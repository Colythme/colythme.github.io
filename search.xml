<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>It&#39;s Time To Learn PYTHON! (record of python challenges)</title>
      <link href="/2021/09/09/Time%20To%20Learn%20Python/"/>
      <url>/2021/09/09/Time%20To%20Learn%20Python/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="It‚Äôs-Time-To-Learn-PYTHON-record-of-python-challenges"><a href="#It‚Äôs-Time-To-Learn-PYTHON-record-of-python-challenges" class="headerlink" title="It‚Äôs Time To Learn PYTHON! (record of python challenges)"></a>It‚Äôs Time To Learn PYTHON! (record of python challenges)</h1><p>Sometimes refer to the solutions to all the passes: <a href="https://www.hackingnote.com/en/python-challenge-solutions/overview">HackingNote Python Challenges Solutions</a></p><h3 id="The-First-Pass"><a href="#The-First-Pass" class="headerlink" title="The First Pass"></a>The First Pass</h3><p>The gibberish displayed on the screen is a passcode which is coded with Caeser cipeher, one of the simplest encryption techniques. From the Wikipedia, we can know that</p><blockquote><p>It is a type of substitution cipher in which each letter in the plaintext is replaced by a letter some fixed number of positions down the alphabet. For example, with a left shift of 3, D would be replaced by A, E would become B, and so on.</p></blockquote><p>So I first wrote a code like this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">para = <span class="built_in">input</span> ()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> para:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span> (i) &gt;= <span class="built_in">ord</span> (<span class="string">&quot;a&quot;</span>) <span class="keyword">and</span> <span class="built_in">ord</span> (i) &lt;= <span class="built_in">ord</span> (<span class="string">&quot;z&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span> ((<span class="built_in">chr</span>)((<span class="built_in">ord</span> (i) + <span class="number">2</span> - <span class="built_in">ord</span> (<span class="string">&quot;a&quot;</span>)) % <span class="number">26</span> + <span class="built_in">ord</span> (<span class="string">&quot;a&quot;</span>)), end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>: <span class="built_in">print</span> (i, end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>Apparently, it is quite cumbersome. After decoding, we can learn from the text that $string.maketrans ()$ is recommanded to be used when facing such problem. So I rewrote the code:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">intext = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">outext = <span class="string">&quot;cdefghijklmnopqrstuvwxyzab&quot;</span></span><br><span class="line">trans = <span class="built_in">str</span>.maketrans (intext, outext);</span><br><span class="line"></span><br><span class="line">para = <span class="built_in">input</span> ()</span><br><span class="line"><span class="built_in">print</span> (para.translate (trans))</span><br></pre></td></tr></table></figure><p>And the code is simpler now. Follow the tips translated, you only need to apply the encryption technique into the url ‚Äúmap‚Äù so that we can get ‚Äúocr‚Äù. After replacing ‚Äúmap‚Äù with ‚Äúocr‚Äù, we can get to the second pass.</p><h3 id="The-Second-Pass"><a href="#The-Second-Pass" class="headerlink" title="The Second Pass"></a>The Second Pass</h3><blockquote><p>recognize the characters. maybe they are in the book, but MAYBE they are in the page source.</p></blockquote><p>It hints us the solution hides in the page source. After opening the page source, we can see another hint and a long string containing various notations, that is</p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/15/hrOlSE9UHZdxpW8.png" alt="psource.png" style="zoom:50%;" /><p>It hints us to find the characters. But how can we get the content of page source? There is a package named $\text{urllib}$, where we can import function <code>urllib.request.urlopen</code> to load raw html data. Then we use function  <code>read</code> and  <code>decode</code>to decode the html and use regular expression to extract the comment blocks.</p><p>Now we have transformed the comment blocks into a string without <code>\n</code>, so the solution is obvious now. We apply <code>re.findall</code> to the string again then we can find the answer $\text{equality}$</p><p>The code is shown below</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">myURL = urlopen (<span class="string">&quot;http://www.pythonchallenge.com/pc/def/ocr.html&quot;</span>)</span><br><span class="line">url = myURL.read().decode()</span><br><span class="line">readl = re.findall (<span class="string">&quot;&lt;!--\s%[\s\S]*--&gt;&quot;</span>, url)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;&quot;</span>.join (re.findall (<span class="string">&quot;[a-zA-Z]&quot;</span>, readl[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure><h3 id="The-Third-Pass"><a href="#The-Third-Pass" class="headerlink" title="The Third Pass"></a>The Third Pass</h3><p>Nearly the same as the second pass.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">myURL = urlopen (<span class="string">&quot;http://www.pythonchallenge.com/pc/def/equality.html&quot;</span>)</span><br><span class="line">url = myURL.read().decode()</span><br><span class="line">readl = re.findall (<span class="string">&quot;&lt;!--[\s\S]*--&gt;&quot;</span>, url)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;&quot;</span>.join (re.findall (<span class="string">&quot;[^A-Z][A-Z]&#123;3&#125;([a-z])[A-Z]&#123;3&#125;[^A-Z]&quot;</span>, readl[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure><h3 id="The-Forth-Pass"><a href="#The-Forth-Pass" class="headerlink" title="The Forth Pass"></a>The Forth Pass</h3><p>From this pass I learn that we can use notation as <code>%s</code> to temporarily substitude a variable, and when you want to call the variable, you only need to add a <code>%</code> notation between two variables.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">findx = [<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line">web = <span class="string">&quot;http://www.pythonchallenge.com/pc/def/linkedlist.php?nothing=%s&quot;</span></span><br><span class="line"><span class="comment"># add = &quot;12345&quot;</span></span><br><span class="line">add = <span class="string">&quot;8022&quot;</span></span><br><span class="line"><span class="keyword">while</span> findx:</span><br><span class="line">    myURL = urlopen (web % add)</span><br><span class="line">    url = myURL.read().decode()</span><br><span class="line">    findx = re.findall (<span class="string">&quot;and the next nothing is (.*)&quot;</span>, url)</span><br><span class="line">    <span class="keyword">if</span> findx: add = findx[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span> (add, url)</span><br></pre></td></tr></table></figure><h3 id="The-Fifth-Pass"><a href="#The-Fifth-Pass" class="headerlink" title="The Fifth Pass"></a>The Fifth Pass</h3><p>According to the page source, we replace the <code>peak.html</code> with <code>banner.p</code> and enter a page full of notations. But we find it difficult to recongnize the characters after decoding the notations in utf-8. In the meantime, we can see a hint in the original page, that is, $\text{pronounce it}$. The pronunciation of $\text{peak}$ is like a object serialization module in Python ‚Äî‚Äî $\text{pickle}$. It hints that we need to decode in the form of pickle, namely,</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myURL = urlopen (<span class="string">&quot;http://www.pythonchallenge.com/pc/def/banner.p&quot;</span>)</span><br><span class="line">readl = pickle.load (myURL)</span><br></pre></td></tr></table></figure><p>Then it is easy to get to a banner like this:</p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/16/8mBSWFRK4qU6cP3.png" alt="@2x.png" style="zoom:40%;" /><p>The problem is resolved right now. The full code is shown below:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">myURL = urlopen (<span class="string">&quot;http://www.pythonchallenge.com/pc/def/banner.p&quot;</span>)</span><br><span class="line">readl = pickle.load (myURL)</span><br><span class="line">f = <span class="built_in">open</span> (<span class="string">&quot;log.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> lst <span class="keyword">in</span> readl:</span><br><span class="line">    <span class="keyword">for</span> tup <span class="keyword">in</span> lst:</span><br><span class="line">        f.write (tup[<span class="number">0</span>] * tup[<span class="number">1</span>])</span><br><span class="line">    f.write (<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">f.close ()</span><br></pre></td></tr></table></figure><h3 id="The-Sixth-Pass"><a href="#The-Sixth-Pass" class="headerlink" title="The Sixth Pass"></a>The Sixth Pass</h3><p>Nearly the same as the previous passes, though the information in page sources is shifted to the zip. We only need to replace the module of urllib with zipfile</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile, re</span><br><span class="line">f = zipfile.ZipFile (<span class="string">&quot;channel.zip&quot;</span>) <span class="comment"># open the zip file</span></span><br><span class="line">add = <span class="string">&#x27;90052&#x27;</span>; findx = [<span class="string">&#x27;&#x27;</span>]; comment = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> findx:</span><br><span class="line">    readl = f.read(add + <span class="string">&#x27;.txt&#x27;</span>).decode() /<span class="comment"># before being decoded, the data is in binary</span></span><br><span class="line">    </span><br><span class="line">    findx = re.findall (<span class="string">&quot;Next nothing is (.*)&quot;</span>, readl)</span><br><span class="line">    comment += f.getinfo (add + <span class="string">&#x27;.txt&#x27;</span>).comment.decode()</span><br><span class="line">    <span class="keyword">if</span> findx: add = findx[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span> (comment)</span><br></pre></td></tr></table></figure><p>The answer is <code>oxygen</code></p><h3 id="The-Seventh-Pass"><a href="#The-Seventh-Pass" class="headerlink" title="The Seventh Pass"></a>The Seventh Pass</h3><p>In this pass, we only have an image and do not know what to do. But there is a grey bar in the middle of the image, which may be the key. We use <code>urlopen</code> to load the image as binary, and use <code>BytesIO</code> to decode, then use the <code>open</code> function in <code>Image</code> module to obtain the data of the image.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">img = Image.<span class="built_in">open</span> (BytesIO (urlopen (<span class="string">&quot;http://www.pythonchallenge.com/pc/def/oxygen.png&quot;</span>).read()))</span><br></pre></td></tr></table></figure><p>After using the <code>getpixel</code> to get the data of certain pixel, we get a list of <code>(R, G, B, alpha)</code>. Then merge the seven same tuples, and get the representation in $ASCII$ of the integer of <code>(R, G, B)</code>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lst = [img.getpixel ((x, img.height / <span class="number">2</span>)) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span> (img.width)][::<span class="number">7</span>]</span><br><span class="line">lst = [R <span class="keyword">for</span> R, G, B, alpha <span class="keyword">in</span> lst]</span><br></pre></td></tr></table></figure><p>Print the result, we now have another hint:</p><blockquote><p>smart guy, you made it. the next level is $[105, 110, 116, 101, 103, 114, 105, 116, 121]$pe_</p></blockquote><p>Following the hint, we do the same process again such that we can get the answer.</p><blockquote><p>$integrity$</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment"># img = Image.open (BytesIO (requests.get (&quot;http://www.pythonchallenge.com/pc/def/oxygen.png&quot;).content))</span></span><br><span class="line">img = Image.<span class="built_in">open</span> (BytesIO (urlopen (<span class="string">&quot;http://www.pythonchallenge.com/pc/def/oxygen.png&quot;</span>).read()))</span><br><span class="line">lst = [img.getpixel ((x, img.height / <span class="number">2</span>)) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span> (img.width)][::<span class="number">7</span>]</span><br><span class="line">lst = [R <span class="keyword">for</span> R, G, B, alpha <span class="keyword">in</span> lst]</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;&quot;</span>.join (<span class="built_in">map</span> (<span class="built_in">chr</span>, lst)))</span><br></pre></td></tr></table></figure><h3 id="The-Eighth-Pass"><a href="#The-Eighth-Pass" class="headerlink" title="The Eighth Pass"></a>The Eighth Pass</h3><p>Decode the <code>username</code> and <code>password</code> in the page source in the form of <code>bzip2</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bz2</span><br><span class="line">un = bz2.decompress (<span class="string">b&#x27;BZh91AY&amp;SYA\xaf\x82\r\x00\x00\x01\x01\x80\x02\xc0\x02\x00 \x00!\x9ah3M\x07&lt;]\xc9\x14\xe1BA\x06\xbe\x084&#x27;</span>)</span><br><span class="line">pw = bz2.decompress (<span class="string">b&#x27;BZh91AY&amp;SY\x94$|\x0e\x00\x00\x00\x81\x00\x03$ \x00!\x9ah3M\x13&lt;]\xc9\x14\xe1BBP\x91\xf08&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (un, pw)</span><br></pre></td></tr></table></figure><p>Or you even can find the answer in the page source‚Ä¶</p><h3 id="The-Ninth-Pass"><a href="#The-Ninth-Pass" class="headerlink" title="The Ninth Pass"></a>The Ninth Pass</h3><p>The number datas in the page source are the coordinates of some dots, we need to use the <code>ImageDraw</code> module in <code>PIL</code> to draw.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">first = [<span class="number">146</span>,<span class="number">399</span>,<span class="number">163</span>,<span class="number">403</span>,<span class="number">170</span>,<span class="number">393</span>,<span class="number">169</span>,<span class="number">391</span>,<span class="number">166</span>,<span class="number">386</span>,<span class="number">170</span>,<span class="number">381</span>,<span class="number">170</span>,<span class="number">371</span>,<span class="number">170</span>,<span class="number">355</span>,<span class="number">169</span>,<span class="number">346</span>,<span class="number">167</span>,<span class="number">335</span>,<span class="number">170</span>,<span class="number">329</span>,<span class="number">170</span>,<span class="number">320</span>,<span class="number">170</span>,</span><br><span class="line"><span class="number">310</span>,<span class="number">171</span>,<span class="number">301</span>,<span class="number">173</span>,<span class="number">290</span>,<span class="number">178</span>,<span class="number">289</span>,<span class="number">182</span>,<span class="number">287</span>,<span class="number">188</span>,<span class="number">286</span>,<span class="number">190</span>,<span class="number">286</span>,<span class="number">192</span>,<span class="number">291</span>,<span class="number">194</span>,<span class="number">296</span>,<span class="number">195</span>,<span class="number">305</span>,<span class="number">194</span>,<span class="number">307</span>,<span class="number">191</span>,<span class="number">312</span>,<span class="number">190</span>,<span class="number">316</span>,</span><br><span class="line"><span class="number">190</span>,<span class="number">321</span>,<span class="number">192</span>,<span class="number">331</span>,<span class="number">193</span>,<span class="number">338</span>,<span class="number">196</span>,<span class="number">341</span>,<span class="number">197</span>,<span class="number">346</span>,<span class="number">199</span>,<span class="number">352</span>,<span class="number">198</span>,<span class="number">360</span>,<span class="number">197</span>,<span class="number">366</span>,<span class="number">197</span>,<span class="number">373</span>,<span class="number">196</span>,<span class="number">380</span>,<span class="number">197</span>,<span class="number">383</span>,<span class="number">196</span>,<span class="number">387</span>,<span class="number">192</span>,</span><br><span class="line"><span class="number">389</span>,<span class="number">191</span>,<span class="number">392</span>,<span class="number">190</span>,<span class="number">396</span>,<span class="number">189</span>,<span class="number">400</span>,<span class="number">194</span>,<span class="number">401</span>,<span class="number">201</span>,<span class="number">402</span>,<span class="number">208</span>,<span class="number">403</span>,<span class="number">213</span>,<span class="number">402</span>,<span class="number">216</span>,<span class="number">401</span>,<span class="number">219</span>,<span class="number">397</span>,<span class="number">219</span>,<span class="number">393</span>,<span class="number">216</span>,<span class="number">390</span>,<span class="number">215</span>,<span class="number">385</span>,</span><br><span class="line"><span class="number">215</span>,<span class="number">379</span>,<span class="number">213</span>,<span class="number">373</span>,<span class="number">213</span>,<span class="number">365</span>,<span class="number">212</span>,<span class="number">360</span>,<span class="number">210</span>,<span class="number">353</span>,<span class="number">210</span>,<span class="number">347</span>,<span class="number">212</span>,<span class="number">338</span>,<span class="number">213</span>,<span class="number">329</span>,<span class="number">214</span>,<span class="number">319</span>,<span class="number">215</span>,<span class="number">311</span>,<span class="number">215</span>,<span class="number">306</span>,<span class="number">216</span>,<span class="number">296</span>,<span class="number">218</span>,</span><br><span class="line"><span class="number">290</span>,<span class="number">221</span>,<span class="number">283</span>,<span class="number">225</span>,<span class="number">282</span>,<span class="number">233</span>,<span class="number">284</span>,<span class="number">238</span>,<span class="number">287</span>,<span class="number">243</span>,<span class="number">290</span>,<span class="number">250</span>,<span class="number">291</span>,<span class="number">255</span>,<span class="number">294</span>,<span class="number">261</span>,<span class="number">293</span>,<span class="number">265</span>,<span class="number">291</span>,<span class="number">271</span>,<span class="number">291</span>,<span class="number">273</span>,<span class="number">289</span>,<span class="number">278</span>,<span class="number">287</span>,</span><br><span class="line"><span class="number">279</span>,<span class="number">285</span>,<span class="number">281</span>,<span class="number">280</span>,<span class="number">284</span>,<span class="number">278</span>,<span class="number">284</span>,<span class="number">276</span>,<span class="number">287</span>,<span class="number">277</span>,<span class="number">289</span>,<span class="number">283</span>,<span class="number">291</span>,<span class="number">286</span>,<span class="number">294</span>,<span class="number">291</span>,<span class="number">296</span>,<span class="number">295</span>,<span class="number">299</span>,<span class="number">300</span>,<span class="number">301</span>,<span class="number">304</span>,<span class="number">304</span>,<span class="number">320</span>,<span class="number">305</span>,</span><br><span class="line"><span class="number">327</span>,<span class="number">306</span>,<span class="number">332</span>,<span class="number">307</span>,<span class="number">341</span>,<span class="number">306</span>,<span class="number">349</span>,<span class="number">303</span>,<span class="number">354</span>,<span class="number">301</span>,<span class="number">364</span>,<span class="number">301</span>,<span class="number">371</span>,<span class="number">297</span>,<span class="number">375</span>,<span class="number">292</span>,<span class="number">384</span>,<span class="number">291</span>,<span class="number">386</span>,<span class="number">302</span>,<span class="number">393</span>,<span class="number">324</span>,<span class="number">391</span>,<span class="number">333</span>,<span class="number">387</span>,</span><br><span class="line"><span class="number">328</span>,<span class="number">375</span>,<span class="number">329</span>,<span class="number">367</span>,<span class="number">329</span>,<span class="number">353</span>,<span class="number">330</span>,<span class="number">341</span>,<span class="number">331</span>,<span class="number">328</span>,<span class="number">336</span>,<span class="number">319</span>,<span class="number">338</span>,<span class="number">310</span>,<span class="number">341</span>,<span class="number">304</span>,<span class="number">341</span>,<span class="number">285</span>,<span class="number">341</span>,<span class="number">278</span>,<span class="number">343</span>,<span class="number">269</span>,<span class="number">344</span>,<span class="number">262</span>,<span class="number">346</span>,</span><br><span class="line"><span class="number">259</span>,<span class="number">346</span>,<span class="number">251</span>,<span class="number">349</span>,<span class="number">259</span>,<span class="number">349</span>,<span class="number">264</span>,<span class="number">349</span>,<span class="number">273</span>,<span class="number">349</span>,<span class="number">280</span>,<span class="number">349</span>,<span class="number">288</span>,<span class="number">349</span>,<span class="number">295</span>,<span class="number">349</span>,<span class="number">298</span>,<span class="number">354</span>,<span class="number">293</span>,<span class="number">356</span>,<span class="number">286</span>,<span class="number">354</span>,<span class="number">279</span>,<span class="number">352</span>,<span class="number">268</span>,</span><br><span class="line"><span class="number">352</span>,<span class="number">257</span>,<span class="number">351</span>,<span class="number">249</span>,<span class="number">350</span>,<span class="number">234</span>,<span class="number">351</span>,<span class="number">211</span>,<span class="number">352</span>,<span class="number">197</span>,<span class="number">354</span>,<span class="number">185</span>,<span class="number">353</span>,<span class="number">171</span>,<span class="number">351</span>,<span class="number">154</span>,<span class="number">348</span>,<span class="number">147</span>,<span class="number">342</span>,<span class="number">137</span>,<span class="number">339</span>,<span class="number">132</span>,<span class="number">330</span>,<span class="number">122</span>,<span class="number">327</span>,</span><br><span class="line"><span class="number">120</span>,<span class="number">314</span>,<span class="number">116</span>,<span class="number">304</span>,<span class="number">117</span>,<span class="number">293</span>,<span class="number">118</span>,<span class="number">284</span>,<span class="number">118</span>,<span class="number">281</span>,<span class="number">122</span>,<span class="number">275</span>,<span class="number">128</span>,<span class="number">265</span>,<span class="number">129</span>,<span class="number">257</span>,<span class="number">131</span>,<span class="number">244</span>,<span class="number">133</span>,<span class="number">239</span>,<span class="number">134</span>,<span class="number">228</span>,<span class="number">136</span>,<span class="number">221</span>,<span class="number">137</span>,</span><br><span class="line"><span class="number">214</span>,<span class="number">138</span>,<span class="number">209</span>,<span class="number">135</span>,<span class="number">201</span>,<span class="number">132</span>,<span class="number">192</span>,<span class="number">130</span>,<span class="number">184</span>,<span class="number">131</span>,<span class="number">175</span>,<span class="number">129</span>,<span class="number">170</span>,<span class="number">131</span>,<span class="number">159</span>,<span class="number">134</span>,<span class="number">157</span>,<span class="number">134</span>,<span class="number">160</span>,<span class="number">130</span>,<span class="number">170</span>,<span class="number">125</span>,<span class="number">176</span>,<span class="number">114</span>,<span class="number">176</span>,</span><br><span class="line"><span class="number">102</span>,<span class="number">173</span>,<span class="number">103</span>,<span class="number">172</span>,<span class="number">108</span>,<span class="number">171</span>,<span class="number">111</span>,<span class="number">163</span>,<span class="number">115</span>,<span class="number">156</span>,<span class="number">116</span>,<span class="number">149</span>,<span class="number">117</span>,<span class="number">142</span>,<span class="number">116</span>,<span class="number">136</span>,<span class="number">115</span>,<span class="number">129</span>,<span class="number">115</span>,<span class="number">124</span>,<span class="number">115</span>,<span class="number">120</span>,<span class="number">115</span>,<span class="number">115</span>,<span class="number">117</span>,</span><br><span class="line"><span class="number">113</span>,<span class="number">120</span>,<span class="number">109</span>,<span class="number">122</span>,<span class="number">102</span>,<span class="number">122</span>,<span class="number">100</span>,<span class="number">121</span>,<span class="number">95</span>,<span class="number">121</span>,<span class="number">89</span>,<span class="number">115</span>,<span class="number">87</span>,<span class="number">110</span>,<span class="number">82</span>,<span class="number">109</span>,<span class="number">84</span>,<span class="number">118</span>,<span class="number">89</span>,<span class="number">123</span>,<span class="number">93</span>,<span class="number">129</span>,<span class="number">100</span>,<span class="number">130</span>,<span class="number">108</span>,<span class="number">132</span>,<span class="number">110</span>,</span><br><span class="line"><span class="number">133</span>,<span class="number">110</span>,<span class="number">136</span>,<span class="number">107</span>,<span class="number">138</span>,<span class="number">105</span>,<span class="number">140</span>,<span class="number">95</span>,<span class="number">138</span>,<span class="number">86</span>,<span class="number">141</span>,<span class="number">79</span>,<span class="number">149</span>,<span class="number">77</span>,<span class="number">155</span>,<span class="number">81</span>,<span class="number">162</span>,<span class="number">90</span>,<span class="number">165</span>,<span class="number">97</span>,<span class="number">167</span>,<span class="number">99</span>,<span class="number">171</span>,<span class="number">109</span>,<span class="number">171</span>,<span class="number">107</span>,<span class="number">161</span>,</span><br><span class="line"><span class="number">111</span>,<span class="number">156</span>,<span class="number">113</span>,<span class="number">170</span>,<span class="number">115</span>,<span class="number">185</span>,<span class="number">118</span>,<span class="number">208</span>,<span class="number">117</span>,<span class="number">223</span>,<span class="number">121</span>,<span class="number">239</span>,<span class="number">128</span>,<span class="number">251</span>,<span class="number">133</span>,<span class="number">259</span>,<span class="number">136</span>,<span class="number">266</span>,<span class="number">139</span>,<span class="number">276</span>,<span class="number">143</span>,<span class="number">290</span>,<span class="number">148</span>,<span class="number">310</span>,<span class="number">151</span>,</span><br><span class="line"><span class="number">332</span>,<span class="number">155</span>,<span class="number">348</span>,<span class="number">156</span>,<span class="number">353</span>,<span class="number">153</span>,<span class="number">366</span>,<span class="number">149</span>,<span class="number">379</span>,<span class="number">147</span>,<span class="number">394</span>,<span class="number">146</span>,<span class="number">399</span>]</span><br><span class="line">second = [<span class="number">156</span>,<span class="number">141</span>,<span class="number">165</span>,<span class="number">135</span>,<span class="number">169</span>,<span class="number">131</span>,<span class="number">176</span>,<span class="number">130</span>,<span class="number">187</span>,<span class="number">134</span>,<span class="number">191</span>,<span class="number">140</span>,<span class="number">191</span>,<span class="number">146</span>,<span class="number">186</span>,<span class="number">150</span>,<span class="number">179</span>,<span class="number">155</span>,<span class="number">175</span>,<span class="number">157</span>,<span class="number">168</span>,<span class="number">157</span>,<span class="number">163</span>,<span class="number">157</span>,<span class="number">159</span>,</span><br><span class="line"><span class="number">157</span>,<span class="number">158</span>,<span class="number">164</span>,<span class="number">159</span>,<span class="number">175</span>,<span class="number">159</span>,<span class="number">181</span>,<span class="number">157</span>,<span class="number">191</span>,<span class="number">154</span>,<span class="number">197</span>,<span class="number">153</span>,<span class="number">205</span>,<span class="number">153</span>,<span class="number">210</span>,<span class="number">152</span>,<span class="number">212</span>,<span class="number">147</span>,<span class="number">215</span>,<span class="number">146</span>,<span class="number">218</span>,<span class="number">143</span>,<span class="number">220</span>,<span class="number">132</span>,<span class="number">220</span>,</span><br><span class="line"><span class="number">125</span>,<span class="number">217</span>,<span class="number">119</span>,<span class="number">209</span>,<span class="number">116</span>,<span class="number">196</span>,<span class="number">115</span>,<span class="number">185</span>,<span class="number">114</span>,<span class="number">172</span>,<span class="number">114</span>,<span class="number">167</span>,<span class="number">112</span>,<span class="number">161</span>,<span class="number">109</span>,<span class="number">165</span>,<span class="number">107</span>,<span class="number">170</span>,<span class="number">99</span>,<span class="number">171</span>,<span class="number">97</span>,<span class="number">167</span>,<span class="number">89</span>,<span class="number">164</span>,<span class="number">81</span>,<span class="number">162</span>,</span><br><span class="line"><span class="number">77</span>,<span class="number">155</span>,<span class="number">81</span>,<span class="number">148</span>,<span class="number">87</span>,<span class="number">140</span>,<span class="number">96</span>,<span class="number">138</span>,<span class="number">105</span>,<span class="number">141</span>,<span class="number">110</span>,<span class="number">136</span>,<span class="number">111</span>,<span class="number">126</span>,<span class="number">113</span>,<span class="number">129</span>,<span class="number">118</span>,<span class="number">117</span>,<span class="number">128</span>,<span class="number">114</span>,<span class="number">137</span>,<span class="number">115</span>,<span class="number">146</span>,<span class="number">114</span>,<span class="number">155</span>,<span class="number">115</span>,</span><br><span class="line"><span class="number">158</span>,<span class="number">121</span>,<span class="number">157</span>,<span class="number">128</span>,<span class="number">156</span>,<span class="number">134</span>,<span class="number">157</span>,<span class="number">136</span>,<span class="number">156</span>,<span class="number">136</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw</span><br><span class="line">im = Image.new (<span class="string">&#x27;RGB&#x27;</span>, (<span class="number">500</span>, <span class="number">500</span>)) <span class="comment"># create a new image</span></span><br><span class="line">draw = ImageDraw.Draw (im) <span class="comment"># create a object</span></span><br><span class="line">draw.polygon (first, fill = <span class="string">&#x27;white&#x27;</span>) <span class="comment"># create a polygon, which is filled in white</span></span><br><span class="line">draw.polygon (second, fill = <span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">im.show ()</span><br></pre></td></tr></table></figure><h3 id="The-Tenth-Pass"><a href="#The-Tenth-Pass" class="headerlink" title="The Tenth Pass"></a>The Tenth Pass</h3><p>The sequence you get by clicking the bull is called $\text{look-and-say sequence}$. From $Google$, we can see that</p><blockquote><p>To generate a member of the sequence from the previous member, read off the digits of the previous member, counting the number of digits in groups of the same digit.</p></blockquote><p>It is easy to use regular expression in $\text{Python}$  to obtain the target string.</p><p>However, I cannot understand I am supposed to regard my regular expression string as  <code>raw string</code>, instead of using it to find the characters straightly.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">strl = <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">30</span>):</span><br><span class="line">    strl = <span class="string">&quot;&quot;</span>.join ([<span class="built_in">str</span> (<span class="built_in">len</span> (i + j)) + i <span class="keyword">for</span> i, j <span class="keyword">in</span> re.findall (<span class="string">&quot;(\d)(\\1*)&quot;</span>, strl)])</span><br><span class="line">    <span class="comment"># Why should I place another escape character ahead of &#x27;\1&#x27;??? Why????????</span></span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">len</span> (strl))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> AMP Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåNOTES„ÄçDiscrete Mathematical Tools for Computer Science</title>
      <link href="/2021/09/03/COMP2711H_Note/"/>
      <url>/2021/09/03/COMP2711H_Note/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="Discrete-Mathematical-Tools-for-Computer-Science"><a href="#Discrete-Mathematical-Tools-for-Computer-Science" class="headerlink" title="Discrete Mathematical Tools for Computer Science"></a>Discrete Mathematical Tools for Computer Science</h1><p>$\text{NOTES ABOUT THE LECTURES}$</p><h2 id="LOGIC"><a href="#LOGIC" class="headerlink" title="LOGIC"></a>LOGIC</h2><h3 id="Useful-Formulas"><a href="#Useful-Formulas" class="headerlink" title="Useful Formulas"></a>Useful Formulas</h3><h4 id="Propositional-Equivalences"><a href="#Propositional-Equivalences" class="headerlink" title="Propositional Equivalences"></a>Propositional Equivalences</h4><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/CNzWALQ7wJ1MftD.png" alt="image-20210906104439334" style="zoom:30%;" /><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/Iyh6MeRCoAqJtU8.png" alt="image-20210906104510549" style="zoom:30%;" /><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/rNxQnSZD6sw84Ro.png" alt="image-20210906104528796" style="zoom:30%;" /><h4 id="Logical-Equivalence"><a href="#Logical-Equivalence" class="headerlink" title="Logical Equivalence"></a>Logical Equivalence</h4><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/sHN6k1bIRJPZhMi.png" alt="image-20210906104751436" style="zoom:30%;" /><h4 id="Rules-of-Inference"><a href="#Rules-of-Inference" class="headerlink" title="Rules of Inference"></a>Rules of Inference</h4><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/HaWMgRPXd7oxOjN.png" alt="image-20210906105011875" style="zoom:30%;" /><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/6QrRVfxXP8ZjIUl.png" alt="image-20210906105030632" style="zoom:30%;" /><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/dN8gWExi5apYHyD.png" alt="image-20210906105050283" style="zoom:30%;" /><ul><li>Notice: $\exist z &gt; 0 (z^2 = 2) \equiv \exist z (z &gt; 0 \and z^2 = 2)$ instead of $\exist z (z &gt; 0 \rightarrow z^2 = 2)$</li></ul><blockquote><p>A real number $r$ is <strong>rational</strong> if there exist integers $p$ and $q$ with $q \neq 0$ such that $r = p / q$. A real number that is not rational is called <strong>irrational</strong></p></blockquote><p>And there‚Äôs a brand new basic proof technique to me ‚Äî Proof by Contraposition.</p><p>We take $\neg q$ as a hypothesis, and then show that $\neg p$ must follows.</p><blockquote><p>Let $f$: ùêô ‚Üí ùêô assign the square of an integer to this integer. Then $f(x) = x^2$, where the domain of $f$ is the set of all integers, we take the <strong>codomain</strong> of $f$ to be the set of all integers, and the <strong>range</strong> of $f$ is the set of all integers that are perfect squares, namely, $\{0, 1, 4, 9, ‚Ä¶\}$</p></blockquote><h3 id="Notes-of-solving-problems"><a href="#Notes-of-solving-problems" class="headerlink" title="Notes of solving problems"></a>Notes of solving problems</h3><ul><li><p>If you are required to proof $A \rightarrow B$ is true, then it suffices to show that whenever $A$ is true, $B$ is also true.</p></li><li><p>Sometimes some problems like ‚ÄúProof $\exists x \forall y P(x, y) \rightarrow \forall y \exists x P(x, y)$ is a tautology‚Äù , you don‚Äôt need to proof it by developing a series of logical equivalences. Instead, you only need to use simple words to explain it. Take the problem above for example:</p><p>If $\exists x \forall y P(x, y)$ is true, then there is some $x$, namely $x_0$ such that for all $y$, $P(x_0, y)$ is true. Therefore, for all $y$, $x_0$ makes $P(x_0, y)$ true, which implies that $\forall y \exists x P(x, y)$ is true.    (Solution from professor‚Äôs slide)</p></li><li><p>Use quantifiers to show ‚Äòunique‚Äô</p><p>$e.g.$ <strong>Express the statement ‚ÄúEveryone has exactly one best friend‚Äù as a logical expression involving predicates, quantiÔ¨Åers with a domain consisting of all people, and logical connectives, where $B (x, y)$ means ‚Äú$y$ is the best friend of $x$‚Äù</strong></p><p>AnswerÔºö$\forall x \exists y ((B (x, y) \land \forall z((z \neq y) \rightarrow \lnot B (x, z)))$</p><p>To express $\exists ! x$, there‚Äôs an another form of formulaÔºö$\exists x P(x) \land \forall x \forall y ((P(x) \land P(y)) \rightarrow x = y)$</p></li><li><p>Example of proving certain number is rationalÔºö„ÄåProve that $\sqrt 2$ is irrational„Äç</p><p>Let us prove it by contradiction.</p><p>Suppose $\sqrt 2$ is rational, then there exists integers $a$ and $b$ such that $\sqrt 2 = \frac{p}{q}$, where $a$ and $b$ have no common factors.</p><p>Then,<br>$$<br>\begin{aligned}<br>&amp;2 = \frac{p^2}{q^2} \\<br>\Rightarrow &amp;2q^2 = p^2 \\<br>\end{aligned}<br>$$<br>So $p^2$ is even, and we can deduce that $p$ is even.  Suppose an integer such that $p = 2m$. Therefore, $2q^2 = p^2 = 4m^2$. Therefore, $q^2 = 2m^2$. And we can see from the equation that $q$ is also even.</p><p>But $2 | p$ and $2 | q$‚Äôs both being true do not follow the premise that $p$ and $q$ have no common factors. Therefore, $\sqrt 2$ cannot be rational.</p></li><li><p><strong>Prove that the set of the rational numbers is countable</strong></p><p>There is a illumination proof in $Schroeder$ with a reference to $Sagher$. Let me give a brief illustration beneath.</p><p>For a rational number $t = \frac{a}{b}$, where $a, b$ are both integer. And the prime factor decompostion of $a$ is $p_1^{x_1}p_2^{x_2}‚Ä¶p_n^{x_n}$, the same, $b‚Äôs$ is $q_1^{y_1}q_2^{y_2}‚Ä¶q_m^{y_m}$. We assume a function $f(x)$ to be $f(\frac{a}{b}) = p_1^{2x_1}p_2^{2x_2}‚Ä¶p_n^{2x_n} \times q_1^{2y_1 - 1}q_2^{2y_2 - 1}‚Ä¶q_m^{2y_m - 1}$, and it is easy to prove that the function is a one-to-one correspondence, for for all natural numbers $N$, it has a representatation as a fractor, then we seperate the primes with even and odd exponents. We can see that to any integer $N$ there correspond a rational number $t$ such that $f(t) = N$</p></li></ul><h2 id="Number-Theory"><a href="#Number-Theory" class="headerlink" title="Number Theory"></a>Number Theory</h2><h3 id="GCD-amp-ExGCD"><a href="#GCD-amp-ExGCD" class="headerlink" title="GCD &amp; ExGCD"></a>GCD &amp; ExGCD</h3><p>As we all know, it is easy to realize ExGCD algorithm by programming, but how can we realize it by hand?</p><p>Suppose we have two numbers, 252 and 198. Now we simulate the process of GCD (we suppose $a = kb + r (k \in \mathbb{Z})$:</p><table><thead><tr><th align="center">$a$</th><th align="center">$b$</th><th align="center">$r$</th></tr></thead><tbody><tr><td align="center">252</td><td align="center">198</td><td align="center">54</td></tr><tr><td align="center">198</td><td align="center">54</td><td align="center">36</td></tr><tr><td align="center">54</td><td align="center">36</td><td align="center">18</td></tr></tbody></table><p>Then we have<br>$$<br>\begin{aligned}<br>54 = 252 - 198 \\<br>36 = 198 - 3 \times 54 \\<br>18 = 54 - 36<br>\end{aligned}<br>$$<br>Substitude<br>$$<br>\begin{aligned}<br>18 &amp;= 54 - 36 \\<br>&amp;= 54 - (198 - 3 \times 54) \\<br>&amp;= 4 \times 54 - 198 \\<br>&amp;= 4 \times (252 - 198) - 198 \\<br>&amp;= 4 \times 252 - 5 \times 198<br>\end{aligned}<br>$$<br>Follow the steps above, we finish the $\text{ExGCD}$ process.</p><p>And here we give out the normal $\text{ExGCD}$ process:<br>$$<br>\begin{aligned}<br>ax + by &amp;= (a, b) \\<br>&amp;= (b, a - \lfloor\frac{a}{b}\rfloor \times b) \\<br>&amp;= mb + n(a - \lfloor\frac{a}{b}\rfloor \times b) \\<br>&amp;= an + (m - \lfloor\frac{a}{b}\rfloor \times n) \times b<br>\end{aligned}<br>$$</p><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>$\text{Predicate}$: Suppose $P$ is the set of prime numbers, then $n = pq (p, q \in P), e \bot (p - 1)(q - 1)$. Suppose $x$ to be the message.</p><p>$\text{Public Key}$: $C = x^e \bmod n$</p><p>$\text{Decryption}$: Find $d$ such that $de \equiv 1 \pmod{(p - 1)(q - 1)}$, then we get the message as $x = C^d \bmod n$</p><h3 id="Notes-of-solving-problems-1"><a href="#Notes-of-solving-problems-1" class="headerlink" title="Notes of solving problems"></a>Notes of solving problems</h3><ul><li><p>A good way to prove a number $m$ to be prime ‚Äì prove that there is no multiplicative inverse for all $x$ in $Z_m$</p><p>For example, to prove that ‚ÄúIf $a^{n - 1} \equiv 1 \pmod{n}$ for all integers $x$ that are not multiples of $n$, then $n$ is prime‚Äù, it suffices to show that for all $a, a \in Z_n$, $a$ has a multiplicative inverse $a^{n - 2} \bmod n$ module $n$. Then we complete the proof.</p></li><li><p>$$\text{Wilson‚Äôs Theorem: } (n \in P \text {(set of primes)} \land (n &gt; 1)) \longleftrightarrow (n - 1)! \equiv n - 1 \pmod{n}$$</p><p>$\text{Proof:}$ It is easy to prove the if part, by using the theorem that $a$ have a multiplicative inverse in $Z_m$ iff $(a, m) = 1$. Therefore, we only need to prove the only-if part, namely, $n \in P \rightarrow (n - 1)! \equiv n - 1 \pmod n$</p><p>Obviously, when $n = 2$, the congruence holds. We only need to consider the situation when $n \ge 3$. According to the property of the multiplicative inverse, each number in the set $\{2, 3, 4, ‚Ä¶, n - 2\}$ has its unique multiplicative inverse in $Z_m$, respectively, that is, we can put these numbers in pairs, in total $\frac{n - 3}{2}$ pairs. Therefore,<br>$$<br>(n - 2)! \equiv 1^{\frac{n - 3}{2}} \equiv 1 \pmod n<br>$$<br>Then the proof is over.</p></li><li><p>The method of $\text{back substitution}$ used to find solutions to the system of congruences:</p><p>For instance, given a system of congruences:<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x \equiv 4 \pmod 6 \\<br>&amp;x \equiv 13 \pmod{15}<br>\end{aligned}<br>\right.<br>$$<br>It is easy to find the congruence system is equivalent to the following:<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x \equiv 0 \pmod 2 \\<br>&amp;x \equiv 1 \pmod 3 \\<br>&amp;x \equiv 3 \pmod 5<br>\end{aligned}<br>\right.<br>$$<br>Suppose an integer $k$ such that $x = 2k$, so now we have<br>$$<br>\begin{aligned}<br>2k &amp;\equiv 1 \pmod 3 \\<br>\Rightarrow k &amp;\equiv 2 \pmod 3<br>\end{aligned}<br>$$<br>Suppose an integer $p$ such that $k = 3p + 2$, therefore, $x = 6p + 4$. Apply the process above again on the modulus $5$, the below follows:<br>$$<br>p \equiv 4 \pmod 5<br>$$<br>Suppose an integer $q$ such that $p = 5q + 4$, therefore, $x = 30q + 28$. Now we get the answer.</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Êï∞Â≠¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êï∞Â≠¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>A.F.O.ÂøÉË∑ØÂéÜÁ®ã&amp;NOI2020Ê∏∏ËÆ∞</title>
      <link href="/2021/07/19/A_F_O/"/>
      <url>/2021/07/19/A_F_O/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>‰ª•‰∏ÄÂùó $Cu$ ÁªìÊùü‰∫ÜËøô‰πàÂ§öÂπ¥ÁöÑ $\text{OI}$ ÁîüÊ∂Ø</p><p>$Day ~ ~ 0$ ÁöÑÁ¨îËØïÂçÅÂàÜÈ°∫Âà©Âú∞ÊãøÂà∞‰∫Ü $100$ ÂàÜÊª°ÂàÜÔºåÊôö‰∏ä‰∏ÄÁõ¥Âú®ËÇùÊ®°ÊùøÔºå‰ΩÜÂ•ΩÂÉèÂÆûÈôÖ‰∏äÂπ∂Ê≤°ÊúâÂï•Áî®ÔºåÈúÄË¶ÅÊ®°ÊùøÁöÑÈÉ®ÂàÜÂàÜ‰º∞Êë∏ÁùÄÂ§ßÂ§öÈÉΩÂø´Âà∞Ê≠£Ëß£‰∫ÜÔºåÂí±‰πüÊÉ≥‰∏çÂà∞</p><p>$Day ~ ~ 1$ ÂºÄÂßãÂâçÔºåÊåâÁÖßÂæÄÂπ¥ÊàêÁª©ÔºåÊàëÁªôËá™Â∑±ÂÆö‰∏ãÂú∞ÂàÜÊï∞ÁõÆÊ†áÂ§ßÊ¶ÇÊòØ $Day ~ ~ 1$ Ë¶ÅÂ§ß‰∫éÁ≠â‰∫é $150$Ôºå$Day ~ ~ 2$ Â§ß‰∫éÁ≠â‰∫é $130$ Â∑¶Âè≥Ôºå‰ΩÜÊàëËÆ§‰∏∫ËøôÊ†∑ÁöÑÁõÆÊ†áÈó¥Êé•ÈÄ†Êàê‰∫Ü $Day ~~ 1$ ÊØîËæÉÂ§ßÁöÑÂ§±Âà©</p><p>$T1$ Áúã‰∫ÜÂ§ßÊ¶Ç $20min$ Â∑¶Âè≥Â∞±ÊÉ≥Âà∞‰∫Ü $O (kn^3\log n)$ Áü©Èòµ‰πòÊ≥ïÁöÑÊÄùË∑ØÔºå‰ΩÜÂ•ΩÂÉèÊÄé‰πàÁÆóÈÉΩÊúÄÂ§öÂè™ËÉΩËøá $k = 0$ ÁöÑÁÇπÔºåÂâ©‰∏ãÁöÑÊÄé‰πàÁÆóÈÉΩËøá‰∏çÂéªÔºàÂÆûÈôÖ‰∏äÊàëËÆ§‰∏∫ËøôÁü©‰πòÂèØ‰ª•Ëøá $k = 0$ ÁöÑÊó∂ÂÄôÊó∂Èó¥‰πüÂ∑≤ÁªèËøáÂéª‰∫ÜÂæà‰πÖÔºâÔºåÁªìÂêàÊö¥ÂäõËøôÊ†∑Â∞±Êúâ $65 pts$ ‰∫ÜÔºå‰ΩÜÁî±‰∫éÁªôËá™Â∑±ÂÆö‰∏ãÁöÑÁõÆÊ†áÔºåÊàë‰∏ÄÁõ¥Âú®ÊÉ≥ÂêéÁª≠Ëß£Ê≥ïÔºå‰∏ÄÁõ¥ÁäπË±´Âà∞ÊÉ≥Âà∞‰∫Ü  $1h45min$ Â∑¶Âè≥‰πüÊ≤°Âï•ÊÉ≥Ê≥ïÔºåËøôÊó∂ÊàëÁÆóÊòØÊØîËæÉÊÖåÂº†‰∫ÜÔºåÂõ†‰∏∫ÊàëÊú¨Êù•ÊòØÊâìÁÆóÊØèÈ¢òÊï¥‰∏™ $1.5h$ÔºåÊØîËæÉ‰ªéÂÆπÔºå‰ΩÜËøô‰πà‰ºòÊüîÂØ°Êñ≠‰∏Ä‰∏ãÂØºËá¥ÊàëÊúÄÁÆÄÂçïÁöÑÊö¥ÂäõÈÉΩ‰∏ÄÁõ¥ÊâìÈîôÔºåÊúÄÂêéÂà∞ $2.5h$ ÊâçÂãâÂãâÂº∫Âº∫ÂÜôÂÆå‰∫Ü $50 pts$ÔºåÂâ©‰∏ã $15 pts$ Ê≤°ÂäûÊ≥ï‰∫ÜÂè™ËÉΩÂÖàÊôæ‰∏ÄËæπ</p><p>ËøôÊó∂ÂÄôÂºÄ $T2$ÔºåÁÆÄÂçïÂÆπÊñ•ÂæàÂ•ΩÊÉ≥Ôºå‰ΩÜÊàëÂç°Âú®‰∫ÜÂ¶Ç‰ΩïÈ´òÊïàÁöÑËÆ°ÁÆóÈÄâÂá∫ÁöÑÊØèÁßçÈõÜÂêàÂåÖÂê´ÁöÑÁÇπÊï∞ÔºåÊÉ≥Êù•ÊÉ≥ÂéªÊÑüËßâÊ†ëÂâñÊØîËæÉÂêàÁêÜÔºå‰ΩÜËøá $5e05$ ËøòÊòØÊØîËæÉÊÇ¨ÔºåÊú¨Êù•ÊÉ≥ÁùÄËÉΩ‰∏çËÉΩÂØπÊØèÊù°ËæπËÄÉËôëÊù•ËÆ°ÁÆóÁ≠îÊ°àÁúãÁúãËÉΩ‰∏çËÉΩÊãøÊõ¥È´òÔºå‰ΩÜÂ•ΩÂÉèÊêû‰∏çÂá∫Êù•ÔºåÊ≠§Êó∂Â∑≤ÁªèÂèàËøá‰∫Ü $1h$ÔºåÂê∏Âèñ‰∫Ü $T1$ ÁöÑÊïôËÆ≠ÔºåÊàëÊûúÊñ≠ÂºÄÂßãÊ†ëÂâñÔºåËä±‰∫Ü $15 \sim 20min$ Â∑¶Âè≥Êï≤ÂÆåÔºåÂèëÁé∞ÊØèÊ¨°‰ºöÂ§öË¶ÜÁõñ‰∏Ä‰∏™ $lca$ÔºåÊú¨Êù•ÊÉ≥ÁùÄÊØèÊ¨°Ë∑≥ÂÆåÊää $lca$ ÂÜçÂà†ÂéªÔºåÁªìÊûúÁ∫øÊÆµÊ†ëÈÉ®ÂàÜÊ≠ªÊ¥ªÂÜô‰∏çÂá∫Êù•ÔºåÂè™Â•ΩÊîæÂºÉÔºåÊîπ $bitset$ Áõ¥Êé•Êö¥ÂäõÊï¥ÈõÜÂêàÁÑ∂ÂêéÂèñÂπ∂ÔºåÂÜôÂÆåÂ∑≤Áªè $4h20min$ ‰∫Ü</p><p>‰∫éÊòØÂè™Ââ©‰∏ã $40min$ ÂÜô $T3$ÔºåÁúãÂÆåÈ¢òÁõÆÁî® $5 \sim 10min$ ÂÜô‰∫Ü $24 pts$ ÁöÑÊö¥ÂäõÔºåÂºÄÂßãÊÉ≥Ââ©‰∏ãÁöÑÈÉ®ÂàÜÂàÜÔºåËøò‰ª•‰∏∫ $Subtask 2$ ÂèØ‰ª•Áõ¥Êé•‰∏Ä‰∏™‰∏ªÂ∏≠Ê†ë‰∫Ü‰∫ãÔºåÂÜôÂÆå‰∫Ü‰∏ªÂ∏≠Ê†ëÊâçÂèëÁé∞ÂÅá‰∫ÜÔºåËøô‰∏™Êó∂ÂÄôÂ§ßÊ¶ÇÂ∞± $4h45min$ ‰∫ÜÔºåÊÉ≥ÊîæÂºÉ‰∫ÜÔºåÂ∑ÆÁÇπ <code>freopen</code> Ê≤°ÂºÄÁõ¥Êé•ËßÅÁ•ñÂÆóÔºåÊÉ≥ÁùÄ‰ªäÂ§©Âè™Êúâ $102 pts$ ÊúâÁÇπÂøÉÊÄÅÁàÜÁÇ∏Ôºå‰∫éÊòØÂú®‰∏ÄÁâáÊ∑∑Ê≤å‰πã‰∏ãËøáÂÆå‰∫ÜÂâ©‰∏ãÁöÑ $15min$</p><p>ÊúÄÁªà $T1$ ÂÜôÊåÇ‰∫ÜÁéØÁöÑÈÉ®ÂàÜÔºå$T3$ Â§ö‰∫Ü $8 pts$ÔºåÊúÄÁªà $40 + 28 + 32 = 104$ÔºåÊØîÈ¢ÑÊúüÈ´ò‰∫Ü $2 pts$ÔºåÂá∫Êù•‰∏ÄÁúãÂá†‰πéÊâÄÊúâ‰∫∫ÈÉΩÊòØ $190+$ÔºåËøòÊúâ $270+$ ÁîöËá≥ $AK$ ÁöÑÔºåÂèëÁé∞ $T1$ Áî® $1 \times n$ ÁöÑÁü©ÈòµÊù•‰πòÔºåÂêåÊó∂‰∫åËøõÂà∂ÊãÜÂàÜ‰∏Ä‰∏ãÁöÑ $trick$ Â∞±ÂèØ‰ª• $O (kn^2\log n)$ Áõ¥Êé•ÂàáÊéâÔºåÂ•ΩÂÉèËøôÊòØ‰∏Ä‰∏™ÊØîËæÉÂ∏∏ËßÑÁöÑ $trick$Ôºü‰∏çËøáÊàëÊ≤°ËßÅËøáÔºåÁÆó‰∫Ü„ÄÇ$T2$ ÁöÑ $40 pts$ Áõ¥Êé•ËÄÉËôëÊØèÊù°ËæπÁöÑË¥°ÁåÆÁÑ∂ÂêéÂ≠êÈõÜÂíå‰∏Ä‰∏ãÂ∞±Â•ΩÔºåÂâ©‰∏ãÁöÑ $60 pts$ ÊòØÊ†ëÂΩ¢ $dp$ÔºåÂèØÊÉú‰∫ÜÊ≤°ÊÉ≥Âà∞ $40 pts$ÔºåËøôËÇØÂÆöÂú®ÊàëËÉΩÂäõËåÉÂõ¥‰πãÂÜÖ</p><p>Êôö‰∏äÂê¨ËÆ≤ËØÑ $T3$ ÊòØ $lxl$ Âá∫ÁöÑÂ§ßÂàÜÂùóÈ¢òÔºåÂéüÊù• $NOI$ ‰πüËÄÉ $YnOI$ ÈÇ£‰∫õÁé©ÊÑèÂÑøÂïä„ÄÇ„ÄÇÂèçÊ≠£ÊàëÂàÜÂùóÂÜôÁöÑÊØîËæÉÂ∞ëÔºå‰ªÄ‰πàÈ´òÁª¥Ëé´ÈòüÁ¨¨ÂçÅ‰∏âÂàÜÂùóÂï•ÁöÑÊàë‰πü‰∏ç‰ºöÔºå‰∏çËøá $lxl$ ÁöÑÂ§¥ÂèëÂ•ΩÈïø„ÄÇ„ÄÇ<code>ÊúùÁî∞ËØó‰πÉ</code> ËøáÊù•ÂÜôËØ¥‰∏çÂÆöËÉΩÂàáÔºüÊúÄÂêéËØ¥‰∫Ü‰∏ãÂ§ßÊ¶ÇÁöÑÊàêÁª©ÂàÜÂ∏ÉÔºåÁÆó‰∏äÈõÜËÆ≠ÈòüÂíå $D„ÄÅE$ Á±ªÔºå$240+$ ÈòüÁ∫øÔºå$148$ Ââç $200$ÔºåÊàë‰º∞Êë∏ÁùÄÂéªÊéâÈÇ£‰∫õ‰∫∫Â§ßÊ¶Ç $125 \sim 130$ Â∫îËØ•ÊòØÊ≠£ÁªüÁöÑÂâç $200$ÔºåÂèØÊÉú‰∫Ü</p><p>$Day ~ ~ 1$ ‰∏ãÂçàÂíåÊôö‰∏äÂ∞±È¢ìÔºåÁÑ∂Âêé‰π∞‰∫Ü‰∏§Êú¨‰π¶ÔºåÁúã‰∫Ü‰ºöÂÑøÔºåÁù°Ëßâ</p><p>$Day ~ ~ 2$ ÊÉ≥ÁùÄËÉΩ‰∏çËÉΩÁøªÁõòÔºå‰ΩÜÂ•ΩÂÉèÂèàÊ≤°Âï•Â∏åÊúõÔºå‰∫éÊòØÂ∞±Âú®‰∏§ÁßçÊÄùÊÉ≥‰∏≠Êå£Êâé</p><p>ËøõËÄÉÂú∫ÂºÄ $T1$ÔºåËä±‰∫Ü $15min$ Èöè‰æøÊÉ≥‰∫Ü‰∏Ä‰∏™Ë¥™ÂøÉÔºåËØï‰∫Ü‰∏Ä‰∏ãÔºåÂ•ΩÂÉèËÉΩËøá $n \le 4$ Âíå $m = n - 1$ ÁöÑÔºüËØ¥‰∏çÂÆö $m \ge n$ ÁöÑ‰πüËÉΩËøáÔºåÁÑ∂ÂêéÂ∞±ÂÅáË£ÖÊúâ $35 pts$ÔºåÂºÄÂßãÊÉ≥Ââ©‰∏ãÁöÑÔºå‰∏ÄÁõ¥ËßâÂæóËøôÈ¢òÂ∫îËØ•ÊòØ‰∏Ä‰∏™ÁΩëÁªúÊµÅÔºå‰ΩÜÂè™ËÉΩÈÄâ $1 \sim 2$ ‰∏™ÁöÑÈôêÂà∂Â∞±ËÆ©ÊàëÊ≠ªÊ¥ªÊûÑ‰∏çÂá∫ÂõæÊù•ÔºåÂá†Ê¨°ÊÉ≥Âà∞‰∫ÜÂá†‰∏™ÂõæÊÑüËßâÊ≤°ÊØõÁóÖÔºåÁªìÊûúÁ≠âË¥πÁî®ÊµÅÁöÑÊï≤ÂÆå‰∫ÜÊâçÂèëÁé∞ÂÅáÁöÑ‰∏çËÉΩÂÜçÂÅáÔºå‰∫éÊòØÂ∞±ËøôÊ†∑Ê∑∑Ê≤åÂú∞Â∫¶Ëøá‰∫Ü $1h45min$ÔºåÂéªÁûÑ‰∫Ü‰∏ÄÁúº $T2$ÔºåÈ¢òÈù¢Ë¥ºÈïø‰ΩÜÊå∫ÊúâÊÑèÊÄùÔºåÁêÜËß£ÂÆåÈ¢òÊÑèËßâÂæóËøôÁé©ÊÑèÂÑø‰∏ÄÁúãÂ∞±Áü•ÈÅì‰∏çÊòØÊàë‰ºöÂÜôÁöÑÔºåÁû•‰∫ÜÁúºÈÉ®ÂàÜÂàÜÔºå$12 pts$ ‰∏ÄÁúºÔºåÂâ©‰∏ãÁöÑÈÉΩ‰∏ç‰ºöÔºå‰∫éÊòØÊàëÊâìÁÆóÂÜô $12 pts$ÔºåÂâ©‰∏ãÁöÑÁõ¥Êé•Âä†‰∏Ä‰∫õÁâπÂà§ÁÑ∂Âêé $rand ()$ÔºåÁÑ∂ÂêéÊªöÂõû $T1$</p><p>$Day ~ ~ 2$ Áî±‰∫éÈ¢òÁõÆÂØπÊàëÊØîËæÉËá™Èó≠ÊâÄ‰ª•Êó∂Èó¥‰πüÊáíÂæóÁÆ°‰∫ÜÔºåÂèçÊ≠£ÈÉΩ‰∏ç‰ºö„ÄÇ„ÄÇ‰∏çÁü•‰ΩïÊó∂ÂºÄ‰∫Ü‰∏ã $T3$ÔºåÂèëÁé∞Ëøû $30 pts$ ÈÉΩ‰∏ç‰ºöÔºåÊÉ≥ÁùÄÁé©ÁêÉ‰∫ÜÔºåÁÑ∂ÂêéÊï≤‰∫Ü‰∏™Ê∑±ÊêúÂÜçÈöè‰æøËæìÂá∫‰∫Ü‰∏™ÊúÄÁü≠Ë∑ØÈ™óÂàÜ</p><p>‰∫éÊòØ $Day ~ ~ 2$ Â∞±Âú®È¢òÁõÆ‰∫§ÂèâÊ∑∑ÊÉ≥Ôºà‰∏ªË¶ÅÂú®ÊÉ≥ $T1$ ÁΩëÁªúÊµÅÔºâ‰∏≠ÁªìÊùü‰∫ÜÔºàÊúÄÂêéÊàë $T1$ Áî®Ë¥™ÂøÉÈ™óÂàÜÔºâ</p><p>$CCF$ Êôö‰∫Ü $1.5h$ ÊâçÂºÄÊàêÁª©ÔºåÂú®Âú∫Â§ñÊâãÊú∫ÈÉΩÂø´ÁúãÊ≤°Áîµ‰∫Ü„ÄÇ„ÄÇÊúÄÁªà $35 + 4 + 0 = 39$Ôºå$T2$ ‰º∞ËÆ°ÊòØÂêéÈù¢È≠îÊîπÂÆåÂøòËÆ∞ÂÜçÊµã‰∏Ä‰∏ã $h_{max} \le 2$ ÁöÑÊï∞ÊçÆÁªìÊûúÁøªËΩ¶‰∫ÜÔºå$T3$ ÂøòËÆ∞ËæìÂá∫ $- 1$ ‰∏çÁÑ∂ËÉΩÊúâ $5 pts$Ôºå‰∫ãÂÆûËØÅÊòé‰Ω†‰∏çËÉΩÁî®ËÑ∏ÁøªÁõòÔºåÁ≤âÂÖî $T1$ ÈöèÊú∫Âåñ $70 +$Ôºå$nealchen$ ËææÂà∞‰∫Ü $200$ Êï¥Ôºå‰ªñ‰ª¨ÁúãÁùÄÂøÖËøõÈòüÂïäÔºåÂæàÂéâÂÆ≥</p><p>ËÆ≤ËØÑ‰πüÊå∫‰∏çÂ§™ÊáÇÔºåÂ•ΩÂÉèÊàë $T1$ ÁöÑ $35 pts$ ÁöÑË¥™ÂøÉË∑üÊ≠£Ëß£‰∏çÊòØ‰∏ÄÂõû‰∫ãÔºüÂèçÊ≠£Â∞±ÊòØ‰ºöÁöÑ‰ºöÔºå‰∏ç‰ºöÁöÑËøòÊòØ‰∏ç‰ºöÔºåËøôÊ†∑ÁöÑËØùÊÄªÂàÜ $100 + 104 + 39 = 243$ÔºåËøôÊàêÁª©ÁúãÁùÄÁÇºÈìúÊúØÂ£´Á®≥‰∫ÜÔºå‰ΩÜËøòÊä±Êúâ‰∏ÄÁ∫øËÉΩÁªôÈìúÊäõÂÖâ‰∏äÈì∂ÁöÑÂ∏åÊúõÔºåÊúÄÁªàÈòüÁ∫ø $447$ÔºåÈì∂Áâå $274$Ôºå$FJ$ Âõõ‰∏™ËøõÈòüÔºåÂÖîÂ∑Æ $1$ ÂàÜ $Au$Ôºå‰ΩÜÈòüÊòØËÇØÂÆöËøõ‰∫Ü</p><p>‰ªäÂπ¥ $Ag$ Êï∞ÁõÆÂ¢ûÂä†‰∫Ü $50$ ‰∏™ÔºåÁúÅÈÄâÂâçÂ§ßÂçäÂπ¥Ê≤°Êêû‰∫ÜÔºåÂ§öÂ∞ëËøòÊòØ‰ºöÊúâ‰∫õÂøÉÈáåÊ≤°Â∫ïÔºå‰ΩÜËøòÊòØËÆ§‰∏∫Êãø $Ag$ ËøòÊòØÊØîËæÉÁ®≥ÁöÑÔºåÂÜµ‰∏îÊ≤°ÊãøÂà∞ $Ag$ Âº∫Âü∫‰πü‰∏ç‰ºöÊúâ‰ªÄ‰πà‰ºòÊÉ†ÔºåÊâÄ‰ª•Á≠âÂà∞‰∏§Â§©ÊàêÁª©Âá∫Êù•ÁöÑÊó∂ÂÄôÔºåËøòÁÆóÊòØÊØîËæÉÂ§±ÊúõÁöÑÔºàËôΩÁÑ∂ÂêéÈù¢ÈÄêÊ∏ê‰ΩõÁ≥ªÔºâÔºåÊÉ≥ÁùÄÂ¶ÇÊûúÊàë $T1$ Ê≤°‰∏¢ÈÇ£ $10 pts$ÔºåÂÜçÊää $k = 0$ Êï≤ÂÆåÔºå$T2$ Êç°Âõû $13 pts$ÔºåÂ•ΩÂÉèËÉΩÂéã $Ag$ Á∫øÂë¢ÔºüÊÑüËßâ‰ªäÂπ¥ÁöÑÈ¢òÊØîËæÉÂÅèÔºåÂØπÊàëËøôÁßçÂà∑È¢òÊØîËæÉÂ∞ëÁöÑÂæà‰∏çÂèãÂ•ΩÔºåËøô‰∫õÁ±ªÂûãÈ¢òÊàëÈÉΩÂá†‰πéÊ≤°ÂÅöËøáÔºåÂ¶ÇÊûúÊç¢ÂÉèÂéªÂπ¥Â∏∏ËßÑ‰∏ÄÁÇπÁöÑÊàëÂ∫îËØ•‰πüËÉΩ $Ag$Ôºü‰∏çËøáËøôÈÉΩÊòØÂêéËØùÔºåÂ§öÂ∞ë‰ºöÊúâ‰∫õ‰∏çÁîòÂøÉÔºå‰∏çËøáËá™Â∑±ÁöÑÊ∞¥Âπ≥Â∞±ÊëÜÂú®ÈÇ£ÂÑøÔºåÊäÄ‰∏çÂ¶Ç‰∫∫ÔºåÁîòÊãú‰∏ãÈ£é</p><p>ËøôÊ†∑ÁÆóÊòØÁªôÊï¥‰∏™ $\text{OI}$ ÁîüÊ∂ØÂàí‰∏ä‰∫Ü‰∏™ÂúÜÊª°ÁöÑÂè•Âè∑ÔºåËôΩÁÑ∂Ê≤°ÊúâÂº∫Âü∫ÁöÑ‰ºòÊÉ†ËøòÊòØ‰ºöÂ§±ËêΩÔºå‰ΩÜÊØïÁ´üËøõËøá‰∫ÜÁúÅÈòüÔºåÊù•Ëøá‰∫ÜÂõΩËµõÔºåËßÅÂà∞ÁîöËá≥ËÆ§ËØÜ‰∫ÜÈÇ£‰∫õ‰πãÂâçÂè™ÈóªÂÖ∂ÂêçÂèØÊúõËÄå‰∏çÂèØÂèäÁöÑÁ•û‰ªôÔºåÁúºÁïå‰πü‰∏ç‰∏ÄÊ†∑‰∫Ü</p><p>ËÄÉÂÆå‰πãÂêéÂíåÂÖ∂ÂÆÉÂº∫Ê†°ÁöÑÊïôÁªÉ‰∫§ÊµÅ‰∫Ü‰∏Ä‰∏ãÔºå‰ªñ‰ª¨‰πüËØ¥‰∫Ü‰ªñ‰ª¨ÁöÑÊïôÂ≠¶ÊåáÂØºÂíåÊñπÊ≥ïÔºåÂêÑ‰∏™ÈÉ®ÂàÜËøûÊé•Á¥ßÂáëÔºåÊúâÁêÜÊúâÊçÆÔºåÂ§ßÈÉ®ÂàÜÈááÁî®ÁöÑÊòØÂçïÊàñÂèåÊïôÂ∏àÁªü‰∏ÄÁÆ°ÁêÜÔºåÊúâÂéÜÂ±äÈ´òÊâã‰º†ÊâøÔºåÂ≠¶ÊúØ‰∫§ÊµÅËåÉÂõ¥Êõ¥ÂπøÔºå‰∏çËá≥‰∫éËØ¥Â∞±Êàë‰ª¨ÂêåÁ∫ßÂõ¢ÈòüÂÜÖÈÉ®‰∫§ÊµÅÔºåÊ∞¥Âπ≥È°∂Â§©‰∫Ü‰πüÂ∞±ÈÇ£‰πàÂ§öÔºå‰∫§ÊµÅÊù•‰∫§ÊµÅÂéª‰∏çËøáËøòÊòØÈÇ£‰∏ÄÂõû‰∫ãÔºåËøõÂ±ïÁºìÊÖ¢Ôºå‰ªñÊ†°‰ªé‰∏ÄÂÆöÁ®ãÂ∫¶ÂºÄÂßãÂ∞±ÁªèÂ∏∏ÊúâÊØîËæÉÂØÜÈõÜÁöÑÈòüÂÜÖÊàñÂ§öÊ†°‰∫íÊµãÔºåÂú®‰Ωú‰∏∫ÈÄâÊâãÁöÑÂêåÊó∂ÔºåËøòÊúâÂæàÂ§ö‰Ωú‰∏∫Âá∫È¢ò‰∫∫‰∏éËÄÅÂ∏àÁöÑÊú∫‰ºöÔºåÊâÄË∞ì <code>ÊïôÂ≠¶Áõ∏Èïø</code> ‰πüÊ≠£ÊòØÂ¶ÇÊ≠§ÔºåÈô§Ê≠§‰ª•Â§ñËøòÊúâÊõ¥Â§öÊåáÂØºÊñπÊ≥ïÔºåËã•ÊòØÂú®ÂΩìÊó∂ÂÅúËØæÁöÑÊó∂ÂÄôÔºåÁîöËá≥ÊòØ‰ªéÂàù‰∏≠ÂºÄÂßã‰ª•ËøôÁßçÊ®°ÂºèËÆ≠ÁªÉÔºåÊàëÁõ∏‰ø°ÊàëËøòÊòØÊúâËÉΩÂäõÂéªÊé•ËøëÈÇ£‰∫õÈ´òÊâãÁöÑÊ∞¥Âπ≥</p><p>ËØ¥ÂÆûËØùÔºåËøôÊ¨°ÊúÄÈÅóÊÜæÁöÑÂÄí‰∏çÊòØÊãø‰∫Ü $Cu$ÔºåÂõ†‰∏∫ËôΩÁÑ∂Êúâ‰∏ÄÂÆöÂ§±ËØØÂõ†Á¥†Ôºå‰ΩÜ‰∏ªË¶ÅËøòÊòØÊäÄ‰∏çÂ¶Ç‰∫∫ÔºåÊúÄÈÅóÊÜæÁöÑÂÖ∂ÂÆû‰æøÊòØÊàëÊú¨Êù•ÂèØËÉΩÂèØ‰ª•Êã•ÊúâÈÇ£‰∫õÈ´òÊâãÁöÑÂÆûÂäõÔºåÂç¥Êàê‰∫ÜÁé∞Âú®ÁöÑÊ†∑Â≠ê</p><p>Â•Ω‰∫ÜÔºå$\text{OI}$ ÁîüÊ∂ØÂ∞±Ê≠§ÁªìÊùüÔºåËØ•ÊªöÂõûÂéªËÇùÊñáÂåñËØæ‰∫Ü</p><p>$\text{A.F.O.}$ Âø´‰πê</p>]]></content>
      
      
      <categories>
          
          <category> ÊùÇË∞à </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊùÇË∞à </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ËØ¥ËØ¥ËØù</title>
      <link href="/2021/07/19/hello-world/"/>
      <url>/2021/07/19/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Áªà‰∫éÊêûÂÆå‰∫Ü„ÄÇ„ÄÇ</p><p>ËøôÊòØÁ¨¨‰∏âÁâàÁöÑÂçöÂÆ¢ËøÅÁßª</p><p>‰πãÂâçÁî±‰∫éÂíï‰∫Ü‰∏ÄÊÆµÊó∂Èó¥OI</p><p>ÊêûÁöÑÂéüÂçöÂÆ¢ÊúçÂä°Âô®ËøáÊúüÂüüÂêçËøáÊúüÊï∞ÊçÆÂÖ®Ê≤°‰∫Ü</p><p>ÁÑ∂ÂêéÂ∞±ÈáçÊñ∞Êêû‰∫ÜËøô‰πà‰∏Ä‰∏™Áé©ÊÑèÂÑø</p><p>Ëá≥‰∫éÂéüÂõ†</p><p>Â§ßÊ¶ÇÂ∞±ÊòØÂíï‰∫ÜÂçäÂπ¥ÂêéÂéªÁúÅÈÄâÊë∏‰∏™È±º‰∏Ä‰∏çÂ∞èÂøÉËøõÈòü‰∫Ü</p><p>‰∫éÊòØÂ∞±ÂæóÂáÜÂ§áNOI‰∫Ü</p><p>ÂΩìÁÑ∂ÔºåËøô‰∏™‚Äú‰∏Ä‰∏çÂ∞èÂøÉ‚Äù‰∏çÂ∏¶Êúâ‰ªª‰ΩïËá™ÂÇ≤ÁöÑÊÑèÊÄù</p><p>ÊàëÂè™ÊòØËßâÂæóËá™Â∑±ÁöÑÊ∞¥Âπ≥ËøòÊ≤°ÊúâËææÂà∞Ê†áÂáÜ„ÄÇ„ÄÇ</p><p>ËøòÊúâ‰∏Ä‰∏™ÊúàÔºåÂá∫ÂéªÈõÜËÆ≠</p><p>Â∏åÊúõÂà∞NOIÁöÑÊó∂ÂÄôËÉΩËææÂà∞Ëá™Â∑±ÊÉ≥Ë¶ÅÁöÑÊ∞¥Âπ≥Âêß</p><p>‰øùÈì∂‰∫âÈáë</p><p>ÈÇ£‰πàÊàëÁöÑÂçöÂÆ¢‰πüÂæóÈáçÊñ∞ÂõûÊù•‰∫Ü</p><p>ÂóØ</p><p>Â∞±ËøôÊ†∑</p><p>$\text{Upd:}$ <a href="https://colythme.github.io/2020/08/21/A_F_O/">A.F.O.ÂøÉË∑ØÂéÜÁ®ã&amp;NOI2020Ê∏∏ËÆ∞</a></p>]]></content>
      
      
      <categories>
          
          <category> ÊùÇË∞à </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊùÇË∞à </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CRTÔºà‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÔºâÂèäÂÖ∂Êâ©Â±ï</title>
      <link href="/2021/07/19/CRT%EF%BC%88%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86%EF%BC%89%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"/>
      <url>/2021/07/19/CRT%EF%BC%88%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86%EF%BC%89%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="CRT"><a href="#CRT" class="headerlink" title="CRT"></a>CRT</h2><p>Áî®‰∫éÊ±ÇËß£Á±ª‰ºº<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x \equiv a_1 \pmod{m_1} \\<br>&amp;x \equiv a_2 \pmod{m_2} \\<br>&amp;‚Ä¶ \\<br>&amp;x \equiv a_n \pmod{m_n}<br>\end{aligned}<br>\right.<br>$$<br>ÂÖ∂‰∏≠Ôºå$\forall i, j, ~ (m_i, m_j) = 1$</p><p>ËÆæ $M = \prod_{i = 1}^n m_i, ~ M_i = \frac{M}{m_i}$ÔºåÂÜçËÆæ $M_it_i \equiv 1 \pmod{m_i}$ÔºåÂÖ∂‰∏≠ $1 \le i \le n$</p><p>ÂàôÂèØÊûÑÈÄ†‰∏ÄËß£ $x = \sum\limits_{i = 1}^n a_iM_it_i$Ôºå‰ªªÊÑèËß£ $x_0 = x + k \times M$</p><h2 id="ExCRT"><a href="#ExCRT" class="headerlink" title="ExCRT"></a>ExCRT</h2><p>Áî®‰∫éÊ±ÇËß£Á±ª‰ºº<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x \equiv a_1 \pmod{m_1} \\<br>&amp;x \equiv a_2 \pmod{m_2} \\<br>&amp;‚Ä¶ \\<br>&amp;x \equiv a_n \pmod{m_n}<br>\end{aligned}<br>\right.<br>$$<br>ÂÖ∂‰∏≠Ôºå‰∏ç‰∏ÄÂÆöÊª°Ë∂≥ $\forall i, j, ~ (m_i, m_j) = 1$</p><p>ËÄÉËôë‰∏§‰∏™‰∏§‰∏™Â§ÑÁêÜÔºåÁÑ∂ÂêéÂêàÂπ∂</p><p>Áé∞Âú®ÂÖàËÄÉËôëÊñπÁ®ã<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x \equiv a_1 \pmod{m_1} \\<br>&amp;x \equiv a_2 \pmod{m_2}<br>\end{aligned}<br>\right.<br>$$<br>Â∞ÜÂêå‰ΩôÂéªÊéâÔºåÂÜçËøõË°åÂèòÊç¢<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x = a_1 + k_1m_1 \\<br>&amp;x = a_2 + k_2m_2<br>\end{aligned}<br>\right. \\<br>\Rightarrow k_1m_1 - k_2m_2 = a_2 - a_1<br>$$</p><p>ÈÇ£‰πàÊ≠§Êó∂Ëã• $(m_1, m_2) | (a_2 - a_1)$ ÂàôÊúâËß£ÔºåÂèç‰πãÂàôÊó†Ëß£</p><p>ÂΩìÁÑ∂ËøôÊó∂Â∞±ÂèØ‰ª•Áî® $ExGCD$ Áõ¥Êé•Ê±ÇËß£Ôºå‰ΩÜÊé•‰∏ãÊù•ÊääÂÆÉÂåñÊàêÈÄÜÂÖÉÁöÑÂΩ¢Âºè‰ºöÊõ¥ÂÆπÊòìËß£ÂºÄ‰πüÊõ¥‰∏çËÄóÊó∂</p><p>‰ª§ $d = (m_1, m_2)$ÔºåÂàô<br>$$<br>\begin{aligned}<br>\frac{k_1m_1}d - \frac{k_2m_2}d &amp;= \frac{a_2 - a_1}d \\<br>\frac{k_1m_1}d &amp;\equiv \frac{a_2 - a_1}d \pmod{\frac{m_2}d} \\<br>k_1 &amp;\equiv inv (\frac{m_1}d, \frac{m_2}d)\frac{a_2 - a_1}d \pmod{\frac{m_2}d} \\<br>k_1 &amp;= inv (\frac{m_1}d, \frac{m_2}d)\frac{a_2 - a_1}d + t\frac{m_2}d \\<br>\end{aligned}<br>$$<br>ÂÖ∂‰∏≠ $inv (x, p)$ Ë°®Á§∫ $x$ Âú®Ê®° $p$ ÊÑè‰πâ‰∏ãÁöÑÈÄÜÂÖÉ</p><p>Ê≠§Êó∂Â∞Ü $k_1$ ‰ª£ÂÖ• $x = a_1 + k_1m_1$ÔºåÂàôÊúâ<br>$$<br>x \equiv a_1 + m_1 \times inv(\frac{m_1}d, \frac{m_2}d)\frac{a_2 - a_1}d \pmod{\frac{m_1m_2}d}<br>$$<br>ÁÑ∂ÂêéÂêàÂπ∂ $n - 1$ Ê¨°Âç≥ÂèØ</p><h2 id="Ex-ExCRT"><a href="#Ex-ExCRT" class="headerlink" title="Ex-ExCRT"></a>Ex-ExCRT</h2><p>If we suppose that our equation set is something like this:<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;b_1x \equiv a_1 \pmod{p_1} \\<br>&amp;b_2x \equiv a_2 \pmod{p_2} \\<br>&amp;‚Ä¶ \\<br>&amp;b_nx \equiv a_n \pmod{p_n}<br>\end{aligned}<br>\right.<br>$$<br>then we need to change the way we process the equations</p><p>Suppose that we have got the answer of the first $i - 1$ congruence equations, we call it $ans$. And suppose $M$ to be the least common multiple of $\{p_1,p_2, p_3, ‚Ä¶, p_n\}$, then obviously, the answer of the first $i$ congruence equations $ANS$ should be $ans + kM (k \in \mathbb Z)$. Let us start to derive:<br>$$<br>\begin{aligned}<br>&amp;ANS = ans + Mx \\<br>&amp;\Rightarrow b_i (ans + Mx) \equiv a_i \pmod{p_i} \\<br>&amp;\Rightarrow b_iMx \equiv a_i - b_i \times ans \pmod{p_i} \\<br>&amp;\Rightarrow b_iMx + p_iy = a_i - b_i \times ans<br>\end{aligned}<br>$$<br>Apparently, we can use $ExCRT$ to solve the last equation.</p>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CRT/ExCRT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∏âÂçÅÂÖ≠Ôºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E5%85%AD%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E5%85%AD%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>$\text{OEIS}$ $trick$</p><p>$\text{scoreÔºö100 + 0 + 0 = 100            rkÔºö6/35}$</p><h2 id="Problem-AÔºöÊï∞ÊéíÂàó"><a href="#Problem-AÔºöÊï∞ÊéíÂàó" class="headerlink" title="Problem AÔºöÊï∞ÊéíÂàó"></a>Problem AÔºöÊï∞ÊéíÂàó</h2><h3 id="È¢òÈù¢"><a href="#È¢òÈù¢" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/01/L1XrIYc2SMA5eDV.png" alt=""></p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÊâìË°®ÔºåÁÑ∂Âêé $\text{OEIS}$ Á¨¨ <a href="http://oeis.org/A005802" target="_blank" rel="noopener">A005802</a> Â∫èÂàó</p><p>Êú¨Êù•ÊÉ≥ÁùÄÈ¢òËß£ÂèØËÉΩ‰ºöÁªôÂá∫Ê≠£Ëß£ÔºåÁÑ∂ËÄå‰ªñËøô‰πàËØ¥</p><blockquote><p>ÈóÆÈ¢òÊòØÊ±Ç‰∏Ä‰∏™Êï∞ÂàóÁöÑÁ¨¨ $n$ È°πÔºå‰ΩÜËØ•Êï∞ÂàóÊòæÁÑ∂‰∏çÊòØÁ∫øÊÄßÈÄíÊé®Êï∞ÂàóÔºå ‰ΩÜÂèØ‰ª•ÁåúÊÉ≥ËØ•Êï∞ÂàóÊòØÊï¥ÂºèÈÄíÊé®Êï∞Âàó„ÄÇÂà©Áî®È´òÊñØÊ∂àÂÖÉÊàñÊâ©Â±ï $BM$ÔºåÂèØÂæó‚Ä¶‚Ä¶</p></blockquote><p>Â•Ω‰∫ÜÈÇ£‰º∞Êë∏ÁùÄÊ≠£Ëß£Â∞± $\text{OEIS}$ Âêß</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">4e05</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T; LL MOD;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL vis[MAXN];</span><br><span class="line"></span><br><span class="line">LL a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;, invfact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++) fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[MAX] = power (fact[MAX], MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = MAX - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --) invfact[i] = invfact[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">1</span>, a[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">1</span>; n &lt; (MAX &gt;&gt; <span class="number">1</span>); n ++) &#123;</span><br><span class="line">LL add = (<span class="number">10l</span>l * n % MOD * n % MOD + <span class="number">10l</span>l * n % MOD + <span class="number">3</span>) % MOD * a[n] % MOD;</span><br><span class="line">add = (add - <span class="number">9l</span>l * n % MOD * n % MOD * a[n - <span class="number">1</span>] % MOD + MOD) % MOD;</span><br><span class="line">a[n + <span class="number">1</span>] = add * power (<span class="number">1l</span>l * (n + <span class="number">1</span>) * (n + <span class="number">1</span>) % MOD, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* (n+1)^2 a(n+1) = (10*n^2+10*n+3) * a(n) - 9*n^2 * a(n-1). */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (vis, - <span class="number">1</span>, <span class="keyword">sizeof</span> (vis));</span><br><span class="line">T = getnum (); <span class="built_in">cin</span> &gt;&gt; MOD;</span><br><span class="line">init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line"><span class="keyword">int</span> n = getnum ();</span><br><span class="line"><span class="keyword">if</span> (~ vis[n]) &#123; <span class="built_in">cout</span> &lt;&lt; vis[n] &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">continue</span>; &#125;</span><br><span class="line">LL ans = ((<span class="number">18l</span>l * n + <span class="number">45</span>) % MOD * a[n]- (<span class="number">7l</span>l + <span class="number">2</span> * n) % MOD * a[n + <span class="number">1</span>] % MOD + MOD) % MOD;</span><br><span class="line">ans = ans * power (<span class="number">6l</span>l * (n + <span class="number">2</span>) % MOD * (n + <span class="number">2</span>) % MOD, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">vis[n] = ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">a(n) = 2 * Sum_&#123;k=0..n&#125; binomial(2*k, k) * (binomial(n, k))^2 * </span></span><br><span class="line"><span class="comment">  (3*k^2 + 2*k+1 - n - 2*k*n)/((k+1)^2 * (k+2) * (n-k+1)).</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöÊéíÂàó"><a href="#Problem-BÔºöÊéíÂàó" class="headerlink" title="Problem BÔºöÊéíÂàó"></a>Problem BÔºöÊéíÂàó</h2><h3 id="È¢òÈù¢-1"><a href="#È¢òÈù¢-1" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/01/IZAX16L2sirGPgw.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/01/rZMB8nmuJ1YoweS.png" alt=""></p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>Á¨¨‰∏ÄÊ¨°ËÆ¢Ê≠£ÁöÑ‰∫§‰∫íÈ¢ò</p><p>Â§ßÊ¶ÇËÆ∞ÂΩï‰∏Ä‰∏ã‰∫§‰∫íÈ¢òÂíãÁé©</p><ul><li>ÁºñËØëÂèØ‰ª•ÈÄöËøáÂú®ÁîµËÑë $\text{path}‚Äã$ ‰∏≠Ê∑ªÂä†ÁºñËØëÂô®Ë∑ØÂæÑÔºåÈÄöËøá $\text{cmd}‚Äã$ $\text{cd}‚Äã$ Âà∞ÊåáÂÆöÊñá‰ª∂Â§πÔºåËæìÂÖ•È¢òÁõÆÁªôÂÆöÁºñËØëËØ≠Âè•ÁºñËØëÔºåÂÜçËøêË°å $\text{xxx.exe}‚Äã$ ËøêË°åÔºåËæìÂÖ•Êï∞ÊçÆÔºåÊúÄÂêéÂú® $\text{cmd}‚Äã$ ‰∏≠ËøîÂõûÁ≠îÊ°àÊ≠£Á°ÆÊÄßÂèäËØ¢ÈóÆÊ¨°Êï∞</li><li>ÁºñËØëËøêË°åÁÆÄÊòìÊñπÊ≥ïÔºåÂèØÁõ¥Êé•Âä†ÂÖ•Â§¥Êñá‰ª∂ <code>#include &quot;grader.cpp&quot;</code>ÔºåÊ≠§Êó∂ÂèØÁõ¥Êé•ÁºñËØëËøêË°å</li></ul><p>ÂõûÂà∞Ê≠£È¢ò</p><p>ÈöèÊú∫‰∏Ä‰∏™ÊéíÂàó $q‚Äã$ÔºåÂÜçÈöèÊú∫Âú∞ÊîπÂèò $q‚Äã$ ‰∏≠ÁöÑ $S‚Äã$ ‰∏™ÂÖÉÁ¥†Ôºå‰ΩøËøô $S‚Äã$ ‰∏™ÂÖÉÁ¥†ÈáçÊñ∞ÈîôÊéíÔºåËÆæÂæóÂà∞ÊéíÂàó $r‚Äã$ÔºåÊîπÂèò‰∫Ü‰ΩçÁΩÆ $a_1, a_2, ‚Ä¶, a_S‚Äã$ÔºåÈÇ£‰πàÊúâ‰∏ÄÂÆöÊ¶ÇÁéáÊª°Ë∂≥ÊâÄÊúâ $|p_{a_i} - q_{a_i}|‚Äã$ ÊûÑÊàêÁöÑÊï∞ÁöÑÈõÜÂêà $A‚Äã$ ‰∏é $|p_{a_i} - r_{a_i}|‚Äã$ ÊûÑÊàêÁöÑÊï∞ÁöÑÈõÜÂêà $B‚Äã$ ÂÆåÂÖ®Ê≤°Êúâ‰∫§ÈõÜÔºåÊ≠§Êó∂Âèñ $S = \frac{\sqrt n}{2}‚Äã$ ÂèØ‰ª•‰ΩøËØ•Ê¶ÇÁéáÊØîËæÉÂ§ßÔºàËØÅÊòéÂí±‰πü‰∏ç‰ºöÔºâ</p><p>ÂÅáÂÆöÊ≠§Êó∂Êª°Ë∂≥ $|A \cup B| = 2S‚Äã$ÔºåÂç≥Êª°Ë∂≥‰∏§‰∏™ÈõÜÂêàÊó†‰∫§ÔºåÈÇ£‰πàÊàë‰ª¨Áî± $A‚Äã$ ÂèØ‰ª•ÂØπÊØè‰∏™ $q_{a_i}‚Äã$ ÂæóÂà∞ÊúÄÂ§ö $2 \times S‚Äã$ ‰∏™ÂÆÉÂèØ‰ª•ÂåπÈÖçÁöÑ‰ΩçÁΩÆÔºåÂêåÊ†∑ÂØπ $B‚Äã$ ‰∏é $r_{a_i}‚Äã$ ‰πüÊòØ‰∏ÄÊ†∑ÔºåËøôÂÆûÈôÖ‰∏äÂ∞±ÂèòÊàê‰∫Ü‰∏Ä‰∏™‰∫åÂàÜÂõæÔºå‰∏∫‰∫ÜÊñπ‰æøÔºåÂ∞ÜÂÖ∂ÂèçËøáÊù•ËÆ∞ÔºåÂç≥ÊØèÊ¨°Áî± $A‚Äã$ ÂæóÂà∞ÊØè‰∏™ $q_{a_i}‚Äã$ ‰∏çÂèØËÉΩÂåπÈÖçÂà∞ÁöÑ‰ΩçÁΩÆÔºåÁÑ∂ÂêéÂú®‰∫åÂàÜÂõæ‰∏äÂ∞ÜËøô‰∫õËæπÂà†ÂéªÔºåÈÇ£‰πàÊúÄÁªàÊâæÂà∞Á≠îÊ°àÁöÑÊÉÖÂÜµÁ≠â‰ª∑‰∫é‰∫åÂàÜÂõæÂåπÈÖçÂÖ∑ÊúâÂîØ‰∏ÄÊÄßÔºåËøô‰∏™Áî®ÁΩëÁªúÊµÅÂíå $Tarjan‚Äã$ Áª¥Êä§‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><p>Ëøõ‰∏ÄÊ≠•‰ºòÂåñÔºåÈöèÊú∫Âá†Ê¨°‰πãÂêéÂèØËÉΩ‰∏Ä‰∫õ‰ΩçÁΩÆÂ∑≤ÁªèÁ°ÆÂÆö‰∫ÜÂîØ‰∏ÄÂåπÈÖçÊÄßÔºåÈÇ£‰πàÊØèÊ¨°ÈöèÊú∫ÈÄâ $S$ ‰∏™ÂÖÉÁ¥†ÁöÑÊó∂ÂÄô‰ºòÂÖàÈÄâËøòÊú™ÊàêÂäüÂåπÈÖçÁöÑ‰ΩçÁΩÆ</p><p>ÂÜçËÄÖÔºåÂú® $n$ ÊØîËæÉÂ∞èÊó∂ÂèØËÉΩÂæàÈöæÈöèÂà∞Á≠îÊ°àÔºåÂ∞±ÂèØ‰ª•Âú®ÂºÄÂ§¥Êó∂ÈöèÂçÅ‰∏™ $q$ÔºåÁÑ∂ÂêéÊØèÊ¨°ÈöèÊú∫‰ΩøÁî®ÂÖ∂‰∏≠‰∏Ä‰∏™ $q$ÔºåËøôÊ†∑ÂèØ‰ª•ÊØîËæÉÂ§ßÁöÑÊ¶ÇÁéáÈÅøÂÖçËøôÊ†∑ÁöÑÊÉÖÂÜµ</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"perm.h"</span></span></span><br><span class="line"><span class="comment">// #include "grader.cpp"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> graph &#123;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">800</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXM];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN], size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN], low[MAXN], bel[MAXN], ord = <span class="number">0</span>, bcc = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head)), size = ord = bcc = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) dfn[i] = low[i] = bel[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">stack</span>[MAXN], top = <span class="number">0</span>; <span class="keyword">bool</span> insta[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">dfn[u] = low[u] = ++ ord;</span><br><span class="line"><span class="built_in">stack</span>[++ top] = u, insta[u] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (! dfn[v]) &#123;</span><br><span class="line">Tarjan (v);</span><br><span class="line">low[u] = min (low[u], low[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (insta[v]) low[u] = min (low[u], dfn[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (low[u] == dfn[u]) &#123;</span><br><span class="line">bcc ++; <span class="keyword">int</span> tp;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">tp = <span class="built_in">stack</span>[top --];</span><br><span class="line">bel[tp] = bcc, insta[tp] = <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">while</span> (tp != u);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) <span class="keyword">if</span> (! dfn[i]) Tarjan (i);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">bool</span> con[<span class="number">1000</span>]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">namespace</span> net &#123;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">800</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, cap, next; &#125; ;</span><br><span class="line">LFS Link[MAXM];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].cap = cap;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Insert (u, v, cap), Insert (v, u, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, N, S, T;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123; <span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head)), size = <span class="number">1</span>; &#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que; <span class="keyword">int</span> depth[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) que.pop();</span><br><span class="line"><span class="built_in">memset</span> (depth, <span class="number">0</span>, <span class="keyword">sizeof</span> (depth));</span><br><span class="line">depth[S] = <span class="number">1</span>, que.push(S);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] || ! cap) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[u] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (v == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cur[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> flow)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (u == T) <span class="keyword">return</span> flow;</span><br><span class="line"><span class="keyword">int</span> rest = flow;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span>&amp; i = cur[u]; i &amp;&amp; rest; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] != depth[u] + <span class="number">1</span> || ! cap) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> k = Dinic (v, min (rest, cap));</span><br><span class="line"><span class="keyword">if</span> (! k) depth[v] = - <span class="number">1</span>;</span><br><span class="line">Link[i].cap -= k, Link[i ^ <span class="number">1</span>].cap += k;</span><br><span class="line">rest -= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow - rest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxflow</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (BFS ()) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cur[i] = Head[i];</span><br><span class="line">ret += Dinic (S, INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> match[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">graph::N = <span class="number">2</span> * n, graph::init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = Head[i]; j; j = Link[j].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[j].to, cap = Link[j].cap;</span><br><span class="line"><span class="keyword">if</span> (! cap) graph::Insert (i, match[i] = v);</span><br><span class="line"><span class="keyword">else</span> graph::Insert (v, i);</span><br><span class="line">&#125;</span><br><span class="line">graph::work ();</span><br><span class="line"><span class="keyword">bool</span> suc = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (graph::bel[i] == graph::bel[match[i]]) suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">else</span> con[i] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> suc;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">400</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> ext[MAXN][MAXN];</span><br><span class="line"><span class="keyword">int</span> N, S, B = <span class="number">10</span>;</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">trans</span> <span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p)</span> </span>&#123;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ret; ret.resize(N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) ret[p[i] - <span class="number">1</span>] = i + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">ask</span> <span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p)</span> </span>&#123; <span class="keyword">return</span> query (trans (p)); &#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; q[<span class="number">11</span>], r, rkc, rkd, rk;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; qq[<span class="number">11</span>], qr, f1, f2;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ret;</span><br><span class="line"><span class="keyword">int</span> cnt1[MAXN]= &#123;<span class="number">0</span>&#125;, cnt2[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">net::init (), net::n = N, net::N = <span class="number">2</span> * N + <span class="number">2</span>;</span><br><span class="line">net::S = <span class="number">2</span> * N + <span class="number">1</span>, net::T = <span class="number">2</span> * N + <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (ext[i][j]) net::addedge (i, j + N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) net::addedge (net::S, i, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) net::addedge (i + N, net::T, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vis1[MAXN], vis2[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = rand () % B + <span class="number">1</span>; rkc.clear();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) <span class="keyword">if</span> (! con[i + <span class="number">1</span>]) rkc.push_back(i);</span><br><span class="line">random_shuffle (rkc.begin(), rkc.end());</span><br><span class="line">rkd.clear(); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) <span class="keyword">if</span> (con[i + <span class="number">1</span>]) rkd.push_back(i);</span><br><span class="line">random_shuffle (rkd.begin(), rkd.end());</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) rkd.size(); i ++) rkc.push_back(rkd[i]);</span><br><span class="line">rk.clear(); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i ++) rk.push_back(rkc[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; S; i ++) swap (rk[i], rk[rand () % i]);</span><br><span class="line">r.resize(N); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) r[i] = q[p][i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i ++) r[rkc[i]] = q[p][rk[i]]; qr = ask (r);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) cnt1[i] = cnt2[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) cnt1[qq[p][i]] ++, cnt2[qr[i]] ++;</span><br><span class="line">f1.clear(), f2.clear();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">while</span> (cnt1[i] &gt; cnt2[i]) f1.push_back(i), cnt1[i] --;</span><br><span class="line"><span class="keyword">while</span> (cnt1[i] &lt; cnt2[i]) f2.push_back(i), cnt1[i] ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">int</span>) f1.size() != S || (<span class="keyword">int</span>) f2.size() != S) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x1 = q[p][rkc[i]], x2 = r[rkc[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) vis1[i] = vis2[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; S; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (x1 - f1[j] &gt;= <span class="number">1</span>) vis1[x1 - f1[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x1 + f1[j] &lt;= N) vis1[x1 + f1[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x2 - f2[j] &gt;= <span class="number">1</span>) vis2[x2 - f2[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x2 + f2[j] &lt;= N) vis2[x2 + f2[j]] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (! vis1[j] || ! vis2[j]) ext[rkc[i] + <span class="number">1</span>][j] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">build (); <span class="keyword">int</span> flow = net::maxflow ();</span><br><span class="line"><span class="keyword">if</span> (flow &lt; N) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (! net::check ()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret[net::match[i] - N - <span class="number">1</span>] = i;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">guess</span> <span class="params">(<span class="keyword">int</span> pn)</span></span>&#123;</span><br><span class="line">N = pn;</span><br><span class="line"><span class="keyword">if</span> (N &lt;= <span class="number">3</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret.push_back(i);</span><br><span class="line"><span class="keyword">while</span> (query (ret).back()) next_permutation (ret.begin(), ret.end());</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">srand (time (<span class="literal">NULL</span>));</span><br><span class="line">S = <span class="built_in">sqrt</span> (N) / <span class="number">2</span>; S = max (S, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) q[i].push_back(j);</span><br><span class="line">random_shuffle(q[i].begin(), q[i].end());</span><br><span class="line">qq[i] = ask (q[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">ext[i][j] = <span class="literal">true</span>;</span><br><span class="line">ret.resize(N); <span class="keyword">while</span> (! work ());</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// g++ grader.cpp perm.cpp -o perm -O2 -std=c++11</span></span><br></pre></td></tr></table></figure><h2 id="Problem-CÔºöÂ°î"><a href="#Problem-CÔºöÂ°î" class="headerlink" title="Problem CÔºöÂ°î"></a>Problem CÔºöÂ°î</h2>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> OEIS </tag>
            
            <tag> ‰∫§‰∫íÈ¢ò </tag>
            
            <tag> ÈöèÊú∫Âåñ </tag>
            
            <tag> ÁΩëÁªúÊµÅ </tag>
            
            <tag> Tarjan </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∏âÂçÅ‰∫îÔºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%94%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%94%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>$\text{scoreÔºö0 + 0 + 0 = 0            rkÔºö32/39}$</p><h2 id="Problem-AÔºöÊúÄÁü≠Ë∑Ø"><a href="#Problem-AÔºöÊúÄÁü≠Ë∑Ø" class="headerlink" title="Problem AÔºöÊúÄÁü≠Ë∑Ø"></a>Problem AÔºöÊúÄÁü≠Ë∑Ø</h2><h3 id="È¢òÈù¢"><a href="#È¢òÈù¢" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/29/uskNSrKd29XJQVq.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/29/FSp9RLq7WQkXEou.png" alt=""></p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËØ•Ë∑ØÂæÑ‰∏ÄÂÆöÊòØ‰ªé $1$ Ëµ∞Âà∞ $n$ ÂêéÔºåÂú®‰ªé $n$ ËøîÂõû $1$ Êó∂Âú®Â§ñÂõ¥Ëµ∞‰∏ÄÈÅ≠ÔºåÂÜçÂõûÂà∞ $1 \rightarrow n$ ÁöÑË∑ØÂæÑËµ∞‰∏ÄÊÆµÔºåÂÜçÂá∫ÂéªÂêë $1$ Ëµ∞‰∏ÄÊÆµ„ÄÇ„ÄÇ</p><p>ËÆæÂæÄÂ§ñÂõ¥Ëµ∞Êó∂ÁöÑËµ∑ÁÇπ‰∏∫ $a$ Á±ªÁÇπÔºåÂõûÂà∞ $1 \rightarrow n$ Ë∑ØÂæÑÁöÑÁÇπ‰∏∫ $b$ Á±ªÁÇπÔºåÂÆπÊòìÁü•ÈÅì $a$ Âíå $b$ ‰∫§ÈîôÂá∫Áé∞ÊâçÂèØËÉΩÊúÄ‰ºòÔºåÈÇ£‰πàÊï¥‰∏™ÂõæÂ§ßÊ¶ÇÂ∞±Ëøô‰πà‰∏™Ê†∑ÔºàËµ∑ÁÇπÂíåÁªàÁÇπ‰∏ç‰ΩúÊ†áËÆ∞Ôºâ</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/29/1OtoEkzY6W78NwX.png" alt=""></p><p>‰ª§ $f_{i, j}$ Ë°®Á§∫‰ªé $1$ Ëµ∞Âà∞ $i$ÔºåÊúÄÂêé‰∏Ä‰∏™ÁÇπ‰∏∫ $i$Ôºå‰∏∫ $a$ Á±ªÁÇπÔºåÂÄíÊï∞Á¨¨‰∫å‰∏™ÁÇπ‰∏∫ $j$Ôºå‰∏∫ $b$ Á±ªÁÇπ</p><p>‰ª§ $g_{i, j}$ Ë°®Á§∫‰ªé $1$ Ëµ∞Âà∞ $i$ÔºåÊúÄÂêé‰∏Ä‰∏™ÁÇπ‰∏∫ $i$Ôºå$i, j$  ÈÉΩ‰∏∫ $b$ Á±ªÁÇπ</p><p>ÂÆûÈôÖ‰∏ä $f$ ÂèØ‰ª•Áõ¥Êé•ËΩ¨ÁßªÔºå‰∏çÈúÄË¶Å $g$Ôºå‰ΩÜËøôÊ†∑Â§çÊùÇÂ∫¶Êó∂ $O (n^4)$ ÁöÑÔºåÊïÖ $g$ Áõ∏ÂΩì‰∫éËæÖÂä©ÂáΩÊï∞</p><p>Áî®Á±ª‰ºº $Dijkstra$ ÁöÑÂΩ¢ÂºèËΩ¨ÁßªÔºåËÆæ $i$ Âà∞ $j$ ÁöÑÊúÄÁü≠Ë∑ØÂæÑ‰∏∫ $d_{i, j}$ÔºàÂç≥‰ΩøË∑ØÂæÑ‰∏äÊâÄÊúâÁÇπÁöÑÊùÉÂÄºÂíåÊúÄÂ∞èÔºåÂåÖÊã¨ $i, j$Ôºâ</p><p>ÂÅáËÆæÊ≠§Êó∂ÂèñÂá∫ $f_{x, y}$ ÂàôÊúâ<br>$$<br>g_{k, y} = \min\{f_{x, y} + d_{x, k} - p_x\}<br>$$<br>Âç≥Â§öÂá∫‰∏Ä‰∏™ $a$ Á±ªÁÇπ $x$ Âà∞ $b$ Á±ªÁÇπ $k$ ÁöÑË∑ØÂæÑ</p><p>ÂÅáËÆæÊ≠§Êó∂ÂèñÂá∫ $g_{x, y}$ÔºåÂàôÊúâ<br>$$<br>f_{k, x} = \min \{g_{x, y} + d_{x, k} + d_{k, y} - p_x - p_y - p_k\}<br>$$<br>Áõ¥Êé•Áî®Â†ÜÁª¥Êä§ÊòØ $O (n^3 \log n)$ ÁöÑÔºå‰ΩÜËßÇÂØü‰∏Ä‰∏ãÂèëÁé∞Âú® $j$ Áõ∏ÂêåÊó∂ÔºåÊØèÊ¨°ÂèØ‰ª•Êûö‰∏æÂèñÊúÄÂ∞èÂÄºÔºåÊïÖÊúÄÁªàÂ§çÊùÇÂ∫¶ $O (n^3)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">250</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;, d[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN], g[MAXN][MAXN];</span><br><span class="line"><span class="keyword">bool</span> visit[<span class="number">2</span>][MAXN][MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> val, x, y;</span><br><span class="line">node (<span class="keyword">int</span> val = <span class="number">0</span>, <span class="keyword">int</span> x = <span class="number">0</span>, <span class="keyword">int</span> y = <span class="number">0</span>) : val (val), x (x), y (y) &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">node maxf[MAXN], maxg[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getm</span> <span class="params">(node&amp; a, node b)</span> </span>&#123; <span class="keyword">if</span> (b.val &lt; a.val) a = b; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">workf</span> <span class="params">(<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">maxf[j] = node (INF, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! visit[<span class="number">0</span>][i][j])</span><br><span class="line">getm (maxf[j], node (f[i][j], i, j));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">workg</span> <span class="params">(<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">maxg[j] = node (INF, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! visit[<span class="number">1</span>][i][j])</span><br><span class="line">getm (maxg[j], node (g[i][j], i, j));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (d, INF, <span class="keyword">sizeof</span> (d));</span><br><span class="line"><span class="built_in">memset</span> (f, INF, <span class="keyword">sizeof</span> (f));</span><br><span class="line"><span class="built_in">memset</span> (g, INF, <span class="keyword">sizeof</span> (g));</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123; a[i] = getnum (); d[i][i] = a[i]; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">d[u][v] = a[u] + a[v];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">d[i][j] = min (d[i][j], d[i][k] + d[k][j] - a[k]);</span><br><span class="line"><span class="keyword">if</span> (d[<span class="number">1</span>][N] &gt;= INF || d[N][<span class="number">1</span>] &gt;= INF) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">f[<span class="number">1</span>][<span class="number">1</span>] = a[<span class="number">1</span>]; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) workf (i), workg (i);</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">node mf, mg; mf = mg = node (INF, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) getm (mf, maxf[i]), getm (mg, maxg[i]);</span><br><span class="line"><span class="keyword">int</span> type = mf.val &lt;= mg.val ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">getm (mf, mg);</span><br><span class="line"><span class="keyword">if</span> (mf.val &gt;= INF) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">int</span> x = mf.x, y = mf.y;</span><br><span class="line"><span class="keyword">if</span> (type) &#123;</span><br><span class="line">visit[<span class="number">1</span>][x][y] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">if</span> (k != y)</span><br><span class="line">f[k][x] = min (f[k][x], g[x][y] + d[x][k] + d[k][y] - a[x] - a[y] - a[k]);</span><br><span class="line">workf (x), workg (y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">visit[<span class="number">0</span>][x][y] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line">g[k][y] = min (g[k][y], f[x][y] + d[x][k] - a[x]);</span><br><span class="line">workf (y), workg (y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; f[N][N] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> ÊúÄÁü≠Ë∑ØDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅÔºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÂàùÊù•‰πçÂà∞Ôºå4h20minÁöÑÈ¢òÊàëÊâì‰∫Ü2hÔºåÊàêÂäüÂû´Â∫ïÔºåÊÅ≠ÂñúÊàëËá™Â∑±</p><p>$\text{scoreÔºö20 + 0 + 0 = 20   rkÔºö26/27}$</p><h2 id="Problen-A"><a href="#Problen-A" class="headerlink" title="Problen A"></a>Problen A</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p><img src= "/img/loading.gif" data-lazy-src="http://xsy.gdgzez.com.cn/JudgeOnline/upload/attachment/image/20200701/20200701213322_88297.png" alt=""></p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>Áúã‰ªñ‰ª¨ÈÉΩ‰ºöÂÜô„ÄÇ„ÄÇËøôÁßçÊØîËæÉÂ§çÊùÇÁöÑÂÆπÊñ•ÊàëÂá†‰πéÈÉΩÊ≤°ÂÜôËøá„ÄÇ„ÄÇ</p><h4 id="ÂâçÁΩÆÁü•ËØÜÔºöÈ´òÁª¥ÂâçÁºÄÂíå"><a href="#ÂâçÁΩÆÁü•ËØÜÔºöÈ´òÁª¥ÂâçÁºÄÂíå" class="headerlink" title="ÂâçÁΩÆÁü•ËØÜÔºöÈ´òÁª¥ÂâçÁºÄÂíå"></a>ÂâçÁΩÆÁü•ËØÜÔºöÈ´òÁª¥ÂâçÁºÄÂíå</h4><p>‰∏æ‰∏™‰æãÂ≠êÔºåÂØπÊØîÂ¶ÇÁé∞Âú®Ë¶ÅÊ±ÇËß£ $\sum\limits_{s = 0}^{2^n - 1}\sum\limits_{j \in s} a_j$ÔºàÊ≠§Â§Ñ $\in$ ÊòØ‰∫åËøõÂà∂Ë°®Á§∫‰∏ãÁöÑÊÑè‰πâÔºâÔºåÁõ¥Êé•Êûö‰∏æÂ≠êÈõÜÊòØ $O (3^n)$ ÁöÑÔºåÈÇ£‰πàÈ´òÁª¥ÂâçÁºÄÂíåÂèØ‰ª•‰ºòÂåñÂà∞ $O (n2^n)$</p><p>ËÄÉËôë‰Ωé‰ΩçÂâçÁºÄÂíåÔºåÊØîÂ¶Ç‰∏â‰ΩçÔºåÊàë‰ª¨ÊòØ‰∏çÊòØÂèØ‰ª•Ëøô‰πàÂÜô</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k ++)</span><br><span class="line">            a[i][j][k] += a[i - <span class="number">1</span>][j][k]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k ++)</span><br><span class="line">            a[i][j][k] += a[i][j - <span class="number">1</span>][k]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k ++)</span><br><span class="line">            a[i][j][k] += a[i][j][k - <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>Â∞±ÊòØÂØπÊØè‰∏ÄÁª¥ÂàÜÂà´Ê±ÇÂâçÁºÄÂíåÔºåÈÇ£‰πàÈ´òÁª¥ÂâçÁºÄÂíå‰πüÊòØËøô‰∏™ÊÄùÊÉ≥ÔºåÂç≥ $f_{s \oplus (1 &lt;&lt; j)} \rightarrow f_s$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> limit = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt;= limit; s ++)</span><br><span class="line">        <span class="keyword">if</span> (s &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)))</span><br><span class="line">            f[s] += f[s ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))];</span><br></pre></td></tr></table></figure><h4 id="ÂõûÂà∞Ê≠£È¢ò"><a href="#ÂõûÂà∞Ê≠£È¢ò" class="headerlink" title="ÂõûÂà∞Ê≠£È¢ò"></a>ÂõûÂà∞Ê≠£È¢ò</h4><p>‰ª§ $|s|$ Ë°®Á§∫ $s$ ÁöÑ‰∫åËøõÂà∂Ë°®Á§∫‰∏ã $1$ ÁöÑ‰∏™Êï∞</p><p>ËÆæ $g_s$ Ë°®Á§∫ÊûÑÊàêÊúÄÁªàÁä∂ÊÄÅ $s$ ÁöÑÊñπÊ°àÊï∞Ôºå$f_s$ Ë°®Á§∫Áä∂ÊÄÅ $s$ ‰∫åËøõÂà∂Ë°®Á§∫‰∏≠ÁöÑ‰∏∫ $0$ ‰ΩçÁöÑÂç°Áâá<strong>Ëá≥Â∞ë</strong>‰∏çÂ≠òÂú®‰∫éÊúÄÁªàÊî∂ËóèÁöÑÊñπÊ°àÊï∞ÔºåÈÇ£‰πàÂÆπÊñ•‰∏Ä‰∏ãÊúâ<br>$$<br>g_s = \sum\limits_{j \in s} f_j \times (-1)^{|s - j|}ÔºàÊ†πÊçÆÂ§öÂá∫Êù•ÁöÑ 0 ÁöÑ‰∏™Êï∞ËøõË°åÂÆπÊñ•Ôºâ<br>$$<br>ÈÇ£‰πàÁé∞Âú®ËÄÉËôëÊ±Ç $f_s$</p><p>ÂÖàËÄÉËôëÊö¥ÂäõËÆ°ÁÆóÔºåÊûö‰∏æ $s$ÔºåÂ∞ÜÊØè‰∏ÄËΩÆÊª°Ë∂≥Áõ∏‰ΩçÁΩÆÊòØÈõ∂ÁöÑÁªÑÂêàÁöÑÊ¶ÇÁéáÂä†Ëµ∑Êù•‰∏∫ $sum_i$ÔºåÊúÄÂêéÂàôÊúâ $f_s = \prod sum_i$ÔºåËøôÊ†∑ÊòæÁÑ∂‰ºö $T$</p><p>ÂØπÊØè‰∏ÄËΩÆÔºåÂèØËÉΩÊª°Ë∂≥ÁöÑÁªÑÂêàÁöÑÁªÑÂêàÂÖ±Êúâ $2^k$ ÁßçÔºåÁé∞Âú®ËÄÉËôëËøô $2^k$ ÁßçÂèØËÉΩÊÄßÂàÜÂà´ÈÉΩË¥°ÁåÆÂà∞Âì™ÂÑø‰∫Ü</p><p>ËÆæÂØπ‰∫éÂΩìÂâçÂèñ $2^k$ ÁßçÁä∂ÊÄÅ‰∏≠ÁöÑ‰∏ÄÁßçÊâÄË°®Á§∫Âá∫ÁöÑ‰∫åËøõÂà∂Áä∂ÊÄÅ‰∏∫ $s$ÔºåËØ•ÁßçÁªÑÂêàÁöÑÁªÑÂêàÂØπÂ∫îÁöÑÂç°ÁâáÈõÜÂêà $card_s$ÔºåÊ¶ÇÁéáÂíå $p_s$ÔºåÈÇ£‰πàÂæàÊòéÊòæÂÆÉÂèØ‰ª•Ë¥°ÁåÆÂà∞ÁöÑÂ∞±ÊòØ $card_s$ ÁöÑË∂ÖÈõÜÔºåÂΩìÁÑ∂Áî±‰∫éÂÆÉÂ≠êÈõÜ‰πü‰ºöË¥°ÁåÆÂà∞ÈÇ£‰∫õË∂ÖÈõÜÔºåÊïÖËøòÈúÄÂÆπÊñ•ÊéâÔºåËÆæÂÆÉ‰ΩøË∂ÖÈõÜÈúÄË¶Å‰πò‰∏äÊï∞ $L_{card_s}$<br>$$<br>L_{card_s} = \prod\limits_{j \in s} p_j^{(- 1)^{|s - j|}}<br>$$<br>‰πãÂêéÂ∞±ÂèØ‰ª•ÈÄöËøáËÆ°ÁÆóÂ≠êÈõÜÁªô $f_s$ ÁöÑË¥°ÁåÆÁõ¥Êé•Ê±ÇÂá∫ $f_s$ ‰∫Ü</p><p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂΩì $j$ ÂèñÁ©∫ÈõÜÁöÑÊó∂ÂÄôÔºå$p_j = 0$ÔºåËÄå $p_j$ ÂèàÊúâÂèØËÉΩË¢´‰Ωú‰∏∫Èô§Êï∞ÔºåÊïÖÊ≠§Êó∂ÈúÄË¶ÅÂºÄ‰∏Ä‰∏™Êï∞ÁªÑËÆ°ÁÆóÂà∞Ê≠§‰∏∫Ê≠¢Á©∂Á´ü‰πòÂíåÈô§‰ª•‰∫ÜÂ§öÂ∞ë‰∏™Èõ∂ÔºåËã•ÊúÄÁªà‰πòÁöÑÊ¨°Êï∞Â§öÔºåÂàôÁõ¥Êé•Â∞Ü $f_s$ ËµãÈõ∂</p><p>ÊúÄÂêé‰∏ÄÈÅçÂÆπÊñ•Ê±ÇÂá∫ $g_s$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">10</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> KTRS = <span class="number">1</span> &lt;&lt; <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="keyword">int</span> mp[MAXM]= &#123;<span class="number">0</span>&#125;, pcnt[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD, p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> a[MAXK], p[MAXK];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> suma[KTRS]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sump[KTRS]= &#123;<span class="number">0</span>&#125;, undp[KTRS]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> zocnt[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL f[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL g[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">int</span> lim = (<span class="number">1</span> &lt;&lt; M) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= lim; i ++) mp[i] = mp[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lim; i ++) pcnt[i] = pcnt[i &gt;&gt; <span class="number">1</span>] + (i &amp; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= lim; i ++) f[i] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> K = getnum (), d = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) &#123;</span><br><span class="line">a[j] = getnum (), p[j] = getnum ();</span><br><span class="line">d += p[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> poe = power (<span class="number">1l</span>l * d, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) p[j] = <span class="number">1l</span>l * p[j] * poe % MOD;</span><br><span class="line"><span class="keyword">int</span> lik = (<span class="number">1</span> &lt;&lt; K) - <span class="number">1</span>;</span><br><span class="line">sump[<span class="number">0</span>] = undp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= lik; j ++) &#123;</span><br><span class="line">suma[j] = suma[j ^ lowbit (j)] | a[mp[lowbit (j)]];</span><br><span class="line">sump[j] = (sump[j ^ lowbit (j)] + p[mp[lowbit (j)]]) % MOD;</span><br><span class="line">undp[j] = power (sump[j], MOD - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">sump[<span class="number">0</span>] = undp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span> &lt;&lt; j;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= lik; k ++)</span><br><span class="line"><span class="keyword">if</span> (k &amp; l) &#123;</span><br><span class="line">sump[k] = sump[k] * undp[k ^ l] % MOD;</span><br><span class="line">undp[k] = undp[k] * sump[k ^ l] % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">zocnt[<span class="number">0</span>] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= lik; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (pcnt[j] &amp; <span class="number">1</span>) zocnt[suma[j]] --;</span><br><span class="line"><span class="keyword">else</span> zocnt[suma[j]] ++;</span><br><span class="line">f[suma[j]] = f[suma[j]] * sump[j] % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span> &lt;&lt; i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= lim; j ++)</span><br><span class="line"><span class="keyword">if</span> (j &amp; l) &#123;</span><br><span class="line">f[j] = f[j] * f[j ^ l] % MOD;</span><br><span class="line">zocnt[j] += zocnt[j ^ l];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= lim; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (zocnt[i] &gt; <span class="number">0</span>) g[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> g[i] = f[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span> &lt;&lt; i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= lim; j ++)</span><br><span class="line"><span class="keyword">if</span> (j &amp; l) g[j] = (g[j] - g[j ^ l] + MOD) % MOD; <span class="comment">// Ê≥®ÊÑèËøôÈáå‰ΩøÂÆπÊñ•ÔºåÊüê‰∏™g[j]Ë¢´Âáè‰∏§Ê¨°ÂàôÂèòÊàêÂä†</span></span><br><span class="line">&#125;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= lim; j ++) ans ^= g[j];</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-B"><a href="#Problem-B" class="headerlink" title="Problem B"></a>Problem B</h2><h3 id="ÈóÆÈ¢òÊèèËø∞"><a href="#ÈóÆÈ¢òÊèèËø∞" class="headerlink" title="ÈóÆÈ¢òÊèèËø∞"></a>ÈóÆÈ¢òÊèèËø∞</h3><p>ÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ $m$ Êù°ËæπÁöÑËøûÈÄöÊó†ÂêëÂõæÔºåËæπ‰∏äÊúâËæπÊùÉÔºåÊ±ÇËØ•Êó†ÂêëÂõæÁöÑÊúÄÂ∞èÁõ¥ÂæÑÁîüÊàêÊ†ëÔºåÂÖ∂ÂÖ∑ÊúâÊúÄÂ∞èÁöÑÁõ¥ÂæÑ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>$1 \le n \le 500, ~ n - 1 \le m \le \frac{n(n - 1)}{2}, ~ 1 \le ËæπÊùÉ \le 10^9$</p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËøôÁé©ÊÑèÂÑøÂ•ΩÂÉèÂíåÊ±Ç‰ªÄ‰πàÂõæÁöÑÁªùÂØπ‰∏≠ÂøÉÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂõæÁöÑÁªùÂØπ‰∏≠ÂøÉÂ∞±ÊòØÊåá‰∏Ä‰∏™‰∏≠ÂøÉÔºåÂà∞ÊúÄËøúÁöÑÁÇπË∑ØÂæÑÊúÄÁü≠</p><p>ÈÇ£Â∞±ÈÄöËøáÂõæÁöÑÁªùÂØπ‰∏≠ÂøÉÊù•Ê±ÇËß£ËøôÈÅìÈ¢ò</p><p>ÂÅáËÆæÊîπÂõæÁöÑÁªùÂØπ‰∏≠ÂøÉ‰∏∫ÁÇπ $p$ÔºåÈÇ£‰πàÂÆÉÂèØ‰ª•ÊòØÊüêÊù°ËæπÁöÑÁ´ØÁÇπ‰πüÂèØ‰ª•Âú®ÊüêÊù°Ëæπ‰∏ä</p><p>È¶ñÂÖàÊúâ‰∏Ä‰∏™ÁªìËÆ∫</p><blockquote><p>Ë∑ùÁ¶ª $p$ ÊúÄËøúÁöÑÁÇπËá≥Â∞ëÊúâ‰∏§‰∏™ÁÇπ $u, v$ÔºåÂπ∂‰∏îÂÆÉ‰ª¨Âà∞ $p$ ÁöÑË∑ùÁ¶ªÁõ∏Á≠â</p></blockquote><p>ËøôÊù°ÁªìËÆ∫ÂæàÂÆπÊòìËØÅÊòéÔºåËã• $dis (u, p) \ne dis (v, p)$ÔºåÈÇ£‰πàÂ∞ÜÁÇπ $p$ ÂæÄËæÉËøúÁöÑÈÇ£‰∏™Á´ØÁÇπÁ®çÂæÆÁßªÂä®‰∏Ä‰∏ãÂç≥ÂèØÂæóÂà∞Êõ¥‰ºòÁöÑÁ≠îÊ°àÊ≠§Êó∂ÂÅáÂÆö $p$ Âú®Ëæπ $(u, v)$ ‰∏äÔºå$(u, v)$ Èïø $L$Ôºå$p$ Ë∑ùÁ¶ªÁÇπ $u$ ‰∏∫ $x$ÔºåÈÇ£‰πà‰ªªÊÑè‰∏ÄÁÇπ $s$ Âà∞ $p$ ÁöÑË∑ùÁ¶ªÂç≥‰∏∫ $\min(dis (s, u) + x, dis (s, v) + L - x)$</p><p>ÂèØ‰ª•ÂèëÁé∞ÔºåËøô‰∏™Ë∑ùÁ¶ª‰ª•ÂáΩÊï∞ÂΩ¢ÂºèË°®Á§∫Âá∫Êù•ÊòØ‰∏ÄÊù°ÊäòÁ∫øÔºà‰∏äÂçáÈÉ®ÂàÜÊñúÁéá‰∏∫ $1$Ôºå‰∏ãÈôçÈÉ®ÂàÜ $- 1$Ôºâ</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/13/Fn3jhbO9fVvUz2B.jpg" alt=""></p><p>ÔºàÂõæÊ∫êÊù•Ëá™ËÆ∫Êñá„ÄäPlay with Trees Solutions„ÄãÔºâ</p><p>ÁÑ∂Âêé‰Ω†Â∞±ÂèØ‰ª•ÊêûÂá∫ $n$ Êù°ÊäòÁ∫øÔºåÂÖ∂‰∏≠Ê®™ÂùêÊ†áÂØπÂ∫îÊØè‰∏ÄÁßç $x$ ÁöÑÂèñÂÄºÔºåÊâÄ‰ª•Âêå‰∏Ä $x$ ÂùêÊ†áÂØπÂ∫îÂêå‰∏Ä‰∏™‰∏≠ÂøÉ</p><p>ËÄåË¶ÅÊ±ÇÁöÑÊòØÊâÄÊúâË∑ùÁ¶ª‰∏≠ÁöÑÊúÄÂ§ßÂÄºÔºåËøôÂØπÂ∫îÂÆûÁ∫øÈÉ®ÂàÜ</p><p>‰Ω†ÂèàË¶Å‰øùËØÅÊúÄÂ§ßÁöÑÊúÄÂ∞èÔºåÊïÖÂè™ÈúÄÂú®ÂÆûÁé∞ÈÉ®ÂàÜÂèñÊúÄÂ∞èÂç≥‰∏∫Á≠îÊ°àÔºåÈÄöËøáÂõæÂÉèÂèØ‰ª•ÁúãÂá∫ÔºåËØ•ÊúÄÂ∞èÂÄºÁÇπ‰∏ÄÂÆö‰∏∫Êüê‰∏§Êù°ÊäòÁ∫øÁöÑ‰∫§ÁÇπ</p><p>ÈÇ£‰πàÂ∞±ÂèØ‰ª•Êûö‰∏æÊâÄÊúâÁÇπÂØπ $(u, v)$ÔºåÂπ∂Êåâ $dis_{u, s}$ ËøõË°åÊéíÂ∫èÔºåÁî®Êâ´ÊèèÁöÑÂÅöÊ≥ïÊ±ÇËß£‰∫Ü</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">500</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL f[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> rnk[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">f[i][j] = f[j][i] = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">f[u][v] = f[v][u] = w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">f[i][j] = min (f[i][j], f[i][k] + f[k][j]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) rnk[i][j] = j;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = j + <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">if</span> (f[i][rnk[i][j]] &gt; f[i][rnk[i][k]])</span><br><span class="line">swap (rnk[i][j], rnk[i][k]);</span><br><span class="line">&#125;</span><br><span class="line">LL ans = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> u = <span class="number">1</span>; u &lt;= N; u ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">1</span>; v &lt;= N; v ++) &#123;</span><br><span class="line">ans = min (ans, f[u][rnk[u][N]] &lt;&lt; <span class="number">1</span>); <span class="comment">// ‰∏≠ÂøÉÂèñÁ´ØÁÇπÂ§Ñ</span></span><br><span class="line">ans = min (ans, f[v][rnk[v][N]] &lt;&lt; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> k = N;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">if</span> (f[v][rnk[u][i]] &gt; f[v][rnk[u][k]]) &#123; <span class="comment">// Âà§Êñ≠‰∏§ÊäòÁ∫øÊòØÂê¶Êúâ‰∫§</span></span><br><span class="line">ans = min (ans, f[u][rnk[u][i]] + f[u][v] + f[v][rnk[u][k]]);</span><br><span class="line">k = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-C"><a href="#Problem-C" class="headerlink" title="Problem C"></a>Problem C</h2>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊÄùÁª¥ </tag>
            
            <tag> ÂÆπÊñ•ÂéüÁêÜ </tag>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> ÁîüÊàêÊ†ë </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅÂõõÔºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÊàêÂäüÁî±Âû´Â∫ïËΩ¨Ëá≥‰∏≠‰∏ãÊ∞¥Âπ≥„ÄÇ„ÄÇ</p><p>ÊÅ≠Âñú„ÄÇ„ÄÇÊàëÔºü</p><p>$\text{scoreÔºö55 + 0 + 0 = 55   rkÔºö21/33}$</p><h2 id="Problem-AÔºöÁåúÊÉ≥"><a href="#Problem-AÔºöÁåúÊÉ≥" class="headerlink" title="Problem AÔºöÁåúÊÉ≥"></a>Problem AÔºöÁåúÊÉ≥</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/11/lzHy4UCcSLXmiVD.png" alt=""></p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ‰∫éÊâÄÊúâÊµãËØïÊï∞ÊçÆÔºåËÆ∞ $l$ Ë°®Á§∫ $n$ ÁöÑÈïøÂ∫¶ÔºåÂàô $1 \le l \le 2 \times 10^5$Ôºå‰øùËØÅ $n$ ÁöÑÊúÄÈ´ò‰Ωç‰∏∫ $1$Ôºå‰∏îÈô§Ê≠§‰πãÂ§ñÁöÑ $l - 1$ ‰Ωç‰ΩøÁî® $\text{std::mt19937}$ ÈöèÊú∫ÁîüÊàê</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËÄÉÂú∫‰∏äÊï≤‰∫Ü‰∏™ $55$ ÂàÜÁöÑÊö¥ÂäõÔºåÊú¨Êù•ÊÉ≥ËØ¥ÁúãËÉΩ‰∏çËÉΩÊûö‰∏æÊØè‰∏Ä‰ΩçÁÑ∂ÂêéÁõ¥Êé•ÁÆóÂÆÉÁöÑÁä∂ÊÄÅÔºåÁÑ∂Âêé‰∏çË°å</p><p>Âá∫È¢ò‰∫∫Êèê‰æõÁöÑÈ¢òËß£Ê≤°ÁúãÊáÇÔºåÂ∞±Áúã‰∫ÜÁúãÂÖ∂‰ªñ $A$ ÊéâÁöÑ‰∫∫ÁöÑÊÄùË∑Ø</p><p>È¶ñÂÖàËÄÉËôëÂàÜÂùóÔºå‰ΩøÂàÜÂá∫ÁöÑÂùóÂ∞ΩÈáèÂ§ßÔºåÂèñÂùóÂ§ßÂ∞è $L = 24$ÔºåÂØπÊØè‰∏ÄÂùóÂàÜÂà´Â§ÑÁêÜ</p><p>Â§ÑÁêÜÂΩìÂâçÂùóÊó∂ÂÖà‰∏çËÄÉËôëÂè≥ÁßªÂà† $0$ ÁöÑÊÉÖÂÜµÔºåÂÖàÂè™ËÄÉËôë‰πò‰∏âÂä†‰∏ÄÁöÑÊÉÖÂÜµÔºåÊúÄÂêéÂè™Ë¶ÅÂú®Á≠îÊ°à‰∏äÂä†‰∏ä‰∫åËøõÂà∂‰ΩçÊÄªÊï∞Âç≥ÂèØ</p><p>ËÆæÁ¨¨ $i$ ÂùóÂÇ®Â≠òÁöÑÊï∞‰∏∫ $a_i$</p><p>Á±ª‰ººÁ∫øÊÆµÊ†ëÂ§ÑÁêÜ‰πòÊ≥ïÊó∂ÁöÑÊìç‰ΩúÔºåËÆ∞‰∏§‰∏™ÂèòÈáè $mul, add$ ËÆ∞ÂΩïÊÄªÂÖ±‰πò‰∫ÜÂ§öÂ∞ëÔºåÊÄªÂÖ±Ëøõ‰ΩçÂ§öÂ∞ëÔºåÈÇ£‰πàËΩ¨ÁßªÂà∞ $a_j$ Êó∂ÂàôÊúâ $a_j = mul * a_j + add$Ôºå‰ª•Ê≠§Á±ªÊé®</p><p>ÁªÜËäÇÂ∞±Áúã‰ª£Á†ÅÂêß</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">24</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">char</span> str[MAXN];</span><br><span class="line"></span><br><span class="line">LL a[MAXN]= &#123;<span class="number">0</span>&#125;, bn = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">lowbit</span> <span class="params">(LL x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; bn; i ++) &#123;</span><br><span class="line">LL mul = <span class="number">1</span>, add = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (a[i]) &#123;</span><br><span class="line">mul *= <span class="number">3</span>, add *= <span class="number">3</span>;</span><br><span class="line">a[i] = a[i] * <span class="number">3</span> + lowbit (a[i]); <span class="comment">// Ê≠§Â§ÑÁî±‰∫éÊ≤°Âà†0ÊïÖÂä†‰∏äÁöÑÊòØlowbit</span></span><br><span class="line">add += a[i] &gt;&gt; L; a[i] &amp;= (<span class="number">1</span> &lt;&lt; L) - <span class="number">1</span>; <span class="comment">// ‰øùÊåÅa[i]Âè™ÊúâL‰ΩçÔºåÂêåÊó∂ËÆ°ÁÆóËøõ‰Ωçadd</span></span><br><span class="line">ans ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= bn; j ++) &#123;</span><br><span class="line">a[j] = a[j] * mul + add;</span><br><span class="line">add = a[j] &gt;&gt; L; a[j] &amp;= (<span class="number">1</span> &lt;&lt; L) - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (add) &#123; a[++ bn] = add &amp; ((<span class="number">1</span> &lt;&lt; L) - <span class="number">1</span>); add &gt;&gt;= L; &#125;</span><br><span class="line">ans += L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (a[bn] ^ <span class="number">1</span>) &#123;</span><br><span class="line">a[bn] = a[bn] &amp; <span class="number">1</span> ? a[bn] * <span class="number">3</span> + <span class="number">1</span> : a[bn] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">ans ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>);</span><br><span class="line">N = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (N == <span class="number">1</span> &amp;&amp; str[<span class="number">1</span>] == <span class="string">'1'</span>) &#123; <span class="built_in">puts</span> (<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">reverse (str + <span class="number">1</span>, str + N + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! ((i - <span class="number">1</span>) % L)) bn ++;</span><br><span class="line">a[bn] |= (str[i] - <span class="string">'0'</span>) &lt;&lt; ((i - <span class="number">1</span>) % L);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; solve () &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöË¶ÜÁõñ"><a href="#Problem-BÔºöË¶ÜÁõñ" class="headerlink" title="Problem BÔºöË¶ÜÁõñ"></a>Problem BÔºöË¶ÜÁõñ</h2><h3 id="È¢òÈù¢"><a href="#È¢òÈù¢" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/02/LuFUy4JASC3b1VZ.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/02/fe1ZOXTEyudg6m7.png" alt=""></p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËøûÁ•û‰ªôÈÉΩËØ¥Á•û‰ªôÁöÑÁ•û‰ªôÈ¢ò</p><p>ËÆæ $S_i$ Ë°®Á§∫ÁÇπ $i$ ËøûÊé•ÁöÑÁÇπÁöÑÈõÜÂêà</p><p>‰ªéÂ∞èÈóÆÈ¢òÂºÄÂßãÊÄùËÄÉÔºåËÄÉËôëÁÇπ $1, 2$ÔºåËã•Êúâ $S_1 - \{2\} \neq S_2 - \{1\}$ÔºåÈÇ£‰πà‰∫§Êç¢ËäÇÁÇπ $1, 2$ ÁöÑÊ†áÂè∑ÂæóÂà∞‰∏ÄÂº†Êñ∞Êó†ÂêëÂõæÔºåÂèØ‰ª•ÂèëÁé∞ÂÆÉ‰ª¨ÁöÑÊúÄÂ∞èÁÇπË¶ÜÁõñ‰∏ÄÂÆöÊòØÁõ∏ÂêåÁöÑÔºåÈÇ£‰πàÂÆÉ‰ª¨ÁöÑË¥°ÁåÆÂíåÂú® $\text{mod} ~~ 2$ ÁöÑÊÉÖÂÜµ‰∏ã‰∏ÄÂÆöÊòØ $0$Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂØπÁ≠îÊ°àÊúâË¥°ÁåÆÁöÑÊó†ÂêëÂõæ‰∏ÄÂÆöÊª°Ë∂≥ $\forall u, v, S_u - \{v\} = S_v - \{u\}$</p><p>Êé•‰∏ãÊù•ËÄÉËôë $S_1 - \{2\} = S_2 - \{1\}$ ÁöÑÊÉÖÂÜµÔºåÂàÜÁ±ªËÆ®ËÆ∫</p><ul><li>Ëã•Â≠òÂú®Ëæπ $(1, 2)$ÔºåÂàôËØ¥Êòé $1, 2$ ‰∏≠ÂøÖÈ°ªÂ≠òÂú®Ëá≥Â∞ë‰∏Ä‰∏™ÁÇπÂä†ÂÖ•Ë¶ÜÁõñÁÇπÔºåÂê¶ÂàôËæπ $(1, 2)$ Â∞±‰∏ÄÂÆö‰∏ç‰ºöË¢´Ë¶ÜÁõñÂà∞Ôºå‰∏çÂ¶®Âº∫Âà∂Ê†áÂè∑Â∞èÁöÑÈÇ£‰∏™Âä†ÂÖ•Ë¶ÜÁõñÁÇπÔºåÂÜçÂà†ÂéªÊâÄÊúâ‰∏é‰πãÁõ∏ËøûÁöÑËæπÔºåÈÇ£‰πàÂ±ÄÈù¢Â∞±ÂèòÊàê‰∫Ü $n‚Äô = n - 1, k‚Äô = k - 1$ ÁªßÁª≠ÊêûÊúÄÂ∞èÁÇπË¶ÜÁõñ</li><li>Ëã•‰∏çÂ≠òÂú®Ëæπ $(1, 2)$ÔºåÈÇ£‰πàÂèØ‰ª•ÈÄâÊã© $S_1$ ‰∏≠ÊâÄÊúâÁÇπÂä†ÂÖ•Ë¶ÜÁõñÁÇπÊàñ $1, 2$ ÂêåÊó∂Âä†ÂÖ•Ë¶ÜÁõñÁÇπÔºå‰πüÂ∞±ÊòØËØ¥ÂÆÉ‰ª¨ÂêåÊó∂Âä†ÂÖ•Êàñ‰∏çÂä†ÂÖ•Ë¶ÜÁõñÁÇπÔºåÂàôÂÆÉ‰ª¨ÂèØ‰ª•ÂêàÂπ∂Êàê‰∏Ä‰∏™Â§ßÁÇπÔºåÂπ∂Âà†ÂéªÈáçÂ§çÁöÑËæπ</li></ul><p>ÂæàÂÆπÊòìÂèëÁé∞ÔºåÊØèÊ¨°ÂêàÂπ∂ÁöÑ‰∏§‰∏™ÁÇπÂÆûÈôÖÂÖ∑ÊúâÁöÑËäÇÁÇπÊï∞ÁõÆ‰∏ÄÂÆöÊòØÁõ∏ÂêåÁöÑ</p><p>Êö¥ÂäõËÆ°ÁÆóÂàôÈúÄË¶ÅÊûö‰∏æ $S_1, S_2$ Á≠âÔºå‰ΩÜÂÆûÈôÖ‰∏äÂú®ÂêàÂπ∂ $1, 2$ ÂêéÔºå$S_1$ ÊòØ‰∏ç‰ºöÂèëÁîüÂèòÂåñÁöÑÔºå‰πüÂ∞±ÊòØËØ¥Êûö‰∏æ $S_1$ ÊòØÂú®ÂêéÈù¢ËøáÁ®ãÂÆåÊàêÁöÑÔºåÂú®‰∏çÊñ≠ÂêàÂπ∂„ÄÅÊ∂àÂéªÁÇπÁöÑËøáÁ®ã‰∏≠ÔºåÊúÄÁªàÊàë‰ª¨‰∏ÄÂÆöÂèØ‰ª•ÂæóÂà∞ÂõæÔºå‰Ωø‰πãÊª°Ë∂≥Êù°‰ª∂ÔºåÊâÄ‰ª•Â∞±‰∏çÈúÄË¶ÅÊâÄË∞ìÊûö‰∏æ $S_1$ ËøôÊ†∑ÁöÑÊ≠•È™§‰∫Ü</p><p>‰∏∫‰∫ÜÊñπ‰æøËÆ°ÁÆóÔºå‰∏çÂ¶®ÂÅáÂÆöÊØèÊ¨°ÂêàÂπ∂ÔºåÈÄâÊã©Áî±ÂÖ∑ÊúâÁõ∏ÂêåËäÇÁÇπÊï∞ÁõÆÔºå‰∏îËØ•Êï∞ÁõÆÊúÄÂ∞èÁöÑ‰∏§‰∏™ÁÇπÔºåÂπ∂‰∏îËøô‰∏™Êï∞ÁõÆ‰∏ÄÂÆöÊòØ $2$ ÁöÑÂπÇÊ¨°ÔºåËÆæÂΩìÂâçÊâæÂà∞ÁöÑËøô‰∏§‰∏™ÁÇπÂÖ∑Êúâ $2^t$ ‰∏™ËäÇÁÇπÔºåÂèØ‰ª•ÂèëÁé∞‰ªªÊÑèÂÖ∑Êúâ $2^d (d &lt; t)$ ‰∏™ËäÇÁÇπÁöÑÁÇπ‰∏ÄÂÆöÊúÄÂ§öÂè™Êúâ‰∏Ä‰∏™Ôºå‰∏î‰∏çÂ≠òÂú®ÂÖ∑Êúâ $2^{t + 2}$ ‰∏™ËäÇÁÇπÁöÑÁÇπÔºåÂõ†‰∏∫Ê≠§Êó∂ÊúÄÂ§öÂè™‰ºöÂêàÂπ∂Âà∞ $2^{t + 1}$</p><p>ÈÇ£‰πàËÆæ $f_{n, k, t}$ Ë°®Á§∫Ââ©‰ΩôËäÇÁÇπÊï∞ $n$ÔºàÂç≥Ê≤°Âä†ÂÖ•Ë¶ÜÁõñÁÇπÁöÑÂâ©‰ΩôÁÇπÁöÑ‰∏™Êï∞ÔºâÔºåËøòÂèØ‰ª•Âä†ÂÖ• $k$ ‰∏™Ë¶ÜÁõñÁÇπÔºå$t$ ÁöÑÊÑè‰πâÂ¶Ç‰∏äÊâÄËø∞</p><p>ÂæàÊòéÊòæÂú®Áü•ÈÅì‰∫Ü $n$ ‰πãÂêéÊàë‰ª¨Â∞±ÂèØ‰ª•Áü•ÈÅìÊ≠§Êó∂ÊØèÁßçÂÖ∑Êúâ‰∏çÂêåËäÇÁÇπÊï∞ÁöÑÁÇπÁöÑ‰∏™Êï∞ÔºåÊ≠§Êó∂Êúâ $tot = n &gt;&gt; t$ ‰∏™Áî± $2^t$ ‰∏™ËäÇÁÇπÁªÑÊàêÁöÑÁÇπÔºåÊûö‰∏æÂú® $tot$ ‰∏≠ÈÄâÊã©Â§öÂ∞ë‰∏™ËøõË°åÁïô‰∏ã„ÄÅÊ∂àÂ§±„ÄÅÂêàÂπ∂ÁöÑÊìç‰Ωú</p><p>ËÆæÊúâ $r (r \in \{0, 1\})$ ‰∏™ÁÇπÁïô‰∏ãÔºå$m (0 \le m \le \frac{tot}2)$ <strong>ÂØπ</strong>ÁÇπÂêàÂπ∂ÔºåÈÇ£‰πàÂèØ‰ª•ËÆ°ÁÆóÂá∫Êúâ $d = tot - 2 * m - r$ ‰∏™ÁÇπÊ∂àÂ§±ÔºåËÆ°ÁÆóÊñπÊ°àÊï∞ÔºåÂç≥Ë¶ÅÂú® $m + d$ ‰∏™‰ΩçÁΩÆ‰∏≠ÈÄâÊã© $d$ ‰∏™‰ΩçÁΩÆÊ∂àÂ§±ÔºåÂç≥ÊñπÊ°àÊï∞‰∏∫ $\dbinom{m + d}d$Ôºå‰ΩÜÂÆûÈôÖ‰∏äËøôÊòØÈîôËØØÁöÑÔºåÂõ†‰∏∫</p><p>Ëã• $r = 0$ ÂàôÂøÖÈ°ªÂº∫Âà∂Ë¶ÅÊ±ÇÊúÄÂêé‰∏ÄÁªÑÁÇπÂøÖÈ°ªÂêàÂπ∂ÔºåÂÅáÂ¶Ç‰∏Ä‰∏™ÈÉΩ‰∏çÂâ©‰∏îÊúÄÂêéÊòØÊ∂àÂ§±ÁöÑËØùÔºåÈÇ£Â∞±Áõ∏ÂΩì‰∫éÂú®Êìç‰ΩúÂâçÊúÄÂêéÊòØÂè™Êúâ‰∏Ä‰∏™ÁÇπÁöÑÔºåËÄåËøôÂîØ‰∏ÄÁöÑÊúÄÂêé‰∏Ä‰∏™ÁÇπÂú®‰∏ç‰∏éÂÖ∂ÂÆÉÁÇπÁªÑÂêàÁöÑÊÉÖÂÜµ‰∏ãÂÆÉÁã¨Ëá™Ê∂àÂ§±ÊòØÊ≤°ÊúâÊÑè‰πâÁöÑÔºåËøôÁßçÊÉÖÂÜµÂÆûÈôÖ‰∏äÂ∫îËØ•ÊòØË¢´ $r = 1$ Êó∂ËÆ°ÁÆóÂà∞ÁöÑÔºåÊïÖËã• $r = 0$ ÂàôÈ°ªÂº∫Âà∂‰ª§ÊúÄÂêé‰∏Ä‰∏™Êìç‰ΩúÊòØÂêàÂπ∂ÔºåÊïÖÊñπÊ°àÊï∞Â∫î‰∏∫ $\dbinom{m + d - [rem = 0]}d$</p><p>ËÆ∞ÂøÜÂåñ‰∏Ä‰∏ãÂç≥ÂèØÔºåÈÄíÂΩíÂà∞ÊúÄÂêé $n$ ‰∏çË∂≥‰ª•ÊàñÊÅ∞Âè™ËÉΩÊèê‰æõ $2^t$ ‰∏™ËäÇÁÇπÊó∂ÔºåËã•ËØ•Áä∂ÊÄÅ‰∫ßÁîüË¥°ÁåÆÂàôÂÖ∂ÂøÖÈ°ªÊª°Ë∂≥ $n \neq k \cap lowbit(n) = k$ÔºåËøôÊòØÂõ†‰∏∫ÊúÄÂêéÂâ©‰∏ãËã•Âπ≤‰∏™ÁÇπÔºåÂèëÁé∞Âè™ÊúâÊúÄÂ∞èÁÇπË¶ÜÁõñ‰∏∫ÊúÄÂ∞èÁÇπÁöÑÊó∂ÂÄôÁ≠îÊ°àÊâçÊòØÂ•áÊï∞ÔºåËã•Ê≠§Êó∂ÊúÄÂ∞èÁÇπË¶ÜÁõñÂ§ß‰∫é‰∏ÄÔºåÂàôË¶ÜÁõñÁÇπ‰πãÈó¥ÂèØ‰ª•‰ªªÊÑèËøûËæπÔºåÂàôÁ≠îÊ°à‰ºöÊòØ $2$ ÁöÑÂπÇÊ¨°ÔºõËã•‰∏çÊòØÊúÄÂ∞èÁÇπÔºåÊØîËøô‰∏™ÁÇπÂ∞èÁöÑÁÇπÂèØ‰ª•ÈÄâÊã©ËøûÊàñ‰∏çËøûËøô‰∏™ÁÇπÔºåÂàôÁ≠îÊ°à‰∫¶ÊòØ $2$ ÁöÑÂπÇÊ¨°</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (n^2\log^2n)$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN][<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; <span class="number">0</span> || k &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (! k) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> ((n &gt;&gt; t) &lt;= <span class="number">1</span>) <span class="keyword">return</span> n != k &amp;&amp; lowbit (n) == k;</span><br><span class="line"><span class="keyword">if</span> (~ f[n][k][t]) <span class="keyword">return</span> f[n][k][t];</span><br><span class="line">f[n][k][t] = <span class="number">0</span>; <span class="keyword">int</span> lim = n &gt;&gt; (t + <span class="number">1</span>), tot = n &gt;&gt; t;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mer = <span class="number">0</span>; mer &lt;= lim; mer ++) <span class="comment">// ÂêàÂπ∂</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> rem = <span class="number">0</span>; rem &lt;= <span class="number">1</span>; rem ++) &#123; <span class="comment">// Áïô‰∏ã</span></span><br><span class="line"><span class="keyword">int</span> des = tot - mer * <span class="number">2</span> - rem; <span class="comment">// Ê∂àÂ§±</span></span><br><span class="line"><span class="keyword">if</span> (des &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> c1 = mer + des - (! rem), c2 = des;</span><br><span class="line"><span class="keyword">if</span> ((c1 &amp; c2) == c2) f[n][k][t] ^= dp (n - (des &lt;&lt; t), k - (des &lt;&lt; t), t + <span class="number">1</span>);</span><br><span class="line"><span class="comment">// ÂØπÁªÑÂêàÊï∞ C (n, m) Ëã•Êª°Ë∂≥ (n &amp; m) == m ÂàôËØ¥Êòé C (n, m) ÊòØÂ•áÊï∞</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> f[n][k][t];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (f, - <span class="number">1</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line">Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= Q; Case ++) &#123;</span><br><span class="line"><span class="keyword">int</span> n = getnum (), k = getnum ();</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, dp (n, k, <span class="number">0</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊÄùÁª¥ </tag>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> ÂàÜÂùó </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅÂÖ≠Ôºâ</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>‰ªäÂ§©ÊòØÂá†Âú∫‰∏ãÊù•Á¨¨‰∏ÄÊ¨°ÂÆåÊï¥ÊêûÂá∫‰∏ÄÈÅìÈ¢ò</p><p>ËôΩÁÑ∂Ë∑ëÁöÑË¥ºÊÖ¢ÔºåÊñπÊ≥ï‰∏çÂ§ü‰ºòÔºåÊØî $\text{std}$ ÊÖ¢ $200ms$„ÄÇ„ÄÇ</p><p>$\text{scoreÔºö0 + 100 + 0 = 100   rkÔºö16/32}$</p><h2 id="Problem-AÔºöGeometric-Progressions"><a href="#Problem-AÔºöGeometric-Progressions" class="headerlink" title="Problem AÔºöGeometric Progressions"></a>Problem AÔºöGeometric Progressions</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>È¶ñÈ°π‰∏∫ $a$ ‰∏îÂÖ¨ÊØî‰∏∫ $b$ ÁöÑÁ≠âÊØîÊï∞ÂàóÊòØ‰∏Ä‰∏™ÂΩ¢Â¶Ç $a, ab, ab^2, ab^3, ‚Ä¶$ ÁöÑÊï∞Â≠óÂ∫èÂàó</p><p>‰Ω†Ë¢´ÁªôÂÆö‰∫Ü $n$ ‰∏™Êï¥Êï∞Á≠âÊØîÊï∞Âàó„ÄÇ‰Ω†ÁöÑ‰ªªÂä°ÊòØÊâæÂá∫ÊúÄÂ∞èÁöÑÊï¥Êï∞ $x$Ôºå‰ΩøÂæóÂÆÉÊòØÊâÄÊúâÁªôÂÆöÁöÑÂ∫èÂàóÁöÑÂÖÉÁ¥†ÔºåÊàñËÄÖÂ£∞ÊòéËøôÊ†∑ÁöÑÊï¥Êï∞‰∏çÂ≠òÂú®</p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n \le 100, ~ 1 \le a, b \le 10^9$</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂéüÈ¢ò <a href="https://codeforces.com/problemset/problem/571/E" target="_blank" rel="noopener">CF571E</a></p><p>È¶ñÂÖàÂ∞ÜÊâÄÊúâ $a, b$ ÂàÜËß£Ë¥®Âõ†Êï∞ÔºåÂæóÂà∞Â§ßÂ∞è‰∏∫ $m$ Ë¥®Âõ†Êï∞ÈõÜ $\{p_1, p_2, ‚Ä¶, p_m\}$</p><p>ËÆæ $c_{i, j}$ Ë°®Á§∫ $a_i$ ÂàÜËß£Ë¥®Âõ†Êï∞Âêé $p_j$ ÁöÑÂπÇÊ¨°Ôºå$d_{i, j}$ Ë°®Á§∫ $b_i$ ÂàÜËß£Ë¥®Âõ†Êï∞Âêé $p_j$ ÁöÑÂπÇÊ¨°ÔºåÈÇ£‰πàÁ≠îÊ°àÂç≥ÂèØË¢´Ë°®Á§∫‰∏∫ $\prod\limits_{i = 1}^m p_i^{c_{1, i} + k \times d_{1, i}}$ÔºåÂÖ∂‰∏≠ $k \in N$</p><p>ËÄÉËôëÊØèÊ¨°Â∞Ü‰∏§ÂØπ $a, b$ ÂêàÂπ∂ÔºåËÆæ‰πãÂâçÂêàÂπ∂ÂæóÂà∞ÁöÑ $a, b$ ÂàÜËß£Ë¥®Âõ†Êï∞ÂêéÁöÑË¥®Âõ†Êï∞ÂπÇÊ¨°Êï∞ÁªÑ $A, B$ÔºåÂÖ∂‰∏≠ $A_i$ Ë°®Á§∫Á¨¨ $i$ ‰∏™Ë¥®Âõ†Êï∞ÁöÑÂπÇÊ¨°ÔºåÂÜçËÆæÂáÜÂ§á‰∏é‰πãÂêàÂπ∂ÁöÑ $a, b$ ÁöÑË¥®Âõ†Êï∞ÂπÇÊ¨°Êï∞ÁªÑ $C, D$</p><p>ÈÇ£‰πàÁé∞Âú®ÂàÜ‰∏∫‰ªÖÊúâ‰∏ÄËß£„ÄÅÊúâÊó†Êï∞Ëß£„ÄÅÊó†Ëß£‰∏âÁßçÊÉÖÂÜµ</p><p>ÂØπ $A, B$ ÂçïÁã¨ËÄÉËôëÔºåËÆæÁ≠îÊ°à $p_i$ ÂπÇÊ¨° $t_i$ÔºåÂàôÊúâ<br>$$<br>\left\{<br>    \begin{aligned}<br>        t_i &amp;= A_i + k \times B_i \\<br>        t_j &amp;= A_j + k \times B_j<br>    \end{aligned}<br>\right. \\<br>\Rightarrow<br>t_i = A_i + \frac{B_i}{B_j}(t_j - A_j)<br>$$<br>‰πüÂ∞±ÊòØËØ¥ $t_j$ Âíå $t_i$ ÁöÑÂÖ≥Á≥ªÊòØ‰∏ÄÊù°ÊñúÁéá‰∏∫ $\frac{B_i}{B_j}$ ÁöÑÁõ¥Á∫ø</p><p>ÂêåÁêÜÂØπ $C, D$ÔºåÊúâ $t_i = C_i + \frac{D_i}{D_j}(t_j - C_j)$</p><p>ÈÇ£‰πà‰ªÖÊúâ‰∏ÄËß£ÁöÑÊù°‰ª∂Âç≥‰∏∫ÂÆÉ‰ª¨‰πãÈó¥Êúâ‰∫§ÁÇπÔºåÂç≥ $\frac{B_i}{B_j} = \frac{D_i}{D_j}$ÔºåËøôÁßçÊÉÖÂÜµÁõ¥Êé•Ëß£Âá∫Êù•Â∞±Â•Ω‰∫Ü</p><p>ÈÇ£‰πàËÄÉËôëÂâ©‰∏ãÁöÑÊÉÖÂÜµÔºå$t_i = A_i + k_1 \times B_i = C_i + k_2 \times D_i$ ÂèØ‰ª•ËΩ¨ÂåñÊàê $k_2 \times D_i - k_1 \times B_i = A_i - C_i$ÔºåÁÑ∂ÂêéÁî® $ExGCD$ Ê±ÇËß£ÔºåÊ≥®ÊÑèÁî±‰∫éÂÆÉ‰ª¨ $k_1, k_2$ ÈÉΩÁõ∏ÂêåÔºåÊâÄ‰ª•Ë¶ÅÊª°Ë∂≥ÊØèÁªÑÊñπÁ®ãÊòØÂê¶Êª°Ë∂≥ÊØî‰æãÂÖ≥Á≥ªÔºå‰∏çÊª°Ë∂≥ÂàôÊó†Ëß£ÔºåÂÖ∂ÂÆûÊàëËßâÂæó‰∏äÈù¢ÈÇ£‰∏™ $\frac{B_i}{B_j} \ne \frac{D_i}{D_j}$ ÂàôÂè™Êúâ‰∏ÄËß£‰πüÂ∫îËØ•ÂèØ‰ª•Áî®Ëøô‰∏™Êù•ÁêÜËß£ÔºåÁÑ∂ÂêéÂ∞±Áõ∏ÂΩì‰∫éËß£‰∏Ä‰∏™‰∫åÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ã</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">900</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e04</span>;</span><br><span class="line"><span class="keyword">int</span> oa[MAXN], ob[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">GCD</span> <span class="params">(LL a, LL b)</span> </span>&#123; <span class="keyword">return</span> ! b ? a : GCD (b, a % b); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exGCD</span> <span class="params">(LL a, LL b, LL&amp; x, LL&amp; y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! b) &#123; x = <span class="number">1</span>, y = <span class="number">0</span>; <span class="keyword">return</span> ; &#125;</span><br><span class="line">exGCD (b, a % b, y, x);</span><br><span class="line">y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXM]= &#123;<span class="number">0</span>&#125;, pn = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">separ</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i ++)</span><br><span class="line"><span class="keyword">if</span> (! (x % i)) &#123;</span><br><span class="line">prime[++ pn] = i;</span><br><span class="line"><span class="keyword">while</span> (! (x % i)) x /= i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (x &gt; <span class="number">1</span>) prime[++ pn] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> pcnt[<span class="number">2</span>][MAXN][MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cencus</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> id, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (! (x % prime[i])) &#123;</span><br><span class="line"><span class="keyword">while</span> (! (x % prime[i])) &#123;</span><br><span class="line">x /= prime[i];</span><br><span class="line">pcnt[p][id][i] ++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL a[MAXM], b[MAXM], c[MAXM], d[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">merge</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL sb = <span class="number">0</span>, sd = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) &#123; sb += b[i]; sd += d[i]; &#125;</span><br><span class="line"><span class="keyword">if</span> (! sb &amp;&amp; ! sd) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (a[i] != c[i])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (! sb || ! sd) &#123;</span><br><span class="line"><span class="keyword">if</span> (! sd) &#123; swap (sb, sd); swap (a, c); swap (b, d); &#125;</span><br><span class="line">LL k = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (d[i]) &#123;</span><br><span class="line"><span class="keyword">if</span> (c[i] &gt; a[i] || (a[i] - c[i]) % d[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">LL pk = (a[i] - c[i]) / d[i];</span><br><span class="line"><span class="keyword">if</span> (k != - <span class="number">1</span> &amp;&amp; pk != k) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">k = pk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (sb * d[i] != sd * b[i])</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (i &lt;= pn) &#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= pn; j ++)</span><br><span class="line"><span class="keyword">if</span> (b[i] * d[j] != d[i] * b[j]) <span class="comment">// Âè™Êúâ‰∏Ä‰∏™Ëß£</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">LL ka = d[j] * (c[i] - a[i]) - d[i] * (c[j] - a[j]);</span><br><span class="line">LL kb = b[j] * (c[i] - a[i]) - b[i] * (c[j] - a[j]);</span><br><span class="line">LL down = d[j] * b[i] - d[i] * b[j];</span><br><span class="line"><span class="keyword">if</span> (down &lt; <span class="number">0</span>) ka = - ka, kb = - kb, down = - down;</span><br><span class="line"><span class="keyword">if</span> (ka &lt; <span class="number">0</span> || kb &lt; <span class="number">0</span> || ka % down || kb % down) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">ka /= down, kb /= down;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= pn; k ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[k] + ka * b[k] != c[k] + kb * d[k]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">a[k] = a[k] + ka * b[k], b[k] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ExGCDÂêàÂπ∂</span></span><br><span class="line">LL rb = <span class="number">0</span>, rd = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (b[i]) &#123;</span><br><span class="line">LL g = GCD (b[i], d[i]);</span><br><span class="line">rb = b[i] / g, rd = d[i] / g;</span><br><span class="line"><span class="keyword">if</span> ((a[i] - c[i]) % g) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">r = (a[i] - c[i]) / g;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (r * (b[i] / rb) != a[i] - c[i]) <span class="comment">// Âà§Êñ≠ÊòØÂê¶ÊàêÊØî‰æã</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (r &lt; <span class="number">0</span>) swap (a, c), swap (b, d), swap (rb, rd), r = - r;</span><br><span class="line">LL ka, kb;</span><br><span class="line">exGCD (rb, rd, ka, kb);</span><br><span class="line">ka = (ka * (- r) % rd + rd) % rd;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">a[i] += ka * b[i], b[i] *= rd;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) oa[i] = getnum (), ob[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) separ (oa[i]), separ (ob[i]);</span><br><span class="line">sort (prime + <span class="number">1</span>, prime + pn + <span class="number">1</span>);</span><br><span class="line">pn = unique (prime + <span class="number">1</span>, prime + pn + <span class="number">1</span>) - prime - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cencus (<span class="number">0</span>, i, oa[i]), cencus (<span class="number">1</span>, i, ob[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) a[i] = pcnt[<span class="number">0</span>][<span class="number">1</span>][i], b[i] = pcnt[<span class="number">1</span>][<span class="number">1</span>][i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pn; j ++) c[j] = pcnt[<span class="number">0</span>][i][j], d[j] = pcnt[<span class="number">1</span>][i][j];</span><br><span class="line"><span class="keyword">if</span> (! merge ()) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line">LL ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) ans = ans * power (prime[i], a[i]) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöBichrome-Spanning-Tree"><a href="#Problem-BÔºöBichrome-Spanning-Tree" class="headerlink" title="Problem BÔºöBichrome Spanning Tree"></a>Problem BÔºöBichrome Spanning Tree</h2><h3 id="È¢òÁõÆÊèèËø∞-1"><a href="#È¢òÁõÆÊèèËø∞-1" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>Êàë‰ª¨Êúâ‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ $m$ Êù°ËæπÁöÑÂ∏¶ÊùÉÊó†ÂêëÂõæ„ÄÇÂõæ‰∏≠ÁöÑÁ¨¨ $i$ Êù°ËæπËøûÊé•‰∫ÜËäÇÁÇπ $u_i, v_i,$ÔºåÊùÉÈáç‰∏∫ $w_i$„ÄÇÂè¶Â§ñÔºå‰Ω†ËøòË¢´ÁªôÂÆö‰∫Ü‰∏Ä‰∏™Êï¥Êï∞ $X$„ÄÇ</p><p>ËØ∑Ê±ÇÂá∫Â∞ÜÊØèÊù°ËæπÊüìÊàêÈªëËâ≤ÊàñÁôΩËâ≤Ôºå‰∏îÊª°Ë∂≥‰∏ãÈù¢ÁöÑÊù°‰ª∂ÁöÑÊñπÊ°àÊï∞Ê®° $10^9 + 7$ ÁöÑÂÄº</p><ul><li>Âõæ‰∏≠Â≠òÂú®‰∏ÄÊ£µÂêåÊó∂ÂåÖÂê´ÊüìÊàêÁôΩËâ≤ÁöÑËæπÂíåÊüìÊàêÈªëËâ≤ÁöÑËæπÁöÑÁîüÊàêÊ†ë„ÄÇÂè¶Â§ñÔºåÂú®ÊâÄÊúâËøôÁßçÁîüÊàêÊ†ë‰∏≠ÔºåÊùÉÈáçÊúÄÂ∞èÁöÑ‰∏ÄÊ£µÁöÑÊùÉÈáçÊÅ∞‰∏∫ $X$</li></ul><p>ËøôÈáåÔºå‰∏ÄÊ£µÁîüÊàêÊ†ëÁöÑÊùÉÈáçÂÆö‰πâ‰∏∫ÁîüÊàêÊ†ë‰∏≠ËæπÁöÑÊùÉÈáçÁöÑÂíå</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-1"><a href="#Êï∞ÊçÆËåÉÂõ¥-1" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n \le 1000, ~ 1 \le m \le 2000, ~ 1 \le w_i \le 10^9, ~ 1 \le X \le 10^{12}$</p><p>ÁªôÂá∫ÁöÑÊï∞ÊçÆ‰øùËØÅÂõæËÅîÈÄöÔºå‰∏çÂ≠òÂú®ÈáçËæπÔºå‰∏çÂ≠òÂú®Ëá™ÁéØ</p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂéüÈ¢ò <a href="https://atcoder.jp/contests/arc093/tasks/arc093_c" target="_blank" rel="noopener">ARC093C</a></p><h4 id="ÊñπÊ≥ï‰∏Ä"><a href="#ÊñπÊ≥ï‰∏Ä" class="headerlink" title="ÊñπÊ≥ï‰∏Ä"></a>ÊñπÊ≥ï‰∏Ä</h4><p>ÂÖàËÆ≤ËÆ≤ÊàëÁöÑÊñπÊ≥ïÂêß</p><p>ÊòæÁÑ∂ÂØπ‰∏ÄÊ£µÊùÉÈáç $&lt; X$ ÁöÑÊ†ëÔºåÂÆÉÊâÄÊúâÁöÑËæπÁöÑÈ¢úËâ≤ÈÉΩÂ∫îËØ•Áõ∏ÂêåÔºåÈÇ£‰πàÊàë‰ª¨ËÄÉËôëÂØπÊØèÊù°ËæπÂà§Êñ≠ÂÆÉ‰ºö‰∏ç‰ºöÊúâËøôÁßçÈôêÂà∂</p><p>Ê≠§Êó∂Áõ¥Êé•Áî® $Kruskal$ Ê±ÇÂá∫ÂåÖÂê´ËØ•ËæπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëÔºåËã•ÂÖ∂ÊùÉÈáç $&lt; X$ÔºåÂàôËØ•ËæπÁöÑÊüìËâ≤Â∞±‰ºöË¢´ÈôêÂà∂ÔºåÁß∞‰∏ÄÁ±ªËæπÔºõËã•ÂÖ∂ÊùÉÈáç $&gt; X$ÔºåÂàôÂÆÉÂ±û‰∫éÊüìËâ≤ÊÉÖÂÜµ‰∏çËÆ∫Â¶Ç‰ΩïÈÉΩ‰∏ç‰ºöÂØπÁ≠îÊ°àÈÄ†ÊàêË¥°ÁåÆÁöÑËæπÔºåÁß∞‰∫åÁ±ªËæπÔºõËã•ÂÖ∂ÊùÉÈáç $= X$ÔºåÂàôÈúÄË¶ÅÁùÄÈáçËÄÉËôëÔºåÁß∞‰∏âÁ±ªËæπ</p><p>ËøôÈáåËÄÉËôë‰∏§Ê£µÂú®Áõ∏ÂêåÁöÑÂõæ‰∏ä‰ΩÜËæπÈõÜÂÆåÂÖ®Êó†‰∫§ÈõÜÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëÔºåÂÆÉ‰ª¨‰∏ÄÂÆöÂèØ‰ª•ÊûÑÊàê‰∏Ä‰∏™Êñ∞ÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëÔºåËØ•ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑËæπÈõÜ‰∏éÂéü‰∏§Ê£µÊ†ëÁöÑËæπÈõÜÂàÜÂà´Êúâ‰∫§ÔºåËøô‰∏™‰πüÂæàÂ•ΩËØÅÊòéÔºåÂõ†‰∏∫ÊúÄÂ∞èÁîüÊàêÊ†ë‰∏ÄÂÆöÊòØÊúÄÂ∞èÁì∂È¢àÁîüÊàêÊ†ëÔºåÂç≥ÊúÄÂ§ßËæπÊúÄÂ∞èÔºåÈÇ£‰πàÂÆÉ‰ª¨‰πãÈó¥‰∏ÄÂÆöÂèØ‰ª•‰∫íÁõ∏ÊõøÊç¢Ôºå‰ªéËÄåÊûÑÊàê‰∏ÄÊ£µÊñ∞ÁöÑ $MST$ÔºåËá≥‰∫éÂØπÈÇ£‰∫õÊùÉÈáç $&lt; X$ ÁöÑÊ†ëÔºå‰πüÊã•ÊúâÁ±ª‰ººËØ•ÂÆöÁêÜÔºåËØÅÊòéÁ±ªÊØî‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><p>Ëá™Ê≠§Êàë‰ª¨Â∞±ÂèØ‰ª•ËÆ§‰∏∫ÊâÄÊúâ‰∫åÁ±ªËæπÁöÑÈ¢úËâ≤‰∏ÄÂÆöÊòØÁõ∏ÂêåÁöÑ</p><p>ËÆæÊüêÊù°‰∏âÁ±ªËæπ $E$Ôºå‰∏âÁ±ªËæπÁöÑÊÄªÊï∞‰∏∫ $m$</p><p>Áé∞Âú®Âè™ÈúÄÊûö‰∏æ $E$ Êù•ËøõË°åÁªÑÂêàËÆ°Êï∞ÔºåÂº∫Âà∂‰ª§ $E$ ÊüìËâ≤‰∏é‰∏ÄÁ±ªËæπ‰∏çÂêåÔºåÂàôÂâ©‰Ωô $m - 1$ Êù°ËæπÂàôÂèØÈöèÊÑèÊüìËâ≤Ôºå‰∏∫ÈÅøÂÖçÁÆóÈáçÔºåÊûö‰∏æ $m - 1$ Êù°Ëæπ‰∏≠‰∏é $E$ ÊüìËâ≤Áõ∏ÂêåÁöÑ‰∏™Êï∞ $j$ÔºåÂàô $E$ Âú®Êûö‰∏æÂà∞ $j$ Âä†‰∏äÁöÑË¥°ÁåÆÂç≥‰∏∫ $\frac{C (m - 1, j)}{j + 1}$ÔºåËÆ∞ÂæóÊúÄÂêé‰πò‰∫åÔºå‰ΩÜÂØπ‰∏çÂ≠òÂú®‰∏ÄÁ±ªËæπÁöÑÊÉÖÂÜµË¶ÅÁâπÂà§‰∏Ä‰∏ã</p><p>ÈÇ£‰πàÊúÄÂêéÂÜçËÆæ‰∏âÁ±ªËæπ‰∏™Êï∞ $ext$ÔºåÂ∞Ü‰πãÂâçÁªüËÆ°ÂæóÂà∞ÁöÑÁ≠îÊ°à‰πò‰∏ä $2^{ext}$ Âç≥ÂèØ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O \big(nm \times \alpha(n)\big)$</p><h4 id="‰ª£Á†ÅÔºàÊñπÊ≥ï‰∏ÄÔºâ"><a href="#‰ª£Á†ÅÔºàÊñπÊ≥ï‰∏ÄÔºâ" class="headerlink" title="‰ª£Á†ÅÔºàÊñπÊ≥ï‰∏ÄÔºâ"></a>‰ª£Á†ÅÔºàÊñπÊ≥ï‰∏ÄÔºâ</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">LL pow2[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125;;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, sze = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">Link[++ sze].to = v;</span><br><span class="line">Link[sze].w = w;</span><br><span class="line">Link[sze].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = sze;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL fact[MAXM]= &#123;<span class="number">0</span>&#125;, invfact[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL inv[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL X;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> u, v, w;</span><br><span class="line">Edge (<span class="keyword">int</span> u = <span class="number">0</span>, <span class="keyword">int</span> v = <span class="number">0</span>, <span class="keyword">int</span> w = <span class="number">0</span>) : u (u), v (v), w (w) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Edge&amp; p) <span class="keyword">const</span> &#123; <span class="keyword">return</span> w &lt; p.w; &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Edge edge[MAXM];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> fa[x] == x ? x : fa[x] = find (fa[x]); &#125;</span><br><span class="line"><span class="function">LL <span class="title">Kruskal</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = edge[i].u, y = edge[i].v, w = edge[i].w;</span><br><span class="line"><span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line"><span class="keyword">if</span> (fx == fy) <span class="keyword">continue</span>;</span><br><span class="line">fa[fx] = fy; ret += w;</span><br><span class="line">Insert (x, y, w), Insert (y, x, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> white[MAXM]= &#123;<span class="number">0</span>&#125;, black[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> wn = <span class="number">0</span>, bn = <span class="number">0</span>;</span><br><span class="line"><span class="function">LL <span class="title">cencus</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= bn; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> i = black[q];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123; fa[j] = j; Head[j] = <span class="number">0</span>; &#125;</span><br><span class="line">sze = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> u = edge[i].u, v = edge[i].v, w = edge[i].w;</span><br><span class="line">fa[u] = v;</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">Kruskal ();</span><br><span class="line">LL add = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= bn - <span class="number">1</span> - (! wn); j ++)</span><br><span class="line">add = (add + C (bn - <span class="number">1</span>, j) * inv[j + <span class="number">1</span>] % MOD) % MOD;</span><br><span class="line">ret = (ret + add) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (wn) ret = <span class="number">2l</span>l * ret % MOD;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>; <span class="keyword">int</span> ext = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">1l</span>l * edge[i].w &gt; X) &#123; ext ++; <span class="keyword">continue</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123; fa[j] = j; Head[j] = <span class="number">0</span>; &#125;</span><br><span class="line">sze = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> u = edge[i].u, v = edge[i].v, w = edge[i].w;</span><br><span class="line">fa[u] = v;</span><br><span class="line">LL x = w + Kruskal ();</span><br><span class="line"><span class="keyword">if</span> (x &lt; X) white[++ wn] = i;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x == X) black[++ bn] = i;</span><br><span class="line"><span class="keyword">else</span> ext ++;</span><br><span class="line">&#125;</span><br><span class="line">ans = cencus ();</span><br><span class="line">ans = ans * pow2[ext] % MOD;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (); <span class="built_in">cin</span> &gt;&gt; X;</span><br><span class="line"><span class="keyword">if</span> (N == <span class="number">1</span>) &#123; <span class="built_in">puts</span> (<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">pow2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= max (N, M); i ++) pow2[i] = pow2[i - <span class="number">1</span>] * <span class="number">2l</span>l % MOD;</span><br><span class="line">fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">inv[<span class="number">1</span>] = fact[<span class="number">1</span>] = invfact[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[i] = invfact[i - <span class="number">1</span>] * inv[i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">edge[i] = Edge (u, v, w);</span><br><span class="line">&#125;</span><br><span class="line">sort (edge + <span class="number">1</span>, edge + M + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; solve () &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ÊñπÊ≥ï‰∫å"><a href="#ÊñπÊ≥ï‰∫å" class="headerlink" title="ÊñπÊ≥ï‰∫å"></a>ÊñπÊ≥ï‰∫å</h4><p>È¢òËß£ÁöÑÊñπÊ≥ïÔºåÊàëËßâÁùÄÊå∫Â¶ô</p><p>ÂÖàÈöè‰æøÂèñ‰∏Ä‰∏™ $MST$ ËÆæ‰∏∫ $T$ÔºåËÆæÂÖ∂ÊùÉÈáçÂíå $w(T)$ÔºåÊòæÁÑ∂Âè™ÈúÄËÄÉËôë $w(T) \le X$</p><p>ÂØπ $w(T) = X$ÔºåÂèØ‰ª•ÂÖàÂä†‰∏äËÆ©ÂÖ∂ÂÜÖÈÉ®‰∏çÂÖ®ÈÉ®ÊüìÁõ∏ÂêåËâ≤ÔºåÂâ©‰ΩôËæπÈöèÊÑèÊüìËâ≤ÔºåÂç≥Ë¥°ÁåÆ $(2^{n - 1} - 2) \cdot 2^{m - n + 1}$</p><p>Êé•‰∏ãÊù•ËÄÉËôë $T$ ÊüìËâ≤ÂÖ®ÈÉ®Áõ∏ÂêåÁöÑÊÉÖÂÜµÔºå‰∏çÂ¶®ËÆæ $T$ ‰∏≠ËæπÂùá‰∏∫ÈªëËæπ</p><blockquote><p>ÊØèÊ¨°ÊõøÊç¢‰∏Ä‰∏™‰∏çÂú® $T$ ‰∏≠ÁöÑÁôΩËæπÂà∞ $T$ÔºåÂàôÊúÄÂ§öÊõøÊç¢‰∏ÄÊ¨°</p></blockquote><p>ËØÅÊòéÂèçÂêëÊÄùËÄÉ‰∏Ä‰∏ãÂ∞±Ë°å‰∫ÜÔºåÊØèÊ¨°ÊõøÊç¢ÊùÉÈáç‰∏ÄÂÆö‰∏ç‰ºöÂáèÂ∞ëÔºåÈÇ£‰πàÂÅáÂÆöÁé∞Âú®ÊõøÊç¢‰∫Ü‰∏§‰∏™ÁôΩËæπÔºå‰ΩÜÂÖ®ÂõæÁöÑÈªëÁôΩËæπ $MST$ ‰ªç‰∏çÂåÖÊã¨‰Ω†Á¨¨‰∫åÊ¨°ÊõøÊç¢ÁöÑËæπÔºåÂõ†‰∏∫Á¨¨‰∫åÊ¨°ÊõøÊç¢Âá∫Êù•ÁöÑÈªëËæπÊ≠§Êó∂Â∞±Êª°Ë∂≥Êù°‰ª∂‰∫Ü</p><p>ÂØπÊØèÊ¨°ÊõøÊç¢ÔºåËã•ÊõøÊç¢Á¨¨ $i$ Êù°ËæπÔºåÂàô‰ºöÂ¢ûÂ§ß $cost(i) = w_i - \max\{w_j | (u_j, v_j) Âú®T‰∏≠(u_i, v_i)‰∏§ÁÇπÈó¥Ë∑ØÂæÑ‰∏ä\}$ÔºàÈ¢òËß£Ë°®Ëø∞ÔºâÁöÑË¥°ÁåÆÔºåÂõ†Ê≠§‰∏ÄÂÆöÈÄâÊúÄÂ∞èËæπÊõøÊç¢</p><p>Ê±Ç $cost(i)$ Ë∑≥‰∏™ÂÄçÂ¢ûÂ∞±Â•Ω‰∫Ü</p><p>ÈÇ£‰πàÊúÄÂêéÂ∞ÜÊâÄÊúâ $i$ ÁöÑ $cost(i)$ Êéí‰∏™Â∫èÔºåËÆæÊéíÂ∫èÂêéÊüêÊù°ËæπÊéíÂú®‰ΩçÁΩÆ $p$ÔºåÂàôÂÖ∂ÂØπÁ≠îÊ°àË¥°ÁåÆ $2^{n + m - 1 - p}$ÔºàÂè™ÊúâÂêéÈù¢ÁöÑËæπÊâçËÉΩ‰ªªÊÑèÊüìËâ≤Ôºâ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (m \log n)$</p><h2 id="Problem-CÔºöNetwork"><a href="#Problem-CÔºöNetwork" class="headerlink" title="Problem CÔºöNetwork"></a>Problem CÔºöNetwork</h2><h3 id="È¢òÈù¢"><a href="#È¢òÈù¢" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/19/ZTh8wvO5FAqHKG4.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/19/DAaFX5Gpq2vzY8g.png" alt=""></p><h3 id="È¢òËß£-2"><a href="#È¢òËß£-2" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂÖàËÆ°ÁÆóÂú®‰∏çÂèçËΩ¨Áî®Êà∑ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊâÄÊúâÁî®Êà∑ÁöÑ $MS(u)$</p><p>ËÄÉËôëÁÇπÂàÜÊ≤ªÔºåÁé∞Âú®ÈÄíÂΩíÂà∞ÂàÜÊ≤ª‰∏≠ÂøÉ $p$ÔºåËÆæ $p$ Â≠êÊ†ëÁÇπ $x$ Âà∞ $p$ ÁöÑËæπÁöÑÊúÄÂ∞èÂÄºÂíåÊúÄÂ§ßÂÄº $(mi_x, ma_x)$ÔºåÂÅáËÆæÁé∞Âú®ÊúâÊúçÂä°Âô® $i$ÔºåÁî®Êà∑ $j$ÔºåÈÉΩÊòØ $p$ ÁöÑÂ≠êÊ†ëÁªìÁÇπÔºåËÆ°ÁÆó $MS(j)$ÔºåËÄÉËôëÊúâÂì™Âá†ÁßçÊÉÖÂÜµ‰ºöË¥°ÁåÆÂà∞ $MS(j)$ÔºåÂç≥ÊòØ $ma_i - mi_x$„ÄÅ$ma_i - mi_j$„ÄÅ$ma_j - mi_i$ÔºåÂêåÊó∂ $(mi_i, ma_i), (mi_j, ma_j)$ ‰πãÈó¥‰∏çÂ≠òÂú®‰ªª‰ΩïÂÖ≥Á≥ªÔºåÈÇ£‰πà‰πüÂ∞±ÊòØËØ¥Âè™ÈúÄÊ±ÇÂæó $p$ Â≠êÊ†ë‰∏≠Êª°Ë∂≥ $ma_i - mi_i$ ÊúÄÂ§ßÔºåÊàñ $ma_i$ ÊúÄÂ§ß„ÄÅÊàñ $mi_i$ ÊúÄÂ§ßÔºåÂç≥ÂèØÊõ¥Êñ∞ÂÖ∂ÂÆÉÊâÄÊúâÁöÑÁî®Êà∑ÔºàÂΩìÁÑ∂Ë¶Å‰∏é $i$ ‰∏çÂêåÂ≠êÊ†ëÔºâÔºåÂèàËÄÉËôëÂà∞ÂêåÂ≠êÊ†ë‰∏çËÉΩ‰∫íÁõ∏Êõ¥Êñ∞ÔºåÊâÄ‰ª•ËøòÂæóËÆ∞ÂΩï‰∏äÈù¢‰∏âËÄÖÁöÑÊ¨°Â§ßÂÄºÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Ê±ÇÂá∫ÊâÄÊúâ $MS(u)$</p><p>Êé•‰∏ãÊù•ËÆ°ÁÆóÂèçËΩ¨Áî®Êà∑ÁöÑÊÉÖÂÜµÔºåÊúÄÂ∞èÂÄºÊúÄÂ§ßÔºåËÄÉËôë‰∫åÂàÜÁ≠îÊ°à</p><p>ËÆæÊ≠§Êó∂‰∫åÂàÜÁ≠îÊ°à $mid$ÔºåÁªßÁª≠ËÄÉËôëÁÇπÂàÜÊ≤ªÔºàÂÆûÈôÖ‰∏äÂè™ÈúÄË¶ÅÁúãÁÇπÂàÜÊ†ëÂ∞±Â•Ω‰∫ÜÔºâÔºåËÆæÂàÜÊ≤ª‰∏≠ÂøÉ $p$ÔºåËÆæÂú®‰∏§‰∏™Â≠êÊ†ëÁöÑÁî®Êà∑ $i, j$ÔºåËã•‰Ωø $check$ Â§±Ë¥•ÂàôÈúÄË¶ÅÊâæÂà∞‰∏ÄÂØπ $i, j$ÔºåÂèçËΩ¨ $i$Ôºå‰ΩøÂæó $Waste (j, i) &lt; mid$</p><p>Â∞Ü $p$ ÊâÄÊúâÂÇ®Â≠ò‰∏ãÊù•ÁöÑ $(mi_x, ma_x)$ Êåâ $mi_x$ ÊéíÂ∫èÔºåÂàôÂØπ $mi_j \le mi_x$ÔºåÊ¨≤‰ΩøÂÖ∂Â§±Ë¥•ÂàôÈúÄÊª°Ë∂≥ $ma_i - mi_j &lt; mid$ÔºåÂç≥ $ma_x &lt; mi_j + mid$ÔºåÂØπ $mi_j &gt; mi_x$ÔºåÊ¨≤‰ΩøÂÖ∂Â§±Ë¥•ÂàôÈúÄÊª°Ë∂≥ $mi_i &gt; \max(ma_i, ma_j) - mid$ÔºåÂΩìÁÑ∂Â∑≤ÁªèÊéíÈô§‰∫ÜÊâÄÊúâÊª°Ë∂≥ $ma_x - mi_x \ge mid$ÔºàÂØπÁ¨¨‰∏ÄÁßçÊÉÖÂÜµÔºâÊàñ $MS(x) \ge mid$ÔºàÂØπ‰∏§ÁßçÊÉÖÂÜµÔºâÁöÑÁÇπÔºåÁÑ∂ÂêéÂíåÂâçÈù¢Áõ∏ÂêåÂèØ‰ª•Á∫øÊÄßÂ§ÑÁêÜ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log n \log V)$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> type[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> rt, minval = INF, fa;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">grvy</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">grvy (n, v, root);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line">maxpart = max (maxpart, subsize[v]);</span><br><span class="line">&#125;</span><br><span class="line">maxpart = max (maxpart, n - subsize[root]);</span><br><span class="line"><span class="keyword">if</span> (maxpart &lt; minval) &#123; rt = root; fa = father; minval = maxpart; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> l, r, id, bel;</span><br><span class="line"><span class="comment">// min value, max value, original index, Â≠êÊ†ë‰ªéÂ±û</span></span><br><span class="line">node (<span class="keyword">int</span> l = <span class="number">0</span>, <span class="keyword">int</span> r = <span class="number">0</span>, <span class="keyword">int</span> id = <span class="number">0</span>, <span class="keyword">int</span> bel = <span class="number">0</span>) : l (l), r (r), id (id), bel (bel) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (l == p.l) <span class="keyword">return</span> r &lt; p.r;</span><br><span class="line"><span class="keyword">return</span> l &lt; p.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="built_in">vector</span>&lt;node&gt; a[MAXN];</span><br><span class="line"><span class="keyword">int</span> minv[MAXN], maxv[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father, <span class="keyword">int</span> bel)</span> </span>&#123;</span><br><span class="line">a[rt].push_back(node (minv[root], maxv[root], root, bel));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">minv[v] = min (minv[root], w);</span><br><span class="line">maxv[v] = max (maxv[root], w);</span><br><span class="line">DFS (v, root, bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> MS[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">minv[rt] = INF, maxv[rt] = <span class="number">0</span>;</span><br><span class="line">a[rt].push_back(node (minv[rt], maxv[rt], rt, rt));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[rt]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">minv[v] = min (minv[rt], w);</span><br><span class="line">maxv[v] = max (maxv[rt], w);</span><br><span class="line">DFS (v, rt, v);</span><br><span class="line">&#125;</span><br><span class="line">sort (a[rt].begin(), a[rt].end());</span><br><span class="line">pair&lt;int, int&gt;  fir (- INF, 0), sec (- INF, 0);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line"><span class="keyword">int</span> ms = x.r - x.l;</span><br><span class="line"><span class="keyword">if</span> (ms &gt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (ms, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ms &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (ms, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line"><span class="keyword">if</span> (now.second) &#123;</span><br><span class="line">MS[x.id] = max (MS[x.id], x.r - x.l);</span><br><span class="line">MS[x.id] = max (MS[x.id], now.first);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fir = make_pair (- INF, <span class="number">0</span>), sec = make_pair (- INF, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.r &gt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (x.r, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x.r &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.r, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second? sec : fir;</span><br><span class="line"><span class="keyword">int</span> r = max (x.r, now.first);</span><br><span class="line"><span class="keyword">if</span> (now.second) MS[x.id] = max (MS[x.id], r - x.l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fir = make_pair (INF, <span class="number">0</span>), sec = make_pair (INF, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.l &lt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (x.l, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x.l &lt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.l, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second? sec : fir;</span><br><span class="line"><span class="keyword">int</span> l = min (x.l, now.first);</span><br><span class="line"><span class="keyword">if</span> (now.second) MS[x.id] = max (MS[x.id], x.r - l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">minval = INF; grvy (n, x, <span class="number">0</span>);</span><br><span class="line">visit[rt] = <span class="literal">true</span>;</span><br><span class="line">work ();</span><br><span class="line">grvy (n, rt, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[rt]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">divide (subsize[v], v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> fail[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doit</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line">pair&lt;int, int&gt; fir (- INF, 0), sec (- INF, 0);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[u].size(); i ++) &#123;</span><br><span class="line">node x = a[u][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line"><span class="keyword">if</span> (now.second &amp;&amp; x.r &lt; now.first) fail[x.id] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (MS[x.id] &gt;= mid || x.r - x.l &gt;= mid) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (x.l + mid &gt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (x.l + mid, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x.l + mid &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.l + mid, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fir = make_pair (INF, <span class="number">0</span>), sec = make_pair (INF, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = a[u].size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">node x = a[u][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line"><span class="keyword">if</span> (now.second &amp;&amp; x.l &gt; max (x.r, now.first) - mid) fail[x.id] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (MS[x.id] &gt;= mid) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (x.r &lt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (x.r, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x.r &lt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.r, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) fail[i] = type[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) doit (i, mid);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! fail[i])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) type[i] = getnum ();</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) sum += type[i];</span><br><span class="line"><span class="keyword">if</span> (sum &gt;= N - <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (sum == N) &#123; <span class="built_in">puts</span> (<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! type[i]) &#123;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d 0\n"</span>, i);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> maxi = <span class="number">0</span>, mini = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">maxi = max (maxi, w); mini = min (mini, w);</span><br><span class="line">&#125;</span><br><span class="line">divide (N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> left = <span class="number">0</span>, right = maxi - mini, ans;</span><br><span class="line"><span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (check (mid)) &#123; ans = mid; left = mid + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="keyword">else</span> right = mid - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">check (ans);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! fail[i]) &#123;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d %d\n"</span>, i, ans);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁÇπÂàÜÊ≤ª </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> ExGCD </tag>
            
            <tag> ÊúÄÂ∞èÁîüÊàêÊ†ë </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅÂÖ´Ôºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AB%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AB%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>‰ªäÊó•‰æùÊóß‰∏âÈÅìÈõÜËÆ≠ÈòüÂéüÈ¢òÔºåÊó†ÈÉ®ÂàÜÂàÜÔºåËøûÁª≠‰∏âÊ¨°</p><p>ÁúüËØ•ÈóÆÂÄôÊê¨È¢ò‰∫∫‰ªñÊØç‰∫≤Â§ß‰∫∫</p><p>$\text{scoreÔºöNULL   rkÔºöNULL}$</p><h2 id="Problem-AÔºöSasha-And-Circles"><a href="#Problem-AÔºöSasha-And-Circles" class="headerlink" title="Problem AÔºöSasha And Circles"></a>Problem AÔºöSasha And Circles</h2><h2 id="Problem-BÔºöChoosing-Ads"><a href="#Problem-BÔºöChoosing-Ads" class="headerlink" title="Problem BÔºöChoosing Ads"></a>Problem BÔºöChoosing Ads</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $n$ ÁöÑÂ∫èÂàóÂíå‰∏Ä‰∏™Êï¥Êï∞ $p$„ÄÇ</p><p>Êúâ $m$ ‰∏™Êìç‰ΩúÔºåÊìç‰ΩúË¶Å‰πàÊòØÂå∫Èó¥ËµãÂÄºÔºåË¶Å‰πàÊòØËØ¢ÈóÆÂå∫Èó¥ÂÜÖÂá∫Áé∞Ê¨°Êï∞Ëá≥Â∞ëÂç† $p\%$ ÁöÑÊï∞„ÄÇ</p><p>ËæìÂá∫ËØ¢ÈóÆÁöÑÁ≠îÊ°àÊó∂ÔºåÂèØ‰ª•ÂåÖÂê´ÈîôÁöÑÊï∞Ôºå‰πüÂèØ‰ª•ÈáçÂ§çËæìÂá∫Ôºå‰ΩÜÂØπÁöÑÊï∞‰∏ÄÂÆöË¶ÅÂú®Á≠îÊ°à‰∏≠Ôºå‰∏îËæìÂá∫ÁöÑÊï∞ÁöÑ‰∏™Êï∞‰∏çË∂ÖËøá $\lfloor \frac{100}p \rfloor$</p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$n, m \le 1.5 \times 10^5, ~ 20 \le p \le 100$</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂÖàËÄÉËôë $p = 51$ ÁöÑÊÉÖÂÜµÔºåÂæàÊòéÊòæÂ∞±ÊòØÊ±ÇÂå∫Èó¥‰ºóÊï∞</p><p>Êúâ‰∏Ä‰∏™ÁªèÂÖ∏Âå∫Èó¥‰ºóÊï∞Â•óË∑ØÔºåÁªôÊï∞Â≠ó $i$ ‰∏Ä‰∏™Êï∞ÁªÑ $c_i$ÔºåËÆæÂΩìÂâç‰ºóÊï∞ $p$ÔºåÊØèÊ¨°Âä†‰∏Ä‰∏™Êï∞Â≠ó $t$ÔºåËã•ËØ•Êï∞Â≠óÁ≠â‰∫é $p$ÔºåÂàô $c_p ++$ÔºåÂèç‰πãÂàô $c_p ‚Äì$ÔºåËã•Âà†Ââç $c_p = 0$ÔºåÂàô $p = t$ÔºåÂêåÊó∂ $c_p = 1$</p><p>ËøôÊ†∑Â≠êËôΩÁÑ∂Ê≤°ÊúâËÆ°ÁÆóÊØèÁßçÊï∞Â≠óÁöÑÂá∫Áé∞Ê¨°Êï∞Ôºå‰ΩÜ‰øùÁïô‰∫ÜÁõ∏ÂØπÊï∞Â≠ó‰∏™Êï∞Â§ßÂ∞èÁöÑÂÖ≥Á≥ªÔºåÊØïÁ´üËã•‰∏Ä‰∏™Êï∞ÁöÑÂá∫Áé∞Ê¶ÇÁéá $&gt; 50\%$ÔºåÂàôÂÆÉÂøÖÂÆö‰ºöÁïôÂà∞ÊúÄÂêé</p><p>ÈÇ£‰πàÁé∞Âú®ËÄÉËôë $20 \le p \le 50$ÔºåÂàôËÄÉËôëÂ≠òÊØè‰∏™Âá∫Áé∞Ê¨°Êï∞Ëá≥Â∞ëÂç† $p\%$ ÁöÑÊï∞ÔºåÂàôÂÆÉ‰ª¨ÊúÄÂ§ö $5$ ‰∏™ÔºåÂú®Á∫øÊÆµÊ†ë‰∏äÁª¥Êä§ÔºåÊØèÊ¨°Âä†ÂÖ•‰∏Ä‰∏™Êï∞ÔºåËã•ÂÆÉ‰∏éÂÖ∂‰∏≠‰∏Ä‰∏™Êï∞Áõ∏Á≠âÂàôÂØπÂ∫îÁöÑÊï∞ÁöÑ $c$ Âä†‰∏ÄÔºåÂèç‰πãÊâÄÊúâÊï∞ÁöÑ $c$ Âáè‰∏ÄÔºåÁÑ∂ÂêéÁî®ËØ•Êï∞Êõø‰ª£ÊúÄÁªàÂ∫îÂΩìË¢´Êõø‰ª£ÁöÑÊï∞ÔºåÂêàÂπ∂Â§çÊùÇÂ∫¶ÊúÄÂ§ö $5 \times 5 = 25$ÔºåÂ§çÊùÇÂ∫¶Ê≠£Á°Æ</p><p>Â§çÊùÇÂ∫¶ $O (nk^2 \log n)$ÔºåÂÖ∂‰∏≠ $k = \lfloor \frac{100}p \rfloor$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">15e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, Q, P, m;</span><br><span class="line"><span class="keyword">int</span> ori[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">6</span>], cnt[<span class="number">6</span>], n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (a, <span class="number">0</span>, <span class="keyword">sizeof</span> (a));</span><br><span class="line"><span class="built_in">memset</span> (cnt, <span class="number">0</span>, <span class="keyword">sizeof</span> (cnt));</span><br><span class="line">n = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> <span class="keyword">operator</span> = (<span class="keyword">const</span> node&amp; p) &#123;</span><br><span class="line">n = p.n;</span><br><span class="line"><span class="built_in">memcpy</span> (a, p.a, <span class="keyword">sizeof</span> (a));</span><br><span class="line"><span class="built_in">memcpy</span> (cnt, p.cnt, <span class="keyword">sizeof</span> (cnt));</span><br><span class="line">&#125;</span><br><span class="line">node <span class="keyword">operator</span> + (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">node ret = p;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">bool</span> in = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ret.n; j ++)</span><br><span class="line"><span class="keyword">if</span> (a[i] == ret.a[j]) &#123;</span><br><span class="line">ret.cnt[j] += cnt[i];</span><br><span class="line">in = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (in) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (ret.n &lt; m) &#123;</span><br><span class="line">ret.a[++ ret.n] = a[i];</span><br><span class="line">ret.cnt[ret.n] = cnt[i];</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ret.n; j ++)</span><br><span class="line"><span class="keyword">if</span> (k == <span class="number">0</span> || ret.cnt[j] &lt; ret.cnt[k])</span><br><span class="line">k = j;</span><br><span class="line"><span class="keyword">if</span> (ret.cnt[k] &gt; cnt[i]) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ret.n; j ++) ret.cnt[j] -= cnt[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> tp = ret.cnt[k];</span><br><span class="line">ret.a[k] = a[i]; ret.cnt[k] = cnt[i] - ret.cnt[k];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ret.n; j ++)</span><br><span class="line"><span class="keyword">if</span> (j != k)</span><br><span class="line">ret.cnt[j] -= tp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">node T[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> lazy[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">setup</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">T[root].a[T[root].n = <span class="number">1</span>] = x;</span><br><span class="line">T[root].cnt[<span class="number">1</span>] = right - left + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">T[root].init ();</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">setup (root, left, right, ori[left]);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid); build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">T[root] = T[lson] + T[rson];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! lazy[root]) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">setup (lson, left, mid, lazy[root]);</span><br><span class="line">setup (rson, mid + <span class="number">1</span>, right, lazy[root]);</span><br><span class="line">lazy[lson] = lazy[rson] = lazy[root];</span><br><span class="line">lazy[root] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) &#123;</span><br><span class="line">setup (root, left, right, x);</span><br><span class="line">lazy[root] = x;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">pushdown (root, left, right);</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) modify (lson, left, mid, L, R, x);</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) modify (rson, mid + <span class="number">1</span>, right, L, R, x);</span><br><span class="line">T[root] = T[lson] + T[rson];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) <span class="keyword">return</span> T[root];</span><br><span class="line">pushdown (root, left, right);</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">node ret; ret.init ();</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) ret = ret + query (lson, left, mid, L, R);</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) ret = ret + query (rson, mid + <span class="number">1</span>, right, L, R);</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), Q = getnum (), P = getnum (); m = <span class="number">100</span> / P;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ori[i] = getnum ();</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= Q; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> type = getnum ();</span><br><span class="line"><span class="keyword">if</span> (type == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum (), id = getnum ();</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, N, l, r, id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">node ans = query (<span class="number">1</span>, <span class="number">1</span>, N, l, r);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, ans.n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ans.n; i ++) <span class="built_in">printf</span> (<span class="string">" %d"</span>, ans.a[i]);</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-CÔºöDistance-Sums"><a href="#Problem-CÔºöDistance-Sums" class="headerlink" title="Problem CÔºöDistance Sums"></a>Problem CÔºöDistance Sums</h2><h3 id="È¢òÁõÆÊèèËø∞-1"><a href="#È¢òÁõÆÊèèËø∞-1" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ÁªôÂá∫ $n$ ‰∏™‰∫í‰∏çÁõ∏ÂêåÁöÑÊï∞ $d_i$ÔºåË°®Á§∫Ê†ë‰∏äÁöÑËäÇÁÇπ $i$ Âà∞ÂÖ∂‰ªñÊâÄÊúâÁÇπÁöÑË∑ùÁ¶ªÂíå„ÄÇ</p><p>ËØ∑Âà§Êñ≠ÊòØÂê¶Â≠òÂú®ËøôÊ†∑‰∏ÄÊ£µÊ†ëÔºåÂÖ∂‰∏≠ÊØèÊù°ËæπÁöÑÈïøÂ∫¶Âùá‰∏∫ $1$„ÄÇËã•Â≠òÂú®ËØ∑ËæìÂá∫‰∏ÄÁßçÊñπÊ°àÔºåÂê¶ÂàôËæìÂá∫ <code>-1</code>„ÄÇ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-1"><a href="#Êï∞ÊçÆËåÉÂõ¥-1" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n \le 10^5, ~ 1 \le d_i \le 10^{12}$</p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËøôÈ¢òÊÑüËßâÊòØ‰∏ÄÁõ¥Êù•ÂÅöÁöÑÊØîËæÉÊ∞¥ÁöÑ„ÄÇ„ÄÇ</p><p>ÂÖàÁªôÊâÄÊúâÁªìÁÇπ $i$ Êåâ $d_i$ Êéí‰∏™Â∫èÔºåÂ∞Ü $d$ ÊúÄÂ∞èÁöÑÁúã‰ΩúÊ†πËäÇÁÇπÔºåÈÇ£‰πàÊòæÁÑ∂Â≠êÁªìÁÇπÁöÑ $d$ ÊØîÂÖ∂Á•ñÂÖàËäÇÁÇπÂ∞è</p><p>ËÆæÁªìÁÇπ $u$ Â≠êÊ†ëÂ§ßÂ∞è $s_u$ÔºåÂàôËÄÉËôëÁî± $u$ Ëµ∞Âà∞ÂÖ∂Â≠êÁªìÁÇπ $v$ Êó∂ $d$ ÁöÑÂ¢ûÈáèÔºåÊúâ $\Delta d = n - 2s_v$</p><p>ÈÇ£‰πà‰ªéÊéíÂ∫èÂêéÁ¨¨ $n$ ‰∏™ÁªìÁÇπÂºÄÂßãÂæÄ‰∏äÊâ´ÔºåÊØèÊ¨°Â∞ÜÂÆÉ‰∏éËÆ°ÁÆóÂêé‰∏éÂÆÉÁõ∏ËøûÁöÑÁà∂ÁªìÁÇπËøûËæπÔºåÂ¶ÇËã•Êâæ‰∏çÂà∞Áà∂ÁªìÁÇπÂàôÊó†Ëß£</p><p>Ê≥®ÊÑèÊúÄÂêéÂª∫ÂÆåÊ†ëË¶ÅËÆ°ÁÆóÊñ∞Âª∫Âá∫ÁöÑÊ†ëÁöÑÊ†πËäÇÁÇπÁöÑ $d$ ÊòØÂê¶‰∏éËæìÂÖ•ÊâÄÁªôÁõ∏Âêå</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">pair&lt;LL, <span class="keyword">int</span>&gt; d[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;, fa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt; <span class="number">1</span>; i --) &#123;</span><br><span class="line">subsize[d[i].second] ++;</span><br><span class="line"><span class="keyword">int</span> up = N - <span class="number">2</span> * subsize[d[i].second];</span><br><span class="line"><span class="keyword">if</span> (up &lt; <span class="number">0</span>) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="built_in">exit</span> (<span class="number">0</span>); &#125;</span><br><span class="line"><span class="keyword">int</span> p = lower_bound (d + <span class="number">1</span>, d + N + <span class="number">1</span>, make_pair (d[i].first - up, <span class="number">0</span>)) - d;</span><br><span class="line"><span class="keyword">if</span> (p &gt;= i || d[p].first != d[i].first - up) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="built_in">exit</span> (<span class="number">0</span>); &#125;</span><br><span class="line">fa[d[i].second] = d[p].second;</span><br><span class="line">subsize[d[p].second] += subsize[d[i].second];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line">LL dist[MAXN]= &#123;<span class="number">0</span>&#125;, total = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123;</span><br><span class="line">total += dist[root];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) G[root].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = G[root][i];</span><br><span class="line">dist[v] = dist[root] + <span class="number">1</span>;</span><br><span class="line">DFS (v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) d[i].first = getnum (), d[i].second = i;</span><br><span class="line">sort (d + <span class="number">1</span>, d + N + <span class="number">1</span>);</span><br><span class="line">solve ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) G[fa[d[i].second]].push_back(d[i].second);</span><br><span class="line">DFS (d[<span class="number">1</span>].second);</span><br><span class="line"><span class="keyword">if</span> (total != d[<span class="number">1</span>].first) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d %d\n"</span>, fa[d[i].second], d[i].second);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊÄùÁª¥ </tag>
            
            <tag> Á∫øÊÆµÊ†ë </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅ‰∫îÔºâ</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%94%EF%BC%89/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%94%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>‰ªäÂ§©ÊúâÁÇπ‰∫∫ÂìÅÔºåT1ÁöÑ50ptsÊö¥ÂäõÊÄíÂéãÊ≠£Ëß£„ÄÇ„ÄÇËøôÊï∞ÊçÆ„ÄÇ„ÄÇ‰∏çË®ÄËÄåÂñª</p><p>$\text{score: 100 + 0 + 0 = 100   rk: 7/36}$</p><h2 id="Problem-AÔºöÊó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏à"><a href="#Problem-AÔºöÊó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏à" class="headerlink" title="Problem AÔºöÊó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏à"></a>Problem AÔºöÊó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏à</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>‰ºóÊâÄÂë®Áü•ÔºåÁΩóËÄÅÂ∏àÊòØÊó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏à</p><p>Âõ†‰∏∫ÁΩóËÄÅÂ∏àÊòØÊó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏àÔºåÊâÄ‰ª•‰ªñÁöÑÊó∂Èó¥ÊòØ‰ª•‰∏ú‰∏∫Âçï‰ΩçÁöÑ</p><p>ÂÖ∑‰ΩìÊù•ËÆ≤ÔºåÁΩóËÄÅÂ∏à‰∏ÄÂ§©Êúânn‰∏úÁöÑÊó∂Èó¥</p><p>Áé∞Âú®ÊúâÂæàÂ§öÂ¶πÂ≠êÊÉ≥Ë∑üÁΩóËÄÅÂ∏àÁ∫¶‰ºö</p><p>Â•áÁâπÁöÑÔºåÂ•π‰ª¨ÊØèÂ§©ÊÄª‰ºöÊèêÂá∫‰∏§ÊÆµÁ∫¶‰ºöÊó∂Èó¥ÔºàÂèØËÉΩÁõ∏ÂêåÔºå‰ª£Ë°®‰∏ÄÁßçÔºâÔºåÂπ∂‰∏îÊØèÂ§©ÊèêÂá∫ÁöÑÊÄªÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ</p><p>Â•π‰ª¨ÊèêÂá∫ÁöÑÁ∫¶‰ºöÊó∂Èó¥ÂΩ¢ÂºèÂΩ¢Â¶Çi,j,‰ª£Ë°®Â∏åÊúõÂú®[i‰∏ú,(i+1)‰∏ú)[i‰∏ú,(i+1)‰∏ú)Êàñ[j‰∏ú,(j+1)‰∏ú)[j‰∏ú,(j+1)‰∏ú)‰∏éÁΩóËÄÅÂ∏àËøõË°åÁ∫¶‰ºö„ÄÇ</p><p>ÂΩìÁÑ∂ÔºåÁΩóËÄÅÂ∏àÂèØ‰ª•Ëøô‰∏§ÊÆµÊó∂Èó¥ÈÉΩ‰∏éËøô‰∏™Â¶πÂ≠êÁ∫¶‰ºö,Âè™ÈÄâÊã©‰∏ÄÊÆµÔºåÊàñËÄÖ‰º§ÂøÉÂú∞ÊäõÂºÉ„ÄÇ</p><p>ÈÇ£‰πàÔºå‰Ωú‰∏∫Êó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏àÁöÑÁΩóËÄÅÂ∏àÔºå<strong>ÊØèÂ§©‰ºöÈÄâÊã©Â∞ΩÂèØËÉΩÂ§öÁöÑÂ¶πÂ≠êËøõË°åÁ∫¶‰ºö</strong></p><p>‰ΩÜ‰Ω†‰∏ÄÂÆöË¶ÅÊ≥®ÊÑè,<strong>ÁΩóËÄÅÂ∏àÊúÄËøëÂπ∂‰∏çÊâìÁÆóËøõË°åÂ§ö‰∫∫ËøêÂä®ÔºåÊâÄ‰ª•‰ªñ‰∏ç‰ºöÂú®1‰∏úÁöÑÊó∂Èó¥ÂêåÊó∂‰∏é‰∏§‰∏™ÊàñÂ§ö‰∏™Â¶πÂ≠êÁ∫¶‰ºö</strong></p><p><strong>ÁΩóËÄÅÂ∏àÂπ∂‰∏çËÑ∏Áõ≤Ôºå‰∏é‰∏Ä‰∏™Â¶πÂ≠êÁ∫¶‰ºö2Ê¨°Âπ∂‰∏çËÉΩÁÆóÊàê‚Äù2‚ÄùÊ¨°ÁöÑË¥°ÁåÆÔºåÂè™ËÉΩÊòØ‚Äù1‚Äù</strong></p><p><strong>ÁΩóËÄÅÂ∏àÊòØÊó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏àÔºåÂè™Ë¶ÅÊª°Ë∂≥‰ª•‰∏äÊù°‰ª∂Ôºå‰ªñÂ∞±ÂèØ‰ª•ÂÆâÊéíÂ•Ω‰ªñÁöÑÊó∂Èó¥Ôºå‰∏çÁî®ÊãÖÂøÉÂà´ÁöÑ</strong></p><p><strong>ËÄå‰∏î,ÊØèÂ§©ÂèØËÉΩ‰ºöÊúâÊñ∞ÁöÑÂ¶πÂ≠êÂêëÁΩóËÄÅÂ∏àÊèêÂá∫Á∫¶‰ºöÈÇÄËØ∑</strong></p><p><strong>‰ΩÜÊòØÊó∂Èó¥‰πÖ‰∫ÜÔºå‰∏Ä‰∫õÂ¶πÂ≠êËÆ§ËØÜÂà∞<del>ÁΩóËÄÅÂ∏àÊòØ‰∏™Ê∏£Áî∑</del>ÁΩóËÄÅÂ∏àÂ§™Âøô‰∫ÜÔºåÂ∞±‰∏çÂÜçÁªôÁΩóËÄÅÂ∏àÊèêÂá∫Á∫¶‰ºöÈÇÄËØ∑</strong></p><p><strong>ÊØèÂ§©Ë¶Å‰πàÊúâÂ¶πÂ≠êÂä†ÂÖ•ÔºåË¶Å‰πàÊúâÂ¶πÂ≠êÈÄÄÂá∫ÔºåËøô‰∏§ÁßçÊÉÖÂÜµÊúâ‰∏î‰ªÖ‰ºöÂèëÁîü‰∏ÄÁßçÔºåÂπ∂‰∏îÈÄÄÂá∫ÁöÑÂ¶πÂ≠ê‰∏ÄÂÆöÊòØÂΩìÂâçÊÉ≥Ë¶ÅÂíåÁΩóËÄÅÂ∏àÁ∫¶‰ºöÁöÑÂ¶πÂ≠ê‰∏≠Êó∂Èó¥ÊúÄ‰πÖÁöÑ„ÄÇÂÖ∂ÂÆûÔºåËøôÂ∞±ÂØπÂ∫î‰∫ÜÂèåÁ´ØÈòüÂàóÁöÑpushÂíåpop„ÄÇÊàë‰ª¨‰øùËØÅÔºåÁΩóËÄÅÂ∏àÊØèÂ§©ÁöÑÂ¶πÂ≠êÊï∞ÈáèÈùûË¥ü</strong></p><p>Áé∞Âú®Ôºå‰Ωú‰∏∫ÁΩóËÄÅÂ∏àÁöÑË¥¥Ë∫´Áßò‰π¶Ôºå‰Ω†ÊØèÂ§©Ë¶ÅÁªôÁΩóËÄÅÂ∏àËßÑÂàíÂ•Ω‰ªñÁöÑÊó∂Èó¥ÔºåÊØèÂ§©ÂëäËØâÁΩóËÄÅÂ∏à‰ªñ‰ªäÂ§©ÊúÄÂ§öÂèØ‰ª•Á∫¶‰ºöÂ§öÂ∞ë‰∏™Â¶πÂ≠ê</p><p>‰∏çËøáÊú¨È¢ò‰∏≠ÔºåÊìç‰ΩúÂèØ‰ª•Âº∫Âà∂Âú®Á∫ø</p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n, m \le 10^5, 0 \le type \le 1, 0 \le op, a, b \le 10^6$</p><p>ÂÖ∂‰∏≠ $a, b$ Ë°®Á§∫Â¶πÂ≠êÁöÑÁ∫¶‰ºöÊó∂Èó¥‰∏∫ $a, b$</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËøôÁ•ûÂ•áÁöÑÈ¢òÁõÆÊèèËø∞ÔºåÁúüÁöÑÊó∂Èó¥ÁÆ°ÁêÜÂ∏¶Â∏à</p><p>ÂÖàËÄÉËôëÊö¥ÂäõÔºåÊØèÊ¨°ÊõøÊç¢ÂÆûÈôÖ‰∏äÂ∞±ÊòØ‰∏Ä‰∏™Á±ª‰ººÂåàÁâôÂà©ÁÆóÊ≥ïÁöÑ‰∏úË•øÔºåÁÑ∂ÂêéÂÆÉÂè™Âà†ÈòüÈ¶ñÁöÑÂ¶πÂ≠êÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÂ∞ΩÂèØËÉΩËÆ©ÈòüÈ¶ñÁöÑÂ¶πÂ≠êÂØπÁ≠îÊ°àÊó†ÂΩ±ÂìçÔºåÊâÄ‰ª•ÊØèÊ¨°ÈòüÂ∞æÂä†ÂÖ•‰∏Ä‰∏™Â¶πÂ≠êÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÂà§Êñ≠Âá∫ÂèØ‰ª•‰∏∫Â•πÂáëÂá∫‰∏Ä‰∏™È¢ùÂ§ñÁöÑ‰ΩçÁΩÆÈÇ£Â∞±Áõ¥Êé•ÂÅöÔºåÂä†ÂÖ•‰∏çË°åÂàôÊõøÊç¢ÊéâÂÖ∂‰∏≠ÊúÄÊó©ÂÖ•ÈòüÁöÑÂ¶πÂ≠êÔºàÂÆûÈôÖ‰∏äËøôÊï¥‰∏™ÂèØ‰ª•ÁúãÊàêÂ§öÊ£µÂÜÖÂêëÂü∫ÁéØÊ†ëÔºåÂç≥ÂÅáÂ¶ÇÁºñÂè∑‰∏∫ $i$ ÁöÑÂ¶πÂ≠êÂç†‰∫Ü‰∏Ä‰∏™‰ΩçÁΩÆÔºåÂπ∂‰∏îÂç†ÁöÑÊòØÁ∫¶‰ºöÊó∂Èó¥ $a$ÔºåÈÇ£‰πàÂ•πÂ∞±Ëøû‰∏ÄÊù° $a \rightarrow b$ ÁöÑÊúâÂêëËæπÔºåÂπ∂ÁªôËøô‰∏™Ëæπ‰ª•ÂÖ•ÈòüÈ°∫Â∫èÁöÑÁºñÂè∑ÔºåÈÇ£‰πàÊØè‰∏ÄÊ¨°Á±ª‰ººÂåàÁâôÂà©ÁÆóÊ≥ïÁöÑËøáÁ®ãÂç≥ÊòØËøô‰∏™Âõæ‰∏≠ÁöÑ‰∏ÄÊù°ÈìæÔºåÈÇ£‰πàÂ∞±ÂèñÁºñÂè∑ÊúÄÂ∞èÁöÑËæπÂ∞±Ë°å‰∫ÜÔºâÔºåÈÇ£‰πàÂú®Âà†ÈòüÈ¶ñÂ¶πÂ≠êÁöÑÊó∂ÂÄôÂ•πÂ∞±Âè™ÊúâÂØπÁ≠îÊ°àÊó†ÂΩ±ÂìçÊàñËÄÖÂç†‰∫Ü‰∏Ä‰∏™‰ΩçÁΩÆËÄå‰ΩøÁ≠îÊ°àÂáè‰∏Ä‰∏§ÁßçÊÉÖÂÜµ‰∫Ü</p><p>Ëøô‰∏™ÁêÜËÆ∫Â§çÊùÇÂ∫¶ÊòæÁÑ∂‰∏çËÉΩËøáÔºåÈöè‰æøÂá∫‰∏™‰∏ÄÊù°ÈìæÁöÑÊï∞ÊçÆÂ∞±Âç°Êéâ‰∫ÜÔºå‰ΩÜÊàëËøòÊòØÁ®çÂæÆÊîæ‰∏Ä‰∏ãÂÆÉÁöÑ‰ª£Á†Å</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXA = <span class="number">1e06</span> + <span class="number">10</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> A, M, type;</span><br><span class="line"><span class="keyword">int</span> ns = <span class="number">1</span>, ne = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> posi[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">bool</span> visit[MAXA]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> who[MAXA]= &#123;<span class="number">0</span>&#125;, use[MAXN]= &#123;<span class="number">0</span>&#125;, in[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">pair&lt;int, int&gt; findpos (int u) &#123; // pair&lt;int, int&gt; ÂàÜÂà´Ë°®Á§∫ÊâæÂà∞ÁöÑÁ©∫Â∫ß‰Ωç‰∏éÂç†‰ΩçÁΩÆÁöÑÁºñÂè∑ÊúÄÂ∞èÂ¶πÂ≠ê</span><br><span class="line">    <span class="keyword">if</span> (visit[u]) <span class="keyword">return</span> make_pair (- <span class="number">1</span>, who[u]);</span><br><span class="line">    <span class="keyword">if</span> (! who[u]) <span class="keyword">return</span> make_pair (u, <span class="number">0</span>);</span><br><span class="line">    visit[u] = <span class="literal">true</span>;</span><br><span class="line">    pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ret = findpos (posi[who[u]][use[who[u]] ^ <span class="number">1</span>]);</span><br><span class="line">    visit[u] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> make_pair (ret.first, min (ret.second, who[u]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">select</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> aim)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (visit[u]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (u == aim) &#123;</span><br><span class="line">        in[who[u]] = <span class="number">0</span>; who[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    visit[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> ((suc = select (posi[who[u]][use[who[u]] ^ <span class="number">1</span>], aim))) &#123;</span><br><span class="line">        <span class="keyword">int</span> p = who[u]; who[u] = <span class="number">0</span>;</span><br><span class="line">        use[p] ^= <span class="number">1</span>; in[p] = posi[p][use[p]];</span><br><span class="line">        who[in[p]] = p;</span><br><span class="line">    &#125;</span><br><span class="line">    visit[u] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> suc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> tp)</span> </span>&#123;</span><br><span class="line">    use[p] = tp, in[p] = posi[p][tp];</span><br><span class="line">    who[in[p]] = p;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    A = getnum (), M = getnum (), type = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> op, a, b;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">0</span>) &#123;</span><br><span class="line">            op = getnum ();</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">1</span>) a = getnum (), b = getnum ();  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            op = (getnum () + ans) % <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">1</span>) a = (getnum () + ans) % A + <span class="number">1</span>, b = (getnum () + ans) % A + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            posi[++ ne][<span class="number">0</span>] = a, posi[ne][<span class="number">1</span>] = b;</span><br><span class="line">            pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ret1 = findpos (a), ret2;</span><br><span class="line">            <span class="keyword">if</span> (ret1.first == - <span class="number">1</span>) &#123;</span><br><span class="line">                ret2 = findpos (b);</span><br><span class="line">                <span class="keyword">if</span> (~ ret2.first) &#123;</span><br><span class="line">                    select (b, ret2.first); add (ne, <span class="number">1</span>);</span><br><span class="line">                    ans ++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (ret1.second &lt; ret2.second) &#123;</span><br><span class="line">                    select (posi[ne][<span class="number">0</span>], in[ret1.second]);</span><br><span class="line">                    add (ne, <span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    select (posi[ne][<span class="number">1</span>], in[ret2.second]);</span><br><span class="line">                    add (ne, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123; select (a, ret1.first); add (ne, <span class="number">0</span>), ans ++; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (in[ns]) &#123;</span><br><span class="line">                ans --;</span><br><span class="line">                who[in[ns]] = <span class="number">0</span>; in[ns] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ns ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÈÇ£‰πàÊé•‰∏ãÊù•Â∞±ÊòØÊ≠£Ëß£ÔºåÁî® $\text{LCT}$ Êù•Áª¥Êä§Ëøô‰∏™ÊúÄÂ∞èÁºñÂè∑Â¶πÂ≠ê</p><p>Áé∞Âú®ÂÖàËÄÉËôëËøûËæπÊï¥Âá∫Êù•ÁöÑËøûÈÄöÂùóÔºåËÆæËØ•ËøûÈÄöÂùóÊúâÁÇπ $x$ ‰∏™ÔºåËæπ $y$ ‰∏™ÔºåÈÇ£‰πàÊòæÁÑ∂Ëã• $x &gt; y$ÔºåÂàôÁ≠îÊ°à‰∏∫ $x - 1$ÔºåËã• $x \le y$ÔºåÂ∞±‰ª£Ë°®ÊúâÁéØÔºåÈÇ£‰πàÁ≠îÊ°àÂç≥‰∏∫ $x$</p><p>Áé∞Âú®ËÄÉËôëÁî® $\text{LCT}$ Êù•Áª¥Êä§ÔºåÈ¶ñÂÖàÊääËøô‰∏™ËøûÈÄöÂùóÈáåÈÄâÊã©ÁöÑËäÇÁÇπÊäΩÊàê‰∏ÄÊ£µÊ†ëÔºåÂπ∂‰∏îËæπÂåñÁÇπÔºåÈÇ£‰πàÂâ©‰∏ãÁöÑËæπÊó†Ê≥ïÂú® $\text{LCT}$ ‰∏≠Ë°®Á§∫Ôºå‰ΩÜÊòØÂè™Ë¶ÅÂ≠òÂú®ÂÖ∂‰∏≠‰∏ÄÊù°Â∞±ËØ¥Êòé‰∏ÄÂÆö‰ºöÊûÑÊàêÁéØÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄÁªüËÆ°ÊØè‰∏™ÁÇπÂÆÉ‰ºöËøûÂ§öÂ∞ëËøôÊ†∑ÁöÑËæπÂç≥ÂèØ</p><p>ÊØèÊ¨°Âà† $\text{LCT}$ ‰∏≠ËæπÁöÑÊó∂ÂÄôÔºåÂà†ÂÆåËæπÂ∞±ÁªôËØ•ËæπËøûÊé•ÁöÑ‰∏§‰∏™ÁÇπÊùÉÂÄºÂêÑÂä†‰∏ÄÔºåËØ¥ÊòéÂÆÉ‰ª¨‰πãÈó¥ÁöÑËæπÂèòÊàê‰∫Ü‰ΩøÊàêÁéØÁöÑËæπÔºåÈÇ£‰πàÂ∞±ÂæóÊõ¥Êñ∞Á≠îÊ°àÔºõÂêåÁêÜÂä†ËæπÂàôÊääÂÆÉ‰ª¨ÂéüÊù•Âä†‰∏äÁöÑÊùÉÂÄºÂáèÊéâ</p><p>ÊÑüËßâËØ¥‰∏çÊ∏ÖÊ•öÂÖ∑‰ΩìËøòÊòØÁúã‰ª£Á†ÅÊ≥®ÈáäÂêß</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, type, n;</span><br><span class="line"><span class="keyword">int</span> posi[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">// n: ËæπÂåñÁÇπ</span></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;, son[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> rev[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> vimi[MAXN]= &#123;<span class="number">0</span>&#125;, fic[MAXN]= &#123;<span class="number">0</span>&#125;, vism[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">// ÂΩìÂâçËäÇÁÇπËøûÁöÑÈùûÊ†ëËäÇÁÇπ‰∏™Êï∞„ÄÅÂΩìÂâçËäÇÁÇπËôöÂ≠êÊ†ëvimiÂíå„ÄÅÂΩìÂâçËäÇÁÇπËôöÂÆûÂ≠êÊ†ëvimiÂíå</span></span><br><span class="line"><span class="keyword">int</span> mini[MAXN]= &#123;<span class="number">0</span>&#125;; <span class="comment">// ÊúÄÊó©ÂÖ•ÈòüËæπ</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> son[father[p]][<span class="number">0</span>] != p &amp;&amp; son[father[p]][<span class="number">1</span>] != p; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sonbel</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> son[father[p]][<span class="number">1</span>] == p; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! p) <span class="keyword">return</span> ;</span><br><span class="line">swap (son[p][<span class="number">0</span>], son[p][<span class="number">1</span>]); rev[p] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">vism[p] = vimi[p] + fic[p] + vism[son[p][<span class="number">0</span>]] + vism[son[p][<span class="number">1</span>]];</span><br><span class="line">mini[p] = min (p &lt;= N ? INF : p, min (mini[son[p][<span class="number">0</span>]], mini[son[p][<span class="number">1</span>]]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! rev[p]) <span class="keyword">return</span> ;</span><br><span class="line">reverse (son[p][<span class="number">0</span>]), reverse (son[p][<span class="number">1</span>]);</span><br><span class="line">rev[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fa = father[p], anc = father[fa];</span><br><span class="line"><span class="keyword">int</span> s = sonbel (p);</span><br><span class="line">son[fa][s] = son[p][s ^ <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (son[fa][s]) father[son[fa][s]] = fa;</span><br><span class="line"><span class="keyword">if</span> (! isroot (fa)) son[anc][sonbel (fa)] = p;</span><br><span class="line">father[p] = anc;</span><br><span class="line">son[p][s ^ <span class="number">1</span>] = fa, father[fa] = p;</span><br><span class="line">pushup (fa), pushup (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">stack</span>[MAXN], top;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">top = <span class="number">0</span>; <span class="built_in">stack</span>[++ top] = p;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> tp = p; ! isroot (tp); tp = father[tp]) <span class="built_in">stack</span>[++ top] = father[tp];</span><br><span class="line"><span class="keyword">while</span> (top &gt; <span class="number">0</span>) pushdown (<span class="built_in">stack</span>[top]), top --;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> fa = father[p]; ! isroot (p); rotate (p), fa = father[p])</span><br><span class="line"><span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">sonbel (p) == sonbel (fa) ? rotate (fa) : rotate (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">access</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> tp = <span class="number">0</span>; p; tp = p, p = father[p]) &#123;</span><br><span class="line">splay (p);</span><br><span class="line">fic[p] += vism[son[p][<span class="number">1</span>]] - vism[tp];</span><br><span class="line">son[p][<span class="number">1</span>] = tp; pushup (p);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">makeroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; access (p), splay (p); reverse (p); &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">access (p), splay (p);</span><br><span class="line"><span class="keyword">while</span> (son[p][<span class="number">0</span>]) &#123; pushdown (p); p = son[p][<span class="number">0</span>]; &#125;</span><br><span class="line">splay (p);</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">value</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> vism[p] &gt; <span class="number">0</span>; &#125; <span class="comment">// Âà§Êñ≠ÊòØÂê¶ÊàêÁéØÔºåËã•ÊàêÁéØÂàôÁ≠îÊ°àÈúÄË¶ÅÂÜçÁÇπ‰∏™Êï∞‰∏äÂä†‰∏Ä</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hideit</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> delta)</span> </span>&#123; <span class="comment">// Â∞ÜÊ†ë‰∏äËæπÂèò‰∏∫‰ΩøÊàêÁéØËæπ</span></span><br><span class="line">makeroot (p); ans -= value (p);</span><br><span class="line">vimi[p] += delta, pushup (p); ans += value (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> in[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">makeroot (x), makeroot (y);</span><br><span class="line">ans -= value (x) + value (y); <span class="comment">// Âà†ÂéªÂéüÊù•‰∏§‰∏™ÂàÜÂºÄÁöÑËøûÈÄöÂùóÁöÑË¥°ÁåÆÂÜçÂä†‰∏äÊñ∞ÂêàÊàêËøûÈÄöÂùóË¥°ÁåÆ</span></span><br><span class="line">ans ++; father[x] = father[y] = id;</span><br><span class="line">fic[id] += vism[x] + vism[y], pushup (id);</span><br><span class="line">ans += value (id); in[id] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cut</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">makeroot (x), access (y), splay (id);</span><br><span class="line">ans --, ans -= value (id);</span><br><span class="line">father[x] = father[y] = <span class="number">0</span>; ans += value (x) + value (y);</span><br><span class="line">in[id] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PUSH</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == y) &#123; hideit (x, <span class="number">2</span>); <span class="keyword">return</span> ; &#125;</span><br><span class="line">makeroot (x);</span><br><span class="line"><span class="keyword">if</span> (findroot (y) == x) &#123;</span><br><span class="line">access (y), splay (y); <span class="keyword">int</span> p = mini[y];</span><br><span class="line">cut (p, posi[p][<span class="number">0</span>], posi[p][<span class="number">1</span>]);</span><br><span class="line">hideit (posi[p][<span class="number">0</span>], <span class="number">1</span>), hideit (posi[p][<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">link (id, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">POP</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! in[id]) &#123;</span><br><span class="line">hideit (x, - <span class="number">1</span>), hideit (y, - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">cut (id, x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">n = N = getnum (), M = getnum (), type = getnum ();</span><br><span class="line"><span class="keyword">int</span> st = N + <span class="number">1</span>; mini[<span class="number">0</span>] = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> op, a, b;</span><br><span class="line"><span class="keyword">if</span> (type == <span class="number">0</span>) &#123;</span><br><span class="line">op = getnum ();</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">1</span>) a = getnum (), b = getnum ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">op = (getnum () + ans) % <span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">1</span>) a = (getnum () + ans) % N + <span class="number">1</span>, b = (getnum () + ans) % N + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">posi[++ n][<span class="number">0</span>] = a, posi[n][<span class="number">1</span>] = b; <span class="comment">// ++ nË°®Á§∫ËæπÂåñÁÇπ</span></span><br><span class="line">PUSH (n, a, b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; POP (st, posi[st][<span class="number">0</span>], posi[st][<span class="number">1</span>]); st ++; &#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöÂ§ßÁå´ÁÜäÂíå‰ªñÁöÑkËæπÂΩ¢"><a href="#Problem-BÔºöÂ§ßÁå´ÁÜäÂíå‰ªñÁöÑkËæπÂΩ¢" class="headerlink" title="Problem BÔºöÂ§ßÁå´ÁÜäÂíå‰ªñÁöÑkËæπÂΩ¢"></a>Problem BÔºöÂ§ßÁå´ÁÜäÂíå‰ªñÁöÑkËæπÂΩ¢</h2><h3 id="È¢òÁõÆÊèèËø∞-1"><a href="#È¢òÁõÆÊèèËø∞-1" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ËèúÈ∏°zjr‰ªäÂ§©Ë¢´‰∏ÄÈÅìÂπºÂÑøÂõ≠Âá†‰ΩïÈ¢òÊâìÁàÜ‰∫ÜÔºå‰∏ÄÂàÜÈÉΩÊãø‰∏çÂà∞„ÄÇ</p><p>‰∫éÊòØ‰ªñÂêë‰Ω†Ê±ÇÂä©QwQ:</p><p>ÁªôÂÆö $n,k$ÔºåÊ±ÇÂá∫ $i(k \le i \le n)$ ËæπÂΩ¢ÁöÑÊâÄÊúâ‰∏âËßíÂâñÂàÜ‰∏≠, $k$ ËæπÂΩ¢ÁöÑÊÄªÊï∞ÁöÑÂíåÂØπ $1e9 + 7$ ÂèñÊ®°ÁöÑÁªìÊûú„ÄÇ</p><p>$k$ ËæπÂΩ¢ÊåáÁöÑÊòØ $n$ ‰∏™ÁÇπ‰∏≠ÁöÑ $k$ ‰∏™ÁÇπÔºå‰ªñ‰ª¨Âú®Ëøô‰∏™ÂâñÂàÜ‰∏≠ÊûÑÊàê‰∏Ä‰∏™Â∞ÅÈó≠ÂõæÂΩ¢„ÄÇ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-1"><a href="#Êï∞ÊçÆËåÉÂõ¥-1" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ‰∫é $100\%$ ÁöÑÊï∞ÊçÆÔºå$3 \le k \le n \le 5 \times 10^6$</p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂÆòÊñπÈ¢òËß£Áúã‰∏çÊáÇ„ÄÇ„ÄÇÁúãÂà´‰∫∫ÁöÑÈ¢òËß£„ÄÇ„ÄÇ</p><p>È¶ñÂÖàËøô‰∏™ÈóÆÈ¢òÂèØ‰ª•ÁúãÊàêÊ±ÇÊâÄÊúâ $n - 2$ ‰∏™ËäÇÁÇπÁöÑ‰∫åÂèâÊ†ë‰∏≠Â§ßÂ∞è‰∏∫ $k - 2$ ÁöÑËøûÈÄöÂùóÁöÑÊï∞Èáè‰πãÂíå</p><p>ÈÇ£‰πàÁé∞Âú®Áõ¥Êé•‰ª§ $n, k$ Âáè‰∫å</p><p>ÂçïÁã¨ËÄÉËôëÊØè‰∏™ËøûÈÄöÂùóÁöÑË¥°ÁåÆÔºåÈ¶ñÂÖàÂÆÉÊúâ $Cat_k$ ÁßçÂΩ¢ÊÄÅÔºåËØ•Ê†ëÊúâ $k + 1$ ÁßçÊé•Â≠êÊ†ëÁöÑÊñπÊ°àÔºàÊï∞‰∏Ä‰∏ãÂ∞±Áü•ÈÅì‰∫ÜÔºå‰∏çÂåÖÊã¨ËØ•Ê†ëÊ†πËäÇÁÇπÂæÄÂÖ∂Áà∂‰∫≤ËøûÔºâÔºåÈÇ£‰πàÁ¨¨‰∏ÄÈÉ®ÂàÜÔºàÊé•ÂÑøÂ≠êÔºâÊñπÊ°àÊï∞Âç≥‰∏∫<br>$$<br>\sum\limits_{i = 0}^{n - k} Cat_k[x^i]C^{k + 1}<br>$$<br>ÂÖ∂‰∏≠ $i$ Ë°®Á§∫Êé•ÂÑøÂ≠êÂ≠êÊ†ëÁöÑÊÄªÂ§ßÂ∞èÔºå$C$ Ë°®Á§∫Âç°ÁâπÂÖ∞Êï∞ÂàóÁöÑÁîüÊàêÂáΩÊï∞</p><p>ÈÇ£‰πàÁé∞Âú®ËÄÉËôëÊé•Áà∂‰∫≤ÔºåÂÆπÊòìÁü•ÈÅìÊñπÊ°àÊï∞‰∏∫<br>$$<br>\sum\limits_{j = 0}^{n - k - i} Cat_j(j + 1)<br>$$<br>ÂÖ∂‰∏≠ $j$ Ë°®Á§∫Êé•ÁöÑÊ†ëÁöÑÂ§ßÂ∞èÔºå$j + 1$ ‰πüÊòØ‰∏ÄÊ†∑Ë°®Á§∫ÂØπÊé•ÁöÑÊ†ëÊù•ËÆ≤Êúâ $j + 1$ ÁßçÊé•ÂÑøÂ≠êÁöÑÊñπÊ°à</p><p>Áé∞Âú®Êó∂Èó¥Â§çÊùÇÂ∫¶ÁöÑÁóáÁªìÂú®‰∫é $[x^n]C^m$ ÁöÑËÆ°ÁÆóÔºåËÄÉËôëÂÆÉÁöÑÂá†‰ΩïÊÑè‰πâ</p><p>ÂÆÉÁõ∏ÂΩì‰∫é $i$ ‰∏™ÊäòÁ∫øÂõæÊãºËµ∑Êù•ÔºåÁé∞Âú®ËÄÉËôëÂ¶Ç‰ΩïÂ∞ÜËøô‰∫õÊäòÁ∫øÂõæÂàÜÊÆµÔºåÂ∞±ÊòØÂ∞ÜÊØè‰∏ÄÊÆµÊäòÁ∫øÂõæÁöÑÁªìÂ∞æ $-1$ÔºåÈÇ£‰πàÊÄªÂÖ±‰ºöÂáè $m - 1$ Ê¨°ÔºàÊúÄÂêé‰∏ÄÊÆµÊòØ‰∏çÈúÄË¶ÅÂáèÁöÑÔºâÔºå‰πüÂ∞±ÊòØËØ¥‚ÄúÁ¨¨‰∏ÄÊ¨°Âá∫Áé∞ $0$ Âà∞Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ $- 1$ ÁöÑ‰ΩçÁΩÆ‚ÄùÂØπÂ∫îÁ¨¨‰∏ÄÊÆµÊäòÁ∫øÔºå‚ÄúÁ¨¨‰∏ÄÊ¨°Âá∫Áé∞ $- 1$ Âà∞Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ $- 2$ ÁöÑ‰ΩçÁΩÆ‚ÄùÂØπÂ∫îÁ¨¨‰∫åÊÆµÊäòÁ∫ø„ÄÇ„ÄÇ„ÄÇ</p><p>ÈÇ£‰πàÁé∞Âú®Â∞±ÊòØÁªô $n$ ‰∏™ $+ 1$Ôºå$n + m - 1$ ‰∏™ $- 1$ÔºåËÆ°ÁÆóÂÖ∂Áî± $(0, 0)$ Âà∞ $(2n + m - 1, - m + 1)$ÔºåÂπ∂‰∏î‰øùËØÅÂâçÁºÄÂíå $\ge - m + 1$ ÁöÑÊñπÊ°àÊï∞ÔºåÊïÖÊòæÁÑ∂Êúâ<br>$$<br>[x^n]C^m = \dbinom{2n + m - 1}{n} - \dbinom{2n + m - 1}{n - 1}<br>$$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><p>ÊàëÁöÑ $\text{code}$ Ë∑ëÁöÑË¥ºÊÖ¢</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e07</span> + <span class="number">10</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1e07</span>;</span><br><span class="line"> </span><br><span class="line">LL inv[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;, invfact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line">LL cat[MAXN]= &#123;<span class="number">0</span>&#125;, g[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function">LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD; &#125;</span><br><span class="line"><span class="function">LL <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="keyword">return</span> (C (<span class="number">2</span> * n + m - <span class="number">1</span>, n) - C (<span class="number">2</span> * n + m - <span class="number">1</span>, n - <span class="number">1</span>) + MOD) % MOD; &#125;</span><br><span class="line"><span class="comment">// [x^n]C^m</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, k;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    n -= <span class="number">2</span>, k -= <span class="number">2</span>;</span><br><span class="line">    fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    fact[<span class="number">1</span>] = invfact[<span class="number">1</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line">        inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">        fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">        invfact[i] = invfact[i - <span class="number">1</span>] * inv[i] % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    cat[<span class="number">0</span>] = g[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">        cat[i] = cat[i - <span class="number">1</span>] * (<span class="number">4</span> * i  - <span class="number">2</span>) % MOD * inv[i + <span class="number">1</span>] % MOD;</span><br><span class="line">        g[i] = (g[i - <span class="number">1</span>] + cat[i] * (i + <span class="number">1</span>) % MOD) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - k; i ++)</span><br><span class="line">        ans = (ans + cat[k] * calc (i, k + <span class="number">1</span>) % MOD * g[n - i - k] % MOD) % MOD;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-CÔºöSUMMER-WC"><a href="#Problem-CÔºöSUMMER-WC" class="headerlink" title="Problem CÔºöSUMMER WC"></a>Problem CÔºöSUMMER WC</h2><h3 id="È¢òÁõÆÊèèËø∞-2"><a href="#È¢òÁõÆÊèèËø∞-2" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>OIerÊòØ‰∏™ÂèØÁà±ÁöÑÁæ§‰ΩìÔºå‰ªñ‰ª¨ÊúâÂæàÂ§öÁöÑÁ¶ÅÂøåËØçÊ±áÔºåÂØπÊ≠§‰ªñ‰ª¨‰ºöÊúâÂùèÊÑüÂ∫¶ÔºåÊàë‰ª¨Ë°®Á§∫Êàê $- x$ ÁöÑÂΩ¢ÂºèÔºå$x$ ‰∏∫Ê≠£Êï¥Êï∞ÔºåË∂äÂ§ßÔºåË°®Á§∫‰ªñ‰ª¨Ë∂äËÆ®ÂéåÔºåÊØîÂ¶Ç:</p><p>$\text{ccf}$ $-250250$ $\text{summerwc}$ $-2600$ $\text{unitedshengxuan}$ $-700$</p><p>‰ΩÜ‰ªñ‰ª¨‰πü‰ºöÂØπ‰∏Ä‰∫õ‰∏úË•øÊúâÂ•ΩÊÑüÂ∫¶ÔºåÁ±ª‰ººÁöÑÔºåÊàë‰ª¨ÂàóÂá∫‰æãÂ≠ê:</p><p>$\text{frog}$ $+1000000$ÔºàÂÖ∂ÂÆûËøúËøú‰∏çÊ≠¢Ôºå‰ΩÜÊú¨È¢òÁöÑÊùÉÂÄº‰∏äÈôê $1e6$Ôºâ$\text{apiadu}$ $+3681$ $\text{txdy}$ $+3669$</p><p>Á±ª‰ººÁöÑÔºåÊàë‰ª¨ËøòÊúâÂæàÂ§ö‰æãÂ≠ê</p><p>‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÂ•ΩÊÑüÂ∫¶Â∞±ÊòØÈáåÈù¢Âá∫Áé∞ËøáÁöÑËØçÊ±áÁöÑÊÑüËßâÁöÑÂíåÔºå‰∏Ä‰∏™ËØçÊ±áÂá∫Áé∞Â§öÊ¨°ÁÆóÂ§öÊ¨°</p><p>‰æãÂ¶Ç $\text{frogfrog}$ ÁöÑÂ•ΩÊÑüÂ∫¶Â∞±ÊòØ $2e6$</p><p>ÁâπÂà´ÁöÑÔºåÊàë‰ª¨ËÄÉËôëÁ©∫‰∏≤ÔºåÂÖ∂Â•ΩÊÑüÂ∫¶‰∏∫ $0$</p><p>Áé∞Âú®Êàë‰πàÁªôÂá∫‰∏Ä‰∏™Â§ßÁöÑ‰∏≤ÔºåÂêåÊó∂ÁªôÂá∫ÊâÄÊúâËØçÊ±á(Â•ΩÊÑüÂ∫¶ÂèØ‰ª•‰∏∫Ë¥üÔºåË°®Á§∫ÊúâÂ§öËÆ®Âéå),Êàë‰ª¨ÈúÄË¶ÅÊ±ÇÂá∫ÈáåÈù¢ÊúÄÂ§ßÂ•ΩÊÑüÂ∫¶Â≠ê‰∏≤ÔºåÂèØ‰ª•‰∏∫Á©∫</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-2"><a href="#Êï∞ÊçÆËåÉÂõ¥-2" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ËÆæ $n$ ‰∏™ËØçÊ±áÁöÑÈïøÂ∫¶Âíå‰∏∫ $L$Ôºå$L_{max}$ ‰∏∫ÂÖ∂‰∏≠ÁöÑÊúÄÂ§ßÈïøÂ∫¶</p><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n, m, L, L_{max} \le 10^6, ~ 1 \le x \le 10^6$</p><h3 id="È¢òËß£-2"><a href="#È¢òËß£-2" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂÆåÂÖ®‰∏ç‰ºö„ÄÇ„ÄÇÊàëÂ≠óÁ¨¶‰∏≤ÂÆûÂú®Â§™Ëèú‰∫Ü„ÄÇ„ÄÇ</p><p>Â•ΩÂÉèËøôÊòØ $\text{GDOI2019}$ ÁöÑ $D2T3$ ÁöÑÂéüÈ¢ò</p><p>‰∏ªË¶ÅÊÄùË∑ØÂ∞±ÂÖàÂª∫Âá∫‰∏Ä‰∏™$\text{AC}$Ëá™Âä®Êú∫ÁÑ∂ÂêéÂú®‰∏äÈù¢$dp$</p><p>Âª∫Âá∫Ëá™Âä®Êú∫ÂêéÈÇ£‰∫õÁªìÂ∞æËäÇÁÇπÈÉΩ‰ºöÊúâ‰∏Ä‰∏™ÊùÉÂÄº $val$ÔºåÈÇ£‰πàÂØπÊñáÊú¨‰∏≤ $[l, r]$ ÁöÑÂ≠ê‰∏≤Â∞±ÊòØÂú®Ëá™Âä®Êú∫‰∏äËµ∞ÁÑ∂ÂêéÊääË∑ØÂæÑ‰∏äÊâÄÊúâ $val$ Âä†Ëµ∑Êù•Âç≥ÂèØÂæóÂà∞ÂÆÉÁöÑÂ•ΩÊÑüÂ∫¶Âíå</p><p>Ê≠§Êó∂‰∏çÂ¶®ËÆæËÆ°Áä∂ÊÄÅ $f_{i, j}$ Ë°®Á§∫ÊñáÊú¨‰∏≤ÂåπÈÖçÂà∞ $i$ Êó∂Ôºå$\text{AC}$Ëá™Âä®Êú∫‰∏äËµ∞Âà∞ËäÇÁÇπ $j$ Êó∂ÁöÑÊúÄÂ§ßÂÄºÔºåËÄåÈÄ†ÊàêËøô‰∏™ÊúÄÂ§ßÂÄºÁöÑÂ≠ê‰∏≤Âç≥ÊòØ $1‚Ä¶i$ ÁöÑÂÖ∂‰∏≠‰∏Ä‰∏™ÂêéÁºÄÂ≠ê‰∏≤</p><p>ÂÅáËÆæÊñáÊú¨‰∏≤Â≠ê‰∏≤ $[1, i]$ Âú®Ëá™Âä®Êú∫‰∏äËµ∞Âà∞ËäÇÁÇπ $node_i$ÔºåÈÇ£‰πàÁé∞Âú®ËÄÉËôëÊúâÂèØËÉΩË¢´ $1‚Ä¶i$ ÁöÑÂêéÁºÄÂ≠ê‰∏≤ÈÅçÂéÜÂà∞ÁöÑ $j$ÔºåÂàô $j$ ‰∏ÄÂÆöÂú® $fail$ Ê†ë‰∏äÊòØ $node_i$ ÁöÑÁ•ñÂÖàÔºåÊïÖÊÄªÁä∂ÊÄÅÊúâ $mL_{max}$ ‰∏™ÔºåÊ≠§Êó∂Â§çÊùÇÂ∫¶‰∏∫ $O (mL_{max})$</p><p>Áé∞Âú®ÂØπ‰∏äËø∞ $dp$ ËøõË°å‰ºòÂåñ</p><p>Âú®ÂæÄ$\text{AC}$Ëá™Âä®Êú∫ÈáåÊèíÂÖ•ÁöÑÊó∂ÂÄôÔºåÂª∫Á´ãÁà∂Â≠êÂÖ≥Á≥ªÔºàÂç≥$\text{trie}$Ê†ë‰∏äÁöÑÁà∂Â≠êÂÖ≥Á≥ªÔºâÔºåÁî® $fa_i$ Ë°®Á§∫</p><p>ÊØèÁªèËøáËá™Âä®Êú∫‰∏äÊüê‰∏ÄÊù°ËæπÔºåËΩ¨Áßª‰∏ÄÂÆöÊòØÁõ∏ÂêåÁöÑÔºåÊïÖÁÆÄÂåñ‰∏Ä‰∏ãÔºå‰ª§ $f_i$ Ë°®Á§∫Ëá™Âä®Êú∫‰∏äËµ∞Âà∞ $i$ ÁöÑÁ≠îÊ°àÔºàÊ≠§Êó∂‰∏éÊñáÊú¨‰∏≤Êó†ÂÖ≥ÔºåÂõ†‰∏∫ËäÇÁÇπ $i$ Â∑≤ÁªèÁ°ÆÂÆö‰∫ÜÂîØ‰∏Ä‰∏Ä‰∏™ÂêéÁºÄÔºâÔºåËÄÉËôë $f_i$ ÈÉΩ‰ªéÂì™ÈáåËΩ¨ÁßªÔºå‰ª§Â≠óÁ¨¶‰∏≤ $S_i$ Ë°®Á§∫ËäÇÁÇπ $i$ Ë°®Á§∫ÂêéÁºÄ</p><ul><li>Áõ¥Êé•Á≠â‰∫é $f_{fail_i}$</li><li>Áî± $fa_i$ ÂèäÂÖ∂ÂêéÁºÄÂÜçÂä†‰∏ä $val_{fail_i}$ ËΩ¨ÁßªÔºàÂç≥‰∏çÂèñ $S_i$ ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÈÇ£‰πà $val_i$ ‰πü‰∏çËÉΩÂä†‰∏ä‰∫ÜÔºâ</li><li>Áõ¥Êé•ÂèñÊï¥‰∏™ $S_i$</li></ul><p>ÊïÖÊ≠§Êó∂ÂÜçËÆæ‰∏§‰∏™Áä∂ÊÄÅ $g_i, h_i$ÔºåÂÖ∂‰∏≠ $g_i$ Ë°®Á§∫Á¨¨‰∏âÁßçÊÉÖÂÜµÔºå$h_i$ Ë°®Á§∫Á¨¨‰∫åÁßçÊÉÖÂÜµÔºåÈÇ£‰πà $f_i$ ÁöÑËΩ¨ÁßªÂ∞±Ë°®Á§∫‰∏∫<br>$$<br>f_i = \max (f_{fail_i}, \max (g_i, h_i))<br>$$<br>Ëá≥‰∫é‰∏∫‰ªÄ‰πàËøòË¶ÅËÆæ $h_i$ÔºåÂõ†‰∏∫ÂÅáÂ¶ÇÁõ¥Êé•‰ªé $f_{fail_i}$ ËΩ¨ÁßªÁöÑËØùÂèØËÉΩ $S_i$ ÁöÑÊüê‰∫õÊúâË¥°ÁåÆÂêéÁºÄÂ∞±Êó†Ê≥ïË¢´ÈÅçÂéÜÂà∞‰∫ÜÔºå‰∏æ‰∏™‰æãÂ≠ê</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e</span><br><span class="line">de</span><br><span class="line">bd</span><br><span class="line">abde</span><br></pre></td></tr></table></figure><p>ÈÇ£‰πàÂú®ËÆ°ÁÆó $f(abde)$ ÁöÑÊó∂ÂÄôÔºåËã•Âè™ÂèñÂÖ∂ $fail$ Ê†ë‰∏äÁà∂‰∫≤ÔºåÂàôÂè™‰ºöËÆøÈóÆÂà∞ $\text{de}$ÔºåÈÇ£‰πà $\text{bd}$ ÂêéÈù¢Êãº‰∏ä‰∏Ä‰∏™ $e$ ÁöÑÊÉÖÂÜµÂ∞±ÈÅçÂéÜ‰∏çÂà∞‰∫Ü</p><p>ÂÖ∂‰∏≠ÂØπ $h_i$ ÁöÑËΩ¨ÁßªÂè™Ë¶ÅËÄÉËôë $S_i$ ‰∏é $S_{fail_i}$ ÁöÑÂ∑ÆÂÄºÈÉ®ÂàÜÂ∞±Â•Ω‰∫ÜÔºåÊïÖÊÄªËΩ¨ÁßªÂ§çÊùÇÂ∫¶ÊòØ $O (m + L)$ ÁöÑ</p><p>Ê≥®ÊÑèËÆ∞ÂæóÂ∞ÜÊñáÊú¨‰∏≤ÊèíÂÖ•Âà∞Ëá™Âä®Êú∫‰∏≠Ôºå‰∏çÁÑ∂ÊòæÁÑ∂Êó†Ê≥ïÁªüËÆ°Á≠îÊ°à</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">char</span> str[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> tr[MAXN][<span class="number">26</span>]= &#123;<span class="number">0</span>&#125;, fail[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL value[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>; <span class="keyword">int</span> n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = str[i] - <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">if</span> (! tr[p][c]) &#123; tr[p][c] = ++ m; father[m] = p; &#125;</span><br><span class="line">p = tr[p][c];</span><br><span class="line">&#125;</span><br><span class="line">value[p] += x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line">LL f[MAXN]= &#123;<span class="number">0</span>&#125;, g[MAXN]= &#123;<span class="number">0</span>&#125;, h[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++)</span><br><span class="line"><span class="keyword">if</span> (tr[<span class="number">0</span>][i])</span><br><span class="line">que.push(tr[<span class="number">0</span>][i]);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line">value[u] += value[fail[u]];</span><br><span class="line">g[u] = g[father[u]] + value[u];</span><br><span class="line"><span class="keyword">if</span> (! fail[u]) h[u] = h[father[u]];</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">h[u] = - INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = father[u]; j != father[fail[u]]; j = fail[j])</span><br><span class="line">h[u] = max (h[u], h[j] + value[fail[u]]);</span><br><span class="line">&#125;</span><br><span class="line">f[u] = max (f[fail[u]], max (g[u], h[u]));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (tr[u][i]) &#123;</span><br><span class="line">fail[tr[u][i]] = tr[fail[u]][i];</span><br><span class="line">que.push(tr[u][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> tr[u][i] = tr[fail[u]][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>, n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = str[i] - <span class="string">'a'</span>;</span><br><span class="line">p = tr[p][c];</span><br><span class="line">ans = max (ans, f[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>);</span><br><span class="line">insert (getnum ());</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>); insert (<span class="number">0</span>);</span><br><span class="line">build ();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; solve () &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LCT </tag>
            
            <tag> ÁªÑÂêàÊï∞Â≠¶ </tag>
            
            <tag> Âç°ÁâπÂÖ∞Êï∞ </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> ACËá™Âä®Êú∫ </tag>
            
            <tag> Âä®ÊÄÅËßÑÂàí </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅ‰∫åÔºâ</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%8C%EF%BC%89/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%8C%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>‰ªäÊó•ÁªßÁª≠Âû´Â∫ïÁ≥ªÂàó</p><p>T1È¢òÊÑèÁêÜËß£ÈîôËØØÊö¥ÂäõÂÜôÊåÇ</p><p>T2ÊÄíÊï≤ $n \le 4$ Ê±ÇÊ†πÂÖ¨ÂºèÁÑ∂ÂêéÂèëÁé∞Á≠îÊ°àËøòÂæóÊéíÂ∫è„ÄÇ„ÄÇ</p><p>$\text{scoreÔºö0 + 10 + 0 = 10   rkÔºö27/27}$</p><h2 id="Problem-AÔºöÊ∏∏Êàè"><a href="#Problem-AÔºöÊ∏∏Êàè" class="headerlink" title="Problem AÔºöÊ∏∏Êàè"></a>Problem AÔºöÊ∏∏Êàè</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ysghÊòØ‰∏ÄÂêçHerthstoneÂ§ßÂ∏à„ÄÇÁé∞Âú®‰ªñÈÅáÂà∞‰∫Ü‰∏Ä‰∏™Âæà‰∏•Â≥ªÁöÑÈóÆÈ¢òÔºö</p><p>Âú∫‰∏äÊÄªÂÖ±Êúâ $n+m$ ‰∏™Èöè‰ªéÔºåÂÖ∂‰∏≠ysghÊéßÂà∂ÁùÄ $n$ ‰∏™ÔºåÂØπÊâãÊéßÂà∂ÁùÄ $m$ ‰∏™„ÄÇÊØè‰∏™Èöè‰ªéÊúâËá™Â∑±ÁöÑË°ÄÈáè„ÄÇ</p><p>Â¶ÇÊûúysghÂú®Ëøô‰∏ÄÂõûÂêàÊàêÂäüËß£Êéâ‰∫ÜÂØπÊâãÁöÑÊâÄÊúâÈöè‰ªéÔºåÂàôysghËé∑ËÉú„ÄÇÂê¶Âàô‰∏ã‰∏ÄÂõûÂêàÂØπÊâãÁõ¥Êé•È™ëËÑ∏ÔºåysghÂ∞±‰ºöËæìÊéâ„ÄÇ</p><p>ysghÁé∞Âú®ÊâãÈáå‰ªÖÊúâ‰∏ÄÂú∫ÁâåÔºåÂ±ûÊÄßÂ¶Ç‰∏ãÔºö</p><p>ËøõË°å $d$ Ê¨°ÔºåÊØè‰∏ÄÊ¨°Á≠âÊ¶ÇÁéáÈöèÊú∫‰∏Ä‰∏™Âú®Âú∫‰∏äÁöÑÊú™Ê≠ª‰∫°Èöè‰ªéÔºàÂåÖÊã¨Ëá™Â∑±ÂíåÂØπÊâãÁöÑÔºâÂπ∂‰∏îÂØπÂÖ∂ÈÄ†Êàê‰∏ÄÁÇπ‰º§ÂÆ≥„ÄÇËã•‰∏çÂ≠òÂú®Êú™Ê≠ª‰∫°Èöè‰ªéÔºåÂàô‰∏çËøõË°åÊ≠§Ê¨°ÊîªÂáª„ÄÇ‰∏Ä‰∏™Èöè‰ªéÊú™Ê≠ª‰∫°ÂΩì‰∏î‰ªÖÂΩìÂÖ∂Ë°ÄÈáè‰∏•Ê†ºÂ§ß‰∫é $0$„ÄÇÊØè‰∏ÄÊ¨°ÊîªÂáªÂêéÔºåÊâÄÊúâË°ÄÈáèÂ∞è‰∫éÁ≠â‰∫é $0$ ÁöÑÈöè‰ªéÁ´ãÂç≥Ê≠ª‰∫°„ÄÇ</p><p>ysghÊÉ≥Ë¶ÅÁü•ÈÅìÔºå‰ªñÊúâÂ§öÂ§ßÊ¶ÇÁéáÂèØ‰ª•ÂèñËÉúÔºå‰πüÂ∞±ÊòØÂ§öÂ§ßÁöÑÊ¶ÇÁéá‰ΩøÂæóÂú®‰ΩøÁî®ËøôÂº†ÁâåÂêéÔºåÂØπÊâãÁöÑÈöè‰ªéÂÖ®ÈÉ®Ê≠ª‰∫°„ÄÇ</p><p><strong>ÁâπÂà´ÊèêÈÜíÔºöÁî±‰∫éÊèèËø∞‰∏éÂÆûÈôÖÊ∏∏ÊàèËßÑÂàôÊúâÂá∫ÂÖ•Ôºå‰∏ÄÂàá‰ª•ÂÆûÈôÖÈ¢òÈù¢ÊèèËø∞‰∏∫ÂáÜ„ÄÇ</strong></p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ‰∫éÊâÄÊúâÊµãËØïÊï∞ÊçÆÔºåÊª°Ë∂≥ $1 \le n, m \le 6, ~ 1 \le d \le 400$</p><p>‰øùËØÅÊâÄÊúâÈöè‰ªéË°ÄÈáèÂùá‰∏∫ $1 \sim 12$ ‰πãÈó¥ÁöÑÊ≠£Êï¥Êï∞</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÊàëÊ≤°Áé©ËøáÁÇâÁü≥ËøòÁúüÊòØÂØπ‰∏çËµ∑Âì¶„ÄÇ„ÄÇÂéüÊù•ÂÅáÂ¶ÇËøô‰∏Ä‰∏™ÊäÄËÉΩÁªìÊùüÂÖ®Âú∫ÈÉΩÊ≤°‰∫ÜÁöÑËØùÊòØÁÆóÊàëÊñπËÉúÂà©ËÄå‰∏çÊòØÂπ≥Êâã„ÄÇ„ÄÇ</p><p>Â∞Ü $n + m$ ‰∏™Èöè‰ªé‰∏ÄËµ∑ËÄÉËôëÔºåËÆæÁ¨¨ $i$ ‰∏™Èöè‰ªéË°ÄÈáè $a_i$</p><p>ÂæàÂÆπÊòìÂèØ‰ª•ÊÉ≥Âà∞ËÆæ $f_{i, state}$ Ë°®Á§∫Ââç $i$ ËΩÆÔºåÊ≠ª‰∫°Áä∂ÊÄÅ‰∏∫‰∏∫ $state$ ÁöÑÊ¶ÇÁéá</p><p>ÊòæÁÑ∂‰∏Ä‰∏™Èöè‰ªéÊ≠ª‰∫°Âêé‰ºöÂàÜ‰∏ÄÊÆµÔºåÂ∞±ÊòØ‰Ω†Êé•‰∏ãÊù•Ë¶Å‰πòÁöÑÊ¶ÇÁéáÂàÜÊØçË¶ÅÂáè‰∏Ä</p><p>Â§öÂä†‰∏Ä‰∏™Ê≠ª‰∫°Èöè‰ªéÂæàÂ•ΩËΩ¨ÁßªÔºå‰ΩÜÊòØÂΩìÊó∂ÊàëÂ∞±Âç°Âú®Â¶Ç‰ΩïËÆ°ÁÆóËØ•Èöè‰ªéÁöÑË°ÄÈáèÂàÜÈÖçÂú®ÂâçÈù¢Âá†ÊÆµÈúÄË¶Å‰πò‰∏äÁöÑÊ¶ÇÁéá</p><p>ÂÆûÈôÖ‰∏äÂæàÁÆÄÂçïÔºåÂè™Ë¶ÅÂú®ËΩ¨ÁßªËØ•ËΩÆÊîªÂáªÂêéÊó†Êñ∞‰∫∫Ê≠ª‰∫°ÁöÑÊó∂ÂÄô‚ÄúÈ¢ÑÊîØ‚Äù‰∏Ä‰∏ãËøô‰∏™Ê¶ÇÁéáÂ∞±Â•Ω‰∫ÜÔºå$\text{dp}$ ÂºèÂ≠êÂ¶Ç‰∏ãÔºåÂÖ∂‰∏≠Ôºå‰ª§ $|state|$ Ë°®Á§∫ $state$ ‰∫åËøõÂà∂Ë°®Á§∫ $1$ ÁöÑ‰∏™Êï∞Ôºå$s (state)$ Ë°®Á§∫ $state$ Ë°®Á§∫Âá∫ÁöÑÊ≠ª‰∫°Èöè‰ªéÁöÑÊÄªË°ÄÈáè<br>$$<br>\begin{aligned}<br>ÊîªÂáªÂêéÊó†Êñ∞‰∫∫Ê≠ª‰∫°Ôºö&amp;f_{i, state} \times \frac1{n + m - |state|} \rightarrow f_{i + 1, state} \\<br>ÊîªÂáªÂêéÂ≠òÂú®Êñ∞Èöè‰ªék(k \not\in state)Ê≠ª‰∫°Ôºö&amp;f_{i, state} \times \frac{\dbinom{i - s (state)}{a_k - 1}}{n + m - |state|} \rightarrow f_{i, state | (1 &lt;&lt; (k - 1))}<br>\end{aligned}<br>$$<br>‚ÄúÈ¢ÑÊîØ‚ÄùËøáÂêéÂú®Ê≠ª‰∫°Èöè‰ªéËΩ¨ÁßªÊó∂Â∞±Âè™Ë¶ÅÁõ¥Êé•Âú®ÂâçÈù¢È¢ÑÁïô‰∏ãÁöÑ‰ΩçÁΩÆ‰∏≠ÈÄâÂá†‰∏™Â∞±Â•Ω‰∫Ü</p><p>ÂΩìÁÑ∂Áé∞Âú®ËøòÈúÄË¶ÅÂ∞ÜÂâ©‰∏ãÁöÑÊú™Ê≠ª‰∫°ÁöÑÈöè‰ªéÁöÑË°ÄÈáèÂàÜÈÖçÔºàÂç≥‰ªñ‰ª¨ÂèØËÉΩË¢´ÊîªÂáª‰ΩÜÊú™Ê≠ª‰∫°ÔºâÔºå‰∏Ä‰∏™Â§öÈáçËÉåÂåÖÂ∞±Â•Ω‰∫Ü</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (2^{n + m}144^2)$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1</span> &lt;&lt; <span class="number">12</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">12</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXD = <span class="number">144</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD, p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N, M, D;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL inv[MAXD]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL fact[MAXD]= &#123;<span class="number">0</span>&#125;, ifact[MAXD]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (m &gt; n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> fact[n] * ifact[m] % MOD * ifact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL f[MAXD][MAX]= &#123;<span class="number">0</span>&#125;, g[MAXN][MAXD]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (state &gt; <span class="number">0</span>) &#123;</span><br><span class="line">cnt ++; state ^= lowbit (state);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> b[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), D = getnum (); T = N + M;</span><br><span class="line">fact[<span class="number">0</span>] = ifact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">fact[<span class="number">1</span>] = ifact[<span class="number">1</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= max (T, D); i ++) &#123;</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">ifact[i] = ifact[i - <span class="number">1</span>] * inv[i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N + M; i ++) &#123; a[i] = getnum (); tot += a[i]; &#125;</span><br><span class="line">D = min (D, tot);</span><br><span class="line"><span class="keyword">int</span> limit = (<span class="number">1</span> &lt;&lt; T) - <span class="number">1</span>;</span><br><span class="line">f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; D; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">0</span>; state &lt;= limit; state ++) &#123;</span><br><span class="line"><span class="keyword">int</span> s = calc (state), sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= T; j ++)</span><br><span class="line"><span class="keyword">if</span> (state &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)))</span><br><span class="line">sum += a[j];</span><br><span class="line"><span class="keyword">if</span> (i &lt; sum) <span class="keyword">continue</span>;</span><br><span class="line">f[i + <span class="number">1</span>][state] = (f[i + <span class="number">1</span>][state] + f[i][state] * inv[T - s] % MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= T; k ++)</span><br><span class="line"><span class="keyword">if</span> (! (state &amp; (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>)))) &#123;</span><br><span class="line">LL mul = C (i - sum, a[k] - <span class="number">1</span>) % MOD * inv[T - s] % MOD;</span><br><span class="line">f[i + <span class="number">1</span>][state | (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))] = (f[i + <span class="number">1</span>][state | (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))] + f[i][state] * mul % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> stan = <span class="number">0</span>;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = N + <span class="number">1</span>; j &lt;= T; j ++) stan |= (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">0</span>; state &lt;= limit; state ++)</span><br><span class="line"><span class="keyword">if</span> ((state &amp; stan) == stan) &#123;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>, m = <span class="number">0</span>;</span><br><span class="line">g[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= T; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (state &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))) sum += a[j];</span><br><span class="line"><span class="keyword">else</span> b[++ m] = a[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> V = D - sum;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= V; k ++) &#123;</span><br><span class="line">g[j][k] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt;= min (k, b[j] - <span class="number">1</span>); l ++)</span><br><span class="line">g[j][k] = (g[j][k] + g[j - <span class="number">1</span>][k - l] * C (V - (k - l), l) % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">ans = (ans + f[D][state] * g[m][V] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöÊñπÁ®ã"><a href="#Problem-BÔºöÊñπÁ®ã" class="headerlink" title="Problem BÔºöÊñπÁ®ã"></a>Problem BÔºöÊñπÁ®ã</h2><h3 id="È¢òÈù¢ÊèèËø∞"><a href="#È¢òÈù¢ÊèèËø∞" class="headerlink" title="È¢òÈù¢ÊèèËø∞"></a>È¢òÈù¢ÊèèËø∞</h3><p>Ê±ÇËß£‰∏ÄÂÖÉ $n$ Ê¨°ÊñπÁ®ã $f(x) = \sum a_ix^i = 0$ ÁöÑÊâÄÊúâÂÆûÊï∞Ê†π</p><p>Êúâ $T$ ÁªÑÊï∞ÊçÆ</p><p><strong>Ê≥®ÊÑèËæìÂá∫ÁöÑÂÆûÊï∞Ê†πË¶ÅÊåâ‰ªéÂ§ßÂà∞Â∞èÊéíÂ∫è</strong></p><h3 id="Êï∞ÊçÆËåÉÂõ¥-1"><a href="#Êï∞ÊçÆËåÉÂõ¥-1" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>$1 \le n \le 6$</p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÔºàÁôæÂ∫¶ÈïøÁöÑË∑ü‰ªÄ‰πà‰∏ÄÊ†∑ÁöÑÊ±ÇÊ†πÂÖ¨ÂºèÁöÑÂçëÂæÆÁöÑÊàëÔºâ</p><p>ÂØπ $f(x)$ÔºåËÄÉËôëÂÖ∂ÂØºÊï∞ $f‚Äô(x)$ÔºåÂØπ‰∫é $f‚Äô(x)$ ÁöÑÁõ∏ÈÇª‰∏§ÂÆûÊï∞Ê†π $x_1, x_2$ ÊòæÁÑ∂Êúâ $f(x)$ Âú® $(x_1, x_2)$ ÂçïË∞É</p><p>ÈÇ£‰πàÊ±ÇÂá∫ $f‚Äô(x)$ ÂÆûÊï∞Ê†πÂêéÂú®‰∏äËø∞ÂçïË∞ÉÂå∫Èó¥‰∫åÂàÜÁ≠îÊ°àÂç≥ÂèØ</p><p>ÈÄíÂΩíÂ§ÑÁêÜ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (Tn^3)$</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> Ld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">6</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Ld eps = <span class="number">1e-12</span>;</span><br><span class="line"><span class="keyword">const</span> Ld INF = <span class="number">1e20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dcmp</span> <span class="params">(Ld p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">fabs</span> (p) &lt; eps) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> p &lt; <span class="number">0</span> ? - <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> t[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> cnt[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">Ld zero[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function">Ld <span class="title">value</span> <span class="params">(<span class="keyword">int</span> n, Ld val)</span> </span>&#123;</span><br><span class="line">Ld x = <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++, x = x * val)</span><br><span class="line">ret += t[n][i] * x;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> n, Ld L, Ld R, Ld&amp; ze)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> d1 = dcmp (value (n, L));</span><br><span class="line"><span class="keyword">int</span> d2 = dcmp (value (n, R));</span><br><span class="line"><span class="keyword">if</span> (d1 * d2 &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (d1 * d2 == <span class="number">0</span>) &#123; ze = d1 == <span class="number">0</span> ? L : R; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (d1 &lt; <span class="number">0</span>) &#123;</span><br><span class="line">Ld left = L, right = R;</span><br><span class="line"><span class="keyword">while</span> (dcmp (right - left) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Ld mid = (left + right) / <span class="number">2.0</span>;</span><br><span class="line"><span class="keyword">if</span> (dcmp (value (n, mid)) &lt;= <span class="number">0</span>) left = mid;</span><br><span class="line"><span class="keyword">else</span> right = mid;</span><br><span class="line">&#125;</span><br><span class="line">ze = left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">Ld left = L, right = R;</span><br><span class="line"><span class="keyword">while</span> (dcmp (right - left) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Ld mid = (left + right) / <span class="number">2.0</span>;</span><br><span class="line"><span class="keyword">if</span> (dcmp (value (n, mid)) &gt;= <span class="number">0</span>) left = mid;</span><br><span class="line"><span class="keyword">else</span> right = mid;</span><br><span class="line">&#125;</span><br><span class="line">ze = left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">Ld a = t[n][<span class="number">1</span>], b = t[n][<span class="number">0</span>];</span><br><span class="line">zero[n][++ cnt[n]] = - b / a;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">2</span>) &#123;</span><br><span class="line">Ld a = t[n][<span class="number">2</span>], b = t[n][<span class="number">1</span>], c = t[n][<span class="number">0</span>];</span><br><span class="line">Ld delta = b * b - <span class="number">4</span> * a * c;</span><br><span class="line"><span class="keyword">if</span> (dcmp (delta) &lt; <span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (dcmp (delta) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (dcmp (delta) == <span class="number">0</span>) delta = <span class="number">0</span>;</span><br><span class="line">Ld x1, x2;</span><br><span class="line"><span class="keyword">if</span> (dcmp (a) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">x1 = (- b - <span class="built_in">sqrt</span> (delta)) / (<span class="number">2.0</span> * a);</span><br><span class="line">x2 = (- b + <span class="built_in">sqrt</span> (delta)) / (<span class="number">2.0</span> * a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">x1 = (- b + <span class="built_in">sqrt</span> (delta)) / (<span class="number">2.0</span> * a);</span><br><span class="line">x2 = (- b - <span class="built_in">sqrt</span> (delta)) / (<span class="number">2.0</span> * a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (dcmp (delta) == <span class="number">0</span>) zero[n][++ cnt[n]] = x1;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">zero[n][++ cnt[n]] = x1;</span><br><span class="line">zero[n][++ cnt[n]] = x2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">work (n - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (! cnt[n - <span class="number">1</span>]) &#123;</span><br><span class="line">Ld posi;</span><br><span class="line"><span class="keyword">if</span> (find (n, - INF, INF, posi))</span><br><span class="line">zero[n][++ cnt[n]] = posi;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">zero[n - <span class="number">1</span>][<span class="number">0</span>] = - INF, zero[n - <span class="number">1</span>][cnt[n - <span class="number">1</span>] + <span class="number">1</span>] = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= cnt[n - <span class="number">1</span>]; i ++) &#123;</span><br><span class="line">Ld posi;</span><br><span class="line"><span class="keyword">if</span> (find (n, zero[n - <span class="number">1</span>][i], zero[n - <span class="number">1</span>][i + <span class="number">1</span>], posi))</span><br><span class="line">zero[n][++ cnt[n]] = posi;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++)</span><br><span class="line">t[i][j] = t[i + <span class="number">1</span>][j + <span class="number">1</span>] * (j + <span class="number">1</span>);</span><br><span class="line">work (n);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, cnt[n]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt[n]; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%.8Lf\n"</span>, zero[n][i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line"><span class="built_in">memset</span> (t, <span class="number">0</span>, <span class="keyword">sizeof</span> (t));</span><br><span class="line"><span class="built_in">memset</span> (cnt, <span class="number">0</span>, <span class="keyword">sizeof</span> (cnt));</span><br><span class="line"><span class="built_in">memset</span> (zero, <span class="number">0</span>, <span class="keyword">sizeof</span> (zero));</span><br><span class="line"><span class="keyword">int</span> n = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++) t[n][i] = getnum ();</span><br><span class="line">solve (n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-CÔºöÊóÖÊ∏∏"><a href="#Problem-CÔºöÊóÖÊ∏∏" class="headerlink" title="Problem CÔºöÊóÖÊ∏∏"></a>Problem CÔºöÊóÖÊ∏∏</h2><h3 id="È¢òÁõÆÊèèËø∞-1"><a href="#È¢òÁõÆÊèèËø∞-1" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ysghÊòØÊúÄ‰ºòÂåñÂ§ßÂ∏à</p><p>ysghÊÉ≥ÂéªÊóÖÊ∏∏Ôºå‰ªñÊâÄÂú®ÁöÑÂüéÂ∏ÇÂÖ±Êúâ $n$ ‰∏™ÊôØÁÇπÔºåÊôØÁÇπ‰πãÈó¥Êúâ $m$ Êù°ÂèåÂêëÈÅìË∑ØËøûÊé•„ÄÇ‰øùËØÅ $n$ ‰∏™ÊôØÁÇπÂèØ‰ª•ÈÄöËøá $m$ Êù°ÈÅìË∑Ø‰∫íÁõ∏Âà∞Ëææ„ÄÇÈÅìË∑ØÈïøÂ∫¶Âùá‰∏∫ $1$„ÄÇ</p><p>ysghÂèØ‰ª•ÈÄöËøá‰πòÂùêÂá∫ÁßüËΩ¶ÂÆåÊàêÊóÖË°å„ÄÇÂÖ∑‰ΩìÁöÑÔºåÁ¨¨ $i$ ‰∏™ÊôØÁÇπÁöÑÂá∫ÁßüËΩ¶ÊúÄÂ§öÂèØ‰ª•Â∞ÜÂÖ∂ËΩΩÂà∞Ë∑ùÁ¶ª $i$ ‰∏çË∂ÖËøá $f_i$ ÁöÑÂú∞Êñπ„ÄÇÂú®Á¨¨ $T$ Â§©ÔºåÊê≠‰πò‰ªéÁ¨¨ $i$ ‰∏™ÊôØÁÇπÂá∫ÂèëÁöÑÂá∫ÁßüËΩ¶ÈúÄË¶ÅËä±Ë¥π $c_i \times T + w_i$ ÂÖÉ„ÄÇ</p><p>ysghÁöÑÈí±Â∑≤ÁªèÂú®Â∞èÂçñÈÉ®‰∏≠Êå•Èúç‰∏ÄÁ©∫ÔºåÂõ†Ê≠§‰ªñÊÉ≥Ë¶ÅÈÄâÊã© $1$ Ëá≥ $T_{max}$ ‰∏≠ÁöÑ‰∏ÄÂ§©Ôºå‰ªéÊôØÁÇπ $1$ Âá∫ÂèëÔºåÊê≠‰πòÂá∫ÁßüËΩ¶Âà∞ËææÊôØÁÇπ$x$ÔºåÂêåÊó∂Ëä±Ë¥πÂ∞ΩÈáèÂú∞Â∞è„ÄÇ</p><p>Áî±‰∫é‰ªñÊ≤°ÊúâÂÆö‰∏ãÊù•Âú®ÈÇ£‰∏™ÂüéÂ∏ÇÊ∏∏Áé©ÔºåÂõ†Ê≠§‰ªñÊÉ≥Ë¶ÅÂØπÊâÄÊúâÁöÑ $x \in [1, n]$ Ê±ÇÂá∫Á≠îÊ°à„ÄÇ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-2"><a href="#Êï∞ÊçÆËåÉÂõ¥-2" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/06/52phqVItFKWuRNg.png" alt=""></p><p>‰øùËØÅÂØπÊâÄÊúâ $1 \le T \le T_{max}, c_i \times T + w_i &gt; 0$</p><h3 id="È¢òËß£-2"><a href="#È¢òËß£-2" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËÆæ $v_i = c_i \times T + w_i$</p><p>ËÄÉËôëÊö¥ÂäõÔºåÂØπÊØè‰∏™ÁÇπÂêëÂÆÉËÉΩÂà∞ËææÁöÑÊâÄÊúâÁÇπËøû‰∏Ä‰∏™ËæπÊùÉ‰∏∫ $v_i$ ÁöÑËæπÔºå‰∏îÂÆπÊòìÂèëÁé∞ÔºåÁ≠îÊ°à‰∏ÄÂÆöÂú® $T$ Âèñ $1$ Êàñ $T_{max}$ ‰∏≠ÈÄâÔºåÁÑ∂Âêé‰ªé $1$ ÂºÄÂßãË∑ëÊúÄÁü≠Ë∑Ø</p><p>Áî±‰∫éÊØè‰∏™ÁÇπÂêëÂ§ñÂá∫ËæπËæπÊùÉÁõ∏ÂêåÔºåÊâÄ‰ª•ËÄÉËôëÁî®Êï∞ÊçÆÁªìÊûÑ‰ºòÂåñÂª∫ÂõæËøáÁ®ã</p><p>‰ªé $m = n - 1$ ÁöÑÊÉÖÂÜµÂºÄÂßãËØ¥ÊòéÔºåÈ¶ñÂÖàË¥™ÂøÉÊÄùÊÉ≥ÔºåÊØè‰∏™ÁÇπÂè™‰ºöË¢´Êõ¥Êñ∞‰∏ÄÊ¨°ÔºåÊØèÊ¨°‰ΩøÁî®Â†Ü‰∏≠ $d$ÔºàÂ∑≤Áü•ÊúÄÁü≠Ë∑ØÔºâÊúÄÂ∞èÁöÑÁÇπÊù•Êõ¥Êñ∞ÂÖ∂ÂÆÉÁÇπ</p><p>ËÆæ $dist(u, v)$ Ë°®Á§∫ $u, v$ ÁöÑÊúÄÁü≠Ë∑ùÁ¶ªÔºàÊ≠§Êó∂Âç≥Ê†ë‰∏äË∑ùÁ¶ªÔºâÂª∫Á´ãÁÇπÂàÜÊ†ëÔºåÂÅáËÆæÁé∞Âú®ÊúÄÁü≠Ë∑ØË∑ëÂà∞‰ªé $u$ ÂºÄÂßãÊõ¥Êñ∞ÂÖ∂ÂÆÉËäÇÁÇπÔºåÈÇ£‰πàÊûö‰∏æ $u$ Âú®ÁÇπÂàÜÊ†ë‰∏äÁöÑÊØè‰∏™Á•ñÂÖàÔºåÈÇ£‰πàÂÖ∂ÊØè‰∏™Á•ñÂÖà $fa$ ÂåÖÂê´ÁöÑËäÇÁÇπ‰∏≠ÔºåÊª°Ë∂≥ $dist (u, fa) + dist (fa, v) \le f_u$ ÁöÑÊâÄÊúâËäÇÁÇπ $v$ ÊòØ $u$ Â∫îÂΩìÂéªÊõ¥Êñ∞ÁöÑÔºå‰∏çÈöæÂèëÁé∞ÔºåËøôÊ†∑ÁöÑ $v$ ‰∏ÄÂÆöÊòØÊåâÂÆÉÂà∞ $fa$ ÁöÑË∑ùÁ¶ªË¢´È°∫Â∫èÊõ¥Êñ∞ÁöÑÔºåÊâÄ‰ª•ÂèØ‰ª•ËÆ∞ÂΩïÊØè‰∏™ÁÇπ $p$ Âú®ÁÇπÂàÜÊ†ë‰∏äÊåâÂà∞ $p$ Ë∑ùÁ¶ªÈÄíÂ¢ûÊéíÂàóÁöÑÂ≠êËäÇÁÇπÔºåÂπ∂ËÆ∞ÂΩï‰∏Ä‰∏™ÊåáÈíàÔºåÂç≥Â∑≤ÁªèÊõ¥Êñ∞Âà∞Âì™‰∏™Â≠êËäÇÁÇπÔºå‰ª•ÂêéÂú®ÁÇπÂàÜÊ†ë‰∏äÊûö‰∏æÂà∞ $p$ Âè™ÈúÄ‰ªéÊåáÈíàËÆ∞ÂΩï‰ΩçÁΩÆÂºÄÂßãÊûö‰∏æÂç≥ÂèØÔºåËøôÊ†∑Â≠êÊØè‰∏™ËäÇÁÇπË¢´ËÆøÈóÆÂà∞ $log n$ Ê¨°ÔºåÊïÖÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log n)$</p><p>ÂØπ‰∫é $m \ge n$ ÁöÑÊÉÖÂÜµÔºåÁî®‰∏é‰∏äÈù¢Á±ª‰ººÁöÑÁÆóÊ≥ïÔºåÁî±‰∫éÂÆÉÊúÄÂ§öÂ§öÂá∫ $50$ Êù°ËæπÔºå‰∏çÂ¶®Â∞±‰ª• $m = n + 50$ Êù•ËÆ∫</p><p>Âú®Âõæ‰∏≠ÈöèÊÑèÊäΩÂá∫‰∏ÄÊ£µÁîüÊàêÊ†ëÔºåÈÇ£‰πàÈÇ£‰∫õ‰∏çÂú®ÁîüÊàêÊ†ë‰∏≠ÁöÑËæπ $(u, v)$ Êàë‰ª¨Â∞Ü $u$ ËÆ∞‰ΩúÂÜó‰ΩôËäÇÁÇπÔºåÂç≥ËøôÊ†∑ÁöÑËæπ‰∏∫ÂÜó‰ΩôËæπÔºåÂæàÊòæÁÑ∂ËøôÊ†∑ÁöÑËäÇÁÇπÊúÄÂ§ö $50$ ‰∏™</p><p>ÈÇ£‰πà‰ªéÁÇπ $u$ Âà∞ÁÇπ $v$ ÁöÑÊúÄÁü≠Ë∑ùÁ¶ªÂ∞±Êúâ‰∏§ÁßçÊÉÖÂÜµ</p><ul><li>ÂÖ®ÈÉ®Ëµ∞Ê†ë‰∏äË∑ØÂæÑ</li><li>‰∫§ÊõøËµ∞Ê†ë‰∏äË∑ØÂæÑ‰∏éÂÜó‰ΩôË∑ØÂæÑÔºåÈÇ£‰πàÂÆÉ‰∏ÄÂÆöËá≥Â∞ëÁªèËøá‰∏Ä‰∏™ÂÜó‰ΩôËäÇÁÇπ $x$ÔºåÊª°Ë∂≥ $dist (u, x) + dist (x, v) \le f_u$</li></ul><p>ÂØπÁ¨¨‰∏ÄÁßçÊÉÖÂÜµÔºåÂú®ÁîüÊàêÊ†ë‰∏≠ËøêË°å‰∏äÈù¢ÊâÄËø∞ $m = n - 1$ ÂêåÊ†∑ÁöÑÁÆóÊ≥ïÂç≥ÂèØÔºåÈóÆÈ¢òÂú®‰∫éÁ¨¨‰∫åÁßçÊÉÖÂÜµ</p><p>ÂÆûÈôÖ‰∏ä‰∏§ÁßçÊÉÖÂÜµÊú¨Ë¥®‰∏äÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂØπÊØè‰∏™ÂÜó‰ΩôËäÇÁÇπ $p$ÔºåÂ∞ÜÊâÄÊúâ $n$ ‰∏™ËäÇÁÇπÊåâÂà∞ $p$ ÁöÑË∑ùÁ¶ªÈÄíÂ¢ûÊéíÂ∫èÂ≠òÂú®Êï∞ÁªÑ‰∏≠ÔºåÈÇ£‰πàÊúÄÁü≠Ë∑ØËøêË°åÂà∞ $u$ Êó∂ÂêåÊ†∑‰πüÂè™Ë¶ÅÁî®ÊåáÈíàÂú®Êï∞ÁªÑÈáåËµ∞Â∞±Â•Ω‰∫ÜÔºåÊ≠•È™§Âíå $m = n - 1$ ÁöÑÊÉÖÂÜµ‰πüÊòØ‰∏ÄÊ†∑ÁöÑ</p><p>ËøôÊ†∑ÊØè‰∏™ËäÇÁÇπÊúÄÂ§öË¢´ËÆøÈóÆ $50 + \log n$ Ê¨°ÔºåÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶ $O \left(n (50 + \log n)\right)$</p><h3 id="‰ª£Á†Å-2"><a href="#‰ª£Á†Å-2" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">50</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="keyword">const</span> LL LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span>  <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, E = <span class="number">0</span>, Tm;</span><br><span class="line"><span class="keyword">int</span> b[MAXN];</span><br><span class="line"><span class="keyword">int</span> f[MAXN], c[MAXN], w[MAXN];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; pt[MAXN], ex[<span class="number">60</span>];</span><br><span class="line"><span class="keyword">int</span> poi[MAXN]= &#123;<span class="number">0</span>&#125;, pex[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> ances[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ances[x] == x ? x : ances[x] = find (ances[x]); &#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; edge[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ances[i] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = edge[i].first, y = edge[i].second;</span><br><span class="line"><span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line"><span class="keyword">if</span> (fx == fy) &#123; b[++ E] = x; <span class="keyword">continue</span>; &#125;</span><br><span class="line">ances[fx] = fy; Insert (x, y), Insert (y, x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> subsize[MAXN], g, mini;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">acsize</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>; <span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">acsize (v, root, n);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line">maxpart = max (maxpart, subsize[v]);</span><br><span class="line">&#125;</span><br><span class="line">maxpart = max (maxpart, n - subsize[root]);</span><br><span class="line"><span class="keyword">if</span> (maxpart &lt; mini) g = root, mini = maxpart;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lev[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> depth[<span class="number">25</span>][MAXN], d[MAXN], m = <span class="number">0</span>, mdep = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father, <span class="keyword">int</span> l)</span> </span>&#123;</span><br><span class="line">d[++ m] = root; mdep = max (mdep, depth[l][root]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">depth[l][v] = depth[l][root] + <span class="number">1</span>;</span><br><span class="line">DFS (v, root, l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> buck[MAXN]= &#123;<span class="number">0</span>&#125;, topo[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> n, <span class="keyword">int</span> l, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">mini = INF, acsize (u, <span class="number">0</span>, n);</span><br><span class="line">father[g] = fa; visit[g] = <span class="literal">true</span>;</span><br><span class="line">mdep = m = <span class="number">0</span>, lev[g] = l, depth[l][g] = <span class="number">0</span>; DFS (g, <span class="number">0</span>, l);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= mdep; i ++) buck[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) buck[depth[l][d[i]]] ++, topo[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= mdep; i ++) buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) topo[buck[depth[l][d[i]]] --] = d[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) pt[g].push_back(topo[i]);</span><br><span class="line">acsize (g, <span class="number">0</span>, n); <span class="keyword">int</span> fg = g;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[fg]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">divide (v, subsize[v], l + <span class="number">1</span>, fg);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="keyword">int</span> deep[<span class="number">51</span>][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linkit</span> <span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) que.pop();</span><br><span class="line"><span class="built_in">memset</span> (vis, <span class="literal">false</span>, <span class="keyword">sizeof</span> (vis));</span><br><span class="line">que.push(S), deep[id][S] = <span class="number">0</span>, vis[S] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) G[u].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = G[u][i];</span><br><span class="line"><span class="keyword">if</span> (vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">deep[id][v] = deep[id][u] + <span class="number">1</span>;</span><br><span class="line">que.push(v); vis[v] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++) buck[i] = topo[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) buck[deep[id][i]] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) topo[buck[deep[id][i]] --] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ex[id].push_back(topo[i]);</span><br><span class="line">&#125;</span><br><span class="line">LL value[MAXN], ans[MAXN]= &#123;<span class="number">0</span>&#125;, dist[MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> id; LL d;</span><br><span class="line">node (<span class="keyword">int</span> id = <span class="number">0</span>, LL d = <span class="number">0</span>) : id (id), d (d) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123; <span class="keyword">return</span> d &gt; p.d; &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">priority_queue&lt;node&gt; heap;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trans</span> <span class="params">(<span class="keyword">int</span> u, LL d)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> p = u; p; p = father[p]) &#123;</span><br><span class="line"><span class="keyword">int</span> l = lev[p];</span><br><span class="line"><span class="keyword">for</span> ( ; poi[p] &lt; (<span class="keyword">int</span>) pt[p].size(); poi[p] ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = pt[p][poi[p]];</span><br><span class="line"><span class="keyword">if</span> (depth[l][u] + depth[l][v] &gt; f[u]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (dist[v] &lt; LINF) <span class="keyword">continue</span>;</span><br><span class="line">dist[v] = dist[u] + value[v];</span><br><span class="line">heap.push(node (v, dist[v]));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= E; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> ( ; pex[i] &lt; (<span class="keyword">int</span>) ex[i].size(); pex[i] ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = ex[i][pex[i]];</span><br><span class="line"><span class="keyword">if</span> (deep[i][u] + deep[i][v] &gt; f[u]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (dist[v] &lt; LINF) <span class="keyword">continue</span>;</span><br><span class="line">dist[v] = dist[u] + value[v];</span><br><span class="line">heap.push(node (v, dist[v]));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> T)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) value[i] = <span class="number">1l</span>l * c[i] * T + w[i];</span><br><span class="line"><span class="built_in">memset</span> (poi, <span class="number">0</span>, <span class="keyword">sizeof</span> (poi)); <span class="built_in">memset</span> (pex, <span class="number">0</span>, <span class="keyword">sizeof</span> (pex));</span><br><span class="line"><span class="keyword">while</span> (! heap.empty()) heap.pop();</span><br><span class="line"><span class="built_in">memset</span> (dist, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (dist));</span><br><span class="line">dist[<span class="number">1</span>] = value[<span class="number">1</span>], heap.push(node (<span class="number">1</span>, dist[<span class="number">1</span>]));</span><br><span class="line"><span class="keyword">while</span> (! heap.empty()) &#123;</span><br><span class="line">node top = heap.top(); heap.pop();</span><br><span class="line"><span class="keyword">int</span> u = top.id; LL d = top.d;</span><br><span class="line">trans (u, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ans[i] = min (ans[i], dist[i] - value[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), Tm = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) f[i] = getnum (), c[i] = getnum (), w[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">G[u].push_back(v), G[v].push_back(u);</span><br><span class="line">edge[i] = make_pair (u, v);</span><br><span class="line">&#125;</span><br><span class="line">build ();</span><br><span class="line">sort (b + <span class="number">1</span>, b + E + <span class="number">1</span>);</span><br><span class="line">E = unique (b + <span class="number">1</span>, b + E + <span class="number">1</span>) - b - <span class="number">1</span>;</span><br><span class="line">divide (<span class="number">1</span>, N, <span class="number">1</span>, <span class="number">0</span>); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= E; i ++) linkit (b[i], i);</span><br><span class="line"><span class="built_in">memset</span> (ans, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (ans));</span><br><span class="line">solve (<span class="number">1</span>), solve (Tm);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) write (ans[i]), <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ËÉåÂåÖDP </tag>
            
            <tag> ÊúÄÁü≠Ë∑Ø </tag>
            
            <tag> Áä∂ÂéãDP </tag>
            
            <tag> ÁÇπÂàÜÊ≤ª </tag>
            
            <tag> Êï∞Â≠¶ </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> Ê¶ÇÁéáDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅ‰πùÔºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B9%9D%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B9%9D%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÂÜçÊ¨°Âû´Â∫ï$\text{.jpg}$</p><p>$\text{scoreÔºö20 + 0 + 10 = 30   rkÔºö27/29}$</p><h2 id="Problem-AÔºösign"><a href="#Problem-AÔºösign" class="headerlink" title="Problem AÔºösign"></a>Problem AÔºösign</h2><h3 id="È¢òÈù¢"><a href="#È¢òÈù¢" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/18/v9ViJtBL6OAnzYG.png" alt=""></p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËøôÈ¢òË¥ºÊ∞¥Ôºå‰ΩÜÊàëÊ≤°ÊÉ≥Âá∫Êù•„ÄÇ„ÄÇ</p><p>ÊàëÂ§ßÊ¶Ç‰ª•‰∏∫Ëøô‰∏çÊòØÊï∞Â≠¶ÊâÄ‰ª•Ê≤°ÊÉ≥Âà∞‰ª£ÂÖ•ÔºåÊàñËÄÖÊòØÊàëÂøòËÆ∞ËØ•ÁÇπÂÄºË°®Á§∫ÂèØ‰ª• $O (\log A)$</p><p>ÂèçÊ≠£ÂÖ®ÊùëÂ∞±ÊàëÊ≤°Âà∞ÂèäÊ†ºÁ∫ø</p><p>È¢òËß£ÊáíÂæóÂÜô‰∫ÜÔºåÂ∞±Êê¨Âá∫È¢ò‰∫∫ÁªôÁöÑÂêß</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/18/Pu2fmObx8V4RDnZ.png" alt=""></p><p>‰∫ãÂÆû‰∏äÔºåËøô‰∏™ÂÅöÊ≥ï‰∏çËÉΩÈÄöËøá„ÄÇ</p><p>ËÄÉËôë‰∏äÈù¢ÂÅöÊ≥ïÂ§çÊùÇÂ∫¶Áì∂È¢àÊòØÂø´ÈÄüÂπÇ„ÄÇ‰∏Ä‰∏™ÁÆÄÂçïÁöÑ$\text{trick}$ÊòØÂØπ‰∫é‰∏Ä‰∏™Âõ∫ÂÆöÁöÑ $son_u = k$Ôºå‰ª§ $M = \lceil \sqrt{A} \rceil$ÔºåÈ¢ÑÂ§ÑÁêÜÂá∫ $k^0, k^1, k^2, ‚Ä¶, k^{M - 1}$ ‰ª•Âèä $(k^M)^0, (k^M)^1, ‚Ä¶, (k^M)^{M - 1}$„ÄÇËøôÊ†∑ÂçïÊ¨°Ê±ÇÊüê‰∏™ÁÇπÂÄºÂ∞±ÂèØ‰ª•Áî® $O (1)$ Ê¨°ÁÆóÊúØËøêÁÆóÊ±ÇÂæó„ÄÇ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ $O ((n + \sqrt{A})\sqrt{n})$„ÄÇ</p><p>‰ª•‰∏äÊòØÂá∫È¢ò‰∫∫Êèê‰æõÈ¢òËß£</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e04</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;, son[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> b[MAXN]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line">LL ans[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL inv;</span><br><span class="line">LL f1[MAXN]= &#123;<span class="number">0</span>&#125;, f2[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> base = p / M, rest = p - base * M;</span><br><span class="line"><span class="keyword">return</span> f2[base] * f1[rest] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">work</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">LL r;</span><br><span class="line"><span class="keyword">if</span> (t == <span class="number">1</span>) r = a[root] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> r = (<span class="number">1</span> - calc (a[root] + <span class="number">1</span>) + MOD) % MOD * inv % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">r = r * work (v, t) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (t == son[root]) ans[root] = r;</span><br><span class="line"><span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> fa = getnum ();</span><br><span class="line">Insert (fa, i); son[fa] ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) b[++ m] = son[i];</span><br><span class="line">sort (b + <span class="number">1</span>, b + m + <span class="number">1</span>);</span><br><span class="line">m = unique (b + <span class="number">1</span>, b + m + <span class="number">1</span>) - b - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) &#123;</span><br><span class="line">inv = power (<span class="number">1</span> - b[i] + MOD, MOD - <span class="number">2</span>);</span><br><span class="line">f1[<span class="number">0</span>] = <span class="number">1</span>, f2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) f1[j] = f1[j - <span class="number">1</span>] * b[i] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) f2[j] = f2[j - <span class="number">1</span>] * f1[M] % MOD;</span><br><span class="line">work (<span class="number">1</span>, b[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºömatch"><a href="#Problem-BÔºömatch" class="headerlink" title="Problem BÔºömatch"></a>Problem BÔºömatch</h2><h2 id="Problem-CÔºötree"><a href="#Problem-CÔºötree" class="headerlink" title="Problem CÔºötree"></a>Problem CÔºötree</h2><h3 id="È¢òÈù¢-1"><a href="#È¢òÈù¢-1" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/18/rxE7RpM2lkOtGWi.png" alt=""></p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ËøôÈ¢òÊúÄÂü∫Êú¨ÁöÑÊÄùË∑ØÊàë‰∏ÄÂºÄÂßãÊÉ≥‰∫Ü‰∏Ä‰∏ãÔºåÁÑ∂ÂêéÈ©¨‰∏äÊâî‰∫Ü„ÄÇ„ÄÇ</p><p>È¶ñÂÖàËÄÉËôëÊØè‰∏™ÁÇπÂÆÉËÉΩÂ§ü‰Ωú‰∏∫Ë¢´ $LCA$ ÁöÑÊÉÖÂÜµ</p><p>ËÄÉËôëÈáçÈìæÂâñÂàÜÔºåÂêØÂèëÂºèÂêàÂπ∂ÔºåËÆæÁÇπ $u$ ÈáçÂ≠êÊ†ë $A$ÔºåÂè¶‰∏ÄÂ≠êÊ†ë $B$ÔºåÂàôÂØπ $i \in B, j \in A$ÔºåÊª°Ë∂≥ $LCA (i, j) = u$ÔºåÊ≠§Êó∂ÈÄâÊã© $i, j$Ôºå$u$ ÂèØ‰ª•Ë¥°ÁåÆÁªôÂå∫Èó¥ $[l, r]$ Êª°Ë∂≥ $l \in [1, i], r \in [j, n]$ÔºàÂÅáÂÆö $i &lt; j)$Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÊûÅÈôêÊÉÖÂÜµÂç≥ÊòØÂèñ $i$ Âú® $A$ ‰∏≠ÁöÑÂâçÈ©± $pre$ ‰∏éÂêéÁªß $nxt$ÔºåÂàôÊúÄÂ§ß $u$ ÂèØË¥°ÁåÆÂå∫Èó¥Âç≥‰∏∫ $[1, pre] \cup [i, n]$ ‰∏é $[1, i] \cup [nxt, n]$</p><p>Ê≠§Êó∂‰∏çÂ¶®ÊääÂå∫Èó¥ $l, r$ ËßÜ‰∏∫‰∫åÁª¥Âπ≥Èù¢‰∏äÁöÑÁÇπ $(l, r)$ÔºåÈÇ£‰πà‰∏äÈù¢ÊâÄËØ¥ÁöÑ $i$ ÂØºËá¥ÁöÑ $u$ ÁöÑÊúÄÂ§ßÂèØË¥°ÁåÆÂå∫Èó¥Âú®Âπ≥Èù¢‰∏äÂàôÊäïÂΩ±‰∏∫Áü©ÂΩ¢ $(1, i), (1, n), (pre, i), (pre, n)$ ‰∏éÁü©ÂΩ¢ $(1, nxt), (1, n), (i, nxt), (i, n)$ÔºàÂèñÁü©ÂΩ¢ÁöÑÂõõ‰∏™ËßíÔºâ</p><p>ËÄÉËôëÊääÊâÄÊúâ  $depth$ ‰∏ÄËá¥ÁöÑÁÇπÊâÄË¥°ÁåÆÁöÑÁü©ÂΩ¢Ê∂Ç‰∏äÁõ∏ÂêåÁöÑÈ¢úËâ≤ÔºåÊ±ÇÊØèÁßçÈ¢úËâ≤ÁöÑÁü©ÂΩ¢ÂêÑËá™ÁöÑÂπ∂ÔºåÈÇ£‰πàÊúÄÁªàËØ¢ÈóÆÁÇπ $(l, r)$ Ë¢´Â§öÂ∞ëÁßçÈ¢úËâ≤ÁöÑÈù¢ÁßØÊâÄË¶ÜÁõñÂàôÊòØÁ≠îÊ°à</p><p>Ê±ÇÁü©ÂΩ¢ÁöÑÂπ∂‰πüÂæàÁÆÄÂçïÔºåÂõ†‰∏∫Ëøô‰∫õÁü©ÂΩ¢ÈÉΩÊòØ‰∏•Ê†ºË¥¥ÁùÄÂπ≥Èù¢Â∑¶‰∏äËßíÔºàÂç≥ $(1, n)$ÔºâÁöÑ</p><p>ÁÑ∂ÂêéÊâ´ÊèèÁ∫ø‰∏ÄÊ≥¢Â∞±ÂÅöÂÆå‰∫Ü</p><p>‰∏çËøá‰∏çË¶ÅÂøò‰∫ÜÈ¢òÈù¢ÊâÄËØ¥ÁöÑ $i, j$ ÂèØ‰ª•Áõ∏ÂêåÔºåÊâÄ‰ª•ÂØπÊØè‰∏™ $i, i \in [1, n]$ÔºåËøòÂæóÂä†‰∏ä $(1, i), (1, n), (i, i), (i, n)$ ÁöÑÁü©ÂΩ¢</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125; ;</span><br><span class="line">LFS Link[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> son[MAXN]= &#123;<span class="number">0</span>&#125;, subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> d[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL dist[MAXN]= &#123;<span class="number">0</span>&#125;, mpp[MAXN]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line">mpp[++ m] = dist[root];</span><br><span class="line">son[root] = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">dist[v] = dist[root] + w;</span><br><span class="line">DFS (v, root);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line"><span class="keyword">if</span> (son[root] == - <span class="number">1</span> || subsize[v] &gt; subsize[son[root]])</span><br><span class="line">son[root] = v;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; mat[MAXN]; <span class="comment">// &lt;Á∫µÂùêÊ†á, Ê®™ÂùêÊ†á&gt;</span></span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; st[MAXN];</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; :: iterator it, it2;</span><br><span class="line"><span class="keyword">int</span> ext[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (it = st[y].begin(); it != st[y].end(); it ++) &#123;</span><br><span class="line"><span class="keyword">int</span> i = * it;</span><br><span class="line">it2 = st[x].lower_bound(i);</span><br><span class="line"><span class="keyword">int</span> pre = i, nxt = i;</span><br><span class="line"><span class="keyword">if</span> (it2 != st[x].begin()) &#123; it2 --; pre = * it2; &#125;</span><br><span class="line">it2 = st[x].upper_bound(i);</span><br><span class="line"><span class="keyword">if</span> (it2 != st[x].end()) nxt = * it2;</span><br><span class="line"><span class="keyword">if</span> (nxt != i) mat[id].push_back(make_pair (nxt, i));</span><br><span class="line"><span class="keyword">if</span> (pre != i) mat[id].push_back(make_pair (i, pre));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (it = st[y].begin(); it != st[y].end(); it ++) st[x].insert(* it);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (son[root] == - <span class="number">1</span>) &#123;</span><br><span class="line">st[root].insert(root); ext[root] = root;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">make (son[root], root);</span><br><span class="line">ext[root] = ext[son[root]];</span><br><span class="line">st[ext[root]].insert(root);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father || v == son[root]) <span class="keyword">continue</span>;</span><br><span class="line">make (v, root);</span><br><span class="line">merge (ext[root], ext[v], d[root]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> x, y, type, id;</span><br><span class="line"><span class="comment">// type: - 1, + 1, 2(dot)</span></span><br><span class="line">node (<span class="keyword">int</span> x = <span class="number">0</span>, <span class="keyword">int</span> y = <span class="number">0</span>, <span class="keyword">int</span> type = <span class="number">0</span>, <span class="keyword">int</span> id = <span class="number">0</span>) : x (x), y (y), type (type), id (id) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (x == p.x) <span class="keyword">return</span> type &lt; p.type;</span><br><span class="line"><span class="keyword">return</span> x &lt; p.x;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">node a[MAXM &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mesh</span> <span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">sort (mat[id].begin(), mat[id].end());</span><br><span class="line"><span class="keyword">int</span> lx = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) mat[id].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> y = mat[id][i].first, x = mat[id][i].second;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= lx) &#123;</span><br><span class="line">a[++ n] = node (lx, y, <span class="number">1</span>, id);</span><br><span class="line">a[++ n] = node (x + <span class="number">1</span>, y, - <span class="number">1</span>, id);</span><br><span class="line">lx = x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> answer[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="keyword">int</span> subsum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (x &lt;= N) &#123;</span><br><span class="line">subsum[x] += delta;</span><br><span class="line">x += lowbit (x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (x &gt; <span class="number">0</span>) &#123;</span><br><span class="line">ret += subsum[x];</span><br><span class="line">x -= lowbit (x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">sort (a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> y = a[i].y, type = a[i].type, id = a[i].id;</span><br><span class="line"><span class="keyword">if</span> (type == <span class="number">2</span>) answer[id] = query (y);</span><br><span class="line"><span class="keyword">else</span> add (y, type);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">&#125;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">sort (mpp + <span class="number">1</span>, mpp + m + <span class="number">1</span>);</span><br><span class="line">m = unique (mpp + <span class="number">1</span>, mpp + m + <span class="number">1</span>) - mpp - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) d[i] = lower_bound (mpp + <span class="number">1</span>, mpp + m + <span class="number">1</span>, dist[i]) - mpp;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) mat[d[i]].push_back(make_pair (i, i));</span><br><span class="line">make (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) mesh (i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= M; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">a[++ n] = node (l, r, <span class="number">2</span>, q);</span><br><span class="line">&#125;</span><br><span class="line">solve ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, answer[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁîüÊàêÂáΩÊï∞ </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> ÂêØÂèëÂºèÂêàÂπ∂ </tag>
            
            <tag> Êâ´ÊèèÁ∫ø </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅ‰∏ÉÔºâ</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%83%EF%BC%89/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%83%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>‰ªäÊó•ÂèàÊòØ‰∏âÈÅìÈõÜËÆ≠Èòü‰Ωú‰∏öÂéüÈ¢ò„ÄÇ„ÄÇÂèàÊ≤°ÈÉ®ÂàÜÂàÜ„ÄÇ„ÄÇ</p><p>ÂèçÊ≠£ÊàëÈÉΩ‰∏ç‰ºöÂøÖÂÆöÁàÜÈõ∂Â∞±Ê≤°‰∫§‰∫Ü„ÄÇ„ÄÇ</p><p>$\text{scoreÔºöNULL   rkÔºöNULL}$</p><h2 id="Problem-AÔºöBirthday"><a href="#Problem-AÔºöBirthday" class="headerlink" title="Problem AÔºöBirthday"></a>Problem AÔºöBirthday</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ÁªôÂÆö $n$ ‰∏™‰ªÖÂåÖÂê´ <code>a,b</code> ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ</p><p>‰Ω†ÈúÄË¶ÅÂéªÊéâÂ∞ΩÂèØËÉΩÂ∞ëÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰ΩøÂæóÂâ©‰∏ãÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠‰∏çÂ≠òÂú®Êüê‰∏Ä‰∏™‰∏≤ÊòØÂè¶‰∏Ä‰∏™‰∏≤ÁöÑÂ≠ê‰∏≤„ÄÇ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n \le 750, ~ \sum\limits_{i = 1}^n |s_i \le 10^7$</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂéüÈ¢ò <a href="https://codeforces.com/problemset/problem/590/E?f0a28=2" target="_blank" rel="noopener">CF590E</a></p><p>Áî±‰∫é $n$ ÂæàÂ∞èÔºåÂæàÊòæÁÑ∂ÂèØ‰ª•ÂØπÊØè‰∏ÄÂØπÂ≠óÁ¨¶‰∏≤Âà§Êñ≠‰∏Ä‰∏™ÊòØ‰∏çÊòØÂè¶‰∏Ä‰∏™ÁöÑÂ≠ê‰∏≤ÔºåÂ¶ÇÊûúÊòØÂ∞±Ëøû‰∏™ÂçïÂêëËæπÔºåÊúÄÁªàÂΩ¢Êàê‰∏Ä‰∏™ $DAG$ ÁÑ∂ÂêéÂú®‰∏äÈù¢Êêû</p><p>ÈÇ£‰πàÂØπ‰∫éÂª∫ÂõæÔºåÂÖàÂª∫‰∏™$\text{AC}$Ëá™Âä®Êú∫ÔºåÂú® $trie$ ÁöÑÁªìÂ∞æÂ≠ò‰∏Ä‰∏ãÁºñÂè∑ÔºåÁÑ∂ÂêéÊääÊØè‰∏™‰∏≤Êâî‰∏äÂéªÂåπÈÖçÔºåÊØèÊ¨°ÂåπÈÖç‰∏éËµ∞Âà∞ËäÇÁÇπ $fail$ Ê†ë‰∏äÁöÑÊâÄÊúâÁºñÂè∑ÔºàÂç≥ÂÆÉÁöÑÂ≠ê‰∏≤ÔºâËøûËæπ</p><p>ÂΩìÁÑ∂Áõ¥Êé•ËøûËæπËÇØÂÆö‰ºö $T$ÔºåÂÆûÈôÖ‰∏ä‰Ω†Âè™Ë¶ÅÂæÄÂú® $fail$ Ê†ëÂæÄ‰∏äÊâæÂà∞ÁöÑÁ¨¨‰∏Ä‰∏™ÁºñÂè∑‰ª•ÂèäÊú¨Ë∫´ËäÇÁÇπÁöÑÁºñÂè∑ÔºàÂ¶ÇÊûúÂ≠òÂú®ÁöÑËØùÔºâËøûËæπÔºåÁÑ∂Âêé‰º†ÈÄíÈó≠ÂåÖÂ∞±Â•Ω‰∫ÜÔºåËøôÊ†∑Â§çÊùÇÂ∫¶Â∞±Ê≠£Á°Æ‰∫Ü</p><p>ÈÇ£‰πàÊé•‰∏ãÊù•ÁöÑ‰ªªÂä°Â∞±ÊòØÂú® $DAG$ ‰∏äÊ±ÇÂá∫ÊúÄÈïøÂèçÈìæÂπ∂ÊûÑÈÄ†ÊñπÊ°à</p><p>ÈÇ£ËøôÂ∞±ÊòØ <a href="https://colythme.github.io/2020/07/15/[CTSC2008]Á•≠Á•ÄÔºàDAGÊúÄÈïøÂèçÈìæÂèäÂÖ∂ÊñπÊ°àÊûÑÈÄ†Ôºâ/">[CTSC2008]Á•≠Á•Ä</a></p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">750</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e07</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">2</span> * MAXN + MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFDS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125;;</span><br><span class="line">LFDS iLink[MAXN * MAXN];</span><br><span class="line"><span class="keyword">int</span> iHead[MAXM]= &#123;<span class="number">0</span>&#125;, isize = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">iLink[++ isize].to = v;</span><br><span class="line">iLink[isize].next = iHead[u];</span><br><span class="line"></span><br><span class="line">iHead[u] = isize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">char</span> str[MAXM];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sve[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tr[MAXM][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span> <span class="params">(<span class="keyword">int</span> ind)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>, n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = str[i] - <span class="string">'a'</span>;</span><br><span class="line">sve[ind].push_back(c);</span><br><span class="line"><span class="keyword">if</span> (! tr[p][c]) tr[p][c] = ++ m;</span><br><span class="line">p = tr[p][c];</span><br><span class="line">&#125;</span><br><span class="line">Insert (p, ind);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> fail[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="keyword">int</span> lastp[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">bitset</span>&lt;MAXN&gt; g[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i ++)</span><br><span class="line"><span class="keyword">if</span> (tr[<span class="number">0</span>][i])</span><br><span class="line">que.push(tr[<span class="number">0</span>][i]);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line">lastp[u] = iHead[fail[u]] ? fail[u] : lastp[fail[u]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (tr[u][i]) &#123;</span><br><span class="line">fail[tr[u][i]] = tr[fail[u]][i];</span><br><span class="line">que.push(tr[u][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> tr[u][i] = tr[fail[u]][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">(<span class="keyword">int</span> ind)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) sve[ind].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = sve[ind][i];</span><br><span class="line">p = tr[p][c];</span><br><span class="line"><span class="keyword">int</span> tp = p;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">2</span>; j ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = iHead[tp]; k; k = iLink[k].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = iLink[k].to;</span><br><span class="line"><span class="keyword">if</span> (v == ind) <span class="keyword">continue</span>;</span><br><span class="line">g[v][ind] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">tp = lastp[tp];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, cap, next; &#125; ;</span><br><span class="line">LFS Link[MAXL &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;, size = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].cap = cap;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Insert (x, y, cap); Insert (y, x, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> S, T, _N;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) que.pop();</span><br><span class="line"><span class="built_in">memset</span> (depth, <span class="number">0</span>, <span class="keyword">sizeof</span> (depth));</span><br><span class="line">depth[S] = <span class="number">1</span>, que.push(S);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] || ! cap) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[u] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (v == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cur[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> flow)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (p == T) <span class="keyword">return</span> flow;</span><br><span class="line"><span class="keyword">int</span> rest = flow;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> &amp;i = cur[p]; i &amp;&amp; rest; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] != depth[p] + <span class="number">1</span> || ! cap) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> k = Dinic (v, min (cap, rest));</span><br><span class="line"><span class="keyword">if</span> (! k) depth[v] = - <span class="number">1</span>;</span><br><span class="line">Link[i].cap -= k, Link[i ^ <span class="number">1</span>].cap += k;</span><br><span class="line">rest -= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow - rest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">MAXFLOW</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (BFS ()) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= _N; i ++) cur[i] = Head[i];</span><br><span class="line">ret += Dinic (S, INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> match[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> tagl[MAXN]= &#123;<span class="literal">false</span>&#125;, tagr[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">tagr[u - N] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][u - N] &amp;&amp; ! tagl[i]) &#123;</span><br><span class="line">tagl[i] = <span class="literal">true</span>;</span><br><span class="line">DFS (match[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>);</span><br><span class="line">insert (i);</span><br><span class="line">&#125;</span><br><span class="line">build ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) work (i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][k])</span><br><span class="line">g[i] |= g[k];</span><br><span class="line">S = <span class="number">2</span> * N + <span class="number">1</span>, _N = T = <span class="number">2</span> * N + <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">add (S, i, <span class="number">1</span>), add (i + N, T, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][j])</span><br><span class="line">add (i, j + N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> ans = N - MAXFLOW ();</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! Link[<span class="number">4</span> * i - <span class="number">2</span>].cap)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = Head[i]; j; j = Link[j].next)</span><br><span class="line"><span class="keyword">if</span> (! Link[j].cap) &#123;</span><br><span class="line">match[i] = Link[j].to;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (Link[<span class="number">4</span> * i].cap)</span><br><span class="line">DFS (i + N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! tagl[i] &amp;&amp; tagr[i])</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d "</span>, i);</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöA-Sequence-of-Permutations"><a href="#Problem-BÔºöA-Sequence-of-Permutations" class="headerlink" title="Problem BÔºöA Sequence of Permutations"></a>Problem BÔºöA Sequence of Permutations</h2><h3 id="È¢òÁõÆÊèèËø∞-1"><a href="#È¢òÁõÆÊèèËø∞-1" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ÁªôÂÆö‰∏§‰∏™Èïø‰∏∫ $n$ ÁöÑÊéíÂàó $p, q$ÔºåËÆæ $f(p, q)$ ‰∏∫‰ΩøÁ¨¨ $p_i$ ‰∏™Êï∞‰∏∫ $q_i$ ÁöÑÊéíÂàó</p><p>Â∑≤Áü• $a_1 = p, a_2 = q, a_{n + 2} = f(a_n, a_{n + 1})$ÔºåÊ±Ç $a_k$</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-1"><a href="#Êï∞ÊçÆËåÉÂõ¥-1" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$n \le 10^5, ~ k \le 10^9$</p><h3 id="ÂâçÁΩÆÁü•ËØÜ"><a href="#ÂâçÁΩÆÁü•ËØÜ" class="headerlink" title="ÂâçÁΩÆÁü•ËØÜ"></a>ÂâçÁΩÆÁü•ËØÜ</h3><p>ÂÆö‰πâ‰∏§‰∏™ÊéíÂàó $p, q$ ÁöÑ‰πòÊ≥ï‰∏∫ÔºåËÆæ $r = pq$ÔºåÂàôÊúâ<br>$$<br>r_i = p_{q_i}<br>$$<br>ËØ•‰πòÊ≥ïÊª°Ë∂≥ÁªìÂêàÂæãÔºå‰ΩÜ‰∏çÊª°Ë∂≥‰∫§Êç¢Âæã</p><p>ËØ•‰πòÊ≥ïÁöÑÂçï‰ΩçÂÖÉ‰∏∫ $e$ Êª°Ë∂≥ $e_i = i$ÔºåÈÇ£‰πàÊéíÂàó $p$ ÁöÑÈÄÜÂÖÉ $p^{- 1}$ Âç≥ÂèØÂÆö‰πâ‰∏∫ $p^{- 1}$ Êª°Ë∂≥ $p^{- 1}_{p_i} = i$</p><p>ÂØπÈÄÜÂÖÉÔºåÊúâ $(pq)^{- 1} = q^{- 1}p^{- 1}$ÔºåÂêåÁêÜÂØπÂ§ö‰∏™ÊéíÂàóÁõ∏‰πòÁöÑÈÄÜÂÖÉÔºåÂ∞ÜÂÆÉ‰ª¨ÂèçËøáÊù•ÂÜçÂàÜÂà´Ê±ÇÈÄÜÔºåÊúÄÂêéÊåâÈ°∫Â∫èÁõ∏‰πòÂç≥ÂèØ</p><p>‰∏ãÈù¢ÁªôÂá∫ËØ•ÈÄÜÂÖÉÂÖ¨ÂºèÁöÑÁÆÄÂçïËØÅÊòéÔºö</p><ul><li>ËÆæ $A = (pq)^{- 1}$ÔºåÂàôÊúâ $A_{p_{q_i}} = i$</li><li>ËÆæ $B = q^{-  1}p^{- 1}$ÔºåÂàôÊúâ $B_i = q^{- 1}<em>{p^{- 1}_i}$Ôºå‰ª§ $i = p_i$ÔºåÊúâ $B</em>{p_i} = q^{- 1}<em>i$ÔºåÂÜç‰ª§ $i = q_i$ÔºåÊúÄÂêéÊúâ $B</em>{p_{q_i}} = i$</li><li>Âç≥ $A_{p_{q_i}} = B_{p_{q_i}}$ÔºåÊïÖÁ≠âÂºèÊàêÁ´ã</li></ul><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>$$<br>\begin{aligned}<br>&amp;f(p, q)_{p_i} = q_i \\<br>\Rightarrow &amp;f(p, q) * p = q \\<br>\Rightarrow &amp;f(p, q) = qp^{- 1}<br>\end{aligned}<br>$$</p><p>ÁÑ∂ÂêéÊâìË°®ÊâæËßÑÂæã<br>$$<br>\begin{aligned}<br>a_1 &amp;= p \\<br>a_2 &amp;= q \\<br>a_3 &amp;= qp^{- 1} \\<br>a_4 &amp;= qp^{- 1}q^{- 1} \\<br>a_5 &amp;= qp^{- 1}q^{- 1}pq^{- 1} \\<br>a_6 &amp;= qp^{- 1}q^{- 1}p^2q^{- 1} \\<br>a_7 &amp;= qp^{- 1}q^{- 1}pqpq^{- 1} \\<br>a_8 &amp;= qp^{- 1}q^{- 1}pqp^{- 1}qpq^{- 1} \\<br>\cdots<br>\end{aligned}<br>$$<br>‰ª§ $t = qp^{- 1}q^{- 1}p$ÔºåÂàô $a_7 = tpt^{- 1}, a_8 = tqt^{- 1}$ÔºåÈÇ£‰πàÂèØ‰ª•ÂæóÂà∞ $a_{6k + 1} = t^kpt^{- k}, a_{6k + 2} = t^kqt^{- k}$ÔºåÂØπ $t$ ÂÅö‰∏™Âø´ÈÄüÂπÇÔºåÁÑ∂ÂêéÂâ©‰∏ãÁöÑÂá†È°πÊö¥Âäõ‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log \frac{k}{6})$</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="keyword">int</span> P[MAXN], Q[MAXN];</span><br><span class="line"><span class="keyword">int</span> IP[MAXN], IQ[MAXN];</span><br><span class="line"><span class="keyword">int</span> T[MAXN], IT[MAXN];</span><br><span class="line"><span class="keyword">int</span> Tk[MAXN], ITk[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span> <span class="params">(<span class="keyword">int</span>* ret, <span class="keyword">int</span>* p, <span class="keyword">int</span>* q)</span> </span>&#123; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret[i] = p[q[i]]; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inv</span> <span class="params">(<span class="keyword">int</span>* I, <span class="keyword">int</span>* p)</span> </span>&#123; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) I[p[i]] = i; &#125;</span><br><span class="line"><span class="keyword">int</span> A[MAXN], ret[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">power</span> <span class="params">(<span class="keyword">int</span>* x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret[i] = i;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) &#123; mul (A, ret, x); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret[i] = A[i]; &#125;</span><br><span class="line">mul (A, x, x); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) x[i] = A[i];</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) x[i] = ret[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span> <span class="params">(<span class="keyword">int</span>* a)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">1</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, a[i]);</span><br><span class="line">&#125; <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">7</span>][MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">0</span>) n = <span class="number">6</span>;</span><br><span class="line">mul (a[<span class="number">1</span>], P, ITk), mul (A, Tk, a[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[<span class="number">1</span>][i] = A[i];</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">1</span>) &#123; print (a[<span class="number">1</span>]); <span class="keyword">return</span> ; &#125;</span><br><span class="line">mul (a[<span class="number">2</span>], Q, ITk), mul (A, Tk, a[<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[<span class="number">2</span>][i] = A[i];</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">2</span>) &#123; print (a[<span class="number">2</span>]); <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">2</span>; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) a[i + <span class="number">2</span>][a[i][j]] = a[i + <span class="number">1</span>][j];</span><br><span class="line">print (a[n]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) P[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) Q[i] = getnum ();</span><br><span class="line">inv (IP, P), inv (IQ, Q);</span><br><span class="line">mul (T, IQ, P), mul (A, IP, T);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) T[i] = A[i];</span><br><span class="line">mul (A, Q, T); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) T[i] = A[i];</span><br><span class="line">inv (IT, T); <span class="keyword">int</span> k = K / <span class="number">6</span>; <span class="keyword">if</span> (! (K % <span class="number">6</span>)) k --;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) Tk[i] = T[i]; power (Tk, k);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ITk[i] = IT[i]; power (ITk, k);</span><br><span class="line"><span class="keyword">int</span> r = K % <span class="number">6</span>; solve (r);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-CÔºöSynchronized-Subsequence"><a href="#Problem-CÔºöSynchronized-Subsequence" class="headerlink" title="Problem CÔºöSynchronized Subsequence"></a>Problem CÔºöSynchronized Subsequence</h2><h3 id="È¢òÁõÆÊèèËø∞-2"><a href="#È¢òÁõÆÊèèËø∞-2" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>Êúâ‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $2n$ ÁöÑ‰ªÖÁî±Â≠óÁ¨¶ $\mathtt{a}, \mathtt{b}$ ÊûÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰∏î $\mathtt{a}$ ÁöÑ‰∏™Êï∞ÊÅ∞Â•ΩÁ≠â‰∫é $\mathtt{b}$ ÁöÑ‰∏™Êï∞ÔºåÈÉΩÂá∫Áé∞‰∫Ü $n$ Ê¨°</p><p>‰Ω†ÈúÄË¶Å‰øùÁïô‰∏Ä‰∫õÂ≠óÁ¨¶ÔºåÂâ©‰∏ãÁöÑÂ≠óÁ¨¶Âà†Êéâ„ÄÇÂØπ‰∫é‰∏Ä‰∏™ $i$Ôºå‰Ω†ÂèØ‰ª•‰øùÁïô‰ªéÂ∑¶ÂæÄÂè≥Êï∞ÁöÑÁ¨¨ $i$ ‰∏™ $\mathtt{a}$ ÂíåÁ¨¨ $i$ ‰∏™ $\mathtt{b}$</p><p>Ê≥®ÊÑèÔºåÂØπ‰∫éËøô‰∏§‰∏™Â≠óÁ¨¶ÔºåÂè™ËÉΩÂêåÊó∂‰øùÁïôÊàñÂêåÊó∂Âà†ÊéâÔºå‰∏çËÉΩÂè™‰øùÁïôÂÖ∂‰∏≠‰∏Ä‰∏™</p><p>ËØ∑‰Ω†Ê±ÇÂá∫ËÉΩÂæóÂà∞ÁöÑÂ≠óÂÖ∏Â∫èÊúÄÂ§ßÁöÑ‰∏≤</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-2"><a href="#Êï∞ÊçÆËåÉÂõ¥-2" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n \le 3000$</p><h3 id="È¢òËß£-2"><a href="#È¢òËß£-2" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂÖ∂ÂÆûÂ•ΩÂÉèÂèØ‰ª•Áõ¥Êé•Ë¥™ÂøÉÊù•ÁùÄÔºå‰ΩÜÊàëËßâÂæó Ë¥™ÂøÉ + $dp$ ÁöÑÊñπÊ≥ïÊõ¥ÂÄºÂæóËÆ∞ÂΩï</p><p>Áé∞Âú®ËÄÉËôëËã•Âº∫Âà∂Ë¶ÅÊ±ÇÁ¨¨ $i$ ÂØπ $a, b$ Â≠òÂú®Êúâ‰ªÄ‰πàÊ†∑ÁöÑÂ±ÄÈù¢ÔºåËÆæÁ¨¨ $i$ ÂØπ $a, b$ Âú®Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑ‰ΩçÁΩÆ $apos_i. bpos_i$</p><ul><li>Ëã• $apos_i &lt; bpos_i$ÔºåÈÇ£‰πàÂú®ÊääËØ•ÂØπ $a, b$ ‰πãÈó¥ÁöÑ $a$ ÂÖ®ÈÉ®Âà†Êéâ‰πãÂâçÈÉΩ‰∏çÊòØÊõ¥‰ºòÁöÑÔºåÊïÖÂÆÉ‰ª¨‰πãÈó¥ÁöÑ $a$ Â∫îÂÖ®ÈÉ®Âà†ÂéªÔºåÊúÄÁªàÁïô‰∏ã $ab$</li><li>Ëã• $apos_i &gt; bpos_i$ÔºåÊòæÁÑ∂ÂÆÉ‰ª¨‰πãÈó¥ÁöÑ $b$ ÈÉΩÂøÖÈ°ªÂÖ®ÈÉ®Â≠òÂú®</li></ul><p>ÈÇ£‰πàÁé∞Âú®ËÆ∞ $f_i$ Ë°®Á§∫Âº∫Âà∂ÈÄâÁ¨¨ $i$ ÂØπ $a,b$ÔºåÂØπ $i‚Ä¶n$ ÂØπ $a, b$ ÁªÑÂêàÊàêÁöÑÊúÄÂ§ß‰∏≤ÔºåËÆ∞ $g_i$ Ë°®Á§∫ $\max (f_i, f_i + 1, ‚Ä¶, f_n)$</p><p>Ê≥®ÊÑè $f, g$ ÈÉΩÊòØ $\text{string}$ Á±ªÂûã</p><p>ËΩ¨ÁßªÂ∞±Áúã‰ª£Á†ÅÊää</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">char</span> str[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> apos[MAXN]= &#123;<span class="number">0</span>&#125;, bpos[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> an = <span class="number">0</span>, bn = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> f[MAXN], g[MAXN];</span><br><span class="line"><span class="comment">// f[i]: Âº∫Âà∂ÈÄâÁ¨¨iÂØπa„ÄÅbÔºåÂØπi...nÂØπa„ÄÅbÁöÑÊúÄÂ§ß‰∏≤</span></span><br><span class="line"><span class="comment">// g[i]: max (f[i], f[i + 1], ..., f[n])</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%s"</span>, &amp; N, str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N &lt;&lt; <span class="number">1</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (str[i] == <span class="string">'a'</span>) apos[++ an] = i;</span><br><span class="line"><span class="keyword">if</span> (str[i] == <span class="string">'b'</span>) bpos[++ bn] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt;= <span class="number">1</span>; i --) &#123;</span><br><span class="line"><span class="keyword">if</span> (apos[i] &lt; bpos[i]) &#123;</span><br><span class="line"><span class="keyword">int</span> j = i;</span><br><span class="line"><span class="keyword">while</span> (j &lt;= N &amp;&amp; apos[j] &lt; bpos[i]) j ++;</span><br><span class="line">f[i] = <span class="string">"ab"</span> + g[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> j = i;</span><br><span class="line"><span class="keyword">while</span> (j &lt;= N &amp;&amp; bpos[j] &lt; apos[i]) j ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= j - i; k ++) f[i] += <span class="string">'b'</span>;</span><br><span class="line">f[i] += <span class="string">'a'</span> + (i + <span class="number">1</span> == j ? g[i + <span class="number">1</span>] : f[i + <span class="number">1</span>]).substr(j - i - <span class="number">1</span>, <span class="built_in">string</span>::npos); <span class="comment">// j-i-1Ë°®Á§∫i...j-1ÈÉΩÂ∑≤ÁªèÊîæÂÆåÔºåÂèñg[i+1]Êàñf[i+1]ÁöÑj...nÊÆµ</span></span><br><span class="line">&#125;</span><br><span class="line">g[i] = max (f[i], g[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; g[<span class="number">1</span>] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ‰∫åÂàÜÂõæ </tag>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> Ë¥™ÂøÉ </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> ACËá™Âä®Êú∫ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∫åÂçÅ‰∏ÄÔºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%80%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%80%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Â•Ω‰∫ÜÔºåÂèàÊòØÁàÜÈõ∂ÁöÑ‰∏ÄÂ§©ÔºåÊÅ≠ÂñúÊàëËá™Â∑±</p><p>$\text{scoreÔºö0 + 0 + 0 = 0   rkÔºö27/27}$</p><h2 id="Problem-AÔºöÂ∞èÂçñÈÉ®"><a href="#Problem-AÔºöÂ∞èÂçñÈÉ®" class="headerlink" title="Problem AÔºöÂ∞èÂçñÈÉ®"></a>Problem AÔºöÂ∞èÂçñÈÉ®</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ysgh ÊòØ‰∏ÄÂêçÊï∞Êï∞Â§ßÂ∏à„ÄÇ</p><p>Áé∞Âú®Â∞èÂçñÈÉ®Êúâ $n$ ÁßçÂïÜÂìÅÔºåÁ¨¨ $i$ ÁßçÊúâ $a_i$ ‰∏™Ôºå‰ª∑Ê†º‰∏∫ $b_i$„ÄÇ</p><p>ysgh ÊÄªÂÖ±Âéª‰∫Ü $Q$ Â§©Â∞èÂçñÈÉ®ÔºåÁ¨¨ $i$ Â§©‰ªñÂè™‰ºöË¥≠‰π∞ÁºñÂè∑Âú® $l_i \sim r_i$ ÁöÑÂïÜÂìÅ„ÄÇ‰ªñÁöÑÂç°ÈáåÊúâ $c_i$ ÂÖÉÔºåÂõ†Ê≠§‰ªñÂè™ËÉΩË¥≠‰π∞‰ª∑ÂÄºÂíå‰∏çË∂ÖËøá $c_i$ ÂÖÉÁöÑÁâ©ÂìÅ„ÄÇ</p><p>ysgh ÊÉ≥Ë¶ÅÁü•ÈÅìÊúâÂ§öÂ∞ëÁßçË¥≠‰π∞Áâ©ÂìÅÁöÑÊñπÊ°à„ÄÇÁî±‰∫éÁ≠îÊ°àÂæàÂ§ßÔºå‰Ω†Âè™ÈúÄË¶ÅËæìÂá∫Á≠îÊ°àÂØπ $1000000007$ ÂèñÊ®°ÂêéÁöÑÁªìÊûú„ÄÇ‰∏§ÁßçÊñπÊ°àË¢´ËÆ§‰∏∫ÊòØ‰∏çÂêåÁöÑÂΩì‰∏î‰ªÖÂΩìÂ≠òÂú®‰∏ÄÁßçÁâ©ÂìÅÔºåÂÖ∂Ë¥≠‰π∞Êï∞Èáè‰∏çÂêå„ÄÇ</p><p>ÂΩìÁÑ∂ÔºåysghÁé©‰∫Ü‰∏™Â∞èËä±ÊãõÔºå‰Ω†ÈúÄË¶ÅÈÄöËøá‰∏ä‰∏Ä‰∏™ËØ¢ÈóÆÁöÑÁ≠îÊ°àÊù•Êé®ÂØº‰∏ã‰∏Ä‰∏™ËØ¢ÈóÆÁöÑÂèÇÊï∞„ÄÇ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ‰∫éÊâÄÊúâÊµãËØïÊï∞ÊçÆÔºåÊª°Ë∂≥ $1 \le n \le 10000, ~ 1 \le Q \le 50000, ~ 1 \le a_i, b_i, c_i \le 1000, 1 \le l‚Äô_i, r‚Äô_i \le n$</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>‰ª§ $C = 1000$</p><p>È¶ñÂÖàÁúãÂæóÂá∫Êù•ÂèØ‰ª•Áî®ÁîüÊàêÂáΩÊï∞ÊêûÔºåÊòæÁÑ∂Á≠îÊ°à‰∏∫ $F_i(x) = \prod\limits_{i = 1}^n \left(\sum\limits_{k = 0}^{a_i}x^{k \times b_i}\right)$</p><p>ÂØπ $F(x)$ Ê±Ç‰∏™ÂâçÁºÄÂíå $SF_n (x)$ÔºåÂπ∂ËÆæ $SF_n(x)$ ÈÄÜÂÖÉ‰∏∫ $I_n(x)$ÔºåÁ≠îÊ°àÂ∞±ÊòØ $SF_r(x)I_{l - 1}(x)$ ÁöÑÂâç $c$ È°πÁ≥ªÊï∞Âíå</p><p>ÁÑ∂ÂêéÊàëÂ∞±ÂºÄÂßã $FFT$„ÄÅÂ§öÈ°πÂºèÊ±ÇÈÄÜ‰ªÄ‰πàÁöÑ‰π±ÊêûÔºåÊó∂Èó¥ÁàÜÁÇ∏ÔºåÁÑ∂ÂêéÁàÜÈõ∂ÔºàËôΩÁÑ∂ÊàëËøûÊØèÊ¨°ËØ¢ÈóÆÁöÑ $l, r$ ÈÉΩÁÆóÈîô‰∫ÜÔºâ</p><p>Â•ΩÂêßÂÆûÈôÖ‰∏ä‰∏äÈù¢ÈÇ£Áé©ÊÑèÂÑøÁªßÁª≠ÂåñÔºåÂèØ‰ª•ÂèòÊàê $F_i(x) = \frac{1 - x^{(a_i + 1)b_i}}{1 - x^{b_i}}$</p><p>Êé•‰∏ãÊù•ÁöÑÊ≠•È™§ÊàëËßâÁùÄÂæàÊúâÊÑèÊÄù</p><p>È¶ñÂÖàÊääÂàÜÂ≠êÂàÜÊØçÂàÜÂºÄÔºåÂ∞±ÂèòÊàê $F_i(x) = (1 + x^{b_i} + x^{2b_i} + ‚Ä¶)(1 - x^{(a_i + 1)b_i})$</p><p>ÂÅáËÆæÁé∞Âú®Ë¶ÅÂ§ÑÁêÜ $SF_i(x) = SF_{i - 1}(x)F_i(x)$ÔºåÈÇ£‰πàËÆæ $SF_i(X), SF_{i - 1}(x)$ ÁöÑÁ¨¨ $k$ È°πÂàÜÂà´‰∏∫ $g_k, f_k$ÔºåÂàôÊúâ $g_k = f_k + f_{k - b_i} + f_{k - 2b_i} + ‚Ä¶$Ôºà‰πò $F(x)$ ÂâçÂçäÈÉ®ÂàÜÔºâÔºåÁÑ∂Âêé $g_k = g_k - g_{k - (a_i + 1)b_i}$Ôºà‰πò $F(x)$ ÂêéÂçäÈÉ®ÂàÜÔºâÔºåËÆ∞ÂæóÁ¨¨‰∫åÈÉ®ÂàÜË¶ÅÂÄíÊé®</p><p>Êé•‰∏ãÊù•Âè™ÈúÄÂ§ÑÁêÜÈÄÜÂÖÉÔºåÂÖàÁõ¥Êé• $O (C^2)$ Ê±ÇÂá∫ $I_{n}(x)$ÔºåÁÑ∂Âêé $I_i(x) = I_{i + 1}(x)F_{i + 1}(x)$ Â§ÑÁêÜÂç≥ÂèØ</p><p>ËøòÊúâ‰∏ÄÈÉ®Â§ÑÁêÜÔºåÂÅáËÆæÂæóÂà∞ÁöÑÊúÄÁªàÂ§öÈ°πÂºè $A(x) = SF_r(x)I_{l - 1}(x)$ÔºåÁÑ∂ÂêéË¶ÅÊ±Ç $\sum\limits_{i = 0}^cA(x)[x^i]$ÔºåËøôÊ†∑ËøòÊòØÈúÄË¶Å‰∏ÄÊ¨°Â§öÈ°πÂºè‰πòÊ≥ïÔºåÊó∂Èó¥ËøòÊòØ‰∏çË°å</p><p>Ê≠§Êó∂ÂèØ‰ª•‰ª§ $B(x) = \frac{A(x)}{1 - x} = A(x)(1 + x + x^2 + ‚Ä¶)$ÔºåÈÇ£‰πà $\sum\limits_{i = 0}^cA(x)[x^i] = B(x)[x^c]$ÔºåÂ∞±ÂèØ‰ª• $O (C)$ Â§ÑÁêÜ</p><p>ËØ¥ÂÆûËØùÊàëËßâÂæóËøô‰∫õÂ§ÑÁêÜÊòØÁúüÊå∫ÂéâÂÆ≥ÁöÑÔºà‰ΩÜÊàëËßâÂæóÂè™ÊòØÂõ†‰∏∫ÊàëÂ§™Ëèú‰∫ÜÔºâ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O \left((n + Q)C\right)$</p><h4 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e04</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXC = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> C = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">power</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = <span class="number">1l</span>l * cnt * x % MOD;</span><br><span class="line">x = <span class="number">1l</span>l * x * x % MOD, p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, Q;</span><br><span class="line"><span class="keyword">int</span> a[MAXN], b[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span> <span class="params">(<span class="keyword">int</span>* A, <span class="keyword">int</span>* B, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= C; i ++) A[i] = (B[i] + (i &gt;= b[p] ? A[i - b[p]] : <span class="number">0</span>)) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = C; i &gt;= (a[p] + <span class="number">1</span>) * b[p]; i --)</span><br><span class="line">A[i] = (A[i] - A[i - (a[p] + <span class="number">1</span>) * b[p]] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span>* A, <span class="keyword">int</span>* inv)</span> </span>&#123;</span><br><span class="line">inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= C; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j ++)</span><br><span class="line">inv[i] = (inv[i] - <span class="number">1l</span>l * inv[j] * A[i - j] % MOD + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> sum[MAXN][MAXC]= &#123;<span class="number">0</span>&#125;, inv[MAXN][MAXC]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// freopen ("A.in", "r", stdin);</span></span><br><span class="line"><span class="comment">// freopen ("A.out", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">N = getnum (), Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = getnum (), b[i] = getnum ();</span><br><span class="line">sum[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, inv[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) mul (sum[i], sum[i - <span class="number">1</span>], i);</span><br><span class="line">inverse (sum[N], inv[N]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --) mul (inv[i], inv[i + <span class="number">1</span>], i + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; j ++)</span><br><span class="line">inv[i][j] = (inv[i][j] + inv[i][j - <span class="number">1</span>]) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= Q; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum (), V = getnum ();</span><br><span class="line">l = (l + ans) % N + <span class="number">1</span>, r = (r + ans) % N + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (l &gt; r) swap (l, r);</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= V; i ++) ans = (ans + <span class="number">1l</span>l * sum[r][i] * inv[l - <span class="number">1</span>][V - i] % MOD) % MOD;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3</span></span><br><span class="line"><span class="comment">1 1</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 3 1</span></span><br><span class="line"><span class="comment">1 3 2</span></span><br><span class="line"><span class="comment">1 3 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöÂçöÂºà"><a href="#Problem-BÔºöÂçöÂºà" class="headerlink" title="Problem BÔºöÂçöÂºà"></a>Problem BÔºöÂçöÂºà</h2><h3 id="È¢òÁõÆÊèèËø∞-1"><a href="#È¢òÁõÆÊèèËø∞-1" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>ysgh Êúâ‰∏ÄÊ£µ $n$ ‰∏™ËäÇÁÇπÁöÑÊ†ëÔºåÊ†ë‰∏äÂú® $1$ Êúâ‰∏ÄÈ¢óÊ£ãÂ≠ê„ÄÇ</p><p>ysgh Âíå ysgs Âà©Áî®Ëøô‰∏™Ê£ãÂ≠êÂºÄÂßã van Ê∏∏Êàè„ÄÇÂÖ∑‰ΩìÁöÑÔºåysgh Âíå ysgs ËΩÆÊµÅÁßªÂä®Ëøô‰∏™Ê£ãÂ≠êÔºåysgh ÂÖàÊâã„ÄÇÊØèÊ¨°ÁßªÂä®Êó∂ÔºåÈúÄË¶ÅÊª°Ë∂≥Êú¨Ê¨°ÁßªÂä®ÁöÑÊ†ë‰∏äË∑ùÁ¶ª‰∏•Ê†ºÂ§ß‰∫é‰∏ä‰∏ÄÊ¨°ÁßªÂä®ÁöÑÊ†ë‰∏äË∑ùÁ¶ªÔºàÁ¨¨‰∏ÄÊ¨°ÁßªÂä®ÈúÄË¶ÅÊª°Ë∂≥Ê†ë‰∏äË∑ùÁ¶ª‰∏ç‰∏∫ $0$ÔºâÔºåÊó†Ê≥ïÁßªÂä®ÁùÄËæì„ÄÇ‰ªñ‰ª¨Áß∞Ê≠§Ê∏∏Êàè‰∏∫ ogsc„ÄÇysgh Âíå ysgs ÈÉΩ‰ºöÂÅöÂá∫Ê∏∏ÊàèÁöÑÊúÄ‰ºòÂÜ≥Á≠ñ„ÄÇ</p><p>ysgh Âíå ysgs van ‰∫ÜÂæàÂ§öÊ∏∏ÊàèÔºåÊ∏êÊ∏êËßâÂæóÊó†ËÅä‰∫Ü„ÄÇ</p><p>Áé∞Âú®‰ªñ‰ª¨ÊâìÁÆó van ‰ª•‰∏ãÊ∏∏ÊàèÔºö</p><p>ÁªôÂÆö‰∏ÄÈ¢ó $n$ ‰∏™ËäÇÁÇπÁöÑÊ†ë„ÄÇysgs ‰ºöÈÄâÂá∫‰∏Ä‰∏™ÂåÖÂê´ËäÇÁÇπ $1$ ÁöÑËÅîÈÄöÂ≠êÊ†ëËøõË°å ogsc Ê∏∏Êàè„ÄÇÂú®‰∏§‰∫∫Âùá‰ΩúÊúÄ‰ºòÂÜ≥Á≠ñÁöÑÊÉÖÂÜµ‰∏ãÔºåÊúâÂ§öÂ∞ë‰∏™ ysgs ÂøÖËÉúÁöÑÊ∏∏Êàè„ÄÇÁî±‰∫éÁ≠îÊ°àÂæàÂ§ßÔºåÂè™ÈúÄË¶ÅÁÆóÂØπ $998244353$ ÂèñËÜúÁöÑÁªìÊûú„ÄÇ</p><p>ysgs Ëä±‰∫Ü $0.5s$ Êä•Âá∫‰∫ÜÁ≠îÊ°àÔºå‰ΩÜÊòØ ysgh ‰∏çÁü•ÈÅìÊòØ‰∏çÊòØÂØπÁöÑÔºå‰∫éÊòØ‰ªñ‰ª¨ÊâæÂà∞‰∫ÜÂú®‰∏ÄÊóÅÂêÉÁìúÁöÑ‰Ω†„ÄÇ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-1"><a href="#Êï∞ÊçÆËåÉÂõ¥-1" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n \le 2e05, ~ T \le 10$</p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><blockquote><p>ÂêéÊâãÂøÖËÉúÁöÑÊù°‰ª∂Ôºö$1$ ‰Ωç‰∫éÊ†ëÁõ¥ÂæÑÁöÑ‰∏≠ÁÇπ‰∏ä</p></blockquote><p>Ê≠§Êó∂Ëã•ÂÖàÊâãÂà∞Ëææ‰∏Ä‰∏™Ë∑ùÁ¶ª $1$ ‰∏∫ $d$ ÁöÑÁÇπ‰∏äÔºåÈÇ£‰πàÂêéÊâãÊÄªÊòØÂèØ‰ª•ÂêàÊ≥ïÂú∞Âà∞Ëææ‰∏éÂÖàÊâã‰∏çÂú®Âêå‰∏ÄÊ£µ $1$ ÁöÑÂ≠êÊ†ëÔºåÂπ∂‰∏î<strong>Ë∑ùÁ¶ª $1$ ‰πü‰∏∫ $d$</strong> ÁöÑÁÇπÔºåÈÇ£‰πàÂÖàÊâãÊúÄÁªà‰∏ÄÂÆö‰ºöË¢´Ëø´Âà∞ËææÁõ¥ÂæÑÁöÑ‰∏Ä‰∏™Á´ØÁÇπÔºå‰πãÂêéÂêéÊâãËµ∞Âà∞Âè¶‰∏Ä‰∏™Áõ¥ÂæÑÁöÑÁ´ØÁÇπÔºåÈÇ£‰πàÂÖàÊâãÂ∞±Êó†Ê≥ïÁßªÂä®‰∫Ü</p><p>ËÄåËã• $1$ ‰∏çÂú®Ê†ëÁõ¥ÂæÑÁöÑ‰∏≠ÁÇπ‰∏äÔºåÈÇ£‰πàÂÖàÊâãÂèØ‰ª•ÁßªÂä®Âà∞Ê†ëÁõ¥ÂæÑ‰∏≠ÁÇπÔºåËÄå‰ΩøÂæóÂêéÊâãÂøÖËæì</p><p>Áé∞Âú®ÈóÆÈ¢òËΩ¨Âåñ‰∏∫ÊúâÂ§öÂ∞ëÊ£µËøûÈÄöÂ≠êÊ†ëÊª°Ë∂≥ $1$ ‰Ωç‰∫éÊ†ëÁõ¥ÂæÑ‰∏≠ÁÇπ‰∏ä</p><p>ËÆæ $f_{u, j}$ Ë°®Á§∫‰ª•ÁÇπ $u$ ‰∏∫Ê†πÔºåÊúâÂ§öÂ∞ë‰∏™ËøûÈÄöÂ≠êÊ†ë $T‚Äô$ Êª°Ë∂≥ $\forall p \in T‚Äô, ~ dist (u, p) \le j$ÔºåÂÖ∂‰∏≠ $dist (u, v)$ Ë°®Á§∫ÁÇπ $u, v$ ÁöÑÊ†ë‰∏äË∑ùÁ¶ª</p><p>ÂÅáËÆæÊàë‰ª¨Ê±ÇÂá∫ÊâÄÊúâ‰ª• $1$ ‰∏∫Ê†πÁöÑËøûÈÄöÂ≠êÊ†ë‰∏™Êï∞‰∏∫ $tot$ÔºåÈÇ£‰πàÊ≠§Êó∂Âè™ÈúÄÊûö‰∏æ $1$ ÁöÑÊØè‰∏™ÂÑøÂ≠ê $u$Ôºå‰ª•Âèä $u$ ÁöÑËøûÈÄöÂ≠êÊ†ëÁ¶ª $u$ ÁöÑÊúÄÂ§ßË∑ùÁ¶ª $j$ÔºåÂº∫Âà∂‰ª§ $u$ ÁöÑËøûÈÄöÂ≠êÊ†ë‰∏∫Ê∑±Â∫¶ÊúÄÊ∑±ÁöÑÔºå‰ª•ÂÖ∂‰Ωô $1$ ÁöÑÂÑøÂ≠ê‰∏∫Ê†πÁöÑËøûÈÄöÂ≠êÊ†ëÊúÄÂ§ßÊ∑±Â∫¶ÈÉΩÂ∞è‰∫éÂÆÉÔºåÈÇ£‰πàËøôÊ†∑ÁöÑÊñπÊ°à‰∏ÄÂÆöÊòØ‰∏çÂêàÊ≥ïÁöÑÔºåÂõ†‰∏∫Áõ¥ÂæÑ‰∏≠ÁÇπ‰∏çÂèØËÉΩÊòØ $1$ÔºåÁªüËÆ°ÊñπÊ°àÊï∞</p><p>‰ª§ $S_u$ Ë°®Á§∫ $u$ ÁöÑÂÑøÂ≠êÈõÜÂêàÔºå$l_u$ Ë°®Á§∫ÁÇπ $u$ Âú®Â≠êÊ†ë‰∏≠ÂèØ‰ª•Âà∞ËææÁöÑÊúÄËøúË∑ùÁ¶ªÔºåÂÖ¨ÂºèÂåñÂú∞ÔºåÊúâ<br>$$<br>ans = tot - \sum\limits_{u \in S_1}\sum\limits_{j = 0}^{l_u} (f_{u, j} - f_{u, j - 1}) \prod\limits_{v \in S_1 \cap u \neq v} f_{v, \min(l_v, j - 1)}<br>$$<br>ÈÇ£‰πàÁé∞Âú®ÈóÆÈ¢òËΩ¨Âåñ‰∏∫Ê±ÇËß£ $f_{u, j}$</p><p>ËÄÉËôëÊö¥ÂäõÔºåÊòæÁÑ∂Êúâ<br>$$<br>\begin{aligned}<br>&amp;f_{u, 0} = 2 \\<br>&amp;f_{u, j} = 1 + \prod\limits_{v \in S_u} f_{v, j - 1}<br>\end{aligned}<br>$$<br>Â§çÊùÇÂ∫¶ÁöÑÁóáÁªìÂú®‰∫é $j$ ÁöÑÂ§ßÂ∞èÊòØÁî± $l_1$ ÂÜ≥ÂÆöÁöÑÔºå‰ΩÜÂÆûÈôÖ‰∏äÊàë‰ª¨ËßÇÂØü $f_{v, j - 1}$ ÂØπ $f_{u, j}$ ÁöÑË¥°ÁåÆÔºåÂè™ÊúâÊª°Ë∂≥ $j \le l_v$ ÁöÑÊâçÊúâÂèØËÉΩË¢´Ë¥°ÁåÆÂà∞ÔºåÂõ†‰∏∫ $\forall j \in (l_v, l_1], f_{v, j} = f_{v, l_v}$ÔºåÁúãÂà∞ËøôÂÖ¨ÂºèÂèØ‰ª•ÊÉ≥Âà∞‰ªÄ‰πàÔºüÈïøÈìæÂâñÂàÜÔºÅ</p><p>ÈúÄË¶ÅÈ¢ùÂ§ñÂ§ÑÁêÜÁöÑÊòØ $f_{v, l_v}$ ÂØπ $f_{u, j}, j \in (l_v + 1, l_u]$Ôºå‰∏çÂ¶®Áî®‰∏Ä‰∏™Êï∞ÁªÑ $g$ Êù•ÂÇ®Â≠òÂÆÉÔºåÂç≥ $g_u = f_{u, l_u}$ÔºåËÄåÊòæÁÑ∂Êàë‰ª¨Âèà‰∏çËÉΩÊûö‰∏æ $l_u$ÔºåËøô‰∏ÄÈÉ®ÂàÜÁöÑÁ≠îÊ°à‰∏ÄÂºÄÂßãÊòØÁî±ÈáçÂÑøÂ≠êÁªßÊâøËøáÊù•ÁöÑÔºå‰ΩÜÂÆÉ‰ª¨ÈÉΩ‰πò‰∏äÁõ∏ÂêåÁöÑ $g_v$ÔºåÈÇ£‰πà‰∏çÂ¶®Áî®Á±ª‰ººÊ†áËÆ∞Ê∞∏‰πÖÂåñÁöÑÊñπÊ≥ïÊù•ËÆ∞ÂΩïËøô‰∏™ $g_v$ÔºåÊ†áËÆ∞ $\forall j \in [0, l_u] f_{u, j} = f_{u, j} \times g_v$ÔºåÂæàÊòæÁÑ∂ÂØπ $j \in [0, l_v + 1]$ ËøòÈúÄË¶ÅÊää $g_v$ Èô§ÊéâÔºåÂõ†‰∏∫ÂÆÉ‰ª¨‰∏çÈúÄË¶ÅËøô‰∏™Ë¥°ÁåÆ</p><p>ÁÑ∂ËÄåËΩ¨ÁßªÂÖ¨ÂºèÈáåËøòÊúâ‰∏Ä‰∏™ $+ 1$ÔºåÈÇ£‰πàÁî® $mul_u, add_u$ ÂàÜÂà´Ë°®Á§∫Ê†áËÆ∞Ê∞∏‰πÖÂåñÁöÑ‰πòÂíåÂä†ÔºåËøòÈúÄË¶ÅËÆ∞ÂΩï‰∏Ä‰∏™ $imul_u$ Êù•ËÆ∞ÂΩïÈúÄË¶ÅÈô§ÊéâÁöÑ $g_v$ÔºåÁî® $dp_{u, j}$ Êù•Ë°®Á§∫Ê≤°Êúâ‰πò‰∏äËøáÊ†áËÆ∞ÁöÑÊï∞ÂÄºÔºåÂÆÉÂèØ‰ª•Âíå $f$ ‰∫íÁõ∏ËΩ¨Âåñ<br>$$<br>\begin{aligned}<br>&amp;f_{u, j} = dp_{u, j} \times mul_u + add_u \\<br>&amp;dp_{u, j} = \frac{f_{u, j} - add_u}{mul_u}<br>\end{aligned}<br>$$<br>‰∏çÂ¶®Áî®ÂáΩÊï∞Êù•Ë°®Á§∫Ëøô‰πà‰∏Ä‰∏™ÂèòÊç¢Ôºå$f(u, j) = dp_{u, j} \times mul_u + add_u$ ‰ª•Âèä $df (u, r) = \frac{r - add_u}{mul_u}$ÔºåÈÇ£‰πà $dp_{u, j}$ Âú®ËΩ¨ÁßªÁöÑÊó∂ÂÄôÂ∞±ÈúÄË¶Å‰∏ÄÁõ¥‰øùÊåÅÊ≤°Á¥ØËÆ°ËøáÊ†áËÆ∞ÁöÑÊï∞ÂÄºÔºåÂç≥ $dp_{u, j} = df (u, f(u, j) \times f(v, j - 1))$</p><p>‰ΩÜÊòØÊ≥®ÊÑèÔºåÂèØËÉΩ‰ºöÂ≠òÂú®ÊüêÊó∂Âàª $f (v, l_u) \equiv 0 \pmod{998244353}$Ôºå‰πüÂ∞±ÊòØ $\forall j \in (l_v, l_u], f (u, j) = 0$ÔºåÁî® $lim_u$ Êù•ËÆ∞ÂΩïËøôÁßç $l_v + 1$Ôºå$z_u$ Êù•ËÆ∞ÂΩïÂú®ÂΩìÂâçÊÉÖÂÜµ‰∏ãÔºå$0$ ÊâÄÂØπÂ∫îÁöÑÊú™Á¥ØËÆ°Ê†áËÆ∞ËøáÁöÑÊï∞ÂÄºÔºåÂç≥ $df (u, 0)$ÔºåÈÇ£‰πàÂØπ $j &lt; lim_u$ ÂàôÁÖßÂ∏∏ÔºåÂØπ $j \ge lim_u$ ÂàôÊúâ $f(u, j) = z_u \times mul_u + add_u$ÔºåÂÖ∂ÂÆûÂ∞±ÊòØÁõ¥Êé•ËµãÂÄº $z_u \rightarrow dp_{u, j}$</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (T \times n)$</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">power</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = <span class="number">1l</span>l * cnt * x % MOD;</span><br><span class="line">x = <span class="number">1l</span>l * x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inv2 = power (<span class="number">2</span>, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> len[MAXN]= &#123;<span class="number">0</span>&#125;, son[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">len[root] = <span class="number">0</span>, son[root] = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">DFS (v, root);</span><br><span class="line"><span class="keyword">if</span> (son[root] == - <span class="number">1</span> || len[v] &gt; len[son[root]])</span><br><span class="line">son[root] = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (~ son[root]) len[root] = len[son[root]] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tmp[MAXN &lt;&lt; <span class="number">1</span>], *dp[MAXN], *id;</span><br><span class="line"><span class="keyword">int</span> mul[MAXN], imul[MAXN], add[MAXN], g[MAXN], ig[MAXN];</span><br><span class="line"><span class="keyword">int</span> lim[MAXN], zero[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">k = min (k, len[n]);</span><br><span class="line"><span class="keyword">if</span> (lim[n] &lt;= k) <span class="keyword">return</span> (<span class="number">1l</span>l * zero[n] * mul[n] % MOD + add[n]) % MOD;</span><br><span class="line"><span class="keyword">return</span> (<span class="number">1l</span>l * dp[n][k] * mul[n] % MOD + add[n]) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">df</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> r)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1l</span>l * (<span class="number">1l</span>l * r - add[n] + MOD) % MOD * imul[n] % MOD; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DP</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (son[u] == - <span class="number">1</span>) &#123;</span><br><span class="line">mul[u] = imul[u] = <span class="number">1</span>;</span><br><span class="line">add[u] = g[u] = <span class="number">2</span>;</span><br><span class="line">lim[u] = N + <span class="number">1</span>, ig[u] = inv2;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">dp[son[u]] = dp[u] + <span class="number">1</span>;</span><br><span class="line">DP (son[u], u);</span><br><span class="line">mul[u] = mul[son[u]], imul[u] = imul[son[u]], add[u] = add[son[u]];</span><br><span class="line">lim[u] = lim[son[u]], zero[u] = zero[son[u]];</span><br><span class="line">dp[u][<span class="number">0</span>] = df (u, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == fa || v == son[u]) <span class="keyword">continue</span>;</span><br><span class="line">dp[v] = id, id += len[v] + <span class="number">1</span>, DP (v, u);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= len[v] + <span class="number">1</span>; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (lim[u] == j) dp[u][j] = zero[u], lim[u] ++;</span><br><span class="line">dp[u][j] = df (u, <span class="number">1l</span>l * f (u, j) * f (v, j - <span class="number">1</span>) % MOD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (! g[v]) &#123; lim[u] = len[v] + <span class="number">2</span>, zero[u] = df (u, <span class="number">0</span>); <span class="keyword">continue</span>; &#125;</span><br><span class="line">mul[u] = <span class="number">1l</span>l * mul[u] * g[v] % MOD;</span><br><span class="line">imul[u] = <span class="number">1l</span>l * imul[u] * ig[v] % MOD;</span><br><span class="line">add[u] = <span class="number">1l</span>l * add[u] * g[v] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= len[v] + <span class="number">1</span>; j ++)</span><br><span class="line">dp[u][j] = df (u, <span class="number">1l</span>l * f (u, j) * ig[v] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">add[u] = (<span class="number">1l</span>l * add[u] + <span class="number">1</span>) % MOD;</span><br><span class="line"><span class="keyword">if</span> (son[fa] != u) &#123; g[u] = f (u, len[u]); ig[u] = power (g[u], MOD - <span class="number">2</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> gr[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stati</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">gr[u] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">stati (v, u);</span><br><span class="line">gr[u] = <span class="number">1l</span>l * gr[u] * (gr[v] + <span class="number">1</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> subpro[MAXN], subflo[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head)), size = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span> (tmp, <span class="number">0</span>, <span class="keyword">sizeof</span> (tmp));</span><br><span class="line">id = tmp;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">mul[i] = imul[i] = add[i] = lim[i] = zero[i] = g[i] = ig[i] = <span class="number">0</span>;</span><br><span class="line">subpro[i] = subflo[i] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>); dp[<span class="number">1</span>] = id, id += len[<span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[<span class="number">1</span>]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">dp[v] = id, id += len[v] + <span class="number">1</span>; DP (v, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= len[v]; j ++)</span><br><span class="line">subpro[j] = <span class="number">1l</span>l * subpro[j] * f (v, j) % MOD;</span><br><span class="line"><span class="keyword">if</span> (len[v] + <span class="number">1</span> &lt;= len[<span class="number">1</span>]) subflo[len[v] + <span class="number">1</span>] = <span class="number">1l</span>l * subflo[len[v] + <span class="number">1</span>] * f (v, len[v]) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len[<span class="number">1</span>]; i ++) subflo[i] = <span class="number">1l</span>l * subflo[i - <span class="number">1</span>] * subflo[i] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= len[<span class="number">1</span>]; i ++) subpro[i] = <span class="number">1l</span>l * subpro[i] * subflo[i] % MOD;</span><br><span class="line">stati (<span class="number">1</span>, <span class="number">0</span>); <span class="keyword">int</span> ans = gr[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[<span class="number">1</span>]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= len[v]; j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> del = (<span class="number">1l</span>l * f (v, j) - (j &gt; <span class="number">0</span> ? f (v, j - <span class="number">1</span>) : <span class="number">1</span>) + MOD) % MOD;</span><br><span class="line"><span class="keyword">if</span> (j &gt; <span class="number">0</span>) del = <span class="number">1l</span>l * del * subpro[j - <span class="number">1</span>] % MOD * power (f (v, j - <span class="number">1</span>), MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">ans = (<span class="number">1l</span>l * ans - del + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line">N = getnum (); init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">Insert (u, v), Insert (v, u);</span><br><span class="line">&#125;</span><br><span class="line">solve ();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem-CÔºöÁΩëÁªúÊµÅ"><a href="#Problem-CÔºöÁΩëÁªúÊµÅ" class="headerlink" title="Problem CÔºöÁΩëÁªúÊµÅ"></a>Problem CÔºöÁΩëÁªúÊµÅ</h3>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁîüÊàêÂáΩÊï∞ </tag>
            
            <tag> Ê†ë‰∏äDP </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> ÂçöÂºàËÆ∫ </tag>
            
            <tag> ÈïøÈìæÂâñÂàÜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∏âÂçÅÔºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Êôö‰∫ÜÂá†Â§©ÂÜôÔºåÊö¥ÂäõÂú∫</p><p>$\text{scoreÔºö40 + 40 + 45 = 125   rkÔºö17/30}$</p><h2 id="Problem-AÔºöTree"><a href="#Problem-AÔºöTree" class="headerlink" title="Problem AÔºöTree"></a>Problem AÔºöTree</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/22/At2B5jTuCRhF9Yv.png" alt=""></p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n \le 10^8, ~ 1000 \le k \le 10^8$</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂæàÂÆπÊòìÂèëÁé∞ÔºåÊª°Ë∂≥Êù°‰ª∂Á≠â‰ª∑‰∫éË¶ÅÊ±ÇÊ†ë‰∏≠Ê≤°Êúâ‰ªªÊÑè‰∏ÄÊù°‰ªéÊ†πÂá∫ÂèëÁöÑË∑ØÂæÑÁªèËøáË∂ÖËøá $k - 1$ ‰∏™Â∑¶ÂÑøÂ≠ê</p><p>ÁÑ∂ÂêéÂ∞±ÊòØ‰∏Ä‰∏™ÂæàÂ¶ôÁöÑËΩ¨Êç¢ÔºåÂ∞ÜÊ†ëÊåâÂ¶Ç‰∏ãËßÑÂàôÂèò‰∏∫Êã¨Âè∑Â∫èÂàóÔºö</p><p>Â≠êÊ†ë $u$ Êã¨Âè∑Â∫è = ‚Äò(‚Äò + ‚Äò$u$ Â∑¶Â≠êÊ†ëÊã¨Âè∑Â∫è‚Äô + ‚Äò)‚Äô + ‚Äò$u$ Âè≥Â≠êÊ†ëÊã¨Âè∑Â∫è</p><p>Áªô‰∏™È¢òËß£ÁöÑÂõæ‰æã</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/22/UzbMDAGx3FZ7nJX.jpg" alt=""></p><p>ÂÆûÈôÖ‰∏äÂèØ‰ª•‰∏çÁî®ËÄÉËôëÂè∂ËäÇÁÇπÔºåÈÇ£‰πàÁé∞Âú®Â∞Ü $n$ Âèò‰∏∫ $n - 1$Ôºå$k$ Âèò‰∏∫ $k - 2$</p><p>ÈÇ£‰πàÁé∞Âú®ÁöÑ‰ªªÂä°Â∞±Âèò‰∏∫Âú®ÂùêÊ†áÁ≥ª‰∏≠Â∞ÜÂ∑¶Êã¨Âè∑Áúã‰ΩúÂæÄÂè≥‰∏äËßíËµ∞ÔºåÂè≥Êã¨Âè∑Áúã‰ΩúÂæÄÂè≥‰∏ãËßíËµ∞Ôºå‰ªé $(0, 0)$ ÊúÄÁªàËµ∞Âà∞ $(2n, 0)$ ÁöÑÊñπÊ°àÊï∞ÔºåÂπ∂ÈúÄË¶ÅÊª°Ë∂≥ËøáÁ®ã‰∏≠Á∫µÂùêÊ†áÂßãÁªàÂú® $[0, k]$ ‰∏≠ÁöÑÊñπÊ°àÊï∞ÔºàÊ≥®ÊÑèÊ≠§Êó∂ $n, k$ Â∑≤ÂèòÂåñÔºâ</p><p>ËøôÂ∞±ÊòØÁ±ª‰ººÂç°ÁâπÂÖ∞Êï∞Ôºå‰ΩÜÊòØÊúâ‰∏§Êù°ÈôêÂà∂ÔºåÂç≥‰∏çËÉΩÁ¢∞Âà∞ $y = - 1$ ‰πü‰∏çËÉΩÁ¢∞Âà∞ $y = k + 1$</p><p>Âèà‰ªé $(x1, y1)$ Ëµ∞Âà∞ $(x_2, y_2)$ Êó†ÈôêÂà∂ÁöÑÊñπÊ°àÊï∞‰∏∫ $f(x_1, y_1, x_2, y_2) = \dbinom{|x_1 - x_2|}{\frac{|x_1 - x_2| + |y_1 - y_2|}{2}}$</p><p>ËÄÉËôëÂÆπÊñ•ÔºåÈ¶ñÂÖàÊúâÊÄªÊñπÊ°àÊï∞ $f(0, 0, 2n, 0)$ÔºåÂÜçÂèñÂØπÁß∞‰∏ÄÊ¨°„ÄÅ‰∏§Ê¨°„ÄÅ‰∏âÊ¨°„ÄÇ„ÄÇÊ±ÇÊñπÊ°àÊï∞</p><p>ÂØπÁß∞‰∏ÄÊ¨°Âç≥ÂØπÁß∞Âà∞ $(0, -2), (0, 2k + 2)$ÔºåÂáèÂéªÂÖ∂Âà∞ $(2n, 0)$ ÁöÑÊñπÊ°àÊï∞</p><p>ÂØπÁß∞‰∏§Ê¨°ÂàÜÁ±ªËÆ®ËÆ∫ÔºåÂÖàÁªèËøá $y = - 1$ ÂÜçÁªèËøá $y = k + 1$ ÊàñÂÖàÁªèËøá $y = k + 1$ ÂÜçÁªèËøá $y = - 1$ÔºåÂØπÁ¨¨‰∏ÄÁßçÊÉÖÂÜµÔºåÂØπÁß∞‰∏§Ê¨°ÂêéÂà∞ $(0, 2k + 4)$ÔºåÂØπÁ¨¨‰∫åÁßçÔºåÂà∞ $(0, - 2k - 4)$ÔºåÂÜçÂä†‰∏äÂÆÉ‰ª¨Âà∞ $(2n, 0)$ ÁöÑÊñπÊ°àÊï∞</p><p>‰ΩÜÊòØ‰ºöÂèëÁé∞ËøôÊ†∑‰ºöÂ§öÂä†‰∏äÂØπÁß∞‰∏âÊ¨°ÁöÑÁ≠îÊ°àÔºåÊâÄ‰ª•ËøòÈúÄÂáèÂéªÂØπÁß∞‰∏âÊ¨°‰∏≠ËÆ®ËÆ∫ÁöÑÁ≠îÊ°à</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/22/7TaRXmWoSwKB61p.png" alt=""></p><p>‰∏æ‰∏™‰æãÂ≠êÔºåËÄÉËôë‰∏äÂõæËøôÊ†∑‰∏Ä‰∏™ËøêÂä®ËΩ®ËøπÔºåÈÇ£‰πàÂÆÉ‰∏ÄÂÖ±‰ºöË¢´Ëøô‰∫õÊâÄËÆ°ÁÆóÂà∞ÔºöÂÖà‰∏ãÂÜç‰∏ä„ÄÅÂÖà‰∏äÂÜç‰∏ã„ÄÅ‰∏ã‰∏ä‰∏ã„ÄÅ‰∏ä‰∏ã‰∏ä„ÄÅ‰∏ã‰∏ä‰∏ã‰∏ä</p><p>ÂÆûÈôÖ‰∏äÊúâÂ∫îËØ•‰ΩúË¥°ÁåÆÁöÑÂè™ÊúâÊúÄÂêé‰∏Ä‰∏™‚Äú‰∏ã‰∏ä‰∏ã‰∏ä‚ÄùËÄåÂ∑≤ÔºåÊâÄ‰ª•ÊòØË¶ÅÂÆπÊñ•ÁöÑ</p><p>ÂèØ‰ª•Áü•ÈÅìÊ≤°‰∏§Ê¨°ÂØπÁß∞Â∞±ÂèØ‰ª•‰ΩøÁ∫µÂùêÊ†áÁªùÂØπÂÄºÂ¢ûÂä† $2k + 4$ÔºåÂΩìÁ∫µÂùêÊ†áÁªùÂØπÂÄºË∂ÖËøá $2n$ Êó∂ÔºåÊòæÁÑ∂Ë¥°ÁåÆ‰∏∫ $0$ÔºåÊ≠§Êó∂Â∞±ÂèØ‰ª•ÂÅúÊ≠¢ÔºåÈÇ£‰πàËÆ°ÁÆóÊÄªÊ¨°Êï∞Â§ßÁ∫¶‰∏∫ $\frac{4n}{k}$</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (\frac{n}k \log_p n)$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 10007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = MOD + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"></span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;, invfact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">lucas</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == m) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MOD &amp;&amp; m &lt;= MOD) <span class="keyword">return</span> C (n, m);</span><br><span class="line"><span class="keyword">return</span> C (n % MOD, m % MOD) * lucas (n / MOD, m / MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sym</span> <span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> p ? - y - <span class="number">2</span> : - y + <span class="number">2</span> * k + <span class="number">2</span>; &#125; <span class="comment">// y = - 1 &amp; y = k + 1</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">path</span> <span class="params">(<span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> lucas (<span class="number">2</span> * n, n + y / <span class="number">2</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K;</span><br><span class="line">n = N - <span class="number">1</span>, k = K - <span class="number">2</span>;</span><br><span class="line">fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MOD; i ++) fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[MOD - <span class="number">1</span>] = power (fact[MOD - <span class="number">1</span>], MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = MOD - <span class="number">2</span>; i &gt;= <span class="number">1</span>; i --) invfact[i] = invfact[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line"><span class="keyword">int</span> up = <span class="number">2</span> * k + <span class="number">2</span>, down = - <span class="number">2</span>, p = <span class="number">1</span>;</span><br><span class="line">LL ans = lucas (<span class="number">2</span> * n, n);</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">abs</span> (up) &gt; <span class="number">2</span> * n &amp;&amp; <span class="built_in">abs</span> (down) &gt; <span class="number">2</span> * n) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">int</span> t = p == <span class="number">1</span> ? - <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">ans = (ans + t * path (up) % MOD + MOD) % MOD;</span><br><span class="line">ans = (ans + t * path (down) % MOD + MOD) % MOD;</span><br><span class="line">up = sym (up, p), down = sym (down, p ^ <span class="number">1</span>);</span><br><span class="line">p ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöÊñáÊú¨ÁºñËæëÂô®"><a href="#Problem-BÔºöÊñáÊú¨ÁºñËæëÂô®" class="headerlink" title="Problem BÔºöÊñáÊú¨ÁºñËæëÂô®"></a>Problem BÔºöÊñáÊú¨ÁºñËæëÂô®</h2><h2 id="Problem-CÔºöÁ¨¨kÊ∑±-kth"><a href="#Problem-CÔºöÁ¨¨kÊ∑±-kth" class="headerlink" title="Problem CÔºöÁ¨¨kÊ∑±(kth)"></a>Problem CÔºöÁ¨¨kÊ∑±(kth)</h2><h3 id="È¢òÁõÆÊèèËø∞-1"><a href="#È¢òÁõÆÊèèËø∞-1" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>‰∏Ä‰∏™ $n$ ‰∏™ÁÇπÁöÑÊúâÊ†πÊ†ëÔºå$1$ ‰∏∫Ê†πÔºåÂ∏¶ËæπÊùÉÔºåÊúâ $m$ Ê¨°Êìç‰Ωú</p><ul><li>Êìç‰Ωú $1$ÔºöÊ±Ç $x$ ÁöÑÂ≠êÊ†ë‰∏≠Á¨¨ $k$ Â∞èÁöÑÊ∑±Â∫¶ÁöÑÂÄºÔºåÂ¶ÇÊûúÂ≠êÊ†ë‰∏≠Ê≤°Êúâ $k$ ‰∏™ÁÇπÂàôËæìÂá∫ $- 1$</li><li>Êìç‰Ωú $2$ÔºöÂ∞Ü $x$ ‰∏é $x$ Áà∂‰∫≤ÁöÑËæπÊùÉÂä†‰∏ä $k$</li></ul><p>‰øùËØÅÊØèÊ¨°Êìç‰Ωú $2$ ÁöÑ $k$ ‰ª•ÂèäÂéüÊ†ëÁöÑËæπÊùÉÂ∞è‰∫éÁ≠â‰∫é‰∏Ä‰∏™Êï∞ $len$<br>Â¶ÇÊûúÊìç‰Ωú $2$ ‰∏≠ $x$ ‰∏∫ $1$ÔºåÈÇ£‰πàËßÜ‰∏∫Â∞Ü $x$ ÁöÑÂü∫Á°ÄÊ∑±Â∫¶Âä†‰∏ä‰∫Ü $k$</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-1"><a href="#Êï∞ÊçÆËåÉÂõ¥-1" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n, m \le 10^5, ~ 1 \le len \le 10, ~ k \in N^+$</p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂéüÈ¢ò <a href="https://www.luogu.com.cn/problem/P3712" target="_blank" rel="noopener">Â∞ëÂ•≥‰∏éÊàòËΩ¶</a></p><p>$\text{lxl}$ ÂàÜÂùóÈ¢ò„ÄÇ„ÄÇ</p><p>È¶ñÂÖàÊêûÂá∫ÊØè‰∏™ÁÇπÁöÑ $DFS$ Â∫èÔºåÈÇ£‰πàÊØèÊ¨°‰øÆÊîπÂ∞±ÊòØÂå∫Èó¥Âä†</p><p>Áé∞Âú®ËÄÉËôëÂ¶Ç‰ΩïÂàÜÂùóÔºåÊçÆËØ¥ËøôÁßçÂàÜÂùóÊñπÂºèÂèØËÉΩÂè´ÂèåÂÖ≥ÈîÆÂ≠óÂàÜÂùóÔºü</p><p>ÂØπÊØè‰∏ÄÂùóÔºå‰øùËØÅ</p><ul><li>ÊØè‰∏ÄÂùóÊúÄÂ§ßÔºàÂ∞èÔºâÂÄº $max(min)$ÔºåÂùóÂ∑¶Âè≥Á´ØÁÇπ $l, r$ÔºåÊª°Ë∂≥Ôºå$max - min \le 2\sqrt{10m}$ ‰∏î $r - l + 1 \le \sqrt n$</li></ul><p>ÈÇ£‰πàËøôÊ†∑Â∞±ÂèØ‰ª•‰øùËØÅÂùóÁöÑÂàÜÂâ≤ÁÇπ‰∏™Êï∞‰∏çË∂ÖËøá $\frac{10m}{\sqrt{10m}} + \frac{n}{\sqrt n}$</p><p>Êü•ËØ¢‰∫åÂàÜÔºåÁÑ∂ÂêéÂú®ÊØè‰∏™ÂùóÂÜÖÂ≠òÂùóÊØè‰∏™ÂÖÉÁ¥†ÊØîÂùó‰∏≠ÊúÄÂ∞èÂÄºÂ§ßÂ§öÂ∞ëÔºåÂπ∂ËÆ∞ÂΩïÂÆÉ‰ª¨ÁöÑ‰∏™Êï∞ÔºåÈÇ£‰πàÊØèÊ¨° $check$ ÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª• $O (1)$ Êü•ËØ¢ÂùóÂÜÖÊØî $mid$ Â∞èÁöÑÁÇπÁöÑ‰∏™Êï∞</p><p>ÁÑ∂ÂêéÊØè‰øÆÊîπ $1000$ ÈáçÊñ∞ÂàÜÂùóÔºå‰øÆÊîπ $1000$ Ê¨°ÂêéÂùóÂÜÖÊúÄÂ§ßÊúÄÂ∞èÂÄºÂ∑Æ‰∏ç‰ºöÊñ∞Â¢ûË∂ÖËøá $20000$ÔºåËøô‰πüÊòØÊï∞ÁªÑËÉΩÂ≠ò‰∏ãÁöÑÊûÅÈôê</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXB = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXV = <span class="number">20000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> LL LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> V = <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, len;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN]= &#123;<span class="number">0</span>&#125;, ord = <span class="number">0</span>;</span><br><span class="line">LL d[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, LL dist)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line">dfn[root] = ++ ord; d[ord] = dist;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line">DFS (v, dist + w);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> lim;</span><br><span class="line"><span class="keyword">int</span> bel[MAXN]= &#123;<span class="number">0</span>&#125;, bl[MAXB]= &#123;<span class="number">0</span>&#125;, br[MAXB]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line">LL mini[MAXB]= &#123;<span class="number">0</span>&#125;, maxi[MAXB]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> subsum[MAXB][MAXV]= &#123;<span class="number">0</span>&#125;, lazy[MAXB]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span> <span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">mini[i] = LINF, maxi[i] = - LINF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = bl[i]; j &lt;= br[i]; j ++) &#123;</span><br><span class="line">d[j] += lazy[i];</span><br><span class="line">mini[i] = min (mini[i], d[j]);</span><br><span class="line">maxi[i] = max (maxi[i], d[j]);</span><br><span class="line">&#125;</span><br><span class="line">lazy[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= maxi[i] - mini[i]; j ++) subsum[i][j] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = bl[i]; j &lt;= br[i]; j ++) subsum[i][d[j] - mini[i]] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= maxi[i] - mini[i]; j ++) subsum[i][j] += subsum[i][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! lazy[p]) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bl[p]; i &lt;= br[p]; i ++) d[i] += lazy[p];</span><br><span class="line">lazy[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) pushdown (i);</span><br><span class="line">LL mi = LINF, ma = - LINF; m = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">mi = min (mi, d[i]), ma = max (ma, d[i]);</span><br><span class="line"><span class="keyword">if</span> (ma - mi &gt; V || i - br[m - <span class="number">1</span>] &gt; lim) &#123;</span><br><span class="line">bl[m] = br[m - <span class="number">1</span>] + <span class="number">1</span>, br[m] = i - <span class="number">1</span>;</span><br><span class="line">mi = ma = d[i]; m ++;</span><br><span class="line">&#125;</span><br><span class="line">bel[i] = m;</span><br><span class="line">&#125;</span><br><span class="line">bl[m] = br[m - <span class="number">1</span>] + <span class="number">1</span>, br[m] = N;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) maintain (i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (bel[l] + <span class="number">1</span> &gt;= bel[r]) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) d[i] += x;</span><br><span class="line">maintain (bel[l]); maintain (bel[r]);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= br[bel[l]]; i ++) d[i] += x;</span><br><span class="line">maintain (bel[l]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bel[l] + <span class="number">1</span>; i &lt;= bel[r] - <span class="number">1</span>; i ++) &#123; lazy[i] += x; mini[i] += x, maxi[i] += x; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bl[bel[r]]; i &lt;= r; i ++) d[i] += x;</span><br><span class="line">maintain (bel[r]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, LL mid)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (bel[l] + <span class="number">1</span> &gt;= bel[r]) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) cnt += d[i] &lt;= mid;</span><br><span class="line"><span class="keyword">return</span> cnt &gt;= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= br[bel[l]]; i ++) cnt += d[i] &lt;= mid;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bel[l] + <span class="number">1</span>; i &lt;= bel[r] - <span class="number">1</span>; i ++)</span><br><span class="line"><span class="keyword">if</span> (mid - mini[i] &gt;= <span class="number">0</span>)</span><br><span class="line">cnt += subsum[i][min (maxi[i] - mini[i], mid - mini[i])];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bl[bel[r]]; i &lt;= r; i ++) cnt += d[i] &lt;= mid;</span><br><span class="line"><span class="keyword">return</span> cnt &gt;= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">pushdown (bel[l]); pushdown (bel[r]);</span><br><span class="line">LL left = LINF, right = - LINF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bel[l]; i &lt;= bel[r]; i ++) &#123;</span><br><span class="line">left = min (left, mini[i]);</span><br><span class="line">right = max (right, maxi[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> left;</span><br><span class="line">LL ans = left;</span><br><span class="line"><span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">LL mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (check (l, r, k, mid)) &#123; ans = mid; right = mid - <span class="number">1</span>; &#125;</span><br><span class="line"><span class="keyword">else</span> left = mid + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), len = getnum ();</span><br><span class="line">lim = <span class="built_in">sqrt</span> (N); </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> fa = getnum (), w = getnum ();</span><br><span class="line">Insert (fa, i, w);</span><br><span class="line">&#125;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">int</span> modi = <span class="number">0</span>;</span><br><span class="line">build ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= M; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> opt = getnum (), x = getnum (), k = getnum ();</span><br><span class="line"><span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (subsize[x] &lt; k) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">continue</span>; &#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, query (dfn[x], dfn[x] + subsize[x] - <span class="number">1</span>, k));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">modi ++;</span><br><span class="line"><span class="keyword">if</span> (! (modi % <span class="number">1000</span>)) build ();</span><br><span class="line">modify (dfn[x], dfn[x] + subsize[x] - <span class="number">1</span>, k);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ÊÄùÁª¥ </tag>
            
            <tag> ÁªÑÂêàÊï∞Â≠¶ </tag>
            
            <tag> ‰∫åÂàÜÁ≠îÊ°à </tag>
            
            <tag> ÂàÜÂùó </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∏âÂçÅ‰∫åÔºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%8C%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%8C%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>‰∏≠‰∏ã</p><p>$\text{scoreÔºö24 + 40 + 0 = 64   rkÔºö23/34}$</p><h2 id="Problem-AÔºöMythological-V"><a href="#Problem-AÔºöMythological-V" class="headerlink" title="Problem AÔºöMythological V"></a>Problem AÔºöMythological V</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>Â∞èSÊâìÁÆóÈÄÅÁªôÂ∞èM‰∏ÄÊ£µ $n$ ‰∏™ÁÇπÁöÑÂú£ËØûÊ†ëÔºåÁÇπ‰ªé $1$ Âà∞ $n$ Ê†áÂè∑Ôºå‰ªñÊâìÁÆóÁªôÊ†ë‰∏äÊåÇ‰∏ä $m$ ‰∏™Á§ºÁâ©ÔºåÊØè‰∏™Á§ºÁâ©Âú®Ê†ë‰∏äÁöÑÊüê‰∏™ÁÇπ‰∏äÔºåÁ§ºÁâ©ÂèØ‰ª•ÈáçÂè†„ÄÇ</p><p> Â∞èMÁªô‰∫ÜÂ∞èS $q$ ‰∏™ÈôêÂà∂ÔºåÂÖ∂‰∏≠Á¨¨ $i$ ‰∏™ÂΩ¢Â¶Ç‚ÄúÁ¨¨ $a_i$ ‰∏™Á§ºÁâ©ÂíåÁ¨¨ $b_i$ ‰∏™Á§ºÁâ©Âú®Ê†ë‰∏äÁöÑÊúÄÁü≠Ë∑ØÂæÑÁªèËøá‰∫ÜÁÇπ $c_i$‚Äù„ÄÇ</p><p> Â∞èSÊÉ≥Ë¶ÅÊûÑÈÄ†Âá∫Á¨¶ÂêàÂ∞èMÊù°‰ª∂ÁöÑÊåÇÁ§ºÁâ©ÊñπÊ°à„ÄÇÂèØÊÄúÁöÑÂ∞èSÂΩìÁÑ∂‰∏ç‰ºöÂï¶ÔºåÊâÄ‰ª•‰ªñÂêë‰Ω†Ê±ÇÂä©„ÄÇ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$n, m \le 250, ~ q \le 5 \times 10^4$</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>Â•Ω‰πÖÊ≤°ÂÜôËøá $2-SAT$ ‰∫Ü</p><p>ËôΩÁÑ∂ÊàëÁöÑÊö¥ÂäõËôΩÁÑ∂ $\text{WA}$ ‰∫Ü‰ΩÜÁ´üÁÑ∂Ê≤°Êúâ $\text{T}$ÔºüËØ¥‰∏çÂÆöÊîπÂØπ‰∫ÜËÉΩËøáÂë¢</p><p>ËÄÉËôë‰∏§‰∏™Á§ºÁâ© $a, b$ ÊîæÁΩÆ‰ΩçÁΩÆÁªèËøá $c$ ‰ª£Ë°®ÁùÄ‰ªÄ‰πàÔºåËØ¥Êòé $a, b$ ÊîæÁΩÆÁöÑ‰ΩçÁΩÆÂú®‰ª• $c$ ‰∏∫Ê†πÁöÑÊ†ë‰∏ä‰Ωç‰∫é‰∏çÂêåÁöÑ $c$ ÂÑøÂ≠êÁöÑÂ≠êÊ†ë‰∏ä</p><p>ÈÇ£‰πàÁé∞Âú®‰ª• $1$ ‰∏∫Ê†πÔºåËÆæ $g_{i, j, 0}$ Ë°®Á§∫Á¨¨ $j$ ‰∏™Á§ºÁâ©‰∏çÂú® $i$ ÁÇπÁöÑÂ≠êÊ†ë‰∏äÔºåËÄå $g_{i, j, 1}$ Ë°®Á§∫Âú®</p><p>ÂØπÊØè‰∏™È¢òÁõÆÊâÄÁªôÈôêÂà∂ÔºåËøûËæπÊúâ $g_{c, a, 0} \rightarrow g_{c, b, 1}$ÔºàË°®Á§∫ $a$ Âú® $c$ Á•ñÂÖà‰∏çÂåÖÊã¨ $c$ ÁöÑÂ≠êÊ†ë‰∏≠ÔºåÈÇ£‰πà $b$ ‰∏ÄÂÆöÂú® $c$ Â≠êÊ†ë‰∏≠Ôºâ„ÄÅ$g_{i, a, 1} \rightarrow g_{i, b, 0}$„ÄÅ$g_{i, b, 1} \rightarrow g_{i, a, 0}$ÔºàÂÖ∂‰∏≠ $i$ Ë°®Á§∫ $c$ ÁöÑÂÑøÂ≠êÁªìÁÇπÔºâ</p><p>ÂΩìÁÑ∂ËøòÊúâÊúÄÂü∫Êú¨ÁöÑÈôêÂà∂ÔºåÂØπÊüê‰∏™ËäÇÁÇπ $u$ ‰ª•ÂèäÊüê‰∏™Á§ºÁâ© $i$Ôºå$g_{1, i, 0} \rightarrow g_{1, i, 1}$ÔºàÂº∫Âà∂Ë¶ÅÊ±Ç $i$ Âú® $1$ ÁöÑÂ≠êÊ†ë‰∏≠Ôºâ„ÄÅ$g_{u, i, 1} \rightarrow g_{fa_u, i, 1}$„ÄÅ$g_{u, i, 0} \rightarrow g_{son_u, i, 0}$„ÄÅ$g_{u, i, 1} \rightarrow g_{v, i, 0}$ÔºàÂÖ∂‰∏≠ $u, v$ ÁöÑ‰∏§‰∏™Â≠êÊ†ëÊó†‰∫§ÈõÜÔºâ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (N + M) = O (n^2m + qn^2)$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">250</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">250</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = MAXN * MAXN * <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">3e07</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXL];</span><br><span class="line"><span class="keyword">int</span> Head[MAXK]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;, depth[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">father[root] = fa;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) G[root].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = G[root][i];</span><br><span class="line"><span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[root] + <span class="number">1</span>;</span><br><span class="line">DFS (v, root);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isanc</span> <span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! x) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> x == y ? <span class="literal">true</span> : isanc (y, father[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line"><span class="keyword">int</span> g[MAXN][MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dfn[MAXK]= &#123;<span class="number">0</span>&#125;, low[MAXK]= &#123;<span class="number">0</span>&#125;, ord = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">stack</span>[MAXK]= &#123;<span class="number">0</span>&#125;, top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> insta[MAXK]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> bel[MAXK]= &#123;<span class="number">0</span>&#125;, co = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">dfn[u] = low[u] = ++ ord;</span><br><span class="line"><span class="built_in">stack</span>[++ top] = u; insta[u] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (! dfn[v]) &#123;</span><br><span class="line">Tarjan (v);</span><br><span class="line">low[u] = min (low[u], low[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (insta[v]) low[u] = min (low[u], dfn[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (dfn[u] == low[u]) &#123;</span><br><span class="line">co ++; <span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">x = <span class="built_in">stack</span>[top --];</span><br><span class="line">insta[x] = <span class="literal">false</span>, bel[x] = co;</span><br><span class="line">&#125; <span class="keyword">while</span> (x != u);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">G[u].push_back(v); G[v].push_back(u);</span><br><span class="line">&#125;</span><br><span class="line">depth[<span class="number">1</span>] = <span class="number">1</span>, DFS (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line">g[i][j][<span class="number">1</span>] = ++ m, g[i][j][<span class="number">0</span>] = ++ m;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> a = getnum (), b = getnum (), u = getnum ();</span><br><span class="line"><span class="keyword">if</span> (father[u]) &#123; Insert (g[u][a][<span class="number">0</span>], g[u][b][<span class="number">1</span>]); Insert (g[u][b][<span class="number">0</span>], g[u][a][<span class="number">1</span>]); &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) G[u].size(); j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = G[u][j];</span><br><span class="line"><span class="keyword">if</span> (v != father[u]) &#123;</span><br><span class="line">Insert (g[v][a][<span class="number">1</span>], g[v][b][<span class="number">0</span>]);</span><br><span class="line">Insert (g[v][b][<span class="number">1</span>], g[v][a][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (father[i]) Insert (g[i][j][<span class="number">1</span>], g[father[i]][j][<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; (<span class="keyword">int</span>) G[i].size(); k ++)</span><br><span class="line"><span class="keyword">if</span> (G[i][k] != father[i])</span><br><span class="line">Insert (g[i][j][<span class="number">0</span>], g[G[i][k]][j][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) Insert (g[<span class="number">1</span>][i][<span class="number">0</span>], g[<span class="number">1</span>][i][<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (! isanc (i, j) &amp;&amp; ! isanc (j, i))</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= M; k ++)</span><br><span class="line">Insert (g[i][k][<span class="number">1</span>], g[j][k][<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)</span><br><span class="line"><span class="keyword">if</span> (! dfn[i])</span><br><span class="line">Tarjan (i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line"><span class="keyword">if</span> (bel[g[i][j][<span class="number">1</span>]] &lt; bel[g[i][j][<span class="number">0</span>]])</span><br><span class="line">ans[j] = depth[ans[j]] &lt; depth[i] ? i : ans[j];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">1</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, ans[i]);</span><br><span class="line">&#125; <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöMythological-IV"><a href="#Problem-BÔºöMythological-IV" class="headerlink" title="Problem BÔºöMythological IV"></a>Problem BÔºöMythological IV</h2><h2 id="Problem-CÔºöMythological-VII"><a href="#Problem-CÔºöMythological-VII" class="headerlink" title="Problem CÔºöMythological VII"></a>Problem CÔºöMythological VII</h2><h3 id="È¢òÁõÆÊèèËø∞-1"><a href="#È¢òÁõÆÊèèËø∞-1" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>Êï∞ËΩ¥‰∏äÊúâ‰∏ÄË°å $n$ ‰∏™ÁÇπÔºåÊØè‰∏™ÁÇπÊúâÊùÉÂÄº„ÄÇÂ∞èMÂíåÂ∞èSÂú®‰∏äÈù¢Áé©Ê∏∏Êàè„ÄÇ</p><p>Â∞èMÂíåÂ∞èS‰∏ÄÂºÄÂßãÈÉΩÂú®Á¨¨ $k$ Âè∑ÁÇπ‰∏äÔºåÂ∞èMÂè™ËÉΩÂêëÂ∑¶ÁßªÂä®ÔºåÂ∞èSÂè™ËÉΩÂêëÂè≥ÁßªÂä®„ÄÇ</p><p>‰ª§ $p_x$ Ë°®Á§∫ÂΩìÂâçÊó∂ÂàªÂ∞èMÁöÑ‰ΩçÁΩÆÔºå$p_y$ Ë°®Á§∫ÂΩìÂâçÊó∂ÂàªÂ∞èSÁöÑ‰ΩçÁΩÆÔºåË¶ÅÊ±Ç‰ªªÊÑèÊó∂ÂàªÈÉΩÊª°Ë∂≥ $(p_x, p_y]$ Ëøô‰∏™Âå∫Èó¥ÁöÑÊâÄÊúâÊï∞ÂíåÈÉΩ $\le 0$„ÄÇ</p><p>Áé∞Âú®ÔºåÂ∞èMÊÉ≥Ë¶ÅÁü•ÈÅì $p_x, p_y$ ËÉΩÂê¶ÂêåÊó∂Á≠â‰∫é $1, n$„ÄÇÂèØÊÄúÁöÑÂ∞èMÂΩìÁÑ∂‰∏ç‰ºöÂï¶ÔºåÊâÄ‰ª•Â•πÂêë‰Ω†Ê±ÇÂä©„ÄÇ</p><h3 id="Êï∞ÊçÆËåÉÂõ¥-1"><a href="#Êï∞ÊçÆËåÉÂõ¥-1" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le n \le 10^5, ~ T \le 20, ~ a_i \in [- 10^{13}, 10^{13}]$</p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>È¢òÁõÆÊòØË¶ÅÊª°Ë∂≥ÂâçÁºÄÂíå $sum_l \ge sum_r$</p><p>‰∏é <a href="https://colythme.github.io/2020/07/26/„ÄåJOISC%202017%20Day%201„ÄçÁÉüËä±Ê£í/">„ÄåJOISC 2017 Day 1„ÄçÁÉüËä±Ê£í</a> Ë¥™ÂøÉÈÉ®ÂàÜÊòØÁõ∏ÂêåÁöÑ</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1e09</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N, K;</span><br><span class="line">LL a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (a[<span class="number">1</span>] &lt; a[N]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> l = K, r = K, ll = K, lr = K;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">if</span> (a[i] &gt;= a[ll])</span><br><span class="line">ll = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (a[i] &lt;= a[lr])</span><br><span class="line">lr = i;</span><br><span class="line"><span class="keyword">while</span> (l != ll || r != lr) &#123;</span><br><span class="line"><span class="keyword">int</span> pl, pr; <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (pl = l; pl &gt; ll; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pl - <span class="number">1</span>] &lt; a[r]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[-- pl] &gt;= a[l]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pl &lt; l &amp;&amp; a[pl] &gt;= a[l]) &#123; l = pl; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (pr = r; pr &lt; lr; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pr + <span class="number">1</span>] &gt; a[l]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[++ pr] &lt;= a[r]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pr &gt; r &amp;&amp; a[pr] &lt;= a[r]) &#123; r = pr; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (! suc) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">l = <span class="number">1</span>, r = N;</span><br><span class="line"><span class="keyword">while</span> (l != ll || r != lr) &#123;</span><br><span class="line"><span class="keyword">int</span> pl, pr; <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (pl = l; pl &lt; ll; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pl + <span class="number">1</span>] &lt; a[r]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[++ pl] &gt;= a[l]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pl &gt; l &amp;&amp; a[pl] &gt;= a[l]) &#123; l = pl; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (pr = r; pr &gt; lr; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pr - <span class="number">1</span>] &gt; a[l]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[-- pr] &lt;= a[r]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pr &lt; r &amp;&amp; a[pr] &lt;= a[r]) &#123; r = pr; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (! suc) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) a[i] += a[i - <span class="number">1</span>];</span><br><span class="line">solve () ? <span class="built_in">puts</span> (<span class="string">"Yes"</span>) : <span class="built_in">puts</span> (<span class="string">"No"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ë¥™ÂøÉ </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> 2-SAT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Èïø‰πêÈõÜËÆ≠ - NOIÊ®°ÊãüËµõÔºà‰∏âÂçÅ‰∏âÔºâ„ÄåËÆ¢Ê≠£Êú™ÂÆåÊàê„Äç</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%89%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%89%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Ê≤°‰∫§</p><p>$\text{scoreÔºöNULL            rkÔºöNULL}$</p><h2 id="Problem-AÔºöÂå∫Èó¥Á¨¨kÂ∞è"><a href="#Problem-AÔºöÂå∫Èó¥Á¨¨kÂ∞è" class="headerlink" title="Problem AÔºöÂå∫Èó¥Á¨¨kÂ∞è"></a>Problem AÔºöÂå∫Èó¥Á¨¨kÂ∞è</h2><h3 id="È¢òÈù¢"><a href="#È¢òÈù¢" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/znS2C4hFuYj79VT.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/c8je9HNIn4CoEyW.png" alt=""></p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂÖàËÄÉËôëÁ¶ªÁ∫øÔºåÊï¥‰Ωì‰∫åÂàÜÔºå‰∫åÂàÜÁ≠îÊ°à $mid$ÔºåÂ§ÑÁêÜÊâÄÊúâ $\le mid$ ÁöÑÊï∞ÔºåÈÇ£‰πàÊ≠§Êó∂ÈóÆÈ¢òÂ∞±ËΩ¨Âåñ‰∏∫Âú®Âå∫Èó¥Âá∫Áé∞Ê¨°Êï∞‰∏çË∂ÖËøá $w$ ÁöÑÊï∞ÊúâÂ§öÂ∞ë‰∏™</p><p>‰∏çÂ¶®ÂÖ≥Ê≥®ÊØè‰∏™Êï∞ÂØπËØ¢ÈóÆÂå∫Èó¥ $[L, R]$ ÁöÑË¥°ÁåÆÔºåÂØπÊüê‰∏™Êï∞ $a$ÔºåËã•ÂÆÉÊòØ‰ªéÂ∑¶ÂæÄÂè≥Âêé $w$ ‰∏™Âá∫Áé∞‰∏∫ $a$ ÁöÑÊï∞ÔºåÂàôÂÆÉÁöÑË¥°ÁåÆ‰∏∫ $1$ÔºåËã•‰∏∫ÂÄíÊï∞Á¨¨ $w + 1$ ‰∏™ÂàôË¥°ÁåÆ‰∏∫ $- w$ÔºåÂâ©‰∏ãÁöÑË¥°ÁåÆÈÉΩ‰∏∫ $0$ÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ÂºÄ‰∏Ä‰∏™ÈòüÂàóÔºåÈ¶ñÂÖàÊÄªÂ§ßÂ∞èÔºàÂç≥‰∏çÂà†ÂéªË∂ÖËøá $w$ ÁöÑÔºâÁÆóÂá∫Êù•ÔºåÊ≠§Êó∂ËÆ°ÁÆóÈúÄË¶ÅÂà†ÂéªÁöÑÔºåÈòüÂàóÂ§ßÂ∞èÊú™Âà∞ $w$ Êó∂Ê≤°ÊúâÈúÄË¶ÅÂà†ÁöÑÔºåËã•Â§ß‰∫é $w$ Êó∂ÊØèÊ¨°Â∞±ËÆ©ÈòüÈ¶ñÁÇπË¥°ÁåÆÂáèÂéª $w + 1$ÔºåÂΩìÁÑ∂‰πãÂâçÂ§öÂáèÁöÑËøòË¶ÅÂä†ÂõûÊù•</p><p>ÈÇ£‰πàÁé∞Âú®Â∞±ÂèØ‰ª•ËÄÉËôë‰ªéÁ¶ªÁ∫øËΩ¨ÊàêÂú®Á∫øÔºåÂú®Êï¥‰Ωì‰∫åÂàÜÁöÑËøáÁ®ã‰∏≠ÊØè‰∏ÄÂ±ÇÔºàÂç≥ÊØè‰∏ÄÊ¨°‰∫åÂàÜÁöÑ $[l, r]$ÔºâÈÉΩ‰ºöÂª∫‰∏Ä‰∫õÂèØÊåÅ‰πÖÂåñÁ∫øÊÆµÊ†ëÔºåËÄåÂÆÉÂèàÊúÄÂ§ö‰ºö‰øÆÊîπ $O (n \log n)$ Ê¨°ÔºåÂºÄ $O (n \log^2 n)$ ‰∏™ËäÇÁÇπÔºåÊâÄ‰ª•ÊääÊØè‰∏ÄÂ±ÇÁöÑÂèØÊåÅ‰πÖÂåñÁ∫øÊÆµÊ†ëÈÉΩÂ≠ò‰∏ãÊù•ÔºåÂú®Á∫ø‰∫åÂàÜÊó∂Âç≥ÂèØÁõ¥Êé•Êü•ÊâæÔºåÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log^2 n)$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lp p &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rp p &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN * MAXL * MAXL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, W, Q, type;</span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> lson[MAXM]= &#123;<span class="number">0</span>&#125;, rson[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> subsum[MAXM]= &#123;<span class="number">0</span>&#125;, nd = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> pre, <span class="keyword">int</span>&amp; p, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">lson[p = ++ nd] = lson[pre], rson[p] = rson[pre];</span><br><span class="line">subsum[p] = subsum[pre] + x;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) modify (lson[pre], lson[p], left, mid, posi, x);</span><br><span class="line"><span class="keyword">else</span> modify (rson[pre], rson[p], mid + <span class="number">1</span>, right, posi, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi)</span> </span>&#123; <span class="comment">// &gt;= posiÁöÑÂíå</span></span><br><span class="line"><span class="keyword">if</span> (right &lt; posi) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= left) <span class="keyword">return</span> subsum[p];</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) <span class="keyword">return</span> subsum[rson[p]] + query (lson[p], left, mid, posi);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> query (rson[p], mid + <span class="number">1</span>, right, posi);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rt[MAXN &lt;&lt; <span class="number">2</span>], posi[MAXL + <span class="number">10</span>], use[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que[MAXN];</span><br><span class="line"><span class="keyword">int</span> ldel[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> p, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>, n = posi[d].size();</span><br><span class="line">use[p].resize(n); posi[d + <span class="number">1</span>].clear(), posi[d + <span class="number">1</span>].push_back(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = posi[d][i];</span><br><span class="line"><span class="keyword">if</span> (a[t] &lt;= mid) &#123;</span><br><span class="line">posi[d + <span class="number">1</span>].push_back(t);</span><br><span class="line">use[p][i] = use[p][i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">ldel[a[t]] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> use[p][i] = use[p][i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lim = posi[d + <span class="number">1</span>].size();</span><br><span class="line">rt[p].resize(lim);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; lim; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = posi[d + <span class="number">1</span>][i], x = a[t];</span><br><span class="line">que[x].push(i);</span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">int</span>) que[x].size() &gt; W) &#123;</span><br><span class="line">modify (rt[p][i - <span class="number">1</span>], rt[p][i], <span class="number">1</span>, lim - <span class="number">1</span>, que[x].front(), - W - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (ldel[x]) modify (rt[p][i], rt[p][i], <span class="number">1</span>, lim - <span class="number">1</span>, ldel[x], W);</span><br><span class="line">ldel[x] = que[x].front(); que[x].pop();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> rt[p][i] = rt[p][i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; lim; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = posi[d + <span class="number">1</span>][i], x = a[t];</span><br><span class="line"><span class="keyword">while</span> (! que[x].empty()) que[x].pop();</span><br><span class="line">&#125;</span><br><span class="line">build (left, mid, lp, d + <span class="number">1</span>);</span><br><span class="line">posi[d + <span class="number">1</span>].clear(), posi[d + <span class="number">1</span>].push_back(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = posi[d][i];</span><br><span class="line"><span class="keyword">if</span> (a[t] &gt; mid) posi[d + <span class="number">1</span>].push_back(t);</span><br><span class="line">&#125;</span><br><span class="line">build (mid + <span class="number">1</span>, right, rp, d + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> left;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> l = use[p][L], r = use[p][R], n = rt[p].size();</span><br><span class="line"><span class="keyword">int</span> sum = r - l + query (rt[p][r], <span class="number">1</span>, n - <span class="number">1</span>, l + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (sum &gt;= k) <span class="keyword">return</span> solve (lp, left, mid, l, r, k);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> solve (rp, mid + <span class="number">1</span>, right, L - l, R - r, k - sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), W = getnum (), Q = getnum (), type = getnum ();</span><br><span class="line">posi[<span class="number">1</span>].resize(N + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123; a[i] = getnum (); posi[<span class="number">1</span>][i] = i; &#125;</span><br><span class="line">build (<span class="number">0</span>, N, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> xxo = type * ans;</span><br><span class="line"><span class="keyword">int</span> l = getnum () ^ xxo, r = getnum () ^ xxo, k = getnum () ^ xxo;</span><br><span class="line">ans = solve (<span class="number">1</span>, <span class="number">0</span>, N, l - <span class="number">1</span>, r, k);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-BÔºöÊ±ÇÂíå"><a href="#Problem-BÔºöÊ±ÇÂíå" class="headerlink" title="Problem BÔºöÊ±ÇÂíå"></a>Problem BÔºöÊ±ÇÂíå</h2><h3 id="È¢òÈù¢-1"><a href="#È¢òÈù¢-1" class="headerlink" title="È¢òÈù¢"></a>È¢òÈù¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/eBd1iKnvg7Gf92A.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/YW1rji2cIUylMm5.png" alt=""></p><h3 id="È¢òËß£-1"><a href="#È¢òËß£-1" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>È¶ñÂÖàÂØπÂºèÂ≠êËøõË°åÂèòÊç¢<br>$$<br>\begin{aligned}<br>ans &amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^n\sum\limits_{d = 1}^k f_d(gcd(i, j)) \\<br>&amp;= \sum\limits_{x = 1}^n\sum\limits_{d = 1}^k f_d(x)\sum\limits_{i = 1}^{\lfloor\frac{n}{x}\rfloor}\sum\limits_{j = 1}^{\lfloor\frac{n}{x}\rfloor}[(i, j) = 1] \\<br>&amp;= \sum\limits_{x = 1}^n\sum\limits_{d = 1}^k f_d(x)\left((2\sum\limits_{i = 1}^{\lfloor\frac{n}{x}\rfloor}\varphi(i)) - 1\right)<br>\end{aligned}<br>$$<br>ÈÇ£‰πàËøôÊó∂ÂØπ $n$ Êï¥Èô§ÂàÜÂùóÂà∞Ôºå$\sum\limits_{i = 1}^n \varphi(i)$ Â∞±ÂèØ‰ª•Áõ¥Êé•ÊùúÊïôÁ≠õÊ±ÇÂá∫ÔºåËÆæÊ≠§Êó∂ÂàÜÂùóÂà∞ $[l, r]$ÔºåÁé∞Âú®ËÄÉËôëÊ±ÇËß£ $\sum\limits_{x = l}^r\sum\limits_{d = 1}^k f_d(x)$ÔºåÂΩìÁÑ∂ÂâçÁºÄÂíåÊòØËÇØÂÆöÁöÑ</p><p>‰ª§ $F_d(x) = \sum\limits_{i = 1}^n f_d(i)$ÔºåËÆæË¥®Âõ†Êï∞ÂàÜËß£ $n = \prod\limits_i p_i^{c_i}$Ôºå‰ª§ $\lambda(x) = \prod\limits_i (- 1)^{c_i}$Ôºå$F_d(x)$ ÂàôÂèØ‰ª•ÈÄöËøáÂÆπÊñ•Ê±ÇÂá∫<br>$$<br>\begin{aligned}<br>F_d(x) &amp;= \sum\limits_{i = 1}^x \mu(i)\sum\limits_{j = 1}^{\lfloor\frac{x}{i^{d + 1}}\rfloor}\lambda(i^{d + 1}j) \\<br>&amp;= \sum\limits_{i = 1}^x \lambda^{d + 1}(i)\mu(i)\sum\limits_{j = 1}^{\lfloor\frac{x}{i^{d + 1}}\rfloor}\lambda(j)<br>\end{aligned}<br>$$<br>Á¨¨‰∏ÄÊ≠•ÂÆûÈôÖ‰∏äÂ∞±ÊòØÁ±ª‰ººÊ±Ç $n$ ‰ª•ÂÜÖÊó†Âπ≥ÊñπÂõ†Â≠êÊï∞ÁöÑÊñπÊ≥ïÔºå$i = 1$ Êó∂‰∏∫ÊÄªÊñπÊ°àÔºåÂêéÈù¢ÂÆπÊñ•Âà†Âéª‰∏çÂêàÊ≥ï</p><p>ËÄåÁ¨¨‰∫åÊ≠•ÊòØÂõ†‰∏∫ $\lambda(x)$ ÊòØ‰∏Ä‰∏™ÂÆåÂÖ®ÁßØÊÄßÂáΩÊï∞</p><p>Áé∞Âú®ÈóÆÈ¢òËΩ¨Âåñ‰∏∫Ê±Ç $\sum\limits_{i = 1}^n \lambda(i)$ÔºåÂèØ‰ª•ÂèëÁé∞‰∏Ä‰∏™ÊÄßË¥®Ôºå$\sum\limits_{d |n} \lambda(i) = [n‰∏∫ÂÆåÂÖ®Âπ≥ÊñπÊï∞]$</p><p>‰∏ãÈù¢ÁªôÂá∫ËØÅÊòé</p><ul><li>ËÆæ $n = \prod\limits_i p_i^{c_i}$ÔºåËÄÉËôë‰∏§‰∏™Êï∞ $p_1^2x, p_1^3x$ÔºåÊª°Ë∂≥ $p_1^2x, p_1^3x | n$ÔºåËã• $p_1^2x$ ÁöÑË¥°ÁåÆ‰∏∫ $1$ÔºåÈÇ£‰πà $p_1^3x$ ÁöÑË¥°ÁåÆÂàô‰∏ÄÂÆö‰∏∫ $- 1$ÔºåÈÇ£‰πà‰ª•Ê≠§Á±ªÊé®Ôºå‰πüÂ∞±ÊòØ $0, 1$ Ê¨°„ÄÅ$2, 3$ Ê¨°„ÄÅ$4, 5$ Ê¨°‚Ä¶ÂàÜÂà´‰∏§‰∏§ÈÖçÂØπÔºåËã• $c_i$ ‰∏∫Â•áÊï∞ÔºåÂàôÊúÄÂêéË¥°ÁåÆÊÄªÂíå‰∏ÄÂÆö‰∏∫ $0$ÔºåËã•‰∏∫ÂÅ∂Êï∞ÔºåÊúÄÂêéÂàô‰∏ÄÂÆö‰∏∫ $1$</li></ul><p>ËøôÊ†∑ÁöÑËØùÂ∞±ÊòØ $\sqrt n = \lambda * 1$ÔºåÂ∞±ÂèØ‰ª•ÊùúÊïôÁ≠õ‰∫Ü</p><p>ÈÇ£‰πàÂØπ $F_d(x)$ÔºåÁ±ª‰ººÊùúÊïôÁ≠õÈ¢ÑÂ§ÑÁêÜ $x$ ÊØîËæÉÂ∞èÁöÑÔºàÊ≥®ÊÑèÁî®ÂéüÂºèÔºåÂç≥ $F_d(x) = \sum\limits_{i = 1}^n f_d(i)$ Êù•È¢ÑÂ§ÑÁêÜÔºâÔºåÁÑ∂ÂêéÂ§ßÁöÑÂ∞±Áõ¥Êé•Êö¥ÂäõÊûö‰∏æÔºåÊúÄÂ§ö $O (\sqrt n)$ÔºåÈÇ£‰πàËøôÊ†∑ÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØ $O (n^{\frac23})$ ÁöÑ</p><h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1073741824</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4e06</span> + <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">3000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL N; <span class="keyword">int</span> K;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN / <span class="number">10</span>], pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line">uint mu[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">uint phi[MAXN]= &#123;<span class="number">0</span>&#125;, sphi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">uint lamda[MAXN]= &#123;<span class="number">0</span>&#125;, suml[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">uint sumf[MAXN]= &#123;<span class="number">0</span>&#125;; <span class="comment">// sumf(x): Œ£(d=1~k)f[d](x)</span></span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;, b[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">4e06</span> + <span class="number">5e05</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">mu[<span class="number">1</span>] = phi[<span class="number">1</span>] = lamda[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">sumf[<span class="number">1</span>] = K;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! visit[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">mu[i] = - <span class="number">1</span>;</span><br><span class="line">phi[i] = i - <span class="number">1</span>, lamda[i] = - <span class="number">1</span>;</span><br><span class="line">a[i] = b[i] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">visit[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j])) &#123;</span><br><span class="line">phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line">lamda[i * prime[j]] = - lamda[i];</span><br><span class="line">a[i * prime[j]] = a[i] + <span class="number">1</span>;</span><br><span class="line">b[i * prime[j]] = max (a[i * prime[j]], b[i]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">mu[i * prime[j]] = - mu[i];</span><br><span class="line">phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</span><br><span class="line">lamda[i * prime[j]] = - lamda[i];</span><br><span class="line">a[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">b[i * prime[j]] = b[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line">suml[i] = suml[i - <span class="number">1</span>] + lamda[i];</span><br><span class="line">sphi[i] = sphi[i - <span class="number">1</span>] + phi[i];</span><br><span class="line">sumf[i] = sumf[i - <span class="number">1</span>]  + lamda[i] * max (<span class="number">0</span>, K - max (b[i], <span class="number">1</span>) + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vp[MAXM]= &#123;<span class="literal">false</span>&#125;, vl[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line">uint sp[MAXM], sl[MAXM];</span><br><span class="line"><span class="function">uint <span class="title">phi_sieve</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sphi[n];</span><br><span class="line"><span class="keyword">if</span> (vp[N / n]) <span class="keyword">return</span> sp[N / n];</span><br><span class="line">uint ret = n * (n + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">ret -= <span class="number">1u</span> * (r - l + <span class="number">1</span>) * phi_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line">vp[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> sp[N / n] = ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">uint <span class="title">lamda_sieve</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> suml[n];</span><br><span class="line"><span class="keyword">if</span> (vl[N / n]) <span class="keyword">return</span> sl[N / n];</span><br><span class="line">uint ret = <span class="built_in">sqrt</span> (n);</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">ret -= <span class="number">1u</span> * (r - l + <span class="number">1</span>) * lamda_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line">vl[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> sl[N / n] = ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL mpow[MAXL][<span class="number">42</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> lim = <span class="built_in">sqrt</span> (N) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lim; i ++) &#123;</span><br><span class="line">mpow[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K + <span class="number">1</span>; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (mpow[i][j - <span class="number">1</span>] &gt; N) <span class="keyword">break</span>;</span><br><span class="line">mpow[i][j] = mpow[i][j - <span class="number">1</span>] * i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vf[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line">uint sf[MAXM];</span><br><span class="line"><span class="function">uint <span class="title">work</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sumf[n];</span><br><span class="line"><span class="keyword">if</span> (vf[N / n]) <span class="keyword">return</span> sf[N / n];</span><br><span class="line">uint ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">1</span>; d &lt;= K; d += <span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; mpow[i][d + <span class="number">1</span>] &amp;&amp; mpow[i][d + <span class="number">1</span>] &lt;= n; i ++)</span><br><span class="line">ret += mu[i] * lamda_sieve (n / mpow[i][d + <span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">2</span>; d &lt;= K; d += <span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; mpow[i][d + <span class="number">1</span>] &amp;&amp; mpow[i][d + <span class="number">1</span>] &lt;= n; i ++)</span><br><span class="line">ret += lamda[i] * mu[i] * lamda_sieve (n / mpow[i][d + <span class="number">1</span>]);</span><br><span class="line">vf[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> sf[N / n] = ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K;</span><br><span class="line">init (); sieve ();</span><br><span class="line">uint ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">1</span>, r; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = N / (N / l);</span><br><span class="line">ans += (<span class="number">2u</span> * phi_sieve (N / l) - <span class="number">1</span>) * (work (r) - work (l - <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans % MOD &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-C-Ê†ë"><a href="#Problem-C-Ê†ë" class="headerlink" title="Problem C: Ê†ë"></a>Problem C: Ê†ë</h2>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ëé´ÊØî‰πåÊñØÂèçÊºî </tag>
            
            <tag> ÊùúÊïôÁ≠õ </tag>
            
            <tag> ÈõÜËÆ≠ </tag>
            
            <tag> Êï¥‰Ωì‰∫åÂàÜ </tag>
            
            <tag> ÂèØÊåÅ‰πÖÂåñÁ∫øÊÆµÊ†ë </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Á∫øÊÆµÊ†ëÊ±ÇÊ†ëÁöÑÁõ¥ÂæÑ</title>
      <link href="/2020/08/04/%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%B1%82%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84/"/>
      <url>/2020/08/04/%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%B1%82%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Á∫øÊÆµÊ†ëÊ±ÇÁõ¥ÂæÑÂèØ‰ª•Ê±Ç‰ªªÊÑèÂ≠êÊ†ëÔºàÂåÖÊã¨ËøûÂ≠êÊ†ëÈÉΩ‰∏çÁÆóÁöÑÂàÜÊï£ËäÇÁÇπÈõÜÂêàÔºâÁöÑÁõ¥ÂæÑÔºåÈÄÇÁî®ËåÉÂõ¥Âπø„ÄÇ</p><p>Á∫øÊÆµÊ†ëÁöÑÊØè‰∏™ËäÇÁÇπÊâÄÂØπÂ∫îÁöÑÂå∫Èó¥$[L, R]$ÔºåÊåá‰ª£‰∫Ü$Dfn$Âú®$[L, R]$ÂÜÖËäÇÁÇπÔºåÂÖ∂‰∏≠Á∫øÊÆµÊ†ë‰∏äÊØè‰∏™ËäÇÁÇπÂ≠òÂÇ®‰∫Ü$diam$ÔºàÂΩìÂâçÂå∫Èó¥Áõ¥ÂæÑÔºâÂèä$lp,  rp$ÔºàÂΩìÂâçÁõ¥ÂæÑÂØπÂ∫îÁöÑÂ∑¶Âè≥Á´ØÁÇπÔºâÔºåÊØèÊ¨°$Merge$Êìç‰ΩúÂàÜ‰∏∫ÂÖ®Â∑¶Âå∫Èó¥„ÄÅÂÖ®Âè≥Âå∫Èó¥ÂíåÊ®™Ë∑®‰∏§‰∏™Âå∫Èó¥‰ΩúËÆ®ËÆ∫ÔºåÂØπ‰∫éÁ¨¨‰∏âÁßçÊÉÖÂÜµÔºåÈÄâÊã©‰∏§‰æßÂéüÁõ¥ÂæÑÁ´ØÁÇπÊ±Ç$Dist$ÂèñÊúÄÂÄºÂç≥ÂèØÔºåÊ≠£Á°ÆÊÄßÊòæÁÑ∂ÔºåÊü•ËØ¢Áõ¥Êé•ÈÄöËøá$Dfn$Êü•ËØ¢Âç≥ÂèØ„ÄÇ</p><p>ÂΩìÁÑ∂ÂèØËÉΩÊúâ‰∏Ä‰∫õÂå∫Èó¥ÂÜÖÁöÑÁÇπ‰∏çËøûÈÄöÔºåÂÖàÂΩì‰ΩúÂÆÉ‰ª¨ËøûÈÄöÂç≥ÂèØ„ÄÇ</p><p>ÂØπ‰∫éÂà†Èô§Êüê‰∫õÂ≠êÊ†ëÔºåÁõ∏ÂΩì‰∫éÊääÊï¥Ê£µÊ†ëÂàÜ‰∏∫$n$ÈÉ®ÂàÜÔºåÊü•ËØ¢ÊØè‰∏™ÈÉ®ÂàÜÔºåÂÖ®ÈÉ®$Merge$Ëµ∑Êù•Âç≥ÂèØ„ÄÇ</p><h3 id="‰æãÈ¢ò"><a href="#‰æãÈ¢ò" class="headerlink" title="‰æãÈ¢ò"></a>‰æãÈ¢ò</h3><p><a href="https://www.luogu.org/problemnew/show/T55282" target="_blank" rel="noopener">SnowÁöÑËøΩÂØª</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line">  <span class="number">2</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line">  <span class="number">3</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line">  <span class="number">4</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line">  <span class="number">5</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line">  <span class="number">6</span> </span><br><span class="line">  <span class="number">7</span> <span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line">  <span class="number">8</span> <span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line">  <span class="number">9</span> </span><br><span class="line"> <span class="number">10</span> <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> <span class="number">11</span> </span><br><span class="line"> <span class="number">12</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"> <span class="number">13</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"> <span class="number">14</span> </span><br><span class="line"> <span class="number">15</span> <span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"> <span class="number">16</span>     <span class="keyword">int</span> to;</span><br><span class="line"> <span class="number">17</span> </span><br><span class="line"> <span class="number">18</span>     <span class="keyword">int</span> next;</span><br><span class="line"> <span class="number">19</span> &#125; ;</span><br><span class="line"> <span class="number">20</span> </span><br><span class="line"> <span class="number">21</span> LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"> <span class="number">22</span> <span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> <span class="number">23</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"> <span class="number">24</span> </span><br><span class="line"> <span class="number">25</span> <span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line"> <span class="number">26</span>     Link[++ size].to = v;</span><br><span class="line"> <span class="number">27</span>     Link[size].next = Head[u];</span><br><span class="line"> <span class="number">28</span> </span><br><span class="line"> <span class="number">29</span>     Head[u] = size;</span><br><span class="line"> <span class="number">30</span> &#125;</span><br><span class="line"> <span class="number">31</span> </span><br><span class="line"> <span class="number">32</span> <span class="keyword">const</span> <span class="keyword">int</span> Root = <span class="number">1</span>;</span><br><span class="line"> <span class="number">33</span> </span><br><span class="line"> <span class="number">34</span> <span class="keyword">int</span> Deep[MAXN];</span><br><span class="line"> <span class="number">35</span> <span class="keyword">int</span> Size[MAXN];</span><br><span class="line"> <span class="number">36</span> <span class="keyword">int</span> Val[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"> <span class="number">37</span> <span class="keyword">int</span> Dfn[MAXN], DDfn[MAXN];</span><br><span class="line"> <span class="number">38</span> <span class="keyword">int</span> Rank[MAXN];</span><br><span class="line"> <span class="number">39</span> <span class="keyword">int</span> dfsord = <span class="number">0</span>, dod2 = <span class="number">0</span>;</span><br><span class="line"> <span class="number">40</span> </span><br><span class="line"> <span class="number">41</span> <span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line"> <span class="number">42</span>     Size[root] = <span class="number">1</span>;</span><br><span class="line"> <span class="number">43</span>     Dfn[root] = ++ dfsord;</span><br><span class="line"> <span class="number">44</span>     Rank[dfsord] = root;</span><br><span class="line"> <span class="number">45</span>     DDfn[root] = ++ dod2;</span><br><span class="line"> <span class="number">46</span>     Val[dod2] = Deep[root];</span><br><span class="line"> <span class="number">47</span>     <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"> <span class="number">48</span>         <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"> <span class="number">49</span>         <span class="keyword">if</span> (v == father)</span><br><span class="line"> <span class="number">50</span>             <span class="keyword">continue</span>;</span><br><span class="line"> <span class="number">51</span> </span><br><span class="line"> <span class="number">52</span>         Deep[v] = Deep[root] + <span class="number">1</span>;</span><br><span class="line"> <span class="number">53</span>         DFS (v, root);</span><br><span class="line"> <span class="number">54</span>         Size[root] += Size[v];</span><br><span class="line"> <span class="number">55</span>         Val[++ dod2] = Deep[root];</span><br><span class="line"> <span class="number">56</span>     &#125;</span><br><span class="line"> <span class="number">57</span> &#125;</span><br><span class="line"> <span class="number">58</span> </span><br><span class="line"> <span class="number">59</span> <span class="keyword">int</span> ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">30</span>];</span><br><span class="line"> <span class="number">60</span> </span><br><span class="line"> <span class="number">61</span> <span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"> <span class="number">62</span>     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dod2; i ++)</span><br><span class="line"> <span class="number">63</span>         ST[i][<span class="number">0</span>] = Val[i];</span><br><span class="line"> <span class="number">64</span>     <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">20</span>; j ++)</span><br><span class="line"> <span class="number">65</span>         <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dod2; i ++)</span><br><span class="line"> <span class="number">66</span>             <span class="keyword">if</span> (i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)) &lt;= dod2)</span><br><span class="line"> <span class="number">67</span>                 ST[i][j] = min (ST[i][j - <span class="number">1</span>], ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line"> <span class="number">68</span> &#125;</span><br><span class="line"> <span class="number">69</span> </span><br><span class="line"> <span class="number">70</span> <span class="function"><span class="keyword">int</span> <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"> <span class="number">71</span>     <span class="keyword">int</span> k = log2 (R - L + <span class="number">1</span>);</span><br><span class="line"> <span class="number">72</span>     <span class="keyword">return</span> min (ST[L][k], ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line"> <span class="number">73</span> &#125;</span><br><span class="line"> <span class="number">74</span> </span><br><span class="line"> <span class="number">75</span> <span class="function"><span class="keyword">int</span> <span class="title">Dist</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"> <span class="number">76</span>     <span class="keyword">if</span> (DDfn[x] &gt; DDfn[y])</span><br><span class="line"> <span class="number">77</span>         swap (x, y);</span><br><span class="line"> <span class="number">78</span> </span><br><span class="line"> <span class="number">79</span>     <span class="keyword">int</span> deeplca = Query (DDfn[x], DDfn[y]);</span><br><span class="line"> <span class="number">80</span>     <span class="keyword">return</span> Deep[x] + Deep[y] - <span class="number">2</span> * deeplca;</span><br><span class="line"> <span class="number">81</span> &#125;</span><br><span class="line"> <span class="number">82</span> </span><br><span class="line"> <span class="number">83</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line"> <span class="number">84</span>     <span class="keyword">int</span> diam;</span><br><span class="line"> <span class="number">85</span>     <span class="keyword">int</span> lp, rp;</span><br><span class="line"> <span class="number">86</span> </span><br><span class="line"> <span class="number">87</span>     Node () &#123;</span><br><span class="line"> <span class="number">88</span>         diam = <span class="number">0</span>;</span><br><span class="line"> <span class="number">89</span>         lp = rp = <span class="number">0</span>;</span><br><span class="line"> <span class="number">90</span>     &#125;</span><br><span class="line"> <span class="number">91</span> </span><br><span class="line"> <span class="number">92</span>     Node (<span class="keyword">int</span> fdiam, <span class="keyword">int</span> flp, <span class="keyword">int</span> frp) :</span><br><span class="line"> <span class="number">93</span>         diam (fdiam), lp (flp), rp (frp) &#123;&#125;</span><br><span class="line"> <span class="number">94</span> &#125; ;</span><br><span class="line"> <span class="number">95</span> </span><br><span class="line"> <span class="number">96</span> Node Tree[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"> <span class="number">97</span> </span><br><span class="line"> <span class="number">98</span> </span><br><span class="line"> <span class="number">99</span> <span class="function">Node <span class="title">Merge</span> <span class="params">(Node s1, Node s2)</span> </span>&#123;</span><br><span class="line"><span class="number">100</span>     <span class="keyword">if</span> (s1.diam == - <span class="number">1</span>)</span><br><span class="line"><span class="number">101</span>         <span class="keyword">return</span> s2;</span><br><span class="line"><span class="number">102</span>     Node news = s1.diam &gt;= s2.diam ? s1 : s2; <span class="comment">// ‰ª•‰∏ãËÆ®ËÆ∫</span></span><br><span class="line"><span class="number">103</span>     <span class="keyword">if</span> (Dist (s1.lp, s2.lp) &gt; news.diam)</span><br><span class="line"><span class="number">104</span>         news = Node (Dist (s1.lp, s2.lp), s1.lp, s2.lp);</span><br><span class="line"><span class="number">105</span>     <span class="keyword">if</span> (Dist (s1.lp, s2.rp) &gt; news.diam)</span><br><span class="line"><span class="number">106</span>         news = Node (Dist (s1.lp, s2.rp), s1.lp, s2.rp);</span><br><span class="line"><span class="number">107</span>     <span class="keyword">if</span> (Dist (s1.rp, s2.lp) &gt; news.diam)</span><br><span class="line"><span class="number">108</span>         news = Node (Dist (s1.rp, s2.lp), s1.rp, s2.lp);</span><br><span class="line"><span class="number">109</span>     <span class="keyword">if</span> (Dist (s1.rp, s2.rp) &gt; news.diam)</span><br><span class="line"><span class="number">110</span>         news = Node (Dist (s1.rp, s2.rp), s1.rp, s2.rp);</span><br><span class="line"><span class="number">111</span> </span><br><span class="line"><span class="number">112</span>     <span class="keyword">return</span> news;</span><br><span class="line"><span class="number">113</span> &#125;</span><br><span class="line"><span class="number">114</span> </span><br><span class="line"><span class="number">115</span> <span class="function"><span class="keyword">void</span> <span class="title">Build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line"><span class="number">116</span>     Tree[root] = Node ();</span><br><span class="line"><span class="number">117</span> </span><br><span class="line"><span class="number">118</span>     <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line"><span class="number">119</span>         Tree[root].diam = <span class="number">0</span>;</span><br><span class="line"><span class="number">120</span>         Tree[root].lp = Tree[root].rp = Rank[left];</span><br><span class="line"><span class="number">121</span>         <span class="keyword">return</span> ;</span><br><span class="line"><span class="number">122</span>     &#125;</span><br><span class="line"><span class="number">123</span> </span><br><span class="line"><span class="number">124</span>     <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="number">125</span>     Build (lson, left, mid);</span><br><span class="line"><span class="number">126</span>     Build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line"><span class="number">127</span> </span><br><span class="line"><span class="number">128</span>     Tree[root] = Merge (Tree[lson], Tree[rson]);</span><br><span class="line"><span class="number">129</span> &#125;</span><br><span class="line"><span class="number">130</span> </span><br><span class="line"><span class="number">131</span> <span class="function">Node <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="number">132</span>     <span class="keyword">if</span> (L == left &amp;&amp; R == right)</span><br><span class="line"><span class="number">133</span>         <span class="keyword">return</span> Tree[root];</span><br><span class="line"><span class="number">134</span> </span><br><span class="line"><span class="number">135</span>     <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="number">136</span>     <span class="keyword">if</span> (R &lt;= mid)</span><br><span class="line"><span class="number">137</span>         <span class="keyword">return</span> Query (lson, left, mid, L, R);</span><br><span class="line"><span class="number">138</span>     <span class="keyword">else</span> <span class="keyword">if</span> (L &gt; mid)</span><br><span class="line"><span class="number">139</span>         <span class="keyword">return</span> Query (rson, mid + <span class="number">1</span>, right, L, R);</span><br><span class="line"><span class="number">140</span>     <span class="keyword">else</span></span><br><span class="line"><span class="number">141</span>         <span class="keyword">return</span> Merge (Query (lson, left, mid, L, mid), Query (rson, mid + <span class="number">1</span>, right, mid + <span class="number">1</span>, R));</span><br><span class="line"><span class="number">142</span> &#125;</span><br><span class="line"><span class="number">143</span> </span><br><span class="line"><span class="number">144</span> <span class="keyword">int</span> N, Q;</span><br><span class="line"><span class="number">145</span> </span><br><span class="line"><span class="number">146</span> <span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="number">147</span>     <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="number">148</span>     <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="number">149</span> </span><br><span class="line"><span class="number">150</span>     <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line"><span class="number">151</span>         ch = getchar ();</span><br><span class="line"><span class="number">152</span>     <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line"><span class="number">153</span>         num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="number">154</span> </span><br><span class="line"><span class="number">155</span>     <span class="keyword">return</span> num;</span><br><span class="line"><span class="number">156</span> &#125;</span><br><span class="line"><span class="number">157</span> </span><br><span class="line"><span class="number">158</span> <span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="number">159</span>     <span class="comment">// freopen ("Input.txt", "r", stdin);</span></span><br><span class="line"><span class="number">160</span> </span><br><span class="line"><span class="number">161</span>     N = getnum (), Q = getnum ();</span><br><span class="line"><span class="number">162</span> </span><br><span class="line"><span class="number">163</span>     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="number">164</span>         <span class="keyword">int</span> u, v;</span><br><span class="line"><span class="number">165</span>         u = getnum (), v = getnum ();</span><br><span class="line"><span class="number">166</span>         Insert (u, v), Insert (v, u);</span><br><span class="line"><span class="number">167</span>     &#125;</span><br><span class="line"><span class="number">168</span> </span><br><span class="line"><span class="number">169</span>     DFS (Root, <span class="number">0</span>);</span><br><span class="line"><span class="number">170</span>     RMQ ();</span><br><span class="line"><span class="number">171</span> </span><br><span class="line"><span class="number">172</span>     Build (Root, <span class="number">1</span>, dfsord);</span><br><span class="line"><span class="number">173</span>     <span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= Q; Case ++) &#123;</span><br><span class="line"><span class="number">174</span>         <span class="keyword">int</span> x, y;</span><br><span class="line"><span class="number">175</span>         x = getnum (), y = getnum ();</span><br><span class="line"><span class="number">176</span> </span><br><span class="line"><span class="number">177</span>         Node res = Node (- <span class="number">1</span>, - <span class="number">1</span>, - <span class="number">1</span>);</span><br><span class="line"><span class="number">178</span>         <span class="keyword">if</span> (Dfn[x] &gt; Dfn[y])</span><br><span class="line"><span class="number">179</span>             swap (x, y);</span><br><span class="line"><span class="number">180</span>         <span class="keyword">int</span> sx = Dfn[x], ex = sx + Size[x] - <span class="number">1</span>;</span><br><span class="line"><span class="number">181</span>         <span class="keyword">int</span> sy = Dfn[y], ey = sy + Size[y] - <span class="number">1</span>;</span><br><span class="line"><span class="number">182</span>         <span class="keyword">if</span> (sx &gt; <span class="number">1</span>) <span class="comment">// Á¨¨‰∏ÄÈÉ®ÂàÜ</span></span><br><span class="line"><span class="number">183</span>             res = Merge (res, Query (Root, <span class="number">1</span>, dfsord, <span class="number">1</span>, sx - <span class="number">1</span>));</span><br><span class="line"><span class="number">184</span>         <span class="keyword">if</span> (ex + <span class="number">1</span> &lt; sy) <span class="comment">// Á¨¨‰∫åÈÉ®ÂàÜ</span></span><br><span class="line"><span class="number">185</span>             res = Merge (res, Query (Root, <span class="number">1</span>, dfsord, ex + <span class="number">1</span>, sy - <span class="number">1</span>));</span><br><span class="line"><span class="number">186</span>         <span class="keyword">int</span> fen = max (ex, ey);</span><br><span class="line"><span class="number">187</span>         <span class="keyword">if</span> (fen &lt; dfsord) <span class="comment">// Á¨¨‰∏âÈÉ®ÂàÜ</span></span><br><span class="line"><span class="number">188</span>             res = Merge (res, Query (Root, <span class="number">1</span>, dfsord, fen + <span class="number">1</span>, dfsord));</span><br><span class="line"><span class="number">189</span>         <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, res.diam == - <span class="number">1</span> ? <span class="number">0</span> : res.diam);</span><br><span class="line"><span class="number">190</span>     &#125;</span><br><span class="line"><span class="number">191</span> </span><br><span class="line"><span class="number">192</span>     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">193</span> &#125;</span><br><span class="line"><span class="number">194</span> </span><br><span class="line"><span class="number">195</span> <span class="comment">/*</span></span><br><span class="line"><span class="comment">196 5 2</span></span><br><span class="line"><span class="comment">197 1 3</span></span><br><span class="line"><span class="comment">198 3 2</span></span><br><span class="line"><span class="comment">199 3 4</span></span><br><span class="line"><span class="comment">200 2 5</span></span><br><span class="line"><span class="comment">201 2 4</span></span><br><span class="line"><span class="comment">202 5 4</span></span><br><span class="line"><span class="comment">203 */</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
          <category> Êï∞ÊçÆÁªìÊûÑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÆµÊ†ë </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Á´ûËµõÂõæÊüìËâ≤</title>
      <link href="/2020/08/04/%E7%AB%9E%E8%B5%9B%E5%9B%BE%E6%9F%93%E8%89%B2/"/>
      <url>/2020/08/04/%E7%AB%9E%E8%B5%9B%E5%9B%BE%E6%9F%93%E8%89%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote><p>ÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπÁöÑÁ´ûËµõÂõæÔºåÁªôËØ•ÂõæÁöÑÊØèÊù°ËæπÊüìËâ≤ÔºåÈ¢úËâ≤Êï∞Èáè‰∏çËÉΩË∂ÖËøá $m$ ‰∏™Ôºå‰∏Ä‰∏™ÊüìËâ≤ÂêàÊ≥ïÂΩì‰∏î‰ªÖÂΩì‰∏çÂ≠òÂú®ÈïøÂ∫¶‰∏∫ $2$ ÁöÑË∑ØÂæÑÔºåÂç≥ÂØπÊúâÂêëÂõæ‰∏≠‰ªªÊÑèË∑ØÂæÑ $i \rightarrow j \rightarrow k$ ÂùáÊúâËæπ $i \rightarrow j$ ÂíåËæπ $j \rightarrow k$ È¢úËâ≤‰∏çÂêå</p></blockquote><blockquote><p>$2 \le n \le 3000, ~ 2 \le m \le 26$</p></blockquote><p>ËÆæËØ•Á´ûËµõÂõæÁÇπÈõÜ $V$</p><p>ËÄÉËôëÊüìÊØè‰∏ÄÁßçÈ¢úËâ≤ÊÑèÂë≥ÁùÄ‰ªÄ‰πàÔºåÁõ∏ÂΩì‰∫éÈÄâÊã©‰∏Ä‰∏™ÁÇπÈõÜ $S \subseteq V$ÔºåÂ∞ÜÊâÄÊúâËæπ $(u, v)$ Êª°Ë∂≥ $u \in S \cap v \in \complement_VS$ Êüì‰∏äËØ•È¢úËâ≤Ôºå‰πüÂ∞±ÊòØËØ¥Êàë‰ª¨Ë¶ÅÊâæÂà∞Ëá≥Â§ö $m$ ‰∏™ËøôÊ†∑ÁöÑÈõÜÂêàÊù•Ë¶ÜÁõñÊâÄÊúâÁöÑËæπ</p><p>ËøôÊ†∑ÂèØ‰ª•ÁªôÂá∫‰∏Ä‰∏™ $m = 2\log n$ ÁöÑÊüìËâ≤ÊñπÊ°àÔºåÂØπÊâÄÊúâÁÇπÂàÜÊ≤ªÔºåÊØèÊ¨°‰∏ÄÂàÜ‰∏∫‰∫åÔºåÁªô $S, \complement_V S$ ‰πãÈó¥ÁöÑËæπÊåâ‰∏§ÁßçÊñπÂêëÊüì‰∏ä‰∏çÂêåÁöÑÈ¢úËâ≤ÔºåËøôÊ†∑ÊÄªÂÖ±ÈúÄË¶ÅÈ¢úËâ≤ÊòØ $2\log n$ ÁöÑ</p><p>‰ΩÜÂÆûÈôÖ‰∏äÂèØ‰ª•Áî®‰∫åËøõÂà∂Êù•Ë°®Á§∫ËøôÁßçÊòØÂê¶Âú®ÊØè‰∏™ $S$ ‰∏≠ÁöÑÂÖ≥Á≥ªÔºåÂØπÊØè‰∏™ $S_i$ÔºåËã•ÂΩìÂâçÁÇπ $u$ ÂæóÂà∞ÁöÑ‰∫åËøõÂà∂‰Ωç‰∏∫ $1$ÔºåÂàô‰ª£Ë°® $u \in S_i$ÔºåÂê¶Âàô $u \in \complement_VS_i$ÔºåÂç≥‰ª£Ë°® $i$ ‰∏çÂ≠òÂú®È¢úËâ≤‰∏∫ $i$ ÁöÑÂ§ñÂêëËæπÔºåÈÇ£‰πàÁÇπ $i$ ÁöÑÈÄâÊã©ÊñπÊ°àÂèØ‰ª•Áúã‰Ωú $\{1, 2, ‚Ä¶, m\}$ ÁöÑ‰∏Ä‰∏™Â≠êÈõÜÔºåËÆæ‰∏∫ $A_i$ÔºåÊàë‰ª¨ÂàôË¶ÅÈÄâÂá∫ $n$ ‰∏™ÈõÜÂêàÊª°Ë∂≥ $\forall i, j$ÔºåÊúâ $\exists x, y, ~ x \in A_i, y \in A_j$ Êª°Ë∂≥ $x \notin A_j, y \notin A_i$</p><p>ÈÇ£‰πà‰∏Ä‰∏™ÊØîËæÉÂ•ΩÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂ∞±ÊòØÂèñÊâÄÊúâÂ§ßÂ∞èÊÅ∞‰∏∫ $\lfloor\frac{m}2\rfloor$ ÁöÑÈõÜÂêàÔºåÂèà $\dbinom{14}{7} = 3432 \ge 3000$ÔºåÊïÖÂÆûÈôÖ‰∏ä $m \le 14$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3432</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">char</span> in[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sve[MAXN]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> lim = (<span class="number">1</span> &lt;&lt; M) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">0</span>; state &lt;= lim; state ++) &#123;</span><br><span class="line"><span class="keyword">int</span> cnt = __builtin_popcount (state);</span><br><span class="line"><span class="keyword">if</span> (cnt == (M &gt;&gt; <span class="number">1</span>)) sve[++ m] = state;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">if</span> (M &gt; <span class="number">14</span>) M = <span class="number">14</span>;</span><br><span class="line">work ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, in + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; M; k ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (in[j] == <span class="string">'1'</span> &amp;&amp; ((sve[i] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">1</span> &amp;&amp; ((sve[j] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="built_in">putchar</span> (k + <span class="string">'a'</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (in[j] == <span class="string">'0'</span> &amp;&amp; ((sve[i] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">0</span> &amp;&amp; ((sve[j] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="built_in">putchar</span> (k + <span class="string">'a'</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊÄùÁª¥ </category>
          
          <category> ÂõæËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊûÑÈÄ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ÁîüÊàêÂáΩÊï∞‰∏éÁªÑÂêàËÆ°Êï∞ÂàùÊ≠•</title>
      <link href="/2020/08/04/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0%E5%88%9D%E6%AD%A5/"/>
      <url>/2020/08/04/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0%E5%88%9D%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ËØ•Êñá‰∏∫ÔºàÈáëÁ≠ñ„ÄäÁîüÊàêÂáΩÊï∞ÁöÑËøêÁÆó‰∏éÁªÑÂêàËÆ°Êï∞ÈóÆÈ¢ò„ÄãÔºâÂ≠¶‰π†Á¨îËÆ∞</p><h3 id="ÂπÇÁ∫ßÊï∞"><a href="#ÂπÇÁ∫ßÊï∞" class="headerlink" title="ÂπÇÁ∫ßÊï∞"></a>ÂπÇÁ∫ßÊï∞</h3><p>Á∫ßÊï∞Ôºö‰∏Ä‰∏™ÊúâÁ©∑ÊàñÊó†Á©∑Â∫èÂàó $a_0, a_1, a_2, ‚Ä¶$ ÁöÑÂΩ¢ÂºèÂíå„ÄåÂç≥ $\sum\limits_{i = 0} a_i$„ÄçË¢´Áß∞‰∏∫Á∫ßÊï∞ÔºåÂ∫èÂàó‰∏≠ÁöÑÈ°πÁß∞‰ΩúÁ∫ßÊï∞ÁöÑÈÄöÈ°π</p><p>ÊïõÊï£ÊÄßÔºöÊûÅÈôêÊòØÊó†Á©∑Âç≥‰∏∫ÂèëÊï£„ÄåÂ¶Ç $f(x) = x$„ÄçÔºõÊûÅÈôê‰∏ç‰∏∫Êó†Á©∑Âç≥‰∏∫Êî∂Êïõ„ÄåÂ¶Ç $f(x) = \frac{1}{x}$„Äç</p><p>ÈÇ£‰πàÂπÇÁ∫ßÊï∞Âç≥‰∏∫ÂΩ¢Â¶Ç $\sum\limits_{n = 0}^{\infty} a_n(x - c)^n$ ÊàñËÄÖÂåñÁÆÄ‰∏∫ $\sum\limits_{n = 0}^{\infty} a_nx^n$ ÁöÑÂΩ¢Âºè</p><h3 id="ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞"><a href="#ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞" class="headerlink" title="ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞"></a>ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞</h3><p>ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞<br>$$<br>A(x) = \sum\limits_{n = 0}^{\infty} a_nx^n<br>$$<br>ÂΩ¢Âºè‰∏éÂπÇÁ∫ßÊï∞ÂæàÂÉèÔºå‰ΩÜËøôÈáå $x$ ‰Ωú‰∏∫‰∏Ä‰∏™Á¨¶Âè∑ËÄå‰∏çÁî®ÂÖ∑‰ΩìÊï∞ÂÄºÂ∏¶ËøõÂéªÁÆóÔºå‰πü‰∏çÁ†îÁ©∂ÊïõÊï£ÊÄß‰ªÄ‰πàÁöÑ</p><p>ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞ÁöÑÂä†Âáè‰πòÊ≥ï‰∏éÂ§öÈ°πÂºèÁöÑÊúâÁùÄÁ±ª‰ººÁöÑÂÆö‰πâ</p><p>ÂÆûÈôÖËøêÁÆóÊó∂‰∏ÄËà¨Âú® $\bmod{x^n}$ ÁöÑÊÑè‰πâ‰∏ãËøõË°åÔºåÂç≥‰ªÖÂèñÊ¨°Êï∞‰∏çË∂ÖËøá $n - 1$ ÁöÑÈ°π</p><h3 id="Á¨õÂç°ÂÑøÁßØ„ÄåÁõ¥ÁßØ„Äç"><a href="#Á¨õÂç°ÂÑøÁßØ„ÄåÁõ¥ÁßØ„Äç" class="headerlink" title="Á¨õÂç°ÂÑøÁßØ„ÄåÁõ¥ÁßØ„Äç"></a>Á¨õÂç°ÂÑøÁßØ„ÄåÁõ¥ÁßØ„Äç</h3><p>ÊúâÈõÜÂêà $A, B$ÔºåÂàô $A, B$ ÁöÑÁ¨õÂç°ÂÑøÁßØËÆ∞‰Ωú $A \times B$ÔºåÊòØÊâÄÊúâÂèØËÉΩÁªÑÊàêÁöÑÊúâÂ∫èÂØπÁöÑÈõÜÂêàÔºå‰∏îÂàÜÂà´‰∏∫ $A, B$ ÁöÑÊàêÂëòÔºåÂç≥ $A \times B = \{(a, b) | a \in A \land b \in B\}$</p><ul><li><p>Á¨õÂç°ÂÑøÁßØ‰∏ÄËà¨‰∏çÊª°Ë∂≥‰∫§Êç¢Âæã‰∏éÁªìÂêàÂæã</p></li><li><p>Á¨õÂç°ÂÑøÁßØÂØπÈõÜÂêàÁöÑÂπ∂Âíå‰∫§Êª°Ë∂≥ÂàÜÈÖçÂæã<br>$$<br>A \times (B \cup C) = (A \times B) \cup (A \times C) \\<br>A \times (B \cap C) = (A \times B) \cap (A \times C) \\<br>(A \times B) \cap (C \times D) = (A \cap C) \times (B \cap D)<br>$$</p></li></ul><h2 id="ÁîüÊàêÂáΩÊï∞‰∏éÁªÑÂêàËÆ°Êï∞"><a href="#ÁîüÊàêÂáΩÊï∞‰∏éÁªÑÂêàËÆ°Êï∞" class="headerlink" title="ÁîüÊàêÂáΩÊï∞‰∏éÁªÑÂêàËÆ°Êï∞"></a>ÁîüÊàêÂáΩÊï∞‰∏éÁªÑÂêàËÆ°Êï∞</h2><h3 id="ÁªÑÂêàÂØπË±°"><a href="#ÁªÑÂêàÂØπË±°" class="headerlink" title="ÁªÑÂêàÂØπË±°"></a>ÁªÑÂêàÂØπË±°</h3><p>Âú®ÁªÑÂêàËÆ°Êï∞ÈóÆÈ¢ò‰∏≠Ôºå‰∏ÄËà¨ÂÆö‰πâ‰∫Ü‰∏ÄÁ±ªÁªÑÂêàÂØπË±°ÔºåËØ•ÂØπË±°ÂèØËÉΩÊòØÊª°Ë∂≥Êüê‰∏ÄÊÄßË¥®ÁöÑÊ†ë„ÄÅÂõæÁ≠âÁöÑÈõÜÂêàÔºå‰∏î‰∏ÄÁ±ªÁªÑÂêàÂØπË±° $A$ ÂÖ∂‰∏≠ÁöÑÂØπË±° $a \in A$ ÊúâÂ§ßÂ∞è $size(a)$ÔºåÈÇ£‰πàÈÄöÂ∏∏ÁöÑËÆ°Êï∞‰ªªÂä°Âç≥‰∏∫Ê±ÇÂá∫ $A_n = (size (a) = n)$ ÁöÑÊï∞ÂÄº</p><p>ÁªÑÂêàÂØπË±°ÂàÜ‰∏∫ÊúâÊ†áÂè∑‰∏éÊó†Ê†áÂè∑ÔºåÂ∞±ÊØîÂ¶ÇÁªìÁÇπÊúâÊ†áÂè∑ÁöÑÊó†ÂêëÂõæ‰∏™Êï∞‰∏éÁªìÁÇπÊó†Ê†áÂè∑ÁöÑÊó†ÂêëÂõæ‰∏™Êï∞</p><p><strong>Ëøô‰∏ÄÈÉ®ÂàÜÈùûÂ∏∏ÈáçË¶ÅÔºåÂØπ‰∫éÈ¢òÁõÆÂøÖÈ°ªÂÖàÊòéÁ°ÆÁªÑÂêàÂØπË±°ÔºåÊâçÂèØ‰ª•ÈÄöËøá OGF Êàñ EGF ÁöÑÂÖ¨ÂºèÊù•ËøõË°åÊ±ÇËß£</strong></p><h3 id="ÊôÆÈÄöÁîüÊàêÂáΩÊï∞„ÄåOGF„Äç"><a href="#ÊôÆÈÄöÁîüÊàêÂáΩÊï∞„ÄåOGF„Äç" class="headerlink" title="ÊôÆÈÄöÁîüÊàêÂáΩÊï∞„ÄåOGF„Äç"></a>ÊôÆÈÄöÁîüÊàêÂáΩÊï∞„ÄåOGF„Äç</h3><p>Êï∞Âàó $A_0, A_1, A_2, ‚Ä¶$ ÁöÑ OGF ÂÆö‰πâ‰∏∫ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞<br>$$<br>A(x) = \sum\limits_{n = 0}^{\infty} A_nx^n<br>$$</p><p>ÂÖ∂‰∏≠Ôºå$A$ ÊòØ‰∏ÄÁ±ªÊó†Ê†áÂè∑ÂØπË±°Ôºå$A_n$ Ë°®Á§∫Êª°Ë∂≥ $size(a) = n$ ÁöÑÂØπË±° $a \in A$ ÁöÑÊï∞Èáè</p><p>ÊàñËÄÖÂèØ‰ª•Ëøô‰πàÁêÜËß£ÔºåÂØπ‰∫éÈõÜÂêà $A = \{A_0, A_1, A_2, ‚Ä¶\}$ÔºåÂÖ∂‰∏≠ $A_i$ ÁöÑÂá∫Áé∞ÈõÜÂêà‰∏∫ $M_i$ÔºåÈÇ£‰πà $A$ ÁöÑ OGF Âç≥‰∏∫ $\prod\limits_{n = 0}^{\infty} \left(\sum\limits_{m \in M_n} x^m\right)$</p><p>ËÄÉËôëÈõÜÂêà $A, B$ ÁöÑÁ¨õÂç°ÂÑøÁßØ $D = A \times B$ÔºåÂπ∂Êúâ $size(d) = size(a) + size(b)$ÔºåÈÇ£‰πàÊòæÁÑ∂<br>$$<br>D_k = \sum\limits_{i + j = k} A_iB_j<br>$$<br>ÂàôÊúâ<br>$$<br>D(x) = A(x)B(x)<br>$$</p><h4 id="ÁîüÊàêÂáΩÊï∞-frac-1-1-x-n"><a href="#ÁîüÊàêÂáΩÊï∞-frac-1-1-x-n" class="headerlink" title="ÁîüÊàêÂáΩÊï∞ $\frac{1}{(1 - x)^n}$"></a>ÁîüÊàêÂáΩÊï∞ $\frac{1}{(1 - x)^n}$</h4><p>ËøôÊòØ‰∏Ä‰∏™ÊØîËæÉÂ∏∏ËßÅÁöÑÁîüÊàêÂáΩÊï∞ÔºåÊé•‰∏ãÊù•ËØÅÊòéÂÆÉÁöÑÂéüÊï∞Âàó‰∏∫<br>$$<br>\sum\limits_{k = 0}^{\infty} \dbinom{k + n - 1}{n - 1} x^k<br>$$<br>Êúâ‰∏§ÁßçÊñπÊ≥ï</p><h5 id="ËØÅÊòéÊñπÊ≥ï‰∏Ä"><a href="#ËØÅÊòéÊñπÊ≥ï‰∏Ä" class="headerlink" title="ËØÅÊòéÊñπÊ≥ï‰∏Ä"></a>ËØÅÊòéÊñπÊ≥ï‰∏Ä</h5><p>È¶ñÂÖàÊòæÁÑ∂<br>$$<br>\frac{1}{(1 - x)^n} = \prod_{i = 1}^n\left(\sum\limits_{k = 0}^{\infty} x^k\right)<br>$$<br>ÈÇ£‰πà‰ΩøÁî®ÈöîÊùøÊ≥ïÂ∞±ÂèØ‰ª•Áõ¥Êé•ËØÅÊòé‰∫Ü</p><h5 id="ËØÅÊòéÊñπÊ≥ï‰∫å"><a href="#ËØÅÊòéÊñπÊ≥ï‰∫å" class="headerlink" title="ËØÅÊòéÊñπÊ≥ï‰∫å"></a>ËØÅÊòéÊñπÊ≥ï‰∫å</h5><ul><li>ÁªìËÆ∫ÔºöËã•Êï∞Âàó $a_0, a_1, a_2, ‚Ä¶$ ÁöÑ OGF ÊòØ $A(x)$Ôºå‰ª§ $s_n = \sum\limits_{i = 0}^n a_i$ÔºåÂàô $s_0, s_1, s_2, ‚Ä¶$ ÁöÑ OGF $B(x)$ ‰∏∫ $\frac{A(x)}{1 - x}$</li><li>ËØÅÊòéÔºöÊòæÁÑ∂ $B(x) = \sum\limits_{n = 0}^{\infty} x^nA(x)$ÔºåÂæóËØÅ</li></ul><p>ÈÇ£‰πàÂØπ‰∫é $\frac{1}{(1 - x)^n}$ ÁöÑÁ≥ªÊï∞Êù•ËÆ≤ÔºåÂÅáÂ¶ÇÊåâÁÖßÊã¨Âè∑È°∫Â∫èÂêàÂπ∂ÔºåÈÇ£‰πàÁ¨¨ $n$ È°πÁöÑÁ≥ªÊï∞Â∞±ÊòØÁ¨¨ $n - 1$ È°πÁöÑÁ≥ªÊï∞Âä†‰∏ä‰∏ä‰∏ÄÁâàÁöÑÁ¨¨ $n$ È°πÁ≥ªÊï∞ÔºåÂèàÂàùÂßãÁ≥ªÊï∞ÂÖ®ÈÉ®‰∏∫ $1$ÔºåÊâÄ‰ª•ËøôÂ∞±ÊòØÊù®Ëæâ‰∏âËßíÁöÑÈÄíÊé®ÂÖ≥Á≥ªÔºåÂæóËØÅ</p><h3 id="ÊåáÊï∞ÁîüÊàêÂáΩÊï∞„ÄåEGF„Äç"><a href="#ÊåáÊï∞ÁîüÊàêÂáΩÊï∞„ÄåEGF„Äç" class="headerlink" title="ÊåáÊï∞ÁîüÊàêÂáΩÊï∞„ÄåEGF„Äç"></a>ÊåáÊï∞ÁîüÊàêÂáΩÊï∞„ÄåEGF„Äç</h3><p>Êï∞Âàó $A_0, A_1, A_2, ‚Ä¶$ ÁöÑ EGF ÂÆö‰πâ‰∏∫ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞<br>$$<br>A(x) = \sum\limits_{n = 0}^{\infty} A_n\frac{x^n}{n!}<br>$$<br>ÂÖ∂‰∏≠Ôºå$A$ ÊòØ‰∏ÄÁ±ªÊúâÊ†áÂè∑ÂØπË±°Ôºå$A_n$ ÁöÑÊÑè‰πâÂêå OGF</p><p>OGF Ë°®Á§∫ÁöÑÊòØÂ∫èÂàóÔºåËÄå EGF Ë°®Á§∫ÁöÑÊòØÈõÜÂêàÔºåËÄåÈõÜÂêà‰∏çÂêå‰∫éÂ∫èÂàóÁöÑÂ∞±ÊòØÂÖ∂Ê≤°ÊúâÈ°∫Â∫èÂÖ≥Á≥ªÔºåÊïÖÈúÄÈô§‰ª• $n!$</p><p>Êç¢‰∏™Â±ÇÈù¢ÁêÜËß£ÔºåÂØπ‰∫éÂ§öÈáçÈõÜ $A = \{\infty \times A_0, \infty \times A_1, \infty \times A_2, ‚Ä¶\}$</p><p>È¶ñÂÖàÂ§öÈáçÈõÜÁöÑÊéíÂàóÊï∞‰∏∫ $\frac{n!}{n_0!n_1!n_2!‚Ä¶}$</p><p>ÂèàÂÖ∂‰∏≠ $A_i$ ÁöÑÂá∫Áé∞ÈõÜÂêà‰∏∫ $M_i$ÔºåÈÇ£‰πà $A$ ÁöÑ EGF Âç≥‰∏∫ $\prod\limits_{n = 0}^{\infty} \left(\sum\limits_{m \in M_n} \frac{x^m}{m!}\right)$</p><p>Ëøô‰∏™ÂºèÂ≠êÂíå‰∏äÈù¢ÈÇ£‰∏™ÂÆö‰πâÂºèÊòØ‰∏ÄÊ†∑ÁöÑ</p><p>ÂêåÊ†∑Âú∞ÔºåËÄÉËôëÊúâÊ†áÂè∑ÂØπË±°ÁöÑÊãºÊé•Ôºå‰ªé $A, B$ ‰∏≠ÂêÑÈÄâ $n, m$ ‰ª∂ÔºåÂõ†‰∏∫ÊòØÊúâÊ†áÂè∑ÁöÑÔºåÊâÄ‰ª•ÈúÄË¶Å‰ª§ÂÖ∂‰øùÊåÅÈ°∫Â∫èÔºåÊïÖÈÄâÊã©ÊñπÊ≥ïÂÖ±Êúâ<br>$$<br>\dbinom{n + m}{n}<br>$$<br>ÁßçÔºåÈÇ£‰πà<br>$$<br>\begin{aligned}<br>D_k &amp;= \sum\limits_{i + j = k} a_ib_j\frac{k!}{i!j!} \\<br>\frac{D_k}{k!} &amp;= \sum\limits_{i + j = k} \frac{a_i}{i!}\frac{b_j}{j!}<br>\end{aligned}<br>$$<br>ËØ¥Êòé<br>$$<br>\begin{aligned}<br>D(x) &amp;= \sum\limits_{k = 0}^{\infty}\left(\sum\limits_{i = 0}^{\infty} \dbinom{k}{i} a_ib_{k - i}\right)\frac{x^k}{k!} \\<br>&amp;= \sum\limits_{k = 0}^{\infty}\sum\limits_{i = 0}^{\infty} \frac{a_i}{i!}\frac{b_{k - i}}{(k - i)!} \\<br>&amp;= A(x)B(x)<br>\end{aligned}<br>$$</p><h3 id="Â§öÈ°πÂºèÊ±ÇÈÄÜ"><a href="#Â§öÈ°πÂºèÊ±ÇÈÄÜ" class="headerlink" title="Â§öÈ°πÂºèÊ±ÇÈÄÜ"></a>Â§öÈ°πÂºèÊ±ÇÈÄÜ</h3><p>ËØ•ÈÉ®ÂàÜËßÅ <a href="https://colythme.github.io/2020/07/01/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86/">Â§öÈ°πÂºèÊ±ÇÈÄÜ</a></p><h3 id="ÁîüÊàêÂáΩÊï∞Áõ∏ÂÖ≥Â∫îÁî®"><a href="#ÁîüÊàêÂáΩÊï∞Áõ∏ÂÖ≥Â∫îÁî®" class="headerlink" title="ÁîüÊàêÂáΩÊï∞Áõ∏ÂÖ≥Â∫îÁî®"></a>ÁîüÊàêÂáΩÊï∞Áõ∏ÂÖ≥Â∫îÁî®</h3><h4 id="OGF-Ê±Ç-Fibonacci-Êï∞ÂàóÈÄöÈ°π"><a href="#OGF-Ê±Ç-Fibonacci-Êï∞ÂàóÈÄöÈ°π" class="headerlink" title="OGF Ê±Ç $Fibonacci$ Êï∞ÂàóÈÄöÈ°π"></a>OGF Ê±Ç $Fibonacci$ Êï∞ÂàóÈÄöÈ°π</h4><p>ÂÆö‰πâ $Fibonacci$ Êï∞ÂàóÁöÑ OGF<br>$$<br>F(x) = \sum\limits_{n = 1}^{\infty} fibo_n x^n<br>$$<br>Âõ†‰∏∫ $Fibonacci$ Êï∞Âàó‰∏éÂÖ∂Âè≥Áßª‰∏Ä‰ΩçÁöÑ $Fibonacci$ Êï∞ÂàóÁöÑÂ∑ÆÊòØÂÖ∂Âè≥Áßª‰∏§‰ΩçÔºåÂæó<br>$$<br>\begin{aligned}<br>F(x) - xF(x) &amp;= x + x^2 \times F(x) \\<br>F(x) &amp;= \frac{x}{1 - x - x^2} \\<br>&amp;= \frac{x}{(1 - \frac{1 - \sqrt5}{2}x)(1 - \frac{1 + \sqrt5}{2}x)}<br>\end{aligned}<br>$$<br>Áé∞Âú®Ë¶ÅÂ∞ÜËØ•ÂºèË£ÇÈ°πÔºåÂÅáÂÆö $F(x) = \frac{x}{(x - x_1)(x - x_2)}$ÔºåÂàôË£ÇÈ°πÁªìÊûú‰∏∫ $\frac{t_1}{x - x_1} + \frac{t_2}{x - x_2}$ÔºåÈÄöÈ°πÔºåÂæó<br>$$<br>F(x) = \frac{t_1x - t_1x_2 + t_2x - t_2x_1}{(1 - x_1)(1 - x_2)}<br>$$<br>Áé∞Âú®Ê±ÇËß£ $t_ 1, t_2$ÔºåÊúâÊñπÁ®ãÁªÑ<br>$$<br>\begin{cases}<br>t_1 + t_2 = 1 \\<br>t_1x_1 + t_2x_2 = 0<br>\end{cases}<br>$$<br>Ëß£Âá∫ $t_1, t_2$ Âç≥ÂèØË£ÇÈ°πÔºåÂæó<br>$$<br>F(x) = -\frac{1}{\sqrt5}\frac{1}{1 - \frac{1 - \sqrt5}{2}x} + \frac{1}{\sqrt5}\frac{1}{1 - \frac{1 + \sqrt5}{2}x}<br>$$<br>Ê≥®ÊÑèÂºèÂ≠ê $\frac{1}{1 - \frac{1 - \sqrt5}{2}x}$ ÔºåËøôÂíåÂºèÂ≠ê $\sum\limits_{n = 0}^{\infty} x^n = \frac{1}{1 - x}$ÔºåÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂèØ‰ª•Áõ¥Êé•ËøòÂéü‰∏∫Êï∞ÂàóÔºåÊïÖ<br>$$<br>fibo_n = - \frac{1}{\sqrt5}\left(\frac{1 - \sqrt5}{2}\right)^n + \frac{1}{\sqrt5}\left(\frac{1 + \sqrt5}{2}\right)^n<br>$$</p><h4 id="ÁîüÊàêÂáΩÊï∞Ê±Ç‰ºØÂä™Âà©Êï∞"><a href="#ÁîüÊàêÂáΩÊï∞Ê±Ç‰ºØÂä™Âà©Êï∞" class="headerlink" title="ÁîüÊàêÂáΩÊï∞Ê±Ç‰ºØÂä™Âà©Êï∞"></a>ÁîüÊàêÂáΩÊï∞Ê±Ç‰ºØÂä™Âà©Êï∞</h4><h5 id="‰ºØÂä™Âà©Êï∞"><a href="#‰ºØÂä™Âà©Êï∞" class="headerlink" title="‰ºØÂä™Âà©Êï∞"></a>‰ºØÂä™Âà©Êï∞</h5><p>‰ºØÂä™Âà©Êï∞ÂàÜ‰∏∫‰∏§Á±ªÔºö</p><p>$B_n^-$ Ë°®Á§∫Á¨¨‰∏ÄÁ±ª‰ºØÂä™Âà©Êï∞Ôºå$B_n^+$ Ë°®Á§∫Á¨¨‰∫åÁ±ª‰ºØÂä™Âà©Êï∞ÔºåÂÆÉ‰ª¨ÁöÑÂ∑ÆÂà´Âú®‰∫éÁ¨¨‰∏ÄÈ°πÔºåÂàÜÂà´‰∏∫ $B_1^- = - \frac{1}{2}, B_1^+ = + \frac{1}{2}$</p><p>Âπ∂‰∏îÂØπ‰∫éÊâÄÊúâÂ§ß‰∫é $1$ ÁöÑÂ•áÊï∞ $n$ÔºåÂÖ∂‰ºØÂä™Âà©Êï∞ $B_n = 0$</p><p>Áé∞Âú®ÂÆö‰πâÁ≠âÂπÇÂíå<br>$$<br>S_m(n) = \sum\limits_{k = 1}^n k^m<br>$$<br>ËØ•ÂºèÊàê‰∏∫‰ºØÂä™Âà©Â§öÈ°πÂºèÔºåÂèòÈáè‰∏∫ $n$ÔºåÊ¨°Êï∞‰∏∫ $m$ÔºåÂèà<br>$$<br>S_m(n) = \frac{1}{m + 1}\sum\limits_{k = 0}^n \dbinom{m + 1}{k} B_k^+ n^{m + 1 - k}<br>$$<br>ËøôÂ∞±ÊòØ‰ºØÂä™Âà©Êï∞‰∏é‰ºØÂä™Âà©Â§öÈ°πÂºèÁöÑÂÖ≥Á≥ª</p><p>‰ºØÂä™Âà©Êï∞ÂèØ‰ª•ÈÄöËøáÈÄíÊé®ÂºèËÆ°ÁÆó<br>$$<br>\sum\limits_{j = 0}^m \dbinom{m + 1}{j} B_j = 0  (B_0 = 1)<br>$$<br>ÂÆÉËøòÂèØ‰ª•ÈÄöËøá EGF Ë°®Ëææ„ÄåËØÅÊòéÂç†Âùë„Äç<br>$$<br>\frac{x}{e^x - 1} = \sum\limits_{n = 0}^{\infty} B_n\frac{x^n}{n!}<br>$$</p><h5 id="‰πòÊ≥ïÈÄÜÂÖÉÊ±Ç‰ºØÂä™Âà©Êï∞"><a href="#‰πòÊ≥ïÈÄÜÂÖÉÊ±Ç‰ºØÂä™Âà©Êï∞" class="headerlink" title="‰πòÊ≥ïÈÄÜÂÖÉÊ±Ç‰ºØÂä™Âà©Êï∞"></a>‰πòÊ≥ïÈÄÜÂÖÉÊ±Ç‰ºØÂä™Âà©Êï∞</h5><p>$$<br>\begin{aligned}<br>\sum\limits_{n = 0}^{\infty} B_n\frac{x^n}{n!} &amp;= \frac{x}{e^x - 1} \\<br>&amp;= \frac{x}{\sum\limits_{n = 1}^{\infty} \frac{x^n}{n!}} \\<br>&amp;= \frac{1}{\left(\sum\limits_{n = 0}^{\infty} \frac{x^n}{(n + 1)!}\right)}<br>\end{aligned}<br>$$</p><p>ÈÇ£‰πàÊ±Ç‰∏ÄÊ¨°‰πòÊ≥ïÈÄÜÂÖÉÂç≥ÂèØ</p><h4 id="ÁîüÊàêÂáΩÊï∞‰ºòÂåñ-DP"><a href="#ÁîüÊàêÂáΩÊï∞‰ºòÂåñ-DP" class="headerlink" title="ÁîüÊàêÂáΩÊï∞‰ºòÂåñ $DP$"></a>ÁîüÊàêÂáΩÊï∞‰ºòÂåñ $DP$</h4><p>ÂÖàÁªôÂá∫‰∏ÄÈÅìÊù•Ëá™ËÆ∫ÊñáÁöÑ‰æãÈ¢ò</p><blockquote><p>Â≠óÁ¨¶ÈõÜÂ§ßÂ∞è‰∏∫ $m$„ÄÇÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $k$ ÁöÑÂ≠óÁ¨¶‰∏≤ $s$ÔºåÊ±ÇÂá∫ÊâÄÊúâÈïø‰∏∫ $n$ ÁöÑ‰∏≤‰∏≠Ôºå‰∏çÂåÖÂê´Â≠ê‰∏≤ $s$ ÁöÑÊúâÂ§öÂ∞ë‰∏™„ÄÇ$(n, m, k \le 10^5)$</p></blockquote><p>Áõ¥Êé• $DP$ ÂæàÂ•ΩÊÉ≥Ôºå‰ª§ $f_i$ Ë°®Á§∫Ââç $i$ ‰∏™‰ΩçÁΩÆÂ°´Â≠óÁ¨¶ÔºåÂπ∂‰∏îÁ¨¨‰∏ÄÊ¨°Êª°Ë∂≥ $substr[i - k + 1, i] = s$<br>$$<br>f_i = m^{i - k} - \sum\limits_{j = 1}^{i - k} f_jm^{i - j - k} - \sum\limits_{j \in Next} f_{i - j}<br>$$<br>Ê≥®ÊÑèÔºåÊ≠§Â§ÑÁöÑ $Next$ ÈõÜÂêàÂÆö‰πâ‰∏∫ $\{j \ge 0 | s[1, k - j] = s[j + 1, k]\}$Ôºå‰∏çÁÑ∂‰∏ãÈù¢‰∏çÂ•ΩËøõË°å‰ºòÂåñ</p><p>Êé•‰∏ãÊù•ÂØπ $DP$ ËøõË°å‰ºòÂåñ</p><p>ËÄÉËôëÁîüÊàêÂáΩÊï∞ $f(x) = \sum\limits_{n = 0}^{\infty} f_nx^n, N(x) = \sum\limits_{j \in Next} x^j$ÔºåÊ†πÊçÆ‰∏äÈù¢ÁöÑ $DP$ ÊñπÁ®ãÔºåÂèØ‰ª•ÂæóÂà∞<br>$$<br>f(x) = \frac{x^k}{1 - mx} + \frac{x^k}{1 - mx}f(x) + f(x)(N(x) - 1)<br>$$<br>ÂÖ∂‰∏≠ÔºåÁ¨¨‰∏ÄÈ°πÁõ¥Êé•Á≠âÊØîÊï∞ÂàóÊ±ÇÂíåÂç≥ÂèØÂæóÂà∞ÔºåËá≥‰∫é $2, 3$ È°πÔºå‰ºöÂèëÁé∞ËøôÂÆûÈôÖ‰∏äÂ∞±ÊòØ‰∏§‰∏™ÁîüÊàêÂáΩÊï∞Áõ∏‰πòÊØè‰∏ÄÈ°πÁöÑÁ≥ªÊï∞ÂèòÂåñÔºåÂπ∂‰∏îÊ≥®ÊÑèÊ≠§Êó∂ $N(x)$ ÈúÄÂáè $1$ÔºåÈò≤Ê≠¢ËÆ°ÁÆóÂà∞ $f_i$ÔºåÊïÖÂæóËØ•Ë°®Á§∫</p><p>ÂåñÁÆÄÔºåÂæó<br>$$<br>f(x) = \frac{x^k}{x^k + (1 - mx)N(x)}<br>$$</p><p>ÈÇ£‰πàÊúÄÁªàÁ≠îÊ°à‰∏∫ $g_n = m^n - \sum\limits_{j = 1}^n f_jm^{n - j}$ÔºåÂÖ∂ OGF $g(x)$ ‰∏∫<br>$$<br>\begin{aligned}<br>g(x) &amp;= \frac{1}{1 - mx} - \frac{1}{1 - mx}f(x) \\<br>&amp;= \frac{N(x)}{x^k + (1 - mx)N(x)}<br>\end{aligned}<br>$$<br>ÁÑ∂ÂêéÊää‰∏ãÈù¢ÈÇ£‰∏úË•ø‰πòÂá∫Êù•ÂåñÁÆÄ‰∏Ä‰∏ãÂ∞±ÂèàÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™Êñ∞ÁöÑÂ§öÈ°πÂºèÔºåÁÑ∂ÂêéÂ∞±ÂèØÁõ¥Êé•Ëß£‰∫Ü</p><p>Â§çÊùÇÂ∫¶ $O (n \log n)$</p><h3 id="ÂØπÊï∞‰∏éÊåáÊï∞ËøêÁÆó"><a href="#ÂØπÊï∞‰∏éÊåáÊï∞ËøêÁÆó" class="headerlink" title="ÂØπÊï∞‰∏éÊåáÊï∞ËøêÁÆó"></a>ÂØπÊï∞‰∏éÊåáÊï∞ËøêÁÆó</h3><h4 id="ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞ÁöÑÂ§çÂêàËøêÁÆó"><a href="#ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞ÁöÑÂ§çÂêàËøêÁÆó" class="headerlink" title="ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞ÁöÑÂ§çÂêàËøêÁÆó"></a>ÂΩ¢ÂºèÂπÇÁ∫ßÊï∞ÁöÑÂ§çÂêàËøêÁÆó</h4><p>ËÆæ $A(x) = \sum\limits_{i = 0}^{\infty} a_ix^i, B(x) = \sum\limits_{i = 1}^{\infty} b_ix^i$ÔºåÈÇ£‰πàÂÆÉ‰ª¨ÁöÑÂ§çÂêà‰∏∫<br>$$<br>C(x) = A(B(x)) = \sum\limits_{i = 0}^{\infty} a_i(B(x))^i<br>$$<br>ÊòæÁÑ∂ÊúÄÁªà $C(x)$ ÂèØ‰ª•ÂΩíÁ∫≥Êàê $C(x) = \sum\limits_{i = 0}^{\infty} c_ix^i$ ÁöÑÂΩ¢Âºè</p><p>Ê≥®ÊÑèÂõ†‰∏∫ $B(x)$ ÊòØÊ≤°ÊúâÂ∏∏Êï∞È°πÁöÑÔºåÊâÄ‰ª• $B(x)^i$ ÊòØ‰ªé $x^i$ Ëµ∑Ê≠•ÁöÑÔºåÊïÖ $B(x)$ ‰∏é $A(x)$ ÁöÑÂ§çÂêàÂèØ‰ª•ÂÆö‰πâ„ÄåÁåúÊµãÊòØËøôÊ†∑ÔºåÁúüÊ≠£ÂéüÂõ†Âç†Âùë„Äç</p><h4 id="ÂΩ¢ÂºèÂØºÊï∞"><a href="#ÂΩ¢ÂºèÂØºÊï∞" class="headerlink" title="ÂΩ¢ÂºèÂØºÊï∞"></a>ÂΩ¢ÂºèÂØºÊï∞</h4><p>ÂØπ‰∫é $A(x) = \sum\limits_{n = 0} ^{\infty} a_nx^n$ÔºåÂÆö‰πâÂÖ∂ÂΩ¢ÂºèÂØºÊï∞<br>$$<br>A‚Äô(x) = \sum\limits_{n = 1}^{\infty} na_nx^{n - 1}<br>$$<br>ÁªèËøáÈ™åËØÅÂèØÁü•<br>$$<br>\begin{matrix}<br>&amp;(cA(x))‚Äô = cA‚Äô(x) \\<br>&amp;(A(x) \pm B(x))‚Äô = A‚Äô(x) \pm B‚Äô(x) \\<br>&amp;(A(x)B(x))‚Äô = A‚Äô(x)B(x) + A(x)B‚Äô(x) \\<br>&amp;\left(\frac{1}{A(x)}\right) = - \frac{A‚Äô(x)}{A(x)^2} \\<br>&amp;(A(B(x))‚Äô = A‚Äô(B(x))B‚Äô(x)<br>\end{matrix}<br>$$<br>Ëøô‰∫õÂü∫Êú¨Ê±ÇÂØºÊ≥ïÂàôÂØπÂΩ¢ÂºèÂØºÊï∞‰ªçÁÑ∂ÊàêÁ´ã</p><h4 id="ÂèØÂæÆÂáΩÊï∞"><a href="#ÂèØÂæÆÂáΩÊï∞" class="headerlink" title="ÂèØÂæÆÂáΩÊï∞"></a>ÂèØÂæÆÂáΩÊï∞</h4><p>ÂèØÂæÆÂáΩÊï∞ÊåáÈÇ£‰∫õÂú®ÂÖ∂ÂÆö‰πâÂüü‰∏≠ÊâÄÊúâÁÇπÈÉΩÂ≠òÂú®ÂØºÊï∞ÁöÑÂáΩÊï∞ÔºåÂõ†Ê≠§ÔºåÂèØÂæÆÂáΩÊï∞ÁöÑÂõæÂÉè‰∏çÂ≠òÂú®‰ªª‰ΩïÈó¥Êñ≠ÁÇπ„ÄÅÂ∞ñÁÇπÊàñÊòØÊúâÂûÇÁõ¥ÂàáÁ∫øÁöÑÁÇπ</p><h4 id="Ê≥∞ÂãíÁ∫ßÊï∞"><a href="#Ê≥∞ÂãíÁ∫ßÊï∞" class="headerlink" title="Ê≥∞ÂãíÁ∫ßÊï∞"></a>Ê≥∞ÂãíÁ∫ßÊï∞</h4><p>ÂØπ‰∫é‰∏Ä‰∏™Âú®ÂÆûÊï∞ÊàñÂ§çÊï∞ $a$ ÈÇªÂüü‰∏äÔºå‰ª•ÂÆûÊï∞ÊàñÂ§çÊï∞‰Ωú‰∏∫ÂèòÈáèÔºåÂπ∂‰∏îÊòØÊó†Á©∑‰∏îÂèØÂæÆÁöÑÂáΩÊï∞ÔºåÂÖ∂Ê≥∞ÂãíÁ∫ßÊï∞ÂÆö‰πâ‰∏∫‰ª•‰∏ãÂΩ¢ÂºèÁöÑÂπÇÁ∫ßÊï∞<br>$$<br>\sum\limits_{n = 0}^{\infty} \frac{f^{(n)}(a)}{n!}(x - a)^n<br>$$<br>Â¶ÇÊûú $a = 0$ÔºåÈÇ£‰πàËØ•Á∫ßÊï∞‰∫¶Áß∞‰ΩúÈ∫¶ÂÖãÂä≥ÊûóÁ∫ßÊï∞</p><p>ÂÆûÈôÖ‰∏äËØ•Âºè‰πüÂ∞±ÊòØÊ≥∞ÂãíÂ±ïÂºÄÁöÑÂºèÂ≠êÔºåËØÅÊòéÔºö<a href="https://baike.baidu.com/item/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F/7681487?fr=aladdin" target="_blank" rel="noopener">Ê≥∞ÂãíÂ±ïÂºÄËØÅÊòé</a></p><h5 id="Â∏∏Áî®ÂáΩÊï∞ÁöÑÈ∫¶ÂÖãÂä≥ÊûóÂ∫èÂàó"><a href="#Â∏∏Áî®ÂáΩÊï∞ÁöÑÈ∫¶ÂÖãÂä≥ÊûóÂ∫èÂàó" class="headerlink" title="Â∏∏Áî®ÂáΩÊï∞ÁöÑÈ∫¶ÂÖãÂä≥ÊûóÂ∫èÂàó"></a>Â∏∏Áî®ÂáΩÊï∞ÁöÑÈ∫¶ÂÖãÂä≥ÊûóÂ∫èÂàó</h5><p>$$<br>\begin{matrix}<br>\frac{1} {1 - x} = \sum\limits_{n = 0}^{\infty} x^n ~ ~ ~ ~ \forall x \in (- 1, 1) \\\<br>e^x = \sum\limits_{n = 0}^{\infty} \frac{x^n} {n!}  ~ ~ ~ ~ \forall x \\\<br>\ln (1 + x) = \sum\limits_{n = 1}^{\infty} \frac{(- 1)^{n + 1} } {n}x^n ~ ~ ~ ~ \forall x \in (- 1, 1) \\\<br>\ln (1 - x) = - \sum\limits_{n = 1}^{\infty} \frac{x^i} {i}<br>\end{matrix}<br>$$</p><h4 id="ÂØπÊï∞ÂáΩÊï∞ÁöÑËÆ°ÁÆó"><a href="#ÂØπÊï∞ÂáΩÊï∞ÁöÑËÆ°ÁÆó" class="headerlink" title="ÂØπÊï∞ÂáΩÊï∞ÁöÑËÆ°ÁÆó"></a>ÂØπÊï∞ÂáΩÊï∞ÁöÑËÆ°ÁÆó</h4><p>ÁªôÂÆö $A(x) = 1 + \sum\limits_{n = 1}^{\infty} a_nx^n$ „ÄåÊ≠§Â§Ñ $+ 1$ ÊòØ‰∏∫‰∫Ü‰øùËØÅÂ§öÈ°πÂºèÊ±ÇÈÄÜÊúâËß£„Äç<br>$$<br>\begin{aligned}<br>B(x) &amp;= ln (A(x)) \\\<br>B‚Äô(x) &amp;= \frac{A(x)}{A‚Äô(x)} \\\<br>B(x) &amp;= \int \frac{A(x)}{A‚Äô(x)} \mathrm{d}x<br>\end{aligned}<br>$$<br>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log n)$</p><h4 id="ÊåáÊï∞ÂáΩÊï∞ÁöÑËÆ°ÁÆó"><a href="#ÊåáÊï∞ÂáΩÊï∞ÁöÑËÆ°ÁÆó" class="headerlink" title="ÊåáÊï∞ÂáΩÊï∞ÁöÑËÆ°ÁÆó"></a>ÊåáÊï∞ÂáΩÊï∞ÁöÑËÆ°ÁÆó</h4><p>ÁªôÂÆö $A(x) = \sum\limits_{i = 1}^{\infty} a_ix^i$Ôºå‰ª§<br>$$<br>B(x) = e^{A(x)}<br>$$<br>ÈÇ£‰πàÁªèËøáÂΩíÁ∫≥‰πãÂêéÂèØ‰ª•Ë°®Á§∫‰∏∫ $B(x) = \sum\limits_{i = 0}^{\infty} b_ix^i$</p><p>ÈÇ£‰πàÊé•‰∏ãÊù•ÁöÑ‰∫ãÊÉÖÂ∞±ÊòØË¶ÅËÆ°ÁÆóÁ≥ªÊï∞ $b_i$</p><p>ÊòæÁÑ∂ $b_0 = 1$ÔºåÈÇ£‰πàÊâ©Â±ïÔºåÂæó<br>$$<br>b_i = \frac{1}{i}\sum\limits_{k = 1}^i a_kb_{i - k}<br>$$<br>Êé•‰∏ãÊù•ËØÅÊòéËøô‰∏™ÁªìËÆ∫</p><h5 id="ËØÅÊòéÊñπÊ≥ï‰∏Ä-1"><a href="#ËØÅÊòéÊñπÊ≥ï‰∏Ä-1" class="headerlink" title="ËØÅÊòéÊñπÊ≥ï‰∏Ä"></a>ËØÅÊòéÊñπÊ≥ï‰∏Ä</h5><p>ÂÖà‰ªéÁÆÄÂçïÁöÑÂºÄÂßãÁúãËµ∑<br>$$<br>\begin{aligned}<br>&amp;b_1 = \frac{a_1}{1!} \\\<br>&amp;b_2 = \frac{a_2}{1!} + \frac{a_1 \times a_1}{2!} \\\<br>&amp;b_3 = \frac{a_3}{1!} + \frac{a_1 \times a_2 + a_2 \times a_1}{2!} + \frac{a_1 \times a_1 \times a_1}{3!}<br>\end{aligned}<br>$$<br>ÂØπ‰∫é $b_4$ ÂÖàÂè™Âàó‰∏æ‰∏Ä‰∏™Ôºö<br>$$<br>b_4 = ‚Ä¶ + \frac{a_1 \times a_1 \times a_2 + a_1 \times a_2 \times a_1 + a_2 \times a_1 \times a_1}{3!} + ‚Ä¶<br>$$<br>ÂèØ‰ª•ÂèëÁé∞ÔºåÁõ∏ÂΩì‰∫éÁé∞Âú®Â§ÑÁêÜÁöÑÈóÆÈ¢òÊòØÔºå‰ª§ $n = \sum\limits_{i = 1}^{total} m_ip_i$ÔºåÈÇ£‰πàÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™ÈõÜÂêà $\{m_1 \times p_1, m_2 \times p_2, ‚Ä¶\}$ÔºåÈÇ£‰πàË¶ÅÂ¶Ç‰ΩïÈÄöËøáÈõÜÂêà $\{\{m_1 \times p_1, ‚Ä¶, (m_i - 1) \times p_i, ‚Ä¶, m_{total} \times p_{total}\}(i = 1, 2, ‚Ä¶, total)\}$ ËΩ¨ÁßªÂà∞ËØ•ÈõÜÂêà</p><p>Áî±‰∫éÊúÄÁªàÂæóÂà∞ÁöÑ $a_{p_1}a_{p_2}a_{p_3}‚Ä¶$ Êó†ÂÖ≥Á¥ßË¶ÅÔºåÊïÖÂè™ËÄÉËôëÂÖ∂Á≥ªÊï∞</p><p>ÂÖàËÄÉËôëÊúÄÁªàÈúÄË¶ÅÁöÑÂÄº<br>$$<br>\begin{aligned}<br>final &amp;= \frac{\frac{m!}{m_1!m_2!m_3!‚Ä¶}}{m!} \\\<br>&amp;= \frac{1}{m_1!m_2!m_3!‚Ä¶}<br>\end{aligned}<br>$$<br>ÂØπ‰∫éÊØè‰∏™ $i$ÔºåÂÆπÊòìÁü•ÈÅìÂÆÉÁöÑË¥°ÁåÆ‰∏∫ $\frac{1}{m_1!‚Ä¶(m_i - 1)!‚Ä¶m_{total}!}$</p><p>Áé∞Âú®Âè™Êúâ $n$ ÂÖ≥‰∫é $m_i, p_i$ÔºåÁöÑÂÖ¨ÂºèÔºåËÄÉËôëÂ∞ÜÊØè‰∏™ $i$ ÁöÑË¥°ÁåÆ‰πò‰∏ä $p_i$ÔºåÊ±ÇÂíåÔºåÂàôÊúâ<br>$$<br>\frac{\sum\limits_i m_ip_i}{m_1!m_2!m_3!‚Ä¶} = \frac{n}{m_1!m_2!m_3!‚Ä¶}<br>$$<br>‰∏ä‰∏ãÂêåÈô§‰∏Ä‰∏™ $n$ Âç≥ÂèØÂæóËß£</p><p>Â•ΩÂÉèËøô‰∏™ËØÅÊòéÊúâÁÇπÈ∫ªÁÉ¶ÔºåÈÇ£‰πàËøòÊúâ‰∏Ä‰∏™</p><h5 id="ËØÅÊòéÊñπÊ≥ï‰∫å-1"><a href="#ËØÅÊòéÊñπÊ≥ï‰∫å-1" class="headerlink" title="ËØÅÊòéÊñπÊ≥ï‰∫å"></a>ËØÅÊòéÊñπÊ≥ï‰∫å</h5><p>‰∏§ËæπÊ±ÇÂØºÔºåÂæó<br>$$<br>B‚Äô(x) = A‚Äô(x)B(x)<br>$$<br>ÈÇ£‰πàÂ±ïÂºÄ‰∏Ä‰∏ãÂ∞±ÂæóÂà∞ËØ•Âºè‰∫Ü</p><p>ÈÇ£‰πàÊúâ‰∫ÜËøô‰∏™ÁªìËÆ∫‰πãÂêéÊ±Ç $b_i$ Áõ¥Êé•ÂàÜÊ≤ª $FFT$ Ëß£ÂÜ≥Âç≥ÂèØ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log^2 n)$</p><h4 id="ÁâõÈ°øËø≠‰ª£Ê≥ï"><a href="#ÁâõÈ°øËø≠‰ª£Ê≥ï" class="headerlink" title="ÁâõÈ°øËø≠‰ª£Ê≥ï"></a>ÁâõÈ°øËø≠‰ª£Ê≥ï</h4><p>ÁªôÂÆö $g(x)$ÔºåÊ±ÇËß£ $f(x)$<br>$$<br>g(f(x)) = 0<br>$$<br>ÂÅáËÆæÂ∑≤ÁªèÂ§ÑÁêÜÂá∫ $f(x)$ ÁöÑÂâç $n$ È°π $f_0(x)$ÔºåÂàôÊúâ<br>$$<br>\begin{aligned}<br>f(x) &amp;\equiv f_0(x) &amp;\pmod{x^n} \\\<br>f(x) - f_0(x) &amp;\equiv 0 &amp;\pmod{x^n} \\\<br>(f(x) - f_0(x))^2 &amp;\equiv 0 &amp;\pmod{x^{2n}}<br>\end{aligned}<br>$$<br>ÈÇ£‰πàÂ∞Ü $g(f(x))$ Ê≥∞ÂãíÂ±ïÂºÄÔºåÂæó<br>$$<br>\begin{aligned}<br>0 &amp;= g(f(x)) \\\<br>&amp;= \sum\limits_{n = 0}^{\infty} \frac{g^{(n)}(f_0(x))}{n!}(f(x) - f_0(x))^n \\\<br>&amp;\equiv g(f_0(x)) + g‚Äô(f_0(x))(f(x) - f_0(x)) \pmod{x^{2n}} \\\<br>f(x) &amp;\equiv f_0(x) - \frac{g(f_0(x))}{g‚Äô(f_0(x))} \pmod{x^{2n}}<br>\end{aligned}<br>$$<br>ÈÇ£‰πàÂ∞±ÂèØ‰ª• $O (n \log n)$ Ê±ÇËß£ $f(x)$ ‰∫Ü</p><h5 id="ÁâõÈ°øËø≠‰ª£Ê≥ïËÆ°ÁÆóÊåáÊï∞ÂáΩÊï∞"><a href="#ÁâõÈ°øËø≠‰ª£Ê≥ïËÆ°ÁÆóÊåáÊï∞ÂáΩÊï∞" class="headerlink" title="ÁâõÈ°øËø≠‰ª£Ê≥ïËÆ°ÁÆóÊåáÊï∞ÂáΩÊï∞"></a>ÁâõÈ°øËø≠‰ª£Ê≥ïËÆ°ÁÆóÊåáÊï∞ÂáΩÊï∞</h5><p>ÁªôÂÆö $A(x) = \sum\limits_{i = 1}^{\infty} a_ix^i$ÔºåÊ±ÇËß£ $e^{A(x)}$</p><p>‰ª§ $g(x) = \ln (x) - A(x)$ÔºåÂàôÊúâ<br>$$<br>\begin{aligned}<br>f(x) &amp;= f_0(x) - \frac{\ln (f_0(x)) - A(x)}{\frac{1}{f_0(x)}} \\<br>&amp;= f_0(x)\left(1 - \ln (f_0(x)) + A(x)\right)<br>\end{aligned}<br>$$</p><h4 id="ÁâõÈ°øËø≠‰ª£Ê≥ïËÆ°ÁÆó-k-Ê¨°ÂπÇ"><a href="#ÁâõÈ°øËø≠‰ª£Ê≥ïËÆ°ÁÆó-k-Ê¨°ÂπÇ" class="headerlink" title="ÁâõÈ°øËø≠‰ª£Ê≥ïËÆ°ÁÆó $k$ Ê¨°ÂπÇ"></a>ÁâõÈ°øËø≠‰ª£Ê≥ïËÆ°ÁÆó $k$ Ê¨°ÂπÇ</h4><p>ÁªôÂÆöÂ§öÈ°πÂºè $A(x) = \sum\limits_{i = 0}^n a_ix^i$ ÂèäÊ≠£Êï¥Êï∞ $k$ÔºåÊ±ÇËß£ $A(x)^k$</p><p>Áõ¥Êé•Âø´ÈÄüÂπÇÂ§çÊùÇÂ∫¶ $O (n \log^2 n)$ÔºåÂ§çÊùÇÂ∫¶ËæÉÈ´ò</p><p>Êé•‰∏ãÊù•ËÆ®ËÆ∫Ôºö</p><p>Ëã• $A(x)$ Â∏∏Êï∞È°π‰∏∫ $1$ÔºåÂàô<br>$$<br>A(x)^k = e^{k \ln A(x)}<br>$$<br>Ëã• $A(x)$ Â∏∏Êï∞È°π‰∏ç‰∏∫ $1$ÔºåÂàôËøõË°åËΩ¨Âåñ</p><p>ËÆæ $A(x)$ ÂæóÊúÄ‰ΩéÊ¨°È°π‰∏∫ $a_tx^t$ÔºåËΩ¨Âåñ‰∏∫Â∏∏Êï∞È°π‰∏∫ $1$ÔºåÂç≥<br>$$<br>A(x)^k = a_t^kx^{kt}\left(\frac{A(x)}{a_tx^t}\right)^k<br>$$<br>ÂêåÊ†∑ÁâõÈ°øËø≠‰ª£Ê≥ïÂç≥ÂèØ</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log n)$</p><h3 id="ÁªÑÂêàËÆ°Êï∞"><a href="#ÁªÑÂêàËÆ°Êï∞" class="headerlink" title="ÁªÑÂêàËÆ°Êï∞"></a>ÁªÑÂêàËÆ°Êï∞</h3><h4 id="Â∫èÂàóËÆ°Êï∞"><a href="#Â∫èÂàóËÆ°Êï∞" class="headerlink" title="Â∫èÂàóËÆ°Êï∞"></a>Â∫èÂàóËÆ°Êï∞</h4><p>Êúâ‰∏ÄÁ±ªÁªÑÂêàÂØπË±° $A$Ôºå$A$ ÁöÑÂÖÉÁ¥†ÂèØ‰ª•ÁªÑÊàêÂ∫èÂàó„ÄåÊúÄÁÆÄÂçïÁöÑ‰æãÂ≠êÂ∞±ÊòØÁî± $\{n_1 \times l_1, n_2 \times l_2, ‚Ä¶\}$ ËøôÊ†∑ÁöÑÈïøÂ∫¶ÈõÜÂêàÊãºÊàêÈïøÂ∫¶‰∏∫ $k (k = 1, 2, ‚Ä¶)$ ÁöÑÊñπÊ°àÊï∞ÊâÄÊûÑÊàêÁöÑÂ∫èÂàó„ÄçÔºåÂàôËøô‰∫õÂ∫èÂàóÂÆö‰πâ‰∫ÜÊñ∞ÁöÑ‰∏ÄÁ±ªÁªÑÂêàÂØπË±° $B$ÔºåÂç≥<br>$$<br>B(x) = \sum\limits_{k = 0}^{\infty} A(x)^k = \frac{1}{1 - A(x)}<br>$$<br>ËØ•ÁªìËÆ∫ÂØπÊúâÊó†Ê†áÂè∑ÈÉΩÊàêÁ´ã</p><h4 id="ÈõÜÂêàËÆ°Êï∞"><a href="#ÈõÜÂêàËÆ°Êï∞" class="headerlink" title="ÈõÜÂêàËÆ°Êï∞"></a>ÈõÜÂêàËÆ°Êï∞</h4><h5 id="ÊúâÊ†áÂè∑ÁöÑÈõÜÂêàËÆ°Êï∞"><a href="#ÊúâÊ†áÂè∑ÁöÑÈõÜÂêàËÆ°Êï∞" class="headerlink" title="ÊúâÊ†áÂè∑ÁöÑÈõÜÂêàËÆ°Êï∞"></a>ÊúâÊ†áÂè∑ÁöÑÈõÜÂêàËÆ°Êï∞</h5><p>ÈõÜÂêà‰∏éÂ∫èÂàóÁöÑÂå∫Âà´Âú®‰∫éÂÖÉÁ¥†Ê≤°ÊúâÈ°∫Â∫èÔºåÊïÖÈúÄÂéªÈô§ÈáçÂ§çÁöÑÔºåÂàô<br>$$<br>B(x) = \sum\limits_{n = 0}^{\infty} \frac{A(x)^n}{n!} = e^{A(x)}<br>$$</p><h6 id="ÊúâÊ†áÂè∑ÁöÑËøûÈÄöÂõæËÆ°Êï∞"><a href="#ÊúâÊ†áÂè∑ÁöÑËøûÈÄöÂõæËÆ°Êï∞" class="headerlink" title="ÊúâÊ†áÂè∑ÁöÑËøûÈÄöÂõæËÆ°Êï∞"></a>ÊúâÊ†áÂè∑ÁöÑËøûÈÄöÂõæËÆ°Êï∞</h6><p>ËÆæ $G$ ÊòØÊâÄÊúâÁÆÄÂçïËøûÈÄöÂõæÔºåÂàôÂÖ∂ EGF ‰∏∫<br>$$<br>G(x) = \sum\limits_{n = 0}^{\infty} 2^{\frac{n(n - 1)}{2}}\frac{x^n}{n!}<br>$$<br>ÂèØ‰ª•Â∞ÜÊâÄÊúâÁÆÄÂçïËøûÈÄöÂõæÁúã‰ΩúËøûÈÄöÂàÜÈáè„ÄåÂÖ∂ÈõÜÂêà‰∏∫ $C(x)$„ÄçÁöÑÈõÜÂêàÔºåÊïÖ<br>$$<br>\begin{aligned}<br>G(x) &amp;= e^{C(x)} \\<br>C(x) &amp;= \ln G(x)<br>\end{aligned}<br>$$<br>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log n)$</p><h5 id="Êó†Ê†áÂè∑ÁöÑÈõÜÂêàËÆ°Êï∞"><a href="#Êó†Ê†áÂè∑ÁöÑÈõÜÂêàËÆ°Êï∞" class="headerlink" title="Êó†Ê†áÂè∑ÁöÑÈõÜÂêàËÆ°Êï∞"></a>Êó†Ê†áÂè∑ÁöÑÈõÜÂêàËÆ°Êï∞</h5><h6 id="ÂÆåÂÖ®ËÉåÂåÖËÆ°Êï∞"><a href="#ÂÆåÂÖ®ËÉåÂåÖËÆ°Êï∞" class="headerlink" title="ÂÆåÂÖ®ËÉåÂåÖËÆ°Êï∞"></a>ÂÆåÂÖ®ËÉåÂåÖËÆ°Êï∞</h6><blockquote><p>‰ΩìÁßØ‰∏∫ $i$ ÁöÑÊúâ $a_i$ Áßç‰∏çÂêåÁöÑÁâ©ÂìÅÔºåÊØèÁßçÁâ©ÂìÅÊúâÊó†Èôê‰∏™ÔºåÈÇ£‰πàÊúÄÁªàË£ÖÊª°‰ΩìÁßØ‰∏∫ $V$ ÁöÑËÉåÂåÖÁöÑÊñπÊ°àÊï∞</p></blockquote><p>ÊòæÁÑ∂Á≠îÊ°à‰∏∫<br>$$<br>\begin{aligned}<br>Ans &amp;= \prod_{i = 1}^n\left(\sum\limits_{j = 0}x^{ij}\right)^{a_i} \\<br>&amp;= \prod_{i = 1}^n\left(\frac{1}{1 - x^i}\right)^{a_i} \\<br>\end{aligned}<br>$$</p><p>Êé•‰∏ãÊù•Áî®ÂØπÊï∞ÂáΩÊï∞Âåñ‰πò‰∏∫Âä†<br>$$<br>\begin{aligned}<br>Ans &amp;= \exp (\sum\limits_{i = 1}^n \ln \left(\left(\frac{1}{1 - x^i}\right)^{a_i}\right)) \\<br>&amp;= \exp (- \sum\limits_{i = 1}^n a_i\ln(1 - x^i)) \\<br>&amp;= \exp (\sum\limits_{i = 1}^na_i\left(\sum\limits_{n = 1}^{\infty} \frac{x^{in}}{n}\right)) \\<br>\end{aligned}<br>$$<br>Êé•‰∏ãÊù•‰ª§ $A(x) = \sum\limits_{i = 1}^{\infty} a_ix^i$ÔºåÊç¢‰∏∫Êûö‰∏æ $n$ÔºåÂæó<br>$$<br>Ans = \exp (\sum\limits_{n = 1}^{\infty} \frac{1}{n}A(x^n))<br>$$<br>ÈÇ£‰πàÊó∂Èó¥Â§çÊùÇÂ∫¶ÁöÑËÆ°ÁÆóÂ∞±ÊòØË∞ÉÂíåÁ∫ßÊï∞ÔºåÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log n)$</p><h4 id="ÁéØÁöÑËÆ°Êï∞"><a href="#ÁéØÁöÑËÆ°Êï∞" class="headerlink" title="ÁéØÁöÑËÆ°Êï∞"></a>ÁéØÁöÑËÆ°Êï∞</h4><h5 id="ÊúâÊ†áÂè∑ÁöÑÁéØÁöÑËÆ°Êï∞"><a href="#ÊúâÊ†áÂè∑ÁöÑÁéØÁöÑËÆ°Êï∞" class="headerlink" title="ÊúâÊ†áÂè∑ÁöÑÁéØÁöÑËÆ°Êï∞"></a>ÊúâÊ†áÂè∑ÁöÑÁéØÁöÑËÆ°Êï∞</h5><h6 id="ÂúÜÊéíÂàóÈóÆÈ¢ò"><a href="#ÂúÜÊéíÂàóÈóÆÈ¢ò" class="headerlink" title="ÂúÜÊéíÂàóÈóÆÈ¢ò"></a>ÂúÜÊéíÂàóÈóÆÈ¢ò</h6><blockquote><p>‰ªé $n$ ‰∏™ÂÖÉÁ¥†‰∏≠‰∏çÈáçÂ§çÂú∞ÂèñÂá∫ $m$ ‰∏™ÂÖÉÁ¥†Âú®‰∏Ä‰∏™ÂúÜÂë®‰∏äÔºåÂπ∂‰∏îÊØè‰∏™ÊéíÂàóÁªèËøáÊóãËΩ¨Âêé‰∏ç‰ºö‰∏éÂÖ∂ÂÆÉ‰ªªÊÑè‰∏Ä‰∏™ÊéíÂàóÁõ∏ÂêåÔºåÂè´ÂÅöËøô $n$ ‰∏™ÂÖÉÁ¥†ÁöÑÂúÜÊéíÂàó</p></blockquote><p>ÊòæÁÑ∂ $n$ ‰∏™ÂÖÉÁ¥†Âèñ $m$ ‰∏™‰ΩúÂúÜÊéíÂàóÁöÑÊñπÊ°àÊï∞‰∏∫<br>$$<br>total = \frac{A_n^m}{m}<br>$$<br>ÈÇ£‰πàÔºåÂØπ‰∫é‰∏ÄÁ±ªÁªÑÂêàÂØπË±° $A$ÔºåÂÖ∂ÂúÜÊéíÂàóÁöÑÁîüÊàêÂáΩÊï∞‰∏∫<br>$$<br>\sum\limits_{k = 1}^{\infty} \frac{A(x)^k}{k} = - \ln (1 - A(x))<br>$$</p><h6 id="ÊúâÊ†áÂè∑ÁöÑÊó†ÂêëËøûÈÄöÂõæ‰∏≠ÁöÑÂü∫ÁéØÊ†ë‰∏™Êï∞ËÆ°Êï∞"><a href="#ÊúâÊ†áÂè∑ÁöÑÊó†ÂêëËøûÈÄöÂõæ‰∏≠ÁöÑÂü∫ÁéØÊ†ë‰∏™Êï∞ËÆ°Êï∞" class="headerlink" title="ÊúâÊ†áÂè∑ÁöÑÊó†ÂêëËøûÈÄöÂõæ‰∏≠ÁöÑÂü∫ÁéØÊ†ë‰∏™Êï∞ËÆ°Êï∞"></a>ÊúâÊ†áÂè∑ÁöÑÊó†ÂêëËøûÈÄöÂõæ‰∏≠ÁöÑÂü∫ÁéØÊ†ë‰∏™Êï∞ËÆ°Êï∞</h6><p>ËÄÉËôëÂ∞ÜÂü∫ÁéØÊ†ëÊãÜÂàÜ‰∏∫Ëã•Âπ≤Ê£µÊ†ëÁöÑÊãºÂáë</p><p>Ê≥®ÊÑèÊ≠§Êó∂ÈúÄËÄÉËôëÁöÑÊòØÊúâÊ†πÊ†ëÔºåÂç≥ÂÖàÂ∞ÜËäÇÁÇπÁúã‰ΩúÁªÑÂêàÂØπË±°ÔºåÊ†πÊçÆ $Cayley$ ÂÆöÁêÜÔºå$n$ ‰∏™ËäÇÁÇπÁöÑÂÆåÂÖ®ÂõæÊúâ $n^{n - 1}$ Ê£µÊúâÊ†πÊ†ëÔºåÂàôÊúâÊ†πÊ†ëÁöÑ EGF $T(x)$ ‰∏∫<br>$$<br>T(x) = \sum\limits_{n = 1}^{\infty} n^{n - 1}\frac{x^n}{n!}<br>$$<br>ÈÇ£‰πàÊ≠§Êó∂Â∞ÜÊúâÊ†πÊ†ëÁúã‰ΩúÁªÑÂêàÂØπË±°ÔºåÂàôÂ∞ÜÂÆÉ‰ª¨ÁªÑÊàêÁéØÔºåÂç≥Âü∫ÁéØÊ†ëÁöÑ EGF $G(x)$ ‰∏∫<br>$$<br>\begin{aligned}<br>G(x) &amp;= \frac{1}{2}\sum\limits_{n = 3}^{\infty} \frac{T(x)^k}{k} \\<br>&amp;= - \frac{1}{2}\ln (1 - T(x)) - \sum\limits_{k = 1}^2 \frac{T(x)^k}{k}<br>\end{aligned}<br>$$</p><h5 id="Êó†Ê†áÂè∑ÁöÑÁéØÁöÑËÆ°Êï∞"><a href="#Êó†Ê†áÂè∑ÁöÑÁéØÁöÑËÆ°Êï∞" class="headerlink" title="Êó†Ê†áÂè∑ÁöÑÁéØÁöÑËÆ°Êï∞"></a>Êó†Ê†áÂè∑ÁöÑÁéØÁöÑËÆ°Êï∞</h5><p>„ÄåÁî±‰∫éÈúÄË¶ÅÁæ§ËÆ∫Áü•ËØÜÔºåÊïÖÁïôÂùë„Äç</p><p>„Äå‰ª•‰∏ãÁïôÂùë„Äç</p>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁªÑÂêàÊï∞Â≠¶ </tag>
            
            <tag> ÁîüÊàêÂáΩÊï∞ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éËé´ÊØî‰πåÊñØÂèçÊºî</title>
      <link href="/2020/08/04/%E7%8B%84%E5%88%A9%E5%85%8B%E9%9B%B7%E5%8D%B7%E7%A7%AF%E4%B8%8E%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
      <url>/2020/08/04/%E7%8B%84%E5%88%A9%E5%85%8B%E9%9B%B7%E5%8D%B7%E7%A7%AF%E4%B8%8E%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Ê¶ÇÂøµÂºïÂÖ•"><a href="#Ê¶ÇÂøµÂºïÂÖ•" class="headerlink" title="Ê¶ÇÂøµÂºïÂÖ•"></a>Ê¶ÇÂøµÂºïÂÖ•</h2><h3 id="Êï∞ËÆ∫ÂáΩÊï∞"><a href="#Êï∞ËÆ∫ÂáΩÊï∞" class="headerlink" title="Êï∞ËÆ∫ÂáΩÊï∞"></a>Êï∞ËÆ∫ÂáΩÊï∞</h3><p>„ÄÄ„ÄÄ„ÄÄ„ÄÄÊåáÂÆö‰πâÂüü‰∏∫Ê≠£Êï¥Êï∞ÁöÑÂáΩÊï∞<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂÆö‰πâÂÖ∂Âä†Ê≥ï‰∏∫ÈÄêÈ°πÁõ∏Âä†ÔºåÂç≥$(f + g)(n) = f(n) + g(n)$<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂÆö‰πâÂÖ∂Êï∞‰πò‰∏∫ÈÄêÈ°πÁõ∏‰πòÔºåÂç≥$(xf)(n) = x √ó f(n)$</p><h3 id="Âçï‰ΩçÂÖÉ"><a href="#Âçï‰ΩçÂÖÉ" class="headerlink" title="Âçï‰ΩçÂÖÉ"></a>Âçï‰ΩçÂÖÉ</h3><p>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂçï‰ΩçÂÖÉÊòØÈõÜÂêà‰∏≠‰∏ÄÁßçÁâπÂà´ÁöÑÂÖÉÁ¥†ÔºåÂΩìÂçï‰ΩçÂÖÉ‰∏éÂÖ∂ÂÆÉÂÖÉÁ¥†Áõ∏ÁªìÂêàÊó∂Ôºå‰∏ç‰ºöÊîπÂèòÂÖ∂ÂÆÉÂÖÉÁ¥†ÁöÑÂÄº</p><h3 id="ÈÄÜÂÖÉ"><a href="#ÈÄÜÂÖÉ" class="headerlink" title="ÈÄÜÂÖÉ"></a>ÈÄÜÂÖÉ</h3><p>„ÄÄ„ÄÄ„ÄÄ„ÄÄÈÄÜÂÖÉÊòØÊåáÂèØ‰ª•ÂèñÊ∂àÂè¶‰∏ÄÁªôÂÆöÂÖÉÁ¥†ËøêÁÆóÁöÑÂÖÉÁ¥†ÔºåÂç≥Â∞ÜÂÖ∂ÂèòÂõûÂçï‰ΩçÂÖÉ</p><h3 id="Á¨¶Âè∑Ë°®Á§∫"><a href="#Á¨¶Âè∑Ë°®Á§∫" class="headerlink" title="Á¨¶Âè∑Ë°®Á§∫"></a>Á¨¶Âè∑Ë°®Á§∫</h3><p>„ÄÄ„ÄÄ„ÄÄ„ÄÄ$[A]$Ë°®Á§∫Êù°‰ª∂$A$ÊòØÂê¶‰∏∫Áúü<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÊ≠§Â§ÑÁöÑÁ¨¶Âè∑‚Äù$*$‚ÄùË°®Á§∫ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ</p><h2 id="ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ"><a href="#ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ" class="headerlink" title="ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ"></a>ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ</h2><p>„ÄÄ„ÄÄ‰ª§$t(n) = f(n) * g(n)$ÔºåÂàô„ÄÄ„ÄÄ</p><p>$$<br>t(n) = \sum\limits_{i | n} f(i)g(\frac{n}{i})<br>$$</p><p>„ÄÄ„ÄÄÈÇ£‰πàÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØÊòæÁÑ∂Êúâ‰∏ãÈù¢Âá†‰∏™ÊÄßË¥®Ôºö</p><h3 id="Êª°Ë∂≥‰πòÊ≥ï‰∫§Êç¢Âæã„ÄÅÁªìÂêàÂæã„ÄÅÂàÜÈÖçÂæã"><a href="#Êª°Ë∂≥‰πòÊ≥ï‰∫§Êç¢Âæã„ÄÅÁªìÂêàÂæã„ÄÅÂàÜÈÖçÂæã" class="headerlink" title="Êª°Ë∂≥‰πòÊ≥ï‰∫§Êç¢Âæã„ÄÅÁªìÂêàÂæã„ÄÅÂàÜÈÖçÂæã"></a>Êª°Ë∂≥‰πòÊ≥ï‰∫§Êç¢Âæã„ÄÅÁªìÂêàÂæã„ÄÅÂàÜÈÖçÂæã</h3><ul><li>ÂØπ‰∫éÂçï‰ΩçÂÖÉ$\epsilon(n) = [n = 1]$ÔºåÊª°Ë∂≥$\epsilon(n)*f(n) = f(n)$<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄ- ÂØπ‰∫éÊØè‰∏Ä‰∏™$f(1) \ne 1$ÁöÑÊï∞ËÆ∫ÂáΩÊï∞$f(n)$ÔºåÁöÜÂ≠òÂú®ÂÖ∂ÈÄÜÂÖÉ$f^{- 1}(n)$ÔºåÊª°Ë∂≥$f(n) * f^{- 1}(n) = \epsilon(n)$ÔºåÈÇ£‰πàÂØπ‰∫éËøô‰∏™ÁªìËÆ∫ÔºåÂèØ‰ª•‰ª§$f^{- 1}(n) = \frac{1}{f(1)}\left(\epsilon(n) - \sum\limits_{i | n, i \ne 1} f(i)f^{- 1}(\frac{n}{i})\right)$ÔºåÂÜç‰ª£ÂõûÂéüÂºèÔºåÊª°Ë∂≥Êù°‰ª∂</li></ul><h3 id="ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éÁßØÊÄßÂáΩÊï∞"><a href="#ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éÁßØÊÄßÂáΩÊï∞" class="headerlink" title="ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éÁßØÊÄßÂáΩÊï∞"></a>ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éÁßØÊÄßÂáΩÊï∞</h3><h3 id="ÁßØÊÄßÂáΩÊï∞"><a href="#ÁßØÊÄßÂáΩÊï∞" class="headerlink" title="ÁßØÊÄßÂáΩÊï∞"></a>ÁßØÊÄßÂáΩÊï∞</h3><p>„ÄÄ„ÄÄ„ÄÄ„ÄÄÁßØÊÄßÂáΩÊï∞Êª°Ë∂≥ÂΩì$(n, m) = 1$ÔºåÊúâ$f(nm) = f(n)f(m)$</p><h3 id="Áõ∏ÂÖ≥ÊÄßË¥®"><a href="#Áõ∏ÂÖ≥ÊÄßË¥®" class="headerlink" title="Áõ∏ÂÖ≥ÊÄßË¥®"></a>Áõ∏ÂÖ≥ÊÄßË¥®</h3><ul><li><p>Ëã•$(n, m) = 1,  d | nm$ÔºåÂàôÂøÖÂÆöÂ≠òÂú®$a | n,  b | m$‰∏îÊª°Ë∂≥$ab = d$ÔºåËØÅÊòéÊòæÁÑ∂</p></li><li><p>Ëã•$(n, m) = 1,  a | n,  b | m$ÔºåÂàôÊúâ$(a, b) = 1$ÔºåËØÅÊòéÊòæÁÑ∂</p></li></ul><p>‚Äã       ËøôÊ†∑ÁöÑËØùÔºåÂ∞±ÊúâÊÄßË¥®Ôºö‰∏§‰∏™ÁßØÊÄßÂáΩÊï∞ÁöÑÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰ªçÊòØÁßØÊÄßÂáΩÊï∞ÔºåËØÅÊòéÔºö<br>„ÄÄ„ÄÄËã•$(n, m) = 1$ÔºåÂàôÊúâ<br>$$<br>\begin{aligned}<br>t(nm) &amp;= \sum\limits_{i | nm} f(i)g(\frac{nm}{i}) \\<br>&amp;= \sum\limits_{a | n, b | m} f(ab)g(\frac{nm}{ab}) \\<br>&amp;= \sum\limits_{a | n, b | m} f(a)f(b)g(\frac{n}{a})g(\frac{m}{b}) \\<br>&amp;= t(n) * t(m)<br>\end{aligned}<br>$$</p><p>„ÄÄ„ÄÄÂè¶Â§ñ‰∏Ä‰∏™ÊÄßË¥®ÔºåÂ∞±ÊòØ‰∏§‰∏™ÁßØÊÄßÂáΩÊï∞ÁöÑÈÄÜÂÖÉ‰ªçÊòØÁßØÊÄßÂáΩÊï∞ÔºåÊòØÁî®Êï∞Â≠¶ÂΩíÁ∫≥Ê≥ïËØÅÊòéÔºö<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄ‰ª§$(n, m) = 1$ÔºåÂΩì$nm = 1$Êó∂ÔºåÁªìËÆ∫ÊòæÁÑ∂ÊàêÁ´ã<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂΩì$nm &gt; 1$‰∏î$n_1m_1 &lt; nm$Êó∂$n_1m_1$ÁªìËÆ∫ÊàêÁ´ãÔºåÂÜçÂÅáËÆæ$nm$Êó∂ÁªìËÆ∫ÊàêÁ´ãÔºåÂàôÊúâÔºàÊ≥®ÊÑèÔºåÁßØÊÄßÂáΩÊï∞‰∏≠‰∏ÄÂÆöÊª°Ë∂≥$f(1) = 1$Ôºâ<br>$$<br>\begin{aligned} f^{- 1}(nm) &amp;= - \sum\limits_{i | nm, i \ne 1} f(i)f^{- 1}(\frac{nm}{i}) \\ &amp;= - \sum\limits_{a | n, b | m, ab \ne 1} f(a)f(b)f^{- 1}(\frac{n}{a})f^{- 1}(\frac{m}{b}) \\ &amp;= f(1)f(1)f^{- 1}(n)f^{- 1}(m) - \sum\limits_{a | n, b | m, ab \ne 1} f(a)f(b)f^{- 1}(\frac{n}{a})f^{- 1}(\frac{m}{b}) \\ &amp;= f^{- 1}(n)f^{- 1}(m) - \epsilon(n)\epsilon(m) \\ &amp;= f^{- 1}(n)f^{- 1}(m) \end{aligned}<br>$$<br>„ÄÄ„ÄÄÊ≥®ÔºöÁßØÊÄßÂáΩÊï∞$f(1) = 1$</p><h3 id="ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éËé´ÊØî‰πåÊñØÂèçÊºî"><a href="#ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éËé´ÊØî‰πåÊñØÂèçÊºî" class="headerlink" title="ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éËé´ÊØî‰πåÊñØÂèçÊºî"></a>ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éËé´ÊØî‰πåÊñØÂèçÊºî</h3><p>„ÄÄ„ÄÄ‰ª§$\mu$Ë°®Á§∫$1$Âú®ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØÊÑè‰πâ‰∏ãÁöÑÈÄÜÂÖÉÔºå‰ª§$g = f * 1$ÔºåÂàôÊúâ$f = f * 1 * \mu = g * \mu$ÔºåÂÜç‰ª§$g(n) = \sum\limits_{d | n} f(d)$ÔºåÂàôÊúâ</p><p>$$<br>f(n) = g(n) * \mu(n) = \sum\limits_{d | n} g(d)\mu(\frac{n}{d})<br>$$<br>„ÄÄ„ÄÄËøôÂ∞±ÊòØËé´ÊØî‰πåÊñØÂèçÊºîÁöÑÂºèÂ≠ê‰∫Ü<br>„ÄÄ„ÄÄÈÇ£‰πàÂØπ‰∫éÂáΩÊï∞$\mu(n)$ÔºåÁî±‰∫é$1$ÊòØÁßØÊÄßÂáΩÊï∞ÔºåÂàô$\mu$‰πüÊòØÁßØÊÄßÂáΩÊï∞ÔºåÂèàÊòìÁü•Ôºà‰ª£ÂõûÂéüÂºèÂ∞±Â•Ω‰∫ÜÔºâ<br>$$<br>\mu(p^k) = \left\{\begin{aligned} 1     k = 0 \\ - 1     k = 1 \\ 0     k &gt; 1 \end{aligned}\right.<br>$$<br>„ÄÄ„ÄÄÈÇ£‰πàÁî±ÁßØÊÄßÂáΩÊï∞ÔºåÂèØÂæó<br>„ÄÄ„ÄÄ- Ëã•$n = p_1p_2‚Ä¶p_k$‰∏î$p_1 \ne p_2 \ne ‚Ä¶ \ne p_k$ÔºåÂàôÊúâ</p><p>$$<br>\mu(n) = (- 1)^k<br>$$</p><p>„ÄÄ„ÄÄ- Ëã•$p_k^r | n (r &gt; 1)$ÔºåÂàôÊúâ</p><p>$$<br>\mu(n) = 0<br>$$</p><p>„ÄÄ„ÄÄÈÇ£‰πàÁßØÊÄßÁ≠õÂç≥ÂèØ</p><h4 id="Âè¶ÈôÑ"><a href="#Âè¶ÈôÑ" class="headerlink" title="Âè¶ÈôÑ"></a>Âè¶ÈôÑ</h4><p>„ÄÄ„ÄÄËé´ÊØî‰πåÊñØÂèçÊºîÁöÑÂè¶‰∏ÄÁßçÂΩ¢ÂºèÔºåÊúâ</p><p>$$<br>g(n) = \sum\limits_{n | d}f(d)<br>$$<br>„ÄÄ„ÄÄÂàôÊúâ</p><p>$$<br>f(n) = \sum\limits_{n | d} \mu(\frac{d}{n})g(d)<br>$$</p>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ëé´ÊØî‰πåÊñØÂèçÊºî </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ê¥õË∞∑3768 - ÁÆÄÂçïÁöÑÊï∞Â≠¶È¢ò</title>
      <link href="/2020/08/04/%E6%B4%9B%E8%B0%B7%203768%20-%20%E7%AE%80%E5%8D%95%E7%9A%84%E6%95%B0%E5%AD%A6%E9%A2%98/"/>
      <url>/2020/08/04/%E6%B4%9B%E8%B0%B7%203768%20-%20%E7%AE%80%E5%8D%95%E7%9A%84%E6%95%B0%E5%AD%A6%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Ê†πÊçÆ<a href="https://www.cnblogs.com/Colythme/p/10275893.html" target="_blank" rel="noopener">CrashÁöÑÊï∞Â≠óË°®Ê†º</a>ÔºåÂæàÂÆπÊòìÂèØ‰ª•Â∞ÜÂºèÂ≠êÂåñÁÆÄ‰∏∫<br>$$<br>\begin{aligned} Ans &amp;= \sum\limits_{i = 1}^n \sum\limits_{j = 1} ij(i, j) \\ &amp;= \sum\limits_{d = 1}^n d^3 \sum\limits_{k = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(k) k^2 \left( \sum\limits_{i = 1}^{\left\lfloor\frac{n}{kd}\right\rfloor} i \right)^2 \end{aligned}<br>$$<br>ÊÑüËßâ $d, k$ ÊîæÂú®‰∏ÄËµ∑ÂºèÂ≠êÊó†Ê≥ïÁªßÁª≠ÂåñÁÆÄÔºå‰∏ªË¶ÅÊòØÊúâ $kd$ Â≠òÂú®ÔºåÊïÖ‰ª§ $T = kd$ ÔºåÂàôÊúâ<br>$$<br>Ans = \sum\limits_{T = 1}^n \left( \sum\limits_{i = 1}^{\left\lfloor\frac{n}{T}\right\rfloor} i \right)^2 T^2 \sum\limits_{d | T} d \mu(\frac{T}{d})<br>$$<br>ÈÇ£‰πàËÄÉËôëÊï¥Èô§ÂàÜÂùóÔºåÁé∞Âú®ÈúÄË¶ÅÂ§ÑÁêÜÁöÑÊòØÂêéÂçäÈÉ®ÂàÜ</p><p>ÈÄöËøáËßÇÂØüÔºàÁúãÈ¢òËß£ÔºâÂèØ‰ª•ÂèëÁé∞Ôºå $\sum\limits_{d | T} d \mu(\frac{T}{d})$ ÂèØ‰ª•ÁúãÊàê $\mu * id$ ÔºåÊïÖÂèØÊõøÊç¢Êàê $\phi(T)$ ÔºåÂàôÊúâ<br>$$<br>Ans = \sum\limits_{T = 1}^n \left( \sum\limits_{i = 1}^{\left\lfloor\frac{n}{T}\right\rfloor} i \right)^2 T^2 \phi(T)<br>$$<br>Áé∞Âú®ËÄÉËôëÂ∞Ü $T^2 \phi(T)$ ÈÉ®ÂàÜÁî®ÊùúÊïôÁ≠õËß£ÂÜ≥<br>$$<br>h(n) = \sum\limits_{d | n} d^2 \phi(d) g(\frac{n}{d})<br>$$<br>‰∏∫‰∫ÜÊ∂àÈô§ $d^2$ Ôºå‰ª§ $g(\frac{n}{d}) = n^2$ ÔºåÂàôÊúâ<br>$$<br>h(n) = n^3<br>$$<br>ÊïÖÂæó<br>$$<br>S(n) = \sum\limits_{i = 1}^n i^3 - \sum\limits_{d = 2}^n d^2 S(\left\lfloor\frac{n}{d}\right\rfloor)<br>$$<br>ÂèàÔºàÈÄöËøáÁúãÈ¢òËß£ÔºâÊúâ‰∏Ä‰∏™Áü•ËØÜÁÇπ<br>$$<br>\sum\limits_{i = 1}^n i^3 = \left( \sum\limits_{i = 1}^n i \right)<br>$$<br>ÈÇ£‰πàÂ∞±ÂèØ‰ª•Áõ¥Êé•ÊùúÊïôÁ≠õ‰∫Ü</p><p>Ëá≥‰∫éÂ§çÊùÇÂ∫¶ÔºåÂ∞ÜÊúÄÂ§ñÂõ¥ÁöÑÊï¥Èô§ÂàÜÂùó‰∏éÊùúÊïôÁ≠õÁúã‰∏∫‰∏Ä‰ΩìÔºåÊïÖÂ§çÊùÇÂ∫¶‰∏∫ $O (n^{\frac{2}{3}})$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">6e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL MOD, N;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">LL inv2, inv6;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN];</span><br><span class="line"><span class="keyword">int</span> vis[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> pcnt = <span class="number">0</span>;</span><br><span class="line">LL phi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumphi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> MAX = <span class="number">6e06</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linear_sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! vis[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">phi[i] = i - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j])) &#123;</span><br><span class="line">phi[i * prime[j]] = phi[i] * <span class="number">1l</span>l * prime[j] % MOD;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">phi[i * prime[j]] = phi[i] * <span class="number">1l</span>l * (prime[j] - <span class="number">1</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++)</span><br><span class="line">sumphi[i] = (sumphi[i - <span class="number">1</span>] + <span class="number">1l</span>l * i % MOD * <span class="number">1l</span>l * i % MOD * phi[i] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tr1::<span class="built_in">unordered_map</span>&lt;LL, LL&gt; maphi;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">sqr</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x * x % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">eqm</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (n + <span class="number">1</span>) % MOD * (n % MOD) % MOD * (<span class="number">2</span> * n % MOD + <span class="number">1</span>) % MOD * inv6 % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">oseqm</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> n % MOD * ((n + <span class="number">1</span>) % MOD) % MOD * inv2 % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">phi_sieve</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX)</span><br><span class="line"><span class="keyword">return</span> sumphi[n];</span><br><span class="line"><span class="keyword">if</span> (maphi[n])</span><br><span class="line"><span class="keyword">return</span> maphi[n];</span><br><span class="line">LL total = sqr (oseqm (n));</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">total = (total - (eqm (r) - eqm (l - <span class="number">1</span>) + MOD) % MOD * phi_sieve (n / l) % MOD + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maphi[n] = total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">Solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">1</span>, r; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = N / (N / l);</span><br><span class="line">ans = (ans + sqr (oseqm (N / l)) * ((phi_sieve (r) - phi_sieve (l - <span class="number">1</span>) + MOD) % MOD) % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%lld%lld"</span>, &amp; MOD, &amp; N);</span><br><span class="line">inv2 = power (<span class="number">2l</span>l, MOD - <span class="number">2</span>), inv6 = power (<span class="number">6l</span>l, MOD - <span class="number">2</span>);</span><br><span class="line">MAX = (<span class="keyword">int</span>) min (<span class="number">1l</span>l * MAX, N), linear_sieve ();</span><br><span class="line">LL ans = Solve ();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">998244353 2000</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1000000007 9786510294</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ëé´ÊØî‰πåÊñØÂèçÊºî </tag>
            
            <tag> ÊùúÊïôÁ≠õ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ê¥õË∞∑3676 - Â∞èÊ∏ÖÊñ∞Êï∞ÊçÆÁªìÊûÑÈ¢ò</title>
      <link href="/2020/08/04/%E6%B4%9B%E8%B0%B7%203676%20-%20%E5%B0%8F%E6%B8%85%E6%96%B0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E9%A2%98/"/>
      <url>/2020/08/04/%E6%B4%9B%E8%B0%B7%203676%20-%20%E5%B0%8F%E6%B8%85%E6%96%B0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ËØ¥ÂÆûËØùËøôÈ¢òÂÜôÊ†ëÂâñ $LCT$ ‰ªÄ‰πàÁöÑÁúüÁöÑÊÄùÊÉ≥Âèà‰∏çÈöæÂèàÂ•ΩÂÆûÁé∞ÁöÑÊ†∑Â≠êÔºå‰ΩÜÊòØÊàëËøòÊòØÈÄâÊã©Ëá™ËôêÈÄâÊã©‰∫ÜÂä®ÊÄÅÁÇπÂàÜÊ≤ª</p><p>ÈÇ£Â∞±‰∏§ÁßçÂÅöÊ≥ïÈÉΩÁ®çÂæÆÊèê‰∏Ä‰∏ãÔºö</p><h3 id="Ê†ëÈìæÂâñÂàÜ-LCT"><a href="#Ê†ëÈìæÂâñÂàÜ-LCT" class="headerlink" title="Ê†ëÈìæÂâñÂàÜ / $LCT$"></a>Ê†ëÈìæÂâñÂàÜ / $LCT$</h3><p>ÂæàÂÆπÊòìÂèØ‰ª•ÂèëÁé∞‰∏Ä‰∏™Êç¢Ê†πÊìç‰ΩúÂè™‰ºöÂØπÂΩìÂâçÊ†πÂú®ÂéüÊ†ëÔºàÊ†π‰∏∫ $1$ Ôºâ‰∏äÁöÑÁ•ñÂÖà‰∏ÄÊù°ÈìæÈÄ†ÊàêÂΩ±ÂìçÔºå‰πüÂ∞±ÊòØÂ∞ÜÂÆÉ‰ª¨ÁöÑÂ≠êÊ†ëÂèòÊàêÈô§ÂΩìÂâçÈìæÊñπÂêëÂÖ∂ÂÆÉ‰∏é‰πãÁõ∏ËøûÁöÑÁÇπÈõÜÔºåÈÇ£‰πàÁî®Ê†ëÂâñË∑≥ÔºåÁî®Á∫øÊÆµÊ†ëÁª¥Êä§‰∏Ä‰∏ãÂéüÊ†ë‰∏ä‰ªé‰∏äÈù¢Êù•ÁöÑÂíå‰ªé‰∏ãÈù¢Êù•ÁöÑÔºåÂÜçÂ∞ÜÊâÄÊúâÊ∂âÂèäÁöÑËäÇÁÇπÂêàÂπ∂ÔºåÂπ∂‰∏îÂà†ÂéªÁÆóÈáçÂ§çÁöÑÂíå‰∏çËØ•ÁÆóÁöÑÂç≥ÂèØÔºàËôΩÁÑ∂ÊàëÊ≤°ÂÆûÁé∞‰ΩÜÊòØËøô‰∏™ÊÄùË∑ØÂ∫îËØ•ÊòØÂØπÁöÑ</p><h3 id="Âä®ÊÄÅÁÇπÂàÜÊ≤ª"><a href="#Âä®ÊÄÅÁÇπÂàÜÊ≤ª" class="headerlink" title="Âä®ÊÄÅÁÇπÂàÜÊ≤ª"></a>Âä®ÊÄÅÁÇπÂàÜÊ≤ª</h3><p>È¶ñÂÖàÊúâ‰∏§ÁØáÂçöÂÆ¢Ôºö<a href="https://www.luogu.org/blog/user4134/solution-p3676" target="_blank" rel="noopener">zzq</a>„ÄÅ<a href="http://www.cnblogs.com/zhoushuyu/p/8309410.html" target="_blank" rel="noopener">ÁßüÈÖ•Èõ®</a></p><p>Âõ†‰∏∫Êàë‰ª¨Ë¶ÅÁÆó $\sum\limits_{i = 1}^n s_i^2$ ÔºåÂèØ‰ª•ÂÖàÊÉ≥‰∏Ä‰∏ã $\sum\limits_{i = 1}^n s_i$ ÊÄé‰πàÁÆóÔºåÂõ†‰∏∫ÊØè‰∏™ÁÇπÁöÑË¥°ÁåÆÂè™‰ºöË¢´Á•ñÂÖàËÆ°ÁÆóÂà∞ÔºåÈÇ£‰πàÊòìÁü• $\sum\limits_{i = 1}^n s_i = \sum\limits_{i = 1}^n value_i * (depth_i + 1)$ ÔºåËøô‰∏™Áõ¥Êé•Áî®Âä®ÊÄÅÁÇπÂàÜÊ≤ªÁª¥Êä§‰∏â‰∏™ÂèòÈáè $sumo_i, sumt_i, sumfa_i$ Ôºàsumo -&gt; $p$ Â≠êËäÇÁÇπÊùÉÂÄº‰πãÂíå,  $sumt$ -&gt; Â≠êËäÇÁÇπÊùÉÂÄº‰∏éË∑ùÁ¶ªÁöÑ‰πòÁßØÂà∞ $p$ ‰πãÂíå,  $sumfa$ -&gt; Â≠êËäÇÁÇπÊùÉÂÄº‰∏éË∑ùÁ¶ªÁöÑ‰πòÁßØÂà∞ $fa$ ÔºàÁÇπÂàÜÊ†ë‰∏äÔºâ‰πãÂíåÔºâÂç≥ÂèØÂæóÂà∞</p><p>Êé•‰∏ãÊù•Êúâ‰∏™ÂæàÈáçË¶ÅÁöÑÁªìËÆ∫ÔºàÂèçÊ≠£ÊàëÊòØËÇØÂÆöÊÉ≥‰∏çÂà∞</p><p>‚Äã    - ‰∏çËÆ∫Ê†πÂ¶Ç‰ΩïÊç¢Ôºå $\sum\limits_{i = 1}^n s_i (sum - s_i)$ ‰∏ÄÂÆöÊòØ‰∏Ä‰∏™ÂÆöÂÄºÔºàËØ¥ÂÆûËØù‰∏ÄÂºÄÂßã‰∏ÄÁõ¥ÊÉ≥ÁùÄÂ¶Ç‰ΩïÂåñÁÆÄ $\sum\limits_{i = 1}^n s_i$ ÔºåÊâÄ‰ª•ÊòØÁúüÁöÑÊ≤°ÊúâÊÉ≥Âà∞ÂèØ‰ª•ÈÄöËøáÊûÑÈÄ†ÂÆöÂÄºÁöÑÊñπÊ≥ïÊù•Ëß£Âá∫ $\sum\limits_{i = 1}^n s_i^2$ Ôºâ</p><p>ÂÖàÊù•ÊÑè‰ºö‰∏Ä‰∏ãËøô‰∏™ÁªìËÆ∫ÔºöÂ∞±ÊòØÊØè‰∏ÄÊù°ËæπËøûÊé•ÁöÑ‰∏§‰∏™ÁÇπÂú®‰ªñ‰ª¨ÁöÑÂ≠êÊ†ë‰∏≠ÂêÑËá™ÈÄâ‰∏§‰∏™ÁÇπËÆ©ÂÆÉ‰ª¨ÊùÉÂÄºÁõ∏‰πòÔºåÊ±ÇÊÄªÊùÉÂÄº</p><p>ÈÇ£‰πàÂ∞±ÊØîËæÉÂÆπÊòìÁü•ÈÅìËØÅÊòé‰∫ÜÔºöÊØèÊù°ËæπÁöÑËæπÊùÉ‰∏∫ÊâÄÊúâÂØπÂ∫îË∑ØÂæÑÁªèËøáËøôÊù°ËæπÁöÑ‰∏§‰∏™ÁÇπÁöÑÊùÉÂÄºÂíåÔºåÊ±ÇÊÄªËæπÊùÉÔºåÂç≥Ê±ÇÁöÑÊòØ $\sum\limits_{i = 1}^n \sum\limits_{j = 1}^n value_i * value_j * dist (i, j)$ ÔºåÊâÄ‰ª•Êúâ $\sum\limits_{i = 1}^n s_i (sum - s_i) = \sum\limits_{i = 1}^n \sum\limits_{j = 1}^n value_i * value_j * dist (i, j)$</p><p>Âõ†‰∏∫ËØ•ÂºèÊòØ‰∏™ÂÆöÂÄºÔºåÊâÄ‰ª•Ê±ÇÂá∫ $\sum\limits_{i = 1}^n s_i$ ÂêéÁõ¥Êé•Ëß£Âá∫ $Ans$ Â∞±ÂÆåÊàê‰∫ÜÊü•ËØ¢Êìç‰Ωú</p><p>ÂØπ‰∫é‰øÆÊîπÊìç‰ΩúÔºåËã•‰øÆÊîπÂÆåÂêé‰∏éÂéüÊùÉÂÄºÁöÑÂ∑ÆÂÄº‰∏∫ $\Delta value$ ÔºåÈÇ£‰πà $\Delta total = \Delta value \sum\limits_{j = 1}^n value_j * dist (p, j)$ Ôºà $p$ ‰∏∫‰øÆÊîπÁÇπÔºâ</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    Link[++ size].to = v;</span><br><span class="line">    Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">    Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, Q;</span><br><span class="line"><span class="keyword">int</span> value[MAXN];</span><br><span class="line"></span><br><span class="line">LL Deep[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Dfn[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> val[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;, belong[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> dfsord = <span class="number">0</span>;</span><br><span class="line">LL sum = <span class="number">0</span>;</span><br><span class="line">LL subtree[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL s1 = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    Dfn[root] = ++ dfsord;</span><br><span class="line">    val[dfsord] = Deep[root], belong[dfsord] = root;</span><br><span class="line">    sum += value[root];</span><br><span class="line">    subtree[root] = value[root];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Deep[v] = Deep[root] + <span class="number">1</span>;</span><br><span class="line">        DFS (v, root);</span><br><span class="line">        val[++ dfsord] = Deep[root], belong[dfsord] = root;</span><br><span class="line">        subtree[root] += subtree[v];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">25</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dfsord; i ++)</span><br><span class="line">        ST[i][<span class="number">0</span>] = make_pair (val[i], belong[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">20</span>; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= dfsord; i ++)</span><br><span class="line">            ST[i][j] = ST[i][j - <span class="number">1</span>].first &lt; ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>].first ? ST[i][j - <span class="number">1</span>] : ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> L = Dfn[x], R = Dfn[y];</span><br><span class="line">    <span class="keyword">if</span> (L &gt; R)</span><br><span class="line">        swap (L, R);</span><br><span class="line">    <span class="keyword">int</span> k = log2 (R - L + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ST[L][k].first &lt; ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].first ? ST[L][k].second : ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].second;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">dist</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lca = LCA (x, y);</span><br><span class="line">    <span class="keyword">return</span> Deep[x] + Deep[y] - (Deep[lca] &lt;&lt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> Vis[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Size[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> minv = INF, grvy;</span><br><span class="line"><span class="keyword">int</span> total;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Grvy_Acqu</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    Size[root] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa || Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Grvy_Acqu (v, root);</span><br><span class="line">        Size[root] += Size[v];</span><br><span class="line">        maxpart = max (maxpart, Size[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    maxpart = max (maxpart, total - Size[root]);</span><br><span class="line">    <span class="keyword">if</span> (maxpart &lt; minv)</span><br><span class="line">        minv = maxpart, grvy = root;</span><br><span class="line">&#125;</span><br><span class="line">LL sumo[MAXN]= &#123;<span class="number">0</span>&#125;, sumt[MAXN]= &#123;<span class="number">0</span>&#125;, sumfa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">// sumo -&gt; pÂ≠êËäÇÁÇπÊùÉÂÄº‰πãÂíå, sumt -&gt; Â≠êËäÇÁÇπÊùÉÂÄº‰∏éË∑ùÁ¶ªÁöÑ‰πòÁßØÂà∞p‰πãÂíå, sumfa -&gt; Â≠êËäÇÁÇπÊùÉÂÄº‰∏éË∑ùÁ¶ªÁöÑ‰πòÁßØÂà∞fa(ÁÇπÂàÜÊ†ë‰∏ä)‰πãÂíå</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sums_Acqu</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    sumo[grvy] += value[root], sumt[grvy] += value[root] * dist (root, grvy);</span><br><span class="line">    <span class="keyword">if</span> (father[grvy])</span><br><span class="line">        sumfa[grvy] += value[root] * dist (root, father[grvy]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i =    Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa || Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        sums_Acqu (v, root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">point_DAC</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> pre)</span> </span>&#123;</span><br><span class="line">    minv = INF, grvy = p, total = Size[p];</span><br><span class="line">    Grvy_Acqu (p, <span class="number">0</span>);</span><br><span class="line">    Vis[grvy] = <span class="literal">true</span>, father[grvy] = pre;</span><br><span class="line">    sums_Acqu (grvy, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> fgrvy = grvy;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[fgrvy]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        point_DAC (v, fgrvy);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    LL tsum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> p = op; p; p = father[p]) &#123;</span><br><span class="line">        tsum += sumt[p];</span><br><span class="line">        <span class="keyword">if</span> (p != op)</span><br><span class="line">            tsum += sumo[p] * dist (p, op);</span><br><span class="line">        <span class="keyword">if</span> (father[p])</span><br><span class="line">            tsum -= sumo[p] * dist (father[p], op) + sumfa[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tsum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Modify</span> <span class="params">(<span class="keyword">int</span> op, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> p = op; p; p = father[p]) &#123;</span><br><span class="line">        sumo[p] -= value[op] - delta;</span><br><span class="line">        sumt[p] -= value[op] * dist (p, op) - delta * dist (p, op);</span><br><span class="line">        <span class="keyword">if</span> (father[p])</span><br><span class="line">            sumfa[p] -= value[op] * dist (father[p], op) - delta * dist (father[p], op);</span><br><span class="line">    &#125;</span><br><span class="line">    sum -= value[op] - delta;</span><br><span class="line">    LL s = Query (op);</span><br><span class="line">    s1 += (delta - value[op]) * s;</span><br><span class="line">    value[op] = delta;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">int</span> isneg = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>)</span><br><span class="line">            isneg = <span class="number">1</span>;</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), Q = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">        Insert (u, v), Insert (v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        value[i] = getnum ();</span><br><span class="line">    DFS (<span class="number">1</span>, <span class="number">0</span>), RMQ ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        s1 += subtree[i] * (sum - subtree[i]);</span><br><span class="line">    Size[<span class="number">1</span>] = N, point_DAC (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">/*cout &lt;&lt; "Next----------------------" &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    for (int i = 1; i &lt;= N; i ++)</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; sumo[i] &lt;&lt; ' ' &lt;&lt; sumt[i] &lt;&lt; ' ' &lt;&lt; sumfa[i] &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; "End-----------------------" &lt;&lt; endl;*/</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= Q; Case ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> opt = getnum ();</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> p = getnum (), delta = getnum ();</span><br><span class="line">            Modify (p, delta);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> p = getnum ();</span><br><span class="line">            LL ans = (Query (p) + sum) * sum - s1;</span><br><span class="line">            <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">4 3 2 1</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">1 1 3</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">1 2 4</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 1</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">4 3 2 1</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Âä®ÊÄÅÁÇπÂàÜÊ≤ª </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ê†πÂè∑ÁÆóÊ≥ïÁõ∏ÂÖ≥</title>
      <link href="/2020/08/04/%E6%A0%B9%E5%8F%B7%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/"/>
      <url>/2020/08/04/%E6%A0%B9%E5%8F%B7%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Ê†ë‰∏äËé´Èòü"><a href="#Ê†ë‰∏äËé´Èòü" class="headerlink" title="Ê†ë‰∏äËé´Èòü"></a>Ê†ë‰∏äËé´Èòü</h2><p>È¶ñÂÖàÊúâ‰∏ÄÈÅìÈ¢ò</p><h3 id="ÁéãÂÆ§ËÅîÈÇ¶"><a href="#ÁéãÂÆ§ËÅîÈÇ¶" class="headerlink" title="ÁéãÂÆ§ËÅîÈÇ¶"></a>ÁéãÂÆ§ËÅîÈÇ¶</h3><h4 id="È¢òÁõÆÂ§ßÊÑè"><a href="#È¢òÁõÆÂ§ßÊÑè" class="headerlink" title="È¢òÁõÆÂ§ßÊÑè"></a>È¢òÁõÆÂ§ßÊÑè</h4><p>ÁªôÂÆö‰∏ÄÊ£µÊ†ëÔºåÂ∞ÜÊ†ëÂàÜ‰∏∫Â§ßÂ∞èËåÉÂõ¥‰∏∫ $[B, 3B]$ ÁöÑËøûÈÄöÂùóÈõÜÔºåÊ±ÇÊñπÊ°à</p><h4 id="Ê†ë‰∏äÂàÜÂùóÊñπÊ≥ï‰πã‰∏Ä"><a href="#Ê†ë‰∏äÂàÜÂùóÊñπÊ≥ï‰πã‰∏Ä" class="headerlink" title="Ê†ë‰∏äÂàÜÂùóÊñπÊ≥ï‰πã‰∏Ä"></a>Ê†ë‰∏äÂàÜÂùóÊñπÊ≥ï‰πã‰∏Ä</h4><p>Á±ª‰ººË¥™ÂøÉÔºåÁî®Ê†àÁª¥Êä§ËøòÊ≤°ÊúâÂú®ËøûÈÄöÂùó‰∏≠ÁöÑÂ≠êËäÇÁÇπÔºåÂØπ‰∫éÈÄíÂΩíÂà∞ÁöÑÂΩìÂâçÁöÑÁÇπ $p$ ÔºåÊâ´ÊèèÂÆÉÁöÑÂ≠êÊ†ëÔºåËÉΩÊãºÂáëÂ∞±ÊãºÂáë</p><p>‰ΩÜÊòØÊ≥®ÊÑèÊúÄÂêéÂèØËÉΩËøò‰ºöÊúâ‰∏Ä‰∫õÁÇπÔºà‰∏ÄÂÆöÂåÖÊã¨Ê†πÔºâÂâ©‰∏ãÔºåÈÇ£‰πàÂ∞ÜËøô‰∫õÁÇπÂπ∂Âà∞ÊúÄÂêé‰∏Ä‰∏™ËøûÈÄöÂùóÂç≥ÂèØ</p><p>ÊòæÁÑ∂ÊØè‰∏™ËøûÈÄöÂùóÈÉΩÊª°Ë∂≥Â§ßÂ∞è‰∏∫ $[B, 3B]$</p><h4 id="Ê†∏ÂøÉ‰ª£Á†Å"><a href="#Ê†∏ÂøÉ‰ª£Á†Å" class="headerlink" title="Ê†∏ÂøÉ‰ª£Á†Å"></a>Ê†∏ÂøÉ‰ª£Á†Å</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> bot = top;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        DFS (v, root);</span><br><span class="line">        <span class="keyword">if</span> (top - bot &gt;= B) &#123;</span><br><span class="line">            capt[++ bind] = root;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; bot)</span><br><span class="line">                belong[Stack[top --]] = bind;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Stack[++ top] = root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Ê†ë‰∏äËé´Èòü-1"><a href="#Ê†ë‰∏äËé´Èòü-1" class="headerlink" title="Ê†ë‰∏äËé´Èòü"></a>Ê†ë‰∏äËé´Èòü</h3><p>È¶ñÂÖàÁî®ÁéãÂÆ§ËÅîÈÇ¶ÁöÑÊñπÊ≥ïÂ∞ÜÊ†ëÂàÜÂùó</p><p>Áî®‰∏Ä‰∏™Êï∞ÁªÑ $state_p$ Êù•Áª¥Êä§ $p$ ÁÇπÊòØÂê¶Âú®ÂΩìÂâçËØ¢ÈóÆÁöÑË∑ØÂæÑ‰∏äÔºåÈÇ£‰πàÊØèÊ¨°ËÆøÈóÆÂ∞±Â∞Ü $state_p$ ÁøªËΩ¨ÔºåÈ°∫‰æø‰øÆÊîπ $ans$ ÔºåÁõ∏ÂΩì‰∫éÂéüÂ∫èÂàó‰∏äËé´ÈòüÁöÑ $add, del$ Êìç‰Ωú</p><p>ÈÇ£‰πàÔºåÊØèÊ¨°ÈúÄË¶Å‰øÆÊîπÈÇ£‰∫õÁÇπÂë¢Ôºü</p><p>ÂÅáËÆæÂΩìÂâçÂ§ÑÁêÜÂà∞ $(px, py)$ ÔºåÁé∞Âú®ÈúÄË¶ÅÂ§ÑÁêÜ $(x, y)$ ÔºåÈÇ£‰πàÂè™ÈúÄ‰øÆÊîπ $px$ Âà∞ $x$ ‰ª•Âèä $py$ Âà∞ $y$ ÁöÑË∑ØÂæÑ‰∏äÁöÑÁÇπÂç≥ÂèØ</p><p>Êé•‰∏ãÊù•ËØÅÊòéËØ•Êìç‰ΩúÁöÑÊ≠£Á°ÆÊÄßÔºö</p><p>‰ª§ $T (x, y)$ Ë°®Á§∫ $x$ Âà∞ $y$ Ë∑ØÂæÑ‰∏äÁöÑÁÇπÈõÜÔºå $xor$ Êìç‰ΩúÁ±ª‰ºº‰ΩçËøêÁÆóÁöÑÂºÇÊàñÔºåÂç≥ÊúâÁõ∏ÂêåÁÇπÂàôÂà†ÂéªÔºåÊó†ÂàôÂä†ÂÖ•</p><p>ÂàôÊúâ $T (x, y) = T (x, root) xor T (y, root)$ ÔºàÊ≥®ÊÑèÔºåËøôÈáåÁöÑ $T (x, y)$ ÊòØ‰∏çÂåÖÊã¨ $lca$ ÁöÑÔºåÊïÖ <strong>$lca$ ÈúÄÂçïÁã¨Â§ÑÁêÜ</strong>Ôºâ</p><p>Êé•‰∏ãÊù•ÊòØËØÅÊòé<br>$$<br>\begin{aligned} &amp;T (px, py)  xor  T (x, y) \\ &amp;= [T (px, root)  xor  T (py, root)]  xor  [T (x, root)  xor  T (y, root)] \\ &amp;=  [T (px, root)  xor  T (x, root)]  xor  [T (py, root)  xor  T (y, root)] \\ &amp;= T (px, x)  xor  T (py, y) \end{aligned}<br>$$<br>ÈÇ£‰πàÂÖ∂ÂÆÉÁöÑ‰øÆÊîπ‰ªÄ‰πàÁöÑÂ∞±ÂíåÂ∫èÂàó‰∏äËé´Èòü‰∏ÄÊ†∑‰∫Ü</p><h3 id="‰æãÈ¢ò"><a href="#‰æãÈ¢ò" class="headerlink" title="‰æãÈ¢ò"></a>‰æãÈ¢ò</h3><p><a href="https://www.luogu.org/problemnew/show/P4074" target="_blank" rel="noopener">[WC2013]Á≥ñÊûúÂÖ¨Âõ≠</a></p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXQ = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    Link[++ size].to = v;</span><br><span class="line">    Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">    Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line">LL V[MAXN], W[MAXN];</span><br><span class="line"><span class="keyword">int</span> pcol[MAXN];</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> belong[MAXN];</span><br><span class="line"><span class="keyword">int</span> lind = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> Stack[MAXN];</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS_bel</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> bot = top;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        DFS_bel (v, root);</span><br><span class="line">        <span class="keyword">if</span> (top - bot &gt;= limit) &#123;</span><br><span class="line">            lind ++;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; bot)</span><br><span class="line">                belong[Stack[top --]] = lind;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Stack[++ top] = root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> deep[MAXN];</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN];</span><br><span class="line"><span class="keyword">int</span> value[MAXN &lt;&lt; <span class="number">1</span>], ranking[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> dfsord = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS_LCA</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    father[root] = fa;</span><br><span class="line">    dfn[root] = ++ dfsord;</span><br><span class="line">    value[dfsord] = deep[root], ranking[dfsord] = root;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        deep[v] = deep[root] + <span class="number">1</span>;</span><br><span class="line">        DFS_LCA (v, root);</span><br><span class="line">        value[++ dfsord] = deep[root], ranking[dfsord] = root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dfsord; i ++)</span><br><span class="line">        ST[i][<span class="number">0</span>] = make_pair (value[i], ranking[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">18</span>; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= dfsord; i ++)</span><br><span class="line">            ST[i][j] = ST[i][j - <span class="number">1</span>].first &lt; ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>].first ? ST[i][j - <span class="number">1</span>] : ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> L = dfn[x], R = dfn[y];</span><br><span class="line">    <span class="keyword">if</span> (L &gt; R)</span><br><span class="line">        swap (L, R);</span><br><span class="line">    <span class="keyword">int</span> k = log2 (R - L + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ST[L][k].first &lt; ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].first ? ST[L][k].second : ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QuerySt</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> index;</span><br><span class="line">    <span class="keyword">int</span> time;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line"></span><br><span class="line">    QuerySt (<span class="keyword">int</span> find = <span class="number">0</span>, <span class="keyword">int</span> ftime = <span class="number">0</span>, <span class="keyword">int</span> fx = <span class="number">0</span>, <span class="keyword">int</span> fy = <span class="number">0</span>) :</span><br><span class="line">        index (find), time (ftime), x (fx), y (fy) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> QuerySt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (belong[x] != belong[p.x])</span><br><span class="line">            <span class="keyword">return</span> belong[x] &lt; belong[p.x];</span><br><span class="line">        <span class="keyword">if</span> (belong[y] != belong[p.y])</span><br><span class="line">            <span class="keyword">return</span> belong[y] &lt; belong[p.y];</span><br><span class="line">        <span class="keyword">return</span> time &lt; p.time;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">QuerySt Query[MAXQ];</span><br><span class="line"><span class="keyword">int</span> qind = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> modposi[MAXQ], modtime[MAXQ];</span><br><span class="line"><span class="keyword">int</span> modpre[MAXQ], modval[MAXQ];</span><br><span class="line"><span class="keyword">int</span> mind = <span class="number">0</span>, cur = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> state[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> donet[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (state[p])</span><br><span class="line">        ans -= V[pcol[p]] * W[donet[pcol[p]]], donet[pcol[p]] --;</span><br><span class="line">    state[p] ^= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (state[p])</span><br><span class="line">        donet[pcol[p]] ++, ans += V[pcol[p]] * W[donet[pcol[p]]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lca = LCA (u, v);</span><br><span class="line">    <span class="keyword">while</span> (u != lca)</span><br><span class="line">        reverse (u), u = father[u];</span><br><span class="line">    <span class="keyword">while</span> (v != lca)</span><br><span class="line">        reverse (v), v = father[v];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">extime</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> exist = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (state[modposi[p]]) &#123;</span><br><span class="line">        exist = <span class="literal">true</span>;</span><br><span class="line">        reverse (modposi[p]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (type == <span class="number">1</span>) &#123;</span><br><span class="line">        modpre[p] = pcol[modposi[p]];</span><br><span class="line">        pcol[modposi[p]] = modval[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        pcol[modposi[p]] = modpre[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (exist)</span><br><span class="line">        reverse (modposi[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">timemod</span> <span class="params">(<span class="keyword">int</span> ptime)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (cur &lt; mind &amp;&amp; modtime[cur + <span class="number">1</span>] &lt;= ptime)</span><br><span class="line">        extime (++ cur, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (cur &gt; <span class="number">0</span> &amp;&amp; modtime[cur] &gt; ptime)</span><br><span class="line">        extime (cur --, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">LL answer[MAXQ]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Moqueue</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> px = <span class="number">1</span>, py = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qind; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> ind = Query[i].index, time = Query[i].time;</span><br><span class="line">        <span class="keyword">int</span> x = Query[i].x, y = Query[i].y;</span><br><span class="line">        timemod (time);</span><br><span class="line">        move (px, x), px = x;</span><br><span class="line">        move (py, y), py = y;</span><br><span class="line">        <span class="keyword">int</span> lca = LCA (px, py);</span><br><span class="line">        reverse (lca);</span><br><span class="line">        answer[ind] = ans;</span><br><span class="line">        reverse (lca);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum (), Q = getnum ();</span><br><span class="line">    limit = (<span class="keyword">int</span>) <span class="built_in">ceil</span> (<span class="built_in">pow</span> ((<span class="keyword">double</span>) N, <span class="number">2.0</span> / <span class="number">3.0</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">        V[i] = (LL) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        W[i] = (LL) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">        Insert (u, v), Insert (v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        pcol[i] = getnum ();</span><br><span class="line">    DFS_bel (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (top &gt; <span class="number">0</span>)</span><br><span class="line">        belong[Stack[top --]] = lind;</span><br><span class="line">    DFS_LCA (<span class="number">1</span>, <span class="number">0</span>), RMQ ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> opt = getnum ();</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> p = getnum (), col = getnum ();</span><br><span class="line">            modposi[++ mind] = p, modtime[mind] = i, modval[mind] = col;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = getnum (), y = getnum ();</span><br><span class="line">            qind ++, Query[qind] = (QuerySt (qind, i, x, y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sort (Query + <span class="number">1</span>, Query + qind + <span class="number">1</span>);</span><br><span class="line">    Moqueue ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qind; i ++)</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, answer[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 3 5</span></span><br><span class="line"><span class="comment">1 9 2</span></span><br><span class="line"><span class="comment">7 6 5 1</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">1 2 3 2</span></span><br><span class="line"><span class="comment">1 1 2</span></span><br><span class="line"><span class="comment">1 4 2</span></span><br><span class="line"><span class="comment">0 2 1</span></span><br><span class="line"><span class="comment">1 1 2</span></span><br><span class="line"><span class="comment">1 4 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="‰∫åÊ¨°Á¶ªÁ∫øËé´Èòü"><a href="#‰∫åÊ¨°Á¶ªÁ∫øËé´Èòü" class="headerlink" title="‰∫åÊ¨°Á¶ªÁ∫øËé´Èòü"></a>‰∫åÊ¨°Á¶ªÁ∫øËé´Èòü</h2><p>ËÄÉËôëÊüê‰∏™Ëé´ÈòüÁöÑÂ§çÊùÇÂ∫¶ÊòØ $O (n\sqrt{n}T)$ÔºåÂÖ∂‰∏≠ $x$ ÊòØÊüêÁßçÂ§çÊùÇÂ∫¶ÔºåÂç≥Ëé´ÈòüÂú®ÁßªÂä®Á´ØÁÇπÊó∂ÁöÑÊõ¥Êñ∞‰∏çÊòØ $O (1)$ ËÄåÊòØ $O (x)$ ÁöÑÔºåÂç≥ÂèØÁî®‰∫åÊ¨°Á¶ªÁ∫øËé´Èòü‰ºòÂåñÊéâ $O (T)$</p><p>ËÄÉËôëÂè≥Á´ØÁÇπÁöÑ‰∏ÄÊ¨°Áî± $R_{i - 1}$ Âà∞ $R_i (R_i &gt; R_{i - 1})$ ÁöÑ‰∏ÄÊ¨°ÁßªÂä®ÔºåÂØπ‰∫é $x \in (R_{i - 1}, R_i]$Ôºå‰ª§ÂÖ∂ÂØπÂå∫Èó¥ $[l, r]$ ÁöÑË¥°ÁåÆ‰∏∫ $c (x, [l, r])$ÔºåÈÇ£‰πà‰πüÂ∞±ÊòØËØ¥ $x$ ÊØèÊ¨°ÁßªÂä®Êàë‰ª¨ÈúÄË¶ÅÁü•ÈÅì $c (x, [l, x - 1])$ÔºåÂ∑ÆÂàÜÔºåÂæó<br>$$<br>c (x, [l, x - 1]) = c (x, [1, x - 1]) - c (x, [1, l - 1])<br>$$<br>ÂØπ‰∫é $c (x, [1, x - 1])$ÔºåÊòæÁÑ∂ÂèØ‰ª•Áõ¥Êé•ÂâçÁºÄÂíåÁª¥Êä§ÔºõÂØπ‰∫é $c (x, [1, l - 1])$ÔºåÁî±‰∫éÂú®‰∏ÄÊ¨°ÁßªÂä®‰∏≠Ê∞∏ËøúÈÉΩÊòØÁªô $[1, l - 1]$ ÂÅöË¥°ÁåÆÔºåÈÇ£‰πàÂèØ‰ª•Âè™Âú® $l - 1$ ÁöÑ‰ΩçÁΩÆÊâì‰∏™Ê†áËÆ∞ËØ¥ÊúâÂì™‰∫õ $x$ ÈúÄË¶Å‰∫ÜËß£ÂÆÉÂú®ËØ•Âå∫Èó¥ÁöÑË¥°ÁåÆÔºåÂÜçËÆ°ÁÆó‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><p>‰πüÂ∞±ÊòØËØ¥Á¨¨‰∏ÄÊ¨°Á¶ªÁ∫øÂ§ÑÁêÜÂá∫ $c (x, [1, x - 1])$ Âπ∂‰∏îÁªôÊØè‰∏™Á´ØÁÇπÊâì‰∏äÊ†áËÆ∞ËØ¥Êòé‰ªçÈúÄËÆ°ÁÆóÁöÑÂå∫Èó¥ÔºåÁ¨¨‰∫åÊ¨°Á¶ªÁ∫øÂàôÂ§ÑÁêÜÁ¨¨‰∏ÄÊ¨°Á¶ªÁ∫øÂàÜÁ¶ªÂá∫ÁöÑÂå∫Èó¥</p><p>ÊïÖÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶ $O (nT + n\sqrt{n})$ÔºåÁ©∫Èó¥Â§çÊùÇÂ∫¶ $O (n)$</p><hr><p>‰ª• „ÄåÁ¨¨ÂçÅÂõõÂàÜÂùó(Ââç‰Ωì)„Äç ‰∏∫‰æã</p><p>È¢òÁõÆÊèèËø∞ÔºöÊü•ËØ¢ $l \le i &lt; j \le r$Ôºå‰∏î $a_i \bigoplus a_j$ ÁöÑ‰∫åËøõÂà∂Ë°®Á§∫‰∏ãÂ≠òÂú® $k$ ‰∏™ $1$ ÁöÑ‰∫åÂÖÉÁªÑ $(i, j)$ ‰∏™Êï∞</p><p>‰ª§‰∫åËøõÂà∂‰∏ãÊúâ $k$ ‰∏™ $1$ ÁöÑÊï∞ÁöÑÈõÜÂêà‰∏∫ $A$ÔºàÊúÄÂ§öÊúâ $3432$ ‰∏™ÔºâÔºåÊï∞Â≠ó $x$ Âá∫Áé∞ÁöÑÊ¨°Êï∞‰∏∫ $ap (x)$ÔºåÈÇ£‰πàÂä†ÂÖ•‰∏Ä‰∏™Êï∞ $y$ Êó∂ÊâÄÂ¢ûÂä†ÁöÑË¥°ÁåÆÂç≥‰∏∫<br>$$<br>\Delta c(x, [l, r]) = \sum\limits_{x \in A} ap (x \bigoplus y)<br>$$<br>‰∫åÊ¨°Á¶ªÁ∫øËé´ÈòüÂç≥ÂèØ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXU = <span class="number">16384</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, K;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> limit = <span class="number">0</span>, bel[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; bits;</span><br><span class="line">LL buck[MAXU]= &#123;<span class="number">0</span>&#125;, preans[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">querySt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> l, r, ind;</span><br><span class="line">LL ans;</span><br><span class="line"></span><br><span class="line">querySt () &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> querySt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> bel[l] == bel[p.l] ? r &lt; p.r : l &lt; p.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">querySt query[MAXM];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">T</span> &#123;</span><span class="keyword">int</span> l, r, delt;&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;T&gt; subs[MAXN];</span><br><span class="line"></span><br><span class="line">LL answer[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), K = getnum ();</span><br><span class="line">limit = <span class="built_in">sqrt</span> (N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">a[i] = getnum ();</span><br><span class="line">bel[i] = (i - <span class="number">1</span>) / limit + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">query[i].l = getnum (), query[i].r = getnum ();</span><br><span class="line">query[i].ind = i, query[i].ans = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16384</span>; i ++)</span><br><span class="line"><span class="keyword">if</span> (__builtin_popcount (i) == K)</span><br><span class="line">bits.push_back(i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">preans[i] = buck[a[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) bits.size(); j ++)</span><br><span class="line">buck[a[i] ^ bits[j]] ++;</span><br><span class="line">&#125;</span><br><span class="line">sort (query + <span class="number">1</span>, query + M + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, pl = <span class="number">1</span>, pr = <span class="number">0</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = query[i].l, r = query[i].r;</span><br><span class="line"><span class="keyword">if</span> (pl &lt; l) subs[pr].push_back((T) &#123;pl, l - <span class="number">1</span>, - i&#125;);</span><br><span class="line"><span class="keyword">while</span> (pl &lt; l) query[i].ans += preans[pl], pl ++;</span><br><span class="line"><span class="keyword">if</span> (pl &gt; l) subs[pr].push_back((T) &#123;l, pl - <span class="number">1</span>, i&#125;);</span><br><span class="line"><span class="keyword">while</span> (pl &gt; l) query[i].ans -= preans[pl - <span class="number">1</span>], pl --;</span><br><span class="line"><span class="keyword">if</span> (pr &lt; r) subs[pl - <span class="number">1</span>].push_back((T) &#123;pr + <span class="number">1</span>, r, - i&#125;);</span><br><span class="line"><span class="keyword">while</span> (pr &lt; r) query[i].ans += preans[pr + <span class="number">1</span>], pr ++;</span><br><span class="line"><span class="keyword">if</span> (pr &gt; r) subs[pl - <span class="number">1</span>].push_back((T) &#123;r + <span class="number">1</span>, pr, i&#125;);</span><br><span class="line"><span class="keyword">while</span> (pr &gt; r) query[i].ans -= preans[pr], pr --;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span> (buck, <span class="number">0</span>, <span class="keyword">sizeof</span> (buck));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) bits.size(); j ++)</span><br><span class="line">buck[a[i] ^ bits[j]] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) subs[i].size(); j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = subs[i][j].l, r = subs[i][j].r, ind = subs[i][j].delt;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= r; k ++) &#123;</span><br><span class="line"><span class="keyword">int</span> tmp = buck[a[k]];</span><br><span class="line"><span class="keyword">if</span> (k &lt;= i &amp;&amp; ! K) tmp --;</span><br><span class="line"><span class="keyword">if</span> (ind &gt; <span class="number">0</span>) query[ind].ans += tmp;</span><br><span class="line"><span class="keyword">else</span> query[- ind].ans -= tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= M; i ++) query[i].ans += query[i - <span class="number">1</span>].ans;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) answer[query[i].ind] = query[i].ans;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">write (answer[i]), <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5 2</span></span><br><span class="line"><span class="comment">3 4 8 0 2</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">3 5</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">2 5</span></span><br><span class="line"><span class="comment">1 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÂΩíÁ∫≥ </tag>
            
            <tag> ÂàÜÂùó </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ÊùúÊïôÁ≠õ</title>
      <link href="/2020/08/04/%E6%9D%9C%E6%95%99%E7%AD%9B/"/>
      <url>/2020/08/04/%E6%9D%9C%E6%95%99%E7%AD%9B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="ÂâçÁΩÆÁõ∏ÂÖ≥"><a href="#ÂâçÁΩÆÁõ∏ÂÖ≥" class="headerlink" title="ÂâçÁΩÆÁõ∏ÂÖ≥"></a>ÂâçÁΩÆÁõ∏ÂÖ≥</h2><ul><li><p>Á±ªÂûãÁßØÊÄßÂáΩÊï∞ÔºàÊ≥®Ôºö‰ª•‰∏ãÁöÜ‰∏∫ÂÆåÂÖ®ÁßØÊÄßÂáΩÊï∞ÔºåÂç≥Êó†ÈúÄÊª°Ë∂≥ $x \perp y$ Âç≥Êúâ $f(x) ¬∑ f(y) = f(xy)$</p><p>$\epsilon (n) = [n = 1]$</p><p>$id (n) = n$</p></li><li><p><a href="https://www.cnblogs.com/Colythme/p/9972264.html" target="_blank" rel="noopener">ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éËé´ÊØî‰πåÊñØÂáΩÊï∞</a></p></li><li><p>ÁãÑÂà©ÂÖãÈõ∑Âç∑ÁßØ‰∏éÊ¨ßÊãâÂáΩÊï∞</p><p>Ê≠§Â§ÑËã•‰ª• $id $ ‰ΩúÂçï‰ΩçÂÖÉÔºåÂàô $1$ ‰∏∫ $\phi$ ÁöÑÈÄÜÔºåÂç≥ $\phi * 1 = id$</p><p>ËØÅÊòéÔºöÁî± $\sum\limits_{d | n} \phi (d) = n$ ÔºåÂÜçÂ∏¶ÂõûÂéüÂºèÂèØËØÅ</p></li><li><p>Ëé´ÊØî‰πåÊñØÂáΩÊï∞‰∏éÊ¨ßÊãâÂáΩÊï∞ÁöÑËΩ¨Âåñ<br>$$<br>\begin{aligned} \phi * 1 &amp;= id \ \phi * 1 * \mu &amp;= id * \mu \ \phi * \epsilon &amp;= id * \mu \ \phi &amp;= \sum\limits_{d | n} \mu(d) \frac{n}{d} \ \frac{\phi}{n} &amp;= \sum\limits_{d | n} \frac{\mu(d)}{d} \end{aligned}<br>$$</p></li></ul><h2 id="ÊùúÊïôÁ≠õ"><a href="#ÊùúÊïôÁ≠õ" class="headerlink" title="ÊùúÊïôÁ≠õ"></a>ÊùúÊïôÁ≠õ</h2><ul><li><p>ÊùúÊïôÁ≠õÁî®‰∫éÊ±ÇËß£ÁßØÊÄßÂáΩÊï∞ÂâçÁºÄÂíå‰∏ÄÁ±ªÈóÆÈ¢ò</p></li><li><p>‰∏ãÈù¢Ê±ÇËß£ÁßØÊÄßÂáΩÊï∞ $f$ ÁöÑÂâçÁºÄÂíå</p></li><li><p>ËÆæÁßØÊÄßÂáΩÊï∞ $f, g, h$ Ôºå‰∏î $h = f * g$ ÔºåÂàôÊúâ</p></li></ul><p>$$<br>\begin{aligned} \sum\limits_{i = 1}^n h(n) &amp;= \sum\limits_{i = 1}^n \sum\limits_{d | n} g(d)f(\frac{n}{d}) \\ &amp;= \sum\limits_{d = 1}^n g(d) \sum\limits_{i = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} f(i) \end{aligned}<br>$$</p><ul><li>‰ª§ $S(n) = \sum\limits_{i = 1}^n f(i)$</li><li>Â∞Ü $d = 1$ Êó∂ÁöÑÊèêÂá∫ÔºåÂÜçÁßªÈ°πÔºåÂæó</li></ul><p>$$<br>S(n) = \sum\limits_{i = 1}^n h(i) - \sum\limits_{d = 2}^n g(d)S(\left\lfloor\frac{n}{d}\right\rfloor)<br>$$</p><ul><li>ÈÇ£‰πàÈ¢ÑÂ§ÑÁêÜ $h, g$ ÁöÑÂâçÁºÄÂíåÔºà‰∏ÄËà¨È¢ÑÂ§ÑÁêÜ $n^{\frac{2}{3}}$ ‰∏™ÔºüÔºâÔºåÂÜçÈÄíÂΩíÊï¥Èô§ÂàÜÂùóÂç≥ÂèØÂ§ÑÁêÜÔºå‰∏çËøá‰∏ÄËà¨ $h, g$ ÈúÄË¶ÅËá™Â∑±ÈÖç</li><li>‰ΩÜÂÆûÈôÖ‰∏äÂπ∂‰∏çÈúÄË¶ÅÁî® $\text{unordered_map}$ Êù•ËÆ∞ÂøÜÂåñÔºåËÆæÈ¢òÁõÆÁªôÂÆö $N$ÔºåÂΩìÂâçÈÄíÂΩíÂà∞ $n$ÔºåÂàô $n$ ÁöÑÁ≠îÊ°àÂèØ‰ª•Ë¢´ $N / n$ ËÆ∞ÂΩïÔºå‰πüÂ∞±ÊòØÁî® $visit(\lfloor\frac{N}n\rfloor)$ Êù•Âà§Êñ≠ÊòØÂê¶Â∑≤Ë¢´ÊêúËøáÔºå‰∏ãÈù¢ÁªôÂá∫Âà´‰∫∫ÁöÑÁÆÄÂçïËØÅÊòé‰∏∫‰ªÄ‰πà‰∏ç‰ºöÂà§Èáç</li><li><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/sG79MC6wLoOvu8k.png" alt=""></li></ul><h2 id="‰æã"><a href="#‰æã" class="headerlink" title="‰æã"></a>‰æã</h2><h3 id="Ê±Ç-sum-limits-i-1-n-mu-i-sum-limits-i-1-n-phi-i"><a href="#Ê±Ç-sum-limits-i-1-n-mu-i-sum-limits-i-1-n-phi-i" class="headerlink" title="Ê±Ç$\sum\limits_{i = 1}^n \mu(i), \sum\limits_{i = 1}^n \phi(i)$"></a>Ê±Ç$\sum\limits_{i = 1}^n \mu(i), \sum\limits_{i = 1}^n \phi(i)$</h3><p>Áî± $\mu * 1 = \epsilon$ ÔºåÂèØ‰ª§ $g = 1, h = \epsilon$ ÔºåÈÇ£‰πàÂæóÂà∞<br>$$<br>S(n) = 1 - \sum\limits_{d = 2}^n S(\left\lfloor\frac{n}{d}\right\rfloor)<br>$$<br>Ê±Ç $\sum \phi$ ÂêåÁêÜ</p><h3 id="Ê±Ç-sum-limits-i-1-n-i-phi-i-ÔºàÈúÄË¶ÅÁî®ÈÖçÁöÑÔºâ"><a href="#Ê±Ç-sum-limits-i-1-n-i-phi-i-ÔºàÈúÄË¶ÅÁî®ÈÖçÁöÑÔºâ" class="headerlink" title="Ê±Ç$\sum\limits_{i = 1}^n i \phi(i) ÔºàÈúÄË¶ÅÁî®ÈÖçÁöÑÔºâ$"></a>Ê±Ç$\sum\limits_{i = 1}^n i \phi(i) ÔºàÈúÄË¶ÅÁî®ÈÖçÁöÑÔºâ$</h3><p>$$<br>h(n) = \sum\limits_{d | n} d \phi(d) g(\frac{n}{d})<br>$$</p><p>Â∏åÊúõÂ∞Ü $d$ Ê∂àÂéªÔºåÊïÖÈÖç $g = id$ ÔºåÂæó $h(n) = n^2$<br>$$<br>S(n) = \sum\limits_{i = 1}^n i - \sum\limits_{d = 2}^n d S(\left\lfloor\frac{n}{d}\right\rfloor)<br>$$<br>Âç≥ÂèØËß£</p><h2 id="‰ª£Á†ÅÔºàÊ±ÇËß£-sum-mu-sum-phi-Ôºâ"><a href="#‰ª£Á†ÅÔºàÊ±ÇËß£-sum-mu-sum-phi-Ôºâ" class="headerlink" title="‰ª£Á†ÅÔºàÊ±ÇËß£$\sum \mu, \sum \phi$ Ôºâ"></a>‰ª£Á†ÅÔºàÊ±ÇËß£$\sum \mu, \sum \phi$ Ôºâ</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e06</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">3000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN / <span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> vis[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mu[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL phi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> sumu[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumphi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">4e06</span> + <span class="number">5e05</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linear_sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">mu[<span class="number">1</span>] = phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! vis[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">mu[i] = - <span class="number">1</span>, phi[i] = i - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j])) &#123;</span><br><span class="line">phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">mu[i * prime[j]] = - mu[i];</span><br><span class="line">phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line">sumu[i] = sumu[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">sumphi[i] = sumphi[i - <span class="number">1</span>] + phi[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> mapmu[MAXM];</span><br><span class="line">LL maphi[MAXM];</span><br><span class="line"><span class="keyword">bool</span> vmu[MAXM]= &#123;<span class="literal">false</span>&#125;, vphi[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mu_sieve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sumu[n];</span><br><span class="line"><span class="keyword">if</span> (vmu[N / n]) <span class="keyword">return</span> mapmu[N / n];</span><br><span class="line"><span class="keyword">int</span> total = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">total -= (r - l + <span class="number">1</span>) * mu_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line">vmu[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> mapmu[N / n] = total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">phi_sieve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sumphi[n];</span><br><span class="line"><span class="keyword">if</span> (vphi[N / n]) <span class="keyword">return</span> maphi[N / n];</span><br><span class="line">LL total = n * <span class="number">1l</span>l * (n + <span class="number">1</span>) / <span class="number">2l</span>l;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">total -= <span class="number">1l</span>l * (r - l + <span class="number">1</span>) * phi_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line">vphi[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> maphi[N / n] = total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">linear_sieve ();</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; T);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line"><span class="built_in">memset</span> (vmu, <span class="literal">false</span>, <span class="keyword">sizeof</span> (vmu));</span><br><span class="line"><span class="built_in">memset</span> (vphi, <span class="literal">false</span>, <span class="keyword">sizeof</span> (vphi));</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; N);</span><br><span class="line">LL ans1 = phi_sieve (N);</span><br><span class="line"><span class="keyword">int</span> ans2 = mu_sieve (N);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld %d\n"</span>, ans1, ans2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊùúÊïôÁ≠õ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Âø´ÈÄüÊ≤ÉÂ∞î‰ªÄÂèòÊç¢„ÄåFWT„Äç</title>
      <link href="/2020/08/04/%E5%BF%AB%E9%80%9F%E6%B2%83%E5%B0%94%E4%BB%80%E5%8F%98%E6%8D%A2%E3%80%8CFWT%E3%80%8D/"/>
      <url>/2020/08/04/%E5%BF%AB%E9%80%9F%E6%B2%83%E5%B0%94%E4%BB%80%E5%8F%98%E6%8D%A2%E3%80%8CFWT%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Â§ÑÁêÜÈóÆÈ¢ò"><a href="#Â§ÑÁêÜÈóÆÈ¢ò" class="headerlink" title="Â§ÑÁêÜÈóÆÈ¢ò"></a>Â§ÑÁêÜÈóÆÈ¢ò</h2><p>$$<br>C_i = \sum\limits_{i \oplus j} A_iB_j<br>$$</p><h2 id="Á¶ªÊï£Ê≤ÉÂ∞î‰ªÄÂèòÊç¢„ÄåDWT„Äç"><a href="#Á¶ªÊï£Ê≤ÉÂ∞î‰ªÄÂèòÊç¢„ÄåDWT„Äç" class="headerlink" title="Á¶ªÊï£Ê≤ÉÂ∞î‰ªÄÂèòÊç¢„ÄåDWT„Äç"></a>Á¶ªÊï£Ê≤ÉÂ∞î‰ªÄÂèòÊç¢„ÄåDWT„Äç</h2><p>ËÆæ $DWT_i (A) = \sum\limits_{j = 0}^n A_jf(i, j)$ ÔºàÁ¨¨‰∏ÄÊ¨°Áü•ÈÅìÂéüÊù•Á¶ªÊï£ÂèòÊç¢ÊòØËøô‰πàËÆæÁöÑÔºâ</p><p>ÂèàÁî±‰∫é<br>$$<br>\begin{aligned}<br>DWT_i(A)DWT_i(B) &amp;= DWT_i(C) \\<br>\sum\limits_{j = 0}^{n - 1} \sum\limits_{k = 0}^{n - 1} A_jB_kf(i, j)f(i, k) &amp;= \sum\limits_{j = 0}^{n - 1} \sum\limits_{k = 0}^{n - 1} A_jB_kf(i, j \oplus k)<br>\end{aligned}<br>$$<br>ÊïÖ $f(i, j)f(i, k) = f(i, j \oplus k)‚Äã$</p><p>‰∫éÊòØÂ∞±Êúâ‰∏Ä‰∫õÁªìËÆ∫</p><ul><li>$and:  f(i, j) = [(i  and   j) = i]$ </li><li>$or:  f(i, j) = [(i  and  j) = j]$</li><li>$xor:  f(i, j) = (- 1)^{cnt (i  and  j)}$ Ôºà$cnt (x)$ ÊòØ $x$ ÁöÑ‰∫åËøõÂà∂‰ΩçÊï∞Ôºâ</li></ul><p>Ëá≥‰∫éËØÅÊòéËá™Â∑±ÊÑè‰ºö‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><p>ÂèàÁî±‰∫é $f(i, j)$ Êª°Ë∂≥‰∫åËøõÂà∂ÊãÜÂàÜÔºåÂç≥<br>$$<br>f(i, j) = \prod\limits_{bit = 0}^{cntbit - 1} f(i_{bit}, j_{bit})<br>$$<br>ÈÇ£‰πàÂ∞ÜÂÖ∂Â∑¶Âè≥ÊãÜÂàÜÔºåÊé®‰∏Ä‰∏ãÂºèÂ≠êÔºåÂæóÔºàÊ≥®ÊÑè‰∏ãÈù¢ÁöÑ $i_{bit}$ Ë°®Á§∫ÁöÑÊòØ<strong>‰ªéÈ´òÂà∞‰Ωé</strong>ÁöÑÁ¨¨ $bit‚Äã$ ‰ΩçÔºâ<br>$$<br>\begin{aligned}<br>DWT_i(A) &amp;= \sum\limits_{j = 0}^n A_jf(i, j) \\<br>&amp;= \sum\limits_{j = 0}^{\frac{n}{2} - 1} A_jf(i, j) + \sum\limits_{j = \frac{n}{2}}^{n - 1} A_jf(i, j)<br>\end{aligned}<br>$$<br>ÁÑ∂ÂêéÂ∞ÜÂÆÉ‰ª¨ÁöÑÊúÄÈ´ò‰ΩçÊèêÂá∫Êù•ÔºåÂæó<br>$$<br>\begin{aligned}<br>DWT_i(A) = f(i_0, 0)\sum\limits_{j = 0}^{\frac{n}{2} - 1} A_j\prod_{bit = 1}^{cntbit - 1}  f(i_{bit}, j_{bit}) + f(i_0, 1)\sum\limits_{j = \frac{n}{2}}^{n - 1}A_j\prod_{bit = 1}^{cntbit - 1} f(i_{bit}, j_{bit})<br>\end{aligned}<br>$$<br>Êï¥ÁêÜ‰∏Ä‰∏ãÔºåÂæó $(i \in [0, \frac{n}{2} - 1])$<br>$$<br>\begin{aligned}<br>DWT_i(A) &amp;= f(0, 0)DWT_{\frac{n}{2}}(A_{left}) + f(0, 1)DWT_{\frac{n}{2}}(A_{right}) \\<br>DWT_{i + \frac{n}{2}}(A) &amp;= f(1, 0))DWT_{\frac{n}{2}}(A_{left}) + f(1, 1)DWT_{\frac{n}{2}}(A_{right})<br>\end{aligned}<br>$$<br>Ëá≥‰∫é $iDWT$ÔºåÂ∞±ÊòØËß£‰∏™‰∫åÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ãÁöÑÈóÆÈ¢ò</p><p>Êé•‰∏ãÊù•Âè™Ë¶ÅÊää $FFT$ ÁöÑÈÉ®ÂàÜÁ®ãÂ∫èÊîπ‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><p>‰∏ãÈù¢ËÆ∞ÂΩï‰∏Ä‰∫õÂ∏∏ËßÅÂÖ¨Âºè<br>$$<br>and:  a[i + j] += a[i + j + k]  (DWT) \\<br>and:  a[i + j] -= a[i + j + k]  (iDWT) \\<br> \\<br>or:  a[i + j + k] += a[i + j]  (DWT) \\<br>or:  a[i + j + k] -= a[i + j]  (iDWT) \\<br> \\<br>xor:  a[i + j] = a[i + j] + a[i + j + k],  a[i + j + k] = a[i + j] - a[i + j + k]  (DWT) \\<br>xor:  a[i + j] = \frac{a[i + j] + a[i + j + k]}{2},  a[i + j + k] = \frac{a[i + j] - a[i + j + k]}{2}  (iDWT)<br>$$</p><h2 id="‰ª£Á†Å„Äå-and-or-xor-„Äç"><a href="#‰ª£Á†Å„Äå-and-or-xor-„Äç" class="headerlink" title="‰ª£Á†Å„Äå$and,  or,  xor$„Äç"></a>‰ª£Á†Å„Äå$and,  or,  xor$„Äç</h2>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FWT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Â∏∏Á≥ªÊï∞Á∫øÊÄßÈÄíÊé®</title>
      <link href="/2020/08/04/%E5%B8%B8%E7%B3%BB%E6%95%B0%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8/"/>
      <url>/2020/08/04/%E5%B8%B8%E7%B3%BB%E6%95%B0%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="ÂâçÁΩÆÁü•ËØÜ"><a href="#ÂâçÁΩÆÁü•ËØÜ" class="headerlink" title="ÂâçÁΩÆÁü•ËØÜ"></a>ÂâçÁΩÆÁü•ËØÜ</h2><h3 id="Â§öÈ°πÂºèÈô§Ê≥ï-ÂèñÊ®°"><a href="#Â§öÈ°πÂºèÈô§Ê≥ï-ÂèñÊ®°" class="headerlink" title="Â§öÈ°πÂºèÈô§Ê≥ï|ÂèñÊ®°"></a>Â§öÈ°πÂºèÈô§Ê≥ï|ÂèñÊ®°</h3><p>ËØ•ÈÉ®ÂàÜËßÅ <a href="https://colythme.github.io/2020/07/22/Â§öÈ°πÂºèÊìç‰Ωú/">Â§öÈ°πÂºèÊìç‰Ωú</a></p><h3 id="ÁâπÂæÅÂÄº‰∏éÁâπÂæÅÂêëÈáè"><a href="#ÁâπÂæÅÂÄº‰∏éÁâπÂæÅÂêëÈáè" class="headerlink" title="ÁâπÂæÅÂÄº‰∏éÁâπÂæÅÂêëÈáè"></a>ÁâπÂæÅÂÄº‰∏éÁâπÂæÅÂêëÈáè</h3><p>ÔºàËøôÈÉ®ÂàÜÊàë‰πü‰∏çÊÄé‰πàÁêÜËß£ÔºåÂ∞±Â§ßÊ¶ÇËÆ∞‰∏™ÁªìËÆ∫Ôºâ</p><p>ÂØπ $n$ Èò∂Áü©Èòµ $A$ ÁöÑÁâπÂæÅÂêëÈáè $\vec{v}$ ‰∏éÔºåÊúâÁâπÂæÅÂÄº $\lambda$ Êª°Ë∂≥<br>$$<br>A\vec v = \lambda\vec v<br>$$<br>ÁßªÈ°πÂàôÊúâ $(\lambda I - A)\vec v = 0$ÔºåÂÖ∂‰∏≠ $I$ ‰∏∫Âçï‰ΩçÁü©Èòµ</p><p>ÈÇ£‰πàÊúâËß£ÁöÑÂÖÖË¶ÅÊù°‰ª∂ÊòØ $det(\lambda I - A) = 0$</p><p>‰ª§ $f(\lambda) = det(\lambda I - A)$ÔºåÂç≥Ê≠§Êó∂ÂèØÂ∞Ü $det (\lambda I - A)$ Áúã‰Ωú‰∏Ä‰∏™ $n$ Èò∂Â§öÈ°πÂºèÔºåÂàôÁß∞ $f(\lambda)$ ‰∏∫Áü©Èòµ $A$ ÁöÑÁâπÂæÅÂ§öÈ°πÂºèÔºåÂØπÁü©Èòµ $A$ÔºåÂÖ∂‰ªªÊÑèÁâπÂæÅÂÄº $\lambda_0$ ÈÉΩÊª°Ë∂≥ $f(\lambda_0) = 0$</p><h3 id="text-Hamiton-Cayley-ÂÆöÁêÜ"><a href="#text-Hamiton-Cayley-ÂÆöÁêÜ" class="headerlink" title="$\text{Hamiton-Cayley}$ÂÆöÁêÜ"></a>$\text{Hamiton-Cayley}$ÂÆöÁêÜ</h3><p>ÂØπÁü©Èòµ $A$ ÂèäÂÖ∂ÁâπÂæÅÂ§öÈ°πÂºè $f(x)$ÔºåÊª°Ë∂≥ $f(A) = O$ÔºåÂÖ∂‰∏≠ $O$ ‰∏∫Èõ∂Áü©Èòµ</p><p>ËØÅÊòéÁïôÂùë</p><h2 id="Â∏∏Á≥ªÊï∞ÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®"><a href="#Â∏∏Á≥ªÊï∞ÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®" class="headerlink" title="Â∏∏Á≥ªÊï∞ÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®"></a>Â∏∏Á≥ªÊï∞ÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®</h2><p>Ê±Ç‰∏Ä‰∏™Êª°Ë∂≥ $k$ Èò∂ÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®Êï∞Âàó $h_i$ ÁöÑÁ¨¨ $n$ È°πÔºåÂç≥<br>$$<br>h_n = \sum\limits_{i = 1}^k f_i \times h_{n - i}<br>$$<br>ÂÆÉÊúâ‰∏â‰∏™ÁâπÁÇπ</p><ul><li>Â∏∏Á≥ªÊï∞ÔºöÈÄíÊé®Á≥ªÊï∞‰∏é‰∏ãÊ†áÊó†ÂÖ≥</li><li>ÈΩêÊ¨°ÔºöÈÄíÊé®Âºè‰∏çÂ≠òÂú®Â∏∏Êï∞È°πÔºåÂ∞±Á±ª‰ºº $y = ax + b$ ‰∏≠ $b = 0$</li><li>Á∫øÊÄßÔºöÈÉΩ‰∏∫‰∏ÄÊ¨°È°π</li></ul><h3 id="Áü©ÈòµÂø´ÈÄüÂπÇ"><a href="#Áü©ÈòµÂø´ÈÄüÂπÇ" class="headerlink" title="Áü©ÈòµÂø´ÈÄüÂπÇ"></a>Áü©ÈòµÂø´ÈÄüÂπÇ</h3><p>Âä†ÈÄüÁü©Èòµ $A$ $\times$ ÂàùÂßãÁü©Èòµ $H$Ôºö<br>$$<br>\begin{pmatrix}<br>f_1 &amp; f_2 &amp; f_3 &amp; \cdots &amp; f_n \\<br>1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\<br>0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\<br>\vdots &amp; \vdots &amp; \ddots &amp; \cdots &amp; \vdots \\<br>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1<br>\end{pmatrix}<br>\times<br>\begin{pmatrix}<br>h_k \\<br>\vdots \\<br>h_3 \\<br>h_2 \\<br>h_1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>h_{k + 1} \\<br>\vdots \\<br>h_4 \\<br>h_3 \\<br>h_2<br>\end{pmatrix}<br>$$<br>ÈÇ£‰πàÂø´ÈÄüÂπÇ $A^nH$ Âç≥ÂèØÔºåÂ§çÊùÇÂ∫¶ $O (k^3 \log n)$</p><h3 id="‰ºòÂåñ"><a href="#‰ºòÂåñ" class="headerlink" title="‰ºòÂåñ"></a>‰ºòÂåñ</h3><p>ËÄÉËôë $A\vec v = \lambda\vec v$Ôºå‰πüÂ∞±ÊòØËØ¥Áé∞Âú®Â≠òÂú®<br>$$<br>\begin{pmatrix}<br>h_{k + 1} \\<br>\vdots \\<br>h_4 \\<br>h_3 \\<br>h_2<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>\lambda h_k \\<br>\vdots \\<br>\lambda h_3 \\<br>\lambda h_2 \\<br>\lambda h_1<br>\end{pmatrix}<br>$$<br>Êé®Âπø‰∏Ä‰∏ãÔºå$h_n = \lambda^{n - 1} h_1$ÔºåÂàô<br>$$<br>\begin{aligned}<br>h_{k + 1} &amp;= f_1h_{k -1} + f_2h_{k - 2} + ‚Ä¶ + f_kh_1 \\<br>\lambda^kh_1 &amp;= f_1\lambda^{k - 1}h_1 + f_2\lambda^{k - 2}h_2 + ‚Ä¶ + f_kh_1 \\<br>\lambda^k &amp;= f_1\lambda^{k - 1} + f_2\lambda^{k - 2} + ‚Ä¶ + f_k<br>\end{aligned}<br>$$<br>Â∞Ü $\lambda$ ÊõøÊç¢‰∏∫ $x$ÔºåÂàôÊúâ $F(x) = x^k - f_1x^{k - 1} - f_2x^{k - 2} - ‚Ä¶ - f_k$</p><p>Ê≠§Êó∂ $F(x)$ Â∞±ÊòØÁü©Èòµ $A$ ÁöÑÁâπÂæÅÂ§öÈ°πÂºèÔºåÊúâ $F(A) = 0$</p><p>ËÄÉËôëÁ≠âÂºè<br>$$<br>x^n = F(x)Q(x) + R(x)<br>$$<br>‰ª• $A$ ‰ª£ÂÖ•ÔºåÂàôÊúâ<br>$$<br>A^n = R(A)<br>$$<br>Âà´Âøò‰∫ÜÁé∞Âú®Ë¶ÅÊ±ÇÁöÑÊòØ $A^n\vec v$ÔºåÈÇ£‰πà‰∏§ËæπÂêå‰πò $\vec v$ÔºåÊúâ $A^n\vec v = R(A)\vec v$</p><p>$R(x)$ ÂèØ‰ª•ÈÄöËøáÁî± $A(x) = x^n$ ÂØπ $F(x)$ ÂèñÊ®°Ê±ÇÂæóÔºåÊ≥®ÊÑèÊ≠§Êó∂‰∏çËÉΩÁõ¥Êé•ÂèñÊ®°ÔºåÂõ†‰∏∫ $n$ ÂèØ‰ª•ÈùûÂ∏∏Â§ßÔºàÊØîÂ¶Ç $n = 1e9Ôºâ$ÔºåÊó†Ê≥ïÂ≠ò‰∏ãÂ§öÈ°πÂºè $x^n$ÔºåÈúÄË¶ÅÈÄöËøáÂø´ÈÄüÂπÇÊ±ÇËß£</p><p>ËÆæ $R(x) = \sum\limits_{i = 0}^{k - 1} c_ix^i$ÔºåÂàô<br>$$<br>A^n\vec v = \sum\limits_{i = 0}^{k - 1}c_iA^i\vec v<br>$$<br>ËÄå $A^i\vec v$ ÂÆûÈôÖ‰∏äÂ∞±ÊòØ<br>$$<br>\begin{pmatrix}<br>h_{k + i} \\<br>\vdots \\<br>h_{i + 3} \\<br>h_{i + 2} \\<br>h_{i + 1}<br>\end{pmatrix}<br>$$<br>$A$ ÁöÑÊ¨°Êï∞ÊúÄÂ§ö $k - 1$Ôºå‰πüÂ∞±ÊòØËØ¥ÊúÄÂ§öÂè™‰ºöÂèñÂà∞Ââç $2k - 1$ ‰∏™ $h_i$ÔºåÊàë‰ª¨ÊúÄÂêéË¶ÅÂèñÂæóÊòØ $A^n\vec v$ ÁöÑÁ¨¨‰∏Ä‰ΩçÔºåÊØèÊ¨°‰πò‰∏ä‰∏Ä‰∏™ $A$ Âàô‰ª§ $h$ Êï∞ÁªÑÂêë‰∏ãÁßª‰∏Ä‰ΩçÔºåÈÇ£‰πàÊúÄÁªàÁ≠îÊ°àÂç≥‰∏∫ $ans = \sum\limits_{i = 0}^{k - 1} c_ih_i$</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (k \log k \log n)$</p><p>ÂÖ∂ÂÆûÊØèÊ¨°Âú®Ê±ÇÂ§öÈ°πÂºèÂèñÊ®°ÁöÑÊó∂ÂÄôÈÉΩÊòØÂØπ $F(x)$ ÂèñÊ®°ÔºåÊâÄ‰ª•ÂèØ‰ª•ÊèêÂâçÂØπ $F(x)$ È¢ÑÂ§ÑÁêÜÔºåÊ±ÇÂá∫ÂÖ∂ÈÄÜÔºåÈÇ£‰πàÂèØ‰ª•Â∞ëÂæàÂ§öÂ∏∏Êï∞ÔºàËôΩÁÑ∂ÊàëÁöÑÂ∏∏Êï∞ËøòÊòØË¥ºÂ§ßÂ∞±ÊòØ‰∫Ü„ÄÇ„ÄÇÔºâ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">32000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN]= &#123;<span class="number">0</span>&#125;, limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">LL ome = power (inv == <span class="number">1</span> ? g : invg, (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">LL x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome % MOD) &#123;</span><br><span class="line">LL a1 = a[j + k], xa2 = x * a[j + mid + k] % MOD;</span><br><span class="line">a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">a[j + mid + k] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">LL A[MAXN], B[MAXN], O[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span> <span class="params">(LL* X, LL* Y, <span class="keyword">int</span> fn, <span class="keyword">int</span> fm, <span class="keyword">int</span> rst)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= fn + fm; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fn; i ++) A[i] = X[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fm; i ++) B[i] = Y[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = A[i] * B[i] % MOD;</span><br><span class="line">NTT (A, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= rst; i ++) X[i] = A[i] * invn % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = rst + <span class="number">1</span>; i &lt;= fn + fm; i ++) X[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* a)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123; a[<span class="number">0</span>] = power (O[<span class="number">0</span>], MOD - <span class="number">2</span>); <span class="keyword">return</span> ; &#125;</span><br><span class="line">inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, a);</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= deg &lt;&lt; <span class="number">1</span>; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++) A[i] = O[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg &lt;&lt; <span class="number">1</span>; i ++) B[i] = a[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) B[i] = B[i] * ((<span class="number">2l</span>l - A[i] * B[i] % MOD + MOD) % MOD) % MOD;</span><br><span class="line">NTT (B, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++) a[i] = B[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL R[MAXN], INVG[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prep</span> <span class="params">(LL* G, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i ++) O[i] = G[i];</span><br><span class="line">reverse (O, O + m + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - m + <span class="number">2</span>; i &lt;= m; i ++) O[i] = <span class="number">0</span>;</span><br><span class="line">inverse (n - m + <span class="number">1</span>, INVG);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PolyMod</span> <span class="params">(LL* F, LL* G, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123; <span class="comment">// F mod G = R</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++) R[i] = F[i];</span><br><span class="line">reverse (R, R + n + <span class="number">1</span>); mul (R, INVG, n, n - m + <span class="number">1</span>, n);</span><br><span class="line">reverse (R, R + n - m + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - m + <span class="number">1</span>; i &lt;= n; i ++) R[i] = <span class="number">0</span>;</span><br><span class="line">mul (R, G, n - m, m, n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i ++) R[i] = (F[i] - R[i] + MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++) &#123; F[i] = i &lt; m ? R[i] : <span class="number">0</span>; R[i] = <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K, L;</span><br><span class="line">LL F[MAXK]= &#123;<span class="number">0</span>&#125;, h[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL X[MAXN]= &#123;<span class="number">0</span>&#125;, ANS[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PolyPow</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; <span class="comment">// X ^ p (mod F)</span></span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) &#123; mul (ANS, X, K - <span class="number">1</span>, K - <span class="number">1</span>, L); PolyMod (ANS, F, L, K); &#125;</span><br><span class="line">mul (X, X, K - <span class="number">1</span>, K - <span class="number">1</span>, L); PolyMod (X, F, L, K);</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum (); L = (K - <span class="number">1</span>) &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++) F[K - i] = (MOD - getnum () % MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) h[i] = getnum () % MOD;</span><br><span class="line">F[K] = X[<span class="number">1</span>] = ANS[<span class="number">0</span>] = <span class="number">1</span>; prep (F, L, K);</span><br><span class="line">PolyPow (N);</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) ans = (ans + ANS[i] * h[i] % MOD + MOD) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Â∏∏Á≥ªÊï∞ÈùûÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®"><a href="#Â∏∏Á≥ªÊï∞ÈùûÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®" class="headerlink" title="Â∏∏Á≥ªÊï∞ÈùûÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®"></a>Â∏∏Á≥ªÊï∞ÈùûÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®</h2><p>Ê±Ç‰∏Ä‰∏™Êª°Ë∂≥ $k$ Èò∂ÈΩêÊ¨°Á∫øÊÄßÈÄíÊé®Êï∞Âàó $h_i$ ÁöÑÁ¨¨ $n$ È°πÔºåÂç≥<br>$$<br>h_n = P(n) + \sum\limits_{i = 1}^k f_i \times h_{n - i}<br>$$</p>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Â§öÈ°πÂºè </tag>
            
            <tag> FFT/NTT </tag>
            
            <tag> Áü©Èòµ‰πòÊ≥ï </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ê¥õË∞∑4233 - Â∞ÑÂëΩ‰∏∏ÊñáÁöÑÁ¨îËÆ∞</title>
      <link href="/2020/08/04/%E5%B0%84%E5%91%BD%E4%B8%B8%E6%96%87%E7%9A%84%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/08/04/%E5%B0%84%E5%91%BD%E4%B8%B8%E6%96%87%E7%9A%84%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÊòæÁÑ∂Á≠îÊ°àÊòØÊÄªÂìàÂØÜÈ°øÂõûË∑ØÊï∞Èô§‰ª•ÂÄºÂæóËÆ∞ÂΩïÁöÑÁ´ûËµõÂõæÊï∞</p><p>ÈÇ£‰πàÂÖàÊ±ÇËß£ÊÄªÂìàÂØÜÈ°øÂõûË∑ØÊï∞ÔºåËÄÉËôëÊØè‰∏™ÂìàÂØÜÈ°øÂõûË∑Ø‰ºöÂú®Âá†‰∏™ÂÄºÂæóËÆ∞ÂΩïÁöÑÁ´ûËµõÂõæ‰∏≠ÔºåÂàôÊúâ<br>$$<br>Hamitons = (n - 1)!2^{C_n^2 - n}<br>$$<br>Âç≥ÊÄªÂÖ±Êúâ $(n - 1)!$ ÁßçÂìàÂØÜÈ°øÂõûË∑ØÔºåÁÑ∂ÂêéÂâ©‰∏ãÁöÑËæπÈöè‰æøÈÄâ</p><p>‰∫éÊòØÁé∞Âú®ËÄÉËôëÂÄºÂæóËÆ∞ÂΩïÁöÑÁ´ûËµõÂõæÊï∞</p><p>È¶ñÂÖàÂ¶ÇÊûú‰∏Ä‰∏™Á´ûËµõÂõæË¶ÅÊúâÂìàÂØÜÈ°øÂõûË∑ØÔºåÈÇ£‰πàÂÆÉËá≥Â∞ëË¶ÅÊúâ‰∏Ä‰∏™ÂåÖÂê´ÊâÄÊúâËäÇÁÇπÁöÑÁéØÔºåÂç≥ËØ•ÂõæÊòØÂº∫ËøûÈÄöÁöÑÔºåÂπ∂‰∏îÊòæÁÑ∂ÈùûÂº∫ËøûÈÄöÁ´ûËµõÂõæÂÆÉ‰∏ÄÂÆö‰∏çÂ≠òÂú®ÂìàÂØÜÈ°øÂõûË∑ØÔºåÊâÄ‰ª•ÊúâÁªìËÆ∫</p><blockquote><p>Êúâ‰∏î‰ªÖÊúâÂº∫ËøûÈÄöÁ´ûËµõÂõæÂ≠òÂú®ÂìàÂØÜÈ°øÂõûË∑Ø</p></blockquote><p>ÈÇ£‰πàÈóÆÈ¢òËΩ¨Âåñ‰∏∫Ê±ÇËß£Âº∫ËøûÈÄöÁ´ûËµõÂõæ</p><p>ÂèëÁé∞Ê≠£Èù¢Èöæ‰ª•Ê±ÇËß£ÔºåÂ∞±ËÄÉËôëÂèçÈù¢Ê±ÇËß£</p><p>ËÆæ $f_n$ Ë°®Á§∫ $n$ ‰∏™ËäÇÁÇπÁöÑÂº∫ËøûÈÄöÁ´ûËµõÂõæÊï∞Ôºå$g_n$ Ë°®Á§∫ $n$ ‰∏™ËäÇÁÇπÁöÑÁ´ûËµõÂõæÊï∞ÔºàÂç≥ $2^{C_n^2}$ÔºâÔºåÂèØÂæó $DP$ ÊñπÁ®ã<br>$$<br>f_n = g_n - \sum\limits_{j = 1}^{n - 1} f_jg_{n - j}\dbinom{n}{j}<br>$$<br>ÂÖ∂‰∏≠Ê±ÇËß£ÈùûÂº∫ËøûÈÄöÁ´ûËµõÂõæÈÉ®ÂàÜÊòØÊØèÊ¨°Â∞ÜÊãìÊâëÂ∫èÊúÄÂ∞èÁöÑÂº∫ËøûÈÄöÂàÜÈáèÊèêÂèñÂá∫Êù•ËÆ°Êï∞ÔºåÈÇ£‰πàÂâ©‰∏ãÁöÑÁÇπÈöèÊÑèËøûÊé•ÔºàÊ≥®ÊÑèÔºåÊ≠§Êó∂ÂèñÁöÑÊòØ<strong>ÊãìÊâëÂ∫èÊúÄÂ∞èÁöÑÂº∫ËÅîÈÄöÂàÜÈáè</strong>ÔºåÊïÖËØ•Âº∫ËÅîÈÄöÂàÜÈáè‰∏éÂÖ∂ÂÆÉËøûÈÄöÂàÜÈáèÁöÑËøûËæπÊñπÂêëÊòØÂõ∫ÂÆöÁöÑÔºâ</p><p>Áé∞Âú®ËÄÉËôë‰ºòÂåñ<br>$$<br>\frac{f_n}{n!} = \frac{g_n}{n!} - \sum\limits_{j = 1}^{n - 1} \frac{f_j}{j!}\frac{g_{n - j}}{(n - j)!}<br>$$</p><p>‰ª§ÊåáÊï∞ÂûãÁîüÊàêÂáΩÊï∞ $F(x) = \sum\limits_n^{\infty} \frac{f_n}{n!}, G(x) = \sum\limits_n^{\infty} \frac{g_n}{n!}$ÔºåÊòìÁü•<br>$$<br>\begin{aligned}<br>F(x) &amp;= G(x) - F(x)G(x) \\<br>F(x) &amp;= \frac{G(x)}{1 + G(x)}<br>\end{aligned}<br>$$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFT</span> <span class="params">(LL* a, <span class="keyword">int</span> limit, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">LL omega = power (inv == <span class="number">1</span> ? g : invg, <span class="number">1l</span>l * (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">LL x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * omega % MOD) &#123;</span><br><span class="line">LL a1 = a[j + k], xa2 = x * a[j + mid + k] % MOD;</span><br><span class="line">a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">a[j + mid + k] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">LL a1[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;, a2[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* A, LL* B, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> limit, lim;</span><br><span class="line"><span class="keyword">for</span> (limit = <span class="number">1</span>, lim = <span class="number">0</span>; limit &lt; n + m; limit &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">a1[i] = a2[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">a1[i] = A[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i ++)</span><br><span class="line">a2[i] = B[i];</span><br><span class="line">DFT (a1, limit, <span class="number">1</span>), DFT (a2, limit, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">a1[i] = a1[i] * a2[i] % MOD;</span><br><span class="line">DFT (a1, limit, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (limit, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">A[i] = a1[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL temp[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* A, LL* B)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123;</span><br><span class="line">B[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, A, B);</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= (deg &lt;&lt; <span class="number">1</span>); n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">temp[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">temp[i] = A[i];</span><br><span class="line">NTT (temp, B, deg, deg), NTT (temp, B, deg, deg);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">B[i] = (<span class="number">2l</span>l * B[i] % MOD - temp[i] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">LL F[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL G[MAXN]= &#123;<span class="number">0</span>&#125;, invG[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL answer[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; N);</span><br><span class="line">fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">F[i] = G[i] = power (<span class="number">2l</span>l, <span class="number">1l</span>l * i * (i - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) * power (fact[i], MOD - <span class="number">2</span>);</span><br><span class="line">G[<span class="number">0</span>] ++;</span><br><span class="line">inverse (N, G, invG);</span><br><span class="line">NTT (F, invG, N, N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i == <span class="number">1</span>)</span><br><span class="line">answer[i] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">2</span>)</span><br><span class="line">answer[i] = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">answer[i] = fact[i - <span class="number">1</span>] * power (<span class="number">2l</span>l, <span class="number">1l</span>l * i * (i - <span class="number">1</span>) / <span class="number">2l</span>l - i) % MOD * power (F[i] * fact[i] % MOD, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, answer[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> ÁîüÊàêÂáΩÊï∞ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ÂØºÊï∞‰∏éÁßØÂàÜ</title>
      <link href="/2020/08/04/%E5%AF%BC%E6%95%B0%E4%B8%8E%E7%A7%AF%E5%88%86/"/>
      <url>/2020/08/04/%E5%AF%BC%E6%95%B0%E4%B8%8E%E7%A7%AF%E5%88%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="ÂØºÊï∞"><a href="#ÂØºÊï∞" class="headerlink" title="ÂØºÊï∞"></a>ÂØºÊï∞</h2><h3 id="Âπ≥ÂùáÂèòÂåñÁéá"><a href="#Âπ≥ÂùáÂèòÂåñÁéá" class="headerlink" title="Âπ≥ÂùáÂèòÂåñÁéá"></a>Âπ≥ÂùáÂèòÂåñÁéá</h3><p>ÂáΩÊï∞ $y = f(x)$ ‰ªé $x_1$ Âà∞ $x_2$ ÁöÑÂπ≥ÂùáÂèòÂåñÁéá‰∏∫ $\frac{f(x_2) - f(x_1)}{x_2 - x_1}$ÔºåÁÆÄËÆ∞‰Ωú $\frac{\Delta y}{\Delta x}$</p><h3 id="Áû¨Êó∂ÂèòÂåñÁéá‰∏éÂØºÊï∞"><a href="#Áû¨Êó∂ÂèòÂåñÁéá‰∏éÂØºÊï∞" class="headerlink" title="Áû¨Êó∂ÂèòÂåñÁéá‰∏éÂØºÊï∞"></a>Áû¨Êó∂ÂèòÂåñÁéá‰∏éÂØºÊï∞</h3><p>ÂáΩÊï∞ $y = f(x)$ Âú® $x = x_0$ Â§ÑÁöÑÁû¨Êó∂ÂèòÂåñÁéáÊòØÂáΩÊï∞ $f(x)$ ‰ªé $x_0$ Âà∞ $x_0 + \Delta x$ ÁöÑÂπ≥ÂùáÂèòÂåñÁéáÂú® $\Delta x \to 0$ Êó∂ÁöÑÊûÅÈôêÔºåËÆ∞‰Ωú $\lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x) - f(x)}{\Delta x} = \lim_{\Delta x \to 0} \frac{\Delta y}{\Delta x}$</p><p>‰∏ÄËà¨Âú∞ÔºåÊàë‰ª¨Áß∞‰∏äÊñáÁöÑÁû¨Êó∂ÂèòÂåñÁéá‰∏∫ÂáΩÊï∞ $y = f(x)$ Âú® $x = x_0$ Â§ÑÁöÑÂØºÊï∞ÔºåËÆ∞‰Ωú $f‚Äô(x_0)$ Êàñ $\frac{\mathrm{d} y}{\mathrm{d} x} \bigg|_{x = x_0}$</p><p>ÂÆûÈôÖ‰∏äÔºåÂØºÊï∞ÊèèËø∞ÁöÑÂç≥‰∏∫‰ªª‰Ωï‰∫ãÁâ©ÁöÑÁû¨Êó∂ÂèòÂåñÁéá</p><p>ExampleÔºö</p><p>Ê±Ç $y = f(x) = x^2 - 7x + 5$ Âú® $x = 2$ ÁöÑÂØºÊï∞ÔºåÂàôÊúâ<br>$$<br>\begin{aligned} \frac{\Delta y}{\Delta x} &amp;= \frac{f(2 + \Delta x) - f(2)}{\Delta x} \\ &amp;= \Delta x - 3  \end{aligned}<br>$$<br>ÊâÄ‰ª•<br>$$<br>f‚Äô(2) = \lim\limits_{\Delta x \to 0} \frac{\Delta y}{\Delta x} = \lim\limits_{\Delta x \to 0} (\Delta x - 3) = - 3<br>$$</p><h3 id="Â∏∏ËßÅÁöÑÂü∫Êú¨ÂàùÁ≠âÂáΩÊï∞ÁöÑÂØºÊï∞ÂÖ¨Âºè"><a href="#Â∏∏ËßÅÁöÑÂü∫Êú¨ÂàùÁ≠âÂáΩÊï∞ÁöÑÂØºÊï∞ÂÖ¨Âºè" class="headerlink" title="Â∏∏ËßÅÁöÑÂü∫Êú¨ÂàùÁ≠âÂáΩÊï∞ÁöÑÂØºÊï∞ÂÖ¨Âºè"></a>Â∏∏ËßÅÁöÑÂü∫Êú¨ÂàùÁ≠âÂáΩÊï∞ÁöÑÂØºÊï∞ÂÖ¨Âºè</h3><table><thead><tr><th align="center">$f(x)$</th><th align="center">$f‚Äô(x)$</th><th align="center">$f(x)$</th><th align="center">$f‚Äô(x)$</th></tr></thead><tbody><tr><td align="center">$c$</td><td align="center">$0$</td><td align="center">$x^a$</td><td align="center">$ax^{a - 1}$</td></tr><tr><td align="center">$\sin x$</td><td align="center">$\cos x$</td><td align="center">$\cos x$</td><td align="center">$- \sin x$</td></tr><tr><td align="center">$a^x$</td><td align="center">$a^x \ln a$</td><td align="center">$e^x$</td><td align="center">$e^x$</td></tr><tr><td align="center">$\log_a x$</td><td align="center">$\frac{1}{x \ln a}$</td><td align="center">$\ln x$</td><td align="center">$\frac{1}{x}$</td></tr><tr><td align="center">$\tan x$</td><td align="center">$\sec^2 x = \frac{1}{\cos^2 x}$</td><td align="center">$\cot x$</td><td align="center">$- \csc^2 x = - \frac{1}{\sin^2 x}$</td></tr></tbody></table><h3 id="Ê±ÇÂØºÊ≥ïÂàô"><a href="#Ê±ÇÂØºÊ≥ïÂàô" class="headerlink" title="Ê±ÇÂØºÊ≥ïÂàô"></a>Ê±ÇÂØºÊ≥ïÂàô</h3><p>$$<br>[f(x) \pm g(x)]‚Äô = f‚Äô(x) \pm g‚Äô(x) \\<br>[cf(x)]‚Äô = cf‚Äô(x) \\<br>[f(x) \cdot g(x)]‚Äô = f‚Äô(x)g(x) + f(x)g‚Äô(x) \\<br>[\frac{f(x)}{g(x)}]‚Äô = \frac{f‚Äô(x)g(x) - f(x)g‚Äô(x)}{[g(x)]^2}<br>$$</p><p>Â§çÂêàÂáΩÊï∞ $y = f(g(x))‚Äã$ ÁöÑÂØºÊï∞ÂíåÂáΩÊï∞ $y = f(u), u = g(x)‚Äã$ ÁöÑÂØºÊï∞Èó¥ÁöÑÂÖ≥Á≥ª‰∏∫ $y_x‚Äô = y_u‚Äô \cdot u_x‚Äô‚Äã$ÔºåÂç≥ $y‚Äã$ ÂØπ $x‚Äã$ ÁöÑÂØºÊï∞ÔºåÁ≠â‰∫é $y‚Äã$ ÂØπ $u‚Äã$ ÁöÑÂØºÊï∞‰∏é $u‚Äã$ ÂØπ $x‚Äã$ ÁöÑÂØºÊï∞ÁöÑ‰πòÁßØ</p><p>ExampleÔºö</p><p>ÂØπ $y = cos^2 \left(2x + \frac{\pi}{3}\right)$ Ê±ÇÂØº<br>$$<br>Ëøô‰∏™Â§çÂêàÂáΩÊï∞ÊòØ f(x) = x^2 Â•ó f(x) = \cos x Â•ó f(x) = 2x + \frac{\pi}{3} \\<br>ÂÆπÊòìÂæóÂà∞ y‚Äô = -4\sin (2x + \frac{\pi}{3})\cos (2x + \frac{\pi}{3}) \\<br>ÂàôÊúâ y‚Äô = -2\sin (4x + \frac{2\pi}{3})<br>$$</p><h3 id="ÂÅèÂØºÊï∞"><a href="#ÂÅèÂØºÊï∞" class="headerlink" title="ÂÅèÂØºÊï∞"></a>ÂÅèÂØºÊï∞</h3><p>Â¶ÇÊûúÊúâÂáΩÊï∞Ëá™ÂèòÈáè‰∏™Êï∞Â§ß‰∫é‰∏ÄÔºåÂ¶Ç<br>$$<br>f(x, y) = x^2 + xy + y^2<br>$$<br>ÈÇ£‰πàÂèØ‰ª•Âõ∫ÂÆö‰∏Ä‰∏™Âπ≥Èù¢ÔºåÂ¶Ç $x$ Âπ≥Èù¢ÔºåÈÇ£‰πà $f(x, y)$ ÂèØ‰ª•Áúã‰ΩúÊòØÂÖ≥‰∫é $y$ ÁöÑÂèÇÊï∞ÂáΩÊï∞ $f_x(y)$Ôºå‰πüÂ∞±ÊòØËØ¥ÊØè‰∏™ $x$ ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™‰∏ÄÂÖÉÂáΩÊï∞ $f_x(y)$</p><p>ÊØîÂ¶ÇÁé∞Âú®‰ª§ $x = a$ÔºåÂàôÊúâ<br>$$<br>f_a(y) = a^2 + ay + y^2<br>$$<br>ÂØπÂÖ∂Ê±ÇÂØºÔºåÂàôÊúâ<br>$$<br>f‚Äô_a(y) = a + 2y<br>$$<br>ÈÇ£‰πàÂØπ‰∫éÊâÄÊúâ $x$ ÁöÑÂèñÂÄºÔºåÂÆö‰πâ<br>$$<br>\frac{\partial f}{\partial y}(x, y) = x + 2y<br>$$<br>ËøôÂ∞±ÊòØ $f$ ÂÖ≥‰∫é $y$ ÁöÑÂÅèÂØºÊï∞</p><p>ÈÇ£‰πàÂØπ‰∫éÂ§öÂÖÉÂáΩÊï∞ $f(x_1, x_2, ‚Ä¶, x_n)$ Âú®ÁÇπ $(a_1, a_2, ‚Ä¶, a_n)$ ÂÖ≥‰∫é $x_k$ ÁöÑÂÅèÂØºÊï∞ÂÆö‰πâ‰∏∫<br>$$<br>\frac{\partial f}{\partial x_k}(a_1, ‚Ä¶, a_n) = \lim\limits_{\Delta x_k \to -} \frac{f(a_1, ‚Ä¶, a_k + \Delta x_k, ‚Ä¶, a_n) - f(a_1, ‚Ä¶, a_n)}{\Delta x_k}<br>$$<br>ËøôÂ∞±ÂÅöÂà∞‰∫ÜÂÅèÂØºÊï∞ÈÄöËøá‰∏ÄÂÖÉÂáΩÊï∞ËøõË°åËÆ°ÁÆó</p><p>ËøôËØ¥Êòé<br>$$<br>\frac{\partial f}{\partial x_k}(a_1, ‚Ä¶, a_n) = \frac{\mathrm{d} f(a_1, ‚Ä¶, a_{k - 1}, a_{k + 1}, ‚Ä¶, a_n)}{\mathrm{d} x_k}(a_1, ‚Ä¶, a_n)<br>$$</p><h3 id="È´òÈò∂ÂØºÊï∞"><a href="#È´òÈò∂ÂØºÊï∞" class="headerlink" title="È´òÈò∂ÂØºÊï∞"></a>È´òÈò∂ÂØºÊï∞</h3><h4 id="‰∫åÈò∂ÂØºÊï∞"><a href="#‰∫åÈò∂ÂØºÊï∞" class="headerlink" title="‰∫åÈò∂ÂØºÊï∞"></a>‰∫åÈò∂ÂØºÊï∞</h4><p>Â¶Ç‰ΩïÂáΩÊï∞ÁöÑÂØºÊï∞ $f‚Äô(x)$ Âú® $x$ Â§ÑÂèØÂØºÔºåÂàôÁß∞ $[f‚Äô(x)]‚Äô$ ‰∏∫ $x$ ÁöÑ‰∫åÈò∂ÂØºÊï∞</p><h4 id="È´òÈò∂ÂØºÊï∞-1"><a href="#È´òÈò∂ÂØºÊï∞-1" class="headerlink" title="È´òÈò∂ÂØºÊï∞"></a>È´òÈò∂ÂØºÊï∞</h4><p>ÈÇ£‰πàÈ´òÈò∂ÂØºÊï∞ÁöÑÂÆö‰πâÂç≥‰∏∫‰∫åÈò∂ÂØºÊï∞ÁöÑÊâ©Â±ï</p><p>$n$ Èò∂ÂØºÊï∞ËÆ∞‰Ωú $f^{(n)}(x), y^{(n)}, \frac{\mathrm{d}^ny}{\mathrm{d}x^n}$ Êàñ $\frac{\mathrm{d}^nf(x)}{\mathrm{d}x^n}$</p><h4 id="È´òÈò∂ÂØºÊï∞Ê±ÇÂØºÊ≥ïÂàô"><a href="#È´òÈò∂ÂØºÊï∞Ê±ÇÂØºÊ≥ïÂàô" class="headerlink" title="È´òÈò∂ÂØºÊï∞Ê±ÇÂØºÊ≥ïÂàô"></a>È´òÈò∂ÂØºÊï∞Ê±ÇÂØºÊ≥ïÂàô</h4><p>$$<br>\frac{\mathrm{d}^n}{\mathrm{d}^nx^n}(cu) = c\frac{\mathrm{d}}{\mathrm{d}x^n}u \\<br>\frac{\mathrm{d}^n}{\mathrm{d}x^n}(u \pm v) = \frac{\mathrm{d}^n}{\mathrm{d}x^n}u \pm \frac{\mathrm{d}^n}{\mathrm{d}x^n}v \\<br>\frac{\mathrm{d}^n}{\mathrm{d}x^n}(u \times v) = \sum\limits_{k = 0}^n \dbinom{n}{k}\frac{\mathrm{d}^{d - k}}{\mathrm{d}x^{d - k}}u\frac{\mathrm{d^k}}{\mathrm{d}x^k}v „ÄåËé±Â∏ÉÂ∞ºÂÖπÂÖ¨Âºè„Äç<br>$$</p><h4 id="Â∏∏Áî®È´òÈò∂ÂØºÊï∞ÂÖ¨Âºè"><a href="#Â∏∏Áî®È´òÈò∂ÂØºÊï∞ÂÖ¨Âºè" class="headerlink" title="Â∏∏Áî®È´òÈò∂ÂØºÊï∞ÂÖ¨Âºè"></a>Â∏∏Áî®È´òÈò∂ÂØºÊï∞ÂÖ¨Âºè</h4><p>$$<br>(x^{\alpha})^{(n)} = x^{\alpha - n} \prod\limits_{k = 0}^{n - 1}(\alpha - k) \\<br>(\frac{1}{x})^{(n)} = (- 1)^n\frac{n!}{x^{n + 1}} \\<br>(\ln x)^{(n)} = (- 1)^{n - 1}\frac{(n - 1)!}{x^n} \\<br>(e^x)^{(n)} = e^x \\<br>(a^x){(n)} = a^x \cdot \ln^n a (a &gt; 0) \\<br>(\sin (kx + b))^{(n)} = k^n\sin (kx + b + \frac{n\pi}{2}) \\<br>(\cos (kx + b))^{(n)} = k^n\cos (kx + b + \frac{n\pi}{2})<br>$$</p><h2 id="ÁßØÂàÜ"><a href="#ÁßØÂàÜ" class="headerlink" title="ÁßØÂàÜ"></a>ÁßØÂàÜ</h2><h3 id="ÂÆöÁßØÂàÜ"><a href="#ÂÆöÁßØÂàÜ" class="headerlink" title="ÂÆöÁßØÂàÜ"></a>ÂÆöÁßØÂàÜ</h3><p>ÂáΩÊï∞ $f(x)$ Âú®Âå∫Èó¥ $[a, b]$ ‰∏äËøûÁª≠ÔºåÁî®ÂàÜÁÇπ $a = x_0 &lt; x_1 &lt; ‚Ä¶ &lt; x_{i - 1} &lt; x_i &lt; ‚Ä¶ &lt; x_n = b$ÔºåÂú®ÊØè‰∏™Â∞èÂå∫Èó¥ $[x_{i - 1}, x_i]$ ‰∏ä‰∫∫Âéª‰∏ÄÁÇπ $\xi (i = 1, 2, ‚Ä¶, n)$Ôºå‰ΩúÂíåÂºè $S_n = \sum\limits_{i = 1}^n f(\xi_i)\Delta x = \sum\limits_{i = 1}^n \frac{b - a}{n} f(\xi_i)$ÔºåÂΩì $n \to \infty$ Êó∂ÔºåÂíåÂºèÊó†ÈôêÊé•ËøëÁöÑÂ∏∏Êï∞Ë¢´Áß∞‰ΩúÂáΩÊï∞ $f(x)$ Âú®Âå∫Èó¥ $[a, b]$ ‰∏äÁöÑÂÆöÁßØÂàÜÔºåËÆ∞‰Ωú $\int_a^b f(x) \mathrm{d} x = \lim\limits_{n \to \infty} \sum\limits_{i = 1}^n \frac{b - a}{n} f(\xi_i)$ Ôºå$a, b$ ÂàÜÂà´Áß∞‰ΩúÁßØÂàÜ‰∏ãÈôê‰∏éÁßØÂàÜ‰∏äÈôêÔºåÂå∫Èó¥ $[a, b]$ Áß∞‰ΩúÁßØÂàÜÂå∫Èó¥Ôºå$f(x)$ Áß∞‰ΩúË¢´ÁßØÂáΩÊï∞Ôºå$x$ Áß∞‰ΩúÁßØÂàÜÂèòÈáèÔºå$f(x)\, \mathrm{d} x$ Áß∞‰ΩúÁßØÂºè</p><p>ÂÖ∂Âá†‰ΩïÊÑè‰πâË°®Á§∫Áî±Áõ¥Á∫ø $x = a, x = b, y = 0‚Äã$ ÂèäÊõ≤Á∫ø $y = f(x)‚Äã$ ÊâÄÂõ¥ÊàêÁöÑÊõ≤ËæπÊ¢ØÂΩ¢Èù¢ÁßØ</p><p>ÂΩì $x \in [a, b]‚Äã$ Êó∂ÔºåËã• $f(x) &lt; 0‚Äã$ÔºåÂàôÁõ¥Á∫ø $x = a, x = b, x‚Äã$ ËΩ¥ÂíåÊõ≤Á∫ø $f(x)‚Äã$ Âõ¥ÊàêÁöÑÂõæÂΩ¢ÁöÑÈù¢ÁßØÂ∫î‰∏∫ $- \int_a^b f(x) \mathrm{d} x‚Äã$</p><h4 id="ÂÆöÁßØÂàÜÁöÑÊÄßË¥®"><a href="#ÂÆöÁßØÂàÜÁöÑÊÄßË¥®" class="headerlink" title="ÂÆöÁßØÂàÜÁöÑÊÄßË¥®"></a>ÂÆöÁßØÂàÜÁöÑÊÄßË¥®</h4><p>$$<br>\int_a^b kf(x) \mathrm{d} x = k\int_a^b f(x) \mathrm{d} \\<br>\int_a^b[f_1(x) \pm f_2(x)] \mathrm{d} x = \int_a^b f_1(x) \mathrm{d} x \pm \int_a^b f_2(x) \mathrm{d} x \\<br>\int_a^b f(x) \mathrm{d} = \int_a^c f(x) \mathrm{d} x + \int_c^b f(x) \mathrm{d} x (ÂÖ∂‰∏≠ a &lt; c &lt; b)<br>$$</p><h3 id="ÂæÆÁßØÂàÜÂü∫Êú¨ÂÆöÁêÜ"><a href="#ÂæÆÁßØÂàÜÂü∫Êú¨ÂÆöÁêÜ" class="headerlink" title="ÂæÆÁßØÂàÜÂü∫Êú¨ÂÆöÁêÜ"></a>ÂæÆÁßØÂàÜÂü∫Êú¨ÂÆöÁêÜ</h3><p>‰∏ÄËà¨Âú∞ÔºåÂ¶ÇÊûú $f(x)$ ÊòØÂå∫Èó¥ $[a, b]$ ‰∏äÁöÑËøûÁª≠ÂáΩÊï∞ÔºåÂπ∂‰∏î $F‚Äô(x) = f(x)$ÔºåÈÇ£‰πà<br>$$<br>\int_a^b f(x) \mathrm{d} x = F(x) \big|_a^b = F(b) - F(a)<br>$$</p><h3 id="‰∏çÂÆöÁßØÂàÜ"><a href="#‰∏çÂÆöÁßØÂàÜ" class="headerlink" title="‰∏çÂÆöÁßØÂàÜ"></a>‰∏çÂÆöÁßØÂàÜ</h3><p>‰∏çÂÆöÁßØÂàÜÂÆûÈôÖ‰∏äÂ∞±ÊòØ $f(x)$ ÁöÑÂéüÂáΩÊï∞ $F(x)$Ôºå$F(x)$ ‰πüË¢´Áß∞‰Ωú $f(x)$ ÁöÑ‰∏çÂÆöÁßØÂàÜ</p><p>ÂáΩÊï∞Êóè $f = \{F(x) + C | C \in \mathbb{R}\}‚Äã$ Áß∞‰∏∫ÂáΩÊï∞ $f = k‚Äã$ ÁöÑÂéüÂáΩÊï∞ÊóèÔºå‰πüÂ∞±ÊòØ $f = k(x)‚Äã$ ÁöÑÊâÄÊúâÂèØËÉΩÁöÑÂéüÂáΩÊï∞ÁöÑÈõÜÂêàÔºåÂÖ∂‰∏≠ $f = C‚Äã$ Áß∞‰ΩúÁßØÂàÜÂ∏∏Êï∞ÔºåÊòØ $f = k(x)‚Äã$ ÁªèËøáÂûÇÁõ¥Âπ≥ÁßªÂæóÂà∞ÁöÑ‰∏ÄÁªÑÂ∏∏Êï∞„ÄåÂõ†‰∏∫‰∏çÁÆ°ÊÄé‰πàÊ†∑ÂØπ‰∫éÊØè‰∏™ $x‚Äã$ ÂÆÉ‰ª¨ÁöÑÂØºÊï∞ÊòØÁõ∏ÂêåÁöÑ„Äç</p><h3 id="Â∏∏ËßÅ‰∏çÂÆöÁßØÂàÜÂÖ¨ÂºèË°®"><a href="#Â∏∏ËßÅ‰∏çÂÆöÁßØÂàÜÂÖ¨ÂºèË°®" class="headerlink" title="Â∏∏ËßÅ‰∏çÂÆöÁßØÂàÜÂÖ¨ÂºèË°®"></a>Â∏∏ËßÅ‰∏çÂÆöÁßØÂàÜÂÖ¨ÂºèË°®</h3><table><thead><tr><th align="center">$\int_a^b c \mathrm{d}x = cx \mid_a^b$</th></tr></thead><tbody><tr><td align="center">$\int_a^b x^n \mathrm{d}x = \frac{1}{n + 1}x^{n + 1} \mid_a^b$</td></tr><tr><td align="center">$\int_a^b \frac{1}{x} \mathrm{d}x = \ln x \mid_a^b$</td></tr><tr><td align="center">$\int_a^b \sin x \mathrm{d}x = - \cos x \mid_a^b$</td></tr><tr><td align="center">$\int_a^b \cos x \mathrm{d}x = \sin x \mid_a^b$</td></tr><tr><td align="center">$\int_a^b e^x \mathrm{d}x = e^x \mid_a^b$</td></tr><tr><td align="center">$\int_a^b a^x \mathrm{d}x = \frac{a^x}{\ln a} \mid_a^b$ $(a &gt; 0$ ‰∏î $a \neq 1)$</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Êï∞Â≠¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êï∞Â≠¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Â≠óÁ¨¶‰∏≤Á±ªÈ¢òËÆ∞ÂΩï</title>
      <link href="/2020/08/04/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2020/08/04/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="ÂêéÁºÄÊï∞ÁªÑ"><a href="#ÂêéÁºÄÊï∞ÁªÑ" class="headerlink" title="ÂêéÁºÄÊï∞ÁªÑ"></a>ÂêéÁºÄÊï∞ÁªÑ</h2><h3 id="Âú®ÊñáÊú¨‰∏≤‰∏≠ÂØªÊâæÂ≠ê‰∏≤"><a href="#Âú®ÊñáÊú¨‰∏≤‰∏≠ÂØªÊâæÂ≠ê‰∏≤" class="headerlink" title="Âú®ÊñáÊú¨‰∏≤‰∏≠ÂØªÊâæÂ≠ê‰∏≤"></a>Âú®ÊñáÊú¨‰∏≤‰∏≠ÂØªÊâæÂ≠ê‰∏≤</h3><p>Âú®ÊñáÊú¨‰∏≤ $T$ ‰∏≠ÂØªÊâæÊ®°Âºè‰∏≤ $S$ÔºåÈÇ£‰πà $S$ ‰∏ÄÂÆöÊòØ $T$ ÁöÑÊüê‰∏™ÂêéÁºÄÁöÑÂâçÁºÄÔºåÂêéÁºÄÊéíÂ∫èÂêéÔºåÂú® $SA$ ‰∏≠‰∫åÂàÜ $S$ ÁöÑ‰ΩçÁΩÆÔºåÊØèÊ¨° $check$ ÊØîËæÉÊó∂Èó¥ $O (|S|)$ÔºåÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶ $O (|S| \log |T|)$</p><h3 id="ÊØîËæÉ‰∏§‰∏™Â≠ê‰∏≤ÁöÑÂ§ßÂ∞èÂÖ≥Á≥ª"><a href="#ÊØîËæÉ‰∏§‰∏™Â≠ê‰∏≤ÁöÑÂ§ßÂ∞èÂÖ≥Á≥ª" class="headerlink" title="ÊØîËæÉ‰∏§‰∏™Â≠ê‰∏≤ÁöÑÂ§ßÂ∞èÂÖ≥Á≥ª"></a>ÊØîËæÉ‰∏§‰∏™Â≠ê‰∏≤ÁöÑÂ§ßÂ∞èÂÖ≥Á≥ª</h3><p>ÊØîËæÉ $S$ ÁöÑÂ≠ê‰∏≤ $A = S[l_1‚Ä¶r_1], B = S[l_2‚Ä¶r_2]$ ÁöÑÂ§ßÂ∞èÂÖ≥Á≥ª</p><p>Ëã• $lcp (l_1, l_2) \ge \min (|A|, |B|)$ÔºåÂàô $A &lt; B \Longleftrightarrow |A| &lt; |B|$ÔºåÂèç‰πã $A &lt; B \Longleftrightarrow rk_{l_1} &lt; rk_{l_2}$</p><h3 id="Êú¨Ë¥®‰∏çÂêåÂ≠ê‰∏≤Êï∞ÁõÆ"><a href="#Êú¨Ë¥®‰∏çÂêåÂ≠ê‰∏≤Êï∞ÁõÆ" class="headerlink" title="Êú¨Ë¥®‰∏çÂêåÂ≠ê‰∏≤Êï∞ÁõÆ"></a>Êú¨Ë¥®‰∏çÂêåÂ≠ê‰∏≤Êï∞ÁõÆ</h3><p>ËÆæÂ≠óÁ¨¶‰∏≤ $S$ ÈïøÂ∫¶‰∏∫ $n$</p><p>$ans = \frac{n(n + 1)}2 - \sum\limits_{i = 2}^n height[i]$</p><h3 id="‰ªéÂ≠óÁ¨¶‰∏≤È¶ñÊàñÂ∞æÂèñÂ≠óÁ¨¶ÊûÑÊàêÊúÄÂ∞èÂ≠óÂÖ∏Â∫èÁöÑÂ≠óÁ¨¶‰∏≤"><a href="#‰ªéÂ≠óÁ¨¶‰∏≤È¶ñÊàñÂ∞æÂèñÂ≠óÁ¨¶ÊûÑÊàêÊúÄÂ∞èÂ≠óÂÖ∏Â∫èÁöÑÂ≠óÁ¨¶‰∏≤" class="headerlink" title="‰ªéÂ≠óÁ¨¶‰∏≤È¶ñÊàñÂ∞æÂèñÂ≠óÁ¨¶ÊûÑÊàêÊúÄÂ∞èÂ≠óÂÖ∏Â∫èÁöÑÂ≠óÁ¨¶‰∏≤"></a>‰ªéÂ≠óÁ¨¶‰∏≤È¶ñÊàñÂ∞æÂèñÂ≠óÁ¨¶ÊûÑÊàêÊúÄÂ∞èÂ≠óÂÖ∏Â∫èÁöÑÂ≠óÁ¨¶‰∏≤</h3><p><a href="https://www.luogu.com.cn/problem/P2870" target="_blank" rel="noopener">[USACO07DEC]Best Cow Line G</a></p><p>ÊúÄÂü∫Êú¨Ë¥™ÂøÉÔºåËã•‰∏§Á´ØÂ≠óÁ¨¶‰∏çÂêåÔºå‰ºòÂÖàÂèñÂ§ßÁöÑÔºåÈÇ£‰πàÈóÆÈ¢òÂ∞±Âú®‰∫é‰∏§Á´ØÁõ∏Âêå</p><p>ËÆæ $pre_i, suf_i$ ÂàÜÂà´Ë°®Á§∫Â≠óÁ¨¶‰∏≤ $i$ ÂºÄÂßãÁöÑÂâç„ÄÅÂêéÁºÄÔºåÈÇ£‰πàÊØèÊ¨°Âè™Ë¶ÅÊØîËæÉ $pre_i$ Âíå $suf_i$ ÁöÑÂ§ßÂ∞èÂ∞±ÂèØ‰ª•ÂÜ≥ÂÆöÔºå‰ΩÜÊòØËøôÊ†∑ÊòØ $O (n^2)$ ÁöÑ</p><p>ËÄÉËôëÂ∞ÜÂèç‰∏≤Èöî‰∏Ä‰∏™ÁâπÊÆäÂ≠óÁ¨¶ÊèíÂú®Âéü‰∏≤ÂêéÔºåË∑ë‰∏ÄËæπÂêéÁºÄÊï∞ÁªÑÔºåÂÅáËÆæÊ≠§Êó∂Âéü‰∏≤Ââ©‰Ωô $[l, r]$ Ê≤°Â§ÑÁêÜÔºåÈÇ£‰πàÂè™Ë¶ÅÊØîËæÉ $SA[2n - l + 2]$ Âíå $SA[r]$ Âç≥ÂèØÔºà‰∏≤‰ª• $1$ ‰∏∫Ëµ∑Âßã‰ΩçÁΩÆÔºâ</p><h3 id="Âà§Êñ≠Â≠óÁ¨¶‰∏≤‰∏≠ÊòØÂê¶Â≠òÂú®ÊüêÂ≠ê‰∏≤‰∏çÈáçÂè†Âú∞Âá∫Áé∞‰∫Ü‰∏§Ê¨°"><a href="#Âà§Êñ≠Â≠óÁ¨¶‰∏≤‰∏≠ÊòØÂê¶Â≠òÂú®ÊüêÂ≠ê‰∏≤‰∏çÈáçÂè†Âú∞Âá∫Áé∞‰∫Ü‰∏§Ê¨°" class="headerlink" title="Âà§Êñ≠Â≠óÁ¨¶‰∏≤‰∏≠ÊòØÂê¶Â≠òÂú®ÊüêÂ≠ê‰∏≤‰∏çÈáçÂè†Âú∞Âá∫Áé∞‰∫Ü‰∏§Ê¨°"></a>Âà§Êñ≠Â≠óÁ¨¶‰∏≤‰∏≠ÊòØÂê¶Â≠òÂú®ÊüêÂ≠ê‰∏≤‰∏çÈáçÂè†Âú∞Âá∫Áé∞‰∫Ü‰∏§Ê¨°</h3><p>‰∫åÂàÜÂ≠ê‰∏≤ÈïøÂ∫¶ $L$ÔºåÂàô $height$ Êï∞ÁªÑËÉΩË¢´ÂàÜ‰∏∫Ëã•Âπ≤Êª°Ë∂≥ÊÆµÂÜÖ $height$ Êï∞ÁªÑÂ§ßÂ∞èÈÉΩ $\ge L$ ÁöÑÊÆµÔºåÂÜçÂà©Áî® $RMQ$ Ê±ÇÂá∫ÊÆµÂÜÖÊúÄÂ§ß‰∏éÊúÄÂ∞èÁöÑ $SA$ ÂÄºÔºåÂà§Êñ≠ÂÖ∂ÊèíÂÄº‰∏é $L$ ÁöÑÂÖ≥Á≥ª</p><h2 id="ÂêéÁºÄËá™Âä®Êú∫"><a href="#ÂêéÁºÄËá™Âä®Êú∫" class="headerlink" title="ÂêéÁºÄËá™Âä®Êú∫"></a>ÂêéÁºÄËá™Âä®Êú∫</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">append</span> <span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fa = last, p = ++ m;</span><br><span class="line">last = p;</span><br><span class="line">len[p] = len[fa] + <span class="number">1</span>, subsize[p] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; ! tr[fa][c])</span><br><span class="line">tr[fa][c] = p, fa = father[fa];</span><br><span class="line"><span class="keyword">if</span> (! fa) &#123; father[p] = <span class="number">1</span>; <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="keyword">int</span> x = tr[fa][c];</span><br><span class="line"><span class="keyword">if</span> (len[x] == len[fa] + <span class="number">1</span>) &#123; father[p] = x; <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="keyword">int</span> np = ++ m;</span><br><span class="line">len[np] = len[fa] + <span class="number">1</span>, father[np] = father[x];</span><br><span class="line">father[x] = father[p] = np;</span><br><span class="line"><span class="built_in">memcpy</span> (tr[np], tr[x], <span class="keyword">sizeof</span> (tr[x]));</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; tr[fa][c] == x)</span><br><span class="line">tr[fa][c] = np, fa = father[fa];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Êú¨Ë¥®‰∏çÂêåÂ≠ê‰∏≤‰∏™Êï∞"><a href="#Êú¨Ë¥®‰∏çÂêåÂ≠ê‰∏≤‰∏™Êï∞" class="headerlink" title="Êú¨Ë¥®‰∏çÂêåÂ≠ê‰∏≤‰∏™Êï∞"></a>Êú¨Ë¥®‰∏çÂêåÂ≠ê‰∏≤‰∏™Êï∞</h3><p>Âª∫Á´ãÂêéÁºÄËá™Âä®Êú∫ÔºåÂú® $parent$ Ê†ë‰∏äÂØπÊâÄÊúâÁä∂ÊÄÅ $u$ÔºåÁªüËÆ° $\sum\limits_u len(u) - fa(len(u))$ Âç≥ÂèØ</p><h3 id="ÊâÄÊúâ‰∏çÂêåÂ≠ê‰∏≤ÁöÑÊÄªÈïøÂ∫¶"><a href="#ÊâÄÊúâ‰∏çÂêåÂ≠ê‰∏≤ÁöÑÊÄªÈïøÂ∫¶" class="headerlink" title="ÊâÄÊúâ‰∏çÂêåÂ≠ê‰∏≤ÁöÑÊÄªÈïøÂ∫¶"></a>ÊâÄÊúâ‰∏çÂêåÂ≠ê‰∏≤ÁöÑÊÄªÈïøÂ∫¶</h3><p>Âª∫Á´ãÂêéÁºÄËá™Âä®Êú∫ÔºåÂú® $parent$ Ê†ë‰∏ä‰∏Ä‰∏™ÁÇπ $u$ ‰ª£Ë°®ÁöÑÊâÄÊúâÂêéÁºÄÁöÑË¥°ÁåÆ‰∏∫ $\frac{(1 + len(u))len(u)}2$ÔºåÁÑ∂ÂêéÂÜçÂáèÂéª $fa(u)$ Áõ∏Â∫îÁöÑË¥°ÁåÆÂç≥ÊòØÂÖ∂ÂáÄË¥°ÁåÆ</p><h3 id="Â≠óÂÖ∏Â∫èÁ¨¨-k-Â§ßÂ≠ê‰∏≤"><a href="#Â≠óÂÖ∏Â∫èÁ¨¨-k-Â§ßÂ≠ê‰∏≤" class="headerlink" title="Â≠óÂÖ∏Â∫èÁ¨¨ $k$ Â§ßÂ≠ê‰∏≤"></a>Â≠óÂÖ∏Â∫èÁ¨¨ $k$ Â§ßÂ≠ê‰∏≤</h3><p><a href="https://www.luogu.com.cn/problem/P3975" target="_blank" rel="noopener">[TJOI2015]Âº¶ËÆ∫</a></p><p>ÂÖ∂‰∏≠ $T$ ‰∏∫ $0$ ÂàôË°®Á§∫‰∏çÂêå‰ΩçÁΩÆÁöÑÁõ∏ÂêåÂ≠ê‰∏≤ÁÆó‰Ωú‰∏Ä‰∏™Ôºå$T$ ‰∏∫ $1$ ÂàôË°®Á§∫‰∏çÂêå‰ΩçÁΩÆÁöÑÁõ∏ÂêåÂ≠ê‰∏≤ÁÆó‰ΩúÂ§ö‰∏™</p><p>Âí±ÊåâÁùÄË∑ØÂæÑÊù•Ëµ∞ÔºåÈÇ£‰πàÊ≠§Êó∂Ëµ∞Âà∞ÁöÑÊØè‰∏™Áä∂ÊÄÅÂØπÂ∫îÂîØ‰∏Ä‰∏Ä‰∏™ÂêéÁºÄÔºåËÆæ $sum_i$ Ë°®Á§∫ËäÇÁÇπ $i$ ËÉΩÂ§üÂà∞ËææÁöÑÊâÄÊúâÂ≠ê‰∏≤‰∏™Êï∞ÔºåÂàùÂßãÂåñ $sum_i$ÔºåËã• $T = 0$ Âàô $sum_i = 1$ÔºåËã• $T = 1$ Âàô $sum_i = size(i)$ÔºåÁÑ∂ÂêéÂÜçÊ±Ç‰∏™ÂíåÔºåÂç≥ $sum_i += \sum\limits_c sum_{trans(i, c)}$</p><p>ÁÑ∂ÂêéÊåâ‰ΩçÂà§Êñ≠Ëµ∞‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">T == <span class="number">0</span> ? Size[i] = Sum[i] = <span class="number">1</span> : Sum[i] = Size[i];</span><br><span class="line">Size[<span class="number">1</span>] = Sum[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = nodes; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j ++)</span><br><span class="line"><span class="keyword">if</span> (Tree[Topo[i]][j])</span><br><span class="line">Sum[Topo[i]] += Sum[Tree[Topo[i]][j]];</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (k &lt;= Size[x]) <span class="keyword">return</span> ;</span><br><span class="line">k -= Size[x];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = Tree[x][i];</span><br><span class="line"><span class="keyword">if</span> (! t) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (k &gt; Sum[t]) &#123; k -= Sum[t]; <span class="keyword">continue</span>; &#125;</span><br><span class="line"><span class="built_in">putchar</span> (i + <span class="string">'a'</span>), print (t, k);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ÊúÄÂ∞èÂæ™ÁéØÁßª‰Ωç"><a href="#ÊúÄÂ∞èÂæ™ÁéØÁßª‰Ωç" class="headerlink" title="ÊúÄÂ∞èÂæ™ÁéØÁßª‰Ωç"></a>ÊúÄÂ∞èÂæ™ÁéØÁßª‰Ωç</h3><blockquote><p>ÁªôÂÆö‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ $S$ÔºåÊ±ÇÂÖ∂Â≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂæ™ÁéØÁßª‰Ωç</p></blockquote><p>‰∏çÈöæÂèëÁé∞ $S + S$ ‰∏ÄÂÆöÂåÖÂê´ $S$ ÁöÑÊúÄÂ∞èÂæ™ÁéØÁßª‰ΩçÔºåÈÇ£‰πàÊûÑÈÄ†Âá∫ $S + S$ ÁöÑÂêéÁºÄËá™Âä®Êú∫ÔºåÁÑ∂ÂêéË¥™ÂøÉËÆøÈóÆÊúÄÂ∞èÁöÑÂ≠óÁ¨¶Âç≥ÂèØ</p><h3 id="Ê®°Âºè‰∏≤Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ"><a href="#Ê®°Âºè‰∏≤Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ" class="headerlink" title="Ê®°Âºè‰∏≤Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ"></a>Ê®°Âºè‰∏≤Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ</h3><blockquote><p>ÁªôÂÆö‰∏Ä‰∏™ÊñáÊú¨‰∏≤ $T$ÔºåÂ§öÁªÑÊü•ËØ¢„ÄÇÊØèÊ¨°Êü•ËØ¢Â≠óÁ¨¶‰∏≤ $P$ Âú®Â≠óÁ¨¶‰∏≤ $T$ ‰∏≠Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆÔºà$P$ ÁöÑÂºÄÂ§¥‰ΩçÁΩÆÔºâ</p></blockquote><p>ËÆæ $firstpos(i)$ Ë°®Á§∫Áä∂ÊÄÅ $i$ ‰ª£Ë°®ÂêéÁºÄÁ¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ</p><p>Âú® $parent$ Ê†ë‰∏äËÄÉËôëÔºåÊòæÁÑ∂Â∫ïÂ±ÇËäÇÁÇπÁöÑ $endpos$ ‰∏ÄÂÆöÊòØÂîØ‰∏ÄÁöÑÔºåÈÇ£‰πàÂÆÉ‰ª¨ÁöÑ $firstpos$ ‰πüÂèØÁõ¥Êé•Á°ÆÂÆöÔºåÈÇ£‰πàÂØπ‰∏Ä‰∏™‰∏çÂú®Â∫ïÂ±ÇÁöÑÁä∂ÊÄÅ $i$ÔºåÊúâ $firstpos(i) = \min\limits_{j \cap fa(j) = i}\{firstpos(j)\}$</p><p>ÂÆûÈôÖ‰∏ä‰∏äËø∞ËøáÁ®ãÂèØ‰ª•Âú®ÊûÑÈÄ†Êó∂ÂÅöÂÆåÔºà‰ª•‰∏ãÊìç‰ΩúÂâçÊèê‰∏∫ $T$ ‰ΩçÁΩÆÁºñÂè∑‰ªé $1$ ÂºÄÂßãÔºâ</p><p>Âú®Êñ∞Âä†ÂÖ•‰∏Ä‰∏™ÁÇπ $p$ Êó∂ÔºåÊúâ $firstpos(p) = len(p)$</p><p>Âú®Â∞ÜËäÇÁÇπ $q$ Â§çÂà∂Âà∞ $np$ Êó∂ÔºåÊúâ $firstpos(np) = \min(firstpos(q), firstpos(p)) = firstpos(q)$</p><p>‰ª§ $t$ Ë°®Á§∫ $P$ Âú® $T$ ‰∏≠Ëµ∞Âà∞ÁöÑÁä∂ÊÄÅÔºåÈÇ£‰πàÁ≠îÊ°à‰æø‰∏∫ $firstpos(t) - |P| + 1$</p><h3 id="ÊúÄÁü≠ÁöÑÊ≤°ÊúâÂá∫Áé∞ËøáÁöÑÂ≠óÁ¨¶‰∏≤"><a href="#ÊúÄÁü≠ÁöÑÊ≤°ÊúâÂá∫Áé∞ËøáÁöÑÂ≠óÁ¨¶‰∏≤" class="headerlink" title="ÊúÄÁü≠ÁöÑÊ≤°ÊúâÂá∫Áé∞ËøáÁöÑÂ≠óÁ¨¶‰∏≤"></a>ÊúÄÁü≠ÁöÑÊ≤°ÊúâÂá∫Áé∞ËøáÁöÑÂ≠óÁ¨¶‰∏≤</h3><blockquote><p>ÁªôÂÆö‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ $S$ Âíå‰∏Ä‰∏™ÁâπÂÆöÁöÑÂ≠óÁ¨¶ÈõÜ $M$ÔºåÊàë‰ª¨Ë¶ÅÊâæ‰∏Ä‰∏™ÈïøÂ∫¶ÊúÄÁü≠ÁöÑÁî± $M$ ‰∏≠Â≠óÁ¨¶ÊûÑÊàêÁöÑÊ≤°ÊúâÂú® $S$ ‰∏≠Âá∫Áé∞ËøáÁöÑÂ≠óÁ¨¶‰∏≤</p></blockquote><p>Âú®ÂêéÁºÄËá™Âä®Êú∫‰∏äÂä®ÊÄÅËßÑÂàíÔºå‰ª§ $f_u$ Ë°®Á§∫Â∑≤ÁªèÂ§ÑÁêÜ‰∫Ü‰∏ÄÊÆµÂ≠ê‰∏≤ÔºåÂΩìÂâçÂú®Áä∂ÊÄÅ $u$Ôºå‰∏∫ÊâæÂà∞‰∏çËøûÁª≠ËΩ¨ÁßªËøòÈúÄË¶ÅÊ∑ªÂä†ÁöÑÊúÄÂ∞ëÂ≠óÁ¨¶Êï∞ÈáèÔºåËΩ¨Áßª‰πüÊØîËæÉÁÆÄÂçï<br>$$<br>f_u = 1 + \min\limits_{c \in M \cap trans(u, c) \in SAM} f_{trans(u, c)}<br>$$<br>ÈÇ£‰πàÊúÄÁªàÁ≠îÊ°à‰∏∫ $f_0$ÔºåËæìÂá∫Â≠óÁ¨¶‰∏≤ÂàôÈÄÜÊé®ÂõûÂéªÂç≥ÂèØ</p><h3 id="‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤"><a href="#‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤" class="headerlink" title="‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤"></a>‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤</h3><blockquote><p>ÁªôÂÆöÂ≠óÁ¨¶‰∏≤ $S$ Âíå $T$ÔºåÊ±ÇÂÆÉ‰ª¨ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤</p></blockquote><p>ÂØπ $S$ ÊûÑÈÄ†ÂêéÁºÄËá™Âä®Êú∫</p><p>ÂØπ $T$ ÁöÑÊØè‰∏™ÂâçÁºÄÔºåËÆæÂΩìÂâçÂâçÁºÄ $[1, i]$ÔºåÊ±ÇÂá∫ËØ•ÂâçÁºÄÁöÑÂú® $S$ ‰∏äÁöÑÊúÄÈïøÂêéÁºÄÈïøÂ∫¶ $l_i$ÔºåÈÇ£‰πàÁ≠îÊ°àÂç≥‰∏∫ $\max\limits_i \{l_i\}$</p><p>Â∞ÜÊØè‰∏™ÂâçÁºÄÊîæÂú®ÂêéÁºÄËá™Âä®Êú∫‰∏äË∑ëÔºåËÆæÂΩìÂâçÂâçÁºÄ $i$ ÊúÄÁªàËµ∞Âà∞Áä∂ÊÄÅ $u$ÔºåÈÇ£‰πàÁé∞Âú®Êâ©Â±ïÂà∞ÂâçÁºÄ $i + 1$ÔºåÂ§öÂá∫Â≠óÁ¨¶ $T_{i + 1} = c$ÔºåÊúâ‰∏§ÁßçÊÉÖÂÜµ</p><ul><li>Â¶ÇÊûúÂ≠òÂú® $trans(u, c)$ÔºåÈÇ£‰πà $u = trans(u, c), l_{i + 1} = l_i + 1$</li><li>Â¶ÇËã•‰∏çÁÑ∂ÔºåÂàôÂú®ÂêéÁºÄËá™Âä®Êú∫ÊâæÂà∞ÂâçÁºÄ $i$ Á¨¨‰∏Ä‰∏™ÁÇπ $p$Ôºå‰ΩøÂÖ∂Êª°Ë∂≥ $trans (p, c)$ Â≠òÂú®ÔºåÂ∞±ÊòØ $p$ Âú® $parent$ ‰∏äÊòØ $u$ ÁöÑÁ•ñÂÖàÔºåÂêåÊó∂ $l_{i + 1} = len(p)$ÔºåÂ¶ÇÊûúÊúÄÁªàÊâæ‰∏çÂà∞ÔºåÈÇ£Â∞±ËøîÂõûÊ∫êÁÇπÔºåÂêåÊó∂ $l_{i + 1} = 0$</li></ul><p>$l_n$ ÊúÄÂ§ö‰∏∫ $|T|$ÔºåËÄåÊØè‰ΩçÂèàÊúÄÂ§öË¢´Âà†‰∏ÄÊ¨°ÔºåÊïÖÊúÄÁªàÊó∂Èó¥Â§çÊùÇÂ∫¶ $O (|S| + |T|)$</p><h3 id="Â§ö‰∏™Â≠óÁ¨¶‰∏≤Èó¥ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤"><a href="#Â§ö‰∏™Â≠óÁ¨¶‰∏≤Èó¥ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤" class="headerlink" title="Â§ö‰∏™Â≠óÁ¨¶‰∏≤Èó¥ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤"></a>Â§ö‰∏™Â≠óÁ¨¶‰∏≤Èó¥ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤</h3><blockquote><p>ÁªôÂÆö $k$ ‰∏™Â≠óÁ¨¶‰∏≤ $S$„ÄÇÊàë‰ª¨ÈúÄË¶ÅÊâæÂà∞ÂÆÉ‰ª¨ÁöÑÊúÄÈïøÂÖ¨ÂÖ±Â≠ê‰∏≤ÔºåÂç≥‰Ωú‰∏∫Â≠ê‰∏≤Âá∫Áé∞Âú®ÊØè‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤ $X$</p></blockquote><p><a href="https://www.spoj.com/problems/LCS2/" target="_blank" rel="noopener">Longest Common Substring II</a></p><p>ËøôÂíåÊ±Ç‰∏§‰∏™ÁöÑÂÆûÈôÖ‰∏äÊòØÂ∑Æ‰∏çÂ§öÁöÑ</p><p>ÂÖàÂØπÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Âª∫‰∏Ä‰∏™ÂêéÁºÄËá™Âä®Êú∫ÔºåÂâ©‰∏ãÁöÑ‰∏≤Âú®‰∏äÈù¢ÂåπÈÖç</p><p>ÂØπ‰∫éÊØè‰∏™ËäÇÁÇπ $i$ÔºåËÆæ $mx_i$ Ë°®Á§∫ÂΩìÂâçÂåπÈÖç‰∏≤Ëµ∞Âà∞Áä∂ÊÄÅ $i$ ÂèØÂåπÈÖçÁöÑÊúÄÈïøÈïøÂ∫¶Ôºå$pl_i$ Ë°®Á§∫Ëµ∞Âà∞Áä∂ÊÄÅ $i$ ÁöÑÊâÄÊúâ‰∏≤Âú®ËØ•Â§ÑÁïô‰∏ãÁöÑÊúÄÈïøÂåπÈÖçÈïøÂ∫¶ÁöÑÊúÄÂ∞èÂÄº</p><p>ÂΩìÁÑ∂ $mx_i$ Ë¶ÅÂÖàÂØπÂÆÉÁöÑÂ≠êÊ†ëÁöÑÊâÄÊúâ $mx$ Âèñ‰∏Ä‰∏™ÊúÄÂ§ßÂÄºÔºåËøôÊ†∑Êñπ‰æøÁªüËÆ°Á≠îÊ°à</p><p>ÈÇ£‰πàÊúÄÂêéÁ≠îÊ°à‰æøÊòØ $\max\limits_i \{pl_i\}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (~ <span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>)) &#123;</span><br><span class="line">n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">1</span>, l = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = str[i] - <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">while</span> (p &amp;&amp; ! tr[p][c])</span><br><span class="line">p = father[p], l = len[p];</span><br><span class="line"><span class="keyword">if</span> (! p) p = <span class="number">1</span>, l = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">l ++, p = tr[p][c];</span><br><span class="line">mx[p] = max (mx[p], l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &gt;= <span class="number">1</span>; i --) &#123;</span><br><span class="line"><span class="keyword">int</span> x = topo[i];</span><br><span class="line">pl[x] = min (pl[x], mx[x]);</span><br><span class="line">mx[father[x]] = max (mx[father[x]], min (len[father[x]], mx[x]));</span><br><span class="line">mx[x] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) ans = max (ans, pl[i]);</span><br></pre></td></tr></table></figure><p>ÂØπÂè¶Â§ñ‰∏ÄÁßçÊñπÊ≥ïÔºåÂ∞±ÊòØÊääÊØè‰∏™Â≠óÁ¨¶‰∏≤Èöî‰∏Ä‰∏™‰∏çÂêåÁöÑÁâπÊÆäÂ≠óÁ¨¶ÊãºÂú®‰∏ÄËµ∑ÔºåÁÑ∂ÂêéÊääÊãºÂ•ΩÁöÑÂ≠óÁ¨¶‰∏≤ÊãøÂéªÂª∫ÂêéÁºÄËá™Âä®Êú∫ÁöÑÊñπÊ≥ïÔºåÊú¨Ë¥®‰∏äÊòØ‰∏ÄÊ†∑ÁöÑ</p><h3 id="Ê±Ç‰∏§‰∏™Â≠óÁ¨¶‰∏≤Êú¨Ë¥®‰∏çÂêåÁöÑÁöÑÂ≠ê‰∏≤ÊÄªÊï∞"><a href="#Ê±Ç‰∏§‰∏™Â≠óÁ¨¶‰∏≤Êú¨Ë¥®‰∏çÂêåÁöÑÁöÑÂ≠ê‰∏≤ÊÄªÊï∞" class="headerlink" title="Ê±Ç‰∏§‰∏™Â≠óÁ¨¶‰∏≤Êú¨Ë¥®‰∏çÂêåÁöÑÁöÑÂ≠ê‰∏≤ÊÄªÊï∞"></a>Ê±Ç‰∏§‰∏™Â≠óÁ¨¶‰∏≤Êú¨Ë¥®‰∏çÂêåÁöÑÁöÑÂ≠ê‰∏≤ÊÄªÊï∞</h3><blockquote><p>ÁªôÂÆöÂ≠óÁ¨¶‰∏≤ $S$ Âíå $T$ÔºåÂπ∂ÁªôÂÆö $l, r$ÔºåÊ±Ç $T$ ‰∏≠‰∏çÂú® $S[l‚Ä¶r]$ ÂÜÖÂá∫Áé∞ÁöÑÂ≠ê‰∏≤‰∏™Êï∞</p></blockquote><p><a href="https://www.luogu.com.cn/problem/P4770" target="_blank" rel="noopener">[NOI2018]‰Ω†ÁöÑÂêçÂ≠ó</a></p><p>ÂÖàËÄÉËôë $l = 1, r = |T|$ ÁöÑÊÉÖÂÜµÔºö</p><p>Âõ†‰∏∫‰ªªÊÑèÂ≠ê‰∏≤‰∏∫Â≠óÁ¨¶‰∏≤ÂâçÁºÄÁöÑÊüê‰∫õÂêéÁºÄÔºåÈÇ£‰πà‰ª§ $lim[i]$ Ë°®Á§∫ $T[1‚Ä¶i]$ Âú® $S$ ‰∏äÊâÄËÉΩÂåπÈÖçÁöÑÊúÄÂ§ßÈïøÂ∫¶Ôºå$posi[i]$ Ë°®Á§∫$T$ÁöÑÂêéÁºÄËá™Âä®Êú∫‰∏äÁöÑÁÇπ $i$ ÁöÑ $endpos$ ÈõÜÂêà‰∏≠ÊúÄÈù†ÂâçÁöÑ‰ΩçÁΩÆÔºåÈÇ£‰πàÁ≠îÊ°àÂç≥‰∏∫<br>$$<br>ans = \sum\limits_i \max (0, len(i) - min (len(fa(i)), lim[posi[i]]))<br>$$<br>ÂÖ∂‰∏≠ $i$ Êûö‰∏æ $T$ ÂêéÁºÄËá™Âä®Êú∫‰∏≠ÁöÑÊâÄÊúâÁÇπ</p><p>Êé•‰∏ãÊù•ËÄÉËôë $l, r$ ‰ªªÊÑèÁöÑÊÉÖÂÜµÔºö</p><p>ÂéüÊù•ËÉΩÂê¶Âú® $S$ ÁöÑÂêéÁºÄËá™Âä®Êú∫‰∏äÂæÄ‰∏ãËµ∞ÁöÑÂà§Êñ≠‰æùÊçÆÂè™ÊúâÂΩìÂâçËäÇÁÇπÊòØÂê¶Â≠òÂú® $c$ ËæπÔºåÈÇ£‰πàÊúâ‰∫Ü $l, r$ ÁöÑÈôêÂà∂ÔºåÂ∞±Â§öÈúÄË¶ÅÂà§Êñ≠Âêë‰∏ãÁöÑËøô‰∏™ËäÇÁÇπÁöÑ $endpos$ ÊòØÂê¶ÊúâÂ≠òÂú®‰∫é $[l + len, r]$Ôºà$len$ Ë°®Á§∫Â∑≤ÂåπÈÖçÈïøÂ∫¶ÔºâÂå∫Èó¥ÁöÑ‰ΩçÁΩÆÔºå$endpos$ ÈõÜÂêàÁî®Âä®ÊÄÅÂºÄÁÇπÁ∫øÊÆµÊ†ëÁª¥Êä§‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><p><a href="https://colythme.github.io/2020/07/01/[NOI2018]‰Ω†ÁöÑÂêçÂ≠ó/">‰ª£Á†Å</a></p><h3 id="Ê±ÇÊâÄÊúâÈïøÂ∫¶‰∏∫-k-ÁöÑÂ≠ê‰∏≤ÁöÑÊúÄÂ§ßÂá∫Áé∞Ê¨°Êï∞"><a href="#Ê±ÇÊâÄÊúâÈïøÂ∫¶‰∏∫-k-ÁöÑÂ≠ê‰∏≤ÁöÑÊúÄÂ§ßÂá∫Áé∞Ê¨°Êï∞" class="headerlink" title="Ê±ÇÊâÄÊúâÈïøÂ∫¶‰∏∫ $k$ ÁöÑÂ≠ê‰∏≤ÁöÑÊúÄÂ§ßÂá∫Áé∞Ê¨°Êï∞"></a>Ê±ÇÊâÄÊúâÈïøÂ∫¶‰∏∫ $k$ ÁöÑÂ≠ê‰∏≤ÁöÑÊúÄÂ§ßÂá∫Áé∞Ê¨°Êï∞</h3><blockquote><p>ÁªôÂÆöÂ≠óÁ¨¶‰∏≤ $S$ÔºåÊ±Ç $S$ ‰∏≠ÈïøÂ∫¶‰∏∫ $k = 1‚Ä¶n$ ÁöÑÂ≠ê‰∏≤ÁöÑÊúÄÂ§ßÂá∫Áé∞Ê¨°Êï∞ÔºàÂØπÊØè‰∏™ $k$ ÂçïÁã¨ËÄÉËôëÔºâ</p></blockquote><p>ËÄÉËôëÂØπÊüê‰∏™ $k$ÔºåÊòæÁÑ∂ÂØπÂÆÉÊúâË¥°ÁåÆÁöÑÂè™ÂèØËÉΩÊòØ $minlen(i) \le k \le maxlen(i)$ ÁöÑÊâÄÊúâÁä∂ÊÄÅ $i$</p><p>Áõ¥Êé•ÁÆóÁöÑËØùÂæóÂª∫Ê£µÁ∫øÊÆµÊ†ëÔºåÂÆûÈôÖ‰∏äÂØπÊüê‰∏™Â≠ê‰∏≤ÔºåÂÆÉÁöÑË¥°ÁåÆ‰∏ÄÂÆöÊòØÂÆÉËá™Â∑±Áõ¥Êé•ÁªôÂá∫Ë¥°ÁåÆÊàñÊòØÂ∞ÜÂÆÉ‰Ωú‰∏∫ÂêéÁºÄÁöÑÂ≠ê‰∏≤ÁªôÂá∫ÁöÑÔºåÊâÄ‰ª•ÊØèÊ¨°Âè™ÈúÄÂú® $maxlen(i)$ Â§ÑÊ†áËÆ∞‰∏Ä‰∏ãÔºåÁÑ∂ÂêéÂÜç $parent$ Ê†ë‰∏äÂØπÂ≠êÊ†ëÊâÄÊúâÁöÑË¥°ÁåÆÂèñ $max$ Â∞±Â•Ω‰∫Ü</p><h3 id="Âπø‰πâÂêéÁºÄËá™Âä®Êú∫"><a href="#Âπø‰πâÂêéÁºÄËá™Âä®Êú∫" class="headerlink" title="Âπø‰πâÂêéÁºÄËá™Âä®Êú∫"></a>Âπø‰πâÂêéÁºÄËá™Âä®Êú∫</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">append</span> <span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> last, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fa = last;</span><br><span class="line"><span class="keyword">if</span> (tr[fa][c]) &#123; <span class="comment">// ‰∏éÂçï‰∏≤ÂêéÁºÄËá™Âä®Êú∫‰∏çÂêåÂ§Ñ</span></span><br><span class="line"><span class="keyword">int</span> x = tr[fa][c];</span><br><span class="line"><span class="keyword">if</span> (len[x] == len[fa] + <span class="number">1</span>) &#123; subsize[x][id] = <span class="number">1</span>; <span class="keyword">return</span> x; &#125; <span class="comment">// ÁâπÂà§‰∏Ä</span></span><br><span class="line"><span class="keyword">int</span> np = ++ m;</span><br><span class="line">father[np] = father[x], len[np] = len[fa] + <span class="number">1</span>;</span><br><span class="line">father[x] = np;</span><br><span class="line"><span class="built_in">memcpy</span> (tr[np], tr[x], <span class="keyword">sizeof</span> (tr[x]));</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; tr[fa][c] == x)</span><br><span class="line">tr[fa][c] = np, fa = father[fa];</span><br><span class="line">subsize[np][id] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> np; <span class="comment">// ÁâπÂà§‰∫å</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> p = ++ m;</span><br><span class="line">len[p] = len[fa] + <span class="number">1</span>, subsize[p][id] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; ! tr[fa][c])</span><br><span class="line">tr[fa][c] = p, fa = father[fa];</span><br><span class="line"><span class="keyword">if</span> (! fa) &#123; father[p] = <span class="number">1</span>; <span class="keyword">return</span> p; &#125;</span><br><span class="line"><span class="keyword">int</span> x = tr[fa][c];</span><br><span class="line"><span class="keyword">if</span> (len[x] == len[fa] + <span class="number">1</span>) &#123; father[p] = x; <span class="keyword">return</span> p; &#125;</span><br><span class="line"><span class="keyword">int</span> np = ++ m;</span><br><span class="line">father[np] = father[x], len[np] = len[fa] + <span class="number">1</span>;</span><br><span class="line">father[p] = father[x] = np;</span><br><span class="line"><span class="built_in">memcpy</span> (tr[np], tr[x], <span class="keyword">sizeof</span> (tr[x]));</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; tr[fa][c] == x)</span><br><span class="line">tr[fa][c] = np, fa = father[fa];</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> last;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>); <span class="keyword">int</span> n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line">last = <span class="number">1</span>; <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++) last = append (str[j] - <span class="string">'a'</span>, last, i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Ê≥®ÊÑè $size$ Ë¶ÅÂØπÊØè‰∏™‰∏≤ÂàÜÂºÄÂ≠ò</p><h3 id="Á∫øÊÆµÊ†ëÂêàÂπ∂Áª¥Êä§Âπø‰πâÂêéÁºÄËá™Âä®Êú∫-size"><a href="#Á∫øÊÆµÊ†ëÂêàÂπ∂Áª¥Êä§Âπø‰πâÂêéÁºÄËá™Âä®Êú∫-size" class="headerlink" title="Á∫øÊÆµÊ†ëÂêàÂπ∂Áª¥Êä§Âπø‰πâÂêéÁºÄËá™Âä®Êú∫ $size$"></a>Á∫øÊÆµÊ†ëÂêàÂπ∂Áª¥Êä§Âπø‰πâÂêéÁºÄËá™Âä®Êú∫ $size$</h3><p><a href="http://codeforces.com/problemset/problem/666/E" target="_blank" rel="noopener">Forensic Examination</a></p><blockquote><p>Áªô‰Ω†‰∏Ä‰∏™‰∏≤ $S$ ‰ª•Âèä $m$ ‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑ $T_1, T_2, ‚Ä¶, T_m$Ôºå$q$ Ê¨°ËØ¢ÈóÆÔºåÊØèÊ¨°ÈóÆ $S$ ÁöÑÂ≠ê‰∏≤ $S[p_l‚Ä¶p_r]$ Âú® $T_l, ‚Ä¶, T_r$ ‰∏≠ÁöÑÂì™‰∏™‰∏≤ÈáåÁöÑÂá∫Áé∞Ê¨°Êï∞ÊúÄÂ§öÔºåÂπ∂ËæìÂá∫Âá∫Áé∞Ê¨°Êï∞„ÄÇÂ¶ÇÊúâÂ§öËß£ËæìÂá∫ÊúÄÈù†ÂâçÁöÑÈÇ£‰∏Ä‰∏™</p></blockquote><p>ÂØπÊâÄÊúâ‰∏≤Âª∫Á´ãÂπø‰πâÂêéÁºÄËá™Âä®Êú∫ÔºåÂºÄ‰∏ÄÊ£µÂå∫Èó¥‰∏∫ $[1, m]$ ÁöÑÁ∫øÊÆµÊ†ëÔºåÂ∞ÜÊØè‰∏™Áä∂ÊÄÅÁöÑ $size$ Â≠ò‰∏ãÊù•ÔºàÁ±ª‰ºº $\text{modify} (rt[p], 1, m, id)$ÔºåÂÖ∂‰∏≠ $id$ Ë°®Á§∫ÂΩìÂâçÊèíÂÖ•ÁöÑÊòØ $m$ ‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂì™‰∏™ÔºåÊ≥®ÊÑè $S$ ÊèíÂÖ•ÂêéÁºÄËá™Âä®Êú∫Êó∂Â∞±‰∏çÁî®‰øÆÊîπÁ∫øÊÆµÊ†ë‰∫ÜÔºâÔºåÂπ∂ËøõË°åÁ∫øÊÆµÊ†ëÂêàÂπ∂</p><p>ÈÇ£‰πàÊØèÊ¨°Âè™Ë¶ÅÂú® $parent$ Ê†ë‰∏äÂÄçÂ¢ûË∑≥Âà∞ÂåÖÂê´Âå∫Èó¥ $S[p_l‚Ä¶p_r]$ ÁöÑÁÇπÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•ÁªüËÆ°ÂÖ∂ÂØπÂ∫îÁ∫øÊÆµÊ†ë $[l, r]$ Âå∫Èó¥ÁöÑÊúÄÂ§ßÂÄºÔºàÂç≥ÂÆÉÂ≠êÊ†ëÁöÑÁ≠îÊ°àÔºâ</p><h3 id="Parent-Ê†ë‰∏ä‰∏§ÁÇπÈó¥Ë∑ùÁ¶ª"><a href="#Parent-Ê†ë‰∏ä‰∏§ÁÇπÈó¥Ë∑ùÁ¶ª" class="headerlink" title="$Parent$ Ê†ë‰∏ä‰∏§ÁÇπÈó¥Ë∑ùÁ¶ª"></a>$Parent$ Ê†ë‰∏ä‰∏§ÁÇπÈó¥Ë∑ùÁ¶ª</h3><p><a href="https://www.luogu.com.cn/problem/P4248" target="_blank" rel="noopener">[AHOI2013]Â∑ÆÂºÇ</a></p><blockquote><p>ÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $n$ ÁöÑÂ≠óÁ¨¶‰∏≤ $S$Ôºå‰ª§ $T_i$ Ë°®Á§∫ÂÆÉ‰ªéÁ¨¨ $i$ ‰∏™Â≠óÁ¨¶ÂºÄÂßãÁöÑÂêéÁºÄÔºåÊ±Ç $\sum\limits_{1 \le i &lt; j \le n} len(T_i) + len(T_j) - 2 \times LCP(T_i, T_j)$</p></blockquote><p>Â∞Ü‰∏≤ÂèçËøáÊù•ÔºåÂêéÁºÄÁöÑÊúÄÈïøÂÖ¨ÂÖ±ÂâçÁºÄÂ∞±ÂèòÊàê‰∫ÜÂâçÁºÄÁöÑÊúÄÈïøÂÖ¨ÂÖ±ÂêéÁºÄ</p><p>‰ª• $len(i) - len(fa(i))$ ‰Ωú‰∏∫Áä∂ÊÄÅ $i$ Âú® $parent$ Ê†ë‰∏äÂà∞Áà∂‰∫≤ÁöÑËæπÊùÉÔºåÈÇ£‰πàÂéüÂºèÂ∞±ÂèØ‰ª•Áúã‰Ωú $parent$ Ê†ë‰∏ä‰∏§‰∏™ÂâçÁºÄÂØπÂ∫îÁöÑÁÇπ $u, v$ ‰πãÈó¥ÁöÑË∑ØÂæÑÈïøÂ∫¶</p><p>Áî±‰∫éÂè™ÊúâÂâçÁºÄÁä∂ÊÄÅÁöÑ $size$ ÊâçÂèØËÉΩË¢´ÂàùÂßãÂåñ‰∏∫ $1$ÔºåÈÇ£‰πàÂØπÁÇπ $i$ Âà∞ÂÖ∂Áà∂‰∫≤ÁöÑËæπÔºåÂÖ∂Ë¥°ÁåÆÂç≥‰∏∫ $w_i \times size(i) \times (n - size(i))$ÔºåÂØπÊâÄÊúâËæπÊ±ÇÂíåÂç≥ÂèØ</p>]]></content>
      
      
      <categories>
          
          <category> ÂΩíÁ∫≥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÂêéÁºÄËá™Âä®Êú∫ </tag>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> ÂΩíÁ∫≥ </tag>
            
            <tag> ÂêéÁºÄÊï∞ÁªÑ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Â§öÈ°πÂºèÊ±ÇÈÄÜ</title>
      <link href="/2020/08/04/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86/"/>
      <url>/2020/08/04/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>È¶ñÂÖàÂÆö‰πâÂ§öÈ°πÂºèÁöÑÂ∫¶Êï∞ $degA$ ‰∏∫Â§öÈ°πÂºè $A(x)$ ÁöÑÊúÄÈ´òÊ¨°Êï∞</p><p>ÈÇ£‰πàÂ§öÈ°πÂºè $A(x)$ ÁöÑÈÄÜÂç≥‰∏∫Â≠òÂú®Â§öÈ°πÂºè $B(x)$ ‰ΩøÂæóÊù°‰ª∂Êª°Ë∂≥Ôºö<br>$$<br>A(x)B(x) \equiv 1 \pmod{x^n}<br>$$</p><h2 id="Ê±ÇËß£ËøáÁ®ã"><a href="#Ê±ÇËß£ËøáÁ®ã" class="headerlink" title="Ê±ÇËß£ËøáÁ®ã"></a>Ê±ÇËß£ËøáÁ®ã</h2><h3 id="ÂàÜÊ≤ª-FFT"><a href="#ÂàÜÊ≤ª-FFT" class="headerlink" title="ÂàÜÊ≤ª $FFT$"></a>ÂàÜÊ≤ª $FFT$</h3><p>ÂØπ $A(x) = \sum\limits_{k = 0}^{n - 1} a_kx^k, B(x) = \sum\limits_{k = 0}^{n - 1} b_kx^k$</p><p>‰ªéÂ∏∏Êï∞È°πËÄÉËôëÔºåÊúâ $b_0 = \frac1{a_0}$ÔºåÂàôÁî± $\sum\limits_{k = 0}^n b_ka_{n - k} = 0$ ÂèØÂæó<br>$$<br>b_k = \sum\limits_{i = 0}^{k - 1} b_i\left(- \frac{a_{k - i}}{a_0}\right)<br>$$</p><h3 id="ÂÄçÂ¢ûËø≠‰ª£"><a href="#ÂÄçÂ¢ûËø≠‰ª£" class="headerlink" title="ÂÄçÂ¢ûËø≠‰ª£"></a>ÂÄçÂ¢ûËø≠‰ª£</h3><p>ÂÅáËÆæÂ≠òÂú®Â§öÈ°πÂºè $A(x)$ Ôºå‰ª•ÂèäÂÖ∂ÈÄÜ $B(x)$ Êª°Ë∂≥Êù°‰ª∂ ÔºåÈÇ£‰πàÂøÖÂÆöÊúâ$A(x)B(x) \equiv 1 \pmod{x^{\left\lceil\frac{n}{2}\right\rceil}}  ‚Ä¶  (1)$ ÔºåÂõ†‰∏∫ $x^n$ ÊòØ $x^{\left\lceil\frac{n}{2}\right\rceil}$ ÁöÑÂÄçÊï∞</p><p>Âπ∂‰∏îÂ≠òÂú® $A(x)B‚Äô(x) \equiv 1 \pmod{x^{\left\lceil\frac{n}{2}\right\rceil}}  ‚Ä¶  (2)$</p><p>$(1) - (2)$ ÔºåÂæó<br>$$<br>\begin{aligned} B(x) - B‚Äô(x) &amp;\equiv 0 \pmod{x^{\left\lceil\frac{n}{2}\right\rceil}}  ‚Ä¶  (3) \\ B(x)^2 - 2B(x)B‚Äô(x) + B‚Äô(x)^2 &amp;\equiv 0 \pmod{x^n} \end{aligned}<br>$$<br>‰∏ä‰∏ÄÊ≠•Ëß£Èáä‰∏Ä‰∏ãÔºåÊòØ‰∏§ËæπÂπ≥Êñπ</p><p>Ëá≥‰∫é‰∏∫‰ªÄ‰πàÊ®°Êï∞‰πüÈúÄË¶ÅÂπ≥ÊñπÔºåÊòØÂõ†‰∏∫ $(3)$ ÂºèÊª°Ë∂≥Â∑¶ËæπÁöÑÂ§öÈ°πÂºèÂú®ÂÖ∂Ê®°ÊÑè‰πâ‰∏ã‰∏∫ $0$ Ôºå‰∏îÂºèÂ≠êÊÅíÊàêÁ´ãÔºåÊïÖÂÖ∂Èô§‰∫ÜÁ¨¨ $x^{\left\lceil\frac{n}{2}\right\rceil}$ È°πÂÖ∂‰ΩôÁ≥ªÊï∞ÁöÜ‰∏∫ $0$ ÔºåÈÇ£‰πàÁé∞Âú®ËÄÉËôë $0 \le x \le n - 1$ ÔºåÂèàÂõ†‰∏∫ $a_i = \sum\limits_{j = 1}^i a_j b_{i - j}$ ÔºåÊâÄ‰ª•ÂøÖÂÆöÂ≠òÂú® $i$ ÊàñËÄÖ $i - j$ Â∞è‰∫é $x^{\left\lceil\frac{n}{2}\right\rceil}$ ÔºåÊïÖ $a_i = 0$ ÔºåÊâÄ‰ª•Âπ≥ÊñπÊó†Â¶®</p><p>Âêå‰πò $A(x)$ ÔºåÁßªÈ°πÔºåÂæó<br>$$<br>B(x) \equiv 2B‚Äô(x) - A(x)B‚Äô(x)^2 \pmod{x^n}<br>$$<br>Âú®ÈÄíÂΩíËøáÁ®ã‰∏≠ÊúÄÂêé‰ºöÈÄíÂΩíÂà∞ $n = 1$ ÔºåÈÇ£‰πàÊ≠§Êó∂ $A(x)B‚Äô‚Äô(x) \equiv c \pmod{x}$ ÔºåÂèñ $c^{- 1}$ Â∞±Â•Ω‰∫Ü</p><p>ÈÇ£‰πàÂÜçÁî® $FFT$ ‰ºòÂåñÂ∞±ÂèØ‰ª•ÂÅöÂà∞ $O (n \log n)$ Ê±ÇËß£</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">LL f[MAXN], invf[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL A[MAXN]= &#123;<span class="number">0</span>&#125;, B[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> oppo[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">LL omega = power (inv == <span class="number">1</span> ? g : invg, (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">LL x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * omega % MOD) &#123;</span><br><span class="line">LL a1 = a[j + k], xa2 = x * a[j + k + mid] % MOD;</span><br><span class="line">a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">a[j + k + mid] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* ps)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123;</span><br><span class="line">ps[<span class="number">0</span>] = power (f[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">Inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, ps);</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt; (deg &lt;&lt; <span class="number">1</span>); n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">A[i] = f[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg &lt;&lt; <span class="number">1</span>; i ++)</span><br><span class="line">B[i] = ps[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">B[i] = B[i] * ((<span class="number">2l</span>l - A[i] * B[i] % MOD + MOD) % MOD) % MOD;</span><br><span class="line">NTT (B, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">ps[i] = B[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">f[i] = getnum ();</span><br><span class="line">Inverse (N, invf);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>)</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld"</span>, invf[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">1 6 3 4 9</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">2 3 3 3 1233 211 23 3 3 322</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Â§öÈ°πÂºè </tag>
            
            <tag> FFT/NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Â§öÈ°πÂºèÊìç‰Ωú</title>
      <link href="/2020/08/04/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%93%8D%E4%BD%9C/"/>
      <url>/2020/08/04/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Â§öÈ°πÂºèÊ±ÇÈÄÜ"><a href="#Â§öÈ°πÂºèÊ±ÇÈÄÜ" class="headerlink" title="Â§öÈ°πÂºèÊ±ÇÈÄÜ"></a>Â§öÈ°πÂºèÊ±ÇÈÄÜ</h2><p>ËØ•ÈÉ®ÂàÜËßÅ <a href="https://colythme.github.io/2020/07/01/Â§öÈ°πÂºèÊ±ÇÈÄÜ/">Â§öÈ°πÂºèÊ±ÇÈÄÜ</a></p><h2 id="Â§öÈ°πÂºèÈô§Ê≥ï-ÂèñÊ®°"><a href="#Â§öÈ°πÂºèÈô§Ê≥ï-ÂèñÊ®°" class="headerlink" title="Â§öÈ°πÂºèÈô§Ê≥ï|ÂèñÊ®°"></a>Â§öÈ°πÂºèÈô§Ê≥ï|ÂèñÊ®°</h2><p>Êúâ $F(x) = G(x)Q(x) + R(x)$ÔºåÁªôÂÆö $F(x)$ ‰∏é $G(x)$ÔºåÊ±ÇËß£ $Q(x), R(x)$ÔºåÂÖ∂‰∏≠ $F(x), G(x)$ ÊúÄÈ´òÊ¨°Êï∞ÂàÜÂà´‰∏∫ $n, m$</p><p>ÊòæÁÑ∂Âú∞Ôºå$Q(x), R(x)$ ÁöÑÊúÄÈ´òÊ¨°Êï∞ÂøÖÂÆö‰∏çË∂ÖËøá $n - m, m - 1$ÔºåËÄÉËôëÂºèÂ≠êÂèòÂΩ¢<br>$$<br>\begin{aligned}<br>&amp;F(x) = G(x)Q(x) + R(x) \\<br>\Rightarrow &amp;F(\frac1x) = G(\frac1x)Q(\frac1x) + R(\frac1x) \\<br>\Rightarrow &amp;x^nF(\frac1x) = x^mG(\frac1x)x^{n - m}Q(\frac1x) + x^{n - m + 1}x^{m - 1}R(\frac1x) \\<br>\end{aligned}<br>$$<br>‰ª§ $A_R(x)$ Ë°®Á§∫ $A(x)$ Á≥ªÊï∞ÁøªËΩ¨ÂêéÂæóÂà∞ÁöÑÂ§öÈ°πÂºèÔºåÂç≥ $A(x)$ Á≥ªÊï∞ $(a_0, a_1, ‚Ä¶, a_n)$Ôºå$A_R(x)$ Á≥ªÊï∞ $(a_n, a_{n - 1}, ‚Ä¶, a_1)$ÔºåÊúâ<br>$$<br>\begin{aligned}<br>\Rightarrow &amp;x^nF(\frac1x) = x^mG(\frac1x)x^{n - m}Q(\frac1x) + x^{n - m + 1}x^{m - 1}R(\frac1x) \\<br>\Rightarrow &amp;F_R(x) = G_R(x)Q_R(x) + x^{n - m + 1}R_R(x) \\<br>\Rightarrow &amp;F_R(x) \equiv G_R(x)Q_R(x) \pmod{x^{n - m + 1}} \\<br>\Rightarrow &amp;Q_R(x) \equiv \frac{F_R(x)}{G_R(x)}<br>\end{aligned}<br>$$<br>ÈÇ£‰πàËøôÊ†∑Â∞±ÂèØ‰ª•Ê±ÇÂá∫ $Q(x)$Ôºå‰πãÂêéÂàôÊúâ $R(x) = F(x) - G(x)Q(x)$</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (n \log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN]= &#123;<span class="number">0</span>&#125;, limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">LL ome = power (inv == <span class="number">1</span> ? g : invg, (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">LL x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome % MOD) &#123;</span><br><span class="line">LL a1 = a[j + k], xa2 = x * a[j + mid + k] % MOD;</span><br><span class="line">a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">a[j + mid + k] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">LL A[MAXN], B[MAXN], f[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span> <span class="params">(LL* X, LL* Y, <span class="keyword">int</span> fn, <span class="keyword">int</span> fm)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= fn + fm; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fn; i ++) A[i] = X[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fm; i ++) B[i] = Y[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = A[i] * B[i] % MOD;</span><br><span class="line">NTT (A, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fn + fm; i ++) X[i] = A[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* a)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123; a[<span class="number">0</span>] = power (f[<span class="number">0</span>], MOD - <span class="number">2</span>); <span class="keyword">return</span> ; &#125;</span><br><span class="line">inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, a);</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= (deg &lt;&lt; <span class="number">1</span>); n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++) A[i] = f[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg &lt;&lt; <span class="number">1</span>; i ++) B[i] = a[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) B[i] = B[i] * ((<span class="number">2l</span>l - A[i] * B[i] % MOD + MOD) % MOD) % MOD;</span><br><span class="line">NTT (B, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++) a[i] = B[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL F[MAXN], G[MAXN], INVG[MAXN];</span><br><span class="line">LL RF[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++) RF[i] = F[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++) f[i] = G[i] = getnum ();</span><br><span class="line">reverse (RF, RF + N + <span class="number">1</span>); reverse (f, f + M + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - M + <span class="number">2</span>; i &lt;= M; i ++) f[i] = <span class="number">0</span>;</span><br><span class="line">inverse (N - M + <span class="number">1</span>, INVG); mul (RF, INVG, N, N - M + <span class="number">1</span>);</span><br><span class="line">reverse (RF, RF + N - M + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - M + <span class="number">1</span>; i &lt;= N; i ++) RF[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N - M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld"</span>, RF[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">mul (RF, G, N - M, M);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) RF[i] = (F[i] - RF[i] + MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld"</span>, RF[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Â§öÈ°πÂºè </tag>
            
            <tag> FFT/NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåJOISC2017Day1„ÄçÁÉüËä±Ê£í</title>
      <link href="/2020/08/04/%E3%80%8CJOISC%202017%20Day%201%E3%80%8D%E7%83%9F%E8%8A%B1%E6%A3%92/"/>
      <url>/2020/08/04/%E3%80%8CJOISC%202017%20Day%201%E3%80%8D%E7%83%9F%E8%8A%B1%E6%A3%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h2><p>Êúâ $N$ ‰∫∫Á´ôÂú®‰∏ÄÊù°Êï∞ËΩ¥‰∏ä„ÄÇ‰ªñ‰ª¨‰∫∫Êâã‰∏Ä‰∏™ÁÉüËä±ÔºåÊØè‰∫∫Êâã‰∏≠ÁöÑÁÉüËä±ÈÉΩÊÅ∞Â•ΩËÉΩÁáÉÁÉß $T$ Áßí„ÄÇÊØè‰∏™ÁÉüËä±Âè™ËÉΩË¢´ÁÇπÁáÉ‰∏ÄÊ¨°„ÄÇ<br>$1$ Âè∑Á´ôÂú®ÂéüÁÇπÔºå$i$ Âè∑ $(1 \le i \le N)$ Âà∞ $1$ Âè∑ÁöÑË∑ùÁ¶ª‰∏∫ $X_i$„ÄÇ‰øùËØÅ $X_1 = 0$Ôºå$X_1, X_2, ‚Ä¶, X_N$ <strong>ÂçïË∞É</strong>ÈÄíÂ¢ûÔºàÂèØËÉΩÊúâ‰∫∫‰ΩçÁΩÆÈáçÂè†Ôºâ<br>ÂºÄÂßãÊó∂Ôºå$K$ Âè∑ÁöÑÁÉüËä±ÂàöÂºÄÂßãÁáÉÁÉßÔºåÂÖ∂‰ªñ‰∫∫ÁöÑÁÉüËä±ÂùáÊú™ÁÇπÁáÉ„ÄÇ‰ªñ‰ª¨ÁöÑÁÇπÁÅ´Â∑•ÂÖ∑Âùè‰∫ÜÔºåÂè™ËÉΩÁî®ÁáÉÁùÄÁöÑÁÉüËä±Â∞ÜÊú™ÁÇπÁáÉÁöÑÁÉüËä±ÁÇπÁáÉ„ÄÇÂΩì‰∏§‰∫∫‰ΩçÁΩÆÈáçÂè†‰∏îÂÖ∂‰∏≠‰∏Ä‰∫∫Êâã‰∏≠ÁöÑÁÉüËä±ÁáÉÁùÄÊó∂ÔºåÂè¶‰∏Ä‰∫∫Êâã‰∏≠ÁöÑÁÉüËä±Â∞±ÂèØ‰ª•Ë¢´ÁÇπÁáÉ„ÄÇÂøΩÁï•ÁÇπÁÅ´ÊâÄÈúÄÊó∂Èó¥„ÄÇ<br>Ê±ÇËá≥Â∞ëÈúÄË¶Å‰ª•Â§öÂø´ÁöÑÈÄüÂ∫¶Ë∑ëÔºåÊâçËÉΩÁÇπÁáÉÊâÄÊúâ‰∫∫ÁöÑÁÉüËä±ÔºàÊ≠§Êó∂ÂèØËÉΩÊúâ‰∫õ‰∫∫ÁöÑÁÉüËä±Â∑≤ÁªèÁÜÑÁÅ≠‰∫ÜÔºâ„ÄÇ<strong>ÈÄüÂ∫¶ÂøÖÈ°ªÊòØ‰∏Ä‰∏™ÈùûË¥üÊï¥Êï∞</strong></p><h2 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h2><p>ÂØπ $100\%$ ÁöÑÊï∞ÊçÆÔºå$1 \le K, N \le 10^5, ~ 1 \le T \le 10^9, ~ 0 \le X_i \le 10^9, ~ X_1 = 0$</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>ÂæàÊòæÁÑ∂ÊâÄÊúâ‰∫∫‰∏ÄÂÆö‰ºö‰∏çÊñ≠ÂêëÊãøÁÉüËä±ÁöÑ‰∫∫Èù†Ëøë</p><p>ÂèØ‰ª•ÂèëÁé∞Ôºå‰∏Ä‰∏™ÊãøÁÉüËä±Ê£íÁöÑ‰∫∫ÂíåÂè¶‰∏Ä‰∏™‰∫∫Áõ∏ÈÅáÊó∂ÔºåËÆ©Âè¶‰∏Ä‰∏™‰∫∫Ë∑üÁùÄÊãøÁÉüËä±ÁöÑ‰∫∫Ëµ∞Áõ¥Ëá≥ÁÉüËä±Âú®ÁÅ≠ÊéâÁöÑÁû¨Èó¥Â∞ÜÁÉüËä±‰º†ÈÄíÁöÑÊÉÖÂÜµÂíåÂú®Áõ∏ÈÅáÊó∂‰º†ÈÄíÊó∂‰∏ÄÊ†∑ÁöÑÔºàÊ≥®ÊÑèÁõ∏ÂØπ‰ΩçÁΩÆÔºå‰ªîÁªÜÊÉ≥‰∏Ä‰∏ãÂ∞±ÂèØ‰ª•ËØÅÊòéÔºâ</p><p>‰πüÂ∞±ÊòØËØ¥ÔºåÊï¥‰∏™ËøáÁ®ãÂèØ‰ª•Áúã‰ΩúÂè™Êúâ‰∏Ä‰∏™ÊãøÁÉüËä±ÁöÑ‰∫∫ÔºåËøõ‰∏ÄÊ≠•Êé®ÁêÜÂèØ‰ª•ÂèëÁé∞ÔºåÊãøÁÉüËä±ÁöÑ‰∫∫ÂíåÂè¶‰∏Ä‰∏™‰∫∫Áõ∏ÈÅáÁ≠â‰ª∑‰∫é‰ªñÁöÑÁÉüËä±ÁáÉÁÉßÊó∂Èó¥Âä†‰∏ä $T$ÔºàÂú®ÊúÄ‰ºòÊÉÖÂÜµ‰∏ãÔºâ</p><p>Âèà‰∏§‰∫∫Áõ∏ÂêëËÄåË°åÊó∂Áõ∏ÂØπÈÄüÂ∫¶‰∏∫ $2v$ÔºåÈÇ£‰πàÂØπ‰∫é‰∏Ä‰∏™Âå∫Èó¥ $[L, R]$ÔºåÂÆÉÊª°Ë∂≥Êù°‰ª∂ÁöÑÂøÖË¶ÅÊù°‰ª∂Âç≥ÊòØ<br>$$<br>2vT(R - L) \ge x_R - x_L<br>$$<br>ËÄåÊàë‰ª¨‰ªé $K$ ÂºÄÂßã‰∏çÊñ≠Âêë‰∏§ËæπÊâ©Â±ïÔºå‰ΩøÂæóÊØèÊ¨°Êâ©Â±ïÈÉΩÊª°Ë∂≥Êù°‰ª∂ÔºåÈÇ£‰πàÊâ©Â±ïÂà∞ $[L, R]$ Êó∂ÔºåËØ•Êù°‰ª∂‰æøÊàê‰∏∫ÂÖÖË¶ÅÊù°‰ª∂</p><p>ÂØπ‰∏äÂºèËøõË°åÂèòÊç¢ÔºåÊúâ<br>$$<br>x_L - 2vTL \ge x_R - 2vTR<br>$$<br>‰∏çÂ¶®‰ª§ $a_i = x_i - 2vTi$ÔºåÈÇ£‰πàËØ•Êù°‰ª∂‰æøËΩ¨Âåñ‰∏∫ $a_L \ge a_R$</p><p>ËøõË°å‰∫åÂàÜÁ≠îÊ°à</p><p>Âú® $check$ Êó∂ËøõË°åË¥™ÂøÉÔºåË¥™ÂøÉÊâ©Â±ïÂΩìÂâçÊâÄÂà∞Âå∫Èó¥ $[l, r]$ÔºåÂØπ $l$Ôºå‰∏çÊñ≠ÊâæÂà∞‰∏Ä‰∏™ $k$Ôºå‰ΩøÂæó $a_k \ge a_l \cap k &lt; l \cap a_k \ge a_r$ÔºåÂØπ $r$ ÂêåÁêÜÔºåÊúÄÁªà‰ºöÊâ©Â±ïÂà∞‰∏Ä‰∏™ÊûÅÂ§ßÂå∫Èó¥ $[ll, lr]$</p><p>Ëã• $ll = 1 \cap lr = N$ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ËøîÂõû $true$ÔºåÂ¶ÇËã•‰∏çÁÑ∂ÔºåÂàôËßÇÂØüÂΩìÂâçÊÉÖÂÜµ</p><p>Áé∞Âú®Â±ÄÈù¢ÊòØ $l, r$ ‰∏çËÉΩÁªßÁª≠ÂæÄÂ∑¶Âè≥Êâ©Â±ïÔºå‰πüÂ∞±ÊòØ $l$ ÂæÄÂ∑¶‰∏çÂ≠òÂú® $a_k \ge a_l$ Êàñ $a_k \ge a_r$Ôºå$r$ ÂæÄÂè≥‰∏çÂ≠òÂú® $a_k \le a_r$ Êàñ $a_k \le a_l$ÔºåÂØπ‰∏çÂ≠òÂú® $a_{k_1} \ge a_r \cup a_{k_2} \le a_l$ ÁöÑÂ±ÄÈù¢ÔºåÊòæÁÑ∂Â∞±Áõ¥Êé•ËøîÂõû $false$ÔºåÈÇ£‰πàÂØπÂè¶‰∏ÄÁßçÂ±ÄÈù¢ÔºåËÄÉËôë $l$ ÂæÄÂ∑¶ÔºåËØ¥Êòé‰∏ÄÊÆµ‰∏ÄÊÆµÁöÑÊúÄÂ§ßÂÄºÊòØÈÄíÂáèÁöÑÔºå‰ΩÜÊòØ‰∏çÂ¶®Â∞ÜÂÖ∂ÂèçËøáÊù•ÔºåÈÇ£‰∏çÂ∞±Âíå‰∏äÈù¢ $K$ ÂæÄ‰∏§ËæπÊâ©Â±ïÁöÑÊÉÖÂÜµ‰∏ÄÊ†∑‰∫ÜÂêóÔºå$r$ ÂæÄÂè≥ÂêåÁêÜÔºåÈÇ£‰πàÁé∞Âú®Ë¶ÅÂÅöÁöÑÂ∞±ÊòØÈáçÊñ∞‰ª§ $l = 1, r = N$ÔºåÁÑ∂ÂêéÂêëÂÜÖÁº©ÔºåÁúãËÉΩÂê¶Áº©Âà∞ $[ll, lr]$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1e09</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K, T;</span><br><span class="line"><span class="keyword">int</span> X[MAXN];</span><br><span class="line"></span><br><span class="line">LL a[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = X[i] - <span class="number">2l</span>l * v * T * i;</span><br><span class="line"><span class="keyword">if</span> (a[<span class="number">1</span>] &lt; a[N]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> l = K, r = K, ll = K, lr = K;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">if</span> (a[i] &gt;= a[ll])</span><br><span class="line">ll = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (a[i] &lt;= a[lr])</span><br><span class="line">lr = i;</span><br><span class="line"><span class="keyword">while</span> (l != ll || r != lr) &#123;</span><br><span class="line"><span class="keyword">int</span> pl, pr; <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (pl = l; pl &gt; ll; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pl - <span class="number">1</span>] &lt; a[r]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[-- pl] &gt;= a[l]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pl &lt; l &amp;&amp; a[pl] &gt;= a[l]) &#123; l = pl; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (pr = r; pr &lt; lr; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pr + <span class="number">1</span>] &gt; a[l]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[++ pr] &lt;= a[r]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pr &gt; r &amp;&amp; a[pr] &lt;= a[r]) &#123; r = pr; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (! suc) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">l = <span class="number">1</span>, r = N;</span><br><span class="line"><span class="keyword">while</span> (l != ll || r != lr) &#123;</span><br><span class="line"><span class="keyword">int</span> pl, pr; <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (pl = l; pl &lt; ll; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pl + <span class="number">1</span>] &lt; a[r]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[++ pl] &gt;= a[l]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pl &gt; l &amp;&amp; a[pl] &gt;= a[l]) &#123; l = pl; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (pr = r; pr &gt; lr; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pr - <span class="number">1</span>] &gt; a[l]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[-- pr] &lt;= a[r]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pr &lt; r &amp;&amp; a[pr] &lt;= a[r]) &#123; r = pr; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (! suc) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum (), T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) X[i] = getnum ();</span><br><span class="line"><span class="keyword">int</span> left = <span class="number">0</span>, right = INF, ans;</span><br><span class="line"><span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (check (mid)) &#123; ans = mid; right = mid - <span class="number">1</span>; &#125;</span><br><span class="line"><span class="keyword">else</span> left = mid + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊÄùÁª¥ </category>
          
          <category> Ë¥™ÂøÉ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊÄùÁª¥ </tag>
            
            <tag> ‰∫åÂàÜÁ≠îÊ°à </tag>
            
            <tag> Ë¥™ÂøÉ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåÁúÅÈÄâÊ®°ÊãüËµõ„ÄçÁü©ÈòµÔºàmatrixÔºâ</title>
      <link href="/2020/08/04/%5B%E7%9C%81%E9%80%89%E6%A8%A1%E6%8B%9F%E8%B5%9B%5D%E7%9F%A9%E9%98%B5%EF%BC%88matrix%EF%BC%89/"/>
      <url>/2020/08/04/%5B%E7%9C%81%E9%80%89%E6%A8%A1%E6%8B%9F%E8%B5%9B%5D%E7%9F%A9%E9%98%B5%EF%BC%88matrix%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h2><p>Êúâ‰∏Ä‰∏™ $n*m$ ÁöÑ $01$ Áü©ÈòµÔºåÁü©Èòµ‰∏≠ $k$ ‰∏™Ê†ºÂ≠êÁöÑÊï∞Â∑≤ÁªèÁ°ÆÂÆöÔºå‰Ω†ÈúÄË¶ÅÊ±ÇÂá∫ÊúâÂ§öÂ∞ëÁßçÊñπÊ°à‰ΩøÂæóÁü©ÈòµÊØèË°åÊØèÂàóÁöÑÂºÇÊàñÂíåÂùá‰∏∫ $1$„ÄÇÂØπ $998244353$ ÂèñÊ®°„ÄÇ</p><h2 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.luogu.org/upload/pic/53120.png" alt=""></p><hr><h3 id="Subtask-1"><a href="#Subtask-1" class="headerlink" title="Subtask 1"></a>Subtask 1</h3><p>Êö¥ÂäõËá™‰∏çÂøÖËØ¥</p><h3 id="Subtask-2"><a href="#Subtask-2" class="headerlink" title="Subtask 2"></a>Subtask 2</h3><p>ÂØπ‰∫é $k = 0$ ÁöÑÊï∞ÊçÆÔºåÂ¶Ç‰ΩïÂÅöÔºü</p><p>ÈÇ£‰πàÊàë‰ª¨Âè™Ë¶ÅÁ©∫Âá∫‰∏ÄÂàóÔºàÊàñ‰∏ÄË°åÊàñÊòØ‰∏ÄË°å‰∏ÄÂàóÔºâÔºåËÆ©ÂÖ∂ÂÆÉÁöÑÊ†ºÂ≠êÈöè‰æøÂ°´ÔºåÂõ†‰∏∫‰∏çÁÆ°ÊÄé‰πàÊ†∑ÔºåÊúÄÂêéÁ©∫Âá∫ÁöÑËøô‰∏ÄÂàóÔºàË°åÔºâÊÄªÊòØÂèØ‰ª•Â∞ÜÊï¥Ë°åÔºàÂàóÔºâÁöÑÂºÇÊàñÂíåÂèò‰∏∫ $1$</p><p>ÂêåÁêÜ $k &lt;= m$ ÁöÑÊï∞ÊçÆÊâæÂá∫‰∏Ä‰∏™ÂÖ®Á©∫ÁöÑÂàóÂ∞±Â•Ω‰∫Ü</p><h3 id="Subtask-3"><a href="#Subtask-3" class="headerlink" title="Subtask 3"></a>Subtask 3</h3><p>‰ªøÁÖß $Subtask  2$ ÁöÑÊÄùË∑ØÔºåËøòÊòØÊâæÂá∫‰∏Ä‰∏™Ë¢´ÈôêÂà∂ÁöÑÊ†ºÂ≠êÊúÄÂ∞ëÁöÑÂàóÔºå‰ª§ËØ•ÂàóË¢´ÈôêÂà∂ÁöÑÊ†ºÂ≠êÊï∞‰∏∫ $p$ÔºåËÄÉËôëÂà∞ $k \le 10m$ÔºåÊïÖ $p \le 10$ÔºåÈÇ£‰πàÂØπ‰∫éÂÖ∂ÂÆÉÂàóÔºåÂè™Ë¶ÅÂÖ≥Ê≥®Ëøô $p$ Ë°å‰ª•ÂèäÂÆÉ‰ª¨Êú¨Ë∫´ÂàóÁöÑÂºÇÊàñÂíåÂ∞±Â•Ω‰∫Ü</p><p>ËÄÉËôë‰ΩøÁî® $DP$ÔºåËÆæ $f_{i, j, k, state}$ Ë°®Á§∫Ââç $i$ ÂàóÂâç $j$ Ë°åÔºåÁõÆÂâçËØ•ÂàóÁöÑÂºÇÊàñÂíå‰∏∫ $k$ÔºåÈÇ£ $p$ Ë°åÁöÑÂºÇÊàñÊÉÖÂÜµÁä∂ÂéãÂêé‰∏∫ $state$</p><p>Â§çÊùÇÂ∫¶ $O (nm2^{\frac{k}{m}})$</p><h3 id="Subtask-4"><a href="#Subtask-4" class="headerlink" title="Subtask 4"></a>Subtask 4</h3><p>Âõ†‰∏∫Áä∂ÊÄÅÊï∞Â§™Â§öÔºåËÄÉËôëËÉΩÂ§üÁõ¥Êé•ËÆ°ÁÆóÁöÑÁä∂ÊÄÅÊï∞Â∞±Áõ¥Êé•Ê∂àÂéª</p><p>ÂØπ‰∫éÈô§‰∫ÜÈÇ£ $p$ Ë°å‰ª•Â§ñËøòÂ≠òÂú®‰∏çË¢´ÈôêÂà∂ÁöÑÊ†ºÂ≠êÁöÑÂàóÔºåÂèØ‰ª•Á©∫Âá∫‰∏Ä‰∏™Ê†ºÂ≠êÔºåÁÑ∂ÂêéÂÖ∂ÂÆÉÊ†ºÂ≠êÈöè‰æøÂ°´ÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∫õÂàóÂà†Âéª</p><p>Âú®Âà†Âéª‰∏äËø∞Âàó‰πãÂâçÔºåËøòË¶ÅËÆ°ÁÆóÂÆÉ‰ª¨ÂØπ‰∫éË°åÁöÑË¥°ÁåÆ</p><p>ÂÅáËÆæÂú® $p$ Ë°åÁöÑÂÖ∂‰∏≠‰∏ÄË°åÔºåÂú®‰∏äËø∞Âàó‰∏≠ËØ•Ë°åÊÄªÂÖ±Êúâ $k$ ‰∏™Á©∫Ê†ºÔºåÈÇ£‰πàÂêåÁêÜËøòÊòØÂè™Ë¶ÅÁïôÂá∫‰∏Ä‰∏™Á©∫Ê†ºÂÖ∂ÂÆÉÈöè‰æøÂ°´ÔºåÊïÖÁ≠îÊ°àË¶ÅÁÆó‰∏ä $2^{k - 1}$</p><p>ÈÇ£‰πàÂØπ‰∫éÊú™Âà†ÂéªÁöÑÂàóÂè™ÈúÄËÄÉËôëÈÇ£ $p$ Ë°åÂ∞±ÂèØ‰ª•‰∫ÜÔºàÂõ†‰∏∫ÂÖ∂ÂÆÉË°å‰∏ÄÂÆöÊòØË¢´ÈôêÂà∂ÁöÑÔºâÔºåÁÑ∂Âêé‰ªøÁÖß $Subtask  3$ ÂÅö $DP$ Âç≥ÂèØ</p><p>Â§çÊùÇÂ∫¶ $O (\frac{k^2}{nm}2^{\frac{k}{m}})$</p><p>ÊÑüËßâÊï¥È¢òÂ∞±ÊòØÂ∞ÜÁ©∫‰∏ÄË°åÁÆóÂºÇÊàñÁöÑÊÄùÊÉ≥ÂÆåÂÖ®Ë¥ØÂΩªÁöÑËØ¥</p><p>Ëá≥‰∫é‰ª£Á†ÅÔºåÊÑüËßâÁêÜËÆ∫‰∏äÈÇ£‰∫õÂ≠òÂú®Á©∫Ê†ºÁöÑË°å $DP$ ‰πãÂêé‰∏çÁÆ°ÂèñÂÖ∂ÂºÇÊàñ‰∏∫ $0$ Êàñ $1$ ÈÉΩÊòØÂèØ‰ª•ÁöÑÔºàÂèØÊÉúÂõ†‰∏∫ÂÜôÂà∞ÂøÉÊÄÅÁàÜÁÇ∏ÁÑ∂ÂêéÂ∞±ÊîæÂºÉ‰∫Ü‰ª£Á†ÅÁöÑËØ¥</p><p>ÔºàËá≥‰∫éËÄÉÂú∫‰∏äËøû $Subtask  2$ ÈÉΩÊ≤°ÊÉ≥Âá∫Êù•ÔºåÂè™ÊòØÁûéÊâì‰∫Ü $k = 0$ ÁöÑËßÑÂæãËÄå‰∏îËøòÊúâÂèØËÉΩÈîôÁöÑÊàëÊÑüËßâÊàëÂ•ΩËèúÂïä</p>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÄßDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåÊ∏ÖÂçéÈõÜËÆ≠2016„Äç‰Ω†ÁöÑÁîüÂëΩÂ∑≤Â¶ÇÈ£é‰∏≠ÊÆãÁÉõÔºàÂç°ÁâπÂÖ∞Êï∞ÁöÑÂè¶‰∏ÄÁßçÁªÑÂêàÊÑè‰πâÔºâ</title>
      <link href="/2020/08/04/%5B%E6%B8%85%E5%8D%8E%E9%9B%86%E8%AE%AD2016%5D%E4%BD%A0%E7%9A%84%E7%94%9F%E5%91%BD%E5%B7%B2%E5%A6%82%E9%A3%8E%E4%B8%AD%E6%AE%8B%E7%83%9B%EF%BC%88%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E7%BB%84%E5%90%88%E6%84%8F%E4%B9%89%EF%BC%89/"/>
      <url>/2020/08/04/%5B%E6%B8%85%E5%8D%8E%E9%9B%86%E8%AE%AD2016%5D%E4%BD%A0%E7%9A%84%E7%94%9F%E5%91%BD%E5%B7%B2%E5%A6%82%E9%A3%8E%E4%B8%AD%E6%AE%8B%E7%83%9B%EF%BC%88%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E7%BB%84%E5%90%88%E6%84%8F%E4%B9%89%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h2><p>Â∞ÜÈ¢òÊÑèËΩ¨Âåñ‰∏Ä‰∏ã</p><p>Êúâ $m = \sum\limits_{i = 1}^n w_i$ ‰∏™Êï∞ÔºåÂâç $n$ ‰∏™‰∏≠Á¨¨ $i$ ‰∏™‰∏∫ $w_i ‚àí 1$ ÔºåÂâ©‰∏ãÁöÑ $m ‚àí n$ ‰∏™Êï∞ÈÉΩÊòØ $‚àí 1$</p><p>Ê±ÇÂØπËøô $m$ ‰∏™Êï∞ $m!$ ÁßçÈáçÊéíÁöÑÊñπÊ°à‰∏≠ÔºåÊúâÂ§öÂ∞ëÁßçÊª°Ë∂≥ÈáçÊéíÂêéÁöÑÂ∫èÂàó‰ªªÊÑèÂâçÁºÄÂíå‰∏ç‰∏∫Ë¥ü</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><h3 id="Âç°ÁâπÂÖ∞Êï∞ÁöÑÂè¶‰∏ÄÁßçÁªÑÂêàÊÑè‰πâ"><a href="#Âç°ÁâπÂÖ∞Êï∞ÁöÑÂè¶‰∏ÄÁßçÁªÑÂêàÊÑè‰πâ" class="headerlink" title="Âç°ÁâπÂÖ∞Êï∞ÁöÑÂè¶‰∏ÄÁßçÁªÑÂêàÊÑè‰πâ"></a>Âç°ÁâπÂÖ∞Êï∞ÁöÑÂè¶‰∏ÄÁßçÁªÑÂêàÊÑè‰πâ</h3><p>È¶ñÂÖàÊúâ‰∏Ä‰∏™ÂºïÁêÜ</p><ul><li>ÁªôÂÆö $n$ ‰∏™ $1$ Âíå $n$ ‰∏™ $- 1$ÔºåÂÆÉ‰ª¨ÁªÑÊàê‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $2n$ ÁöÑÂ∫èÂàó $a$ÔºåÂàôÂøÖÂÆöÂ≠òÂú®‰∏Ä‰∏™ $i$ ‰ΩøÂæóÂ∫èÂàó $a_{i + 1‚Ä¶2n} + a_{1‚Ä¶i}$ Êª°Ë∂≥‰ªªÊÑèÂâçÁºÄÈÉΩ‰∏çÂ∞è‰∫éÈõ∂</li><li>ËØÅÊòé‰πüÂæàÁÆÄÂçïÔºåÊâæÂà∞‰∏Ä‰∏™‰ΩøÂæóÂâçÁºÄÂíåÊúÄÂ∞èÁöÑ‰ΩçÁΩÆ $i$ÔºåËÆæ $s_{i,j}$ Ë°®Á§∫ $a$ ‰∏ä $a_i$ Âà∞ $a_j$ ÁöÑÂíåÔºåÈÇ£‰πàÊòæÁÑ∂ $s_{i + 1, 2n} \ge 0$ÔºåÂØπ $\forall k \in [1, i]$Ôºå$s_{i + 1, 2n} + s_{1, k} \ge 0$</li></ul><p>ÈÇ£‰πàÊé•‰∏ãÊù•Ê±ÇËß£ $n$ ‰∏™ $1$ Âíå $n$ ‰∏™ $- 1$ ÁªÑÊàêÁöÑÂêàÊ≥ïÂ∫èÂàóÔºàÂç≥‰ªªÊÑèÂâçÁºÄÂíå‰∏çÂ∞è‰∫éÈõ∂ÔºâÁöÑÊñπÊ°àÊï∞Ôºå‰πüÂ∞±ÊòØÂç°ÁâπÂÖ∞Êï∞</p><p>$1$ ÁöÑÁºñÂè∑‰∏∫ $1 \sim n$Ôºå$- 1$ ÁöÑÁºñÂè∑‰∏∫ $n + 1 \sim 2n$</p><p>Áé∞Âú®ÂÖàÂÅáÂÆöÊâÄÊúâ $1$ Âíå $- 1$ ÈÉΩÊòØÊúâÊ†áÂè∑ÁöÑÔºåÈÇ£‰πàÊúÄÂêé‰πò‰∏ä‰∏Ä‰∏™ $\frac1{n!n!}$ Â∞±Â•Ω‰∫Ü</p><p>Áî±‰∫éÁõ¥Êé•Áúã $2n$ ÁöÑÁéØÂèØ‰ª•Êñ≠ÁöÑÂú∞ÊñπËæÉÂ§öÊó†Ê≥ïÂ§ÑÁêÜÔºåÊïÖËÄÉËôëÂú®ÂêéÈù¢Êé•‰∏ä‰∏Ä‰∏™ÁºñÂè∑‰∏∫ $2n + 1$ ÁöÑ $- 1$ÔºåÈÇ£‰πàÁé∞Âú®ÈóÆÈ¢òÂ∞±ÂèòÊàêÁªôÂÆö‰∏Ä‰∏™ $2n + 1$ ÈïøÂ∫¶ÁöÑÁéØÔºåÊñ≠ÂºÄÂÖ∂‰∏≠‰∏ÄÂ§Ñ $- 1$ÔºåÂæóÂà∞ÁöÑÂ∫èÂàóÂâç $2n$ È°π‰ªªÊÑèÂâçÁºÄÂíåÈùûË¥üÔºåÂâç $2n + 1$ È°πÂâçÁºÄÂíå‰∏∫ $- 1$</p><p>ÈÇ£‰πàÂíå‰∏äÈù¢ÂêåÊ†∑Âèñ‰∏Ä‰∏™‰ΩøÂâçÁºÄÂíåÊúÄÂ∞èÁöÑ‰ΩçÁΩÆ $i$ÔºàËã•ÊúâÂ§ö‰∏™ÂàôÂèñÊúÄÂ∞èÁöÑÈÇ£‰∏Ä‰∏™ÔºâÔºåÂèØ‰ª•ËØÅÊòé $i$ ‰ΩøÂîØ‰∏ÄÁöÑ</p><p>Â∞±ÈÇ£ÂèñÁ¨¨‰∫å‰∏™‰∏∫‰æãÔºåËÆæÂèñÁ¨¨‰∫å‰∏™‰ΩøÂâçÁºÄÂíåÊúÄÂ∞èÁöÑ‰ΩçÁΩÆ‰∏∫ $j$ÔºåÈÇ£‰πàÊúâ $s_{j + 1, 2n + 1} + s_{1, j} = - 1$ÔºåÂç≥ $s_{j + 1, 2n + 1} + s_{1, i} = - 1$ÔºåËøôÊ†∑Â≠êÂ∞±Â∑≤Áªè‰∏çÊª°Ë∂≥Êù°‰ª∂‰∫Ü</p><p>ËØÅÊòé‰∫ÜÂîØ‰∏ÄÊÄßÔºå‰πüÂ∞±ÊòØËØ¥Êñ≠ÂºÄÊñπÂºèÊòØÂîØ‰∏ÄÁöÑ</p><p>Áî±‰∫éÊ≠§Êó∂ $- 1$ ‰ΩøÊúâÊ†áÂè∑ÁöÑÔºåÊÄªÂÖ±Êúâ $n + 1$ ‰∏™ $- 1$Ôºå‰πüÂ∞±ÊòØËØ¥ÊâÄÊúâ $2n + 1$ ‰∏™ÂÖÉÁ¥†ÁªÑÊàêÁöÑÁéØ‰∏≠Âπ≥ÂùáÊØè $n + 1$ ‰∏™ÁéØÂ∞±Â≠òÂú®‰∏Ä‰∏™Êª°Ë∂≥Êù°‰ª∂ÁöÑÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÂæóÂà∞Âç°ÁâπÂÖ∞Êï∞ÁöÑÈÄöÈ°π<br>$$<br>Cat_n = \frac{\frac{(2n + 1)!}{2n + 1}}{(n + 1)(n!)^2} = \frac{\dbinom{2n}{n}}{n + 1}<br>$$</p><h3 id="ÂõûÂà∞È¢òÁõÆ"><a href="#ÂõûÂà∞È¢òÁõÆ" class="headerlink" title="ÂõûÂà∞È¢òÁõÆ"></a>ÂõûÂà∞È¢òÁõÆ</h3><p>ÂêåÊ†∑ÁöÑÔºåËøô $m$ ‰∏™Êï∞ÁªÑÊàêÁöÑÂ∫èÂàóÂêåÊ†∑‰πüÊª°Ë∂≥Â≠òÂú®‰∏Ä‰∏™‰ΩçÁΩÆ $i$ ‰ΩøÂæó $s_{i + 1, m} + s_{1, i}$ ‰∏çÂ∞è‰∫éÈõ∂</p><p>ÊïÖ‰πüÂú®ËØ•Â∫èÂàóÂêéÈù¢Âä†ÂÖ•‰∏Ä‰∏™ÁºñÂè∑‰∏∫ $m + 1$ ÁöÑ $- 1$ÔºåËøûÊàêÁéØÂêéÊñ≠ÁéØÊñπÂºèÂîØ‰∏Ä</p><p>ÈÇ£‰πàÁ≠îÊ°àÂç≥‰∏∫ $\frac{m!}{m - n + 1}$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">4e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">n = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) m += getnum ();</span><br><span class="line">LL fact = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= m; i ++) fact = fact * i % MOD;</span><br><span class="line">cout &lt;&lt; fact * power (m - n + 1, MOD - 2) % MOD &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁªÑÂêàÊï∞Â≠¶ </tag>
            
            <tag> Âç°ÁâπÂÖ∞Êï∞ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåÂõΩÂÆ∂ÈõÜËÆ≠Èòü„Äçmiddle</title>
      <link href="/2020/08/04/%5B%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%5Dmiddle/"/>
      <url>/2020/08/04/%5B%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%5Dmiddle/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>‰∏ÄÈÅìÂÖ∂ÂÆûÂæàÁÆÄÂçïÁÑ∂ËÄåÊàëËøòÊòØÁûÑ‰∫ÜÈ¢òËß£ÁöÑÈ¢ò</p><p>È¶ñÂÖàËÄÉËôë‰∫åÂàÜÁ≠îÊ°à</p><p>ÊòæÁÑ∂Â∞ÜÂ∞è‰∫é $mid$ ÁöÑËµã‰∏∫ $-1$ÔºåÂ∞ÜÂ§ß‰∫éÁ≠â‰∫é $mid$ Ëµã‰∏∫ $1$</p><p>ÈÇ£‰πàÊòæÁÑ∂ $total =  $ $[q_1, q_2]$ ÊúÄÈïøÂêéÁºÄ $+$ ‰∏≠Èó¥ÂøÖÈÄâ $+$ $[q_3, q_4]$ ÊúÄÈïøÂâçÁºÄ</p><p>ÁÑ∂ÂêéËã• $total \ge 0$ Âàô $check (mid)$ ËøîÂõû $true$</p><p>ÂæàÂ•ΩÁÑ∂ÂêéÊàëÂ∞±‰∏ç‰ºöÂ§ÑÁêÜ‰∫Ü</p><p>‰∫éÊòØÈ¢òËß£Â∞±ËØ¥Â∞ÜÊØè‰∏™ $mid$ Âª∫‰∏ÄÊ£µÁ∫øÊÆµÊ†ëÔºåÁÑ∂ÂêéÁî®‰∏ªÂ∏≠Ê†ëÂ∞±‰∏ç‰ºö $MLE$ÔºàÂ•ΩÂêßÂéüÊù•Êú¨Êù•ÊòØÊÉ≥Âª∫Â∫èÂàó‰∏äÁöÑ‰∏ªÂ∏≠Ê†ëÁöÑËØ¥ÂΩìÁÑ∂Âπ∂‰∏çÂèØË°å</p><p>ÈÇ£‰πàÊØèÊ¨° $check$ Â∞±Âú® $mid$ Âè∑ÁâàÊú¨‰∏äÁöÑÊ†ëÊü•ËØ¢Âç≥ÂèØ</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e04</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXLOG = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXT = MAXN * MAXLOG;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, Q;</span><br><span class="line"><span class="keyword">int</span> a[MAXN], mapp[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> q[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">valueSt</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> subsum;</span><br><span class="line">    <span class="keyword">int</span> lmax, rmax;</span><br><span class="line"></span><br><span class="line">    valueSt () &#123;</span><br><span class="line">        subsum = <span class="number">0</span>;</span><br><span class="line">        lmax = rmax = - INF;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">int</span> ctree[MAXT]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> lson[MAXT]= &#123;<span class="number">0</span>&#125;, rson[MAXT]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">valueSt value[MAXT];</span><br><span class="line"><span class="keyword">int</span> nodes = <span class="number">0</span>;</span><br><span class="line"><span class="function">valueSt <span class="title">maintain</span> <span class="params">(valueSt A, valueSt B)</span> </span>&#123;</span><br><span class="line">    valueSt res;</span><br><span class="line">    res.subsum = A.subsum + B.subsum;</span><br><span class="line">    res.lmax = max (A.lmax, A.subsum + B.lmax);</span><br><span class="line">    res.rmax = max (B.rmax, A.rmax + B.subsum);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span>&amp; root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    root = ++ nodes;</span><br><span class="line">    value[root] = valueSt ();</span><br><span class="line">    <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">        value[root].subsum = value[root].lmax = value[root].rmax = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build (lson[root], left, mid);</span><br><span class="line">    build (rson[root], mid + <span class="number">1</span>, right);</span><br><span class="line">    value[root] = maintain (value[lson[root]], value[rson[root]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span> <span class="params">(<span class="keyword">int</span> pre, <span class="keyword">int</span>&amp; root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi)</span> </span>&#123;</span><br><span class="line">    root = ++ nodes;</span><br><span class="line">    lson[root] = lson[pre], rson[root] = rson[pre];</span><br><span class="line">    value[root] = value[pre];</span><br><span class="line">    <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">        value[root].subsum = value[root].lmax = value[root].rmax = - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (posi &lt;= mid) update (lson[pre], lson[root], left, mid, posi);</span><br><span class="line">    <span class="keyword">else</span> update (rson[pre], rson[root], mid + <span class="number">1</span>, right, posi);</span><br><span class="line">    value[root] = maintain (value[lson[root]], value[rson[root]]);</span><br><span class="line">&#125;</span><br><span class="line">valueSt tans;</span><br><span class="line"><span class="comment">// ‰ª•‰∏ãÊ≥®ÊÑèÔºà‰ª•rmax‰∏∫‰æãÔºâ</span></span><br><span class="line"><span class="comment">// Áî±‰∫équery_sumÊòØÁî±Â∑¶Ëá≥Âè≥Ëµ∞ÔºåÂπ∂‰∏îmaintain‰∏≠ÊòØÂèñBÁöÑrmaxÊàñËÄÖÂ∞ÜA‰∏éBÂêàÂπ∂</span></span><br><span class="line"><span class="comment">// ÈÇ£‰πàÂú®query_sum‰∏≠value[root]‰∏çÂèØËÉΩ‰Ωú‰∏∫B</span></span><br><span class="line"><span class="comment">// ÊïÖÊúÄÁªàËé∑ÂæóÁöÑtans.rmaxÁöÑËµ∑ÂßãÁÇπ‰∏ÄÂÆö‰∏∫q[2]</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query_sum</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) &#123;</span><br><span class="line">        tans = maintain (tans, value[root]);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= mid) query_sum (lson[root], left, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span> (R &gt; mid) query_sum (rson[root], mid + <span class="number">1</span>, right, L, R);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (q[<span class="number">2</span>] + <span class="number">1</span> &lt;= q[<span class="number">3</span>] - <span class="number">1</span>) &#123;</span><br><span class="line">        tans = valueSt (), query_sum (ctree[mid], <span class="number">1</span>, N, q[<span class="number">2</span>] + <span class="number">1</span>, q[<span class="number">3</span>] - <span class="number">1</span>);</span><br><span class="line">        total += tans.subsum;</span><br><span class="line">    &#125;</span><br><span class="line">    tans = valueSt (), query_sum (ctree[mid], <span class="number">1</span>, N, q[<span class="number">1</span>], q[<span class="number">2</span>]);</span><br><span class="line">    total += tans.rmax;</span><br><span class="line">    tans = valueSt (), query_sum (ctree[mid], <span class="number">1</span>, N, q[<span class="number">3</span>], q[<span class="number">4</span>]);</span><br><span class="line">    total += tans.lmax;</span><br><span class="line">    <span class="keyword">return</span> total &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; x, <span class="keyword">const</span> <span class="keyword">int</span>&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a[x] &lt; a[y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        a[i] = getnum (), mapp[i] = i;</span><br><span class="line">    sort (mapp + <span class="number">1</span>, mapp + N + <span class="number">1</span>, comp);</span><br><span class="line">    build (ctree[<span class="number">1</span>], <span class="number">1</span>, N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        ctree[i] = ctree[i - <span class="number">1</span>];</span><br><span class="line">        update (ctree[i - <span class="number">1</span>], ctree[i], <span class="number">1</span>, N, mapp[i - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    Q = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= Q; Case ++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i ++)</span><br><span class="line">            q[i] = (getnum () + ans) % N + <span class="number">1</span>;</span><br><span class="line">        sort (q + <span class="number">1</span>, q + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">1</span>, right = N;</span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            check (mid) ? (ans = a[mapp[mid]], left = mid + <span class="number">1</span>) : right = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">170337785</span></span><br><span class="line"><span class="comment">271451044</span></span><br><span class="line"><span class="comment">22430280</span></span><br><span class="line"><span class="comment">969056313</span></span><br><span class="line"><span class="comment">206452321</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">3 1 0 2</span></span><br><span class="line"><span class="comment">2 3 1 4</span></span><br><span class="line"><span class="comment">3 1 4 0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ÊçÆÁªìÊûÑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÆµÊ†ë </tag>
            
            <tag> ‰∫åÂàÜÁ≠îÊ°à </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåÂõΩÂÆ∂ÈõÜËÆ≠Èòü„ÄçCrashÁöÑÊï∞Â≠óË°®Ê†º</title>
      <link href="/2020/08/04/%5B%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%5DCrash%E7%9A%84%E6%95%B0%E5%AD%97%E8%A1%A8%E6%A0%BC/"/>
      <url>/2020/08/04/%5B%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%5DCrash%E7%9A%84%E6%95%B0%E5%AD%97%E8%A1%A8%E6%A0%BC/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h2><p>Ê±Ç $\sum\limits_{i = 1}^N \sum\limits_{j = 1}^M lcm (i, j)$</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>ÊòìÁü•ÔºåÂéüÂºè<br>$$<br>\sum\limits_{i = 1}^N \sum\limits_{j = 1}^M \frac{ij}{\gcd (i, j)}<br>$$<br>Êûö‰∏æ $\gcd (i, j)$ Ôºå‰∏îÂ∞Ü $d$ ÊèêÂá∫Êù•Âæó<br>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{i = 1}^{\left\lfloor\frac{N}{d}\right\rfloor} \sum\limits_{j = 1}^{\left\lfloor\frac{M}{d}\right\rfloor} ij[(i, j) = 1]<br>$$<br>Â∞ÜÂÖ¨Âºè $\sum\limits_{k | n} \mu(k) = [n = 1]$ ‰ª£ÂÖ•ÔºåÂæó<br>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{i = 1}^{\left\lfloor\frac{N}{d}\right\rfloor} \sum\limits_{j = 1}^{\left\lfloor\frac{M}{d}\right\rfloor} ij \sum\limits_{k | (i, j)} \mu(k)<br>$$<br>Â•óË∑ØÊûö‰∏æ $k$ ÔºåÂæó</p><p>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{k = 1}^{\min (\left\lfloor\frac{N}{d}\right\rfloor, \left\lfloor\frac{M}{d}\right\rfloor)} \mu(k) \sum\limits_{i = 1}^{\left\lfloor\frac{N}{d}\right\rfloor} \sum\limits_{j = 1}^{\left\lfloor\frac{M}{d}\right\rfloor} ij [k | (i, j)]<br>$$<br>ÈÇ£‰πà $ij$ Â≠òÂú®Ë¥°ÁåÆÊó∂ÂÖ∂ÂøÖÂÆöÊòØ $k$ ÁöÑÂÄçÊï∞ÔºåÊïÖ<br>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{k = 1}^{\min (\left\lfloor\frac{N}{d}\right\rfloor, \left\lfloor\frac{M}{d}\right\rfloor)} \mu(k) \sum\limits_{ki = 1}^{\left\lfloor\frac{N}{d}\right\rfloor} \sum\limits_{kj = 1}^{\left\lfloor\frac{M}{d}\right\rfloor} k^2 ij<br>$$<br>Â∞Ü $k$ ÊèêÂá∫ÔºåÂæó<br>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{k = 1}^{\min (\left\lfloor\frac{N}{d}\right\rfloor, \left\lfloor\frac{M}{d}\right\rfloor)} k^2 \mu(k) ( \sum\limits_{i = 1}^{\left\lfloor\frac{N}{kd}\right\rfloor} i) (\sum\limits_{j = 1}^{\left\lfloor\frac{M}{kd}\right\rfloor} j)<br>$$<br>ÈÇ£‰πàÂ∞±ÂèØ‰ª•È¢ÑÂ§ÑÁêÜ $\sum\limits_{k = 1}^n k^2 \mu(k)$ ÔºåÂêéÈù¢ÁöÑÁî®Êï¥Èô§ÂàÜÂùóÂ∞±Â•Ω‰∫Ü</p><h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 20101009</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e07</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN];</span><br><span class="line"><span class="keyword">int</span> vis[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mu[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1e07</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prime_Acqu</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! vis[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">mu[i] = - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j]))</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">mu[i * prime[j]] = - mu[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++)</span><br><span class="line">sum[i] = (sum[i - <span class="number">1</span>] + <span class="number">1l</span>l * i * <span class="number">1l</span>l * i % MOD * mu[i] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">LL fn = (LL) n;</span><br><span class="line"><span class="keyword">return</span> (fn * (fn + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> limit = min (N, M);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">1</span>; d &lt;= limit; d ++) &#123;</span><br><span class="line">LL total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> minlim = min (N / d, M / d);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r; l &lt;= minlim; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = min ((N / d) / ((N / d) / l), (M / d) / ((M / d) / l));</span><br><span class="line">total = (total + (sum[r] - sum[l - <span class="number">1</span>] + MOD) % MOD * calc (N / d / l) % MOD * calc (M / d / l) % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">ans = (ans + (LL) (d) * total % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">prime_Acqu ();</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d"</span>, &amp; N, &amp; M);</span><br><span class="line">LL ans = Solve ();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ëé´ÊØî‰πåÊñØÂèçÊºî </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåÂõõÊ†°ËÅîËÄÉ„ÄçÂØÜÁ†Å</title>
      <link href="/2020/08/04/%5B%E5%9B%9B%E6%A0%A1%E8%81%94%E8%80%83%5D%E5%AF%86%E7%A0%81/"/>
      <url>/2020/08/04/%5B%E5%9B%9B%E6%A0%A1%E8%81%94%E8%80%83%5D%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h2><p>ÁªôÂÆö $n$ Ë°å $m$ ÂàóÁöÑ $01$ Áü©ÈòµÔºåÊ±ÇÊª°Ë∂≥ $\big(\sum_{\forall i \in A, j \in B} value_{i, j}\big) \equiv 0 \pmod{2}$ ÁöÑ‰∫åÂÖÉÁªÑÁöÑÊï∞Èáè</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>È¶ñÂÖàËÄÉËôë $n = 1$Ôºå‰ª§ $1$ ÁöÑ‰∏™Êï∞‰∏∫ $t$ÔºåÂèØ‰ª•ÂèëÁé∞Á≠îÊ°à<br>$$<br>\sum\limits_{k = 0}^{\lfloor\frac{m}{2}\rfloor} \dbinom{t}{2k} \times 2^{m - t} - 1 = 2^{m - 1} - 1<br>$$<br>Ëá≥‰∫éËØÅÊòéÔºåÂèØ‰ª•ËÄÉËôëÂ∑≤ÁªèÈÄâÂ•ΩÁöÑÊï∞Âàó $\{a_1, a_2, ‚Ä¶, a_n\}$ÔºåÈÇ£‰πàÁé∞Âú®ËÄÉËôëÂä†ÂÖ•Á¨¨ $n +1$ ‰∏™ÔºåÊòæÁÑ∂Âä†ÂÖ• $0, 1$ ÈÉΩÊòØÂ§ö‰∫Ü‰∏§ÁßçÈÄâÊã©</p><p>ÈÇ£‰πàÁé∞Âú®ËÄÉËôëÂ∞ÜË°åÂêàÂπ∂Êàê‰∏ÄÂàó</p><p>‰ΩÜÊòØÈóÆÈ¢òÊòØÂ¶ÇÊûúÈúÄË¶ÅÊûö‰∏æÈÄâÁöÑË°åËøòÊòØÈúÄË¶Å $2^n$ ÁöÑÂ§çÊùÇÂ∫¶ÔºåÁÑ∂ÂêéÊàëËÄÉÂú∫‰∏äÂ∞±ÊÉ≥Âà∞ËøôÂ∞±Âáâ‰∫Ü</p><p>ÈÇ£‰πàÊòæÁÑ∂ÊØèÊ¨°ÈÄâÂ•Ω‰∫ÜË°åÔºåÂÜçÈÄâÂàóÁöÑÊó∂ÂÄôËøôËã•Âπ≤‰∏™Âàó‰ºöË¥ØÁ©øÊâÄÊúâË°åÔºåÈÇ£Â∞±ÂèØ‰ª•Â∞ÜÊØèË°åÁúã‰Ωú‰∏Ä‰∏™Êï∞ÔºåÂπ∂‰∏îÂ∞ÜÂÆÉ‰ª¨ÂêàÂπ∂ÔºàÂºÇÊàñÔºâËµ∑Êù•ÔºåËøôÊ†∑Â∞±ÂèòÊàêÂÅö $n = 1$ ÁöÑÊÉÖÂÜµ‰∫Ü</p><p>Êé•‰∏ãÊù•Âè™Ë¶ÅËÄÉËôëÊúâÂá†ÁßçÊÉÖÂÜµ‰ºö‰ΩøÂæóÂÖ∂ÂºÇÊàñÂíå‰∏∫ $1$ ÔºàÊàñ‰∏ç‰∏∫ $1$ÔºâÂ∞±Ë°å‰∫Ü</p><p>Â∞ÜÂÆÉ‰ª¨Ê±ÇÁ∫øÊÄßÂü∫ÔºåÂõ†‰∏∫Ë°®Á§∫Âü∫ÁöÑË°åÂêëÈáè‰∏çÂèØËÉΩÁªÑÊàê $0$ÔºåÊïÖÂºÇÊàñÂíå‰∏∫ $0$ ÁöÑÊÉÖÂÜµÂ∞±ÊòØ $2^{\text{ÊâÄÊúâÁöÑÈõ∂ÂêëÈáè‰∏™Êï∞}}$</p><p>‰ª§ÊâÄÊúâÈõ∂ÂêëÈáè‰∏™Êï∞‰∏∫ $k$ÔºåÈÇ£‰πàÁ≠îÊ°àÂç≥‰∏∫ $(2^k - 1)(2^m - 1) + (2^n - 2^k)(2^{m - 1} - 1)$</p><p>ÁÑ∂ÂêéÈ´òÊñØÊ∂àÂÖÉÂÜçÁî® $bitset$ Áª¥Êä§‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="built_in">bitset</span>&lt;MAXN&gt; bit[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Guass</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> row, col;</span><br><span class="line"><span class="keyword">for</span> (row = <span class="number">1</span>, col = <span class="number">1</span>; row &lt;= N &amp;&amp; col &lt;= M; row ++, col ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = row + <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (bit[i][col])</span><br><span class="line">swap (bit[row], bit[i]);</span><br><span class="line"><span class="keyword">if</span> (! bit[row][col]) &#123;</span><br><span class="line">row --;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = row + <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (bit[i][col])</span><br><span class="line">bit[i] ^= bit[row];</span><br><span class="line">&#125;</span><br><span class="line">row --;</span><br><span class="line"><span class="keyword">return</span> N - row;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">freopen (<span class="string">"password.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">freopen (<span class="string">"password.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> p = getnum ();</span><br><span class="line">bit[i][j] = p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> zero = Guass ();</span><br><span class="line">LL ans = ((power (<span class="number">2l</span>l, zero) - <span class="number">1</span> + MOD) % MOD * ((power (<span class="number">2l</span>l, M) - <span class="number">1</span> + MOD) % MOD) % MOD +</span><br><span class="line"> (power (<span class="number">2l</span>l, N) - power (<span class="number">2l</span>l, zero) + MOD) % MOD * ((power (<span class="number">2l</span>l, M - <span class="number">1</span>) - <span class="number">1</span> + MOD) % MOD) % MOD) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">0 0</span></span><br><span class="line"><span class="comment">0 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3</span></span><br><span class="line"><span class="comment">1 1 0</span></span><br><span class="line"><span class="comment">0 1 0</span></span><br><span class="line"><span class="comment">1 0 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÄßÂü∫ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåÂõõÊ†°ËÅîËÄÉ„ÄçÂ§ßÊ∞¥È¢ò „ÄåÁÆÄÂçïpruferÂ∫èÂàó„Äç</title>
      <link href="/2020/08/04/%5B%E5%9B%9B%E6%A0%A1%E8%81%94%E8%80%83%5D%E5%A4%A7%E6%B0%B4%E9%A2%98%20%E3%80%8C%E7%AE%80%E5%8D%95prufer%E5%BA%8F%E5%88%97%E3%80%8D/"/>
      <url>/2020/08/04/%5B%E5%9B%9B%E6%A0%A1%E8%81%94%E8%80%83%5D%E5%A4%A7%E6%B0%B4%E9%A2%98%20%E3%80%8C%E7%AE%80%E5%8D%95prufer%E5%BA%8F%E5%88%97%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="pruferÂ∫èÂàó"><a href="#pruferÂ∫èÂàó" class="headerlink" title="pruferÂ∫èÂàó"></a>pruferÂ∫èÂàó</h2><p>pruferÂ∫èÂàóÊòØ‰∏ÄÁßçÊó†Ê†πÊ†ëÁöÑÂ∫èÂàóË°®Á§∫ÊñπÊ≥ïÔºå<strong>‰∏Ä‰∏™ËäÇÁÇπ‰∏™Êï∞‰∏∫ $n$ ÁöÑÊó†Ê†πÊ†ëÂØπÂ∫îÁùÄÂîØ‰∏Ä‰∏ÄÁßçÈïøÂ∫¶‰∏∫ $n - 2$ ÁöÑpruferÂ∫èÂàó</strong></p><h3 id="Êó†Ê†πÊ†ëÂåñpruferÂ∫èÂàó"><a href="#Êó†Ê†πÊ†ëÂåñpruferÂ∫èÂàó" class="headerlink" title="Êó†Ê†πÊ†ëÂåñpruferÂ∫èÂàó"></a>Êó†Ê†πÊ†ëÂåñpruferÂ∫èÂàó</h3><p>ÊØèÊ¨°ÂèñÁºñÂè∑ÊúÄÂ∞èÁöÑÂè∂Â≠êËäÇÁÇπÔºåÂ∞ÜÂÖ∂ÊåáÂêëÁöÑ‚ÄúÁà∂‰∫≤‚ÄùÔºàÂ∞±ÊòØÂÆÉÂîØ‰∏ÄÊåáÂêëÁöÑÔºâËäÇÁÇπÂä†ÂÖ•pruferÂ∫èÂàó‰∏≠ÔºåÊúÄÁªàÂâ©‰Ωô‰∏§‰∏™ËøûÊé•ÁöÑËäÇÁÇπÁªìÊùü</p><h3 id="pruferÂ∫èÂàóÂåñÊó†Ê†πÊ†ë"><a href="#pruferÂ∫èÂàóÂåñÊó†Ê†πÊ†ë" class="headerlink" title="pruferÂ∫èÂàóÂåñÊó†Ê†πÊ†ë"></a>pruferÂ∫èÂàóÂåñÊó†Ê†πÊ†ë</h3><p>ÂØπ‰∫épruferÂ∫èÂàó $A= \{a_1, a_2, a_3, ‚Ä¶\}$ÔºåÊØèÊ¨°ÂèñÊúÄÂâçÈù¢ÁöÑÂÖÉÁ¥† $a_s$ÔºåÂú®ÊÄªÁÇπÈõÜ‰∏≠ÊâæÂà∞ÊúÄÂ∞èÁöÑÊ≤°ÊúâÂú® $A$ ‰∏≠ÁöÑËäÇÁÇπ $t$ÔºåÂ∞Ü $a_s,  t$ ËøûËæπÂπ∂Âà†Âéª $a_s$ÔºåÂèØ‰ª•‰ΩøÁî® $set$ Á≠âÁª¥Êä§</p><h3 id="Áõ∏ÂÖ≥ÂÆöÁêÜ"><a href="#Áõ∏ÂÖ≥ÂÆöÁêÜ" class="headerlink" title="Áõ∏ÂÖ≥ÂÆöÁêÜ"></a>Áõ∏ÂÖ≥ÂÆöÁêÜ</h3><ul><li>$n$ ‰∏™ÁÇπÁöÑÊúâÊ†áÂè∑ÂÆåÂÖ®ÂõæÊó†Ê†πÊ†ëËÆ°Êï∞Ôºö$n^{n - 2}$</li><li>$n$ ‰∏™ÁÇπÔºåÊØè‰∏™ÁÇπÁöÑÂ∫¶Êï∞‰∏∫ $\{d_1, d_2, d_3, ‚Ä¶\}$ ÁöÑÊúâÊ†áÂè∑Êó†Ê†πÊ†ëËÆ°Êï∞Ôºö$\frac{(n - 2)!}{d_1!d_2!d_3!‚Ä¶}$ÔºàÂÆûÈôÖ‰∏äÂ∞±ÊòØ‰∏Ä‰∏™Â§öÈáçÈõÜÁöÑÊéíÂàóÊï∞Ôºâ</li><li>$n$ ‰∏™ÁÇπÁöÑpruferÂ∫èÂàó‰∏≠Á¨¨ $i$ ‰∏™ÁÇπÊÅ∞Â•ΩÂá∫Áé∞ $d_i - 1$ Ê¨°</li><li>$n$ ‰∏™ÁÇπÂ∫¶Êï∞‰∏∫ $\{d_1, d_2, ‚Ä¶, d_k\}$ÔºåÂâ©‰Ωô $k + 1 \thicksim n$ Êú™Áü•Â∫¶Êï∞ÁöÑËäÇÁÇπÁöÑÊúâÊ†áÂè∑Êó†Ê†πÊ†ëËÆ°Êï∞ÔºöËÆæÂâ©‰ΩôÁöÑ‰ΩçÁΩÆ $d_l = (n - 2) - \sum\limits_{i = 1}^k (d_i- 1) $ÔºåÂÖàÂ∞ÜÂÆÉ‰ª¨Áúã‰Ωú‰∏Ä‰∏™Êï¥‰ΩìÂÜçÂ±ÄÈÉ®Ê±ÇËß£ÂæóÂà∞ $ans = \frac{(n - 2)!}{d_1!d_2!‚Ä¶d_k!d_l!}(n - k)^{d_l}$</li><li>$n$ ‰∏™ÁÇπÁöÑÊúâÊ†áÂè∑ÊúâÊ†πÊ†ëËÆ°Êï∞Ôºö$n^{n - 1}$</li><li>$n$ ‰∏™ÁÇπÁöÑÊó†Ê†áÂè∑ÊúâÊ†πÊ†ëËÆ°Êï∞ÔºöÂæÖÁª≠</li><li>$n$ ‰∏™ÁÇπÁöÑÊó†Ê†áÂè∑Êó†Ê†πÊ†ëËÆ°Êï∞ÔºöÂæÖÁª≠</li></ul><h2 id="Êú¨È¢òÈ¢òËß£"><a href="#Êú¨È¢òÈ¢òËß£" class="headerlink" title="Êú¨È¢òÈ¢òËß£"></a>Êú¨È¢òÈ¢òËß£</h2><h3 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h3><p>Êúâ $n$ ‰∏™ÊúâÊ†áÂè∑ÁÇπÔºåÁ¨¨ $i$ ‰∏™ÁÇπÁöÑÂ∫¶Êï∞‰∏äÈôê‰∏∫ $A_i$</p><p>Áé∞Âú®ÂØπ‰∫éÊØè‰∏™ $s (1 \le s \le n)$ÔºåÈóÆ‰ªéËøô $n$ ‰∏™ÁÇπ‰∏≠ÈÄâÂá∫‰∏Ä‰∫õÁÇπÁªÑÊàêÂ§ßÂ∞è‰∏∫ $s$ ÁöÑÊúâÊ†áÂè∑Êó†Ê†πÊ†ëÁöÑÊñπÊ°àÊï∞</p><h3 id="Êï∞ÊçÆËåÉÂõ¥"><a href="#Êï∞ÊçÆËåÉÂõ¥" class="headerlink" title="Êï∞ÊçÆËåÉÂõ¥"></a>Êï∞ÊçÆËåÉÂõ¥</h3><p>ÂØπ‰∫é $100\%$ ÁöÑÊï∞ÊçÆÔºå$n \le 100$</p><p>ËÄÉËôëÁõ¥Êé•Â∞ÜÊó†Ê†πÊ†ëËΩ¨Âåñ‰∏∫pruferÂ∫èÂàóÔºåÁî±ÂîØ‰∏ÄÊÄßÂú®Â∫èÂàó‰∏äÁõ¥Êé• $dp$<br>‰ª§ $f_{i, j, k}$ Ë°®Á§∫Ââç $i$ ‰∏™ÁÇπÈÄâ $j$ ‰∏™ÁªÑÊàêÈïøÂ∫¶‰∏∫ $k$ ÁöÑpruferÂ∫èÂàóÁöÑÊñπÊ°àÊï∞</p><p>ÊòæÁÑ∂<br>$$<br>\begin{aligned}<br>f_{i + 1, j, k} &amp;+= f_{i, j, k} \\<br>f_{i + 1, j + 1, k + l(l \in [0, A_{i + 1} - 1])} &amp;+= f_{i, j, k} \times \dbinom{k + l}{l}<br>\end{aligned}<br>$$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1004535809</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL C[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL f[MAXN][MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> limit[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>)</span><br><span class="line">write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">freopen (<span class="string">"tree.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">freopen (<span class="string">"tree.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">limit[i] = getnum ();</span><br><span class="line">C[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">C[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">C[i][j] = (C[i - <span class="number">1</span>][j - <span class="number">1</span>] + C[i - <span class="number">1</span>][j]) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= N; k ++) &#123; <span class="comment">// Ê≥®ÊÑèÈúÄÁúºÁ•ûÂà∞N</span></span><br><span class="line">f[i][j][k] = f[i - <span class="number">1</span>][j][k];</span><br><span class="line"><span class="keyword">if</span> (j &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt;= k &amp;&amp; l &lt; limit[i]; l ++) <span class="comment">// Ê≥®ÊÑèÂõ†‰∏∫ÂèØ‰ª•‰ΩúÂè∂Â≠êÊâÄ‰ª•lÈúÄË¶Å‰ªé0ÂºÄÂßãÊûö‰∏æ</span></span><br><span class="line">f[i][j][k] = (f[i][j][k] + f[i - <span class="number">1</span>][j - <span class="number">1</span>][k - l] * C[k][l] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">write (N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">' '</span>), write (f[N][i][i - <span class="number">2</span>]);</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">2 2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">1 5 2 4 4 4</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">output:</span></span><br><span class="line"><span class="comment">6 15 50 160 392 509</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> pruferÂ∫èÂàó </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåÂåó‰∫¨ÁúÅÈÄâÈõÜËÆ≠2019„ÄçÁîüÊàêÊ†ëËÆ°Êï∞„ÄåMatrix-Tree„Äç</title>
      <link href="/2020/08/04/%5B%E5%8C%97%E4%BA%AC%E7%9C%81%E9%80%89%E9%9B%86%E8%AE%AD2019%5D%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0%E3%80%8CMatrix-Tree%E3%80%8D/"/>
      <url>/2020/08/04/%5B%E5%8C%97%E4%BA%AC%E7%9C%81%E9%80%89%E9%9B%86%E8%AE%AD2019%5D%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0%E3%80%8CMatrix-Tree%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="ÂâçÁΩÆÁü•ËØÜ"><a href="#ÂâçÁΩÆÁü•ËØÜ" class="headerlink" title="ÂâçÁΩÆÁü•ËØÜ"></a>ÂâçÁΩÆÁü•ËØÜ</h2><h3 id="Matrix-TreeÂÆöÁêÜ"><a href="#Matrix-TreeÂÆöÁêÜ" class="headerlink" title="Matrix-TreeÂÆöÁêÜ"></a>Matrix-TreeÂÆöÁêÜ</h3><p>ÂØπ‰∫éÊó†ÂêëÂõæ $G$ÔºåÂÆö‰πâÂÖ∂Â∫¶Êï∞Áü©Èòµ $D$<br>$$<br>\left[<br>\begin{matrix}<br>deg_1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\<br>0 &amp; deg_2 &amp; 0 &amp; \cdots &amp; 0 \\<br>0 &amp; 0 &amp; deg_3 &amp; \cdots &amp; 0 \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; deg_n<br>\end{matrix}<br>\right]<br>$$<br>ÂÆö‰πâÂÖ∂ÈÇªÊé•Áü©Èòµ $C$<br>$$<br>\left[<br>\begin{matrix}<br>0 &amp; a_{1,2} &amp; a_{1,3} &amp; \cdots &amp; a_{1,n} \\<br>a_{2,1} &amp; 0 &amp; a_{2,3} &amp; \cdots &amp; a_{2,n} \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>a_{n,1} &amp; a_{n,2} &amp; a_{n,3} &amp; a_{n,4} &amp; 0<br>\end{matrix}<br>\right]<br>$$<br>ÂÖ∂‰∏≠ $a_{i, j} \in \{0, ~1\}$</p><p>ÂÆö‰∫éÂÖ∂ÁöÑÂü∫Â∞îÈúçÂ§´Áü©Èòµ $L(G) = D - C$ÔºåÂàôÊúâ $L(G)$ ÁöÑ‰ªªÊÑè‰ª£Êï∞‰ΩôÂ≠êÂºèÂç≥‰∏∫Êó†ÂêëÂõæ $G$ ÁöÑÁîüÊàêÊ†ë‰∏™Êï∞</p><p>Ëá≥‰∫éÊ±Ç‰ª£Êï∞‰ΩôÂ≠êÂºèÂàô‰ªªÊÑèÂà†ÂéªÁ¨¨ $i$ Ë°å $i$ ÂàóÈ´òÊñØÊ∂àÂÖÉÂæóÂÖ∂Êñú‰∏ä‰∏âËßíÁü©ÈòµÊúÄÂêéÂç≥Êúâ $ans = \sum\limits_i a_{i,i}$</p><p>Ëá≥‰∫éËØÅÊòéÂ∞±ÁïôÂùëÂêß</p><h4 id="ÊãìÂ±ï"><a href="#ÊãìÂ±ï" class="headerlink" title="ÊãìÂ±ï"></a>ÊãìÂ±ï</h4><ul><li>Â∏¶ÊùÉÂõæÁîüÊàêÊ†ëÔºöÂÆö‰πâ‰∏ÄÊ£µÁîüÊàêÊ†ëÁöÑÊùÉÂÄº‰∏∫ËæπÊùÉ‰πãÁßØÔºåÊ±ÇËß£ÊâÄÊúâÁîüÊàêÊ†ëÁöÑÊùÉÂÄº‰πãÂíå„ÄÇ      Â∞Ü $D$ ‰∏≠ÁöÑ $deg_i$ Êîπ‰∏∫ËøûÊé•ÂÖ∂ÁöÑÁÇπÁöÑÊùÉÂÄºÂíåÔºåÂÜç‰ª§ $C$ ‰∏≠ $a_{i, j} = w_{i, j}$ Ôºà$w_{i, j}$ ‰∏∫ËæπÊùÉÔºâÔºåÊúÄÂêéMatrix-TreeÂÆöÁêÜÂç≥ÂèØ</li><li>ÊúâÂêëÂõæÁöÑÁîüÊàêÊ†ëÂΩ¢ÂõæËÆ°Êï∞ÔºöÊàë‰ª¨Â∞ÜÂ∫¶Êï∞Áü©ÈòµÊîπ‰∏∫ÂÖ•Â∫¶ÔºåÈÇªÊé•Áü©ÈòµÊîπ‰∏∫ÊúâÂêëËæπÁöÑÈÇªÊé•Áü©ÈòµÔºå‰ª• $p$ ‰∏∫Ê†πÁöÑÊ†ëÂΩ¢Âõæ‰∏™Êï∞ÊòØÂéªÊéâ $p$ Ë°å $p$ ÂàóÂêéÂÅöË°åÂàóÂºèÂæóÁöÑÁ≠îÊ°à</li></ul><h3 id="Â§öÈ°πÂºèÊ±ÇÈÄÜ-O-n-2"><a href="#Â§öÈ°πÂºèÊ±ÇÈÄÜ-O-n-2" class="headerlink" title="Â§öÈ°πÂºèÊ±ÇÈÄÜ $O (n^2)$"></a>Â§öÈ°πÂºèÊ±ÇÈÄÜ $O (n^2)$</h3><p>‰∫éÊòØÊàëÂÖà‰ºö $O (n \log n)$ ÂÜç‰ºö $O (n^2)$ Êàë‰πüÂæàÁªùÊúõÂïä</p><p>‰ª§ $C(x) = A(x)B(x) \pmod p$ÔºåÈ¶ñÂÖàÊúâ $C_0 = A_0B_0 = 1 \pmod p$ ÔºàÊ≠§Â§ÑË°®Á§∫Âú® $\mod p$ ÊÑè‰πâ‰∏ãÔºåÁÑ∂Âêé‰ª• $C_1$ ‰∏∫‰æãÔºåÂàôÊúâ $C_1 = A_0B_1 + A_1B_0 = 0 \pmod p$ÔºåÂèØËß£Âæó $B_1 = - \frac{A_1B_0}{A_0}$ÔºåÂÖ∂ÂÆÉÂêåÁêÜ</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>È¶ñÂÖàÂØπ‰∫é $(w_1 + w_2 + w_3 + \wedge ~+ w_n)^k = \sum\prod\limits_{i = 1}^n w_{\forall}$</p><p>ÈÇ£‰πàÂèØ‰ª•ËÅîÊÉ≥Âà∞ÊúâÊ†áÂè∑ÁöÑÊï¥Êï∞ÊãÜÂàÜÔºåÈÇ£‰πàÂç≥ÂèØÂ∞ÜÊØèÊù°ËæπÁöÑËæπÊùÉËÆæ‰∏∫ÂéüËæπÊùÉÁöÑ EGFÔºåÂç≥ $value = \sum\limits_{n \ge 0} w^n\frac{x^n}{n!}$ Ôºà$w$ ‰∏∫ÂéüËæπÊùÉÔºâÔºåÊé•‰∏ãÊù•Matrix-TreeÂç≥ÂèØ</p><p>ÊúÄÂêéÂæóÂà∞‰∏Ä‰∏™Â§öÈ°πÂºè $G(x)$ÔºåÁ≠îÊ°àÂç≥‰∏∫ $ans = G_k \cdot fact_k$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">30</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">30</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">LL invf[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, k;</span><br><span class="line"></span><br><span class="line">LL <span class="built_in">map</span>[MAXN][MAXN][MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL res[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL temp[MAXK]= &#123;<span class="number">0</span>&#125;, tmp[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multiply</span> <span class="params">(LL* a, LL* b, LL* ret)</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (temp, <span class="number">0</span>, <span class="keyword">sizeof</span> (temp));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++)</span><br><span class="line">temp[i] = (temp[i] + a[j] * b[i - j] % MOD) % MOD;</span><br><span class="line"><span class="built_in">memcpy</span> (ret, temp, <span class="keyword">sizeof</span> (temp));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inv</span> <span class="params">(LL* a, LL* ret)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; i ++)</span><br><span class="line">temp[i] = tmp[i] = <span class="number">0</span>;</span><br><span class="line">temp[<span class="number">0</span>] = power (a[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i ++)</span><br><span class="line">tmp[i] = a[i] * temp[<span class="number">0</span>] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j ++)</span><br><span class="line">temp[i] = (temp[i] - tmp[j] * temp[i - j] % MOD + MOD) % MOD;</span><br><span class="line"><span class="built_in">memcpy</span> (ret, temp, <span class="keyword">sizeof</span> (temp));</span><br><span class="line">&#125;</span><br><span class="line">LL ret[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Gauss</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">res[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">multiply (<span class="built_in">map</span>[i][i], res, res);</span><br><span class="line">inv (<span class="built_in">map</span>[i][i], ret);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; N; j ++)</span><br><span class="line">multiply (<span class="built_in">map</span>[i][j], ret, <span class="built_in">map</span>[i][j]);</span><br><span class="line"><span class="built_in">memset</span> (<span class="built_in">map</span>[i][i], <span class="number">0</span>, <span class="keyword">sizeof</span> (<span class="built_in">map</span>[i][i]));</span><br><span class="line"><span class="built_in">map</span>[i][i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> t = N - <span class="number">1</span>; t &gt;= i; t --) &#123;</span><br><span class="line">multiply (<span class="built_in">map</span>[i][t], <span class="built_in">map</span>[j][i], ret);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt;= k; l ++) &#123;</span><br><span class="line"><span class="built_in">map</span>[j][t][l] = (<span class="built_in">map</span>[j][t][l] - ret[l] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), k = getnum ();</span><br><span class="line">invf[<span class="number">0</span>] = invf[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= k; i ++)</span><br><span class="line">invf[i] = (- MOD / i + MOD) % MOD * invf[MOD % i] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i ++)</span><br><span class="line">invf[i] = invf[i] * invf[i - <span class="number">1</span>] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123;</span><br><span class="line">LL delta = getnum ();</span><br><span class="line"><span class="keyword">if</span> (j &lt;= i) <span class="keyword">continue</span>;</span><br><span class="line">LL <span class="built_in">pow</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt;= k; l ++) &#123;</span><br><span class="line">LL value = <span class="built_in">pow</span> * invf[l] % MOD;</span><br><span class="line"><span class="built_in">map</span>[i][j][l] = <span class="built_in">map</span>[j][i][l] = (- value + MOD) % MOD;</span><br><span class="line"><span class="built_in">map</span>[i][i][l] = (<span class="built_in">map</span>[i][i][l] + value) % MOD;</span><br><span class="line"><span class="built_in">map</span>[j][j][l] = (<span class="built_in">map</span>[j][j][l] + value) % MOD;</span><br><span class="line"><span class="built_in">pow</span> = <span class="built_in">pow</span> * delta % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Gauss ();</span><br><span class="line">LL ans = res[k];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i ++)</span><br><span class="line">ans = ans * i % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 3</span></span><br><span class="line"><span class="comment">0 0 1 1</span></span><br><span class="line"><span class="comment">0 0 1 1</span></span><br><span class="line"><span class="comment">1 1 0 0</span></span><br><span class="line"><span class="comment">1 1 0 0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Áü©ÈòµÊ†ëÂÆöÁêÜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Problem 5280 - [ZJOI2019]Á∫øÊÆµÊ†ë</title>
      <link href="/2020/08/04/%5BZJOI2019%5D%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
      <url>/2020/08/04/%5BZJOI2019%5D%E7%BA%BF%E6%AE%B5%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÁúãÈ¢òËß£ÈáåÊúâ‰∫∫ËØ¥ËøôÈ¢òÂÆûÂú®Â§™Ê∞¥</p><p>‰ΩÜÊàëËøûÁ¨¨‰∏ÄÊ≠•ÂØπÁÇπÂàÜÁ±ªÈÉΩ‰∏ç‰ºöÔºàËôΩÁÑ∂ÂàÜÁ±ªÂÆåÂêéÁöÑÁ°Æ‰∏ç‰ºöÂæàÈöæÔºâ</p><p>Êàë‰æùÊóßÊòØÂ§™Ëèú</p><p>Â•Ω‰∫ÜËøõÂÖ•Ê≠£È¢ò</p><p>Á∫øÊÆµÊ†ë‰∏äÊâì $\text{tag}$ÔºåÂõ†‰∏∫ÂÆÉ‰∏ÄÁõ¥Â§çÂà∂Êù•Â§çÂà∂ÂéªÔºå‰∏çÂèØËÉΩÂú®Ê≤°Ê£µÁ∫øÊÆµÊ†ë‰∏äÈÉΩËøõË°å‰øÆÊîπÔºåÂ∞±ËÄÉËôëÁÇπÁöÑÂÖ±ÂêåÊÄßË¥®ÔºåÁõ∏ÂêåÊÄßË¥®ÁöÑÁÇπÂèØ‰ª•‰∏ÄËµ∑‰øÆÊîπÔºåÈÇ£‰πàÊ≠§Êó∂Áõ∏ÂΩì‰∫éÂè™ËøõË°å‰∏ÄÊ¨° $\text{modify}$ Â∞±Ë°å‰∫Ü</p><p>ÂèØ‰ª•Â∞ÜÁÇπÂàÜÊàê‰∫îÁ±ªÔºö</p><ul><li>‰∏ÄÁ±ªÁÇπÔºöÂçäË¶ÜÁõñÔºàÂ∞±ÊòØ‰øÆÊîπÊó∂‰ºöÁªèËøá‰ΩÜÊòØ‰∏çÊâìÊ†áËÆ∞Ôºâ</li><li>‰∫åÁ±ªÁÇπÔºöÂÖ®Ë¶ÜÁõñÔºåÊâìÊ†áËÆ∞ÔºàÂå∫Èó¥Ë¢´‰øÆÊîπÂå∫Èó¥ÂÆåÂÖ®Ë¶ÜÁõñÔºå‰ºöË¢´ËÆøÈóÆÂà∞ÔºåË¢´ÊâìÊ†áËÆ∞Ôºâ</li><li>‰∏âÁ±ªÁÇπÔºöÂÖ®Ë¶ÜÁõñÔºå‰∏çÊâìÊ†áËÆ∞ÔºàÂå∫Èó¥Ë¢´‰øÆÊîπÂå∫Èó¥ÂÆåÂÖ®Ë¶ÜÁõñÔºå‰ΩÜ‰∏ç‰ºöË¢´ËÆøÈóÆÂà∞ÔºåÂ∞±ÊòØÊâìÊ†áËÆ∞ÂÖ®Ë¶ÜÁõñËäÇÁÇπÁöÑÂ≠êËäÇÁÇπÔºå‰∏çË¢´ÊâìÊ†áËÆ∞Ôºâ</li><li>ÂõõÁ±ªÁÇπÔºöËÆøÈóÆ‰∏çÂà∞Ôºå‰ºöË¢´‰∏ã‰º†Ê†áËÆ∞</li><li>‰∫îÁ±ªÁÇπÔºöËÆøÈóÆ‰∏çÂà∞Ôºå‰∏ç‰ºöË¢´‰∏ã‰º†Ê†áËÆ∞</li></ul><p>ÈÇ£‰πàÊ≠§Êó∂ÊñπÊ°àÊï∞ËΩ¨Ê¶ÇÁéáÔºå‰ª§ $f_u$ Ë°®Á§∫ËäÇÁÇπ $u$ ÊúâË¢´ÊâìÊ†áËÆ∞ÁöÑÊ¶ÇÁéáÔºåÂç≥ $u$ ÊúâË¢´ÊâìÊ†áËÆ∞ÁöÑÁ∫øÊÆµÊ†ëÂç†ÊØîÔºåÈÇ£‰πàÊúÄÁªàË¢´ÊâìÊ†áËÆ∞ÁöÑËäÇÁÇπ $u$ ‰∏™Êï∞Âç≥‰∏∫ $f_u \times 2^n$ÔºàÂÖ∂‰∏≠ $n$ Ë°®Á§∫Ë¢´‰øÆÊîπÊ¨°Êï∞Ôºâ</p><p>‰ΩÜÊòØ‰ºöÂèëÁé∞ÂÜôÂõõÁ±ªÁÇπÁöÑÊó∂ÂÄôËøòÈúÄË¶ÅÁü•ÈÅìÂÆÉÁ•ñÂÖàÊúâÊ≤°ÊúâË¢´ÊâìÊ†áËÆ∞ÔºåÊâÄ‰ª•ËøòÈúÄË¶ÅËÆæ‰∏Ä‰∏™ $g_u$ Ë°®Á§∫ËäÇÁÇπ $u$ ÂèäÂÖ∂Á•ñÂÖàË¢´ÊâìÊ†áËÆ∞ÁöÑÊ¶ÇÁéáÔºåÂºÄÂßãËΩ¨Áßª</p><p>ÂØπ‰∏ÄÁ±ªÁÇπÔºåÂ§çÂà∂Âêé‰∏ÄÂçä‰øùÊåÅÂéüÊ†∑Ôºå‰∏ÄÂçäÂøÖÂÆöÊó†Ê†áËÆ∞ÔºàÂõ†‰∏∫ÊòØÁªèËøáÁÇπËÇØÂÆö‰ºöË¢´‰∏ã‰º†ÔºâÔºåÂÖ∂Á•ñÂÖàÂêåÁêÜ<br>$$<br>f_u = \frac12(f_u + 0), g_u = \frac12(g_u + 0)<br>$$<br>ÂØπ‰∫åÁ±ªÁÇπÔºåÂ§çÂà∂Âêé‰∏ÄÂçä‰øùÊåÅÂéüÊ†∑Ôºå‰∏ÄÂçäÂøÖÂÆö‰ºöË¢´ÊâìÊ†áËÆ∞<br>$$<br>f_u = \frac12(f_u + 1), g_u = \frac12(g_u + 1)<br>$$<br>ÂØπ‰∏âÁ±ªÁÇπÔºåÂ§çÂà∂Âêé‰∏ÄÂçä‰øùÊåÅÂéüÊ†∑Ôºå‰∏ÄÂçäÂøÖÂÆö‰∏ç‰ºöË¢´‰∏ã‰º†Ê†áËÆ∞Ôºå‰ΩÜÂÖ∂Á•ñÂÖàÂøÖÂÆö‰ºöË¢´Ê†áËÆ∞<br>$$<br>f_u = f_u, g_u = \frac12(g_u + 1)<br>$$<br>ÂØπÂõõÁ±ªÁÇπÔºåÂ§çÂà∂Âêé‰∏ÄÂçä‰øùÊåÅÂéüÊ†∑Ôºå‰∏ÄÂçäÂèØËÉΩ‰ºöË¢´‰∏ã‰º†Ê†áËÆ∞ÔºàÂøÖÂÆö‰ºöÁªèËøáÂÖ∂Áà∂ËäÇÁÇπÔºåÂê¶ÂàôÂÆÉ‰∏çÂèØËÉΩÊàê‰∏∫ÂõõÁ±ªÁÇπÔºåÂêåÊó∂ÊòØÂê¶‰ºöË¢´‰∏ã‰º†Ê†áËÆ∞ÂèñÂÜ≥‰∫éÂÆÉÁ•ñÂÖàÊòØÂê¶ÊúâÊ†áËÆ∞ÔºåÂç≥ $g_u$Ôºâ<br>$$<br>f_u = \frac12(f_u + g_u), g_u = g_u<br>$$<br>ÂØπ‰∫îÁ±ªÁÇπÔºåÂ§çÂà∂Âêé‰∏ÄÂçä‰øùÊåÅÂéüÊ†∑Ôºå‰∏ÄÂçä‰πü‰∏ç‰ºöË¢´ÂΩ±Âìç<br>$$<br>f_u = f_u, g_u = g_u<br>$$<br>ÊïÖ‰∫îÁ±ªÁÇπÂèØ‰∏çÂÅöÂ§ÑÁêÜ</p><p>‰ΩÜÊòØ‰∏âÁ±ªÁÇπÁöÑÊï∞ÁõÆÂæàÂ§öÔºåÊòØ $O (n)$ Á∫ßÂà´ÔºåÊïÖÂØπ‰∏âÁ±ªÁÇπÁöÑ‰øÆÊîπËøòÈúÄË¶ÅÊâìÊáíÊ†áËÆ∞</p><p>ÂÜçÂºÄ‰∏Ä‰∏™ $sumf_u$ Áª¥Êä§ÂÖ∂Â≠êÊ†ëÁ≠îÊ°à</p><p>ÊúÄÁªàÁ≠îÊ°àÂç≥‰∏∫ $sumf_1 \times 2^n$</p><p>Êó∂Èó¥Â§çÊùÇÂ∫¶ $O (m\log n)$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">8e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL inv2 = <span class="number">499122177</span>;</span><br><span class="line"></span><br><span class="line">LL f[MAXN]= &#123;<span class="number">0</span>&#125;, g[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumf[MAXN]= &#123;<span class="number">0</span>&#125;, lazy[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">lazy[root] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid);</span><br><span class="line">build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123; sumf[root] = (f[root] + sumf[lson] + sumf[rson]) % MOD; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushG</span> <span class="params">(<span class="keyword">int</span> root, LL value)</span> </span>&#123;</span><br><span class="line">g[root] = (g[root] * value % MOD + <span class="number">1l</span>l - value + MOD) % MOD;</span><br><span class="line">lazy[root] = lazy[root] * value % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushF</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123; f[root] = (f[root] + g[root]) % MOD * inv2 % MOD; maintain (root); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (lazy[root] == <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">pushG (lson, lazy[root]); pushG (rson, lazy[root]);</span><br><span class="line">lazy[root] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) &#123;</span><br><span class="line">f[root] = (f[root] + <span class="number">1</span>) % MOD * inv2 % MOD; <span class="comment">// ‰∫åÁ±ªÁÇπ</span></span><br><span class="line">g[root] = (g[root] + <span class="number">1</span>) % MOD * inv2 % MOD;</span><br><span class="line">pushG (lson, inv2); pushG (rson, inv2); <span class="comment">// ‰∏âÁ±ªÁÇπ</span></span><br><span class="line">maintain (root);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">pushdown (root); <span class="comment">// ‰∏âÁ±ªÁÇπpushdown</span></span><br><span class="line">f[root] = f[root] * inv2 % MOD; <span class="comment">// ‰∏ÄÁ±ªÁÇπ</span></span><br><span class="line">g[root] = g[root] * inv2 % MOD;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) modify (lson, left, mid, L, R);</span><br><span class="line"><span class="keyword">else</span> pushF (lson); <span class="comment">// ÂõõÁ±ªÁÇπ</span></span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) modify (rson, mid + <span class="number">1</span>, right, L, R);</span><br><span class="line"><span class="keyword">else</span> pushF (rson); <span class="comment">// ÂõõÁ±ªÁÇπ</span></span><br><span class="line">maintain (root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line">LL down = <span class="number">1</span>;</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= M; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> type = getnum ();</span><br><span class="line"><span class="keyword">if</span> (type == <span class="number">2</span>) &#123; write (sumf[<span class="number">1</span>] * down % MOD); <span class="built_in">puts</span> (<span class="string">""</span>); &#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">down = down * <span class="number">2l</span>l % MOD;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, N, l, r);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 1 3</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 3 5</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ê†ë‰∏äDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåZJOI2016„ÄçÂ§ßÊ£ÆÊûó</title>
      <link href="/2020/08/04/%5BZJOI2016%5D%E5%A4%A7%E6%A3%AE%E6%9E%97/"/>
      <url>/2020/08/04/%5BZJOI2016%5D%E5%A4%A7%E6%A3%AE%E6%9E%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÔºàË≤å‰ººÊï¥‰∏™‰ª£Á†Å‰∏çËÉΩÁî® $makeroot$ ÔºüÊòØÂõ†‰∏∫ÊòØÊúâÊ†πÊ†ëÔºüÔºâ</p><p>Âõ†‰∏∫ÊòØÂå∫Èó¥Êìç‰ΩúÔºåÊâÄ‰ª•ÂèØ‰ª•ËÄÉËôëÂú®Âå∫Èó¥ÂÜÖ‰∏éÂå∫Èó¥Â§ñÁöÑÂ∑ÆÂºÇ</p><p>ÂØπ‰∫éÊìç‰Ωú $1$ ÔºåÂèØ‰ª•Áúã‰Ωú‰∏Ä‰∏™ÁîüÊàêËäÇÁÇπÂåÖÂê´‰∫ÜÂà∞‰∏ã‰∏Ä‰∏™ $1$ Êìç‰Ωú‰πãÈó¥ÈïøÂá∫ÁöÑËäÇÁÇπÔºåÈÇ£‰πàÂØπ‰∫é‰∏Ä‰∏™Êìç‰Ωú $l, r$ ÔºåÁõ∏ÂΩì‰∫éÊòØÂú® $l$ Â§ÑÂ∞ÜÂΩìÂâçÁîüÊàêËäÇÁÇπÂèäÂÖ∂ÂåÖÂê´ÁöÑËäÇÁÇπÊï¥‰∏™ÁßªÊ§çÂà∞ÂÆÉÊõ¥ÊîπÂêéÁöÑ‰ΩçÁΩÆÔºåÂà∞ $r + 1$ Êó∂ÂÜçÁßªÊ§çÂõûÂéªÔºåÊâÄ‰ª•ÂèØ‰ª•ËÄÉËôëÂ∞Ü‰∏Ä‰∏™ $1$ Êìç‰ΩúÂàÜËß£‰∏∫‰∏§‰∏™Êìç‰ΩúÔºà‰∏Ä‰∏™ÁßªÊ§çÔºå‰∏Ä‰∏™ÁßªÊ§çÂõûÂéªÔºâÔºåÊïÖÂèØ‰ª•Â∞ÜÊâÄÊúâÊìç‰ΩúÊåâÁ´ØÁÇπ„ÄÅÊó∂Èó¥ÊéíÂ∫èÔºà‰ª•ÂèäÂêå‰ΩçÁΩÆ‰øÆÊîπÊìç‰ΩúÂøÖÂÆöÂú®Êü•ËØ¢Êìç‰ΩúÂâçÔºåÂõ†‰∏∫ÂèØ‰ª•ÂÖàÊääÊ†ëÂª∫ÂÆåÂÜçÊü•ËØ¢ÂØπÁªìÊûúÊ≤°ÊúâÂΩ±ÂìçÔºâÔºåÊâ´Êèè‰∏ÄÈÅçÂç≥ÂèØ</p><p>ÂêåÊó∂Ôºå‰∏∫‰∫ÜÊñπ‰æøÁßªÊ§çÔºåÂ∞ÜÊØè‰∏™ÁîüÊàêËäÇÁÇπÁúã‰ΩúÊñ∞Âª∫ÁöÑ‰∏Ä‰∏™ËôöÁÇπ</p><p>ÂØπ‰∫éÊìç‰Ωú $0$ ÔºåÁõ¥Êé•Âú®ËôöÁÇπ‰∏ã $link$ Âç≥ÂèØÔºåÂõ†‰∏∫Â∞±ÁÆóÂ∑≤ÁªèÂª∫‰∫Ü‰∏Ä‰∫õÂØπ‰∫éÂΩìÂâçÊìç‰Ωú‰∏çÂ≠òÂú®ÁöÑËôöÁÇπÔºå‰πü‰∏ç‰ºöÂØπÁ≠îÊ°àÈÄ†ÊàêÂΩ±Âìç</p><p>ÂØπ‰∫éÊìç‰Ωú $2$ ÔºåÊó†Ê≥ïÊ≠£Èù¢Âú® $LCT$ ‰∏äÁÆóÂá∫‰∏§ÁÇπÁöÑË∑ùÁ¶ªÔºåÊïÖÂèØËÄÉËôëÂ∑ÆÂàÜÔºåÂæóÂà∞ $Ans = Sum_x + Sum_y - 2 * Sum_{lca}$ ÔºåÂÖ∂‰∏≠ÂÆûÁÇπË¥°ÁåÆ‰∏∫ $1$ ÔºåËôöÁÇπË¥°ÁåÆ‰∏∫ $0$</p><p>ÂØπ‰∫éÊ±Ç $LCA$ ÔºåÂÖà $access (y)$ ÔºåÂÜçÂú® $access (x)$ ÁöÑÊó∂ÂÄôÂæóÂà∞ÁöÑÊúÄÂêé‰∏Ä‰∏™Ë∑≥ËôöËæπÁöÑÁÇπÂç≥ÊòØÂÆÉ‰ª¨ÁöÑ $LCA$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QuerySt</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> pos, time;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line"></span><br><span class="line">    QuerySt () &#123;&#125;</span><br><span class="line">    QuerySt (<span class="keyword">int</span> fpos, <span class="keyword">int</span> ftime, <span class="keyword">int</span> fx, <span class="keyword">int</span> fy) :</span><br><span class="line">        pos (fpos), time (ftime), x (fx), y (fy) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> QuerySt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> pos == p.pos ? time &lt; p.time : pos &lt; p.pos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">QuerySt Query[MAXN];</span><br><span class="line"><span class="keyword">int</span> que = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> son[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Sum[MAXN]= &#123;<span class="number">0</span>&#125;, value[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> son[father[p]][<span class="number">0</span>] != p &amp;&amp; son[father[p]][<span class="number">1</span>] != p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sonbel</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> son[father[p]][<span class="number">1</span>] == p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    Sum[p] = Sum[son[p][<span class="number">0</span>]] + Sum[son[p][<span class="number">1</span>]] + value[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fa = father[p], anc = father[fa];</span><br><span class="line">    <span class="keyword">int</span> s = sonbel (p);</span><br><span class="line">    son[fa][s] = son[p][s ^ <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (son[fa][s])</span><br><span class="line">        father[son[fa][s]] = fa;</span><br><span class="line">    <span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">        son[anc][sonbel (fa)] = p;</span><br><span class="line">    father[p] = anc;</span><br><span class="line">    son[p][s ^ <span class="number">1</span>] = fa, father[fa] = p;</span><br><span class="line">    pushup (fa), pushup (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> fa = father[p]; ! isroot (p); rotate (p), fa = father[p])</span><br><span class="line">        <span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">            sonbel (p) == sonbel (fa) ? rotate (fa) : rotate (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Access</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( ; p; tp = p, p = father[p])</span><br><span class="line">        splay (p), son[p][<span class="number">1</span>] = tp, pushup (p);</span><br><span class="line">    <span class="keyword">return</span> tp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="comment">// Ê≥®ÊÑèÊ≠§Êó∂Ê≤°ÊúâmakerootÊâÄ‰ª•ÈúÄË¶ÅÊ≥®ÊÑèÊòØÂ∞ÜyËøûÂà∞x‰∏ã</span></span><br><span class="line">    splay (y);</span><br><span class="line">    father[y] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cut</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    Access (x), splay (x);</span><br><span class="line">    father[son[x][<span class="number">0</span>]] = <span class="number">0</span>, son[x][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    pushup (x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> totq = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> ans[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    sort (Query + <span class="number">1</span>, Query + que + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= que; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> time = Query[i].time;</span><br><span class="line">        <span class="keyword">int</span> x = Query[i].x, y = Query[i].y;</span><br><span class="line">        <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            Access (x), splay (x), ans[time] += Sum[x];</span><br><span class="line">            <span class="keyword">int</span> lca = Access (y);</span><br><span class="line">            splay (y), ans[time] += Sum[y];</span><br><span class="line">            Access (lca), splay (lca), ans[time] -= (Sum[lca] &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cut (x), link (y, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ind[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> liml[MAXN], limr[MAXN];</span><br><span class="line"><span class="keyword">int</span> nodes = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum ();</span><br><span class="line">    <span class="keyword">int</span> lastr = <span class="number">1</span>, real = <span class="number">1</span>;</span><br><span class="line">    ind[<span class="number">1</span>] = Sum[<span class="number">1</span>] = value[<span class="number">1</span>] = <span class="number">1</span>, liml[<span class="number">1</span>] = <span class="number">1</span>, limr[<span class="number">1</span>] = N;</span><br><span class="line">    link (<span class="number">1</span>, nodes = lastr = <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> opt = getnum ();</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">            link (lastr, ind[++ real] = ++ nodes);</span><br><span class="line">            value[nodes] = Sum[nodes] = <span class="number">1</span>;</span><br><span class="line">            liml[real] = l, limr[real] = r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> l = getnum (), r = getnum (), x = getnum ();</span><br><span class="line">            l = max (l, liml[x]), r = min (r, limr[x]);</span><br><span class="line">            <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            link (lastr, ++ nodes);</span><br><span class="line">            Query[++ que] = QuerySt (l, i - M, nodes, ind[x]); <span class="comment">// Áî±nodesÁ¶ªÂºÄlinkÂêëindex[x]</span></span><br><span class="line">            Query[++ que] = QuerySt (r + <span class="number">1</span>, i - M, nodes, lastr);</span><br><span class="line">            lastr = nodes;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = getnum (), u = getnum (), v = getnum ();</span><br><span class="line">            Query[++ que] = QuerySt (x, ++ totq, ind[u], ind[v]); <span class="comment">// Áî±index[u]Âà∞index[v]ÁöÑË∑ùÁ¶ª</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Solve ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= totq; i ++)</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5</span></span><br><span class="line"><span class="comment">0 1 5</span></span><br><span class="line"><span class="comment">1 2 4 2</span></span><br><span class="line"><span class="comment">0 1 4</span></span><br><span class="line"><span class="comment">2 1 1 3</span></span><br><span class="line"><span class="comment">2 2 1 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ÊçÆÁªìÊûÑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LCT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåYnoi2013„ÄçD1T1</title>
      <link href="/2020/08/04/%5BYnoi2013%5DD1T1/"/>
      <url>/2020/08/04/%5BYnoi2013%5DD1T1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h2><p>$\text{opt} = 1$ Êó∂Ôºå‰ª£Ë°®Êää‰∏Ä‰∏™Âå∫Èó¥  $l, r$ ÂÜÖÁöÑÊâÄÊúâÊï∞ÈÉΩ $\text{xor}$ ‰∏ä $v$„ÄÇ</p><p>$\text{opt} = 2$ Êó∂Ôºå Êü•ËØ¢‰∏Ä‰∏™Âå∫Èó¥ $[l, r]$ ÂÜÖÈÄâ‰ªªÊÑè‰∏™Êï∞ÔºàÂåÖÊã¨ $0$ ‰∏™ÔºâÊï∞ $\text{xor}$ Ëµ∑Êù•ÔºåËøô‰∏™ÂÄº‰∏é $v$ ÁöÑÊúÄÂ§ß $\text{xor}$ ÂíåÊòØÂ§öÂ∞ë„ÄÇ</p><hr><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>Âá†‰πéÊ≤°ÂÜôËøáÂ∑ÆÂàÜÔºåÁúãÂÆåËøôÈ¢ò‰πãÂêéÈ°øÊó∂ÊÑüËßâÂà∞‰∫ÜÂ∑ÆÂàÜÁöÑÂº∫Â§ß</p><p>È¶ñÂÖàÊòæÁÑ∂Á¨¨‰∫å‰∏™Êìç‰ΩúÈúÄË¶ÅÁª¥Êä§Á∫øÊÄßÂü∫ÔºåÁÑ∂Âêé $O (\log{n})$ Ê±ÇËß£</p><p>ÁÑ∂ÂêéÂõ†‰∏∫Êúâ $1$ Êìç‰ΩúÔºåÊâÄ‰ª•Ëã•ÊòØÁõ¥Êé•Áª¥Êä§Âå∫Èó¥Á∫øÊÄßÂü∫ÔºåÂú®ËÆ°ÁÆóÁ≠îÊ°àÊó∂‰∏çÁü•ÈÅì $1$ Êìç‰Ωú‰∏≠ÁöÑ $v$ Âú®ÂΩìÂâçÁ≠îÊ°à‰∏≠Ë¢´ÂºÇÊàñ‰∏ä‰∫ÜÂ•áÊï∞ËøòÊòØÂÅ∂Êï∞Ê¨°ÔºåÊïÖÊó†Ê≥ïÊ±ÇËß£</p><p>‰ΩÜÊòØÂú®ÂçïÁÇπ‰øÆÊîπÁöÑÊÉÖÊôØ‰∏ãÂ∞±‰∏ç‰ºöÊúâ‰∏äËø∞ÈóÆÈ¢òÔºåÊïÖÁé∞Âú®ÁöÑÈóÆÈ¢òÊòØÂ¶Ç‰ΩïÂ∞ÜÂå∫Èó¥ÈóÆÈ¢òËΩ¨Âåñ‰∏∫ÂçïÁÇπÈóÆÈ¢ò</p><p>‰∫éÊòØÂ∞±ÈúÄË¶ÅÂ∑ÆÂàÜÔºåËÆ©ÊØè‰∏™ $b_{i + 1} = a_{i + 1} ~ \text{xor} ~ a_i$ÔºåÈÇ£‰πàÊ≠§Êó∂ $v$ ÁöÑË¥°ÁåÆÂ∞±Âè™‰ΩúÁî®‰∫é $b_l$ ‰∏é $b_{r + 1}$ÔºåÂèØÁõ¥Êé•ÂçïÁÇπ‰øÆÊîπÔºåÁÑ∂ÂêéÂú®Á∫øÊÆµÊ†ë‰∏äÂêåÊó∂Áª¥Êä§Âå∫Èó¥Á∫øÊÄßÂü∫ÔºåÊü•ËØ¢Êó∂Âè™ÈúÄÊü•ËØ¢ $1‚Ä¶l$ ÁöÑÂâçÁºÄÂíåÔºàÂç≥ $b_l$ÔºâÔºåÂÜçÂ∞Ü‰πã‰∏é $l + 1‚Ä¶r$ ÁöÑÂå∫Èó¥Á∫øÊÄßÂü∫ÂêàÂπ∂Âç≥ÂèØÊ±ÇËß£Á≠îÊ°à</p><p>Â§çÊùÇÂ∫¶ $O (n \log^2{n})$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e04</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">baseSt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> b[<span class="number">32</span>];</span><br><span class="line"><span class="keyword">int</span> subsum;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (b, <span class="number">0</span>, <span class="keyword">sizeof</span> (b));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">append</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">31</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line"><span class="keyword">if</span> (x &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))) &#123;</span><br><span class="line"><span class="keyword">if</span> (! b[j]) &#123;</span><br><span class="line">b[j] = x;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> x ^= b[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">baseSt base[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function">baseSt <span class="title">merge</span> <span class="params">(baseSt A, baseSt B)</span> </span>&#123;</span><br><span class="line">baseSt ret; ret.init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">31</span>; j &gt;= <span class="number">1</span>; j --) &#123;</span><br><span class="line"><span class="keyword">if</span> (A.b[j]) ret.b[j] = A.b[j];</span><br><span class="line"><span class="keyword">else</span> ret.b[j] = B.b[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">31</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line"><span class="keyword">if</span> (A.b[j] &amp;&amp; B.b[j])</span><br><span class="line">ret.append (B.b[j]);</span><br><span class="line">ret.subsum = A.subsum ^ B.subsum;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">base[root].init ();</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">base[root].subsum = a[left];</span><br><span class="line">base[root].append (base[root].subsum);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid);</span><br><span class="line">build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">base[root] = merge (base[lson], base[rson]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">base[root].init ();</span><br><span class="line">base[root].subsum ^= delta, base[root].append (base[root].subsum);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) modify (lson, left, mid, posi, delta);</span><br><span class="line"><span class="keyword">else</span> modify (rson, mid + <span class="number">1</span>, right, posi, delta);</span><br><span class="line">base[root] = merge (base[lson], base[rson]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">baseSt <span class="title">query_base</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R)</span><br><span class="line"><span class="keyword">return</span> base[root];</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">baseSt ret; ret.init ();</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) ret = merge (ret, query_base (lson, left, mid, L, R));</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) ret = merge (ret, query_base (rson, mid + <span class="number">1</span>, right, L, R));</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query_value</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right)</span><br><span class="line"><span class="keyword">return</span> base[root].subsum;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) <span class="keyword">return</span> query_value (lson, left, mid, posi);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> query_value (rson, mid + <span class="number">1</span>, right, posi) ^ base[lson].subsum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> x, baseSt A)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = x;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">31</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line">ret = max (ret, ret ^ A.b[j]);</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">a[i + <span class="number">1</span>] ^= a[i];</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> opt = getnum (), l = getnum (), r = getnum (), x = getnum ();</span><br><span class="line"><span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, N, l, x);</span><br><span class="line"><span class="keyword">if</span> (r &lt; N) modify (<span class="number">1</span>, <span class="number">1</span>, N, r + <span class="number">1</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> delta = query_value (<span class="number">1</span>, <span class="number">1</span>, N, l);</span><br><span class="line"><span class="keyword">if</span> (l == r) <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, max (x ^ delta, x));</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">baseSt bas = query_base (<span class="number">1</span>, <span class="number">1</span>, N, l + <span class="number">1</span>, r);</span><br><span class="line">bas.append (delta);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, solve (x, bas));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">1 14 51 4</span></span><br><span class="line"><span class="comment">2 1 3 0</span></span><br><span class="line"><span class="comment">1 2 3 3</span></span><br><span class="line"><span class="comment">2 1 4 10</span></span><br><span class="line"><span class="comment">1 1 4 514</span></span><br><span class="line"><span class="comment">2 3 4 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ÊçÆÁªìÊûÑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÆµÊ†ë </tag>
            
            <tag> Á∫øÊÄßÂü∫ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåYnoi2012„ÄçD2T1</title>
      <link href="/2020/08/04/%5BYnoi2012%5DD2T1/"/>
      <url>/2020/08/04/%5BYnoi2012%5DD2T1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>È¶ñÂÖàÊúâ‰∏Ä‰∏™ÊÄßË¥®</p><blockquote><p>ÂØπ‰∫é $n \ge 11$ÔºåÊìç‰Ωú $1$ ÂøÖÂÆöÊúâËß£</p></blockquote><p>‰∏Ä‰∏™Êù•Ëá™ $\text{Okami}$ ÁöÑ‰∏•Ë∞®ËØÅÊòéÔºö</p><p>ËÄÉËôë‰∫í‰∏çÁõ∏ÂêåÁöÑÊï∞ $x, y, z, ‚Ä¶$ÔºåÂàôÊúâ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x</span><br><span class="line">x y x+y</span><br><span class="line">x y z x+y x+z y+z x+y+z</span><br></pre></td></tr></table></figure><p>‰πüÂ∞±ÊòØÂØπ‰∫é $n$ ‰∏™‰∫í‰∏çÁõ∏ÂêåÁöÑÊï∞ÂÆÉ‰ª¨ÊòæÁÑ∂ÂèØ‰ª•ÊãºÂá∫ $2^n - 1$ÔºåÈÇ£‰πàÊ†πÊçÆÊäΩÂ±âÂéüÁêÜÔºåÂàôÊúâ $2^n - 1 \ge 1000$ Êó∂ÂøÖÂÆöÊúâËß£ÔºåÂàôÂëΩÈ¢òÊàêÁ´ã</p><p>ÈÇ£‰πàÂâ©‰∏ãÁöÑÂ∞±Áõ¥Êé• $\text{bitset}$ ‰ºòÂåñËÉåÂåÖÂ∞±Â•Ω‰∫ÜÔºàÊ≥®ÊÑèÂèØ‰ª•Áõ¥Êé•ËÉåÂåÖÂõ†‰∏∫Ëã•ÈõÜÂêà $X$ Âíå $Y$ ÂêåÊó∂ÈÄâ‰∫Ü‰∏Ä‰∏™Êï∞ÔºåÈÇ£‰πàÂÆÉ‰ª¨ÂêåÊó∂ÂéªÈô§ËØ•Êï∞‰πüÊòØÁõ∏Á≠âÁöÑÔºâÔºåËá≥‰∫éÊìç‰Ωú $2$ ÁöÑÂΩ±ÂìçÂàôÁõ¥Êé•Ê†ëÁä∂Êï∞ÁªÑÁªüËÆ°ÊØè‰∏™Êï∞Ë¶ÅÁ´ãÊñπÂá†Ê¨°ÔºåÁî±‰∫é $\bmod V$ÔºåÈÇ£‰πàÁõ¥Êé•ÂÄçÂ¢ûÂ§ÑÁêÜÂç≥ÂèØ</p><p>ÂçïËØçËØ¢ÈóÆÂ§çÊùÇÂ∫¶ $O (\frac{(r - l + 1)^2V}{32})$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXV = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, V;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> powv[MAXV][<span class="number">25</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V; i ++) powv[i][<span class="number">0</span>] = i * i * i % V;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">18</span>; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V; i ++)</span><br><span class="line">powv[i][j] = powv[powv[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">19</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line"><span class="keyword">if</span> (p &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)))</span><br><span class="line">x = powv[x][j - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x &amp; (- x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (x &lt;= N) &#123;</span><br><span class="line">subsum[x] += delta;</span><br><span class="line">x += lowbit (x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (x &gt; <span class="number">0</span>) &#123;</span><br><span class="line">cnt += subsum[x];</span><br><span class="line">x -= lowbit (x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bitset</span>&lt;12 * MAXV&gt; f;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), V = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum ();</span><br><span class="line">init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= M; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> opt = getnum (), l = getnum (), r = getnum ();</span><br><span class="line"><span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (r - l + <span class="number">1</span> &gt;= <span class="number">12</span>) <span class="built_in">puts</span> (<span class="string">"Yuno"</span>);</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">f.reset(); <span class="keyword">bool</span> suc = <span class="literal">false</span>; f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = calc (a[i], query (i));</span><br><span class="line"><span class="keyword">if</span> ((f &amp; (f &lt;&lt; x)).any()) &#123;</span><br><span class="line">suc = <span class="literal">true</span>; <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">f = f | (f &lt;&lt; x);</span><br><span class="line">&#125;</span><br><span class="line">suc ? <span class="built_in">puts</span> (<span class="string">"Yuno"</span>) : <span class="built_in">puts</span> (<span class="string">"Yuki"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> add (l, <span class="number">1</span>), add (r + <span class="number">1</span>, - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">20 20 152</span></span><br><span class="line"><span class="comment">3 26 133 54 79 81 72 109 66 91 82 100 35 23 104 17 51 114 12 58</span></span><br><span class="line"><span class="comment">2 1 17</span></span><br><span class="line"><span class="comment">2 6 12</span></span><br><span class="line"><span class="comment">1 1 12</span></span><br><span class="line"><span class="comment">2 3 5</span></span><br><span class="line"><span class="comment">2 11 11</span></span><br><span class="line"><span class="comment">2 7 19</span></span><br><span class="line"><span class="comment">2 6 15</span></span><br><span class="line"><span class="comment">1 5 12</span></span><br><span class="line"><span class="comment">1 1 9</span></span><br><span class="line"><span class="comment">1 10 19</span></span><br><span class="line"><span class="comment">2 3 19</span></span><br><span class="line"><span class="comment">2 6 20</span></span><br><span class="line"><span class="comment">2 1 13</span></span><br><span class="line"><span class="comment">2 1 15</span></span><br><span class="line"><span class="comment">2 1 9</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">2 1 7</span></span><br><span class="line"><span class="comment">2 7 19</span></span><br><span class="line"><span class="comment">2 6 19</span></span><br><span class="line"><span class="comment">2 3 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ËÉåÂåÖDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåWC2018„ÄçÈÄöÈÅì</title>
      <link href="/2020/08/04/%5BWC2018%5D%E9%80%9A%E9%81%93/"/>
      <url>/2020/08/04/%5BWC2018%5D%E9%80%9A%E9%81%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ËøôÈ¢òÁúüÁöÑÊòØÂÜôÂà∞ÂøÉÊÄÅÁàÜÁÇ∏„ÄÇ„ÄÇ</p><p>‰∏ÄÈÅìËæπÂàÜÊ≤ª + ËôöÊ†ë</p><h2 id="ÂâçÁΩÆÁü•ËØÜ"><a href="#ÂâçÁΩÆÁü•ËØÜ" class="headerlink" title="ÂâçÁΩÆÁü•ËØÜ"></a>ÂâçÁΩÆÁü•ËØÜ</h2><h3 id="ËæπÂàÜÊ≤ª"><a href="#ËæπÂàÜÊ≤ª" class="headerlink" title="ËæπÂàÜÊ≤ª"></a>ËæπÂàÜÊ≤ª</h3><p>È°æÂêçÊÄù‰πâÔºåÂ∞±ÊòØÈÄâÊã©‰∏ÄÊù°ËæπÔºåÁ±ª‰ººÁÇπÂàÜÊ≤ªÂØπÊâÄÊúâÁªèËøáËØ•ËæπÁöÑË∑ØÂæÑËøõË°åÂ§ÑÁêÜÔºå‰ΩÜ‰∏éÁÇπÂàÜÊ≤ª‰∏çÂêåÁöÑÊòØÔºåËæπÂàÜÊ≤ªÂèØËÉΩ‰ºöË¢´ËèäËä±ÂõæÂç°Âà∞ $O (n^2)$ÔºåÊïÖÊ≠§Êó∂ÈúÄË¶ÅÈáçÊûÑÊ†ëÔºåÂ∞Ü‰πãÂèò‰∏∫Â∫¶Êï∞‰∏çË∂ÖËøá‰∏âÁöÑ‰∫åÂèâÊ†ë</p><h4 id="Ê†ëÈáçÊûÑ"><a href="#Ê†ëÈáçÊûÑ" class="headerlink" title="Ê†ëÈáçÊûÑ"></a>Ê†ëÈáçÊûÑ</h4><p>ÈÄöËøáÂª∫Á´ãÊñ∞ÁöÑËôöÁÇπËøõË°åÈáçÊûÑÔºå‰ΩÜË¶ÅÊª°Ë∂≥Âä†ÂÖ•ÁöÑËôöÁÇπ‰∏çÂΩ±ÂìçÊúÄÂêéÁ≠îÊ°àËÆ°ÁÆó</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rebuild</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> nf = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">LL w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (! nf) &#123;</span><br><span class="line">Insert (root, v, w), Insert (v, root, w);</span><br><span class="line">nf = root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> k = ++ m; <span class="comment">// ËôöÁÇπ</span></span><br><span class="line">Insert (nf, k, <span class="number">0</span>), Insert (k, nf, <span class="number">0</span>);</span><br><span class="line">Insert (k, v, w), Insert (v, k, w);</span><br><span class="line">nf = k;</span><br><span class="line">&#125;</span><br><span class="line">rebuild (v, root);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Ê±Ç‰∏≠ÂøÉËæπ"><a href="#Ê±Ç‰∏≠ÂøÉËæπ" class="headerlink" title="Ê±Ç‰∏≠ÂøÉËæπ"></a>Ê±Ç‰∏≠ÂøÉËæπ</h4><p>‰∫éÁÇπÂàÜÊ≤ªÁöÑÊ±ÇÈáçÂøÉÁï•Êúâ‰∏çÂêåÔºå‰ΩÜÊú¨Ë¥®ÊòØ‰∏ÄÊ†∑ÁöÑ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> cet, mini; <span class="comment">// ÈáçÂøÉËæπ</span></span><br><span class="line"><span class="keyword">bool</span> visit[MAXM &lt;&lt; <span class="number">3</span>]= &#123;<span class="literal">false</span>&#125;; <span class="comment">// ËæπÊòØÂê¶Â∑≤ÁªèË¢´ÁªèËøá</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findc</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; ~ i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (visit[i &gt;&gt; <span class="number">1</span>] || v == father) <span class="keyword">continue</span>;</span><br><span class="line">findc (n, v, root);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line"><span class="keyword">int</span> maxpart = max (subsize[v], n - subsize[v]); <span class="comment">// Ê≥®ÊÑèÊ≠§Â§Ñ</span></span><br><span class="line"><span class="keyword">if</span> (maxpart &lt; mini) &#123; mini = maxpart; cet = i; &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>Áé∞Âú®ÂºÄÂßãËæπÂàÜÊ≤ªÔºåÂàÜÊ≤ªÂà∞Êüê‰∏ÄËæπ $E$ÔºåÂ∞ÜÁõ∏Â∫îÁÇπÂàÜ‰∏∫‰∏§‰∏™ËøûÈÄöÂùó $A, B$</p><p>ËÄÉËôëÂéüÂºèÔºåÂÖ∂‰∏≠ $d_T(x)$ Ë°®Á§∫Âú®Ê†ë $T$ ‰∏≠ $x$ Ë∑ùÊ†πËäÇÁÇπÔºàÊàñÂàÜÊ≤ª‰∏≠ÂøÉÔºâÁöÑÈïøÂ∫¶ÔºåÂØπ‰∏§ÁÇπ $i \in A, j \in B$<br>$$<br>ans = \max \{d_{T_1}(i) + d_{T_1}(j) + dist_{T_2}(i, j) + dist_{T_3}(i, j)\}<br>$$<br>Ê≠§Êó∂ÂØπ $A \cup B$ Âª∫Á´ãËôöÊ†ëÔºåÂú®ËôöÊ†ë‰∏äË∑ë $\text{DFS}$ÔºåËÆæÊ≠§Êó∂ËÆøÈóÆÂà∞ËôöÊ†ë‰∏äÁÇπ $p$ÔºåÂàôÂºèÂ≠êÂèØÂèò‰∏∫<br>$$<br>\begin{aligned}<br>ans &amp;= \max \{d_{T_1}(i) + d_{T_1}(j) + d_{T_2}(i) + d_{T_2}(j) - 2 \times d_{T_2}(p) + dist_{T_3}(i, j)\} \\<br>&amp;= \max \{(d_{T_1} + d_{T_2})(i) + (d_{T_1} + d_{T_2})(j)- 2 \times d_{T_2}(p) + dist_{T_3}(i, j)\}<br>\end{aligned}<br>$$<br>ËøôÂ∞±Áõ∏ÂΩì‰∫éÁªô $T_3$ ÁöÑÁÇπ $i, j$ ÂàÜÂà´Ëµã‰∏äÊùÉÂÄº $value_i = d_{T_1}(i) + d_{T_2}(i), value_j = d_{T_1}(j) + d_{T_2}(j)$ÔºåÁÑ∂ÂêéÊ±Ç $T_3$ ‰∏äÁÇπ $i \in A, j \in B$ ÁöÑ $i, j$ Èó¥ËæπÊùÉÂíåÂú®Âä†‰∏ä $i, j$ ÁÇπÊùÉÁöÑÊúÄÂ§ßÂÄºÂç≥ÂèØÊ±ÇÂæóÁ≠îÊ°àÔºåÂ∞±ÊòØÁªô $T_3$ ‰∏äÁöÑÁÇπÈªëÁôΩÊüìËâ≤ÔºåÊ±ÇÁôΩÁÇπÂà∞ÈªëÁÇπÁöÑÁ´ØÁÇπÁÇπÊùÉÂç≥ËæπÊùÉÂíåÁöÑÊúÄÂ§ßÂÄº</p><p>ÈÇ£‰πàÊ≠§Êó∂ÂèëÁé∞ËæπÊùÉ $w_i$ ÈÉΩÊòØÊ≠£Êï¥Êï∞ÔºåËØ¥ÊòéÂÆÉ‰ª¨Êª°Ë∂≥Áõ¥ÂæÑÂêàÂπ∂ÁöÑÂÆöÁêÜÔºåÂç≥Êñ∞Áõ¥ÂæÑÂøÖÂÆöÁî±ÂéüÊù•‰∏§Êù°Áõ¥ÂæÑÁöÑÁ´ØÁÇπ‰∫ßÁîüÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Áõ¥Êé•Ê±Ç‰∫ÜÔºåÂú® $T_2$ ‰∏ä $\text{dp}$ Êó∂È°∫‰æøÂêàÂπ∂ $T_3$ ÁöÑÁ≠îÊ°à</p><p>Ëøô‰πàÁõ¥Êé•ÂÅöÊó∂ $O (n \log^2 n)$ ÁöÑÔºåÂ∏∏Êï∞‰∏ÄÂ§ßÈÇ£Â∞±Áé©ÁêÉ</p><p>ÂÖ∂ÂÆû‰ºòÂåñÂà∞ $O (n \log n)$ ‰πüÊòØÂæàÊòæÁÑ∂ÁöÑÔºåÂÜô‰∏™ $\text{RMQ}$ ÁöÑ $\text{LCA}$ÔºåÂπ∂‰∏îÂú®Âª∫ËôöÊ†ëÊó∂‰∏çÁî® $\text{sort}$ ËÄåÊòØÂü∫Êï∞ÊéíÂ∫èÂ∞±Â•Ω‰∫Ü</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><p>357Ë°åÔºàÂåÖÂê´Â∞ëÈáèÊ≥®ÈáäÔºâ„ÄÇ„ÄÇÈÉΩ‰∏çÁü•Â§ö‰πÖÊ≤°ÊúâÊâì‰ª£Á†ÅÊâìÁöÑËøô‰πàÂ∏¶ÊÑüËøá‰∫Ü„ÄÇ„ÄÇ</p><p>$\text{debug}$ ÁúüÁöÑÂ∞±Â§üÂèó‰∫Ü</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="comment">//T3</span></span><br><span class="line">LL val[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree3</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span> <span class="keyword">int</span> to, next; LL w; &#125; ;</span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN], size;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v; Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u]; Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dfn[MAXN], ord, cnt;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN], value[MAXN &lt;&lt; <span class="number">1</span>], bel[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line">LL d[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">dfn[root] = ++ ord;</span><br><span class="line">value[ord] = depth[root], bel[ord] = root;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">LL w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[root] + <span class="number">1</span>;</span><br><span class="line">d[v] = d[root] + w;</span><br><span class="line">DFS (v, root);</span><br><span class="line">value[++ ord] = depth[root];</span><br><span class="line">bel[ord] = root;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ord; i ++) ST[i][<span class="number">0</span>] = make_pair (value[i], bel[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">20</span>; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= ord; i ++)</span><br><span class="line"><span class="keyword">if</span> (ST[i][j - <span class="number">1</span>].first &lt; ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>].first) ST[i][j] = ST[i][j - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> ST[i][j] = ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">LCA</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = log2 (r - l + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (ST[l][k].first &lt; ST[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].first) <span class="keyword">return</span> ST[l][k].second;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> ST[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].second;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">dist</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (dfn[x] &gt; dfn[y]) swap (x, y);</span><br><span class="line"><span class="keyword">int</span> lca = LCA (dfn[x], dfn[y]);</span><br><span class="line"><span class="keyword">return</span> val[x] + val[y] + d[x] + d[y] - <span class="number">2l</span>l * d[lca];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">LL w = getnum ();</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">&#125;</span><br><span class="line">ord = <span class="number">0</span>;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>); RMQ ();</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Tree3 T3;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">diam</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> x, y; LL d;</span><br><span class="line">diam (<span class="keyword">int</span> fx = <span class="number">0</span>, <span class="keyword">int</span> fy = <span class="number">0</span>, LL fd = <span class="number">0</span>) : x (fx), y (fy), d (fd) &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">diam f[MAXN][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">query</span> <span class="params">(diam A, diam B)</span> </span>&#123;</span><br><span class="line">LL d1 = max (T3.dist (A.x, B.x), T3.dist (A.x, B.y));</span><br><span class="line">LL d2 = max (T3.dist (A.y, B.x), T3.dist (A.y, B.y));</span><br><span class="line"><span class="keyword">return</span> max (d1, d2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">diam <span class="title">merge</span> <span class="params">(diam A, diam B)</span> </span>&#123;</span><br><span class="line">LL maxi; diam ret;</span><br><span class="line">ret = A.d &gt; B.d ? diam (A.x, A.y, maxi = A.d) : diam (B.x, B.y, maxi = B.d);</span><br><span class="line"><span class="keyword">if</span> (T3.dist (A.x, B.x) &gt; maxi) &#123; ret = diam (A.x, B.x, maxi = T3.dist (A.x, B.x)); &#125;</span><br><span class="line"><span class="keyword">if</span> (T3.dist (A.x, B.y) &gt; maxi) &#123; ret = diam (A.x, B.y, maxi = T3.dist (A.x, B.y)); &#125;</span><br><span class="line"><span class="keyword">if</span> (T3.dist (A.y, B.x) &gt; maxi) &#123; ret = diam (A.y, B.x, maxi = T3.dist (A.y, B.x)); &#125;</span><br><span class="line"><span class="keyword">if</span> (T3.dist (A.y, B.y) &gt; maxi) &#123; ret = diam (A.y, B.y, maxi = T3.dist (A.y, B.y)); &#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; a, <span class="keyword">const</span> <span class="keyword">int</span>&amp; b)</span> </span>&#123; <span class="keyword">return</span> dfn[a] &lt; dfn[b]; &#125;</span><br><span class="line"><span class="comment">//T2</span></span><br><span class="line"><span class="keyword">int</span> dye[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> iskey[MAXN]= &#123;<span class="number">0</span>&#125;, isdye[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree2</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span> <span class="keyword">int</span> to, next; LL w; &#125; ;</span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN], size;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v; Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u]; Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ord;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN], value[MAXN &lt;&lt; <span class="number">1</span>], bel[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line">LL d[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">dfn[root] = ++ ord;</span><br><span class="line">value[ord] = depth[root], bel[ord] = root;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">LL w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[root] + <span class="number">1</span>;</span><br><span class="line">d[v] = d[root] + w;</span><br><span class="line">DFS (v, root);</span><br><span class="line">value[++ ord] = depth[root];</span><br><span class="line">bel[ord] = root;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ord; i ++) ST[i][<span class="number">0</span>] = make_pair (value[i], bel[i]);</span><br><span class="line"><span class="keyword">int</span> MAX = log2 (ord) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= MAX; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= ord; i ++)</span><br><span class="line"><span class="keyword">if</span> (ST[i][j - <span class="number">1</span>].first &lt; ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>].first) ST[i][j] = ST[i][j - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> ST[i][j] = ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">LCA</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (dfn[x] &gt; dfn[y]) swap (x, y);</span><br><span class="line"><span class="keyword">int</span> l = dfn[x], r = dfn[y];</span><br><span class="line"><span class="keyword">int</span> k = log2 (r - l + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (ST[l][k].first &lt; ST[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].first) <span class="keyword">return</span> ST[l][k].second;</span><br><span class="line"><span class="keyword">return</span> ST[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">stack</span>[MAXN], top;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! top) &#123; <span class="built_in">stack</span>[++ top] = x; <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="keyword">int</span> lca = LCA (<span class="built_in">stack</span>[top], x);</span><br><span class="line"><span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; depth[lca] &lt; depth[<span class="built_in">stack</span>[top - <span class="number">1</span>]]) &#123;</span><br><span class="line">Insert (<span class="built_in">stack</span>[top - <span class="number">1</span>], <span class="built_in">stack</span>[top], <span class="number">0</span>); top --;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (depth[lca] &lt; depth[<span class="built_in">stack</span>[top]]) &#123; Insert (lca, <span class="built_in">stack</span>[top], <span class="number">0</span>); top --; &#125;</span><br><span class="line"><span class="keyword">if</span> (! top || <span class="built_in">stack</span>[top] != lca) <span class="built_in">stack</span>[++ top] = lca;</span><br><span class="line"><span class="built_in">stack</span>[++ top] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cstr</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; <span class="comment">// ËôöÊ†ëÊûÑÂª∫</span></span><br><span class="line">size = <span class="number">0</span>;</span><br><span class="line">top = <span class="number">0</span>; <span class="keyword">if</span> (a[l] != <span class="number">1</span>) <span class="built_in">stack</span>[++ top] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) &#123; add (a[i]); val[a[i]] += d[a[i]]; iskey[a[i]] = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">while</span> (top &gt; <span class="number">1</span>) &#123; Insert (<span class="built_in">stack</span>[top - <span class="number">1</span>], <span class="built_in">stack</span>[top], <span class="number">0</span>); top --; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123; <span class="comment">// dp</span></span><br><span class="line">vis[u] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (iskey[u]) &#123;</span><br><span class="line">isdye[u][dye[u]] = <span class="literal">true</span>;</span><br><span class="line">f[u][dye[u]] = diam (u, u, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">dp (v);</span><br><span class="line"><span class="keyword">if</span> (isdye[u][<span class="number">0</span>] &amp;&amp; isdye[v][<span class="number">1</span>]) ans = max (ans, query (f[u][<span class="number">0</span>], f[v][<span class="number">1</span>]) - <span class="number">2l</span>l * d[u]);</span><br><span class="line"><span class="keyword">if</span> (isdye[u][<span class="number">1</span>] &amp;&amp; isdye[v][<span class="number">0</span>]) ans = max (ans, query (f[u][<span class="number">1</span>], f[v][<span class="number">0</span>]) - <span class="number">2l</span>l * d[u]);</span><br><span class="line"><span class="keyword">if</span> (isdye[v][<span class="number">0</span>]) &#123;</span><br><span class="line"><span class="keyword">if</span> (! isdye[u][<span class="number">0</span>]) f[u][<span class="number">0</span>] = f[v][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">else</span> f[u][<span class="number">0</span>] = merge (f[u][<span class="number">0</span>], f[v][<span class="number">0</span>]);</span><br><span class="line">isdye[u][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (isdye[v][<span class="number">1</span>]) &#123;</span><br><span class="line"><span class="keyword">if</span> (! isdye[u][<span class="number">1</span>]) f[u][<span class="number">1</span>] = f[v][<span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> f[u][<span class="number">1</span>] = merge (f[u][<span class="number">1</span>], f[v][<span class="number">1</span>]);</span><br><span class="line">isdye[u][<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to; del (v);</span><br><span class="line">&#125;</span><br><span class="line">Head[u] = val[u] = dye[u] = <span class="number">0</span>; iskey[u] = isdye[u][<span class="number">0</span>] = isdye[u][<span class="number">1</span>] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">LL w = getnum ();</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">&#125;</span><br><span class="line">ord = <span class="number">0</span>;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>); RMQ ();</span><br><span class="line">size = <span class="number">0</span>; <span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = i;</span><br><span class="line">sort (a + <span class="number">1</span>, a + N + <span class="number">1</span>, comp);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Tree2 T2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// T1</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree1_ori</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span> <span class="keyword">int</span> to, next; LL w; &#125; ;</span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN], size;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v; Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u]; Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Tree1_ori T1;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line">LL w;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> size = - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rebuild</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> nf = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = T1.Head[root]; i; i = T1.Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = T1.Link[i].to;</span><br><span class="line">LL w = T1.Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (! nf) &#123;</span><br><span class="line">Insert (root, v, w), Insert (v, root, w);</span><br><span class="line">nf = root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> k = ++ m;</span><br><span class="line">Insert (nf, k, <span class="number">0</span>), Insert (k, nf, <span class="number">0</span>);</span><br><span class="line">Insert (k, v, w), Insert (v, k, w);</span><br><span class="line">nf = k;</span><br><span class="line">&#125;</span><br><span class="line">rebuild (v, root);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> subsize[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> cet, mini; <span class="comment">// ÈáçÂøÉËæπ</span></span><br><span class="line"><span class="keyword">bool</span> visit[MAXM &lt;&lt; <span class="number">3</span>]= &#123;<span class="literal">false</span>&#125;; <span class="comment">// ËæπÊòØÂê¶Â∑≤ÁªèË¢´ÁªèËøá</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findc</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; ~ i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (visit[i &gt;&gt; <span class="number">1</span>] || v == father) <span class="keyword">continue</span>;</span><br><span class="line">findc (n, v, root);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line"><span class="keyword">int</span> maxpart = max (subsize[v], n - subsize[v]);</span><br><span class="line"><span class="keyword">if</span> (maxpart &lt; mini) &#123; mini = maxpart; cet = i; &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">coll</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> root, <span class="keyword">int</span> father, LL d)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (root &lt;= N) &#123; dye[root] = p; val[root] = d; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; ~ i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">LL w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (visit[i &gt;&gt; <span class="number">1</span>] || v == father) <span class="keyword">continue</span>;</span><br><span class="line">coll (p, v, root, d + w);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tp[<span class="number">2</span>][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> n, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">cet = - <span class="number">1</span>, mini = INF; findc (n, u, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (cet == - <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">visit[cet &gt;&gt; <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> x = Link[cet].to, y = Link[cet ^ <span class="number">1</span>].to;</span><br><span class="line">coll (<span class="number">0</span>, x, y, Link[cet].w); coll (<span class="number">1</span>, y, x, <span class="number">0</span>);</span><br><span class="line">T2.cstr (l, r); T2.dp (<span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> cnt[<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) tp[dye[a[i]]][++ cnt[dye[a[i]]]] = a[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= l + cnt[<span class="number">0</span>] - <span class="number">1</span>; i ++) a[i] = tp[<span class="number">0</span>][i - l + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l + cnt[<span class="number">0</span>]; i &lt;= r; i ++) a[i] = tp[<span class="number">1</span>][i - l - cnt[<span class="number">0</span>] + <span class="number">1</span>];</span><br><span class="line">T2.del (<span class="number">1</span>); <span class="keyword">int</span> szr = n - subsize[x];</span><br><span class="line">divide (x, subsize[x], l, l + cnt[<span class="number">0</span>] - <span class="number">1</span>);</span><br><span class="line">divide (y, szr, l + cnt[<span class="number">0</span>], r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">LL w = getnum ();</span><br><span class="line">T1.Insert (u, v, w), T1. Insert (v, u, w);</span><br><span class="line">&#125;</span><br><span class="line">T2.build (); T3.build ();</span><br><span class="line"><span class="built_in">memset</span> (Head, - <span class="number">1</span>, <span class="keyword">sizeof</span> (Head));</span><br><span class="line">m = N; rebuild (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">divide (<span class="number">1</span>, m, <span class="number">1</span>, N);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">1 3 0</span></span><br><span class="line"><span class="comment">1 4 1</span></span><br><span class="line"><span class="comment">4 5 7</span></span><br><span class="line"><span class="comment">1 2 0</span></span><br><span class="line"><span class="comment">2 3 1</span></span><br><span class="line"><span class="comment">2 4 1</span></span><br><span class="line"><span class="comment">2 5 3</span></span><br><span class="line"><span class="comment">1 5 2</span></span><br><span class="line"><span class="comment">2 3 8</span></span><br><span class="line"><span class="comment">3 4 5</span></span><br><span class="line"><span class="comment">4 5 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ê†ë‰∏äDP </tag>
            
            <tag> ËæπÂàÜÊ≤ª </tag>
            
            <tag> ËôöÊ†ë </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåWC2008„ÄçÊ∏∏ËßàËÆ°Âàí „ÄåÊñØÂù¶ÈÇ£Ê†ëÊ®°Êùø„Äç</title>
      <link href="/2020/08/04/%5BWC2008%5D%E6%B8%B8%E8%A7%88%E8%AE%A1%E5%88%92%20%E3%80%8C%E6%96%AF%E5%9D%A6%E9%82%A3%E6%A0%91%E6%A8%A1%E6%9D%BF%E3%80%8D/"/>
      <url>/2020/08/04/%5BWC2008%5D%E6%B8%B8%E8%A7%88%E8%AE%A1%E5%88%92%20%E3%80%8C%E6%96%AF%E5%9D%A6%E9%82%A3%E6%A0%91%E6%A8%A1%E6%9D%BF%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="ÊñØÂù¶ÈÇ£Ê†ë"><a href="#ÊñØÂù¶ÈÇ£Ê†ë" class="headerlink" title="ÊñØÂù¶ÈÇ£Ê†ë"></a>ÊñØÂù¶ÈÇ£Ê†ë</h3><p>ÁôæÂ∫¶Èáä‰πâ</p><blockquote><p>ÊñØÂù¶Á∫≥Ê†ëÈóÆÈ¢òÊòØÁªÑÂêà‰ºòÂåñÈóÆÈ¢òÔºå‰∏éÊúÄÂ∞èÁîüÊàêÊ†ëÁõ∏‰ººÔºåÊòØÊúÄÁü≠ÁΩëÁªúÁöÑ‰∏ÄÁßç„ÄÇÊúÄÂ∞èÁîüÊàêÊ†ëÊòØÂú®ÁªôÂÆöÁöÑÁÇπÈõÜÂíåËæπ‰∏≠ÂØªÊ±ÇÊúÄÁü≠ÁΩëÁªú‰ΩøÊâÄÊúâÁÇπËøûÈÄö„ÄÇËÄåÊúÄÂ∞èÊñØÂù¶Á∫≥Ê†ëÂÖÅËÆ∏Âú®ÁªôÂÆöÁÇπÂ§ñÂ¢ûÂä†È¢ùÂ§ñÁöÑÁÇπÔºå‰ΩøÁîüÊàêÁöÑÊúÄÁü≠ÁΩëÁªúÂºÄÈîÄÊúÄÂ∞è„ÄÇ</p></blockquote><p>Âç≥ÊúÄÂ∞èÊñØÂù¶ÈÇ£Ê†ëÂç≥‰∏∫Âπ∂ÈùûÈÄâÊã©ÊâÄÊúâÁöÑÁªìÁÇπÔºåËÄåÊòØÈÄâÊã©‰∏ÄÈÉ®ÂàÜÁªìÁÇπÔºå‰∏∫‰øùËØÅÂÆÉ‰ª¨ËøûÈÄöÔºå‰∏îÊ±ÇËß£ÊúÄÂ∞èÂºÄÈîÄ</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÊñØÂù¶ÈÇ£Ê†ëÊ®°Êùø</p><p>ÂèëÁé∞Áõ¥Êé•Ë°®Á§∫ÁÇπÁöÑÂ≠òÂú®ÊÄßÊ≤°ÊúâÊÑè‰πâ</p><p>ËÆæÂáΩÊï∞ $f[i][state]$ Ë°®Á§∫ÔºöÂØπ‰∫éÁÇπ $i$ÔºåÂÖ∂ÂÆÉÁªìÁÇπ‰∏éÂÖ∂ËøûÈÄöÊÉÖÂÜµ</p><p>ÈÇ£‰πàÊúâ‰∏§ÁßçËΩ¨Áßª</p><p>ÂÖ∂‰∏Ä„ÄÅÁî±ÂÖ∂Â≠êÈõÜËΩ¨Áßª<br>$$<br>f[i][state] = \min\limits_{sub \in state} \{f[i][sub] + f[i][\complement_{state}sub] - value_i\}<br>$$<br>‰πãÊâÄ‰ª•Ë¶ÅÂáèÂéª $value_i$ ÊòØÂõ†‰∏∫‰ºöÁÆóÈáç</p><p>ÈôÑÔºöÊûö‰∏æÂ≠êÈõÜÁöÑÊñπÊ≥ï</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> sub = state &amp; (state - <span class="number">1</span>); sub; sub = (sub - <span class="number">1</span>) &amp; state)</span><br></pre></td></tr></table></figure><p>ÂÖ∂‰∫å„ÄÅÁî±Áõ∏ÈÇªÂΩìÂâçÁä∂ÊÄÅ‰∏ãÁªìÁÇπËΩ¨Áßª<br>$$<br>f[i][state] = \min\limits_{state_p = true} \{f[p][state] + value_i\}<br>$$<br>ÂèëÁé∞ÂæàÂÉè‰∏âËßíÂΩ¢‰∏çÁ≠âÂºèÔºåÊïÖËÄÉËôë $SPFA$ ËΩ¨Áßª</p><p>ÊÄªÂ§çÊùÇÂ∫¶ $O (n3^n + kE2^n)$Ôºå$3^n$ ‰∏∫Êûö‰∏æÂ≠êÈõÜÊÄªÂ§çÊùÇÂ∫¶</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">10</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1</span> &lt;&lt; <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NextX[<span class="number">4</span>]= &#123;- <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, NextY[<span class="number">4</span>]= &#123;<span class="number">0</span>, - <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> Map[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">preSt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"><span class="keyword">int</span> state;</span><br><span class="line"></span><br><span class="line">preSt (<span class="keyword">int</span> fx = <span class="number">0</span>, <span class="keyword">int</span> fy = <span class="number">0</span>, <span class="keyword">int</span> fs = <span class="number">0</span>) :</span><br><span class="line">x (fx), y (fy), state (fs) &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN][MAXM];</span><br><span class="line">preSt pre[MAXN][MAXN][MAXM];</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; que;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span> <span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; top = que.front();</span><br><span class="line">que.pop();</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> x = top.first, y = top.second;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> tx = x + NextX[i];</span><br><span class="line"><span class="keyword">int</span> ty = y + NextY[i];</span><br><span class="line"><span class="keyword">if</span> (tx &lt; <span class="number">1</span> || tx &gt; N || ty &lt; <span class="number">1</span> || ty &gt; M)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (f[x][y][state] + Map[tx][ty] &lt; f[tx][ty][state]) &#123;</span><br><span class="line">f[tx][ty][state] = f[x][y][state] + Map[tx][ty];</span><br><span class="line">pre[tx][ty][state] = preSt (x, y, state);</span><br><span class="line">que.push(make_pair (tx, ty));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tag[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">traceback</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! x || ! y)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">tag[x][y] = <span class="number">1</span>;</span><br><span class="line">preSt pr = pre[x][y][state];</span><br><span class="line">traceback (pr.x, pr.y, pr.state);</span><br><span class="line"><span class="keyword">if</span> (pr.x == x &amp;&amp; pr.y == y)</span><br><span class="line">traceback (pr.x, pr.y, state - pr.state);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">int</span> px, py;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line">Map[i][j] = getnum ();</span><br><span class="line"><span class="keyword">if</span> (! Map[i][j]) &#123;</span><br><span class="line">cnt ++, f[i][j][<span class="number">1</span> &lt;&lt; (cnt - <span class="number">1</span>)] = <span class="number">0</span>;</span><br><span class="line">px = i, py = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> limit = (<span class="number">1</span> &lt;&lt; cnt) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">1</span>; state &lt;= limit; state ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> sub = state &amp; (state - <span class="number">1</span>); sub; sub = (sub - <span class="number">1</span>) &amp; state) <span class="comment">// from subset</span></span><br><span class="line"><span class="keyword">if</span> (f[i][j][sub] + f[i][j][state - sub] - Map[i][j] &lt; f[i][j][state]) &#123;</span><br><span class="line">f[i][j][state] = f[i][j][sub] + f[i][j][state - sub] - Map[i][j];</span><br><span class="line">pre[i][j][state] = preSt (i, j, sub);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (f[i][j][state] &lt; INF)</span><br><span class="line">que.push(make_pair (i, j));</span><br><span class="line">&#125;</span><br><span class="line">SPFA (state); <span class="comment">// from other nodes</span></span><br><span class="line">&#125;</span><br><span class="line">traceback (px, py, limit);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, f[px][py][limit]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! Map[i][j])</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">'x'</span>);</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">tag[i][j] ? <span class="built_in">putchar</span> (<span class="string">'o'</span>) : <span class="built_in">putchar</span> (<span class="string">'_'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 4</span></span><br><span class="line"><span class="comment">0 1 1 0</span></span><br><span class="line"><span class="comment">2 5 5 1</span></span><br><span class="line"><span class="comment">1 5 5 1</span></span><br><span class="line"><span class="comment">0 1 1 0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊñØÂù¶Á∫≥Ê†ë </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåSDOI2009„ÄçHHÂéªÊï£Ê≠• „ÄåÁü©Èòµ‰πòÊ≥ïËÆ°Êï∞„Äç</title>
      <link href="/2020/08/04/%5BSDOI2009%5DHH%E5%8E%BB%E6%95%A3%E6%AD%A5%20%E3%80%8C%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95%E8%AE%A1%E6%95%B0%E3%80%8D/"/>
      <url>/2020/08/04/%5BSDOI2009%5DHH%E5%8E%BB%E6%95%A3%E6%AD%A5%20%E3%80%8C%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95%E8%AE%A1%E6%95%B0%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ËÆ°Êï∞ÈóÆÈ¢ò‰πüËÆ∏ÂèØ‰ª•ËΩ¨Âåñ‰∏∫Áü©Èòµ‰πòÊ≥ïÂΩ¢Âºè</p><p>ÊØîÂ¶ÇËã•ËØ•È¢òÊ≤°Êúâ‰∏çËÉΩÂú®‰∏ÄÊù°Ëæπ‰∏äÈáçÂ§çËµ∞ÁöÑÊù°‰ª∂ÈôêÂà∂ÔºåÈÇ£‰πàÁõ¥Êé•Â∞ÜÈÇªÊé•Áü©ÈòµËΩ¨Âåñ‰∏∫Áü©Èòµ‰πòÊ≥ïÂç≥ÂèØ</p><p>ÊïÖ</p><h3 id="Áü©Èòµ‰πòÊ≥ïËÆ°Êï∞"><a href="#Áü©Èòµ‰πòÊ≥ïËÆ°Êï∞" class="headerlink" title="Áü©Èòµ‰πòÊ≥ïËÆ°Êï∞"></a>Áü©Èòµ‰πòÊ≥ïËÆ°Êï∞</h3><p>ÂØπ‰∫éËÆ°Êï∞ÈóÆÈ¢òÔºåËã•ÂèØ‰ª•Â∞Ü $n$ ‰∏™ÁÇπË°®Á§∫Êàê $n \times n$ ÁöÑÁü©ÈòµÔºåÂπ∂‰∏îÂèØ‰ª•‰øùËØÅ‰∏≠ÈÄîËΩ¨ÁßªÂØπË±°‰∏ç‰ºöÂèòÂåñÔºåÂç≥ÂèØÁî®Áü©Èòµ‰πòÊ≥ïËÆ°Êï∞</p><h3 id="Ëá≥‰∫éËØ•È¢ò"><a href="#Ëá≥‰∫éËØ•È¢ò" class="headerlink" title="Ëá≥‰∫éËØ•È¢ò"></a>Ëá≥‰∫éËØ•È¢ò</h3><p>ÈÇ£‰πàËÄÉËôëËØ•È¢òÔºåÂä†ÂÖ•‰∫Ü‰∏çËÉΩÈáçÂ§çÂú®‰∏ÄÊù°Ëæπ‰∏äËµ∞ÁöÑÈôêÂà∂ÔºåÈÇ£‰πàÊúÄÁÆÄÂçïÁöÑÊÄùÊÉ≥Â∞±ÊòØÊãÜÁÇπÔºåÂπ∂‰∏îËÆ©ÊîπÁÇπÂ±èËîΩÊéâÂΩìÂâçÊñπÂêëÔºå‰ΩÜÊòØÂ¶ÇÊûúËÄÉËôëËæπÔºå‰∏ÄÊù°Êó†ÂêëËæπÂèØ‰ª•ÊãÜÊàê‰∏§Êù°ÊúâÂêëËæπÔºåÈÇ£ÊãÜÂá∫Êù•ÁöÑÂ∞±ÊØîÁÇπÂ∞ëÂæàÂ§ö‰∫ÜÔºåÊïÖËÄÉËôëÁÇπËæπËΩ¨Âåñ</p><p>ÈÇ£‰πàÂè™Ë¶ÅÂú®Ëµ∑ÂßãÁÇπÂä†‰∏ÄÊù°Ë∂ÖÁ∫ßÊ∫êËæπÔºåÂêåÊ†∑Áü©Èòµ‰πòÊ≥ïÂç≥ÂèØÁªüËÆ°Á≠îÊ°à</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 45989</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">50</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">120</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, K;</span><br><span class="line"><span class="keyword">int</span> st, ed;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">LL a[MAXM][MAXM];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= size; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= size; j ++)</span><br><span class="line">a[i][j] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">Matrix newmat;</span><br><span class="line">newmat.init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= size; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= size; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= size; k ++)</span><br><span class="line">newmat.a[i][j] = (newmat.a[i][j] + a[i][k] * p.a[k][j] % MOD) % MOD;</span><br><span class="line"><span class="keyword">return</span> newmat;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Matrix mats, bem;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">mats = mats * bem;</span><br><span class="line">bem = bem * bem;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[ed]; i; i = Link[i].next)</span><br><span class="line">ans = (ans + mats.a[<span class="number">1</span>][i ^ <span class="number">1</span>]) % MOD;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), K = getnum (), st = getnum () + <span class="number">1</span>, ed = getnum () + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum () + <span class="number">1</span>, v = getnum () + <span class="number">1</span>;</span><br><span class="line">Insert (u, v), Insert (v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[st]; i; i = Link[i].next)</span><br><span class="line">bem.a[<span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= size; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = Head[v]; j; j = Link[j].next) &#123;</span><br><span class="line"><span class="keyword">if</span> ((j ^ <span class="number">1</span>) == i)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">bem.a[i][j] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= size; i ++)</span><br><span class="line">mats.a[i][i] = <span class="number">1</span>;</span><br><span class="line">LL ans = power (K);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5 3 0 0</span></span><br><span class="line"><span class="comment">0 1</span></span><br><span class="line"><span class="comment">0 2</span></span><br><span class="line"><span class="comment">0 3</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Áü©Èòµ‰πòÊ≥ï </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåSCOI2016„ÄçËêåËêåÂìí</title>
      <link href="/2020/08/04/%5BSCOI2016%5D%E8%90%8C%E8%90%8C%E5%93%92/"/>
      <url>/2020/08/04/%5BSCOI2016%5D%E8%90%8C%E8%90%8C%E5%93%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Á¨¨‰∏ÄÊ¨°ÂÅöÂà∞ËøôÁßçÂÄçÂ¢ûÈ¢òÔºåÊúâÁÇπÊúâË∂£</p><p>È¶ñÂÖàÂå∫Èó¥ÂÜÖÁöÑÊØè‰∏™ÁÇπÂØπÂ∫îÁõ∏Á≠âÁî®Âπ∂Êü•ÈõÜÁª¥Êä§‰∏Ä‰∏ãÂ∞±Â•Ω‰∫ÜÔºåÊòæÁÑ∂ÊúÄÂêéÁöÑÁ≠îÊ°àÂ∞±ÊòØÔºàÂπ∂Êü•ÈõÜ‰∏™Êï∞‰∏∫ $t$Ôºâ $9 \cdot 10^{t - 1}$</p><p>ÂΩìÁÑ∂ËøôÊ†∑‰ºöÈÄ†Êàê $O (n^2)$ ÁöÑÂ§çÊùÇÂ∫¶ÔºåÈÇ£‰πàÈÄöËøáÂÄçÂ¢ûÊù•‰ºòÂåñÔºåÂç≥Â∞ÜÂå∫Èó¥‰∫åËøõÂà∂ÊãÜÂàÜÔºåÁÑ∂ÂêéÊØèÊ¨°Â∞Ü $[l_1, l_1 + 2^k - 1]$ ‰∏é $[l_2, l_2 +2^k - 1]$ ÂêàÂπ∂ÔºåÂÖ∂‰∏≠ $k$ ‰∏∫‰∫åËøõÂà∂ÊãÜÂàÜÁªìÊûúÊâÄÂæóÂπÇÊ¨°ÁöÑÈÉ®ÂàÜÔºåÈÇ£‰πàËøôÊ†∑‰øÆÊîπÂ∞±ÂèòÊàê $O (n \log n)$ ‰∫Ü</p><p>ÂØπ‰∫éÊü•ËØ¢ÔºåÊòæÁÑ∂ÊòØ‰∏çËÉΩÁõ¥Êé•Êü•ËØ¢‰∫ÜÔºåÈÇ£‰πàÂ∞±ÈÄöËøáÁî±Â§ßÂå∫Èó¥Âà∞Â∞èÂå∫Èó¥ÁöÑ‰º†ÈÄíÔºàÂç≥Â∞ÜÂ§ßÂå∫Èó¥ÊãÜÂàÜ‰∏∫Â∑¶Âè≥‰∏§ÊÆµÔºåÁÑ∂ÂêéÂàÜÂà´‰∏é‰πãÁ•ñÂÖàÊãÜÂàÜÂæóÂ∑¶Âè≥‰∏§ÊÆµÂêàÂπ∂ÔºâÊù•Â∞Ü‰ø°ÊÅØËΩ¨ÁßªÂà∞ÊúÄÂ∞èÁöÑÔºàÂç≥‰ª•ÁÇπ‰∏∫Âçï‰ΩçÁöÑÔºâÂå∫Èó¥ÊÆµ‰∏ä</p><p>ÈÇ£‰πàÊúÄÂêéÂç≥ $O (n)$ Êü•ËØ¢Âπ∂Êü•ÈõÜ‰∏™Êï∞Âç≥ÂèØ</p><p>ÊïÖËØ•ÂÄçÂ¢ûÊï¥‰ΩìÊÄùÊÉ≥Âç≥‰∏∫ÔºöÂ∞Ü‰ª•ÁÇπ‰∏∫Âçï‰ΩçÂ§ÑÁêÜÊîπ‰∏∫‰ª•ÂπÇÊ¨°Âå∫Èó¥ÊÆµ‰∏∫Âçï‰ΩçÂ§ÑÁêÜ $\rightarrow$ Â∞ÜÂπÇÊ¨°Âå∫Èó¥ÊÆµÁöÑ‰ø°ÊÅØËΩ¨ÁßªÂà∞Â∞èÂå∫Èó¥Áõ¥Ëá≥Âçï‰ΩçÂå∫Èó¥ $\rightarrow$ Á≠îÊ°àÂ§ÑÁêÜ</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN][<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> father[x][j] == x ? x : father[x][j] = find (father[x][j], j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fx = find (x, j), fy = find (y, j);</span><br><span class="line">father[fx][j] = fy;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> fx = find (i, j);</span><br><span class="line">merge (i, fx, j - <span class="number">1</span>);</span><br><span class="line">merge (i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)), fx + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)), j - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">18</span>; j ++)</span><br><span class="line">father[i][j] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l1 = getnum (), r1 = getnum ();</span><br><span class="line"><span class="keyword">int</span> l2 = getnum (), r2 = getnum ();</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span>; j &gt;= <span class="number">0</span>; j --)</span><br><span class="line"><span class="keyword">if</span> (l1 + p + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= r1) &#123;</span><br><span class="line">merge (l1 + p, l2 + p, j);</span><br><span class="line">p += (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">pushdown ();</span><br><span class="line"><span class="keyword">int</span> group = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (find (i, <span class="number">0</span>) == i)</span><br><span class="line">group ++;</span><br><span class="line">LL ans = <span class="number">9l</span>l * power (<span class="number">10l</span>l, group - <span class="number">1</span>) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 2</span></span><br><span class="line"><span class="comment">1 2 3 4</span></span><br><span class="line"><span class="comment">3 3 3 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">100000 1</span></span><br><span class="line"><span class="comment">1 99999 2 100000</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊÄùÁª¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÂÄçÂ¢û </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåPOI2009„ÄçLYZ-Ice Skates</title>
      <link href="/2020/08/04/%5BPOI2009%5DLYZ-Ice%20Skates/"/>
      <url>/2020/08/04/%5BPOI2009%5DLYZ-Ice%20Skates/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="ÂâçÁΩÆ„ÄåHallÂÆöÁêÜ„Äç"><a href="#ÂâçÁΩÆ„ÄåHallÂÆöÁêÜ„Äç" class="headerlink" title="ÂâçÁΩÆ„ÄåHallÂÆöÁêÜ„Äç"></a>ÂâçÁΩÆ„ÄåHallÂÆöÁêÜ„Äç</h3><blockquote><p> ‰∫åÂàÜÂõæG‰∏≠ÁöÑ‰∏§ÈÉ®ÂàÜÈ°∂ÁÇπÁªÑÊàêÁöÑÈõÜÂêàÂàÜÂà´‰∏∫X, Y(ÂÅáËÆæÊúâ|X|‚â§|Y||X|‚â§|Y|)„ÄÇG‰∏≠Êúâ‰∏ÄÁªÑÊó†ÂÖ¨ÂÖ±ÁÇπÁöÑËæπÔºå‰∏ÄÁ´ØÊÅ∞Â•Ω‰∏∫ÁªÑÊàêXÁöÑÁÇπ(‰πüÂ∞±ÊòØÂ≠òÂú®ÂÆåÁæéÂåπÈÖç)ÁöÑÂÖÖÂàÜÂøÖË¶ÅÊù°‰ª∂ÊòØÔºöX‰∏≠ÁöÑ‰ªªÊÑèk‰∏™ÁÇπËá≥Â∞ë‰∏éY‰∏≠ÁöÑk‰∏™ÁÇπÁõ∏ÈÇªÔºåÂç≥ÂØπ‰∫éX‰∏≠ÁöÑ‰∏Ä‰∏™ÁÇπÈõÜW Ôºå‰ª§N(W)‰∏∫WÁöÑÊâÄÊúâÈÇªÂ±ÖÔºå ÈúçÂ∞îÂÆöÁêÜÂç≥ÂØπ‰∫é‰ªªÊÑèWÔºå|W|‚â§|N(W)</p></blockquote><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>Áî±‰∫éÊúÄÂùèÊÉÖÂÜµ‰ªªÈÄâ $k$ ‰∏™ÊòØÈÄâ‰∏ÄÁ´ØËøûÁª≠ÁöÑÂå∫Èó¥ $[l, r]$ÔºåÊ†πÊçÆHallÂÆöÁêÜÁöÑ $|W| \le N(W)$ ÂèØ‰ª•ÂæóÂà∞<br>$$<br>\begin{aligned}<br>sum[l, r] &amp;\le (r - l + 1 + d) \cdot k \\<br>sum[l, r] - (r - l +1) \cdot k &amp;\le d \cdot k<br>\end{aligned}<br>$$<br>ÈÇ£‰πàÂ∞±ÂèØ‰ª•Âú®Á∫øÊÆµÊ†ë‰∏≠Â∞ÜÊØè‰∏™ÁÇπÁöÑÊùÉÂÄºËÆæ‰∏∫ $value - k$ÔºåÁÑ∂ÂêéÁª¥Êä§ÊúÄÂ§ßÂ≠êÊÆµÂíå $sumax$</p><p>ÈÇ£‰πàÊúÄÂêé $sumax \le d \cdot k  ?  TAK  :  NIE$ Âç≥ÂèØ</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> limit, N, k, d;</span><br><span class="line"></span><br><span class="line">LL subsum[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL lmax[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;, rmax[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumax[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123;</span><br><span class="line">subsum[root] = subsum[lson] + subsum[rson];</span><br><span class="line">lmax[root] = max (lmax[lson], subsum[lson] + lmax[rson]);</span><br><span class="line">rmax[root] = max (rmax[rson], rmax[lson] + subsum[rson]);</span><br><span class="line">sumax[root] = max (sumax[lson], max (sumax[rson], rmax[lson] + lmax[rson]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">subsum[root] = lmax[root] = rmax[root] = sumax[root] = - k;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid), build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">maintain (root);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">subsum[root] += delta;</span><br><span class="line">lmax[root] += delta, rmax[root] += delta;</span><br><span class="line">sumax[root] += delta;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">posi &lt;= mid ? modify (lson, left, mid, posi, delta) : modify (rson, mid + <span class="number">1</span>, right, posi, delta);</span><br><span class="line">maintain (root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">limit = getnum (), N = getnum (), k = getnum (), d = getnum ();</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, limit);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> posi = getnum (), delta = getnum ();</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, limit, posi, delta);</span><br><span class="line">LL deal = sumax[<span class="number">1</span>];</span><br><span class="line">deal &lt;= <span class="number">1l</span>l * k * d ? <span class="built_in">puts</span> (<span class="string">"TAK"</span>) : <span class="built_in">puts</span> (<span class="string">"NIE"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 4 2 1</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">3 3</span></span><br><span class="line"><span class="comment">2 -1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
          <category> Êï∞ÊçÆÁªìÊûÑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÆµÊ†ë </tag>
            
            <tag> ‰∫åÂàÜÂõæ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåPOI2006„ÄçMET-Subway</title>
      <link href="/2020/08/04/%5BPOI2006%5DMET-Subway/"/>
      <url>/2020/08/04/%5BPOI2006%5DMET-Subway/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h2><p>Âú®‰∏ÄÊ£µÊ†ë‰∏äÈÄâÂá∫ $k$ Êù°ÂèØÁõ∏‰∫§ÁöÑÈìæ‰ΩøÂæóË¢´Ë¶ÜÁõñÁöÑÁÇπÊï∞ÊúÄÂ§öÔºåÊ±ÇËØ•ÊúÄÂ§ßÂÄº</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>ËØ¥ÂÆûËØùËøô‰∏™Ëß£Ê≥ïÊòØÁúüÁöÑÂéâÂÆ≥</p><p>ÊòæÁÑ∂È¢òÁõÆÂèØ‰ª•Áúã‰ΩúÈÄâÂá∫ $k \times 2$ ‰∏™Âè∂Â≠êËäÇÁÇπÔºåÁÑ∂ÂêéÂ∞ÜÂÆÉ‰ª¨‰∫íÁõ∏ËøûÊé•ÊúÄÁªàË¶ÜÁõñÁöÑÁÇπÁöÑÊúÄÂ§ßÂÄº</p><p>ÂÜçËÄÉËôëÂà†ÂéªÈÄâ‰∏≠ÁöÑ $k \times 2$ ‰∏™Âè∂Â≠êËäÇÁÇπÂêéÔºåÂêëÂÜÖ‰∏ÄÂ±ÇÁöÑÁÇπÊúÄÂ§öÂè™‰ºöÊúâ $k \times 2$ ‰∏™ÁÇπÊúâË¥°ÁåÆ</p><p>ÂêåÁêÜÁªßÁª≠ÂÜÖÊé®</p><p>‰∫éÊòØ‰∏äËø∞ËøáÁ®ãÂç≥Áî±Âè∂Â≠êËäÇÁÇπÂºÄÂßãÊãìÊâëÔºåÂØπ‰∫éÊãìÊâëÁöÑÊØè‰∏ÄÂ±ÇÔºå‰ª§ÁÇπ $i$ ÊãìÊâëÊ∑±Â∫¶‰∏∫ $depth_i$Ôºå$total_i$ Ë°®Á§∫ÊãìÊâëÊ∑±Â∫¶‰∏∫ $i$ ÁöÑÁÇπÁöÑ‰∏™Êï∞ÔºåÂç≥ÔºåÂ∞ÜÊØè‰∏Ä‰∏™ÊãìÊâëÂ±ÇÈáçÊñ∞Áúã‰ΩúÂè∂Â≠êËäÇÁÇπÔºåÂÜçÂú®ÂΩìÂâçÊãìÊâëÂ±Ç‰∏≠ÈÄâÂá∫Ëá≥Â§ö $k \times 2$ ‰∏™‚ÄúÂè∂Â≠êËäÇÁÇπ‚ÄùÔºåÊïÖ<br>$$<br>\min (k \times 2, total_i)<br>$$<br>Âç≥‰∏∫ÊãìÊâëÊ∑±Â∫¶‰∏∫ $i$ ÁöÑÂ±ÇÁöÑÁ≠îÊ°àË¥°ÁåÆ</p><p>Â∞ÜÂÆÉ‰ª¨Á¥ØÂä†Ëµ∑Êù•Âç≥ÂèØ</p><p>Â§çÊùÇÂ∫¶ $O (n)$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e06</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="keyword">int</span> degree[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> total[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">toposort</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (degree[i] == <span class="number">1</span>) &#123;</span><br><span class="line">que.push(i);</span><br><span class="line">total[depth[i] = <span class="number">1</span>] ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> ((-- degree[v]) == <span class="number">1</span>) &#123;</span><br><span class="line">total[depth[v] = depth[u] + <span class="number">1</span>] ++;</span><br><span class="line">que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">Insert (u, v), Insert (v, u);</span><br><span class="line">degree[u] ++, degree[v] ++;</span><br><span class="line">&#125;</span><br><span class="line">toposort ();</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">ans += min (K &lt;&lt; <span class="number">1</span>, total[i]);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">17 3</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">5 2</span></span><br><span class="line"><span class="comment">5 6</span></span><br><span class="line"><span class="comment">5 8</span></span><br><span class="line"><span class="comment">7 8</span></span><br><span class="line"><span class="comment">9 8</span></span><br><span class="line"><span class="comment">5 10</span></span><br><span class="line"><span class="comment">10 13</span></span><br><span class="line"><span class="comment">13 14</span></span><br><span class="line"><span class="comment">10 12</span></span><br><span class="line"><span class="comment">12 11</span></span><br><span class="line"><span class="comment">15 17</span></span><br><span class="line"><span class="comment">15 16</span></span><br><span class="line"><span class="comment">15 10</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊÄùÁª¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåNOI2018„Äç‰Ω†ÁöÑÂêçÂ≠ó</title>
      <link href="/2020/08/04/%5BNOI2018%5D%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97/"/>
      <url>/2020/08/04/%5BNOI2018%5D%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="‰∏ªË¶ÅÈ¢òÊÑè"><a href="#‰∏ªË¶ÅÈ¢òÊÑè" class="headerlink" title="‰∏ªË¶ÅÈ¢òÊÑè"></a>‰∏ªË¶ÅÈ¢òÊÑè</h3><p>Ê±ÇÂ≠óÁ¨¶‰∏≤$S$‰∏é$T$‰∏çÂêåÁöÑÂ≠ê‰∏≤ÊÄªÊï∞</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>ÂÖàËÄÉËôë$l = 1, r = |T|$ÁöÑÊÉÖÂÜµÔºö</p><p>Âõ†‰∏∫‰ªªÊÑèÂ≠ê‰∏≤‰∏∫Â≠óÁ¨¶‰∏≤ÂâçÁºÄÁöÑÊüê‰∫õÂêéÁºÄÔºåÈÇ£‰πà‰ª§$Lim[i]$Ë°®Á§∫$T[1‚Ä¶i]$Âú®$S$‰∏äÊâÄËÉΩÂåπÈÖçÁöÑÊúÄÂ§ßÈïøÂ∫¶Ôºå$Posi[i]$Ë°®Á§∫$T$ÁöÑÂêéÁºÄËá™Âä®Êú∫‰∏äÁöÑÁÇπ$i$ÁöÑ$endpos$ÈõÜÂêà‰∏≠ÊúÄÈù†ÂâçÁöÑ‰ΩçÁΩÆÔºåÈÇ£‰πàÁ≠îÊ°àÂç≥‰∏∫</p><p>$$Ans = \sum\limits_{i = 1}^{nodes} \max (0, Len[i] - min (Len[Father[i]], Lim[Posi[i]]))$$</p><p>Êé•‰∏ãÊù•ËÄÉËôë$l, r$‰ªªÊÑèÁöÑÊÉÖÂÜµÔºö</p><p>ÂéüÊù•ËÉΩÂê¶Âú®$S$ÁöÑÂêéÁºÄËá™Âä®Êú∫‰∏äÂæÄ‰∏ãËµ∞ÁöÑÂà§Êñ≠‰æùÊçÆÂè™ÊúâÂΩìÂâçËäÇÁÇπÊòØÂê¶Â≠òÂú®$c$ËæπÔºåÈÇ£‰πàÊúâ‰∫Ü$l, r$ÁöÑÈôêÂà∂ÔºåÂ∞±Â§öÈúÄË¶ÅÂà§Êñ≠Âêë‰∏ãÁöÑËøô‰∏™ËäÇÁÇπÁöÑ$endpos$ÊòØÂê¶ÊúâÂ≠òÂú®‰∫é$[l + len, r]$Ôºà$len$Ë°®Á§∫Â∑≤ÂåπÈÖçÈïøÂ∫¶ÔºâÂå∫Èó¥ÁöÑ‰ΩçÁΩÆÔºå$endpos$ÈõÜÂêàÁî®Âä®ÊÄÅÂºÄÁÇπÁ∫øÊÆµÊ†ëÁª¥Êä§‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e06</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">20</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line"><span class="keyword">char</span> Orig[MAXN], Str[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Root[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Left[MAXN * MAXL]= &#123;<span class="number">0</span>&#125;, Right[MAXN * MAXL]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> tnodes = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Modify</span> <span class="params">(<span class="keyword">int</span>&amp; root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (! root)</span><br><span class="line">        root = ++ tnodes;</span><br><span class="line">    <span class="keyword">if</span> (left == right)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    pos &lt;= mid ? Modify (Left[root], left, mid, pos) : Modify (Right[root], mid + <span class="number">1</span>, right, pos);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Tree_Merge</span> <span class="params">(<span class="keyword">int</span> sl, <span class="keyword">int</span> sr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (! sl || ! sr)</span><br><span class="line">        <span class="keyword">return</span> sl + sr;</span><br><span class="line">    <span class="keyword">int</span> p = ++ tnodes;</span><br><span class="line">    Left[p] = Tree_Merge (Left[sl], Left[sr]);</span><br><span class="line">    Right[p] = Tree_Merge (Right[sl], Right[sr]);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (! root || left &gt; right)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= mid)</span><br><span class="line">        <span class="keyword">if</span> (Query (Left[root], left, mid, L, R))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (R &gt; mid)</span><br><span class="line">        <span class="keyword">if</span> (Query (Right[root], mid + <span class="number">1</span>, right, L, R))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> Tree[MAXN][<span class="number">30</span>];</span><br><span class="line">    <span class="keyword">int</span> Father[MAXN];</span><br><span class="line">    <span class="keyword">int</span> Len[MAXN], Posi[MAXN];</span><br><span class="line">    <span class="keyword">int</span> last, nodes;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++) &#123;</span><br><span class="line">            <span class="built_in">memset</span> (Tree[i], <span class="number">0</span>, <span class="keyword">sizeof</span> (Tree[i]));</span><br><span class="line">            Father[i] = <span class="number">0</span>, Posi[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last = nodes = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Append</span> <span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> pos, <span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> fa = last, p = ++ nodes;</span><br><span class="line">        last = p;</span><br><span class="line">        Len[p] = Len[fa] + <span class="number">1</span>, Posi[p] = pos;</span><br><span class="line">        <span class="keyword">while</span> (fa &amp;&amp; ! Tree[fa][c])</span><br><span class="line">            Tree[fa][c] = p, fa = Father[fa];</span><br><span class="line">        <span class="keyword">if</span> (! fa)</span><br><span class="line">            Father[p] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> x = Tree[fa][c];</span><br><span class="line">            <span class="keyword">if</span> (Len[x] == Len[fa] + <span class="number">1</span>)</span><br><span class="line">                Father[p] = x;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> np = ++ nodes;</span><br><span class="line">                Len[np] = Len[fa] + <span class="number">1</span>, Father[np] = Father[x], Posi[np] = Posi[x];</span><br><span class="line">                Father[p] = Father[x] = np;</span><br><span class="line">                <span class="built_in">memcpy</span> (Tree[np], Tree[x], <span class="keyword">sizeof</span> (Tree[x]));</span><br><span class="line">                <span class="keyword">while</span> (fa &amp;&amp; Tree[fa][c] == x)</span><br><span class="line">                    Tree[fa][c] = np, fa = Father[fa];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>)</span><br><span class="line">            Modify (Root[p], <span class="number">1</span>, N, pos);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> Topo[MAXN];</span><br><span class="line">    <span class="keyword">int</span> Minp[MAXN];</span><br><span class="line">    <span class="keyword">int</span> buck[MAXN];</span><br><span class="line">    <span class="comment">/*void Merge_Minp () &#123;</span></span><br><span class="line"><span class="comment">        for (int i = 1; i &lt;= nodes; i ++)</span></span><br><span class="line"><span class="comment">            buck[i] = 0, Minp[i] = Posi[i];</span></span><br><span class="line"><span class="comment">        for (int i = 1; i &lt;= nodes; i ++)</span></span><br><span class="line"><span class="comment">            buck[Len[i]] ++;</span></span><br><span class="line"><span class="comment">        for (int i = 1; i &lt;= N; i ++)</span></span><br><span class="line"><span class="comment">            buck[i] += buck[i - 1];</span></span><br><span class="line"><span class="comment">        for (int i = nodes; i &gt;= 1; i --)</span></span><br><span class="line"><span class="comment">            Topo[buck[Len[i]] --] = i;</span></span><br><span class="line"><span class="comment">        for (int i = nodes; i &gt;= 1; i --)</span></span><br><span class="line"><span class="comment">            Minp[Father[Topo[i]]] = min (Minp[Father[Topo[i]]], Minp[Topo[i]]);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Merge_Tree</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">            buck[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">            buck[Len[i]] ++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">            buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = nodes; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">            Topo[buck[Len[i]] --] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = nodes; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">            Root[Father[Topo[i]]] = Tree_Merge (Root[Father[Topo[i]]], Root[Topo[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">SAM S, T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Lim[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">/*void Match (int l, int r) &#123;</span></span><br><span class="line"><span class="comment">    int p = 1, len = 0;</span></span><br><span class="line"><span class="comment">    for (int i = 1; i &lt;= M; i ++) &#123;</span></span><br><span class="line"><span class="comment">        int c = Str[i] - 'a';</span></span><br><span class="line"><span class="comment">        while (p &amp;&amp; ! S.Tree[p][c])</span></span><br><span class="line"><span class="comment">            p = S.Father[p], len = S.Len[p];</span></span><br><span class="line"><span class="comment">        while (p &amp;&amp; ! Query (Root[S.Tree[p][c]], 1, N, l + len, r))</span></span><br><span class="line"><span class="comment">            p = S.Father[p], len = S.Len[p];</span></span><br><span class="line"><span class="comment">        S.Tree[p][c] ? (p = S.Tree[p][c], len ++) : (p = 1, len = 0);</span></span><br><span class="line"><span class="comment">        Lim[i] = len;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Work</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">1</span>, len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> c = Str[j] - <span class="string">'a'</span>;</span><br><span class="line">        T.Append (c, j, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (S.Tree[p][c] &amp;&amp; Query (Root[S.Tree[p][c]], <span class="number">1</span>, N, l + len, r)) &#123;</span><br><span class="line">                p = S.Tree[p][c], len ++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (! len)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            len --;</span><br><span class="line">            <span class="keyword">if</span> (len == S.Len[S.Father[p]])</span><br><span class="line">                p = S.Father[p];</span><br><span class="line">        &#125;</span><br><span class="line">        Lim[j] = len;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// T.Merge_Minp ();</span></span><br><span class="line">    <span class="comment">// Match (l, r);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">Solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T.nodes; i ++)</span><br><span class="line">        ans += max (<span class="number">0</span>, T.Len[i] - max (T.Len[T.Father[i]], Lim[T.Posi[i]]));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span> (<span class="string">"%s"</span>, Orig + <span class="number">1</span>);</span><br><span class="line">    N = <span class="built_in">strlen</span> (Orig + <span class="number">1</span>);</span><br><span class="line">    S.init ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        S.Append (Orig[i] - <span class="string">'a'</span>, i, <span class="number">1</span>);</span><br><span class="line">    S.Merge_Tree ();</span><br><span class="line">    <span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; Q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span> (<span class="string">"%s"</span>, Str + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">        T.init ();</span><br><span class="line">        M = <span class="built_in">strlen</span> (Str + <span class="number">1</span>);</span><br><span class="line">        Work (l, r);</span><br><span class="line">        LL ans = Solve ();</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">scbamgepe</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">smape 1 9</span></span><br><span class="line"><span class="comment">sbape 1 9</span></span><br><span class="line"><span class="comment">sgepe 1 9</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">scbamgepe</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">smape 2 7</span></span><br><span class="line"><span class="comment">sbape 3 8</span></span><br><span class="line"><span class="comment">sgepe 1 9</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Â≠óÁ¨¶‰∏≤ </category>
          
          <category> Êï∞ÊçÆÁªìÊûÑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÆµÊ†ë </tag>
            
            <tag> ÂêéÁºÄËá™Âä®Êú∫ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåNOI2016„ÄçÂæ™ÁéØ‰πãÁæé</title>
      <link href="/2020/08/04/%5BNOI2016%5D%E5%BE%AA%E7%8E%AF%E4%B9%8B%E7%BE%8E/"/>
      <url>/2020/08/04/%5BNOI2016%5D%E5%BE%AA%E7%8E%AF%E4%B9%8B%E7%BE%8E/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h2><p>Ê±ÇËß£ $1 \le x \le n, ~ 1 \le y \le m$ ‰∏≠Êª°Ë∂≥Âú® $k$ ËøõÂà∂‰∏ã $\frac{x}{y}$ ÊòØÊúâÈôêÂæ™ÁéØÂ∞èÊï∞ÁöÑ‰∏™Êï∞</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>ÂæàÂ•ΩÁÑ∂ÂêéÊàë‰∏ÄÂºÄÂßãÂú®ËÆ°ÁÆóÂô®‰∏äÊï≤‰∫ÜÂçä‰∏™Â∞èÊó∂ÁÑ∂ÂêéÁî±‰∫éÁúºÁûéÂπ∂‰∏îÂΩíÁ∫≥ËÉΩÂäõÂ∑ÆÂπ∂Ê≤°ÊúâÂèëÁé∞ËßÑÂæã</p><p>ËÆæ $\frac{x}{y}$ ÁöÑÂæ™ÁéØËäÇÈïøÂ∫¶‰∏∫ $l$ÔºåÂàôÊúâ<br>$$<br>\begin{aligned}<br>\frac{xk^l}{y} - \left\lfloor\frac{xk^l}{y}\right\rfloor &amp;= \frac{x}{y} - \left\lfloor\frac{x}{y}\right\rfloor \\<br>xk^l - \left\lfloor\frac{xk^l}{y}\right\rfloor y &amp;= x - \left\lfloor\frac{x}{y}\right\rfloor y \\<br>xk^l &amp;\equiv x \pmod y \\<br>k &amp;\equiv 1 \pmod y<br>\end{aligned}<br>$$<br>‰πüÂ∞±ÊòØËØ¥Âè™Ë¶ÅÊª°Ë∂≥ $y \bot k$ Âç≥ÂèØÊª°Ë∂≥È¢òÊÑèÔºåÊïÖÂèØÂ∞ÜÈóÆÈ¢òÂåñ‰∏∫<br>$$<br>\begin{aligned}<br>Ans &amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^m [(i, j) = 1][(j, k) = 1] \\<br>&amp;= \sum\limits_{j = 1}^m [(j, k) = 1]\sum\limits_{d | j} \mu(d)\left\lfloor\frac{n}{d}\right\rfloor \\<br>&amp;= \sum\limits_{d = 1}^n \mu(d)\left\lfloor\frac{n}{d}\right\rfloor\sum\limits_{d | j}[(j, k) = 1] \\<br>&amp;Â∞ÜjÈô§‰ª•d, Ê≠§Êó∂Ëã•ÂêéÂçäÈÉ®ÂàÜÁöÑ\sumË¶ÅÊúâË¥°ÁåÆÂàôÈúÄÊª°Ë∂≥d \bot k \\<br>&amp;= \sum\limits_{d = 1}^n [(d, k) = 1]\mu(d)\left\lfloor\frac{n}{d}\right\rfloor\big(\sum\limits_{j = 1}^{\left\lfloor\frac{m}{d}\right\rfloor}[(j, k) = 1]\big)<br>\end{aligned}<br>$$<br>‰∫éÊòØÊé•‰∏ãÊù•Âèò‰∏∫Â§ÑÁêÜ<br>$$<br>f_1(n, k) = \sum\limits_{d = 1}^n [(d, k) = 1]\mu(d) \\<br>f_2(n) = \sum\limits_{d = 1}^n [(d, k) = 1]<br>$$<br>ÂÖàËØ¥ $f_2(n)$ÔºåËæÉÂ•ΩÂ§ÑÁêÜÔºåÂç≥ËÄÉËôëÈïøÂ∫¶‰∏∫ $k$ ÁöÑÂå∫Èó¥Â∞Ü $n$ ÂàÜÊÆµÔºåÂÖ∂‰∏≠Èô§‰∫ÜÊúÄÂêéÂ§öÂá∫Êù•ÁöÑÈÇ£‰∏ÄÊÆµÂÖ∂‰ΩôÁöÑÊÆµÂæóÂà∞ÁöÑË¥°ÁåÆÊòØÁõ∏ÂêåÁöÑÔºåÂç≥ $\varphi(k)$ÔºåÊïÖ<br>$$<br>f_2(n) = \left\lfloor\frac{n}{k}\right\rfloor\varphi(k) + f_2(n \% k)<br>$$<br>ÈÇ£‰πàÂØπ‰∫é $f_1(n, k)$ÔºåÂÆπÊòìÂèòÊç¢Âæó<br>$$<br>f_1(n, k) = \sum\limits_{d | k}^n \mu(d)\sum\limits_{l = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(ld)<br>$$<br>ÁÑ∂ÂêéÊàëÂ∞±‰∏ç‰ºö‰∫ÜÔºåÁúã‰∫Ü‰∏ãÈ¢òËß£ÔºåÂèØ‰ª•ÂèëÁé∞Ëã• $\mu(ld)$ ÊúâË¥°ÁåÆÔºå<strong>ÂàôÈúÄÊª°Ë∂≥ $l \bot d$ÔºåÊ≠§Êó∂Êúâ $\mu(ld) = \mu(l)\mu(d)$</strong>ÔºåÊïÖ<br>$$<br>\begin{aligned}<br>f_1(n, k) &amp;= \sum\limits_{d | k} \mu(d)\sum\limits_{l = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(l)\mu(d)[(d, l) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu^2(d)\sum\limits_{l = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(l)[(d, l) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu^2(d)f_1(\left\lfloor\frac{n}{d}\right\rfloor, d)<br>\end{aligned}<br>$$<br>ÂæàÂ•ΩÊàëËøòÊòØÁ¨¨‰∏ÄÊ¨°ÂÜôÂà∞Ëé´ÂèçÂ∏¶ÈÄíÂΩíÁöÑ</p><p>Ê≥®ÊÑèËæπÁïåÊù°‰ª∂ $n = 0$ ‰∏é $k = 1$ÔºåÂØπ‰∫é $n = 0$ ËøîÂõû $0$ Âç≥ÂèØÔºåÂØπ‰∫é $k = 1$Ôºå$f_1(n, 1)$ Âç≥‰∏∫ $\sum\limits_{d = 1}^n \mu(d)$ÔºåÊùúÊïôÁ≠õ‰∏Ä‰∏ãÂç≥ÂèØ</p><p>ÊúÄÂêéÂÜçÊï¥Èô§ÂàÜÂùó‰∏ÄÊ¨°Ê±ÇÊÄªÁ≠îÊ°àÂ∞±Â•Ω‰∫Ü</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e06</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1e06</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, K;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXM / <span class="number">10</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mu[MAXM]= &#123;<span class="number">0</span>&#125;, sumu[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linear_sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">sumu[<span class="number">1</span>] = mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! visit[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">mu[i] = - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">visit[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j])) <span class="keyword">break</span>;</span><br><span class="line">mu[i * prime[j]] = - mu[i];</span><br><span class="line">&#125;</span><br><span class="line">sumu[i] = sumu[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tr1::<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mapmu;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mu_sieve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sumu[n];</span><br><span class="line"><span class="keyword">if</span> (mapmu[n]) <span class="keyword">return</span> mapmu[n];</span><br><span class="line"><span class="keyword">int</span> total = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">total -= (r - l + <span class="number">1</span>) * mu_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> mapmu[n] = total;</span><br><span class="line">&#125;</span><br><span class="line">LL f[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumr[MAXM]= &#123;<span class="number">0</span>&#125;; <span class="comment">// sigma ([(j, k) = 1])</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GCD</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> ! b ? a : GCD (b, a % b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">r_sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">f[i] = f[i - <span class="number">1</span>] + (GCD (i, K) == <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rval</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (n / K) * f[K] + f[n % K];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;, <span class="keyword">int</span>&gt; mapl;</span><br><span class="line"><span class="function">LL <span class="title">l_solve</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123; <span class="comment">// S(n, K)</span></span><br><span class="line"><span class="keyword">if</span> (! n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ret = make_pair (n, k);</span><br><span class="line"><span class="keyword">if</span> (mapl[ret]) <span class="keyword">return</span> mapl[ret];</span><br><span class="line"><span class="keyword">if</span> (k == <span class="number">1</span>) <span class="keyword">return</span> mu_sieve (n);</span><br><span class="line">LL total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i * i &lt;= k; i ++)</span><br><span class="line"><span class="keyword">if</span> (! (k % i)) &#123;</span><br><span class="line"><span class="keyword">if</span> (mu[i]) total += l_solve (n / i, i);</span><br><span class="line"><span class="keyword">if</span> (i * i != k &amp;&amp; mu[k / i])</span><br><span class="line">total += l_solve (n / (k / i), k / i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> mapl[ret] = total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">linear_sieve ();</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d%d"</span>, &amp; N, &amp; M, &amp; K);</span><br><span class="line">r_sieve ();</span><br><span class="line">LL ans = <span class="number">0</span>, pre = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r; l &lt;= min (N, M); l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = min (N / (N / l), M / (M / l));</span><br><span class="line">LL pl = l_solve (r, K);</span><br><span class="line">ans += <span class="number">1l</span>l * (pl - pre) * (N / l) * rval (M / l);</span><br><span class="line">pre = pl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 6 10</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">99 7689 100</span></span><br><span class="line"><span class="comment">ans: 257777</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="ÊñπÊ≥ï‰∫å"><a href="#ÊñπÊ≥ï‰∫å" class="headerlink" title="ÊñπÊ≥ï‰∫å"></a>ÊñπÊ≥ï‰∫å</h3><p>ÊàëÊ≤°ÊúâÂÜôËøôÁßçÊñπÊ≥ïÔºå‰ΩÜÊòØËøôÁßçÁúüÁöÑÂæàÁÆÄÂçïÁöÑËØ¥<br>$$<br>\begin{aligned}<br>f(n, m, k) &amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^m [(i, j) = 1][(j, k) = 1] \\<br>&amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^m [(i, j) = 1]\sum\limits_{d | j, d | k} \mu(d) \\<br>&amp;= \sum\limits_{d | k} \mu(d)\sum\limits_{i = 1}^n\sum\limits_{d | j}^m [(i, j) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu(d)\sum\limits_{i = 1}^n\sum\limits_{j = 1}^{\left\lfloor\frac{m}{d}\right\rfloor} [(i, jd) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu(d)\sum\limits_{i = 1}^n\sum\limits_{j = 1}^{\left\lfloor\frac{m}{d}\right\rfloor} [(i, j) = 1][(i, d) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu(d)f(\left\lfloor\frac{m}{d}\right\rfloor, n, d)<br>\end{aligned}<br>$$<br>ËæπÁïå $n = 0$ ÊàñËÄÖ $m = 0$ ËøîÂõû $0$Ôºå$k = 1$ ËøîÂõû $\sum\limits_{i = 1}^n\sum\limits_{j = 1}^m [(i, j) = 1] = \sum\limits_{i = 1}^{\min (n, m)} \mu(d) \left\lfloor\frac{n}{d}\right\rfloor \left\lfloor\frac{m}{d}\right\rfloor$ Âç≥ÂèØ</p><p>‰∏çËøáËØ¥ÂÆûËØùËøô‰∏™ËôΩÁÑ∂ÁÆÄÂçï‰ΩÜÊòØËá≥Â∞ëÂØπ‰∫éÊàë‰∏çÂ§ßÂÆπÊòìÊÉ≥Âà∞ÔºåÊØïÁ´üÊàë‰ºöÂÖàÊãÜ $[(i, j) = 1]$ ÈÉ®ÂàÜÔºåÂõ†‰∏∫ÊÄªÊÑüËßâ $[(j, k) = 1]$ ‰ºöÂ§öÂá∫‰∏Ä‰∏™ $d | k$ ÁöÑÈôêÂà∂Êù°‰ª∂</p><p>‰ΩÜÊòØËøô‰∏™Ëß£Ê≥ïÊòØÁúüÁöÑÂéâÂÆ≥</p>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ëé´ÊØî‰πåÊñØÂèçÊºî </tag>
            
            <tag> ÊùúÊïôÁ≠õ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåNOI2014„ÄçË¥≠Á•® „ÄåÊ†ë‰∏äÊñúÁéá‰ºòÂåñ„Äç</title>
      <link href="/2020/08/04/%5BNOI2014%5D%E8%B4%AD%E7%A5%A8%20%E3%80%8C%E6%A0%91%E4%B8%8A%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96%E3%80%8D/"/>
      <url>/2020/08/04/%5BNOI2014%5D%E8%B4%AD%E7%A5%A8%20%E3%80%8C%E6%A0%91%E4%B8%8A%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>È¶ñÂÖàÊòìÂæóÊñπÁ®ãÔºå‰∏îÁªèËøáÂèòÊç¢Êúâ</p><p>$$\begin{aligned} f_i &amp;= \min\limits_{dist_i - lim_i \le dist_j} \{f_j + (dist_i - dist_j)p_i + q_i\} \\ f_j &amp;= p_idist_j + f_i - dist_ip_i - q_i \end{aligned}‚Äã$$</p><p>Âú®‰∏ÄÊù°Áõ¥Á∫ø‰∏äÊó∂ÔºåÊñúÁéá‰ºòÂåñÂèØ‰ª•Áî®ÊôÆÈÄö$CDQ‚Äã$ÂàÜÊ≤ªÂÆûÁé∞Ôºà‰ºö‰∏ç‰ºöËøá‰∫éÈ∫ªÁÉ¶ÔºüÔºâÔºåÈÇ£‰πàÂØπ‰∫éÂú®Ê†ë‰∏äÊñúÁéá‰ºòÂåñÊó∂ÔºåËÄÉËôëÁÇπÂàÜÊ≤ª</p><p>ËøôÊó∂Â∞±Âú®ÁÇπÂàÜÊ≤ª‰∏≠ËøêÁî®$CDQ$ÂàÜÊ≤ªÁöÑÊÄùÊÉ≥ÔºåÂç≥‰ΩøÁî®Âú®ÂΩìÂâçÈáçÂøÉÁÆ°ËæñËåÉÂõ¥ÂÜÖÁöÑÈÄöÂêëÊ†πËäÇÁÇπÁöÑÈÇ£‰∏ÄÊù°Èìæ‰∏äÁöÑËäÇÁÇπÊù•Êõ¥Êñ∞ÂÖ∂ÂÆÉËäÇÁÇπÂ∞±Â•Ω‰∫Ü</p><p>Ê≥®ÊÑèÂú®ÂàÜÊ≤ª‰∏≠ÁöÑÊñúÁéá‰ºòÂåñÊó∂Âú®Âá∏ÂåÖ‰∏äÂä†ÁÇπÂíåÊõ¥Êñ∞Âè≥‰æßËäÇÁÇπÁ≠îÊ°àË¶ÅÂêåÊó∂ËøõË°åÔºå‰∏çÁÑ∂ÂΩìÂâçÊúÄ‰ºòËß£ÂèØËÉΩ‰ºöÂú®ÂêéÈù¢Áî±‰∫éÊñúÁéáË¢´Âà†ÂéªÔºåÂØºËá¥Á≠îÊ°àÈîôËØØÔºåËøòÊúâÁî±‰∫é‰∏ãÈù¢‰ª£Á†ÅÊòØÁî±Ê∑±Â∫¶Áî±Â∞èÂà∞Â§ßÂ§ÑÁêÜÁöÑÔºåÊâÄ‰ª•ÊòØÂèçÁùÄÁª¥Êä§‰∏ãÂá∏ÂåÖÔºåÂç≥‰∏äÂá∏ÂåÖ</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="keyword">const</span> LL INFLL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-08</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dcmp</span> <span class="params">(<span class="keyword">double</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span> (p) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> p &lt; <span class="number">0</span> ? - <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    Link[++ size].to = v;</span><br><span class="line">    Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">    Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Root = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CitySt</span> &#123;</span></span><br><span class="line">    LL p, q, lim;</span><br><span class="line"></span><br><span class="line">    CitySt () &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">CitySt City[MAXN];</span><br><span class="line"></span><br><span class="line">LL f[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">LL Fdist[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL Dist[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Dist[v] = Dist[root] + Fdist[v];</span><br><span class="line">        DFS (v, root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Vis[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Size[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> grvy, minval = INF;</span><br><span class="line"><span class="keyword">int</span> total;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Grvy_Acqu</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    Size[root] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father || Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Grvy_Acqu (v, root);</span><br><span class="line">        Size[root] += Size[v];</span><br><span class="line">        maxpart = max (maxpart, Size[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    maxpart = max (maxpart, total - Size[root]);</span><br><span class="line">    <span class="keyword">if</span> (maxpart &lt; minval)</span><br><span class="line">        grvy = root, minval = maxpart;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> temp[MAXN];</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> Que[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Dist[a] == Dist[b])</span><br><span class="line">        <span class="keyword">return</span> INFLL * <span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">double</span>) (f[b] - f[a]) * <span class="number">1.0</span> / (<span class="keyword">double</span>) (Dist[b] - Dist[a]) * <span class="number">1.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> listq[MAXN];</span><br><span class="line"><span class="keyword">int</span> lp = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; a, <span class="keyword">const</span> <span class="keyword">int</span>&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Dist[a] - City[a].lim &gt; Dist[b] - City[b].lim;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">listq_Acqu</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (father)</span><br><span class="line">        listq[++ lp] = root;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father || Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        listq_Acqu (v, root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Binary_Search</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left == right)</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    <span class="keyword">int</span> l = left, r = right;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (f[Que[mid + <span class="number">1</span>]] - f[Que[mid]] &lt;= p * (Dist[Que[mid + <span class="number">1</span>]] - Dist[Que[mid]]))</span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> tp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left &gt; right)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> p = Binary_Search (left, right, City[tp].p);</span><br><span class="line">    f[tp] = min (f[tp], f[Que[p]] + (Dist[tp] - Dist[Que[p]]) * City[tp].p + City[tp].q);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Solve</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123;</span><br><span class="line">    minval = INF, total = Size[root], Grvy_Acqu (root, <span class="number">0</span>);</span><br><span class="line">    Vis[grvy] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> fgrvy = grvy;</span><br><span class="line">    <span class="keyword">if</span> (grvy != root) &#123;</span><br><span class="line">        Size[root] -= Size[grvy];</span><br><span class="line">        Solve (root);</span><br><span class="line">    &#125;</span><br><span class="line">    p = <span class="number">0</span>;</span><br><span class="line">    temp[++ p] = fgrvy;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> nd = fgrvy; nd != root; nd = Father[nd]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Dist[fgrvy] - City[fgrvy].lim &lt;= Dist[Father[nd]])</span><br><span class="line">            f[fgrvy] = min (f[fgrvy], f[Father[nd]] + (Dist[fgrvy] - Dist[Father[nd]]) * City[fgrvy].p + City[fgrvy].q);</span><br><span class="line">        temp[++ p] = Father[nd];</span><br><span class="line">    &#125;</span><br><span class="line">    lp = <span class="number">0</span>;</span><br><span class="line">    listq_Acqu (fgrvy, <span class="number">0</span>);</span><br><span class="line">    sort (listq + <span class="number">1</span>, listq + lp + <span class="number">1</span>, comp);</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">1</span>, right = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= p &amp;&amp; j &lt;= lp; i ++) &#123; <span class="comment">// ÊñúÁéá‰ºòÂåñ</span></span><br><span class="line">        <span class="keyword">while</span> (j &lt;= lp &amp;&amp; Dist[temp[i]] &lt; Dist[listq[j]] - City[listq[j]].lim)</span><br><span class="line">            Update (left, right, listq[j ++]);</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; Dcmp (slope (Que[right - <span class="number">1</span>], Que[right]) - slope (Que[right], temp[i])) &lt;= <span class="number">0</span>) <span class="comment">// Ê≥®ÊÑèÊòØ‰∏äÂá∏ÂåÖ</span></span><br><span class="line">            right --;</span><br><span class="line">        Que[++ right] = temp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j &lt;= lp)</span><br><span class="line">        Update (left, right, listq[j ++]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[fgrvy]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Solve (v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getint</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">getLL</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    LL num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen ("Input.txt", "r", stdin);</span></span><br><span class="line">    <span class="comment">// freopen ("Output.txt", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span> (f, <span class="number">0x3f3f3f3f</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line">    f[Root] = <span class="number">0</span>;</span><br><span class="line">    N = getint (), getint ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> fa = getint ();</span><br><span class="line">        Father[i] = fa;</span><br><span class="line">        Fdist[i] = getLL ();</span><br><span class="line">        City[i].p = getLL (), City[i].q = getLL (), City[i].lim = getLL ();</span><br><span class="line">        Insert (fa, i), Insert (i, fa);</span><br><span class="line">    &#125;</span><br><span class="line">    DFS (Root, <span class="number">0</span>);</span><br><span class="line">    Size[Root] = N;</span><br><span class="line">    Solve (Root);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++)</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, f[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">7 3</span></span><br><span class="line"><span class="comment">1 2 20 0 3</span></span><br><span class="line"><span class="comment">1 5 10 100 5</span></span><br><span class="line"><span class="comment">2 4 10 10 10</span></span><br><span class="line"><span class="comment">2 9 1 100 10</span></span><br><span class="line"><span class="comment">3 5 20 100 10</span></span><br><span class="line"><span class="comment">4 4 20 0 10</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊñúÁéá‰ºòÂåñ </tag>
            
            <tag> Ê†ë‰∏äDP </tag>
            
            <tag> ÁÇπÂàÜÊ≤ª </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåNOI2007„ÄçË¥ßÂ∏ÅÂÖëÊç¢ „ÄåCDQÂàÜÊ≤ªÂÆûÁé∞ÊñúÁéá‰ºòÂåñ„Äç</title>
      <link href="/2020/08/04/%5BNOI2007%5D%E8%B4%A7%E5%B8%81%E5%85%91%E6%8D%A2%20%E3%80%8CCDQ%E5%88%86%E6%B2%BB%E5%AE%9E%E7%8E%B0%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96%E3%80%8D/"/>
      <url>/2020/08/04/%5BNOI2007%5D%E8%B4%A7%E5%B8%81%E5%85%91%E6%8D%A2%20%E3%80%8CCDQ%E5%88%86%E6%B2%BB%E5%AE%9E%E7%8E%B0%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>È¶ñÂÖàÊØèÊ¨°‰π∞Âçñ‰∏ÄÂÆöÊòØÂú®ÊüêÂ§© $k$ ‰ª•ÂΩìÊó∂ÁöÑÊúÄÂ§ßÊî∂ÂÖ•‰π∞ÂÖ•ÔºåÂÜçÂà∞Á¨¨ $i$ Â§©ÂçñÂá∫ÔºåÈÇ£‰πàÊòìÂæóÊñπÁ®ãÔºö</p><p>$$f_i = \max \{\frac{A_iRate_kf_k}{A_kRate_k + B_k} + \frac{B_if_k}{A_kRate_k + B_k}\}$$</p><p>ÂÜç‰ª§</p><p>$$\left\{\begin{aligned} x_k = \frac{Rate_kf_k}{A_kRate_k + B_k} \\ y_k = \frac{f_k}{A_kRate_k + B_k}\end{aligned}\right.$$</p><p>ÂàôÊúâ</p><p>$$\begin{aligned} f_i &amp;= \max \{A_ix_k + B_iy_k\} \\ y_k &amp;= - \frac{A_i}{B_i}x_k + \frac{f_i}{B_i} \end{aligned}$$</p><p>ÈÇ£‰πàÁé∞Âú®ÈúÄË¶ÅÊâæÂà∞‰∏Ä‰∏™ÁÇπ $(x_k, y_k)$ ‰ΩøÂæóÁõ¥Á∫øÁöÑÊà™Ë∑ùÊúÄÂ§ß</p><p>Áî±‰∫éÊñúÁéáÂíåÊ®™ÂùêÊ†áÁöÜ‰∏çÊª°Ë∂≥ÂçïË∞ÉÊÄßÔºåÂèØ‰ª•Áî®Âπ≥Ë°°Ê†ëÁ≠âÁª¥Êä§ÔºåËøôÈáå‰ΩøÁî®CDQÂàÜÊ≤ªÂÆûÁé∞</p><p>ÂÆûÁé∞ËøáÁ®ãÂ¶Ç‰∏ãÔºö</p><p>‚Ö† Â∞ÜÊï∞ÊçÆÊåâÁÖßÊñúÁéá$\frac{A_i}{B_i}$ÈôçÂ∫èÊéíÂ∫è</p><p>‚Ö° Â∞ÜÂå∫Èó¥ÊåâÁÖßÊìç‰ΩúÈ°∫Â∫èÂàÜ‰∏∫Â∑¶Âè≥‰∏§ÈÉ®ÂàÜÂ§ÑÁêÜ</p><p>‚Ö¢ ÂÖàÂ§ÑÁêÜÂ∑¶ÂçäÈÉ®ÂàÜÔºåÁª¥Êä§Â∑¶ÂçäËæπÂá∏ÂåÖÔºàÊ≥®ÊÑèÔºåÊ≠§Êó∂Â∑¶ÂçäËæπÂ∑≤ÊåâÁÖß $x$ ÊéíÂ∫èÔºâ</p><p>‚Ö£ Â§ÑÁêÜÂ∑¶ÂçäËæπÂØπÂè≥ÂçäËæπÁöÑÂΩ±ÂìçÔºåÁî±‰∫éÂ∑≤ÊåâÁÖßÊñúÁéáÈôçÂ∫èÊéíÂ∫èÔºåÊâÄ‰ª•ÊôÆÈÄöÊñúÁéá‰ºòÂåñÂç≥ÂèØ</p><p>‚Ö§ Â∞ÜÂå∫Èó¥ÊåâÁÖß $x$ ÊéíÂ∫è</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> INF = <span class="number">1e60</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-08</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dcmp</span> <span class="params">(<span class="keyword">double</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span> (p) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> p &lt; <span class="number">0</span> ? - <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CashSt</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> a, b, rate;</span><br><span class="line">    <span class="keyword">double</span> k, x, y;</span><br><span class="line">    <span class="keyword">int</span> index;</span><br><span class="line"></span><br><span class="line">    CashSt () &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> CashSt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Dcmp (x - p.x) == <span class="number">0</span> ? Dcmp (y - p.y) &lt; <span class="number">0</span> : Dcmp (x - p.x) &lt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">CashSt Cash[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> CashSt&amp; a, <span class="keyword">const</span> CashSt&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Dcmp (a.k - b.k) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span> <span class="params">(CashSt a, CashSt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Dcmp (b.x - a.x) == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="keyword">return</span> (b.y - a.y) / (b.x - a.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">double</span> f[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">CashSt Que[MAXN];</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">CashSt temp[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">        f[left] = max (f[left], f[left - <span class="number">1</span>]);</span><br><span class="line">        Cash[left].y = f[left] / (Cash[left].a * Cash[left].rate + Cash[left].b);</span><br><span class="line">        Cash[left].x = Cash[left].y * Cash[left].rate;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> p1 = left - <span class="number">1</span>, p2 = mid;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= right; i ++)</span><br><span class="line">        Cash[i].index &lt;= mid ? temp[++ p1] = Cash[i] : temp[++ p2] = Cash[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= right; i ++)</span><br><span class="line">        Cash[i] = temp[i];</span><br><span class="line">    CDQ (left, mid);</span><br><span class="line">    l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= mid; i ++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; Dcmp (slope (Que[r - <span class="number">1</span>], Que[r]) - slope (Que[r], Cash[i])) &lt; <span class="number">0</span>)</span><br><span class="line">            r --;</span><br><span class="line">        Que[++ r] = Cash[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mid + <span class="number">1</span>; i &lt;= right; i ++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; Dcmp (slope (Que[l], Que[l + <span class="number">1</span>]) - Cash[i].k) &gt; <span class="number">0</span>)</span><br><span class="line">            l ++;</span><br><span class="line">        f[Cash[i].index] = max (f[Cash[i].index], Cash[i].a * Que[l].x + Cash[i].b * Que[l].y);</span><br><span class="line">    &#125;</span><br><span class="line">    CDQ (mid + <span class="number">1</span>, right);</span><br><span class="line">    l = left, r = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= mid &amp;&amp; r &lt;= right) &#123;</span><br><span class="line">        <span class="comment">// if (Dcmp (Cash[l].x - Cash[r].x) &lt; 0 || (Dcmp (Cash[l].x - Cash[r].x) == 0 &amp;&amp; Dcmp (Cash[l].y - Cash[r].y) &lt; 0))</span></span><br><span class="line">        <span class="keyword">if</span> (Cash[l] &lt; Cash[r])</span><br><span class="line">            temp[++ p] = Cash[l], l ++;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            temp[++ p] = Cash[r], r ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= mid)</span><br><span class="line">        temp[++ p] = Cash[l], l ++;</span><br><span class="line">    <span class="keyword">while</span> (r &lt;= right)</span><br><span class="line">        temp[++ p] = Cash[r], r ++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= p; i ++)</span><br><span class="line">        Cash[i + left - <span class="number">1</span>] = temp[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> num = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">double</span> T = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = num * <span class="number">10.0</span> + (ch - <span class="string">'0'</span>) * <span class="number">1.0</span>, ch = getchar ();</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">'.'</span>) &#123;</span><br><span class="line">        ch = getchar ();</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">            num = num + (T /= <span class="number">10.0</span>) * (ch - <span class="string">'0'</span>), ch = getchar ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen ("Input.txt", "r", stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span> (<span class="string">"%d%lf"</span>, &amp; N, &amp; f[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">double</span> a = getnum (), b = getnum (), rate = getnum ();</span><br><span class="line">        Cash[i].a = a, Cash[i].b = b, Cash[i].rate = rate;</span><br><span class="line">        Cash[i].index = i;</span><br><span class="line">        Cash[i].k = - a / b;</span><br><span class="line">    &#125;</span><br><span class="line">    sort (Cash + <span class="number">1</span>, Cash + N + <span class="number">1</span>, comp);</span><br><span class="line">    CDQ (<span class="number">1</span>, N);</span><br><span class="line">    <span class="built_in">printf</span> (<span class="string">"%.3f\n"</span>, f[N]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 100</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">2 2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> ÊñúÁéá‰ºòÂåñ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåNOI2007„ÄçÁîüÊàêÊ†ëËÆ°Êï∞</title>
      <link href="/2020/08/04/%5BNOI2007%5D%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0/"/>
      <url>/2020/08/04/%5BNOI2007%5D%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÂêéÈù¢ÂèëÁé∞ËøôÊòØÊüêÊ¨°ËÄÉËØïÁöÑÂéüÈ¢òÊù•ÁùÄ</p><p>ÊÄïÊòØÂ§™‰πÖÊ≤°ÊâìËøáÁä∂ÂéãÁÑ∂ÂêéËøû $k \le 5$ ÂèØËÉΩË¶ÅÁä∂ÂéãËøô‰πàÊòéÊòæÁöÑÊèêÁ§∫ÈÉΩÁªôÊó†ËßÜ‰∫ÜÁÑ∂ÂêéÂ∞±Èöè‰æøÊï≤‰∫Ü‰∏™Áü©ÈòµÊ†ëÈ™ó‰∫Ü $50$„ÄÇ„ÄÇ„ÄÇ</p><p>Â•ΩÊâÄ‰ª•ËøôÈ¢òÊòØ‰∏ÄÈÅìÁä∂Âéã</p><p>‰ª§ $state$ Ë°®Á§∫ÂØπ‰∫é $i$ ÁÇπÔºàÂåÖÊã¨ÂÆÉÊú¨Ë∫´ÔºâÁöÑÂâç $k$ ‰∏™ÁÇπÁöÑËøûÈÄöÁä∂ÊÄÅÔºå$e.g.   \{1, 1, 2\}$ Ë°®Á§∫ $\{1, 2\}, \{3\}$ ÁÇπÂàÜÂà´ËøûÈÄö</p><p>Ê≥®ÊÑè‰∏∫‰∫ÜÂéªÈáçË¶ÅÁî®ÊúÄÂ∞èË°®Á§∫Ôºå‰∫éÊòØÂç≥‰ΩøÂΩì $k = 5$ Êó∂Áä∂ÊÄÅÊï∞‰πü‰∏çËøáÂ∞± $52$ ‰∏™ËÄåÂ∑≤‰∫Ü</p><p>ÂÜç‰ª§ $f_{i, j}$ Ë°®Á§∫Ââç $i$ ‰∏™ÁÇπ‰∏î $i$ ÁÇπËøûÈÄöÁä∂ÊÄÅ‰∏∫ $j$ Êó∂ÁöÑÊñπÊ°àÊï∞Ôºå$g_{i, j}$ Ë°®Á§∫Áä∂ÊÄÅ $i$ ËΩ¨ÁßªÂà∞Áä∂ÊÄÅ $j$ Êó∂ÁöÑÊñπÊ°àÊï∞ÔºåÂàôÊúâÊñπÁ®ã<br>$$<br>f_{i, j} = \sum_k f_{i - 1, k} * g_{k, j}<br>$$<br>ÂèØ‰ª•ÂèëÁé∞ËøôÂ∞±ÊòØ‰∏Ä‰∏™Áü©ÈòµËΩ¨ÁßªÂºèÔºåÊïÖÁõ¥Êé•Áü©Èòµ‰πòÊ≥ïÂç≥ÂèØ</p><p>ÈÇ£‰πàËá≥‰∫éËÆ°ÁÆó $g_{i, j}$ ÂàôÊûö‰∏æ $i$ÔºåÂèäÂΩìÂâçÁÇπ‰∏éÂâçÈù¢ÁÇπÁöÑËøûÈÄöÁä∂ÊÄÅ $state$Ôºà‰∫åËøõÂà∂Ë°®Á§∫ÔºâÔºåÁÑ∂ÂêéÂπ∂Êü•ÈõÜÁª¥Êä§‰∏Ä‰∏ãÔºåÂà§Êñ≠ÂΩìÂâç $state$ ÊòØÂê¶‰ºö‰∏é‰πãÂâçÂÜ≤Á™ÅÔºàËøûËæπÂêéÊó†ÁéØ‰∏îÂéüÁä∂ÊÄÅ‰∏≠ÁöÑÊúÄÂâçÁÇπÔºàÂç≥‰ºöË¢´Âà∑ÊéâÁöÑÁÇπÔºâ‰∏éÂΩìÂâçÁöÑ $k$ ‰∏™ÁÇπ‰∏≠Ëá≥Â∞ë‰∏Ä‰∏™ÁÇπËøûËæπÔºâÔºåÁÑ∂ÂêéËÆ°ÁÆóÂá∫ $j$ÔºåÊúÄÂêéÁ¥ØÂä†Âç≥ÂèØ</p><p>ÂΩìÁÑ∂Ë¶ÅÊ≥®ÊÑèËÄÉËôë $f$ Áü©ÈòµÁöÑÂàùÂßãÁä∂ÊÄÅÔºåÂç≥ÂØπ‰∫é $i  \in [1, k]$ÔºåÈÇ£‰πàËÆ°ÁÆóÂá∫ÈáåÈù¢ÊØè‰∏™ËøûÈÄöÂùóÁöÑÂ§ßÂ∞è $a_i$ÔºåÁÑ∂ÂêéÁî® $Calley$ ÂÖ¨Âºè $n^{n - 2}$ ÁÆó‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 65521</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">52</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXT = <span class="number">6e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> K;</span><br><span class="line">LL N;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> allst[MAXM], M = <span class="number">0</span>; <span class="comment">// Âéã‰ΩçË°®Á§∫</span></span><br><span class="line"><span class="keyword">int</span> mapp[MAXT]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> state, <span class="keyword">int</span> maxi)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == K + <span class="number">1</span>) &#123;</span><br><span class="line">        allst[++ M] = state;</span><br><span class="line">        mapp[state] = M;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= min (maxi + <span class="number">1</span>, K); i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> nst = state * <span class="number">10</span> + i;</span><br><span class="line">        DFS (p + <span class="number">1</span>, nst, max (i, maxi));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">    LL a[MAXM][MAXM];</span><br><span class="line"></span><br><span class="line">    Matrix () &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line">        a[i][j] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix&amp; A, <span class="keyword">const</span> Matrix&amp; B) &#123;</span><br><span class="line">Matrix ret = Matrix ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= M; k ++)</span><br><span class="line">ret.a[i][j] = (ret.a[i][j] + A.a[i][k] * B.a[k][j] % MOD) % MOD;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">Matrix f, g;</span><br><span class="line"><span class="function">LL <span class="title">matpower</span> <span class="params">(LL p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">f = f * g;</span><br><span class="line">g = g * g;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> f.a[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXK];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> father[x] == x ? x : father[x] = find (father[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    LL cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (p) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">            cnt = cnt * x % MOD;</span><br><span class="line">        x = x * x % MOD;</span><br><span class="line">        p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> visit[MAXK]= &#123;<span class="number">0</span>&#125;, bit[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span> <span class="params">(<span class="keyword">int</span> state, <span class="keyword">int</span> con)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K + <span class="number">1</span>; i ++)</span><br><span class="line">        father[i] = i, visit[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> st = state, i = K; i &gt; <span class="number">0</span>; i --, st /= <span class="number">10</span>)</span><br><span class="line">        bit[i] = st % <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= K; j ++) &#123;</span><br><span class="line">            <span class="keyword">int</span> fx = find (i), fy = find (j);</span><br><span class="line">            <span class="keyword">if</span> (bit[i] != bit[j] || fx == fy) <span class="keyword">continue</span>;</span><br><span class="line">            father[fx] = fy;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; j ++)</span><br><span class="line">        <span class="keyword">if</span> (con &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))) &#123;</span><br><span class="line">            <span class="keyword">int</span> fx = find (K + <span class="number">1</span>), fy = find (j);</span><br><span class="line">            <span class="keyword">if</span> (fx == fy) <span class="keyword">return</span> ;</span><br><span class="line">            father[fx] = fy;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">bool</span> fail = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= K + <span class="number">1</span>; i ++)</span><br><span class="line">        <span class="keyword">if</span> (find (<span class="number">1</span>) == find (i)) &#123;</span><br><span class="line">            fail = <span class="literal">false</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (fail) <span class="keyword">return</span> ; <span class="comment">// ‰πãÂâçÁöÑÁÇπÈÉΩËÅîÈÄö</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">        bit[i] = find (i + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">        <span class="keyword">if</span> (! visit[bit[i]])</span><br><span class="line">            visit[bit[i]] = ++ cnt;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">final</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">        <span class="keyword">final</span> = <span class="keyword">final</span> * <span class="number">10</span> + visit[bit[i]];</span><br><span class="line">    g.a[mapp[state]][mapp[<span class="keyword">final</span>]] ++, g.a[mapp[state]][mapp[<span class="keyword">final</span>]] %= MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cnt[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prep</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123; <span class="comment">// i in [1, k]</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; j ++) cnt[j] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> st = allst[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; j ++, st /= <span class="number">10</span>)</span><br><span class="line">            cnt[st % <span class="number">10</span>] ++;</span><br><span class="line">    LL ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K &amp;&amp; cnt[j] &gt; <span class="number">0</span>; j ++)</span><br><span class="line">    ret = ret * power (cnt[j], cnt[j] - <span class="number">2</span>) % MOD;</span><br><span class="line">    f.a[<span class="number">1</span>][i] = ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> limit = (<span class="number">1</span> &lt;&lt; K) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) <span class="comment">// Êûö‰∏æÂΩìÂâçÁÇπÂèäÂÖ∂‰∏é‰πãÂâçÁöÑËøûÈÄöÁä∂ÊÄÅ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">0</span>; state &lt;= limit; state ++)</span><br><span class="line">            maintain (allst[i], state);</span><br><span class="line">    <span class="comment">/*for (int i = 1; i &lt;= M; i ++) &#123;</span></span><br><span class="line"><span class="comment">        for (int j = 1; j &lt;= M; j ++)</span></span><br><span class="line"><span class="comment">            cout &lt;&lt; g.a[i][j] &lt;&lt; ' ';</span></span><br><span class="line"><span class="comment">        puts ("");</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; K &gt;&gt; N;</span><br><span class="line">    DFS (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>), prep ();</span><br><span class="line">    LL ans = matpower (N - K);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 5</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 23333333333333</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Áä∂ÂéãDP </tag>
            
            <tag> Áü©Èòµ‰πòÊ≥ï </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåJSOI2012„ÄçÂàÜÈõ∂È£ü</title>
      <link href="/2020/08/04/%5BJSOI2012%5D%E5%88%86%E9%9B%B6%E9%A3%9F/"/>
      <url>/2020/08/04/%5BJSOI2012%5D%E5%88%86%E9%9B%B6%E9%A3%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>È¶ñÂÖàÊôÆÈÄö $DP$ ÂºèÂ≠êÂæàÂ•ΩÂàó</p><p>‰ª§ $f[i][j]$ Ë°®Á§∫ $i$ ‰∏™Â∞èÊúãÂèãÂàÜ $j$ ‰∏™Á≥ñÊûú‰∏îÊØè‰∫∫Ëá≥Â∞ë‰∏ÄÈ¢óÁöÑÁ≠îÊ°àÔºåÂàôÊúâ<br>$$<br>f[i][j] = \sum\limits_{k = 1}^j f[i - 1][j - k](Ok^2 + Sk + U)<br>$$<br>Êé•‰∏ãÊù•Áî®ÁîüÊàêÂáΩÊï∞‰ºòÂåñËØ•Âºè</p><p>‰ª§ $g[k] = Ok^2 + Sk + U$ÔºåÂàô<br>$$<br>f_i(x) = f_{i - 1}(x)g(x)<br>$$<br>ÂÖ∂‰∏≠ $f_0(x) = 1$</p><p>ÊâÄ‰ª•Á≠îÊ°àÂç≥‰∏∫<br>$$<br>[x^M] \sum\limits_{i = 0}^A f_i(x) = [x^M] \sum\limits_{i = 0}^A (g(x))^i = [x^M] \frac{1 - (g(x))^{A + 1}}{1 - g(x)}<br>$$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span> (- <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL MOD;</span><br><span class="line">LL O, S, U;</span><br><span class="line">LL a[MAXN]= &#123;<span class="number">0</span>&#125;, b[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mcomplex</span> &#123;</span></span><br><span class="line"><span class="keyword">double</span> a, b;</span><br><span class="line"></span><br><span class="line">mcomplex (<span class="keyword">double</span> fa = <span class="number">0.0</span>, <span class="keyword">double</span> fb = <span class="number">0.0</span>) :</span><br><span class="line">a (fa), b (fb) &#123;&#125;</span><br><span class="line"></span><br><span class="line">mcomplex <span class="keyword">operator</span> + (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (a + p.a, b + p.b);</span><br><span class="line">&#125;</span><br><span class="line">mcomplex <span class="keyword">operator</span> - (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (a - p.a, b - p.b);</span><br><span class="line">&#125;</span><br><span class="line">mcomplex <span class="keyword">operator</span> * (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (a * p.a - b * p.b, a * p.b + b * p.a);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span> <span class="params">(mcomplex* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">mcomplex omega = mcomplex (<span class="built_in">cos</span> (PI / (<span class="keyword">double</span>) mid), inv * <span class="built_in">sin</span> (PI / (<span class="keyword">double</span>) mid));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">mcomplex x = mcomplex (<span class="number">1.0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * omega) &#123;</span><br><span class="line">mcomplex a1 = a[j + k], xa2 = x * a[j + mid + k];;</span><br><span class="line">a[j + k] = a1 + xa2;</span><br><span class="line">a[j + k + mid] = a1 - xa2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">aclimit</span> <span class="params">(<span class="keyword">int</span> maxl)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= maxl; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line">limit = n;</span><br><span class="line">&#125;</span><br><span class="line">mcomplex a1[MAXN &lt;&lt; <span class="number">2</span>], a2[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multiply</span> <span class="params">(LL* A, LL* B, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">aclimit (n + m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">a1[i] = a2[i] = mcomplex ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">a1[i] = mcomplex ((<span class="keyword">double</span>) A[i], <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i ++)</span><br><span class="line">a2[i] = mcomplex ((<span class="keyword">double</span>) B[i], <span class="number">0</span>);</span><br><span class="line">FFT (a1, <span class="number">1</span>), FFT (a2, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">a1[i] = a1[i] * a2[i];</span><br><span class="line">FFT (a1, - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n + m; i ++)</span><br><span class="line">A[i] = (LL) (a1[i].a / limit + <span class="number">0.5</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL inv[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL temp[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* A, LL* B)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123;</span><br><span class="line">B[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, A, B);</span><br><span class="line">aclimit (deg &lt;&lt; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">temp[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">temp[i] = A[i];</span><br><span class="line">multiply (temp, B, deg, deg);</span><br><span class="line">multiply (temp, B, deg, deg);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">B[i] = (<span class="number">2</span> * B[i] % MOD - temp[i] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL ans[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">power</span> <span class="params">(LL* A, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">ans[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">multiply (ans, a, M, M);</span><br><span class="line">multiply (a, a, M, M);</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">int</span> isneg = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>)</span><br><span class="line">isneg = <span class="number">1</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">M = getnum (), MOD = getnum (), N = getnum ();</span><br><span class="line">O = getnum (), S = getnum (), U = getnum ();</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">a[i] = (O * i * i + S * i + U) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">b[i] = (- a[i] + MOD) % MOD;</span><br><span class="line">b[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">power (ans, N + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">ans[i] = (- ans[i] + MOD) % MOD;</span><br><span class="line">ans[<span class="number">0</span>] = (ans[<span class="number">0</span>] + <span class="number">1</span>) % MOD;</span><br><span class="line">inverse (M + <span class="number">1</span>, b, inv);</span><br><span class="line">multiply (ans, inv, M, M);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans[M] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 100</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> ÁîüÊàêÂáΩÊï∞ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåJLOI2013„ÄçÂú∞ÂΩ¢ÁîüÊàê</title>
      <link href="/2020/08/04/%5BJLOI2013%5D%E5%9C%B0%E5%BD%A2%E7%94%9F%E6%88%90/"/>
      <url>/2020/08/04/%5BJLOI2013%5D%E5%9C%B0%E5%BD%A2%E7%94%9F%E6%88%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Êå∫ÊúâË∂£ÁöÑ‰∏ÄÈÅì $dp$Ôºå‰∏§ÈóÆÂÆûÈôÖ‰∏äÂ∞±Áõ∏ÂΩì‰∫éÊòØÁ¨¨‰∏ÄÈóÆÊòØÁ¨¨‰∫åÈóÆÁöÑÈÉ®ÂàÜÂàÜ</p><h4 id="Á¨¨‰∏ÄÈóÆ"><a href="#Á¨¨‰∏ÄÈóÆ" class="headerlink" title="Á¨¨‰∏ÄÈóÆ"></a>Á¨¨‰∏ÄÈóÆ</h4><p>‰∏ÄÂºÄÂßã‰ª•‰∏∫Ë¶Å $dp$ÔºåÁÑ∂ËÄåÂπ∂‰∏çÁî®</p><p>ÂØπ‰∫éËøôÁßçÈ´òÂ∫¶ÁÑ∂ÂêéÊ±ÇÊñπÊ°àÊï∞ÁöÑÈ¢òÔºåÂèØ‰ª•Âè™ËÄÉËôëÂÖ∂Áõ∏ÂØπ‰ΩçÁΩÆÔºåÂõ†‰∏∫Âè™Ë¶ÅÊâÄÊúâÁõ∏ÂØπ‰ΩçÁΩÆÁ°ÆÂÆö‰∫ÜÔºåÈÇ£‰πàÊï¥‰∏™Â∫èÂàóÂ∞±ÂîØ‰∏ÄÁ°ÆÂÆö‰∫Ü</p><p>È¶ñÂÖàËÇØÂÆöË¶ÅÂÖàÂ∞ÜÂÆÉ‰ª¨‰ª•È´òÂ∫¶‰∏∫Á¨¨‰∏ÄÂÖ≥ÈîÆÂ≠óÔºàÁî±Â§ßÂà∞Â∞èÔºâÔºåÂÖ≥ÈîÆÂÄº‰∏∫Á¨¨‰∫åÂÖ≥ÈîÆÂ≠óÔºà‰ªéÂ∞èÂà∞Â§ßÔºâÊéíÂ∫è</p><p>ÈÇ£‰πàÂØπ‰∫éÁ¨¨ $i$ Â∫ßÂ±±ÔºåÂÆÉÂ∞±‰ºöÊúâ $\min (i, key_i)$ ‰∏™Áõ∏ÂØπ‰ΩçÁΩÆÂèØ‰ª•Âç†ÔºåÂõ†‰∏∫ÊúâÁõ∏ÂêåÈ´òÂ∫¶ÁöÑÂ±±Â≥∞ÔºåÊâÄ‰ª•Ëøò‰ºöÂ§öÂá∫ $same$ Ôºà$i$ ÂâçÈù¢‰∏éÂÖ∂È´òÂ∫¶Áõ∏ÂêåÁöÑÂ±±Â≥∞ÁöÑ‰∏™Êï∞Ôºâ‰∏™‰ΩçÁΩÆ</p><p>ÈÇ£‰πà $ans_1 = \prod\limits_{i = 1}^n min (i, key_i + same)$</p><h4 id="Á¨¨‰∫åÈóÆ"><a href="#Á¨¨‰∫åÈóÆ" class="headerlink" title="Á¨¨‰∫åÈóÆ"></a>Á¨¨‰∫åÈóÆ</h4><p>ÁóáÁªìËøòÊòØÂú®‰∫éÁõ∏ÂêåÈ´òÂ∫¶ÁöÑÂ±±Â≥∞‰ºö‰∫ßÁîüÈáçÂ§ç</p><p>‰ΩÜÊòØÊòæÁÑ∂Â¶ÇÊûú‰∏ÄÊ¨°ÊÄßÁ°ÆÂÆöÂ•ΩÊâÄÊúâÁõ∏ÂêåÂ±±Â≥∞ÁöÑ‰ΩçÁΩÆÊòØ‰∏ç‰ºö‰∫ßÁîüÈáçÂ§çÁöÑÔºåÊïÖËÄÉËôëÂ∞ÜÊØè‰∏ÄÁªÑÁõ∏ÂêåÈ´òÂ∫¶ÁöÑÂ±±Â≥∞ÊîæÂú®‰∏ÄËµ∑Â§ÑÁêÜ</p><p>‰∏∫‰∫ÜÈÅøÂÖçÈáçÂ§çÔºåÈúÄË¶ÅÂº∫Âà∂‰ª§Ëøô‰∫õÁõ∏ÂêåÈ´òÂ∫¶ÁöÑÂ±±Â≥∞ÊîæÁΩÆÊúâÂ∫èÔºåÂç≥ÂêéÊîæÁöÑ‰∏ÄÂÆöÂú®ÂÖàÊîæÁöÑÂêéÈù¢ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•‰ª§ $f_{i, j}$ Ë°®Á§∫ÔºàÂΩìÂâçÁªÑÁõ∏ÂêåÈ´òÂ∫¶Â±±Â≥∞ÔºâÂâç $i$ ‰∏™ÊîæÂú®Ââç $j$ ‰∏™‰ΩçÁΩÆ‰∏äÔºåÂπ∂‰∏îÁ¨¨ $i$ ÊîæÂú®Á¨¨ $j$ ‰∏™‰ΩçÁΩÆÁöÑÊñπÊ°àÊï∞ÔºåÂàôÊúâÔºà‰∏ãÁ§∫ÊñπÁ®ãË°®Á§∫Âå∫Èó¥ $[l, r]$ ÁöÑÁõ∏ÂêåÈ´òÂ∫¶Â±±Â≥∞ÁªÑÔºâ<br>$$<br>\begin{aligned}<br>f_{i, j} &amp;= \sum\limits_{k = 1}^j f_{i - 1, k}  (j \in [0, \min (l, key_i) - 1]) \\<br>&amp;= f_{i - 1, j} + f_{i, j - 1}<br>\end{aligned}<br>$$<br>ÁÑ∂ÂêéÂÆûÈôÖ‰∏äÁ¨¨‰∏ÄÁª¥ÊòØÊ≤°Áî®ÁöÑÔºåÂÜçÁúÅÊéâÂ∞±Ë°å‰∫Ü</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 2011</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL f[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hillSt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> high;</span><br><span class="line"><span class="keyword">int</span> key;</span><br><span class="line"></span><br><span class="line">hillSt (<span class="keyword">int</span> fhigh = <span class="number">0</span>, <span class="keyword">int</span> fkey = <span class="number">0</span>) :</span><br><span class="line">high (fhigh), key (fkey) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> hillSt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (high == p.high)</span><br><span class="line"><span class="keyword">return</span> key &lt; p.key;</span><br><span class="line"><span class="keyword">return</span> high &gt; p.high;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">hillSt hill[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">hill[i].high = getnum (), hill[i].key = getnum ();</span><br><span class="line">sort (hill + <span class="number">1</span>, hill + N + <span class="number">1</span>);</span><br><span class="line">LL ans1 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> same = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">hill[i].high == hill[i - <span class="number">1</span>].high ? same ++ : same = <span class="number">0</span>;</span><br><span class="line">ans1 = ans1 * <span class="number">1l</span>l * min (i, hill[i].key + same) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL ans2 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= N; l ++) &#123;</span><br><span class="line"><span class="keyword">int</span> r;</span><br><span class="line"><span class="keyword">for</span> (r = l; r &lt;= N &amp;&amp; hill[r + <span class="number">1</span>].high == hill[r].high; r ++);</span><br><span class="line"><span class="built_in">memset</span> (f, <span class="number">0</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line">f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= min (l, hill[i].key) - <span class="number">1</span>; j ++)</span><br><span class="line">f[j] = (f[j - <span class="number">1</span>] + f[j]) % MOD;</span><br><span class="line">LL total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= min (l, hill[r].key) - <span class="number">1</span>; j ++)</span><br><span class="line">total = (total + f[j]) % MOD;</span><br><span class="line">ans2 = ans2 * total % MOD;</span><br><span class="line">swap (l, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans1 &lt;&lt; <span class="string">' '</span> &lt;&lt; ans2 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÄßDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåHNOI2007„ÄçÊ¢¶ÂπªÂ≤õÂÆùÁè† „ÄåÂ•óË∑ØÔºöÂàÜÂ±ÇDP„Äç</title>
      <link href="/2020/08/04/%5BHNOI2007%5D%E6%A2%A6%E5%B9%BB%E5%B2%9B%E5%AE%9D%E7%8F%A0%20%E3%80%8C%E5%A5%97%E8%B7%AF%EF%BC%9A%E5%88%86%E5%B1%82DP%E3%80%8D/"/>
      <url>/2020/08/04/%5BHNOI2007%5D%E6%A2%A6%E5%B9%BB%E5%B2%9B%E5%AE%9D%E7%8F%A0%20%E3%80%8C%E5%A5%97%E8%B7%AF%EF%BC%9A%E5%88%86%E5%B1%82DP%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÊòæÁÑ∂Áõ¥Êé• $01$ ËÉåÂåÖ‰ºöË∂ÖÊó∂Âπ∂‰∏îË∂ÖÁ©∫Èó¥</p><p><strong>Â•óË∑ØÔºöÂàÜÂ±Ç $DP$</strong></p><p>„ÄåËÄÉËôëÂ∞ÜÊØè‰∏™Â≠êÁªìÊûÑÁúã‰Ωú‰∏ÄÂ±ÇÔºà‰πüÂ∞±ÊòØÂåÖÂê´‰∫Ü‰∏çÊ≠¢ $1$ ‰∏™Áâ©ÂìÅÁöÑ‰ø°ÊÅØÔºâÔºåÂπ∂‰∏îÂ§ßÂ±Ç‰∏ç‰ºöÂØπÂ∞èÂ±ÇÈÄ†ÊàêÂΩ±ÂìçÔºåÂèØ‰ª•ËÄÉËôëÂÖàËøõË°åÊØè‰∏ÄÂ±ÇÁöÑËá™ÊàëÊõ¥Êñ∞ÔºàÂç≥Áî®ÂΩìÂâçÂ±ÇÁâ©ÂìÅÊõ¥Êñ∞ÂΩìÂâçÂ±ÇÁ≠îÊ°àÔºâÔºåÂÜçËøõË°åÂ±ÇÁöÑÂêàÂπ∂ÔºåÊ≠§Êó∂ËÄÉËôë‰ΩéÂ±ÇÂØπÈ´òÂ±ÇÁöÑÂΩ±Âìç„Äç</p><p><strong>Ê≠£È¢ò</strong></p><p>ÈÇ£‰πàËøôÈ¢òÊúâ‰∏Ä‰∏™ÁâπÊÆäÊÄßË¥®Ôºö $V_i = a \times 2^b$</p><blockquote><p>bÂÄºÂ§ßÁöÑÁâ©ÂìÅ‰∏ç‰ºöÂΩ±ÂìçÈõ∂Á¢éÂâ©‰ΩôÁöÑÈáçÈáè‰∏äÈôê„ÄÇ</p><p>Â∞ÜÁâ©ÂìÅÊåâbÂÄºÂàÜÈò∂ÊÆµÂ§ÑÁêÜ„ÄÇ</p></blockquote><p>ÈÇ£‰πàÂ∞±ÊòØÂàÜÂ±Ç $DP$</p><p>ÂÖàÈÄöËøáÊôÆÈÄöÁöÑ $01$ ËÉåÂåÖÊõ¥Êñ∞ÂΩìÂâçÂ±ÇËá™Ë∫´ÊúÄ‰ºòËß£</p><p>ÂÜçËøõË°åÂ±ÇÂêàÂπ∂Ôºö</p><p>‰ª§ $g_{i, j}‚Äã$ Ë°®Á§∫Á¨¨ $i‚Äã$ Â±ÇÔºå$a‚Äã$ ‰∏∫ $j‚Äã$ ÁöÑÊúÄ‰ºòËß£Ôºå$f_{i, j}‚Äã$ Ë°®Á§∫Á¨¨ $i‚Äã$ Â±ÇÔºå$a‚Äã$ ‰∏∫ $j‚Äã$ÔºåÂπ∂‰∏îÂÜçÂä†‰∏ä $V_{total}‚Äã$ ÁöÑ $1‚Ä¶i - 1‚Äã$ ‰ΩçÁöÑÊúÄ‰ºòËß£</p><p>ÈÇ£‰πàÂØπ‰∫éÁ¨¨ $i$ Â±ÇÔºåÊûö‰∏æÂΩìÂâç $j$</p><p>ÂØπ‰∫éËΩ¨ÁßªÔºåÊûö‰∏æÂú®Ëá™Ë∫´Â±ÇÂÜÖÊ∂àËÄóÁöÑÁ©∫Èó¥ $(j - k) \times 2^i$ÔºåÈÇ£‰πàËøòÂâ©‰∏ã $k \times 2^i + V_{total}\{1‚Ä¶i - 1\}$ ÁöÑÁ©∫Èó¥ÔºåÂàÜÈÖçÁªô‰∏ä‰∏ÄÂ±ÇÔºåÈÇ£‰πàÂèØÂæóËΩ¨ÁßªÊñπÁ®ã‰∏∫</p><p>ÔºàÊ≥®Ôºö$w_i$ Ë°®Á§∫ $V_{total}$ Á¨¨ $i$ ‰ΩçÔºâ<br>$$<br>f_{i, j} = \max \{g_{i, j - k} + f_{i - 1, 2k + w_i}\}<br>$$<br>ÂêåÊó∂Ôºå$g_{i, j}$ ÂèØ‰ª•ÈÄöËøáÁî±Â§ßÂà∞Â∞èÊûö‰∏æÊù•Ê∂àÈô§</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">30</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line">LL f[MAXN][MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">int</span> isneg = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>)</span><br><span class="line">isneg = <span class="number">1</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (~ (N = getnum ())) &#123;</span><br><span class="line">M = getnum ();</span><br><span class="line"><span class="built_in">memset</span> (f, <span class="number">0</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> vol = getnum (), value = getnum ();</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (! (vol &amp; <span class="number">1</span>))</span><br><span class="line">vol &gt;&gt;= <span class="number">1</span>, b ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1000</span>; j &gt;= vol; j --)</span><br><span class="line">f[b][j] = max (f[b][j], f[b][j - vol] + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> xm = M, maxb = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (xm)</span><br><span class="line">xm &gt;&gt;= <span class="number">1</span>, maxb ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= maxb; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1000</span>; j ++)</span><br><span class="line">f[i][j] = max (f[i][j], f[i][j - <span class="number">1</span>]);</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxb; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = min (<span class="number">1000</span>, M &gt;&gt; i); j &gt;= <span class="number">0</span>; j --) <span class="comment">// Ê≥®ÊÑèÊ≠§Â§Ñ‰∏äÈôêÊòØ min (100, M &gt;&gt; i)ÔºåM &gt;&gt; i ‰øùËØÅ‰∏ç‰ºöÂ∞ÜÈ´ò‰ΩçÊãøÂ§ö‰∫Ü</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= j; k ++) &#123;</span><br><span class="line">f[i][j] = max (f[i][j], f[i][j - k] + f[i - <span class="number">1</span>][min ((k &lt;&lt; <span class="number">1</span>) + ((M &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>), <span class="number">1000</span>)]);</span><br><span class="line">ans = max (ans, f[i][j]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 10</span></span><br><span class="line"><span class="comment">8 9</span></span><br><span class="line"><span class="comment">5 8</span></span><br><span class="line"><span class="comment">4 6</span></span><br><span class="line"><span class="comment">2 5</span></span><br><span class="line"><span class="comment">-1 -1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 10</span></span><br><span class="line"><span class="comment">8 9</span></span><br><span class="line"><span class="comment">5 8</span></span><br><span class="line"><span class="comment">4 6</span></span><br><span class="line"><span class="comment">2 5</span></span><br><span class="line"><span class="comment">4 13</span></span><br><span class="line"><span class="comment">8 9</span></span><br><span class="line"><span class="comment">5 8</span></span><br><span class="line"><span class="comment">4 6</span></span><br><span class="line"><span class="comment">2 5</span></span><br><span class="line"><span class="comment">16 75594681</span></span><br><span class="line"><span class="comment">393216 5533</span></span><br><span class="line"><span class="comment">2 77</span></span><br><span class="line"><span class="comment">32768 467</span></span><br><span class="line"><span class="comment">29360128 407840</span></span><br><span class="line"><span class="comment">112 68</span></span><br><span class="line"><span class="comment">24576 372</span></span><br><span class="line"><span class="comment">768 60</span></span><br><span class="line"><span class="comment">33554432 466099</span></span><br><span class="line"><span class="comment">16384 318</span></span><br><span class="line"><span class="comment">33554432 466090</span></span><br><span class="line"><span class="comment">2048 111</span></span><br><span class="line"><span class="comment">24576 350</span></span><br><span class="line"><span class="comment">9216 216</span></span><br><span class="line"><span class="comment">12582912 174768</span></span><br><span class="line"><span class="comment">16384 295</span></span><br><span class="line"><span class="comment">1024 76</span></span><br><span class="line"><span class="comment">-1 -1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÂàÜÂ±ÇDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåFJOI2016„ÄçÂª∫Á≠ëÂ∏à</title>
      <link href="/2020/08/04/%5BFJOI2016%5D%E5%BB%BA%E7%AD%91%E5%B8%88/"/>
      <url>/2020/08/04/%5BFJOI2016%5D%E5%BB%BA%E7%AD%91%E5%B8%88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ËøôÈ¢ò‰∏ÄÁõ¥ÂæÄ $\text{dp}$ ÂéªÊÉ≥ÔºåÁÑ∂ÂêéÂ∞±Ê≤°‰∫Ü</p><p>ÊâÄ‰ª•ÂÖ∂ÂÆûÂπ∂‰∏çÁî®Ê≥®ÊÑè‰πãÂâçÁöÑÂèØÁúãËßÅÁöÑÂª∫Á≠ëÁöÑÊúÄÂ§ßÂÄºÊòØÂ§öÂ∞ëÔºåËã•ÊääÈÇ£‰∫õËÉΩÂ§üË¢´ÁúãËßÅÁöÑÂª∫Á≠ë‰πãÈó¥ÊûÑÊàêÁöÑÂå∫Èó¥Áúã‰Ωú‰∏Ä‰∏™Â∞èÁªÑÔºåÈÇ£‰πàËÉΩÂ§üË¢´ÁúãËßÅÁöÑÂª∫Á≠ë‰∏çËøáÊòØÂú®ÂΩìÂâçÂ∞èÁªÑ‰∏≠ÈÄâÊã©‰∏Ä‰∏™ÊúÄÂ§ßÂÄºÊúÄ‰∏∫‰ª£Ë°®ÊéíÂú®Â∑¶ÔºàÂè≥ÔºâËæπÁΩ¢‰∫Ü</p><p>ÊâÄ‰ª•Áé∞Âú®ÈóÆÈ¢òËΩ¨Âåñ‰∏∫Â∞Ü $n - 1$ ‰∏™Âª∫Á≠ëÂàÜÂú® $A + B - 2$ ‰∏™ÁõíÂ≠êÔºåÁÑ∂ÂêéÁõíÂ≠êÂÜÖÂèØ‰ª•ÈöèÊÑèÊéíÂàóÁöÑ‰∏™Êï∞</p><p>ÁÑ∂Âêé‰∏äËø∞ÈóÆÈ¢òÂÆûÈôÖ‰∏äÂèØ‰ª•Â∞ÜÊØè‰∏™ÁõíÂ≠êÁúã‰Ωú‰∏Ä‰∏™ÂúÜÔºåÊïÖÈóÆÈ¢òÂèàËΩ¨Âåñ‰∏∫ $n - 1$ ‰∏™Âª∫Á≠ëÊûÑÊàêÁöÑ $A + B - 2$ ‰∏™ÂúÜÊéíÂàóÊñπÊ°àÊï∞ÔºåÂç≥ÊñØÁâπÊûóÊï∞ $S (n - 1, A + B - 2)$</p><p>ÁÑ∂ÂêéË¶ÅÂú®ÂÖ∂‰∏≠ÈÄâÊã©‰∏Ä‰∫õÊîæÂ∑¶ÔºàÂè≥ÔºâËæπÔºåÊïÖÁ≠îÊ°àÂç≥‰∏∫<br>$$<br>ans = S (n - 1, A + B - 2) \times \dbinom{A + B - 2}{A - 1}<br>$$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e04</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXAB = <span class="number">200</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> n, A, B;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NMAX = <span class="number">5e04</span>, ABMAX = <span class="number">200</span>;</span><br><span class="line">LL S[MAXN][MAXAB]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL fact[MAXAB]= &#123;<span class="number">0</span>&#125;, invfact[MAXAB]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">S[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= NMAX; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= min (i, ABMAX); j ++)</span><br><span class="line">S[i][j] = (S[i - <span class="number">1</span>][j - <span class="number">1</span>] + S[i - <span class="number">1</span>][j] * (i - <span class="number">1</span>) % MOD) % MOD;</span><br><span class="line">fact[<span class="number">0</span>] = fact[<span class="number">1</span>] = invfact[<span class="number">0</span>] = invfact[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= ABMAX; i ++) &#123;</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[i] = (MOD - MOD / i) * invfact[MOD % i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ABMAX; i ++)</span><br><span class="line">invfact[i] = invfact[i - <span class="number">1</span>] * invfact[i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">init ();</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line">n = getnum (), A = getnum (), B = getnum ();</span><br><span class="line">LL ans = S[n - <span class="number">1</span>][A + B - <span class="number">2</span>] * C (A + B - <span class="number">2</span>, A - <span class="number">1</span>) % MOD;</span><br><span class="line">write (ans), <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3 2 2</span></span><br><span class="line"><span class="comment">3 1 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁªÑÂêàÊï∞Â≠¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåCTSC2008„ÄçÁ•≠Á•ÄÔºàDAGÊúÄÈïøÂèçÈìæÂèäÂÖ∂ÊñπÊ°àÊûÑÈÄ†Ôºâ</title>
      <link href="/2020/08/04/%5BCTSC2008%5D%E7%A5%AD%E7%A5%80%EF%BC%88DAG%E6%9C%80%E9%95%BF%E5%8F%8D%E9%93%BE%E5%8F%8A%E5%85%B6%E6%96%B9%E6%A1%88%E6%9E%84%E9%80%A0%EF%BC%89/"/>
      <url>/2020/08/04/%5BCTSC2008%5D%E7%A5%AD%E7%A5%80%EF%BC%88DAG%E6%9C%80%E9%95%BF%E5%8F%8D%E9%93%BE%E5%8F%8A%E5%85%B6%E6%96%B9%E6%A1%88%E6%9E%84%E9%80%A0%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h2><p>Ê±Ç‰∏Ä‰∏™ $n$ ÁÇπ $m$ ËæπÁöÑ $DAG$ ÁöÑÊúÄÈïøÂèçÈìæÔºåÂú®Á¨¨‰∫åË°åËæìÂá∫ÊûÑÈÄ†ÁöÑÂÖ∂‰∏≠‰∏ÄÁßçÊñπÊ°àÔºåÂú®Á¨¨‰∏âË°åËæìÂá∫Âú®‰øùËØÅÊúÄÈïøÂèçÈìæÁöÑÂâçÊèê‰∏ãÔºåÊØè‰∏™ÁÇπÊòØÂê¶ËÉΩÂ§üËÆæÁΩÆ‰∏∫ÂèçÈìæ‰∏≠ÁöÑÁÇπ</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>ÂèçÊ≠£ËØÅÊòé‰πü‰∏ç‰ºöÔºåÂ∞±ËÆ∞ÂΩï‰∏Ä‰∏ãÂÖ∑‰ΩìÊñπÊ≥ï</p><blockquote><p>ÊúÄÈïøÂèçÈìæÔºöÂØπ $DAG$ ÁÇπÈõÜ $V$ÔºåÊúÄÈïøÂèçÈìæ‰∏∫‰∏Ä‰∏™ÈõÜÂêà $S \subseteq V$ÔºåÊª°Ë∂≥ $\forall u \in S, v \in S$Ôºå$u$ ‰∏çËÉΩÂà∞Ëææ $v$Ôºå$v$ ‰πü‰∏çËÉΩÂà∞Ëææ $u$</p></blockquote><p>Ê†πÊçÆ $\text{Dilworth}$ ÂÆöÁêÜÔºå‰∏Ä‰∏™ $DAG$ ÁöÑÊúÄÈïøÂèçÈìæÂ§ßÂ∞èÁ≠â‰∫éÂÖ∂ÊúÄÂ∞èÂèØÈáçÈìæË¶ÜÁõñÂ§ßÂ∞è</p><p>ÂØπ $DAG$ ‰º†ÈÄíÈó≠ÂåÖÂêéÔºåÊúÄÂ∞èÂèØÈáçÈìæË¶ÜÁõñÂ§ßÂ∞èÂèØËΩ¨Âåñ‰∏∫ÊúÄÂ∞è<strong>‰∏ç</strong>ÂèØÈáçÈìæË¶ÜÁõñÂ§ßÂ∞èÔºåÂç≥ÊúÄÂ∞èË∑ØÂæÑÁÇπË¶ÜÁõñ</p><blockquote><p>ÊúÄÂ∞èË∑ØÂæÑÁÇπË¶ÜÁõñÔºöÂ∞Ü $DAG$ Áî®Ëã•Âπ≤‰∏çÁõ∏‰∫§ÁöÑÈìæË¶ÜÁõñÔºåÂç≥ÊØè‰∏™ÁÇπÊúÄÂ§öË¢´ÁªèËøá‰∏ÄÊ¨°ÔºåÊúÄÂ∞è‰ΩøÁî®ÈìæÁöÑ‰∏™Êï∞</p></blockquote><p>ÈÇ£‰πàÊúÄÂ∞èÂèØÈáçÈìæË¶ÜÁõñÂàôÊòØÁ±ª‰ººÔºå‰∏çÂêå‰πãÂ§Ñ‰ªÖÂú®‰∫éÊØè‰∏™ÁÇπÂèØË¢´ÁªèËøáÂ§öÊ¨°</p><blockquote><p>ÊúÄÂ∞èË∑ØÂæÑÁÇπË¶ÜÁõñÂ§ßÂ∞è $=$ $n$ $-$ ËØ• $DAG$ ÊãÜÁÇπ‰∫åÂàÜÂõæÁöÑÊúÄÂ§ßÂåπÈÖçÂ§ßÂ∞è</p></blockquote><p>ÈÇ£‰πà $\text{Subtask1}$ Â∞±ÂÅöÂÆå‰∫Ü</p><p>Êää $DAG$ ÊãÜÁÇπÂêéÊúÄÂ∞èË∑ØÂæÑÁÇπË¶ÜÁõñÂ∞±Áõ∏ÂΩì‰∫éÊòØÊ±ÇËØ•ÊãÜÁÇπ‰∫åÂàÜÂõæÁöÑÊúÄÂ§ßÁã¨Á´ãÈõÜ</p><p>Êé•‰∏ãÊù•ÂºÄÂßãÊûÑÈÄ†ÊñπÊ°à</p><ul><li>ÊâæÂà∞ÊãÜÁÇπ‰∫åÂàÜÂõæ‰∏≠Âè≥‰æßÁöÑÊâÄÊúâÈùûÂåπÈÖçÁÇπ</li><li>Áî±Ëøô‰∫õÈùûÂåπÈÖçÁÇπÂá∫ÂèëÔºåÂè≥‰æßÁÇπÂè™Ëµ∞ÈùûÂåπÈÖçËæπÔºåÂ∑¶‰æßÁÇπÂè™Ëµ∞ÂåπÈÖçËæπ</li><li>ÈÇ£‰πà‰∏ÄÁßçÊúÄÂ∞èÁÇπË¶ÜÁõñÁöÑÂêàÊ≥ïÊñπÊ°àÂ∞±ÊòØÂèñÂ∑¶‰æß‰∏≠Ë¢´ $DFS$ Âà∞ÁöÑÁÇπÔºåÂè≥‰æß‰∏≠Ê≤°Ë¢´ $DFS$ Âà∞ÁöÑÁÇπ</li><li>ÈÇ£‰πàËØ•ÊãÜÁÇπ‰∫åÂàÜÂõæÁöÑÊúÄÂ§ßÁã¨Á´ãÈõÜÁöÑ‰∏ÄÁßçÂêàÊ≥ïÊñπÊ°àÊûÑÈÄ†Â∞±ÊòØ‰∏äËø∞ÊûÑÈÄ†ÁöÑË°•ÈõÜ</li></ul><p>ËøôÊ†∑Â∞±Ê±ÇÂá∫‰∫ÜÊúÄÂ∞èË∑ØÂæÑÁÇπË¶ÜÁõñÁöÑ‰∏ÄÁßçÊñπÊ°àÔºåÂç≥ÊúÄÈïøÂèçÈìæÁöÑ‰∏ÄÁßçÊûÑÈÄ†</p><p>ÈÇ£‰πà $\text{Subtask2}$ Â∞±ÂÅöÂÆå‰∫Ü</p><p>ÂØπ $\text{Subtask3}$ÔºåÊûö‰∏æÊØè‰∏™ÁÇπÔºåÂ∞ÜÂÆÉ‰ºöÂà∞ËææÁöÑÁÇπÂíå‰ºöÂà∞ËææÂÆÉÁöÑÁÇπÂà†ÊéâÔºåÂº∫Âà∂ÂÅáÂ¶ÇËØ•ÁÇπÔºåÂÜçË∑ë‰∏ÄÈÅçÊúÄÈïøÂèçÈìæÔºåËã•ÂÖ∂ÂæóÂà∞ÊúÄÈïøÂèçÈìæÈïøÂ∫¶Á≠â‰∫éÂéüÁ≠îÊ°àÂáè‰∏ÄÔºåÂàôËØ¥ÊòéËØ•ÁÇπÂèØ‰ª•Ë¢´ËÆæÁΩÆ‰∏∫ÂèçÈìæ‰∏≠ÁöÑÁÇπ</p><p>ÈÇ£‰πà $\text{Subtask3}$ Â∞±ÂÅöÂÆå‰∫Ü</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">2</span> * MAXN + MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="built_in">bitset</span>&lt;MAXN&gt; g[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, cap, next; &#125; ;</span><br><span class="line">LFS Link[MAXL &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;, size = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].cap = cap;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Insert (x, y, cap); Insert (y, x, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> S, T, _N;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) que.pop();</span><br><span class="line"><span class="built_in">memset</span> (depth, <span class="number">0</span>, <span class="keyword">sizeof</span> (depth));</span><br><span class="line">depth[S] = <span class="number">1</span>, que.push(S);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] || ! cap) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[u] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (v == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cur[MAXL]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> flow)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (p == T) <span class="keyword">return</span> flow;</span><br><span class="line"><span class="keyword">int</span> rest = flow;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> &amp;i = cur[p]; i &amp;&amp; rest; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] != depth[p] + <span class="number">1</span> || ! cap) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> k = Dinic (v, min (cap, rest));</span><br><span class="line"><span class="keyword">if</span> (! k) depth[v] = - <span class="number">1</span>;</span><br><span class="line">Link[i].cap -= k, Link[i ^ <span class="number">1</span>].cap += k;</span><br><span class="line">rest -= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow - rest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">MAXFLOW</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (BFS ()) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= _N; i ++) cur[i] = Head[i];</span><br><span class="line">ret += Dinic (S, INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> match[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Subtask2</span></span><br><span class="line"><span class="keyword">bool</span> tagl[MAXN]= &#123;<span class="literal">false</span>&#125;, tagr[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">tagr[u - N] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][u - N] &amp;&amp; ! tagl[i]) &#123;</span><br><span class="line">tagl[i] = <span class="literal">true</span>;</span><br><span class="line">DFS (match[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Subtask3</span></span><br><span class="line"><span class="keyword">bool</span> del[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">g[u][v] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][k])</span><br><span class="line">g[i] |= g[k];</span><br><span class="line">S = <span class="number">2</span> * N + <span class="number">1</span>, _N = T = <span class="number">2</span> * N + <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">add (S, i, <span class="number">1</span>), add (i + N, T, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][j])</span><br><span class="line">add (i, j + N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> ans = N - MAXFLOW ();</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! Link[<span class="number">4</span> * i - <span class="number">2</span>].cap)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = Head[i]; j; j = Link[j].next)</span><br><span class="line"><span class="keyword">if</span> (! Link[j].cap) &#123;</span><br><span class="line">match[i] = Link[j].to;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (Link[<span class="number">4</span> * i].cap)</span><br><span class="line">DFS (i + N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) <span class="built_in">printf</span> (<span class="string">"%d"</span>, ! tagl[i] &amp;&amp; tagr[i]);</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head)); size = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">memset</span> (del, <span class="literal">false</span>, <span class="keyword">sizeof</span> (del));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (i == j || g[i][j] || g[j][i])</span><br><span class="line">del[j] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! del[i]) &#123;</span><br><span class="line">add (S, i, <span class="number">1</span>), add (i + N, T, <span class="number">1</span>);</span><br><span class="line">m ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! del[i])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][j] &amp;&amp; ! del[j])</span><br><span class="line">add (i, j + N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> ret = m - MAXFLOW ();</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, ret == ans - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ‰∫åÂàÜÂõæ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåCodeforces Round 558 (Div. 2).F„ÄçIndecisive Taxi Fee</title>
      <link href="/2020/08/04/%5BCodeforces%20Round%20#558%20(Div.%202).F%5DIndecisive%20Taxi%20Fee/"/>
      <url>/2020/08/04/%5BCodeforces%20Round%20#558%20(Div.%202).F%5DIndecisive%20Taxi%20Fee/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>È¢òÊÑèÂç≥‰∏∫Â∏¶‰øÆÔºà‰∏¥Êó∂ÔºâÊúÄÁü≠Ë∑Ø</p><p>ÂÖàÈöè‰æøÊèê‰∏ÄÊù°ÊúÄÁü≠Ë∑ØÂá∫Êù•ÔºåÈÇ£‰πà‰øÆÊîπÂèØÂàÜ‰∏∫ÂõõÁßçÊÉÖÂÜµÔºö</p><ul><li>ËØ•ËæπÂú®ÊúÄÁü≠Ë∑Ø‰∏äÔºå‰∏îÊï∞ÂÄºÂèòÂ∞è</li><li>ËØ•ËæπÂú®ÊúÄÁü≠Ë∑Ø‰∏äÔºå‰∏îÊï∞ÂÄºÂèòÂ§ß</li><li>ËØ•ËæπÂú®ÊúÄÁü≠Ë∑ØÂ§ñÔºå‰∏îÊï∞ÂÄºÂèòÂ∞è</li><li>ËØ•ËæπÂú®ÊúÄÁü≠Ë∑ØÂ§ñÔºå‰∏îÊï∞ÂÄºÂèòÂ§ß</li></ul><p>ÈÇ£‰πàÂØπ‰∫éÊÉÖÂÜµ $1, 3, 4$ÔºåÊòæÁÑ∂ÊòØÂçÅÂàÜÂÆπÊòìÂ§ÑÁêÜÁöÑÔºåÈÇ£‰πàÈóÆÈ¢òÂ∞±Âú®ÊÉÖÂÜµ $2$</p><p>ËÆæÊúÄÁü≠Ë∑ØÁªèËøáÁÇπ $e_1, e_2, e_3, ‚Ä¶$</p><p>ËÄÉËôëÂà∞Êñ∞ÁöÑÊúÄÁü≠Ë∑ØÂøÖÂÆö‰∏éÂéüÊúÄÁü≠Ë∑ØÊúâÁõ∏ÂêåÁöÑ‰∏ÄÊÆµÂâçÁºÄ‰∏éÂêéÁºÄÔºàÂèØ‰ª•‰∏∫Á©∫ÔºâÔºåËÆæ $dis2_{i, j} (i &lt; j)$ Ë°®Á§∫‰∏çÁªèËøáË∑ØÂæÑ $e_ie_j$ ÁöÑÊúÄÁü≠Ë∑ØÔºåÊâÄ‰ª•Á≠îÊ°àÂç≥‰∏∫ $\min \{dis2 (e_ie_j) (i &lt; j)\}$</p><p>ÈÇ£‰πà‰æø‰∏§ÈÅç $Dijstra$ ÂàÜÂà´Ê±ÇÂá∫ $1, n$ Âà∞ÊØè‰∏™ÁÇπ $p$ ÁöÑÊúÄÁü≠Ë∑Ø $pre_p, suf_p$ÔºåÂπ∂‰∏îÂØπ‰∫éÊúÄÁü≠Ë∑Ø‰∏äÁöÑÁÇπ $e_i$ÔºåÊ±ÇÂá∫ÂÖ∂Âú®ÊúÄÁü≠Ë∑Ø‰∏äÁöÑÂâçÈ©±Ëæπ $from_{e_i}$ ‰∏éÂêéÁªßËæπ $nxt_{e_i}$ÔºåÂØπ‰∫éÊØè‰∏™‰∏çÂú®ÊúÄÁü≠Ë∑Ø‰∏äÁöÑÁÇπ $p$ÔºåÊ±ÇÂá∫ÁÇπ $1$ Ëá≥ $p$ ‰∏≠ÊúÄÂêé‰∏Ä‰∏™Âú®ÂéüÊúÄÁü≠Ë∑Ø‰∏äÁöÑÁÇπÁöÑÂêéÁªßËæπ $from_p$ ÂèäÁÇπ $p$ Ëá≥ $n$ ‰∏≠Á¨¨‰∏Ä‰∏™Âú®ÂéüÊúÄÁü≠Ë∑Ø‰∏äÁöÑÁÇπÁöÑÂêéÁªßËæπ $nxt_p$ÔºåÊïÖÂØπ‰∫éÊØè‰∏™‰∏çÂú®ÊúÄÁü≠Ë∑Ø‰∏äÁöÑËæπ $(u, v)$ÔºåÂÆÉÂèØ‰ª•ÂØπ $dis2 (from_u, nxt_v - 1), dis2 (from_v, nxt_u - 1)$ ÂÅöË¥°ÁåÆÔºåÁÑ∂ÂêéÁî®Á∫øÊÆµÊ†ëÁª¥Êä§‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><p>Ë¶ÅÊ≥®ÊÑè‰∏ãÂàó‰ª£Á†ÅÂØπ‰∫éÊúÄÁü≠Ë∑Ø‰∏äÁöÑÁÇπ $e_i$ ÂÖ∂ $from_{e_i}$ ÂÆûÈôÖ‰∏äÊòØÂêéÁªßËæπÔºåËøôÊ†∑Â≠ê‰øÆÊîπÁöÑÂå∫Èó¥ÊâçÊòØÂØπÁöÑ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"><span class="keyword">int</span> w, id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].id = id;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> p;</span><br><span class="line">LL dist;</span><br><span class="line"></span><br><span class="line">node (<span class="keyword">int</span> fp = <span class="number">0</span>, LL fdist = <span class="number">0</span>) :</span><br><span class="line">p (fp), dist (fdist) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> dist &gt; p.dist;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">priority_queue&lt;node&gt; heap;</span><br><span class="line">LL dist[<span class="number">3</span>][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> from[MAXN]= &#123;<span class="number">0</span>&#125;, nxt[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> occp[MAXN]= &#123;<span class="literal">false</span>&#125;; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> S)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">dist[p][i] = INF, visit[i] = <span class="literal">false</span>;</span><br><span class="line">dist[p][S] = <span class="number">0</span>, heap.push(node (S, <span class="number">0</span>));</span><br><span class="line"><span class="keyword">while</span> (! heap.empty()) &#123;</span><br><span class="line">node top = heap.top();</span><br><span class="line">heap.pop();</span><br><span class="line"><span class="keyword">int</span> u = top.p;</span><br><span class="line">LL d = top.dist;</span><br><span class="line"><span class="keyword">if</span> (visit[u]) <span class="keyword">continue</span>;</span><br><span class="line">visit[u] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (d + w &lt; dist[p][v]) &#123;</span><br><span class="line">dist[p][v] = d + w;</span><br><span class="line"><span class="keyword">if</span> (p == <span class="number">2</span>) from[v] = i;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (p == <span class="number">0</span> &amp;&amp; ! occp[v]) from[v] = from[u];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (p == <span class="number">1</span> &amp;&amp; ! occp[v]) nxt[v] = nxt[u];</span><br><span class="line">heap.push(node (v, dist[p][v]));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> path[MAXM]= &#123;<span class="number">0</span>&#125;, pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deal</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">1</span>; v != N;) &#123;</span><br><span class="line"><span class="keyword">int</span> ps = Link[from[v]].id;</span><br><span class="line">path[ps] = ++ pcnt, occp[v] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> nxn = Link[from[v] ^ <span class="number">1</span>].to;</span><br><span class="line">from[v] = nxt[v] = pcnt; <span class="comment">// attention</span></span><br><span class="line">v = nxn;</span><br><span class="line">&#125;</span><br><span class="line">occp[N] = <span class="literal">true</span>;</span><br><span class="line">from[N] = nxt[N] = pcnt + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL minv[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">minv[root] = INF;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid), build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R, LL delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> ( L &gt; R) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) &#123;</span><br><span class="line">minv[root] = min (minv[root], delta);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) modify (lson, left, mid, L, R, delta);</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) modify (rson, mid + <span class="number">1</span>, right, L, R, delta);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right)</span><br><span class="line"><span class="keyword">return</span> minv[root];</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) <span class="keyword">return</span> min (minv[root], query (lson, left, mid, posi));</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> min (minv[root], query(rson, mid + <span class="number">1</span>, right, posi));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line"><span class="keyword">int</span> w = getnum ();</span><br><span class="line">Insert (u, v, w, i), Insert (v, u, w, i);</span><br><span class="line">&#125;</span><br><span class="line">Dijkstra (<span class="number">2</span>, N), deal ();</span><br><span class="line">Dijkstra (<span class="number">0</span>, <span class="number">1</span>), Dijkstra (<span class="number">1</span>, N);</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, pcnt);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= size; i += <span class="number">2</span>) &#123;</span><br><span class="line"><span class="keyword">int</span> u = Link[i].to, v = Link[i ^ <span class="number">1</span>].to;</span><br><span class="line"><span class="keyword">int</span> w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (path[Link[i].id]) <span class="keyword">continue</span>;</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, pcnt, from[u], nxt[v] - <span class="number">1</span>, dist[<span class="number">0</span>][u] + dist[<span class="number">1</span>][v] + w);</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, pcnt, from[v], nxt[u] - <span class="number">1</span>, dist[<span class="number">0</span>][v] + dist[<span class="number">1</span>][u] + w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> cur = getnum () &lt;&lt; <span class="number">1</span>, delta = getnum ();</span><br><span class="line"><span class="keyword">int</span> u = Link[cur].to, v = Link[cur ^ <span class="number">1</span>].to;</span><br><span class="line"><span class="keyword">int</span> w = Link[cur].w;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (path[Link[cur].id]) ans = min (dist[<span class="number">0</span>][N] - w + delta, query (<span class="number">1</span>, <span class="number">1</span>, pcnt, path[Link[cur].id]));</span><br><span class="line"><span class="keyword">else</span> ans = min (dist[<span class="number">0</span>][N], min (dist[<span class="number">0</span>][u] + dist[<span class="number">1</span>][v] + delta, dist[<span class="number">0</span>][v] + dist[<span class="number">1</span>][u] + delta));</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%I64d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5 6</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">2 4 3</span></span><br><span class="line"><span class="comment">1 4 7</span></span><br><span class="line"><span class="comment">1 3 1</span></span><br><span class="line"><span class="comment">3 4 5</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">5 1</span></span><br><span class="line"><span class="comment">3 8</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 4 4</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">1 2 3</span></span><br><span class="line"><span class="comment">1 2 4</span></span><br><span class="line"><span class="comment">1 2 5</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">4 3</span></span><br><span class="line"><span class="comment">1 5</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 1 1</span></span><br><span class="line"><span class="comment">1 2 1</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊúÄÁü≠Ë∑Ø </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåCERC2014„ÄçOuter space invaders</title>
      <link href="/2020/08/04/%5BCERC2014%5DOuter%20space%20invaders/"/>
      <url>/2020/08/04/%5BCERC2014%5DOuter%20space%20invaders/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h2><p>ÁªôÂÆö $n$ ‰∏™Á∫øÊÆµÔºåÊØè‰∏™Á∫øÊÆµÊúâ‰∏Ä‰∏™ÊùÉÂÄº $w_i$ÔºåÊØèÊ¨°ÂèñËΩ¥‰∏ä‰∏ÄÁÇπÔºåËé∑ÂæóÁöÑÊùÉÂÄº‰∏∫ÈÄâÊã©ÁöÑË¶ÜÁõñÂú®ÂΩìÂâçÁÇπ‰∏äÁöÑÁ∫øÊÆµÁöÑÊúÄÂ§ßÊùÉÂÄºÔºåÊ±ÇÊúÄÁªàË¶ÜÁõñÊâÄÊúâÁ∫øÊÆµÂêéÈúÄË¶ÅÁöÑÊúÄÂ∞èÊùÉÂÄº</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>Â•ΩÂêßÊòØ‰∏ÄÈÅìÈùûÂ∏∏Ê∞¥ÁöÑÂå∫Èó¥ $dp$ ÁÑ∂ËÄåÊàëÂπ∂Ê≤°ÊúâÊÉ≥Âá∫Êù•ÊâÄ‰ª•ÊàëÊòØÁúüÁöÑÁªùÊúõ</p><p>ÂÖàÊää $l_i, r_i$ Á¶ªÊï£ÂåñÂêé‰ª§ $f_{l, r}$ Ë°®Á§∫<strong>ÂÆåÂÖ®Ë¶ÜÁõñ</strong>Âå∫Èó¥ $[l, r]$ ÁöÑÁ∫øÊÆµÁöÑÊúÄÂ∞èÊùÉÂÄºÔºåËÆæÂÆåÂÖ®Â§Ñ‰∫é $[l, r]$ ÁöÑÁ∫øÊÆµ‰∏≠ÊùÉÂÄºÂèñÊúÄÂ§ßÂÄºÁöÑÁ∫øÊÆµ $p$ÔºåÂàôÊúâËΩ¨ÁßªÊñπÁ®ã<br>$$<br>f_{l, r} = \min \{f_{l, k - 1} + f_{k + 1, r} + w_p\} (l_p \le k \le r_p)<br>$$<br>ÊâÄ‰ª•Ê≥®ÊÑè‰∏ÄÂÆöË¶ÅÂÆåÂÖ®Ë¶ÜÁõñÔºå$[l, k - 1], [k + 1, r]$ Êâç‰∏ç‰ºöÂØπ $[l, r]$ ÈÄ†ÊàêÂΩ±ÂìçÔºå‰∫éÊòØÊàëÂ∞±Âç°ËøôÂÑø‰∫Ü</p><p>Ë∞®‰ª•Ê≠§ÊñáÁ∫™ÂøµÊàëÈÄùÂéªÁöÑÊô∫ÂïÜ</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">600</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> l[MAXN], r[MAXN], value[MAXN];</span><br><span class="line"><span class="keyword">int</span> vcol[MAXN &lt;&lt; <span class="number">1</span>], vcnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line">N = getnum ();</span><br><span class="line">vcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">l[i] = getnum (), r[i] = getnum (), value[i] = getnum ();</span><br><span class="line">vcol[++ vcnt] = l[i], vcol[++ vcnt] = r[i];</span><br><span class="line">&#125;</span><br><span class="line">sort (vcol + <span class="number">1</span>, vcol + vcnt + <span class="number">1</span>);</span><br><span class="line">vcnt = unique (vcol + <span class="number">1</span>, vcol + vcnt + <span class="number">1</span>) - vcol - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">l[i] = lower_bound (vcol + <span class="number">1</span>, vcol + vcnt + <span class="number">1</span>, l[i]) - vcol;</span><br><span class="line">r[i] = lower_bound (vcol + <span class="number">1</span>, vcol + vcnt + <span class="number">1</span>, r[i]) - vcol;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">2</span>; len &lt;= vcnt; len ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= vcnt - len + <span class="number">1</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> j = i + len - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> maxv = - <span class="number">1</span>, sl, sr;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt;= l[k] &amp;&amp; r[k] &lt;= j) <span class="comment">// ÂÆåÂÖ®Ë¶ÜÁõñ</span></span><br><span class="line"><span class="keyword">if</span> (value[k] &gt; maxv) &#123;</span><br><span class="line">maxv = value[k];</span><br><span class="line">sl = l[k], sr = r[k];</span><br><span class="line">&#125;</span><br><span class="line">f[i][j] = maxv == - <span class="number">1</span> ? <span class="number">0</span> : INF;</span><br><span class="line"><span class="keyword">if</span> (maxv != - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = sl; k &lt;= sr; k ++)</span><br><span class="line">f[i][j] = min (f[i][j], f[i][k - <span class="number">1</span>] + f[k + <span class="number">1</span>][j] + maxv);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, f[<span class="number">1</span>][vcnt]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 4 4</span></span><br><span class="line"><span class="comment">4 7 5</span></span><br><span class="line"><span class="comment">3 4 7</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Âå∫Èó¥DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>„ÄåAPIO2013„ÄçÊú∫Âô®‰∫∫</title>
      <link href="/2020/08/04/%5BAPIO2013%5D%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
      <url>/2020/08/04/%5BAPIO2013%5D%E6%9C%BA%E5%99%A8%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>È¶ñÂÖàÂõ†‰∏∫ÁÇπÊï∞‰∏çÂ§öÔºåÂèØ‰ª•ËÄÉËôëÂÖàÂú® $4r \times c$ Êó∂Èó¥ÂÜÖÂ∞ÜÊØè‰∏™ÁÇπÊúùÊØè‰∏™ÊñπÂêëÂèØ‰ª•Âà∞ËææÁöÑ‰ΩçÁΩÆÈ¢ÑÂ§ÑÁêÜÂá∫Êù•ÔºåÂª∫ÊàêÂõæ</p><p>ÈÇ£‰πàÁé∞Âú®ÂÆπÊòìÁúãÂá∫ÊòØÊñØÂù¶ÈÇ£Ê†ëÈóÆÈ¢òÔºåÊâÄ‰ª•ËÄÉËôëÂ∞ÜÈóÆÈ¢òÁÆÄÂåñ‰∏Ä‰∏ãÔºö</p><blockquote><p>Áé∞Âú®ÁªôÂÆö $n$ ‰∏™‰∏çÂêåÁ∫ßÂà´ÁöÑÊú∫Âô®‰∫∫ÔºåÂ∞Ü‰∏§ÊÆµÁ∫ßÂà´ÁöÑÊú∫Âô®‰∫∫ÂêàÂπ∂ÈúÄË¶ÅËä±Ë¥π $c_i$ÔºåÈÇ£‰πàÂ∞ÜÊâÄÊúâÊú∫Âô®‰∫∫ÂêàÂπ∂ÁöÑÊúÄÂ∞èËä±Ë¥πÊòØÂ§öÂ∞ë</p></blockquote><p>Ëøô‰∏™ÈóÆÈ¢òÊòæÁÑ∂‰ΩøÁî®Âå∫Èó¥ $DP$ ÂèØ‰ª•Ëß£ÂÜ≥ÔºåÈÇ£‰πàÊâ©Â±ïÂà∞ÊñØÂù¶ÈÇ£Ê†ë‰∏äÂç≥ÂèØ</p><p>‰ª§ $f[l][r][i]$ Ë°®Á§∫Âå∫Èó¥ $l, r$ ÁöÑÊú∫Âô®‰∫∫ÂêàÂπ∂Âêé‰Ωç‰∫é‰ΩçÁΩÆ $i$ ÁöÑÊúÄÂ∞èËä±Ë¥πÔºåÂàôÊúâ<br>$$<br>f[l][r][i] = \min \{f[l][k][i] + f[k + 1][r][i]\}<br>$$<br>‰ª•Âèä<br>$$<br>f[l][r][i] = \min\limits_{p  link  to  i} \{f[l][r][p] + 1\}<br>$$<br>Á¨¨‰∫å‰∏™ÂºèÂ≠êÁõ¥Êé• $SPFA$ ‰ºöË∂ÖÊó∂</p><p><strong>‰ΩÜÊòØËßÇÂØüÊØèÊù°ËæπÁöÑË¥°ÁåÆÈÉΩ‰∏∫ $1$ÔºåÊâÄ‰ª•ÂèØ‰ª•Â∞Ü $SPFA$ ‰ºòÂåñÊàê $BFS$ ÁöÑÂ§çÊùÇÂ∫¶</strong></p><p>Á±ª‰ººÂ†Ü‰ºòÂåñÁöÑÊÄùÊÉ≥ÔºåÂºÄ‰∏§‰∏™ÈòüÂàóÔºå‰∏Ä‰∏™Â≠òÂàùÂßãÁöÑÁªèËøá $f$ ÊéíÂ∫èÁöÑÁÇπÔºå‰∏Ä‰∏™Â≠òË¢´ÊùæÂºõÁöÑÁÇπÔºåÁî±‰∫éËæπÁöÑÊÄßË¥®Âèä $que1$ ÁªèËøáÊéíÂ∫èÁöÑÂéüÂõ†ÔºåÊâÄ‰ª• $que2$ ‰∏ÄÂÆö‰πüÊòØÊåâ $f$ ÈÄíÂ¢ûÁöÑÔºå‰ªéËÄå‰ºòÂåñÊàê $BFS$ ÁöÑÂ§çÊùÇÂ∫¶</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">9</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">500</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXI = MAXL * MAXL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">4</span> * MAXI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NextX[<span class="number">4</span>]= &#123;- <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, NextY[<span class="number">4</span>]= &#123;<span class="number">0</span>, - <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM];</span><br><span class="line"><span class="keyword">int</span> Head[MAXI]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, R, C;</span><br><span class="line"><span class="keyword">char</span> Map[MAXL][MAXL];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">encode</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (x - <span class="number">1</span>) * C + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fto[MAXL][MAXL][<span class="number">4</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXL][MAXL][<span class="number">4</span>]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">move</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (vis[x][y][k])</span><br><span class="line"><span class="keyword">return</span> fto[x][y][k] = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (fto[x][y][k])</span><br><span class="line"><span class="keyword">return</span> fto[x][y][k];</span><br><span class="line"><span class="keyword">int</span> tx = x + NextX[k], ty = y + NextY[k];</span><br><span class="line">vis[x][y][k] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (Map[tx][ty] == <span class="string">'x'</span>)</span><br><span class="line">fto[x][y][k] = encode (x, y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (Map[tx][ty] == <span class="string">'A'</span>)</span><br><span class="line">fto[x][y][k] = move (tx, ty, (k + <span class="number">1</span>) % <span class="number">4</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (Map[tx][ty] == <span class="string">'C'</span>)</span><br><span class="line">fto[x][y][k] = move (tx, ty, (k + <span class="number">3</span>) % <span class="number">4</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">fto[x][y][k] = move (tx, ty, k);</span><br><span class="line">vis[x][y][k] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> fto[x][y][k];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN][MAXI];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que1, que2;</span><br><span class="line"><span class="keyword">int</span> inque[MAXI]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> buck[MAXI]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> save[MAXI];</span><br><span class="line"><span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fsort</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> limit = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R * C; i ++)</span><br><span class="line"><span class="keyword">if</span> (f[l][r][i] &lt; INF)</span><br><span class="line">limit = max (limit, f[l][r][i]), total ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= limit; i ++)</span><br><span class="line">buck[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R * C; i ++)</span><br><span class="line"><span class="keyword">if</span> (f[l][r][i] &lt; INF)</span><br><span class="line">buck[f[l][r][i]] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= limit; i ++)</span><br><span class="line">buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = R * C; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">if</span> (f[l][r][i] &lt; INF)</span><br><span class="line">save[buck[f[l][r][i]] --] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">fsort (l, r);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= total; i ++)</span><br><span class="line">que1.push(save[i]), inque[save[i]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (! que1.empty() || ! que2.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u;</span><br><span class="line"><span class="keyword">int</span> f1 = ! que1.empty() ? que1.front() : INF;</span><br><span class="line"><span class="keyword">int</span> f2 = ! que2.empty() ? que2.front() : INF;</span><br><span class="line">f1 &lt; f2 ? (u = f1, que1.pop()) : (u = f2, que2.pop());</span><br><span class="line">inque[u] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (f[l][r][u] + <span class="number">1</span> &lt; f[l][r][v]) &#123;</span><br><span class="line">f[l][r][v] = f[l][r][u] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (! inque[v])</span><br><span class="line">que2.push(v), inque[v] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d%d"</span>, &amp; N, &amp; C, &amp; R);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; i ++)</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, Map[i] + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; i ++)</span><br><span class="line">Map[i][<span class="number">0</span>] = Map[i][C + <span class="number">1</span>] = <span class="string">'x'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; j ++)</span><br><span class="line">Map[<span class="number">0</span>][j] = Map[R + <span class="number">1</span>][j] = <span class="string">'x'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (Map[i][j] == <span class="string">'x'</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k ++) &#123;</span><br><span class="line">move (i, j, k);</span><br><span class="line"><span class="keyword">if</span> ((~ fto[i][j][k]) &amp;&amp; fto[i][j][k] != encode (i, j))</span><br><span class="line">Insert (encode (i, j), fto[i][j][k]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span> (f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; j ++)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">isdigit</span> (Map[i][j]))</span><br><span class="line">f[Map[i][j] - <span class="string">'0'</span>][Map[i][j] - <span class="string">'0'</span>][encode (i, j)] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">1</span>; len &lt;= N; len ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= N - len + <span class="number">1</span>; l ++) &#123;</span><br><span class="line"><span class="keyword">int</span> r = l + len - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R * C; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt; r; k ++)</span><br><span class="line">f[l][r][i] = min (f[l][r][i], f[l][k][i] + f[k + <span class="number">1</span>][r][i]);</span><br><span class="line">&#125;</span><br><span class="line">SPFA (l, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R * C; i ++)</span><br><span class="line">ans = min (ans, f[<span class="number">1</span>][N][i]);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans == INF ? - <span class="number">1</span> : ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 10 5</span></span><br><span class="line"><span class="comment">1.........</span></span><br><span class="line"><span class="comment">AA...x4...</span></span><br><span class="line"><span class="comment">..A..x....</span></span><br><span class="line"><span class="comment">2....x....</span></span><br><span class="line"><span class="comment">..C.3.A...</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊñØÂù¶Á∫≥Ê†ë </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nÁÇπÂü∫ÁéØÊ†ë‰∏™Êï∞ÈóÆÈ¢ò</title>
      <link href="/2020/08/04/n%E7%82%B9%E5%9F%BA%E7%8E%AF%E6%A0%91%E4%B8%AA%E6%95%B0%E9%97%AE%E9%A2%98/"/>
      <url>/2020/08/04/n%E7%82%B9%E5%9F%BA%E7%8E%AF%E6%A0%91%E4%B8%AA%E6%95%B0%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ÂØπ‰∫é $n$ ‰∏™ÁÇπÁªÑÊàêÁöÑÁéØÂ§ßÂ∞è‰∏∫ $m$ ÁöÑÂü∫ÁéØÊ†ë‰∏™Êï∞ÁöÑÈóÆÈ¢òÔºåÁõÆÂâçÂ∑≤Áü•‰∏âÁßçËß£Ê≥ï</p><h2 id="Ëß£Ê≥ï‰∏Ä„ÄåÂä®ÊÄÅËßÑÂàí„Äç"><a href="#Ëß£Ê≥ï‰∏Ä„ÄåÂä®ÊÄÅËßÑÂàí„Äç" class="headerlink" title="Ëß£Ê≥ï‰∏Ä„ÄåÂä®ÊÄÅËßÑÂàí„Äç"></a>Ëß£Ê≥ï‰∏Ä„ÄåÂä®ÊÄÅËßÑÂàí„Äç</h2><p>Âú®ÁéØ‰∏äÊØè‰∏™ÁÇπ‰∏ãÈù¢Êê≠Ê†ëÁöÑÊñπÊ°àÊï∞ÔºåÁõ∏ÂΩì‰∫éÊòØÂú®ÂÆåÂÖ®Âõæ‰∏≠Âà∂ÈÄ†ÁîüÊàêÊ†ëÔºåÁÑ∂ÂêéÊèê‰∏Ä‰∏™ÁÇπÔºàÂç≥ÁéØ‰∏äÈÇ£‰∏™ÁÇπÔºâ‰∏∫Ê†πÔºåÊïÖÂèØÁî® $n^{n - 2}$ Êù•ËÆ°ÁÆó</p><p>ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÂæàÂÆπÊòìÊÉ≥Âà∞‰∏ÄÁßçËÉåÂåÖËß£Ê≥ïÔºåÊääÁéØÈöè‰æøÊâæ‰∏™Âú∞ÊñπÊñ≠‰∏Ä‰∏ãÔºåÊääÂÆÉÁúãÊàêÂ∫èÂàóÔºåÂç≥ÂèØ‰ª§ $f_{i, j}$ Ë°®Á§∫ÁéØÂ∫èÂàóÂâç $i$ ‰∏™ÁÇπÔºåÂ∑≤Áªè‰ΩøÁî®‰∫Ü $j$ ‰∏™ÁÇπÂÅöÁéØ‰∏ãÁöÑÊ†ëÁöÑÊñπÊ°àÊï∞ÔºåÊòæÁÑ∂<br>$$<br>f_{i, j} = \sum\limits_{k = 0}^j f_{i - 1, j - k} \times \dbinom{n - m - (j - k)}{k} \cdot (k + 1)^{k - 1}<br>$$<br>ÁÑ∂ÂêéÁ≠îÊ°àË¶ÅÂØπÁéØËøõË°åÂúÜÊéíÂàóÔºåÂç≥ $ans = f_{m, n - m} \times \frac{A_n^m}{2m}$</p><p>Â§çÊùÇÂ∫¶ $O (n^3)$</p><p>ÂΩìÁÑ∂ËøôÊ†∑Â§çÊùÇÂ∫¶ÊØîËæÉÈ´òÔºåÂèØ‰ª•ËÄÉËôëÂ∞ÜÂ∑≤ÁªèÊãºÂ•ΩÁöÑËøûÈÄöÂùóÂíåÂ∑≤ÁªèÊãºÂ•ΩÁöÑ‰∏ÄÊ£µÊ†ëËøûÊé•Ëµ∑Êù•Ôºå‰ª§ $f_n$ Ë°®Á§∫ $n$ ‰∏™ÁÇπÁöÑÁ≠îÊ°à</p><p>ÂΩìÁÑ∂Ôºå‰∏∫‰∫Ü‰øùËØÅ‰∏ç‰ºöÁÆóÈáçÔºåÈúÄË¶ÅÊúâ‰∏Ä‰∏™ÁâπÂæÅÁÇπÔºåÂç≥‰øùËØÅÁÇπ $1$ ‰∏ç‰ºöÂú®ÁéØ‰∏äÔºåÂç≥<br>$$<br>f_n = \frac{n}{n - m}\sum\limits_{i = m}^{n - 1} f_i \times i \cdot (n - i)^{n - i - 2} \cdot \dbinom{n - 1}{i}<br>$$<br>Ê≥®ÊÑèÔºåÂâçÈù¢ÁöÑ $\frac{n}{n - m}$ ÊòØÂõ†‰∏∫Âú®‰Ω†‰ª§ÊØè‰∏™ÁÇπ‰Ωú‰∏∫ÈÇ£‰∏™‰∏çÂú®ÁéØ‰∏äÁöÑÈÇ£‰∏™ÁÇπÁöÑÊó∂ÂÄôÔºåÂÆûÈôÖ‰∏äÂØπ‰∫éÊØè‰∏™ÁÇπÂÆÉ‰ºöË¢´ÂÖ∂ÂÆÉÁÇπ‰Ωú‰∏∫‰∏çÂú®ÁéØ‰∏äÁöÑÁÇπÊó∂ÁÆóÈáç $n - m$ Ê¨°ÔºåÊïÖÈúÄË¶ÅÈô§‰ª• $n - m$</p><p>Â§çÊùÇÂ∫¶ $O (n^2)$</p><h2 id="Ëß£Ê≥ï‰∫å„ÄåpruferÂ∫èÂàó„Äç"><a href="#Ëß£Ê≥ï‰∫å„ÄåpruferÂ∫èÂàó„Äç" class="headerlink" title="Ëß£Ê≥ï‰∫å„ÄåpruferÂ∫èÂàó„Äç"></a>Ëß£Ê≥ï‰∫å„ÄåpruferÂ∫èÂàó„Äç</h2><p>ËÄÉËôëÂú®ÂÅöpruferÂ∫èÂàóÁöÑÊó∂ÂÄôÔºåÂØπ‰∫éÂ∫èÂàóÈïøÂ∫¶Êù•ËÆ≤ÔºåÂ∞ÜÂÖ∂Áº©Êàê‰∏Ä‰∏™ÁÇπÔºåÂç≥Êúâ $n - m + 1$ ‰∏™‰ΩçÁΩÆÔºå‰ΩÜÊòØÂú®ÂÆûÈôÖÊîæÁÇπÁöÑÊó∂ÂÄôÔºåÂç¥Â∫îÂΩìÊòØÊúâ $n$ ÁßçÈÄâÊã©ÔºåÂõ†‰∏∫ÁéØ‰∏ä‰∏çÂêåÁÇπ‰Ωú‰∏∫Áà∂‰∫≤ÁöÑÊÉÖÂÜµÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑÔºåÂç≥Êúâ $n^{n - m - 1}$ ‰∏™‰ΩçÁΩÆÔºåÁÑ∂ÂêéÂÜçÂÅö‰∏ÄÊ¨°ÂúÜÊéíÂàóÔºåÂç≥‰πò‰∏ä $\frac{A_n^m}{2m}$Ôºå‰ΩÜÊòØÂèØ‰ª•ÂèëÁé∞ÁéØÊâÄÁß∞ÁöÑÁÇπ‰Ωú‰∏∫ÈùûÊ†πËäÇÁÇπÔºàÁõ∏ÂØπÊÑè‰πâ‰∏äÔºâÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÈÄâÂÆö‰∏Ä‰∏™ÁéØ‰∏äÁöÑÁÇπ‰Ωú‰∏∫‰∏éÁà∂ËäÇÁÇπËøûÊé•ÁöÑÁÇπÔºåÂç≥ËøòÈúÄË¶Å‰πò‰∏ä $m$</p><p>ÊïÖÊúÄÂêéÁ≠îÊ°à‰∏∫Ôºå$ans = \frac{A_n^m}{2m} \cdot n^{n - m - 1} \cdot m$</p><p>Â§çÊùÇÂ∫¶ $O (n)$</p><h2 id="Ëß£Ê≥ï‰∏â„ÄåÁîüÊàêÂáΩÊï∞„Äç"><a href="#Ëß£Ê≥ï‰∏â„ÄåÁîüÊàêÂáΩÊï∞„Äç" class="headerlink" title="Ëß£Ê≥ï‰∏â„ÄåÁîüÊàêÂáΩÊï∞„Äç"></a>Ëß£Ê≥ï‰∏â„ÄåÁîüÊàêÂáΩÊï∞„Äç</h2><p>ËÄÉËôëÂ∞ÜÂü∫ÁéØÊ†ëÊãÜÂàÜ‰∏∫Ëã•Âπ≤Ê£µÊ†ëÁöÑÊãºÂáë</p><p>Ê≥®ÊÑèÊ≠§Êó∂ÈúÄËÄÉËôëÁöÑÊòØÊúâÊ†πÊ†ëÔºåÂç≥ÂÖàÂ∞ÜËäÇÁÇπÁúã‰ΩúÁªÑÂêàÂØπË±°ÔºåÊ†πÊçÆ $Cayley$ ÂÆöÁêÜÔºå$n$ ‰∏™ËäÇÁÇπÁöÑÂÆåÂÖ®ÂõæÊúâ $n^{n - 1}$ Ê£µÊúâÊ†πÊ†ëÔºåÂàôÊúâÊ†πÊ†ëÁöÑ EGF $T(x)$ ‰∏∫<br>$$<br>T(x) = \sum\limits_{n = 1}^{\infty} n^{n - 1}\frac{x^n}{n!}<br>$$<br>ÈÇ£‰πàÊ≠§Êó∂Â∞ÜÊúâÊ†πÊ†ëÁúã‰ΩúÁªÑÂêàÂØπË±°ÔºåÂàôÂ∞ÜÂÆÉ‰ª¨ÁªÑÊàêÁéØÔºåÂç≥Âü∫ÁéØÊ†ëÁöÑ EGF $G(x)$ ‰∏∫<br>$$<br>\begin{aligned}<br>G(x) &amp;= \frac{1}{2}\sum\limits_{k = 3}^{\infty} \frac{T(x)^k}{k} \\<br>&amp;= - \frac{1}{2}\ln (1 - T(x)) - \sum\limits_{k = 1}^2 \frac{T(x)^k}{k}<br>\end{aligned}<br>$$</p>]]></content>
      
      
      <categories>
          
          <category> ÂΩíÁ∫≥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á∫øÊÄßDP </tag>
            
            <tag> ÁîüÊàêÂáΩÊï∞ </tag>
            
            <tag> pruferÂ∫èÂàó </tag>
            
            <tag> ÂΩíÁ∫≥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NTTÔºàÂø´ÈÄüÊï∞ËÆ∫ÂèòÊç¢Ôºâ</title>
      <link href="/2020/08/04/NTT%EF%BC%88%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2%EF%BC%89/"/>
      <url>/2020/08/04/NTT%EF%BC%88%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Ê¶ÇÂøµÂºïÂÖ•"><a href="#Ê¶ÇÂøµÂºïÂÖ•" class="headerlink" title="Ê¶ÇÂøµÂºïÂÖ•"></a>Ê¶ÇÂøµÂºïÂÖ•</h2><h3 id="Èò∂"><a href="#Èò∂" class="headerlink" title="Èò∂"></a>Èò∂</h3><p>ÂØπ‰∫é$p \in N_+$‰∏î$(a,  p) = 1$ÔºåÊª°Ë∂≥$a^r \equiv 1 (mod  p)$ÁöÑÊúÄÂ∞èÁöÑÈùûË¥ü$r$‰∏∫$a$Ê®°$p$ÊÑè‰πâ‰∏ãÁöÑÈò∂ÔºåËÆ∞‰Ωú$\delta_p(a)$</p><h3 id="ÂéüÊ†π"><a href="#ÂéüÊ†π" class="headerlink" title="ÂéüÊ†π"></a>ÂéüÊ†π</h3><p>ÂÆö‰πâÔºöËã•$p \in N_+$‰∏î$a \in N$ÔºåËã•$\delta_p(a) = \phi(p)$ÔºåÂàôÁß∞$a$‰∏∫Ê®°$p$ÁöÑ‰∏Ä‰∏™ÂéüÊ†π<br>Áõ∏ÂÖ≥ÂÆöÁêÜÔºö</p><ul><li>Ëã•‰∏Ä‰∏™Êï∞$m$Êã•ÊúâÂéüÊ†πÔºåÈÇ£‰πàÂÆÉÂøÖÂÆö‰∏∫$2,  4,  p^t,  2p^t  (p$‰∏∫Â•áË¥®Êï∞$)$ÁöÑÂÖ∂‰∏≠‰∏Ä‰∏™<br>   ÊØè‰∏™Êï∞$p$ÈÉΩÊúâ$\phi(\phi(p))$‰∏™ÂéüÊ†π<br>   „ÄÄ„ÄÄËØÅÊòéÔºöËã•$p \in N_+$‰∏î$(a,  p) = 1$ÔºåÊ≠£Êï¥Êï∞$r$Êª°Ë∂≥$a^r \equiv 1 (mod  p)$ÔºåÈÇ£‰πà$\delta(p) | r$ÔºåÁî±Ê≠§Êé®ÂπøÔºåÂèØÁü•$\delta(p) | \phi(p)$ÔºåÊâÄ‰ª•$p$ÁöÑÂéüÊ†π‰∏™Êï∞Âç≥‰∏∫$p$‰πãÂâç‰∏é$\phi(p)$‰∫íË¥®ÁöÑÊï∞ÔºåÂç≥$\phi(p)$ÊïÖÂÆöÁêÜÊàêÁ´ã<br>   „ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ- Ëã•$g$ÊòØ$m$ÁöÑ‰∏Ä‰∏™ÂéüÊ†πÔºåÂàô$g,  g^1,  g^2,  ‚Ä¶,  g^{\phi(m)} (mod  p)$‰∏§‰∏§‰∏çÂêå<br>   „ÄÄ„ÄÄ„ÄÄ„ÄÄÂéüÊ†πÊ±ÇÊ≥ïÔºö<br>   „ÄÄ„ÄÄÂ∞Ü$\phi(m)$Ë¥®Âõ†Êï∞ÂàÜËß£ÔºåÂæó$\phi(m) = p_1^{c_1} * p_2^{c_2} * ‚Ä¶ * p_k^{c_k}$<br>   „ÄÄ„ÄÄÈÇ£‰πàÊâÄÊúâ$g$Êª°Ë∂≥$g^{\frac{\phi(m)}{p_i}} \neq 1 (mod  m)$Âç≥‰∏∫$m$ÁöÑÂéüÊ†π</li></ul><h2 id="NTT"><a href="#NTT" class="headerlink" title="$NTT$"></a>$NTT$</h2><p>„ÄÄ„ÄÄÁî±‰∫é$FTT$Ê∂âÂèäÂà∞Â§çÊï∞ÁöÑËøêÁÆóÔºåÊâÄ‰ª•Â∏∏Êï∞ÂæàÂ§ßÔºåËÄå$NTT$‰ªÖÈúÄ‰ΩøÁî®ÈïøÊï¥ÂûãÔºåÂèØÂ§ßÂ§ß‰ºòÂåñÂ∏∏Êï∞</p><p>„ÄÄ„ÄÄËÉΩÂ§üÂ∞ÜÂéüÊ†π‰ª£ÊõøÂçï‰ΩçÊ†πËøõË°åËÆ°ÁÆóÔºåÊòØÂõ†‰∏∫ÂÆÉ‰ª¨ÁöÑÊÄßË¥®Áõ∏‰ººÔºåËá≥Â∞ëÂú®Âçï‰ΩçÊ†πÈúÄË¶ÅÁöÑÈÇ£Âá†‰∏™ÊÄßË¥®ÂéüÊ†πÈÉΩÊª°Ë∂≥ÔºåÂΩìÁÑ∂ÔºåË¶ÅËÉΩÂ§üËøõË°å$NTT$ÔºåÈúÄË¶ÅÊª°Ë∂≥Ê®°Êï∞$p$‰∏∫Ë¥®Êï∞Ôºå‰∏î$p = ax + 1$ÂÖ∂‰∏≠$x$‰∏∫$2$ÁöÑÊ¨°ÂπÇÔºåÈÇ£‰πà‰∏ÄËà¨ËÉΩÊª°Ë∂≥Êù°‰ª∂ÁöÑÊï∞ÔºàÂ∏∏Áî®ÔºâÊúâÔºö<br>„ÄÄ„ÄÄ$|            p             |    g     |$</p><p>„ÄÄ„ÄÄ$|    469762049     |    3     |$</p><p>„ÄÄ„ÄÄ$|    998244353     |    3     |$</p><p>„ÄÄ„ÄÄ$|   1004535809    |    3     |$<br>„ÄÄ„ÄÄÈÇ£‰πàÔºåÂ∞±ÂèØ‰ª•Â∞ÜÂçï‰ΩçÊ†π$\omega_n$ÊõøÊç¢‰∏∫$g^{\frac{p - 1}{n}}$ËøõË°å$NTT$‰∫Ü</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = (<span class="number">1</span> &lt;&lt; <span class="number">22</span>);</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    LL cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (p) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">            cnt = cnt * x % MOD;</span><br><span class="line"></span><br><span class="line">        x = x * x % MOD;</span><br><span class="line">        p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN];</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">            swap (a[i], a[oppo[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> ome = power (inv == <span class="number">1</span> ? g : invg, (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome % MOD) &#123;</span><br><span class="line">                LL a1 = a[j + k], xa2 = x * a[j + k + mid] % MOD;</span><br><span class="line">                a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">                a[j + k + mid] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line">        A[i] = (<span class="keyword">int</span>) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">        B[i] = (<span class="keyword">int</span>) getnum ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n, lim = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= N + M; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">        oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line">    limit = n;</span><br><span class="line">    NTT (A, <span class="number">1</span>);</span><br><span class="line">    NTT (B, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">        A[i] = A[i] * B[i] % MOD;</span><br><span class="line">    NTT (A, - <span class="number">1</span>);</span><br><span class="line">    LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i)</span><br><span class="line">            <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d"</span>, (<span class="keyword">int</span>) (A[i] * invn % MOD));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="‰ªªÊÑèÊ®°Êï∞-NTT-Ôºà‰∏âÊ®°Êï∞-NTT-Ê≥ïÔºâ"><a href="#‰ªªÊÑèÊ®°Êï∞-NTT-Ôºà‰∏âÊ®°Êï∞-NTT-Ê≥ïÔºâ" class="headerlink" title="‰ªªÊÑèÊ®°Êï∞$NTT$Ôºà‰∏âÊ®°Êï∞$NTT$Ê≥ïÔºâ"></a>‰ªªÊÑèÊ®°Êï∞$NTT$Ôºà‰∏âÊ®°Êï∞$NTT$Ê≥ïÔºâ</h3><p>ÊúâÂÖ¨Âºè</p><p>$$<br>\left\{\begin{aligned} x \equiv a_1 (mod  m_1) \\ x \equiv a_2 (mod  m_2) \\ x \equiv a_3 (mod  m_3) \end{aligned}\right.<br>$$<br>Áõ¥Êé•‰πò‰ºöÁàÜ$long  long$ÔºåÂ∞±ÂÖàÂ∞Ü‰∏äÈù¢ÁöÑÁî®$CRT$ÂêàÂπ∂ÔºåÂæó</p><p>$$<br>\left\{\begin{aligned} x \equiv A (mod  M) \\ x \equiv a_3 (mod  m_3) \end{aligned}\right.<br>$$<br>ÈÇ£‰πàËÆæ$Ans = kM + A$ÔºåÂàôÊúâ<br>$$<br>\begin{aligned}<br>kM + A &amp;\equiv a_3 \pmod{m_3} \\<br>k &amp;\equiv (a_3 - A)M^{- 1} \pmod{m_3}<br>\end{aligned}<br>$$<br>Áõ¥Êé•Â§ÑÁêÜÂç≥ÂèØ</p><h4 id="‰ª£Á†ÅÔºà‰ªªÊÑèÊ®°Êï∞-NTT-Ôºâ"><a href="#‰ª£Á†ÅÔºà‰ªªÊÑèÊ®°Êï∞-NTT-Ôºâ" class="headerlink" title="‰ª£Á†ÅÔºà‰ªªÊÑèÊ®°Êï∞$NTT$Ôºâ"></a>‰ª£Á†ÅÔºà‰ªªÊÑèÊ®°Êï∞$NTT$Ôºâ</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL MOD[<span class="number">3</span>]= &#123;<span class="number">469762049</span>, <span class="number">998244353</span>, <span class="number">1004535809</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> LL g = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> eps = <span class="number">1e-03</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">multi</span> <span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">    a %= p, b %= p;</span><br><span class="line">    <span class="keyword">return</span> ((a * b - (LL) ((LL) ((<span class="keyword">long</span> <span class="keyword">double</span>) a / p * b + eps) * p)) % p + p) % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, LL p, LL mod)</span> </span>&#123;</span><br><span class="line">    LL cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (p) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">            cnt = cnt * x % mod;</span><br><span class="line"></span><br><span class="line">        x = x * x % mod;</span><br><span class="line">        p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg[<span class="number">3</span>]= &#123;power (g, MOD[<span class="number">0</span>] - <span class="number">2</span>, MOD[<span class="number">0</span>]), power (g, MOD[<span class="number">1</span>] - <span class="number">2</span>, MOD[<span class="number">1</span>]), power (g, MOD[<span class="number">2</span>] - <span class="number">2</span>, MOD[<span class="number">2</span>])&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL P;</span><br><span class="line"></span><br><span class="line">LL A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="keyword">int</span> oppo[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv, <span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">            swap (a[i], a[oppo[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        LL ome = power (inv == <span class="number">1</span> ? g : invg[type], (MOD[type] - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>), MOD[type]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">            LL x = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome % MOD[type]) &#123;</span><br><span class="line">                LL a1 = a[j + k], xa2 = x * a[j + k + mid] % MOD[type];</span><br><span class="line">                a[j + k] = (a1 + xa2) % MOD[type];</span><br><span class="line">                a[j + k + mid] = (a1 - xa2 + MOD[type]) % MOD[type];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL ntta[<span class="number">3</span>][MAXN], nttb[<span class="number">3</span>][MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT_Main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, lim = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= N + M; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">    limit = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">        oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i ++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            ntta[i][j] = A[j];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            nttb[i][j] = B[j];</span><br><span class="line">        NTT (ntta[i], <span class="number">1</span>, i);</span><br><span class="line">        NTT (nttb[i], <span class="number">1</span>, i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            ntta[i][j] = ntta[i][j] * nttb[i][j] % MOD[i];</span><br><span class="line">        NTT (ntta[i], - <span class="number">1</span>, i);</span><br><span class="line">        LL invn = power (n, MOD[i] - <span class="number">2</span>, MOD[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= N + M; j ++)</span><br><span class="line">            ntta[i][j] = ntta[i][j] * invn % MOD[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL ans[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CRT</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    LL m = MOD[<span class="number">0</span>] * MOD[<span class="number">1</span>];</span><br><span class="line">    LL M1 = MOD[<span class="number">1</span>], M2 = MOD[<span class="number">0</span>];</span><br><span class="line">    LL t1 = power (M1, MOD[<span class="number">0</span>] - <span class="number">2</span>, MOD[<span class="number">0</span>]), t2 = power (M2, MOD[<span class="number">1</span>] - <span class="number">2</span>, MOD[<span class="number">1</span>]), invM = power (m % MOD[<span class="number">2</span>], MOD[<span class="number">2</span>] - <span class="number">2</span>, MOD[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line">        LL a1 = ntta[<span class="number">0</span>][i], a2 = ntta[<span class="number">1</span>][i], a3 = ntta[<span class="number">2</span>][i];</span><br><span class="line">        LL A = (multi (a1 * M1 % m, t1 % m, m) + multi (a2 * M2 % m, t2 % m, m)) % m;</span><br><span class="line">        LL k = ((a3 - A % MOD[<span class="number">2</span>]) % MOD[<span class="number">2</span>] + MOD[<span class="number">2</span>]) % MOD[<span class="number">2</span>] * invM % MOD[<span class="number">2</span>];</span><br><span class="line">        ans[i] = ((k % P * (m % P) % P + A % P) % P + P) % P;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum (), P = (LL) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line">        A[i] = (LL) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">        B[i] = (LL) getnum ();</span><br><span class="line"></span><br><span class="line">    NTT_Main ();</span><br><span class="line">    CRT ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i)</span><br><span class="line">            <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld"</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Â§öÈ°πÂºè </tag>
            
            <tag> FFT/NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LOJ6039 - „ÄåÈõÖÁ§ºÈõÜËÆ≠ 2017 Day5„ÄçÁè†ÂÆù „ÄåÈáçÈáèËæÉÂ∞èÁöÑÂ§ßÊï∞ÊçÆ01ËÉåÂåÖ„Äç</title>
      <link href="/2020/08/04/LOJ%206039%20-%20%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD%202017%20Day5%E3%80%8D%E7%8F%A0%E5%AE%9D%20%E3%80%8C%E9%87%8D%E9%87%8F%E8%BE%83%E5%B0%8F%E7%9A%84%E5%A4%A7%E6%95%B0%E6%8D%AE01%E8%83%8C%E5%8C%85%E3%80%8D/"/>
      <url>/2020/08/04/LOJ%206039%20-%20%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD%202017%20Day5%E3%80%8D%E7%8F%A0%E5%AE%9D%20%E3%80%8C%E9%87%8D%E9%87%8F%E8%BE%83%E5%B0%8F%E7%9A%84%E5%A4%A7%E6%95%B0%E6%8D%AE01%E8%83%8C%E5%8C%85%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÁõÆÊèèËø∞"><a href="#È¢òÁõÆÊèèËø∞" class="headerlink" title="È¢òÁõÆÊèèËø∞"></a>È¢òÁõÆÊèèËø∞</h2><p>$01$ ËÉåÂåÖÔºåÊï∞ÊçÆËåÉÂõ¥ $1 \le n \le 1e06, 1 \le weight_i \le 300$</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>Á•û‰ªô $01$ ËÉåÂåÖ</p><p>ËÄÉËôëÈáçÈáèËæÉÂ∞èÔºåÊïÖÂèØ‰ª•ËÄÉËôëÊ†πÊçÆÈáçÈáèÂàÜÂ±ÇÂ§ÑÁêÜ</p><p>‰ª§ $f_{i, j}$ Ë°®Á§∫‰ΩøÁî®Ââç $i$ ‰∏™ÈáçÈáèÔºåÊÄªÂÖ±Ëä±Ë¥π $j$ ÂÆπÈáèÁöÑÊúÄÂ§ß‰ª∑ÂÄº</p><p>ÂÆπÊòìÊ≥®ÊÑèÂà∞Âú®Âêå‰∏ÄÈáçÈáè‰∏≠ÊòæÁÑ∂Ë¶Å‰ºòÂÖàÈÄâÊã©‰ª∑ÂÄºÂ§ßÁöÑÔºåÊïÖÂ∞ÜÊØèÁßçÈáçÈáèÊåâ‰ª∑ÂÄºÊéíÂ∫èÔºå‰ª§ $sumv_{i, j}$ Ë°®Á§∫ÈáçÈáè‰∏∫ $i$ ÁöÑÂâç $j$ Â§ßÁöÑ‰ª∑ÂÄºÂâçÁºÄÂíåÔºåÂàôÊúâ<br>$$<br>f_{i, j} = \max\limits_k \{f_{i - 1, j - ki} + sumv_{i, k}\}<br>$$<br>ÁÑ∂ÂêéÔºàÈÄöËøáÁúãÈ¢òËß£ÔºâÂèØ‰ª•ÂèëÁé∞ÔºåÂõ†‰∏∫ÊòØ $j - ki$ÔºåÊïÖÂèØ‰ª•ËÄÉËôëÊåâÁÖß $j \mod i$ ÂàÜÁ±ªÂ§ÑÁêÜÔºåËøôÊ†∑ÊòØÊª°Ë∂≥ÂÜ≥Á≠ñÂçïË∞ÉÊÄßÁöÑ</p><p>Ëá≥‰∫éËØÅÊòéÔºå‰∏∫‰∫ÜÊñπ‰æøÂèØ‰ª•Â∞ÜÂºèÂ≠êÁÆÄÂåñÊàê $f_i = \max \{f_j +sumv_{i - j}\}$ ÁöÑÂΩ¢ÂºèÔºåÁÑ∂ÂêéÁî®ÂèçËØÅÊ≥ïÊàñÊòØÂõõËæπÂΩ¢‰∏çÁ≠âÂºèÈÉΩÂÆπÊòìËØÅÊòé</p><p>ÈÇ£‰πàÊúÄÂêéÂ∞±ÂèØ‰ª•Áî®ÂÜ≥Á≠ñÂçïË∞ÉÊÄßÁöÑÂ•óË∑Ø‰ª£Á†ÅÊàñËÄÖÊòØÁî®ÂàÜÊ≤ªËß£ÂÜ≥‰∫Ü</p><p>ÂàÜÊ≤ªÊØîËæÉÁÆÄÂçïÔºåÂ§ßÊ¶ÇÂ∞±ÊòØÁúãÂú®Â§ÑÁêÜÂå∫Èó¥ $[u, v]$Ôºå $[l, r]$ ÂÜ≥Á≠ñÂå∫Èó¥ÂÜÖÂØπ‰∫é $mid$ ‰ΩçÁΩÆÂú® $[l, r]$ ‰∏≠ÊúÄÊúâÂÜ≥Á≠ñÂú®Âì™‰∏™‰ΩçÁΩÆÔºåÁÑ∂ÂêéÂ∑¶Âè≥ÈÄíÂΩíÂç≥ÂèØ</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">5e04</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXC = <span class="number">300</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K, C = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; value[MAXC];</span><br><span class="line"><span class="built_in">vector</span>&lt;LL&gt; prefix[MAXC];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; a, <span class="keyword">const</span> <span class="keyword">int</span>&amp; b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL f[MAXC][MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL trans[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function">LL <span class="title">w</span> <span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = (i - j) / s;</span><br><span class="line"><span class="keyword">if</span> (p &gt;= (<span class="keyword">int</span>) prefix[s].size())</span><br><span class="line"><span class="keyword">return</span> - <span class="number">1l</span>l;</span><br><span class="line"><span class="keyword">return</span> f[s - <span class="number">1</span>][j] + prefix[s][p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; <span class="comment">// Â±ÇÊï∞ Â§ÑÁêÜÂå∫Èó¥ ÂÜ≥Á≠ñÂå∫Èó¥</span></span><br><span class="line"><span class="keyword">int</span> mid = (u + v) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">LL maxi = - <span class="number">1</span>, posi = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= min (mid, r); i ++) &#123;</span><br><span class="line">LL cont = w (trans[mid], trans[i], p);</span><br><span class="line"><span class="keyword">if</span> (cont &gt; maxi)</span><br><span class="line">maxi = cont, posi = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (u == v) &#123;</span><br><span class="line">f[p][trans[u]] = maxi;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">solve (p, u, mid, l, posi);</span><br><span class="line">solve (p, mid + <span class="number">1</span>, v, posi, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>)</span><br><span class="line">write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = getnum (), v = getnum ();</span><br><span class="line">C = max (C, c), value[c].push_back(v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= C; i ++) &#123;</span><br><span class="line">sort (value[i].begin(), value[i].end(), comp);</span><br><span class="line">LL sum = <span class="number">0</span>;</span><br><span class="line">prefix[i].push_back(sum);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) value[i].size(); j ++)</span><br><span class="line">sum += value[i][j], prefix[i].push_back(sum);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line">trans[limit = <span class="number">1</span>] = j;</span><br><span class="line"><span class="keyword">while</span> (trans[limit] + i &lt;= K)</span><br><span class="line">limit ++, trans[limit] = trans[limit - <span class="number">1</span>] + i;</span><br><span class="line">solve (i, <span class="number">1</span>, limit, <span class="number">1</span>, limit);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">write (f[C][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 10</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">1 48</span></span><br><span class="line"><span class="comment">3 25</span></span><br><span class="line"><span class="comment">2 76</span></span><br><span class="line"><span class="comment">4 83</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ËÉåÂåÖDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FFTÔºàÂø´ÈÄüÂÇÖÈáåÂè∂ÂèòÊç¢Ôºâ</title>
      <link href="/2020/08/04/FFT%EF%BC%88%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%EF%BC%89/"/>
      <url>/2020/08/04/FFT%EF%BC%88%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Ê¶ÇÂøµÂºïÂÖ•"><a href="#Ê¶ÇÂøµÂºïÂÖ•" class="headerlink" title="Ê¶ÇÂøµÂºïÂÖ•"></a>Ê¶ÇÂøµÂºïÂÖ•</h2><p>„ÄÄ„ÄÄ<strong>- ÁÇπÂÄºË°®Á§∫</strong><br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂØπ‰∫é‰∏Ä‰∏™$n - 1$Ê¨°Â§öÈ°πÂºè$A(x)$ÔºåÂèØ‰ª•ÈÄöËøáÁ°ÆÂÆö$n$‰∏™ÁÇπ‰∏éÂÄºÔºàÂç≥$x$Âíå$y$ÔºâÊù•Ë°®Á§∫ËøôÂîØ‰∏ÄÁöÑ$A(x)$</p><p>„ÄÄ„ÄÄ<strong>- Â§çÊï∞</strong><br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂØπ‰∫é‰∏ÄÂÖÉ‰∫åÊ¨°ÊñπÁ®ã<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄ$$x^2 + 1 = 0$$<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂú®ÂÆûÊï∞ËåÉÂõ¥ÂÜÖÊó†Ëß£ÔºåÈÇ£‰πàÊàë‰ª¨Â∞ÜÂÆûÊï∞ËåÉÂõ¥Êâ©ÂÖÖÔºåÂ∞±ÂæóÂà∞‰∫ÜÂ§çÊï∞ÔºåÂÜç‰ª§$i$‰∏∫ËØ•ÊñπÁ®ãÁöÑËß£ÔºåÂç≥<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄ$$i^2 = - 1$$<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÈÇ£‰πàÂ∞±ÂÆö‰πâ$z = a + bi$ÁöÑÊï∞‰∏∫Â§çÊï∞ÔºåÂàôÊúâ<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂΩì$b = 0$Êó∂Ôºå$z$‰∏∫ÂÆûÊï∞<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂΩì$b \neq 0$Êó∂Ôºå$z$‰∏∫ËôöÊï∞<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂΩì$a = 0  \&amp;\&amp;  b \neq 0$Êó∂Ôºå$z$‰∏∫Á∫ØËôöÊï∞<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂÖ∂‰∏≠ÔºåÂ§çÊï∞Êª°Ë∂≥Âä†Ê≥ï‰∫§Êç¢Âæã„ÄÅÁªìÂêàÂæã„ÄÅ‰πòÊ≥ïÂàÜÈÖçÁéáÁ≠â</p><p>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂ§çÊï∞Áõ∏‰πòÔºö$z_1 = a_1 + b_1i,  z_2 = a_2 + b_2i$ÔºåÂàô$z_1 √ó z_2 = (a_1 + b_1i)(a_2 + b_2i) = (a_1a_2 - b_1b_2) + (a_1b_2 + b_1a_2)i$ÔºåÂÆÉ‰ª¨Áõ∏‰πòËøòÊòØ‰∏Ä‰∏™Â§çÊï∞ÔºåÂú®Â§çÂπ≥Èù¢‰∏äÁêÜËß£ÔºåÂ∞±ÊòØÊ®°ÈïøÁõ∏‰πòÔºåÂπÖËßíÁõ∏Âä†</p><p>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂÖ±ËΩ≠Â§çÊï∞ÔºöÂΩì‰∏§‰∏™Â§çÊï∞ÂÆûÈÉ®Áõ∏ÂêåÔºåËôöÈÉ®‰∏∫Áõ∏ÂèçÊï∞Êó∂Ôºå‰∏§‰∏™Â§çÊï∞Ë¢´Áß∞‰∏∫ÂÖ±ËΩ≠Â§çÊï∞</p><p>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂØπ‰∫é‰∏Ä‰∏™Â§çÊï∞$z = a + bi$ÔºåËøòÂèØ‰ª•Âú®Â§çÊï∞Âπ≥Èù¢‰∏äÁî®ÂêëÈáèË°®Á§∫Âá∫Êù•ÔºåÂç≥Êúâ$\overrightarrow{OZ}$‰∏Ä‰∏ÄÂØπÂ∫îÊØè‰∏™$z = a + bi$ÔºåÈÇ£‰πàÂ∞±ÊúâÂ§çÊï∞ÁöÑÊ®°Á≠â‰∫é$\overline{Z}$ÔºåÂç≥$|z| = \sqrt{a^2 + b^2}$<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄÂ§çÊï∞Áõ¥Êé•ÊØîËæÉÂ§ßÂ∞èÊ≤°ÊúâÊÑè‰πâÔºåÈô§ÈùûÂÆÉÊòØ‰∏Ä‰∏™ÂÆûÊï∞</p><h3 id="FFT-‰ΩúÁî®"><a href="#FFT-‰ΩúÁî®" class="headerlink" title="$FFT$‰ΩúÁî®"></a>$FFT$‰ΩúÁî®</h3><p>„ÄÄ„ÄÄÈÇ£‰πàÔºåÊúâ‰∫ÜÁÇπÂÄºË°®Á§∫ÔºåÂØπ‰∫éÂ§öÈ°πÂºè$A(x)$Âíå$B(x)$Áõ∏‰πòÔºåÂ∞±‰∏çÈúÄË¶Å$O(n^2)$ÔºåËÄåÂè™ÈúÄË¶Å$O(n)$ÔºåÂõ†‰∏∫$C(x_i) = A(x_i) * B(x_i)$ÔºåÁÑ∂ÂêéÊûö‰∏æ$x_i$Âç≥ÂèØ<br>„ÄÄ„ÄÄ‰∫éÊòØÁé∞Âú®ÁöÑÂ§çÊùÇÂ∫¶ÁóáÁªìÂ∞±Âú®‰∫éÂ∞ÜÂ§öÈ°πÂºèËΩ¨ÂåñÊàêÁÇπÂÄºË°®Á§∫ÁöÑ$O(n^2)$‰∫ÜÔºå‰∫éÊòØÂ∞±Êúâ$FFT$ÔºåÂèØ‰ª•ÂÆûÁé∞Âú®$O(n  logn)$ÁöÑÊó∂Èó¥ÂÜÖËΩ¨Âåñ</p><h3 id="Á¶ªÊï£ÂÇÖÈáåÂè∂ÂèòÊç¢"><a href="#Á¶ªÊï£ÂÇÖÈáåÂè∂ÂèòÊç¢" class="headerlink" title="Á¶ªÊï£ÂÇÖÈáåÂè∂ÂèòÊç¢"></a>Á¶ªÊï£ÂÇÖÈáåÂè∂ÂèòÊç¢</h3><p>„ÄÄ„ÄÄ‰∫éÊòØÂÇÖÈáåÂè∂ËßÑÂÆöÔºåÁÇπÂÄº‰∏≠ÁöÑ$x$‰∏∫Ê®°Èïø‰∏∫$1$ÁöÑÂ§çÊï∞<br>„ÄÄ„ÄÄËá≥‰∫é‰∏∫‰ªÄ‰πàË¶ÅÂèñÂ§çÊï∞ËÄå‰∏çÊòØÂÆûÊï∞ÔºåÂõ†‰∏∫ÂÆÉÊúâÂæàÁ•ûÂ•áÁöÑÊÄßË¥®<br>„ÄÄ„ÄÄÈÇ£‰πàÂØπ‰∫éËøô$n$‰∏™Â§çÊï∞ÁöÑÂèñÊ≥ïÔºåÂèñÁöÑÊòØÂ§çÂπ≥Èù¢‰∏äÂçäÂæÑ‰∏∫$1$ÁöÑ‰∏Ä‰∏™ÂúÜÔºåÂ∞ÜÂÖ∂$n$Á≠âÂàÜÂêéÂæóÂà∞ÁöÑÁÇπÔºå‰ª§Á¨¨$i$‰∏™ÁÇπË°®Á§∫‰∏∫$\omega_n^k(0 \le k \le n - 1)$ÔºåÈÇ£‰πàËøô‰∏™ÁÇπÂú®Â§çÂπ≥Èù¢‰∏≠ÁöÑË°®Á§∫Âç≥‰∏∫$(cos\frac{k}{n}2\pi,  sin\frac{k}{n}2\pi)$ÔºåÈÇ£‰πàÊ†πÊçÆÂ§çÊï∞‰πòÊ≥ïÂú®Â§çÂπ≥Èù¢‰∏äÁöÑÊÑè‰πâ‰∏∫Ê®°ÈïøÁõ∏‰πòÔºåÂπÖÈïøÁõ∏Âä†ÔºåÂç≥$\omega_n^k$Áõ∏ÂΩì‰∫é$(\omega_n^1)^k$ÔºåÈÇ£‰πàÁß∞$\omega_n^1$‰∏∫Âçï‰ΩçÊ†π<br>„ÄÄ„ÄÄÊàë‰ª¨Â∞±ÊääËøô$\omega_n^0,  \omega_n^1,  ‚Ä¶,  \omega_n^{n - 1}$‰Ωú‰∏∫ÁÇπÂÄºË°®Á§∫ÁöÑ$x$ÔºåÁß∞‰ΩúÁ¶ªÊï£ÂÇÖÈáåÂè∂ÂèòÊç¢ÁöÑÁªìÊûú<br>„ÄÄ„ÄÄÂÖàÁªôÂá∫ÂÖ≥‰∫éÂÇÖÈáåÂè∂ÈÄÜÂèòÊç¢ÁöÑÁªìËÆ∫Ôºö<br>„ÄÄ„ÄÄ„ÄÄ„ÄÄ- Â∞ÜÂ§öÈ°πÂºè$A(x)$ÁöÑÁ¶ªÊï£ÂÇÖÈáåÂè∂ÂèòÊç¢ÁªìÊûú‰Ωú‰∏∫Á≥ªÊï∞‰ª£ÂÖ•Â§öÈ°πÂºè$B(x)$ÔºåÂÜçÂ∞ÜÊØè‰∏™Á¶ªÊï£ÂÇÖÈáåÂè∂ÂèòÊç¢ÁªìÊûúÁöÑÂÄíÊï∞ÔºåÂç≥$\omega_n^0,  \omega_n^{- 1},  ‚Ä¶,  \omega_n^{- (n - 1)}$‰Ωú‰∏∫$x$‰ª£ÂÖ•$B(x)$ÂæóÂà∞ÁÇπÂÄºË°®Á§∫ÔºåÈÇ£‰πàËøô‰∫õË°®Á§∫Èô§‰ª•$n$Â∞±ÂæóÂà∞‰∫Ü$A(x)$ÁöÑÂéüÁ≥ªÊï∞ [Ëá≥‰∫éËØÅÊòéÔºö‰∏çÂ≠òÂú®ÁöÑ]<br>„ÄÄ„ÄÄËøôÂ∞±ÊòØÂÇÖÈáåÂè∂ÂèòÊç¢Á•ûÂ•áÁöÑÊÄßË¥®</p><h2 id="FFT"><a href="#FFT" class="headerlink" title="$FFT$"></a>$FFT$</h2><p>„ÄÄ„ÄÄÊúâ‰∫ÜÂÇÖÈáåÂè∂ÂèòÊç¢ÔºåËôΩÁÑ∂Â§öÈ°πÂºè‰∏éÁÇπÂÄºË°®Á§∫Áõ∏‰∫íËΩ¨ÂåñÂ∑≤ÁªèÂæàËΩªÊùæ‰∫ÜÔºå‰ΩÜÊòØÂ§çÊùÇÂ∫¶‰ªçÁÑ∂‰∏çÁêÜÊÉ≥ÔºåÂ∞±Êúâ‰∫ÜÂø´ÈÄüÂÇÖÈáåÂè∂ÂèòÊç¢<br>„ÄÄ„ÄÄÁªìËÆ∫Ôºö</p><ul><li>$\omega_{2n}^{2k} = \omega_n^k$ [ËØÅÊòéÔºö‰ª£ËøõÂéüÂÖ¨ÂºèÊòæÁÑ∂]<ul><li>$\omega_n^{k + \frac{n}{2}} = - \omega_n^k$ [ËØÅÊòéÔºöÂÖ≥‰∫éÂ§çÂπ≥Èù¢ÂéüÁÇπ‰∏≠ÂøÉÂØπÁß∞]<br>  ÂØπ‰∫éÂ§öÈ°πÂºè$A(x) = \sum\limits_{i = 0}^{n - 1} a_ix^i$ÔºåÂ∞ÜÂÆÉÁöÑÂ•áÂÅ∂È°πÊãÜÂºÄÔºåÂπ∂Â∞Ü$x$ËΩ¨‰∏∫$x^2$ÂæóÂà∞ÔºàÊ≠§Â§ÑÂÖàÂÅáÂÆö$n$‰∏∫ÂÅ∂Êï∞Ôºâ</li></ul></li></ul><p>$$<br>N(x) = a_0 + a_2x + a_4x^2 + ‚Ä¶ + a_{n - 2}x^{\frac{n}{2} - 1} \\<br>M(x) = a_1 + a_3x + a_5x^2 + ‚Ä¶ + a_{n - 1}x^{\frac{n}{2} - 1}<br>$$</p><p>„ÄÄ„ÄÄ    ÂΩìÁÑ∂Ê≠§Êó∂‰ª£ÂÖ•ÁöÑÊòØ$N(x^2),  M(x^2)$ÔºåÂàôÊúâ</p><p>$$<br>A(x) = N(x^2) + xM(x^2)<br>$$<br>‚Äã    „ÄÄ„ÄÄÊ≠§Êó∂Â∞±ÈúÄË¶ÅÊää$\omega_n^k$‰ª£ÂÖ•ÔºåÂàÜÊÉÖÂÜµËÆ®ËÆ∫Ôºö<br>„ÄÄ„ÄÄ    Ëã•$k &lt; \frac{n}{2}$ÔºåÂàôÊúâ<br>$$<br>\begin{aligned}<br>A(\omega_n^k) &amp;= N(\omega_n^{2k}) + \omega_n^kM(\omega_n^{2k}) \\<br>&amp;= N(\omega_{\frac{n}{2}}^k) + \omega_n^kM(\omega_{\frac{n}{2}}^k)<br>\end{aligned}<br>$$</p><p>‚Äã    „ÄÄ„ÄÄÂèç‰πã</p><p>$$<br>\begin{aligned}<br>A(\omega_n^k) &amp;= N(\omega_n^{2k + n}) + \omega_n^{k + \frac{n}{2}}M(\omega_n^{2k + n}) \\<br>&amp;= N(\omega_n^{2k} √ó \omega_n^n) + \omega_n^{k + \frac{n}{2}}M(\omega_n^{2k} √ó \omega_n^n)ÔºàËøô‰∏ÄÊ≠•ÊòØÈÄöËøáÂ§çÊï∞‰πòÊ≥ïÂ§çÂπ≥Èù¢‰∏äÁöÑÊÑè‰πâÂåñÁÆÄÁöÑÔºâ \\<br>&amp;= N(\omega_{\frac{n}{2}}^k) - \omega_n^kM(\omega_{\frac{n}{2}}^k)<br>\end{aligned}<br>$$</p><p>„ÄÄ„ÄÄ‰∫éÊòØÔºåÊàë‰ª¨Âè™Ë¶ÅÊ±ÇÂæó$\{\omega_{\frac{n}{2}}^0,  \omega_{\frac{n}{2}}^1,  ‚Ä¶,  \omega_{\frac{n}{2}}^{\frac{n}{2} - 1}\}$ÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞$A(x)$ÁöÑÊâÄÊúâÂÖ≥‰∫éÊâÄÊúâÁ¶ªÊï£ÂÇÖÈáåÂè∂ÂèòÊç¢ÁªìÊûúÁöÑÁÇπÂÄºË°®Á§∫‰∫ÜÔºåÂèØÁî®ÂàÜÊ≤ªÂÆûÁé∞ÔºåÂ§çÊùÇÂ∫¶$O(n  logn)$</p><h3 id="‰ª£Á†ÅÔºàÂàÜÊ≤ªFFTÔºâ"><a href="#‰ª£Á†ÅÔºàÂàÜÊ≤ªFFTÔºâ" class="headerlink" title="‰ª£Á†ÅÔºàÂàÜÊ≤ªFFTÔºâ"></a>‰ª£Á†ÅÔºàÂàÜÊ≤ªFFTÔºâ</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span> (- <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mcomplex</span> &#123;</span></span><br><span class="line"><span class="keyword">double</span> x, y;</span><br><span class="line"></span><br><span class="line">mcomplex () &#123;&#125;</span><br><span class="line">mcomplex (<span class="keyword">double</span> fx, <span class="keyword">double</span> fy) :</span><br><span class="line">x (fx), y (fy) &#123;&#125;</span><br><span class="line"></span><br><span class="line">mcomplex <span class="keyword">operator</span> + (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (x + p.x, y + p.y);</span><br><span class="line">&#125;</span><br><span class="line">mcomplex <span class="keyword">operator</span> - (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (x - p.x, y - p.y);</span><br><span class="line">&#125;</span><br><span class="line">mcomplex <span class="keyword">operator</span> * (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (x * p.x - y * p.y, x * p.y + y * p.x);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function">mcomplex <span class="title">omega</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (<span class="built_in">cos</span> (<span class="number">2.0</span> * PI * (<span class="keyword">double</span>) k / (<span class="keyword">double</span>) n), <span class="number">1.0</span> * inv * <span class="built_in">sin</span> (<span class="number">2.0</span> * PI * (<span class="keyword">double</span>) k / (<span class="keyword">double</span>) n));</span><br><span class="line">&#125;</span><br><span class="line">mcomplex A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span> <span class="params">(mcomplex* a, <span class="keyword">int</span> n, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">mcomplex a1[n &gt;&gt; <span class="number">1</span>], a2[n &gt;&gt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> m = n &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i += <span class="number">2</span>) &#123;</span><br><span class="line">a1[i &gt;&gt; <span class="number">1</span>] = a[i];</span><br><span class="line">a2[i &gt;&gt; <span class="number">1</span>] = a[i + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">FFT (a1, m, inv);</span><br><span class="line">FFT (a2, m, inv);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i ++) &#123;</span><br><span class="line">mcomplex x = omega (n, i, inv);</span><br><span class="line">a[i] = a1[i] + x * a2[i];</span><br><span class="line">a[i + m] = a1[i] - x * a2[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line">A[i].x = (<span class="keyword">double</span>) getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">B[i].x = (<span class="keyword">double</span>) getnum ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= N + M; n &lt;&lt;= <span class="number">1</span>);</span><br><span class="line">FFT (A, n, <span class="number">1</span>);</span><br><span class="line">FFT (B, n, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">A[i] = A[i] * B[i];</span><br><span class="line">FFT (A, n, - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i)</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, (<span class="keyword">int</span>) (A[i].x / n + <span class="number">0.5</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Ëù¥Ëù∂Êìç‰Ωú"><a href="#Ëù¥Ëù∂Êìç‰Ωú" class="headerlink" title="Ëù¥Ëù∂Êìç‰Ωú"></a>Ëù¥Ëù∂Êìç‰Ωú</h3><p>„ÄÄ„ÄÄ‰∫éÊòØËøôÊ†∑ËøòÊòØ‰ºöË∂ÖÊó∂ÔºåÈÇ£‰πàËøòÈúÄË¶Å‰ºòÂåñ<br>„ÄÄ„ÄÄÊ†πÊçÆË°®Ê†ºÔºåÊúâ‰∏Ä‰∏™ËÄÉÁúºÂäõÁöÑÊÄßË¥®<br>„ÄÄ„ÄÄ$|0  1  2  3|$<br>„ÄÄ„ÄÄ$|0  2 | 1  3|$<br>„ÄÄ„ÄÄ$|0 | 2 | 1 | 3|$<br>„ÄÄ„ÄÄ‰ºöÂèëÁé∞ÊØè‰∏™Êï∞Â≠óÁöÑÁõÆÊ†á‰ΩçÁΩÆÁöÑ‰∫åËøõÂà∂ÊòØÂéüÊï∞ÁöÑ‰∫åËøõÂà∂ÁøªËΩ¨ÁöÑÁªìÊûúÔºåÊØîÂ¶Ç$1 = (01)_2,  2 = (10)_2$ÊÅ∞Â•ΩÊòØÁõ∏ÂØπÂ∫îÁöÑÔºå‰∫éÊòØÂ∞±ÂèØ‰ª•Ê†πÊçÆËøô‰∏™ÊÄßË¥®ÂÖàÂ∞ÜÊØè‰∏™Êï∞ÊéíÂàóÂà∞ÊúÄÁªà‰ΩçÁΩÆÔºåÂÜçÈÄê‰∏ÄÂêàÂπ∂</p><h4 id="‰ª£Á†ÅÔºàËø≠‰ª£‰ºòÂåñ-FFT-Ôºâ"><a href="#‰ª£Á†ÅÔºàËø≠‰ª£‰ºòÂåñ-FFT-Ôºâ" class="headerlink" title="‰ª£Á†ÅÔºàËø≠‰ª£‰ºòÂåñ$FFT$Ôºâ"></a>‰ª£Á†ÅÔºàËø≠‰ª£‰ºòÂåñ$FFT$Ôºâ</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = (<span class="number">1</span> &lt;&lt; <span class="number">22</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span> (- <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mcomplex</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line"></span><br><span class="line">    mcomplex () &#123;&#125;</span><br><span class="line">    mcomplex (<span class="keyword">double</span> fx, <span class="keyword">double</span> fy) :</span><br><span class="line">        x (fx), y (fy) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    mcomplex <span class="keyword">operator</span> + (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mcomplex (x + p.x, y + p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    mcomplex <span class="keyword">operator</span> - (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mcomplex (x - p.x, y - p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    mcomplex <span class="keyword">operator</span> * (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mcomplex (x * p.x - y * p.y, x * p.y + y * p.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function">mcomplex <span class="title">omega</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mcomplex (<span class="built_in">cos</span> (<span class="number">2.0</span> * PI * (<span class="keyword">double</span>) k / (<span class="keyword">double</span>) n), <span class="number">1.0</span> * inv * <span class="built_in">sin</span> (<span class="number">2.0</span> * PI * (<span class="keyword">double</span>) k / (<span class="keyword">double</span>) n));</span><br><span class="line">&#125;</span><br><span class="line">mcomplex A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN];</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span> <span class="params">(mcomplex* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">            swap (a[i], a[oppo[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        mcomplex ome = mcomplex (<span class="built_in">cos</span> (PI / (<span class="keyword">double</span>) mid), inv * <span class="built_in">sin</span> (PI / (<span class="keyword">double</span>) mid));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">            mcomplex x = mcomplex (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome) &#123;</span><br><span class="line">                mcomplex a1 = a[j + k], xa2 = x * a[j + k + mid];</span><br><span class="line">                a[j + k] = a1 + xa2;</span><br><span class="line">                a[j + k + mid] = a1 - xa2;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line">        A[i].x = (<span class="keyword">double</span>) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">        B[i].x = (<span class="keyword">double</span>) getnum ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n, lim = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= N + M; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">        oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line">    limit = n;</span><br><span class="line">    FFT (A, <span class="number">1</span>);</span><br><span class="line">    FFT (B, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">        A[i] = A[i] * B[i];</span><br><span class="line">    FFT (A, - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i)</span><br><span class="line">            <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d"</span>, (<span class="keyword">int</span>) (A[i].x / n + <span class="number">0.5</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h2><p>„ÄÄ„ÄÄËøôÊ†∑ÁöÑ$FFT$ÂèØ‰ª•Âú®$O(n  logn)$ÁöÑÊó∂Èó¥ÂÜÖÊ±ÇÂá∫Â§öÈ°πÂºè‰πòÊ≥ïÁöÑÂêÑÈ°πÁ≥ªÊï∞Ôºå‰∏ªË¶ÅÊµÅÁ®ãÔºöÂ∞Ü‰∏§‰∏™Â§öÈ°πÂºèÂàÜÂà´ËΩ¨ÂåñÊàêÁÇπÂÄºË°®Á§∫ $\dashrightarrow$ ÈÄöËøáÁÇπÂÄºË°®Á§∫Â∞Ü‰∏§‰∏™Â§öÈ°πÂºèÂêàÂπ∂ $\dashrightarrow$ ÈÄöËøáÁ¶ªÊï£ÂÇÖÈáåÂè∂ÈÄÜÂèòÊç¢Â∞ÜÁÇπÂÄºË°®Á§∫ËΩ¨ÂåñÊàêÁ≥ªÊï∞Ë°®Á§∫ÔºåÂç≥ÂæóËß£</p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><p><a href="https://www.cnblogs.com/RabbitHu/p/FFT.html" target="_blank" rel="noopener">[Â∞èÂ≠¶ÁîüÈÉΩËÉΩÁúãÊáÇÁöÑFFTÔºÅÔºÅÔºÅ]</a></p><p><a href="https://www.cnblogs.com/zwfymqz/p/8244902.html" target="_blank" rel="noopener">[Âø´ÈÄüÂÇÖÈáåÂè∂ÂèòÊç¢(FFT)ËØ¶Ëß£]</a></p><p><a href="https://blog.csdn.net/qq_39670434/article/details/79678103" target="_blank" rel="noopener">[Â§çÊï∞‚Äî‚ÄîÊ¶ÇÂøµÂíå‰ª£Êï∞ËøêÁÆó]</a></p>]]></content>
      
      
      <categories>
          
          <category> ÁÆóÊ≥ï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Â§öÈ°πÂºè </tag>
            
            <tag> FFT/NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF917D Stranger Trees</title>
      <link href="/2020/08/04/CF917D%20Stranger%20Trees/"/>
      <url>/2020/08/04/CF917D%20Stranger%20Trees/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Solution-‚Ö†"><a href="#Solution-‚Ö†" class="headerlink" title="Solution ‚Ö†"></a>Solution ‚Ö†</h2><p>‰∏ÄÈÅìÊúâÁÇπÊúâË∂£ÁöÑÊ†ëÂΩ¢ $dp$ + ÂÆπÊñ•ÔºåÂèçÊ≠£Áªï‰∫ÜÊàëÂçäÂ§©ÔºåËøô‰πàÁ•û‰ªôÊàë‰πü‰∏çÂèØËÉΩÂÜôÂá∫Êù•</p><p>È¶ñÂÖàËÄÉËôëÂü∫Êú¨ÊÄùË∑ØÔºåÁõ¥Êé•Ê±ÇËß£ÊÅ∞Â•Ω $k$ ‰∏™ËæÉÈöæÔºåÊïÖËÄÉËôëÂÖàÊ±ÇËß£Â§ß‰∫éÁ≠â‰∫é $k$ ÁöÑÁõ∏‰ººÂ∫¶ÁöÑÊñπÊ°àÊï∞ÔºåÁÑ∂ÂêéÂÜçÂÆπÊñ•</p><p>ËÄÉËôëÈÄâÂÆö‰∫ÜÂøÖÈÄâÁöÑËã•Âπ≤Êù°ËæπÂêéËÆ°ÁÆóÊñπÊ°àÊï∞„ÄÇÊòæÁÑ∂Ê≠§Êó∂Êï¥‰∏™ÂõæË¢´ÂàÜÊàê‰∫ÜËã•Âπ≤ËøûÈÄöÂùóÔºåÂÅáËÆæÊúâ $k$ ‰∏™ËøûÈÄöÂùóÔºåÂ∞ÜËøûÈÄöÂùóÁº©ÁÇπÔºåËÄÉËôëÂÆÉ‰ª¨ÂèØ‰ª•ÁªÑÊàêÁöÑÊ†ëÁöÑÊñπÊ°àÊï∞ÔºåÊú¨Êù•Â∫îËØ•ÊòØ $k^{k - 2}$ÔºåÁÑ∂ËÄåÂØπ‰∫éÊØè‰∏™ËøûÈÄöÂùóÁöÑÁº©ÁÇπÔºåÂÆÉÂèØ‰ª•ÂêëÂÖ∂ÂÆÉËøûÈÄöÂùó‰∏≠ÂåÖÂê´ÁöÑ‰ªªÊÑè‰∏ÄÁÇπËøûÊé•Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂú® purfer Â∫èÂàó‰∏≠ÔºåÂ∫îÂΩìËÄÉËôëËøûÈÄöÂùóÂÜÖÁöÑÁÇπÁºñÂè∑Âú®Â∫èÂàó‰∏≠ÁöÑÂá∫Áé∞ÊÉÖÂÜµÔºåËÄå‰∏çÊòØ‰ªÖ‰ªÖËÄÉËôëËøûÈÄöÂùóÁºñÂè∑Âá∫Áé∞Âú®Â∫èÂàó‰∏≠ÔºåÊïÖ prufer Â∫èÂàó‰∏≠ÁöÑÊØè‰∏™‰ΩçÁΩÆÂèØ‰ª•Â°´ $n$ ‰∏™Êï∞ÔºåÂç≥ $n^{k - 2}$ÔºåÁÑ∂ËÄåËÄÉËôë‰∫ÜÁà∂‰∫≤ÔºåËøòÈúÄË¶ÅËÄÉËôëÂÑøÂ≠êÔºå‰Ωú‰∏∫Âè∂Â≠êËäÇÁÇπÁöÑÁº©ÁÇπÂêéÁöÑËøûÈÄöÂùóÔºåÂêåÊ†∑ÁöÑÈáåÈù¢‰πüÊòØ‰ªªÊÑèÁÇπÂêëÂ§ñËøûËæπÔºåÊïÖËøòÈúÄ‰πò‰∏ä $\prod size_i$ÔºåÂÖ∂‰∏≠Ôºå$size_i$ ‰∏∫ËøûÈÄöÂùó $i$ ÁöÑÂ§ßÂ∞èÔºåÈÇ£‰πàÁªº‰∏äÔºåÂØπ‰∫é‰∏Ä‰∏™Â≠òÂú® $k$ ‰∏™ËøûÈÄöÂùóÁöÑÂõæÔºåÂÖ∂ÊûÑÈÄ†ÁöÑÁîüÊàêÊ†ëÁöÑÊñπÊ°àÊï∞‰∏∫ $n^{k - 2} \times \prod size_i$</p><p>ÈÇ£‰πàÁé∞Âú®ËÄÉËôëÊ±ÇËß£ $\prod size_i$Ôºå‰ΩøÁî®Ê†ëÂΩ¢ $dp$ Ê±ÇËß£</p><p>‰ª§ $f_{root, i, j}$ Ë°®Á§∫‰ª• $root$ ‰∏∫Ê†πÔºåÊÄªËÆ° $j$ ‰∏™ËøûÈÄöÂùóÔºå$root$ ÊâÄÂú®ÁöÑËøûÈÄöÂùóÂ§ßÂ∞è‰∏∫ $j$ ÁöÑÊñπÊ°àÊï∞ÔºåÈÇ£‰πàÂØπ‰∫é $root$ ÁöÑÊØè‰∏™ÂÑøÂ≠êÊúâÈÄâÊàñ‰∏çÈÄâÁöÑ‰∏§ÁßçÊÉÖÂÜµÔºåÊûö‰∏æÂÖ∂ÂÑøÂ≠ê $son$ ÁöÑËøûÈÄöÂùó‰∏™Êï∞ $k$ Âèä $son$ ÊâÄÂú®ËøûÈÄöÂùóÂ§ßÂ∞è $l$Ôºö</p><ul><li>ÈÄâÔºö$f_{root, i + k - 1, j + l} += f_{root, i, j} \times f_{son, k, l}$</li><li>‰∏çÈÄâÔºö$f_{root, i + k, j} = f_{root, i, j} \times f_{son, k, l} \times l$</li></ul><p>Ê≥®ÊÑèÊØèÊ¨°ÁöÑ $\times size_i$ ÊòØÂú®Êï¥‰∏™ËøûÈÄöÂùó $i$ Â∑≤ÁªèÁ°ÆÂÆö‰∏ãÊù•ÁöÑÊó∂ÂÄôÊâçËÉΩ‰πòÔºåÊïÖÂú®ÂÖ∂Áà∂‰∫≤Êâ´ÊèèÂà∞ÂΩìÂâçËäÇÁÇπÁöÑÊó∂ÂÄôÊâç‰πò‰∏äÂÖ∂ÊâÄÂú®ËøûÈÄöÂùóÂ§ßÂ∞è</p><p>ÂÜçÁªôÂá∫ $g_i = \sum\limits_{i = 1}^n\sum\limits_{j = 1}^{n - i + 1} n^{i - 2}f_{1, i, j} \times j$</p><p>Ê≥®ÊÑèÊ≠§Êó∂ÁöÑ $g_k$ Âπ∂‰∏çÊòØ‰∏•Ê†ºÊÑè‰πâ‰∏äÁöÑÂ§ß‰∫éÁ≠â‰∫é $k$ ÁöÑÁõ∏‰ººÂ∫¶ÁöÑÁ≠îÊ°àÔºåËÄåÊòØÂØπ‰∫éÊØè‰∏ÄÁßç‰ΩøÁî®Â§ß‰∫éÁ≠â‰∫é $k$ Êù°ÈáçÂ§çËæπÂàÜÂâ≤ËøûÈÄöÂùóÁöÑÊñπÊ°àÊï∞ÔºåÂÜçÊâ©Â±ïÊàêÊ†ëÊó∂‰ºöÈáçÂ§çÔºåÊïÖ $g_i - g_{i + 1}$ Âπ∂‰∏çÊòØ $ans_i$ÔºåÈÇ£‰πàÊ≠§Êó∂ÂÜçËøõË°åÂÆπÊñ•ÔºåÂç≥<br>$$<br>g_i = g_i - \sum\limits_{j = i + 1}^{n - 1} g_j\dbinom{j}{i}<br>$$<br>Âç≥ÂØπ‰∫éÊØè‰∏ÄÁªÑÊÅ∞Â•Ω $j$ Êù°ÈáçÂ§çËæπÁöÑÊñπÊ°àÊï∞ÔºåÈÇ£‰πàÂú®ÊØè‰∏ÄÁªÑÊñπÊ°à‰∏≠ÈÄâÂá∫‰ªªÊÑè $i$ Êù°ËæπÂç≥ÂèØÁªÑÊàê $g_i$ ‰∏≠ÁöÑ‰∏ÄÁßçÊñπÊ°àÔºåÊïÖÂÖ∂ÊñπÊ°àÊï∞ÁöÑÊÄªÂíåÂç≥‰∏∫ $g_i$ Â§öÁÆóÁöÑÊñπÊ°àÊï∞</p><p>Ê≠§Êó∂ $g_i$ Âç≥‰∏∫Ëß£</p><p>Â§çÊùÇÂ∫¶ $O (n^4)$</p><p>Â§çÊùÇÂ∫¶ËØÅÊòé</p><p>Ê±ÇËß£ $S = \sum\limits_{i = 1}^n size_i^2 \big(\sum\limits size_{son}^2\big)$ ÊúÄÂ§ßÂÄº</p><p>Áé∞Âú®ËÄÉËôëÂØπ‰∫éÊØè‰∏Ä‰∏™ËäÇÁÇπ $i$ÔºåÊ±ÇËß£ $size_i^2 \big(\sum\limits size_{son}^2\big)$ ÊúÄÂ§ßÂÄº</p><p>‰ª§ $i$ ÁöÑÂÑøÂ≠êÈõÜÂêà‰∏∫ $SON$ÔºåÂàôÊúâ $\sum\limits_{j \in SON} size_j = size_i - 1$ÔºåÊ±ÇËß£ $\sum\limits_{j \in SON} size_j^2$ ÊúÄÂ§ßÂÄº</p><p>Âõ†‰∏∫ $(size_i - 1)^2 = (\sum\limits_{j \in SON} size_j)^2 \ge \sum\limits_{j \in SON} size_j^2$ÔºåÊïÖÂΩì $SON$ Â§ßÂ∞è‰∏∫ $1$ Êó∂‰∏äÂºèÂèñÊúÄÂ§ßÂÄº</p><p>ÊòæÁÑ∂ $S_{max}$ ÈöèÁùÄ $n$ ËÄåÈÄíÂ¢ûÔºåÂèàÁî±‰∫éÂØπ‰∫éÊâÄÊúâ $SON$ Â§ßÂ∞è‰∏∫ $1$ Êó∂ÁöÑÁÇπ $i$ ÂÖ∂ $size_i^2 = t_1$ÔºåÂØπ‰∫éÂÖ∂ÂÆÉ‰ªªÊÑèÊÉÖÂÜµÁÇπ $i$ ÁöÑ $size_i^2 = t_2$ÔºåÊòæÁÑ∂ÂèØ‰ª•ÂØπËøô‰∫õÊúâÊ†áÂè∑ÁÇπÊâæÂà∞‰∏ÄÁßçÊéíÂàó‰ΩøÂæóÂØπ‰∫é $\forall i$Ôºå Â≠òÂú® $t_1 \ge t_2$ÔºåÊïÖËøôÊ†∑ÂàôÂèØ‰ΩøÂæó $S$ ÂèñÊúÄÂ§ßÂÄºÔºåÊ≠§Êó∂ËØ•Ê†ë‰∏∫‰∏ÄÊù°ÈìæÔºå$S_{max} = \sum\limits_{i = 1}^n i^2 = \frac{(2n +1)n(n + 1)}{6}$ÔºåÊïÖÂ§çÊùÇÂ∫¶‰∏äÈôê‰∏∫ $O (n^4)$</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">p = (p + MOD - <span class="number">1</span>) % (MOD - <span class="number">1</span>);</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function">LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> fact[n] * power (fact[m], MOD - <span class="number">2</span>) % MOD * power (fact[n - m], MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL f[MAXN][MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL temp[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = f[root][<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> p = Head[root]; p; p = Link[p].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[p].to;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">DFS (v, root);</span><br><span class="line"><span class="built_in">memset</span> (temp, <span class="number">0</span>, <span class="keyword">sizeof</span> (temp));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= subsize[root]; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= subsize[root] - i + <span class="number">1</span>; j ++)</span><br><span class="line"><span class="keyword">if</span> (f[root][i][j])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= subsize[v]; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= subsize[v] - k + <span class="number">1</span>; l ++) &#123;</span><br><span class="line">temp[i + k - <span class="number">1</span>][j + l] = (temp[i + k - <span class="number">1</span>][j + l] + f[root][i][j] * f[v][k][l] % MOD) % MOD; <span class="comment">// select</span></span><br><span class="line">temp[i + k][j] = (temp[i + k][j] + f[root][i][j] * f[v][k][l] % MOD * l % MOD) % MOD; <span class="comment">// do not select</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memcpy</span> (f[root], temp, <span class="keyword">sizeof</span> (f[root]));</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL g[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) output (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">Insert (u, v), Insert (v, u);</span><br><span class="line">&#125;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// Áõ∏‰ººÂ∫¶ n - k</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">LL base = power (<span class="number">1l</span>l * N, i - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N - i + <span class="number">1</span>; j ++) &#123;</span><br><span class="line">g[N - i] = (g[N - i] + base * f[<span class="number">1</span>][i][j] % MOD * j % MOD) % MOD;</span><br><span class="line"><span class="keyword">if</span> (N - i == <span class="number">1</span>)</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Test: "</span> &lt;&lt; f[<span class="number">1</span>][i][j] % MOD % MOD &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j ++)</span><br><span class="line">g[i] = (g[i] - g[j] * C (j, i) % MOD + MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">output (g[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="Solution-‚Ö°"><a href="#Solution-‚Ö°" class="headerlink" title="Solution ‚Ö°"></a>Solution ‚Ö°</h2><p>ËøôÊòØ‰∏Ä‰∏™Áü©ÈòµÊ†ëÂÆöÁêÜÁöÑËß£Ê≥ï</p><p>Ëøô‰∏é„Äå<a href="https://www.luogu.org/problem/P5296" target="_blank" rel="noopener">[Âåó‰∫¨ÁúÅÈÄâÈõÜËÆ≠2019]ÁîüÊàêÊ†ëËÆ°Êï∞</a>„ÄçÊûÅ‰∏∫Áõ∏‰ººÔºåÈÉΩÊòØÂ§öÈ°πÂºèÁü©ÈòµÊ†ëÂÆöÁêÜ</p><p>ÂØπ‰∫é‰∏çÂú®ÁªôÂÆöÊ†ë‰∏äÁöÑËæπÂ∞ÜÂÖ∂ÊùÉÂÄºËµã‰∏∫ $1$ÔºåÂØπ‰∫éÂú®ÁªôÂÆöÊ†ë‰∏äÁöÑËæπÂ∞ÜÂÖ∂ÊùÉÂÄºËµã‰∏∫ $x$ÔºàÂç≥Â§öÈ°πÂºè $x$ÔºâÔºåÁÑ∂ÂêéÁü©ÈòµÊ†ëÂÆöÁêÜÂç≥ÂèØ</p>]]></content>
      
      
      <categories>
          
          <category> Âä®ÊÄÅËßÑÂàí </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ê†ëÂΩ¢DP </tag>
            
            <tag> ÂÆπÊñ•ÂéüÁêÜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1187F Expected Square Beauty</title>
      <link href="/2020/08/04/CF1187F%20Expected%20Square%20Beauty/"/>
      <url>/2020/08/04/CF1187F%20Expected%20Square%20Beauty/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Á¨¨‰∏ÄÊ¨°ÂÅöÂà∞ËøôÁßçÁ±ª‰ºº‰ª£Êï∞ÊñπÊ≥ïËøêÁî®ÊúüÊúõÊÄßË¥®ÁöÑÈ¢òÁöÑËØ¥</p><p>ÊúüÊúõÊÄßË¥®Ôºö</p><ul><li>ÂØπ‰∫é‰∏§‰∏™Áã¨Á´ãÁöÑÂØπË±° $A, B$ÔºåÂàôÊúâ $E (AB) = E(A)E(B)‚Äã$</li><li>Á∫øÊÄßÊÄßÔºöÂØπ‰∫éÂØπË±° $X, Y‚Äã$ÔºåÂ≠òÂú® $E(aX + bY) = aE(x) + bE(Y)‚Äã$</li></ul><p>È¶ñÂÖàËÆæËÆ°ÂáΩÊï∞ $I_i(x) = \begin{cases} 1     x_i \neq x_{i - 1} \ 0     x_i = x_{i - 1} \end{cases} (i &gt; 1), ~ I_1(x) = 1‚Äã$ÔºåÂàôÊúâ $B(x) = \sum\limits_{i = 1}^n I_i(x)‚Äã$ÔºåÊïÖ<br>$$<br>\begin{aligned}<br>E (B^2(x)) &amp;= E (\sum\limits_{i = 1}^n I_i(x)\sum\limits_{j = 1}^n I_j(x)) \\<br>&amp;= E (\sum\limits_{i = 1}^n\sum\limits_{j = 1}^n I_i(x)I_j(x)) \\<br>&amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^n E(I_i(x)I_j(x))<br>\end{aligned}<br>$$<br>ÊòìÁü•ÔºåËã• $x_i = x_{i - 1}‚Äã$ ÁöÑÊ¶ÇÁéá $p_i = \frac{\min(r_{i - 1}, r_i) - \max (l_{i - 1}, l_i) + 1}{(r_{i - 1} - l_{i - 1} + 1)(r_i - l_i + 1)}‚Äã$ÔºåÈÇ£‰πà $x_i \neq x_{i - 1}‚Äã$ ÁöÑÊ¶ÇÁéáÔºåÂç≥ $E(I_i(x)) = 1 - p_i‚Äã$ÔºåÁâπÂà´Âú∞Ôºå$p_1 = 0, E(I_1(x)) = 1‚Äã$</p><p>ÈÇ£‰πàÊ≠§Êó∂ÂØπ $E (I_i(x)I_j(x))‚Äã$ ËøõË°åËÆ®ËÆ∫Ôºö</p><p>Ëã• $i = j$ÔºåÂàô $E(I_i(x)I_j(x)) = E(I_i(x))$</p><p>Ëã• $|i - j| &gt; 1‚Äã$ÔºåÈÇ£‰πà $I_i(x)‚Äã$ ‰∏é $I_j(x)‚Äã$ ÂàÜÂà´Áã¨Á´ãÔºåÊïÖ $E(I_i(x)I_j(x)) = E(I_i(x))E(I_j(x))‚Äã$</p><p>Ëã• $|i - j| = 1‚Äã$Ôºå‰ª§ $i + 1 = j‚Äã$ÔºåÈÇ£‰πàËøõË°åÂÆπÊñ•ÔºåÂç≥ $E(I_i(x)I_{i- 1}(x)) = 1 - p_{i - 1} - p_i + P ((x_{i - 2} == x_{i - 1}) \bigcup (x_{i - 1} == x_i))‚Äã$ÔºåÊ†πÊçÆ $E(I_i(x))‚Äã$ ÁöÑËÆ°ÁÆóÊñπÊ≥ïÔºåÊòìÁü•Ôºå$P ((x_{i - 2} = x_{i - 1}) \bigcup (x_{i - 1} = x_i)) =  \frac{\min(r_{i - 2}, r_{i - 1}, r_i) - \max (l_{i - 2}, l_{i - 1}, l_i) + 1}{(r_{i - 2} - l_{i - 2} + 1)(r_{i - 1} - l_{i - 1} + 1)(r_i - l_i + 1)}‚Äã$ÔºåÁâπÂà´Âú∞Ôºå$E(I_1(x)I_2(x)) = E(I_2(x))‚Äã$</p><p>Áªº‰∏äÔºåÊúÄÂêéÁ≠îÊ°à‰∏∫</p><p>$E(B^2(x)) = \sum\limits_{i = 1}^n(p_i + \sum\limits_{|i - j| &gt; 1} p_j) + 2\sum\limits_{i = 2}^n E(I_i(x)I_{i - 1}(x))$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> l[MAXN], r[MAXN];</span><br><span class="line"><span class="keyword">int</span> size[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL p[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL psum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) l[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) r[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) size[i] = r[i] - l[i] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">LL nume = max (<span class="number">0</span>, min (r[i - <span class="number">1</span>], r[i]) - max (l[i - <span class="number">1</span>], l[i]) + <span class="number">1</span>);</span><br><span class="line">LL base = <span class="number">1l</span>l * size[i - <span class="number">1</span>] * size[i] % MOD;</span><br><span class="line">p[i] = nume * power (base, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">psum[i] = (psum[i - <span class="number">1</span>] + (<span class="number">1l</span>l - p[i] + MOD) % MOD) % MOD;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ans = (ans + (<span class="number">1l</span>l - p[i] + MOD) % MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i - <span class="number">2</span> &gt;= <span class="number">1</span>) ans = (ans + (<span class="number">1l</span>l - p[i] + MOD) % MOD * psum[i - <span class="number">2</span>] % MOD) % MOD;</span><br><span class="line"><span class="keyword">if</span> (i + <span class="number">2</span> &lt;= N)</span><br><span class="line">ans = (ans + (<span class="number">1l</span>l - p[i] + MOD) % MOD * ((psum[N] - psum[i + <span class="number">1</span>] + MOD) % MOD) % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL part3 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (N &gt; <span class="number">1</span>) part3 = (<span class="number">1l</span>l - p[<span class="number">2</span>] + MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">LL nume = max (<span class="number">0</span>, min (r[i - <span class="number">2</span>], min (r[i - <span class="number">1</span>], r[i])) - max (l[i - <span class="number">2</span>], max (l[i - <span class="number">1</span>], l[i])) + <span class="number">1</span>);</span><br><span class="line">LL base = <span class="number">1l</span>l * size[i - <span class="number">2</span>] * size[i - <span class="number">1</span>] % MOD * size[i] % MOD;</span><br><span class="line">LL per = ((<span class="number">1l</span>l - p[i - <span class="number">1</span>] - p[i] + nume * power (base, MOD - <span class="number">2</span>) % MOD) % MOD + MOD) % MOD;</span><br><span class="line">part3 = (part3 + per) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">part3 = part3 * <span class="number">2l</span>l % MOD;</span><br><span class="line">ans = (ans + part3) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">1 2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">3 4 5</span></span><br><span class="line"><span class="comment">4 5 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Êï∞ËÆ∫ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êï∞Â≠¶ÊúüÊúõ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BZOJ3277 - ‰∏≤</title>
      <link href="/2020/08/04/BZOJ3277%20-%20%E4%B8%B2/"/>
      <url>/2020/08/04/BZOJ3277%20-%20%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h3><p>Áé∞Âú®ÁªôÂÆö‰Ω†n‰∏™Â≠óÁ¨¶‰∏≤ÔºåËØ¢ÈóÆÊØè‰∏™Â≠óÁ¨¶‰∏≤ÊúâÂ§öÂ∞ëÂ≠ê‰∏≤Ôºà‰∏çÂåÖÊã¨Á©∫‰∏≤ÔºâÊòØÊâÄÊúân‰∏™Â≠óÁ¨¶‰∏≤‰∏≠Ëá≥Â∞ëk‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÂ≠ê‰∏≤ÔºàÊ≥®ÊÑèÂåÖÊã¨Êú¨Ë∫´Ôºâ„ÄÇ</p><h3 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h3><p>È¶ñÂÖàÊòØÂπø‰πâÂêéÁºÄËá™Âä®Êú∫ÔºåÂ∞±ÊòØÊØèÊ¨°Â∞Ü$last$ÂΩí‰∏∫$Root$Ôºå‰ªéËÄåÂ∞ÜÂá†‰∏™ÂêéÁºÄËá™Âä®Êú∫ÊãºÂú®‰∏ÄËµ∑Â§ÑÁêÜ</p><p>ÈÇ£‰πàÁé∞Âú®ÈúÄË¶ÅÁü•ÈÅìÊØè‰∏™Â≠ó‰∏≤Âú®$n$‰∏™ÊØç‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞ÔºåÊâÄË∞ìÂ≠ó‰∏≤ÔºåÂ∞±ÊòØÊâÄÊúâÂâçÁºÄÁöÑÊâÄÊúâÂêéÁºÄÔºåÊâÄ‰ª•ÂèØ‰ª•È°∫ÁùÄÂâçÁºÄËµ∞ÔºåÈÇ£‰πàÈÄöËøá$Parent$Ê†ëÊâæÂêéÁºÄÔºå‰∏ÄÁõ¥ÂæÄ‰∏äË∑≥ÔºåÈÇ£‰πàÈúÄË¶ÅÂä†‰∏ÄÁöÑÊâÄÊúâÂêéÁºÄÂ∞±ÊòØÊâÄÂ±ûÊØç‰∏≤Âπ∂ÈùûÂΩìÂâçÊØç‰∏≤ÁöÑÈÇ£Âá†‰∏™</p><p>Ê≠§Êó∂ÂÜçÊï¥ÁêÜÂá∫ÊØè‰∏™ÊâÄÂ±ûÊØç‰∏≤‰∏™Êï∞$Size &gt;= K$ÁöÑÂàùÂßãË¥°ÁåÆÔºåÂç≥$Len[i] - Len[Father[i]]$ÔºåÂèç‰πãËµã$0$</p><p>ÂèàÂ≠ê‰∏≤‰∏∫ÂâçÁºÄÁöÑÂêéÁºÄÔºåÈÇ£‰πà‰∏Ä‰∏™ËäÇÁÇπÁöÑË¥°ÁåÆÂç≥‰∏∫ÂÆÉÁ•ñÂÖàËá≥ÂÆÉÊú¨Ë∫´ÁöÑË¥°ÁåÆÂâçÁºÄÂíåÔºåÂç≥ÂÆÉÊâÄÊúâÂêéÁºÄËÉΩÂ§üÊûÑÊàêÁöÑÂ≠ê‰∏≤Êï∞</p><p>ÊúÄÂêéÂÜçÈÅçÂéÜ‰∏ÄÈÅçÂâçÁºÄÁªüËÆ°Á≠îÊ°àÂç≥ÂèØ</p><h3 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">6e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="built_in">string</span> Str[MAXN &gt;&gt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Root = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> Tree[MAXN][<span class="number">30</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Len[MAXN]= &#123;<span class="number">0</span>&#125;, Size[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Belong[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> last = Root, nodes = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Append</span> <span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> bel)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fa = last, p = ++ nodes;</span><br><span class="line">    last = p;</span><br><span class="line">    Len[p] = Len[fa] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (fa &amp;&amp; ! Tree[fa][c])</span><br><span class="line">        Tree[fa][c] = p, fa = Father[fa];</span><br><span class="line">    <span class="keyword">if</span> (! fa)</span><br><span class="line">        Father[p] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> x = Tree[fa][c];</span><br><span class="line">        <span class="keyword">if</span> (Len[x] == Len[fa] + <span class="number">1</span>)</span><br><span class="line">            Father[p] = x;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> np = ++ nodes;</span><br><span class="line">            Len[np] = Len[fa] + <span class="number">1</span>, Father[np] = Father[x];</span><br><span class="line">            Father[p] = Father[x] = np;</span><br><span class="line">            <span class="built_in">memcpy</span> (Tree[np], Tree[x], <span class="keyword">sizeof</span> (Tree[x]));</span><br><span class="line">            <span class="keyword">while</span> (fa &amp;&amp; Tree[fa][c] == x)</span><br><span class="line">                Tree[fa][c] = np, fa = Father[fa];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> Topo[MAXN];</span><br><span class="line"><span class="keyword">int</span> W[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> buck[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Merge</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = Str[i].size();</span><br><span class="line">        <span class="keyword">int</span> p = Root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++) &#123;</span><br><span class="line">            p = Tree[p][Str[i][j] - <span class="string">'a'</span>];</span><br><span class="line">            <span class="keyword">int</span> fa = p;</span><br><span class="line">            <span class="keyword">while</span> (fa &amp;&amp; Belong[fa] != i) &#123;</span><br><span class="line">                Size[fa] ++;</span><br><span class="line">                Belong[fa] = i;</span><br><span class="line">                fa = Father[fa];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">        buck[Len[i]] ++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">        buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = nodes; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">        Topo[buck[Len[i]] --] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">        <span class="keyword">if</span> (Size[i] &gt;= K)</span><br><span class="line">            W[i] = Len[i] - Len[Father[i]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">        W[Topo[i]] += W[Father[Topo[i]]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL Answer[MAXN &gt;&gt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span> (<span class="string">"%d%d"</span>, &amp; N, &amp; K);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; Str[i];</span><br><span class="line">        <span class="keyword">int</span> n = Str[i].size();</span><br><span class="line">        last = Root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            Append (Str[i][j] - <span class="string">'a'</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    Merge ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = Str[i].size();</span><br><span class="line">        <span class="keyword">int</span> p = Root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            p = Tree[p][Str[i][j] - <span class="string">'a'</span>], Answer[i] += W[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld"</span>, Answer[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">abc</span></span><br><span class="line"><span class="comment">a</span></span><br><span class="line"><span class="comment">ab</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">aa</span></span><br><span class="line"><span class="comment">aaa</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Â≠óÁ¨¶‰∏≤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÂêéÁºÄËá™Âä®Êú∫ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BZOJ2959 - ÈïøË∑ë</title>
      <link href="/2020/08/04/BZOJ%202959%20-%20%E9%95%BF%E8%B7%91/"/>
      <url>/2020/08/04/BZOJ%202959%20-%20%E9%95%BF%E8%B7%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="È¢òÊÑè"><a href="#È¢òÊÑè" class="headerlink" title="È¢òÊÑè"></a>È¢òÊÑè</h2><p>ÊØè‰∏™ÁÇπÊúâÂêÑËá™ÁöÑÊùÉÂÄºÔºåË¶ÅÊ±ÇÁª¥Êä§Êìç‰ΩúÔºöÂä®ÊÄÅÂä†Ëæπ„ÄÅÂä®ÊÄÅ‰øÆÊîπÊùÉÂÄº„ÄÅËØ¢ÈóÆÂú®ÊØè‰∏™ÁÇπÂè™ËÉΩÁªèËøá‰∏ÄÊ¨°ÁöÑÊÉÖÂÜµ‰∏ã‰∏§ÁÇπÈó¥Ë∑ØÁ®ã‰∏≠ÁöÑÊúÄÂ§ßÊùÉÂÄºÂíå</p><h2 id="È¢òËß£"><a href="#È¢òËß£" class="headerlink" title="È¢òËß£"></a>È¢òËß£</h2><p>È¶ñÂÖàÂØπ‰∫é‰∏Ä‰∏™ÈùôÊÄÅÁöÑÂõæÔºåÂ∞ÜÂÖ∂Áº©ÁÇπÔºåÂèØ‰ª•ÂæóÂà∞‰∏ÄÊ£µÊ†ëÔºåÈÇ£‰πà‰∏§ÁÇπÈó¥ËØ¢ÈóÆÁöÑÁ≠îÊ°àÂç≥‰∏∫ÂÆÉ‰ª¨‰πãÈó¥ÁªèËøáÁöÑ $BCC$ ÁöÑÊùÉÂÄºÂíå</p><p>ÊîØÊåÅÂä®ÊÄÅÂä†ËæπÔºåÂ∞±ÈúÄË¶ÅÁî®Âà∞ $LCT$ ÂéªÁª¥Êä§ $BCC$</p><p>Â¶ÇÊûú‰∏§‰∏™ÁÇπÊâÄÂú® $BCC$ Âú®‰∏çÂêåÊ†ë‰∏äÔºåÈÇ£‰πàÁõ¥Êé•ËøûËæπÂç≥ÂèØÔºõÂèç‰πãÔºåÂàôËØ¥ÊòéÂΩ¢Êàê‰∫ÜÁéØÔºåÂ∞±Êö¥ÂäõÂ∞ÜËøôÊù°ÈìæÊãñÂá∫Êù•ÔºåÁî®ÈÄâÂÆö‰∏Ä‰∏™Ê†áÂáÜËäÇÁÇπÔºåÁî®Âπ∂Êü•ÈõÜÂ∞ÜÈìæ‰∏äÂÖ∂ÂÆÉËäÇÁÇπËøûÂà∞Ê†áÂáÜËäÇÁÇπ‰∏äÔºåÂÆπÊòìËØÅÊòéÔºåËøôÊ†∑ÁöÑÂ§çÊùÇÂ∫¶ÊòØÂùáÊëä $O (\log n)$ ÁöÑ</p><p>Êü•ËØ¢Âç≥‰øÆÊîπÂÆπÊòìÂÆûÁé∞Ôºå‰∏çÂä†ËµòËø∞</p><p>Ê≥®ÊÑèÔºåÊ≠§È¢òÊ≤°ÊúâÂà†ËæπÔºåÊâÄ‰ª• $findroot$ ÂèØÁî®Âè¶‰∏Ä‰∏™Âπ∂Êü•ÈõÜ‰ª£ÊõøÔºå‰∏çÁÑ∂‰ºö $T$</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">15e04</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ances[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p == ances[p] ? p : ances[p] = find (ances[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lctanc[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lctfind</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p == lctanc[p] ? p : lctanc[p] = lctfind (lctanc[p]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL realval[MAXN];</span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> son[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL Sum[MAXN]= &#123;<span class="number">0</span>&#125;, value[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> revtag[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> son[father[p]][<span class="number">0</span>] != p &amp;&amp; son[father[p]][<span class="number">1</span>] != p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sonbel</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> son[father[p]][<span class="number">1</span>] == p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (! p)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    swap (son[p][<span class="number">0</span>], son[p][<span class="number">1</span>]);</span><br><span class="line">    revtag[p] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    Sum[p] = Sum[son[p][<span class="number">0</span>]] + Sum[son[p][<span class="number">1</span>]] + value[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (revtag[p]) &#123;</span><br><span class="line">        reverse (son[p][<span class="number">0</span>]), reverse (son[p][<span class="number">1</span>]);</span><br><span class="line">        revtag[p] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fa = father[p], anc = father[fa];</span><br><span class="line">    <span class="keyword">int</span> s = sonbel (p);</span><br><span class="line">    son[fa][s] = son[p][s ^ <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (son[fa][s])</span><br><span class="line">        father[son[fa][s]] = fa;</span><br><span class="line">    <span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">        son[anc][sonbel (fa)] = p;</span><br><span class="line">    father[p] = anc;</span><br><span class="line">    son[p][s ^ <span class="number">1</span>] = fa, father[fa] = p;</span><br><span class="line">    pushup (fa), pushup (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> Stack[MAXN];</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    top = <span class="number">0</span>, Stack[++ top] = p;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> nd = p; ! isroot (nd); nd = father[nd])</span><br><span class="line">        Stack[++ top] = father[nd];</span><br><span class="line">    <span class="keyword">while</span> (top &gt; <span class="number">0</span>)</span><br><span class="line">        pushdown (Stack[top]), top --;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> fa = father[p]; ! isroot (p); rotate (p), fa = father[p])</span><br><span class="line">        <span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">            sonbel (p) == sonbel (fa) ? rotate (fa) : rotate (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Access</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> tp = <span class="number">0</span>; p; tp = p, p = father[tp] = find (father[p])) <span class="comment">// Ê≥®ÊÑèÂõ†‰∏∫ÊúâÂπ∂Êü•ÈõÜÔºåÊâÄ‰ª•‰πüË¶ÅÂêåÊó∂Êõ¥Êñ∞father[tp]</span></span><br><span class="line">        splay (p), son[p][<span class="number">1</span>] = tp, pushup (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Makeroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    Access (p), splay (p), reverse (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Split</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    Makeroot (x);</span><br><span class="line">    Access (y), splay (y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    Makeroot (x);</span><br><span class="line">    father[x] = y;</span><br><span class="line">    <span class="keyword">int</span> fx = lctfind (x), fy = lctfind (y);</span><br><span class="line">    lctanc[fx] = fy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> root)</span> </span>&#123; <span class="comment">// Êö¥ÂäõÂêàÂπ∂</span></span><br><span class="line">    <span class="keyword">if</span> (! p)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (p != root)</span><br><span class="line">        ances[p] = root, value[root] += value[p];</span><br><span class="line">    merge (son[p][<span class="number">0</span>], root), merge (son[p][<span class="number">1</span>], root);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line">    <span class="keyword">if</span> (fx == fy)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (lctfind (fx) != lctfind (fy)) &#123;</span><br><span class="line">        link (fx, fy);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    Split (fx, fy);</span><br><span class="line">    merge (fy, fy);</span><br><span class="line">    son[fy][<span class="number">0</span>] = son[fy][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    pushup (fy);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Modify</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fx = find (x);</span><br><span class="line">    splay (fx);</span><br><span class="line">    value[fx] -= realval[x] - val, realval[x] = val;</span><br><span class="line">    pushup (fx);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line">    <span class="keyword">if</span> (lctfind (fx) != lctfind (fy))</span><br><span class="line">        <span class="keyword">return</span> - <span class="number">1</span>;</span><br><span class="line">    Split (fx, fy);</span><br><span class="line">    <span class="keyword">return</span> Sum[fy];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">int</span> isneg = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>)</span><br><span class="line">            isneg = <span class="number">1</span>;</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> answer[MAXN];</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N = getnum (), M = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        Sum[i] = value[i] = realval[i] = getnum (), lctanc[i] = ances[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> type = getnum ();</span><br><span class="line">        <span class="keyword">int</span> x = getnum (), y = getnum ();</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>)</span><br><span class="line">            Add (x, y);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">2</span>)</span><br><span class="line">            Modify (x, y);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">3</span>)</span><br><span class="line">            <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, Query (x, y));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">9 31</span></span><br><span class="line"><span class="comment">10 20 30 40 50 60 70 80 90</span></span><br><span class="line"><span class="comment">3 1 2</span></span><br><span class="line"><span class="comment">1 1 3</span></span><br><span class="line"><span class="comment">1 1 2</span></span><br><span class="line"><span class="comment">1 8 9</span></span><br><span class="line"><span class="comment">1 2 4</span></span><br><span class="line"><span class="comment">1 2 5</span></span><br><span class="line"><span class="comment">1 4 6</span></span><br><span class="line"><span class="comment">1 4 7</span></span><br><span class="line"><span class="comment">3 1 8</span></span><br><span class="line"><span class="comment">3 8 8</span></span><br><span class="line"><span class="comment">1 8 9</span></span><br><span class="line"><span class="comment">3 8 8</span></span><br><span class="line"><span class="comment">3 7 5</span></span><br><span class="line"><span class="comment">3 7 3</span></span><br><span class="line"><span class="comment">1 4 1</span></span><br><span class="line"><span class="comment">3 7 5</span></span><br><span class="line"><span class="comment">3 7 3</span></span><br><span class="line"><span class="comment">1 5 7</span></span><br><span class="line"><span class="comment">3 6 5</span></span><br><span class="line"><span class="comment">3 3 6</span></span><br><span class="line"><span class="comment">1 2 4</span></span><br><span class="line"><span class="comment">1 5 5</span></span><br><span class="line"><span class="comment">3 3 6</span></span><br><span class="line"><span class="comment">2 8 180</span></span><br><span class="line"><span class="comment">3 8 8</span></span><br><span class="line"><span class="comment">2 9 190</span></span><br><span class="line"><span class="comment">3 9 9</span></span><br><span class="line"><span class="comment">2 5 150</span></span><br><span class="line"><span class="comment">3 3 6</span></span><br><span class="line"><span class="comment">2 1 210</span></span><br><span class="line"><span class="comment">3 3 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÂõæËÆ∫,Êï∞ÊçÆÁªìÊûÑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LCT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC003Ëß£È¢òÊä•Âëä</title>
      <link href="/2020/08/04/AGC003%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
      <url>/2020/08/04/AGC003%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="D-Anticube"><a href="#D-Anticube" class="headerlink" title="D - Anticube"></a>D - Anticube</h2><p>ËØ¥ÂÆûËØùË¥®Âõ†Êï∞ÂàÜËß£ÁöÑÈ¢òÈÉΩÊå∫ÊúâÊÑèÊÄùÁöÑ</p><p>È¶ñÂÖàÂØπ‰∫éÊØè‰∏™Êï∞ÔºåÊòæÁÑ∂ÈáåÈù¢Â≠òÂú®ÁöÑË¥®Êï∞‰∏âÊ¨°ÊñπÁöÑÂõ†Â≠êÈÉΩÊòØÊó†Ë¥°ÁåÆÁöÑÔºåÈÇ£‰πàÂ∞ÜÂÖ∂ÁöÑÊØè‰∏™Ë¥®Âõ†Êï∞ÂåñÁÆÄÔºåÂç≥ÂØπ‰∫éË¥®Âõ†Â≠ê $p^k$ÔºåÂ∞ÜÂÖ∂Âèò‰∏∫ $p^{k ~ mod ~  3}$</p><p>ÈÇ£‰πà‰∏§‰∏™Êï∞Ëã•‰πòÁßØ‰∏∫ÂÆåÂÖ®Á´ãÊñπÊï∞ÔºåÂàôÂøÖÈ°ªÊª°Ë∂≥ÂÆÉ‰ª¨ÁöÑÊØè‰∏Ä‰∏™Áõ∏ÂêåË¥®Âõ†Â≠êÈÉΩÊòØ‚Äú‰∫íË°•ÁöÑ‚ÄùÔºàÂç≥Ê¨°Êï∞Áõ∏Âä†‰∏∫ $0$ Êàñ $3$ÔºâÔºåÂêåÊó∂ÊòæÁÑ∂‰∏ÄÂÆö‰∏çÂ≠òÂú®Â§ß‰∫é‰∏Ä‰∏™ $&gt; \sqrt[3]n$ ÁöÑË¥®Âõ†Êï∞ $p$ÔºåÈÇ£‰πàËß£Ê≥ïÂ∞±ÂæàÊòæÁÑ∂‰∫Ü</p><p>Â∞±ÊòØÁ≠õÂá∫ $[2, \sqrt[3]n]$ ÁöÑË¥®Êï∞ÔºåÁÑ∂ÂêéÂØπÊØè‰∏Ä‰∏™Êï∞ËøõË°åÂåñÁÆÄÔºåÁÑ∂ÂêéÂ∞ÜÂåñÁÆÄÂêéÁöÑÊï∞ÁöÑËÆ°Êï∞Âô®Âä†‰∏ÄÔºåÊúÄÂêéÂú®ÊâÄÊúâ‰∏§‰∏§‚Äú‰∫íË°•‚ÄùÁöÑÊï∞‰∏≠Âèñ $max$ Ê±ÇÂíåÂç≥ÂèØ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2200</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">LL a[MAXN], newa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXM]= &#123;<span class="number">0</span>&#125;, pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">2200</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (visit[i]) <span class="keyword">continue</span>;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i &lt;&lt; <span class="number">1</span>; j &lt;= MAX; j += i)</span><br><span class="line">visit[j] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tr1::<span class="built_in">unordered_map</span>&lt;LL, <span class="keyword">int</span>&gt; mapp, ccnt;</span><br><span class="line"><span class="keyword">int</span> ind = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= p; j ++)</span><br><span class="line">cnt *= x;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;LL, LL&gt; save[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">save[++ ind] = make_pair (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">mapp[<span class="number">0</span>] = mapp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">LL p = a[i];</span><br><span class="line">LL cnt = <span class="number">1</span>, ano = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt; j ++)</span><br><span class="line"><span class="keyword">if</span> (! (p % prime[j])) &#123;</span><br><span class="line"><span class="keyword">int</span> times = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (! (p % prime[j]))</span><br><span class="line">p /= prime[j], times ++;</span><br><span class="line">times %= <span class="number">3</span>;</span><br><span class="line"><span class="keyword">if</span> (times &gt; <span class="number">0</span>)</span><br><span class="line">ano *= power (prime[j], <span class="number">3</span> - times);</span><br><span class="line">cnt *= power (prime[j], times);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (a[i] != <span class="number">1</span> &amp;&amp; cnt == <span class="number">1</span> &amp;&amp; p == <span class="number">1</span>) &#123;</span><br><span class="line">ccnt[<span class="number">0</span>] ++;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">ccnt[cnt * p] ++, newa[i] = cnt * p;</span><br><span class="line"><span class="keyword">if</span> (mapp[cnt * p]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (p &gt; <span class="number">1</span>) &#123;</span><br><span class="line">LL sqr = <span class="built_in">sqrt</span> (p);</span><br><span class="line"><span class="keyword">if</span> (sqr * sqr == p) &#123;</span><br><span class="line">save[++ ind] = make_pair (cnt * p, ano * sqr);</span><br><span class="line">mapp[cnt * p] = mapp[ano * sqr] = ind;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">save[++ ind] = make_pair (cnt, ano);</span><br><span class="line">mapp[cnt] = mapp[ano] = ind;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ccnt[<span class="number">0</span>] = min (ccnt[<span class="number">0</span>], <span class="number">1</span>), ccnt[<span class="number">1</span>] = min (ccnt[<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ind; i ++)</span><br><span class="line">ans += max (ccnt[save[i].first], ccnt[save[i].second]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! mapp[newa[i]])</span><br><span class="line">ans ++;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T num = T ();</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum&lt;<span class="keyword">int</span>&gt; ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum&lt;LL&gt; ();</span><br><span class="line">sieve ();</span><br><span class="line"><span class="keyword">int</span> ans = solve ();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">32</span></span><br><span class="line"><span class="comment">64</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">100</span></span><br><span class="line"><span class="comment">1000000007</span></span><br><span class="line"><span class="comment">10000000000</span></span><br><span class="line"><span class="comment">1000000009</span></span><br><span class="line"><span class="comment">999999999</span></span><br><span class="line"><span class="comment">999</span></span><br><span class="line"><span class="comment">999</span></span><br><span class="line"><span class="comment">999</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">100</span></span><br><span class="line"><span class="comment">2368593037</span></span><br><span class="line"><span class="comment">38192375</span></span><br><span class="line"><span class="comment">218391929</span></span><br><span class="line"><span class="comment">572421321</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">32</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="E-Sequential-operations-on-Sequence"><a href="#E-Sequential-operations-on-Sequence" class="headerlink" title="E - Sequential operations on Sequence"></a>E - Sequential operations on Sequence</h2><p>ÂÖàËÄÉËôëÊâÄÊúâÂè™Â≠òÂú®Â¢ûÂä†ÈïøÂ∫¶ÁöÑÊìç‰Ωú</p><p>ÈÇ£‰πàÂèØ‰ª•‰ªéÂêéÂæÄÂâçÊûö‰∏æÔºåËÄÉËôëÂêéÈù¢ÁöÑÊìç‰ΩúÂØπÂâçÈù¢ÁöÑË¥°ÁåÆ</p><p>ÈÇ£‰πàÂØπ‰∫éÊØè‰∏Ä‰∏™‰ΩçÁΩÆ $p$ÔºåÂÆÉÁõ∏ÂΩì‰∫éÊòØÁ¨¨‰∏Ä‰∏™Â∞è‰∫éÂÆÉÁöÑ‰ΩçÁΩÆ $q$ ÁÆó $p / q$ Ê¨°ÔºåÁÑ∂ÂêéÂÜçÁÆó‰∏ÄÊ¨° $p ~ mod ~ q$ÔºåÊïÖÈÄíÂΩíÂç≥ÂèØ</p><p>ÁÑ∂ÂêéÂØπ‰∫éÂáèÂ∞ëÈïøÂ∫¶ÁöÑÊìç‰ΩúÔºåÊòæÁÑ∂ËØ•Êìç‰Ωú‰πãÂâçÊâÄÊúâÈïøÂ∫¶Â§ß‰∫éÁ≠â‰∫éÂΩìÂâçÈïøÂ∫¶ÁöÑÊìç‰ΩúÈÉΩÊòØÊó†Áî®ÁöÑÔºåÊïÖÂè™ÈúÄÂàùÂßãÂåñÊó∂ÂèñÈÄíÂ¢ûÁöÑÊìç‰ΩúÂç≥ÂèØËΩ¨Âåñ‰∏∫Âè™Â≠òÂú®Â¢ûÂä†ÈïøÂ∫¶ÁöÑÊìç‰ΩúÁöÑÈõÜÂêà</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL que[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> tail = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">LL suffix[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> value[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findpos</span> <span class="params">(<span class="keyword">int</span> limit, LL delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (delta &lt; que[<span class="number">1</span>]) <span class="keyword">return</span> delta;</span><br><span class="line"><span class="keyword">int</span> posi = upper_bound (que + <span class="number">1</span>, que + limit, delta) - que - <span class="number">1</span>;</span><br><span class="line">LL add = delta / que[posi], rest = delta % que[posi];</span><br><span class="line">suffix[posi] += suffix[limit] * add;</span><br><span class="line"><span class="keyword">return</span> findpos (limit, rest);</span><br><span class="line">&#125;</span><br><span class="line">LL subsum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">value[<span class="number">1</span>] = que[<span class="number">1</span>], suffix[tail] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = tail; i &gt;= <span class="number">2</span>; i --) &#123;</span><br><span class="line"><span class="keyword">int</span> val = findpos (i, que[i]);</span><br><span class="line">value[i] = val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = tail; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">subsum[value[i]] += suffix[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">subsum[i] += subsum[i + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T num = T ();</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">println</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line">write (x), <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum&lt;<span class="keyword">int</span>&gt; (), M = getnum&lt;<span class="keyword">int</span>&gt; ();</span><br><span class="line">que[++ tail] = N;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">LL posi = getnum&lt;LL&gt; ();</span><br><span class="line"><span class="keyword">while</span> (tail &gt;= <span class="number">1</span> &amp;&amp; que[tail] &gt;= posi) tail --;</span><br><span class="line">que[++ tail] = posi;</span><br><span class="line">&#125;</span><br><span class="line">solve ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">println (subsum[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 3</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">11</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 10</span></span><br><span class="line"><span class="comment">9</span></span><br><span class="line"><span class="comment">13</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">9</span></span><br><span class="line"><span class="comment">19</span></span><br><span class="line"><span class="comment">22</span></span><br><span class="line"><span class="comment">27</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 10</span></span><br><span class="line"><span class="comment">15</span></span><br><span class="line"><span class="comment">22</span></span><br><span class="line"><span class="comment">12</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 10</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">26</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">12</span></span><br><span class="line"><span class="comment">12</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">20</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 10</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">24</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="F-Fraction-of-Fractal"><a href="#F-Fraction-of-Fractal" class="headerlink" title="F - Fraction of Fractal"></a><strong>F - Fraction of Fractal</strong></h2><p>‰∫éÊòØÊàëÂèàÁúãÈîô‰∫Ü‰∏ÄÊ¨°È¢òÁõÆ„ÄÇ„ÄÇ</p><p>ÂØπ‰∫éÂ∑¶Âè≥„ÄÅ‰∏ä‰∏ãÂ§çÂà∂ÂêéÈÉΩËøûÈÄöÁöÑÊÉÖÂÜµÔºåÊòæÁÑ∂Á≠îÊ°à‰∏∫ $1$</p><p>ÂØπ‰∫éÂ∑¶Âè≥„ÄÅ‰∏ä‰∏ãÂ§çÂà∂ÂêéÈÉΩ‰∏çËøûÈÄöÁöÑÊÉÖÂÜµÔºåËÆæÂÖ∂ÈªëÁÇπ‰∏™Êï∞‰∏∫ $p$ÔºåÂàôÁ≠îÊ°àÊòæÁÑ∂‰∏∫ $p^{k - 1}$</p><p>ÈÇ£‰πàÁé∞Âú®ÂÅáËÆæÂ∑¶Âè≥Â§çÂà∂ÂêéËøûÈÄöÔºå‰∏ä‰∏ãÂ§çÂà∂Âêé‰∏çËøûÈÄöÔºå‰ª§ÂÖ∂ÊúÄÁªàÁä∂ÊÄÅÈªëÁÇπ‰∏™Êï∞ $x_n$ÔºåÂ∑¶Âè≥ËøûÈÄöÁöÑÁÇπÁªÑÔºàÂç≥ $##$Ôºâ‰∏™Êï∞‰∏∫ $y_n$ÔºåÈÇ£‰πàÊÄùËÄÉ‰∏Ä‰∏ãÔºåÁ≠îÊ°àÂç≥‰∏∫ $x_n - y_n$ÔºåËÄÉËôëËΩ¨ÁßªÔºåÈÇ£‰πà $y_i$ ‰ºöÂè™‰ºöÂú®ÊúÄÂ∑¶Á´ØÂíåÊúÄÂè≥Á´ØËøûÈÄöÊó∂Â¢ûÂä†ÔºåÊïÖ‰ª§ $z_i$ Ë°®Á§∫ $i$ Áä∂ÊÄÅÊó∂ÊúÄÂ∑¶ÂíåÊúÄÂè≥ËøûÈÄöÁöÑ‰∏™Êï∞ÔºåÂàôËΩ¨ÁßªÂç≥‰∏∫<br>$$<br>\begin{aligned}<br>x_i &amp;= x_{i - 1}^2 \\<br>y_i &amp;= x_{i - 1} \times y_{i - 1} + z_{i - 1} \times y_{i - 1} \\<br>z_i &amp;= z_{i - 1}^2<br>\end{aligned}<br>$$<br>ÁÑ∂ÂêéÂèëÁé∞ËøôÊ†∑Â≠êÊª°Ë∂≥Áü©Èòµ‰πòÊ≥ïÔºåÂç≥ÂèØÊûÑÈÄ†Áü©Èòµ<br>$$<br>\begin{bmatrix}<br>x_1 &amp; y_1 \\<br>0 &amp; z_1<br>\end{bmatrix}<br>$$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">LL a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">Matrix () &#123;</span><br><span class="line"><span class="built_in">memset</span> (a, <span class="number">0</span>, <span class="keyword">sizeof</span> (a));</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix&amp; A, <span class="keyword">const</span> Matrix&amp; B) &#123;</span><br><span class="line">Matrix ret = Matrix ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span>; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">2</span>; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= <span class="number">2</span>; k ++)</span><br><span class="line">ret.a[i][j] = (ret.a[i][j] + A.a[i][k] * B.a[k][j] % MOD) % MOD;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">matpower</span> <span class="params">(Matrix x, LL k)</span> </span>&#123;</span><br><span class="line">Matrix ret = Matrix ();</span><br><span class="line">ret.a[<span class="number">1</span>][<span class="number">1</span>] = ret.a[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (k) &#123;</span><br><span class="line"><span class="keyword">if</span> (k &amp; <span class="number">1</span>)</span><br><span class="line">ret = ret * x;</span><br><span class="line">x = x * x;</span><br><span class="line">k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> (ret.a[<span class="number">1</span>][<span class="number">1</span>] - ret.a[<span class="number">1</span>][<span class="number">2</span>] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL k;</span><br><span class="line"><span class="keyword">char</span> <span class="built_in">map</span>[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d%lld"</span>, &amp; N, &amp; M, &amp; k);</span><br><span class="line"><span class="keyword">int</span> tol = <span class="number">0</span>, toup = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> lr = <span class="number">0</span>, ud = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, <span class="built_in">map</span>[i] + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">map</span>[i][j] == <span class="string">'#'</span>) &#123;</span><br><span class="line">cnt ++;</span><br><span class="line">tol += <span class="built_in">map</span>[i][j - <span class="number">1</span>] == <span class="string">'#'</span>;</span><br><span class="line">toup += <span class="built_in">map</span>[i - <span class="number">1</span>][j] == <span class="string">'#'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">map</span>[i][<span class="number">1</span>] == <span class="string">'#'</span> &amp;&amp; <span class="built_in">map</span>[i][M] == <span class="string">'#'</span>) lr ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">map</span>[<span class="number">1</span>][j] == <span class="string">'#'</span> &amp;&amp; <span class="built_in">map</span>[N][j] == <span class="string">'#'</span>) ud ++;</span><br><span class="line"><span class="keyword">if</span> (! lr &amp;&amp; ! ud) &#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; power (<span class="number">1l</span>l * cnt, k - <span class="number">1</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (lr &amp;&amp; ud) &#123;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">"1"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (! lr) swap (lr, ud), swap (tol, toup);</span><br><span class="line">Matrix x = Matrix ();</span><br><span class="line">x.a[<span class="number">1</span>][<span class="number">1</span>] = cnt, x.a[<span class="number">1</span>][<span class="number">2</span>] = tol, x.a[<span class="number">2</span>][<span class="number">2</span>] = lr;</span><br><span class="line">LL ans = matpower (x, k - <span class="number">1</span>);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3 3</span></span><br><span class="line"><span class="comment">.#.</span></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="comment">#.#</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">11 15 1000000000000000000</span></span><br><span class="line"><span class="comment">.....#.........</span></span><br><span class="line"><span class="comment">....###........</span></span><br><span class="line"><span class="comment">....####.......</span></span><br><span class="line"><span class="comment">...######......</span></span><br><span class="line"><span class="comment">...#######.....</span></span><br><span class="line"><span class="comment">..##.###.##....</span></span><br><span class="line"><span class="comment">..##########...</span></span><br><span class="line"><span class="comment">.###.....####..</span></span><br><span class="line"><span class="comment">.####...######.</span></span><br><span class="line"><span class="comment">###############</span></span><br><span class="line"><span class="comment">#.##..##..##..#</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AtCoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC002Ëß£È¢òÊä•Âëä</title>
      <link href="/2020/08/04/AGC002%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
      <url>/2020/08/04/AGC002%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="D-Stamp-Rally"><a href="#D-Stamp-Rally" class="headerlink" title="D - Stamp Rally"></a>D - Stamp Rally</h2><p>Êï¥‰Ωì‰∫åÂàÜ + Âπ∂Êü•ÈõÜÂ∏∏ËßÑÊìç‰Ωú</p><p>‰∏çËøáËÆ∞ÂæóÊØèÊ¨°‰ªÖÂ∞ÜÂΩìÂâçÈÄíÂΩíÊó∂‰ΩøÁî®ÁöÑÂπ∂Êü•ÈõÜÂà†ÂéªÂç≥ÂèØÔºå‰πãÂâçÁöÑ‰øùÁïôÔºåÊâÄ‰ª•ÂØπ‰∫éÈÇ£‰∫õË¢´ÂøΩÁï•ÁöÑÁ≠îÊ°àÁöÑ‰ΩçÁΩÆÔºå‰πüÈúÄË¶ÅÈÄíÂΩíÂà∞ÁÑ∂ÂêéÂä†ÂÖ•Âπ∂Êü•ÈõÜ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXQ = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; edge[MAXM];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> answer[MAXQ]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">querySt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> index;</span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"><span class="keyword">int</span> lim;</span><br><span class="line"></span><br><span class="line">querySt (<span class="keyword">int</span> find = <span class="number">0</span>, <span class="keyword">int</span> fx = <span class="number">0</span>, <span class="keyword">int</span> fy = <span class="number">0</span>, <span class="keyword">int</span> flim = <span class="number">0</span>) :</span><br><span class="line">index (find), x (fx), y (fy), lim (flim) &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">querySt query[MAXQ];</span><br><span class="line"></span><br><span class="line">querySt q1[MAXQ], q2[MAXQ];</span><br><span class="line"><span class="keyword">int</span> father[MAXN], subsize[MAXN];</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; <span class="built_in">stack</span>[MAXM];</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> father[x] == x ? x : find (father[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line"><span class="keyword">if</span> (fx == fy) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">if</span> (subsize[fx] &gt; subsize[fy]) swap (fx, fy);</span><br><span class="line">father[fx] = fy, subsize[fy] += subsize[fx];</span><br><span class="line"><span class="built_in">stack</span>[++ top] = make_pair (fx, fy);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line"><span class="comment">// if (left &gt; right || l &gt; r) return ; Ê≥®ÊÑèËã• l &gt; r Â∞±ÈÄÄÂá∫ÈÇ£‰πàÊúâ‰∏Ä‰∫õÁÇπÊó†Ê≥ïÂä†ÂÖ•Âπ∂Êü•ÈõÜ</span></span><br><span class="line">top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line"><span class="comment">// cout &lt;&lt; "Test: " &lt;&lt; left &lt;&lt; ' ' &lt;&lt; l &lt;&lt; ' ' &lt;&lt; r &lt;&lt; endl;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++)</span><br><span class="line">answer[query[i].index] = left;</span><br><span class="line">merge (edge[left].first, edge[left].second);</span><br><span class="line">top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= mid; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = edge[i].first, v = edge[i].second;</span><br><span class="line">merge (u, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> t1 = <span class="number">0</span>, t2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = query[i].x, y = query[i].y;</span><br><span class="line"><span class="keyword">int</span> lim = query[i].lim;</span><br><span class="line"><span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line"><span class="keyword">if</span> (fx == fy) &#123;</span><br><span class="line"><span class="keyword">if</span> (subsize[fx] &gt;= lim) q1[++ t1] = query[i];</span><br><span class="line"><span class="keyword">else</span> q2[++ t2] = query[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (subsize[fx] + subsize[fy] &gt;= lim) q1[++ t1] = query[i];</span><br><span class="line"><span class="keyword">else</span> q2[++ t2] = query[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t1; i ++)</span><br><span class="line">query[l + i - <span class="number">1</span>] = q1[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t2; i ++)</span><br><span class="line">query[l + t1 + i - <span class="number">1</span>] = q2[i];</span><br><span class="line"><span class="keyword">while</span> (top &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">int</span> x = <span class="built_in">stack</span>[top].first, y = <span class="built_in">stack</span>[top].second;</span><br><span class="line">top --;</span><br><span class="line">father[x] = x, subsize[y] -= subsize[x];</span><br><span class="line">&#125;</span><br><span class="line">solve (left, mid, l, l + t1 - <span class="number">1</span>), solve (mid + <span class="number">1</span>, right, l + t1, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// freopen ("stamp.in", "r", stdin);</span></span><br><span class="line"><span class="comment">// freopen ("stamp.out", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">edge[i] = make_pair (u, v);</span><br><span class="line">&#125;</span><br><span class="line">Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = getnum (), y = getnum (), z = getnum ();</span><br><span class="line">query[i] = querySt (i, x, y, z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">father[i] = i, subsize[i] = <span class="number">1</span>;</span><br><span class="line">solve (<span class="number">1</span>, M, <span class="number">1</span>, Q);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, answer[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 6</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">1 5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">2 4 3</span></span><br><span class="line"><span class="comment">2 4 4</span></span><br><span class="line"><span class="comment">2 4 5</span></span><br><span class="line"><span class="comment">1 3 3</span></span><br><span class="line"><span class="comment">1 3 4</span></span><br><span class="line"><span class="comment">1 3 5</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 13</span></span><br><span class="line"><span class="comment">8 5</span></span><br><span class="line"><span class="comment">5 7</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">7 8</span></span><br><span class="line"><span class="comment">5 6</span></span><br><span class="line"><span class="comment">10 9</span></span><br><span class="line"><span class="comment">4 8</span></span><br><span class="line"><span class="comment">7 10</span></span><br><span class="line"><span class="comment">7 1</span></span><br><span class="line"><span class="comment">2 7</span></span><br><span class="line"><span class="comment">4 2</span></span><br><span class="line"><span class="comment">8 10</span></span><br><span class="line"><span class="comment">6 9</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">4 9 11</span></span><br><span class="line"><span class="comment">6 2 2</span></span><br><span class="line"><span class="comment">5 4 5</span></span><br><span class="line"><span class="comment">10 8 4</span></span><br><span class="line"><span class="comment">2 4 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="E-Candy-Piles"><a href="#E-Candy-Piles" class="headerlink" title="E - Candy Piles"></a>E - Candy Piles</h2><p>Á•û‰ªôÂçöÂºàËÆ∫ + Ê®°ÂûãËΩ¨Âåñ</p><p>ÁÆóÊòØÁõÆÂâçÂÅöËøáÁöÑ‰∏∫Êï∞ÊûÅÂ∞ëÁöÑÂçöÂºàËÆ∫È¢ò‰πã‰∏ÄÔºåÁÑ∂ËÄåÂπ∂‰∏çÁî® $SG$ ÂáΩÊï∞‰ªÄ‰πàÁöÑ</p><p>Ê≥®ÊÑè $2$ Êìç‰ΩúÊòØÂØπ‰∫éÊØè‰∏ÄÂ†ÜÈÉΩÂêÉ‰∏Ä‰∏™ËÄå‰∏çÊòØ‰ªªÈÄâ‰∏ÄÂ†ÜÂêÉÔºåÁÑ∂ËÄåÊàëÁúãÂÆåÈ¢òËß£ÊâçÂèëÁé∞ÊàëÈ¢òÁõÆÁúãÈîô‰∫Ü„ÄÇ„ÄÇ„ÄÇ</p><p>Â∞ÜÁ≥ñÊûúÂ†ÜÊåâÁÖß‰∏™Êï∞ÊéíÂ∫èÂêéÔºåÂæóÂà∞Â¶Ç‰∏ãÂõæ</p><blockquote><p>000</p><p>000</p><p>0000</p><p>00000</p></blockquote><p>Â∞ÜÂÖ∂ÁúãÂÅö‰ª•Â∑¶‰∏ãËßí‰∏∫ÁÇπ $(1, 1)$ ÁöÑÂùêÊ†áÁ≥ªÔºåÈÇ£‰πàÔºåÂØπ‰∫éÂêÉÊúÄÂ§ßÁöÑ‰∏ÄÂ†ÜÁ≥ñÊûúÔºåÂ∞±Áõ∏ÂΩì‰∫éÂêë‰∏äÁßª‰∏ÄÊ†ºÔºåÂØπ‰∫éÊØèÂ†ÜÂêÉ‰∏Ä‰∏™Á≥ñÊûúÔºåÂ∞±Áõ∏ÂΩì‰∫éÂêëÂè≥Áßª‰∏ÄÊ†ºÔºåÁÑ∂ÂêéÂêÉÂà∞‰∏çËÉΩÂêÉ‰∏∫Ê≠¢ÔºåÂç≥Âà∞ËææÁÇπ $(3, 4), ~ (4, 2), ~ (1, 5)$ ÁöÑÂÖ∂‰∏≠‰∏Ä‰∏™</p><p>ÊòæÁÑ∂Ôºå‰∏äËø∞Êó†Ê≥ïÁªßÁª≠Ëµ∞Âä®ÁöÑ‰∏âÁÇπÊòØÂøÖËæìÁÇπÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈÄöËøá‰∏äËø∞ÁÇπÊâ©Âº†Â∞ÜÊï¥ÂπÖÂõæÁöÑÂøÖËµ¢ÂøÖËæìÁä∂ÊÄÅË°®Á§∫Âá∫Êù•</p><p>Ê†πÊçÆÂÆöÁêÜ</p><blockquote><p>Ëã•‰∏Ä‰∏™ÁÇπÊòØÂøÖËµ¢ÁÇπÂΩì‰∏î‰ªÖÂΩìÂÖ∂ÂèØËΩ¨ÁßªÁöÑÁä∂ÊÄÅ‰∏≠Â≠òÂú®ÂøÖËæìÁÇπÔºõËã•‰∏Ä‰∏™ÁÇπÊòØÂøÖËæìÁÇπÂΩì‰∏î‰ªÖÂΩìÂÖ∂ÂèØËΩ¨ÁßªÁöÑÁä∂ÊÄÅ‰∏≠ÁöÜÊòØÂøÖËµ¢ÁÇπ</p></blockquote><p>Â∞±ÂèØ‰ª•ÂÆûÁé∞</p><p>ÂΩìÁÑ∂ÔºåËøôÊ†∑ËøòÊòØ $T$ ÁöÑÔºåÊâÄ‰ª•ÁªèËøáËßÇÂØüÔºåÂèØ‰ª•ÂèëÁé∞</p><ul><li>‰∏Ä‰∏™ÁÇπÁöÑÂøÖËµ¢ÂøÖËæìÁä∂ÊÄÅ‰∏éÂÖ∂Â∑¶‰∏äËßíÁöÑÁä∂ÊÄÅÁõ∏Âêå</li></ul><p>ËØÅÊòéÁöÑËØùÊûö‰∏æÁÑ∂ÂêéÁÆÄÂçïÂèçËØÅ‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü</p><p>ÊïÖÁé∞Âú®ÂèØ‰ª•Â∞ÜÁÇπ $(1, 1)$ ‰∏ÄÁõ¥ÂêëÂè≥‰∏äËßíÁßªÂä®Âà∞Áõ¥Âà∞Êó†Ê≥ïÁßªÂä®‰∏∫Ê≠¢ÁöÑÁÇπ $(k, k)$ÔºåÈÇ£‰πàÂÆÉÁé∞Âú®ÂøÖÂ§Ñ‰∫éÂõæÂΩ¢ÁöÑ‚ÄúËæπÁºò‚Äù‰∏äÔºåÊòæÁÑ∂ÔºåÂØπ‰∫éËæπÁºòÁöÑÊÉÖÂÜµÔºå‰∏Ä‰∏™ÁÇπÁöÑÁä∂ÊÄÅÂøÖ‰∏éÂÖ∂Âè≥Ôºà‰∏äÔºâÁöÑÁÇπÁõ∏ÂèçÔºåÈÇ£‰πàÂè™Ë¶ÅÂà§Êñ≠‰∏Ä‰∏ã $(k, k)$ ÂèØ‰ª•Âêë‰∏äÊàñÂêëÂè≥Êâ©Âº†Áõ¥Âà∞Êó†Ê≥ïÁßªÂä®ÁöÑÊ≠•Êï∞ÁöÑÂ•áÂÅ∂ÊÄßÔºåËã•Â≠òÂú®Â•áÊï∞ÔºåÂàô‰∏∫ÂÖàÊâãÂøÖËµ¢ÔºõÂèç‰πãÔºåÂàôÂêéÊâãÂøÖËµ¢</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; a, <span class="keyword">const</span> <span class="keyword">int</span>&amp; b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum ();</span><br><span class="line">sort (a + <span class="number">1</span>, a + N + <span class="number">1</span>, comp);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (a[i + <span class="number">1</span>] &lt;= i) &#123;</span><br><span class="line"><span class="keyword">bool</span> win = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> ((a[i] - i) &amp; <span class="number">1</span>)</span><br><span class="line">win = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (! win &amp;&amp; a[i + <span class="number">1</span>] == i) &#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= N; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[j] &lt; i) <span class="keyword">break</span>;</span><br><span class="line">cnt ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (! (cnt &amp; <span class="number">1</span>))</span><br><span class="line">win = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">win ? <span class="built_in">puts</span> (<span class="string">"First"</span>) : <span class="built_in">puts</span> (<span class="string">"Second"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="F-Leftmost-Ball"><a href="#F-Leftmost-Ball" class="headerlink" title="F - Leftmost Ball"></a>F - Leftmost Ball</h2><p>Âä®ÊÄÅËßÑÂàí</p><p>‰∏ÄÂºÄÂßãÊàëÊòØÊåâÁÖßÂ∏∏ËßÑÊÄùË∑ØÊÉ≥ÔºåÂπ∂‰∏îÂ∞Ü‰∏Ä‰∏™ÁôΩÁêÉ‰∏é‰∏ÄÁ±ªÈ¢úËâ≤ÁêÉÂΩìÂÅö‰∏Ä‰∏™Êï¥‰ΩìÊù•Â§ÑÁêÜÁöÑÔºåÂç≥ËÆæ $f_{i, j}$ Ë°®Á§∫Ââç $i$ ‰∏™‰ΩçÁΩÆÊîæÁΩÆ $j$ ‰∏™ÁôΩÁêÉÁöÑÊñπÊ°àÊï∞ÔºåÁÑ∂ËÄåÈ¶ñÂÖàËøôÊ†∑‰ºö $T$ÔºåÂπ∂‰∏îÂÆπÊòìÁÆóÈáçÔºå‰∫éÊòØÊàëÂéªÂ∫∑‰∫ÜÁúºÈ¢òËß£</p><p>ÁÑ∂ÂêéÂèëÁé∞ÂÆûÈôÖ‰∏äÁôΩÁêÉ‰∏çËÉΩ‰∏éÁ±ªÈ¢úËâ≤ÁêÉÊï¥‰ΩìËÄÉËôëÔºå‰∏çÁÑ∂‰ºöÁÆóÈáçÔºå‰ΩÜÊòØÊòæÁÑ∂‰∏ÄÁ±ªÈ¢úËâ≤ÁêÉÊòØÂèØ‰ª•Êï¥‰ΩìËÄÉËôëÁöÑÔºåÊïÖËÆæÁä∂ÊÄÅ $f_{i, j}$ Ë°®Á§∫Êîæ‰∫Ü $i$ ‰∏™ÁôΩÁêÉÂíå $j$ ‰∏™Á±ªÈ¢úËâ≤ÁêÉÁöÑÊñπÊ°àÊï∞ $(j \le i)$</p><p>ÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºåË¶ÅÂ¶Ç‰ΩïÁü•ÈÅìÊØè‰∏™ÁêÉÂú®ÂΩìÂâçÁä∂ÊÄÅ‰∏ãÁöÑ‰ΩçÁΩÆÂÖ≥Á≥ªÂë¢ÔºüÂõ†‰∏∫ÊÑüËßâ‰∏çÁü•ÈÅìÊ≤°Ê≥ïÁ°ÆÂÆöÁêÉÁöÑÂèØÊîæÁΩÆÊñπÊ°àÊï∞</p><p>ÂΩìÁÑ∂ÂÅáÂ¶ÇÁúüÁöÑË¶ÅÁü•ÈÅì‰ΩçÁΩÆÂÖ≥Á≥ªÊòØ‰∏çÂèØËÉΩÁöÑÔºåÊâÄ‰ª•‰ªîÁªÜÊÄùËÄÉ‰∏Ä‰∏ãÔºåÂèØ‰ª•ÂèëÁé∞ÔºåËã•ÂΩìÂâç‰Ω†Ë¶ÅÊîæ‰∏Ä‰∏™ÁôΩÁêÉÔºåÈÇ£‰πàÂú®‰Ω†ÊîæÂΩìÂâçÁôΩÁêÉÁöÑ‰ΩçÁΩÆ‰πãÂâçÁöÑ‰ΩçÁΩÆÂøÖÈ°ªÂ∑≤ÁªèË¢´ÂÆåÂÖ®Â°´Êª°Ôºå‰∏çÁÑ∂ÂøÖ‰ºöÂ≠òÂú®ËØ•ÁôΩÁêÉ‰πãÂêéÁöÑÁ±ªÈ¢úËâ≤ÁêÉÊîæÁΩÆÂú®ÂΩìÂâçÁôΩÁêÉÂâçÔºå‰ΩøÂæóÊñπÊ°à‰∏çÂêàÊ≥ïÔºåÊïÖÂΩìÂâçÁôΩÁêÉÊîæÁΩÆÁöÑÁõ∏ÂØπ‰ΩçÁΩÆ‰∏ÄÂÆöÂè™Êúâ‰∏Ä‰∏™ÔºåÂç≥ $f_{i, j} += f_{i - 1,j }$</p><p>ÂØπ‰∫éÊîæÁΩÆÁ±ªÈ¢úËâ≤ÁêÉÔºåÁî±‰∫éÂΩìÂâçÁ±ªÈ¢úËâ≤ÁêÉÁöÑÁôΩÁêÉÂ∑≤ÁªèÊîæÁΩÆÂÆåÊØïÔºåÊïÖÂÆÉËøòÂâ©‰∏ã $n \times k - i - (k - 1) \times(j - 1)$ ‰∏™‰ΩçÁΩÆÊîæÂÖ∂ $k - 1$ ‰∏™ÁêÉÔºå‰∏îÂΩìÂâçËøòÂâ©‰∏ã $n - (j - 1)$ ‰∏™È¢úËâ≤ÂèØ‰æõÈÄâÊã©ÔºåÊïÖÂæó $f_{i, j} += f_{i, j - 1} \times (n - j + 1) \times \dbinom{n \times k - i - (k - 1) \times (j - 1)}{k - 1}$</p><p>ÁÑ∂ËÄå‰Ω†‰ºöÂèëÁé∞ËøôÊ†∑ËøûÊ†∑‰æãÈÉΩËøá‰∏ç‰∫ÜÔºåÂõ†‰∏∫‰Ω†ÂèàÁÆóÈáç‰∫Ü</p><p>ÊØîÂ¶ÇÂØπ‰∫é</p><blockquote><p>{0, 0, 1, 2}</p></blockquote><p>Â∞±‰ºöÂ≠òÂú®ÂÖàÊîæ $\{0, 1\}$ ËøòÊòØ $\{0, 2\}$ ÁöÑÈóÆÈ¢òÔºåÁÑ∂Âêé‰ºöÊîæ‰∏§ÈÅçÔºåÊâÄ‰ª•ÁêÜËÆ∫‰∏äÂè™Ë¶ÅÊòØÂ≠òÂú®ËøûÁª≠ÁöÑ $0$ ÁöÑÈÉΩ‰ºöÁÆóÈáç</p><p>‰∫éÊòØ‰∏ÄÊó∂ËÑëÊäΩÔºåÂèàÂè™ËÉΩÁûÑÈ¢òËß£‰∫Ü</p><p>ÂÖ∂ÂÆûËß£ÂÜ≥ÊñπÊ°àÊûÅÂÖ∂ÁÆÄÂçïÔºåÂè™Ë¶ÅÊª°Ë∂≥ÂΩìÂâçÊîæÁöÑÁ±ªÈ¢úËâ≤ÁêÉÁöÑÁ¨¨‰∏Ä‰∏™‰∏ÄÂÆöÊòØÊúÄÊé•Ëøë $0$ ÁöÑÂ∞±Ë°å‰∫ÜÔºå‰πüÂ∞±ÊòØËßÑÂÆöÂÖ∂ÊîæÁΩÆÈ°∫Â∫è</p><p>ÊïÖÁªº‰∏äÊâÄËø∞ÔºåËΩ¨ÁßªÊñπÁ®ã‰∏∫<br>$$<br>f_{i, j} = f_{i - 1, j} + f_{i, j - 1} \times (n - j + 1) \times \dbinom{n \times k - i - (k - 1) \times (j - 1) - 1}{k - 2}<br>$$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"></span><br><span class="line">LL fact[MAXM]= &#123;<span class="number">0</span>&#125;, invfact[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">fact[<span class="number">0</span>] = fact[<span class="number">1</span>] = invfact[<span class="number">0</span>] = invfact[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N * K; i ++) &#123;</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[i] = (MOD - MOD / i) * invfact[MOD % i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N * K; i ++)</span><br><span class="line">invfact[i] = invfact[i - <span class="number">1</span>] * invfact[i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL f[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d"</span>, &amp; N, &amp; K);</span><br><span class="line"><span class="keyword">if</span> (K == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">"1"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">init ();</span><br><span class="line">f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++) &#123;</span><br><span class="line">LL delta = f[i][j - <span class="number">1</span>] * (N - j + <span class="number">1</span>) % MOD * C (N * K - i - (K - <span class="number">1</span>) * (j - <span class="number">1</span>) - <span class="number">1</span>, K - <span class="number">2</span>) % MOD;</span><br><span class="line"><span class="keyword">if</span> (j == <span class="number">0</span>) delta = <span class="number">0</span>;</span><br><span class="line">f[i][j] = (f[i][j] + f[i - <span class="number">1</span>][j] + delta) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; f[N][N] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2000 2000</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊØîËµõ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AtCoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC001 E - Wide Swap</title>
      <link href="/2020/08/04/AGC001%20E%20-%20Wide%20Swap/"/>
      <url>/2020/08/04/AGC001%20E%20-%20Wide%20Swap/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>È¶ñÂÖàÊòæÁÑ∂Ë¶ÅÂÖàÊääÂéüÊï∞ÁªÑÈáçÊñ∞Êò†Â∞Ñ‰∏Ä‰∏ãÔºå‰ª§Êò†Â∞ÑËøáÂêéÁöÑÊï∞ÁªÑ‰∏∫ $a_i$</p><p>Âõ†‰∏∫È¢òÁõÆË¶ÅÊ±Ç $|a_j - a_i| &gt;= K$ ÁöÑÂèØ‰ª•ÁΩÆÊç¢ÔºåÈÇ£‰πàÂèç‰πãÔºåÂàôÊúâ $|a_j - a_i| &lt; K$ ÁöÑ $i, j$ Áõ∏ÂØπ‰ΩçÁΩÆ‰∏çÂèò</p><p>ÊïÖÊúÄÁÆÄÂçïÁöÑÊñπÊ≥ïÂ∞±ÊòØÂØπ‰∫éÊØè‰∏™ $i$ÔºåÂ∞ÜÂÖ∂‰∏éÊâÄÊúâÊª°Ë∂≥ $|a_j - a_i| &lt; K$ ÁöÑ $j$ ËøûËæπÔºåÁÑ∂ÂêéË∑ë‰∏ÄËæπÊãìÊâëÔºåÂ§çÊùÇÂ∫¶ $O (n^2)$</p><p>ÁÑ∂ÂêéËÄÉËôëÂú® $a_i$ ËøûÁöÑËøô‰πàÂ§öËæπ‰∏≠ÔºåËã•ÊòØÂ≠òÂú®Ëæπ $(i, j), (j, k), (i, k)$ÔºåÂÖ∂‰∏≠ $i &lt; j &lt; k$ÔºåÈÇ£‰πàÊòæÁÑ∂ $(i, k)$ ÁöÑÂ≠òÂú®ÊÄßÊòØÊó†ÂÖ≥Á¥ßË¶ÅÁöÑ</p><p>Âèà $a_i$ ÂèØËøûËæπÁöÑÊùÉÂÄºËåÉÂõ¥ÊòØ $(a_i - K, a_i) \cup (a_i, a_i + K)$ÔºåÈÇ£‰πàÂè™ÈúÄË¶ÅÂàÜÂà´Âêë‰∏§‰∏™Âå∫Èó¥‰∏≠Ê†áÂè∑ÊúÄÂ∞èÁöÑÈÇ£‰∏™ÁÇπËøûËæπÂ∞±Â•Ω‰∫ÜÔºàÂçïÂêëËæπÔºåÂπ∂‰∏î‰∏ÄÂÆöÂêëÊ†áÂè∑ÊØîËá™Â∑±Â§ßÁöÑÁÇπËøûÔºâÔºåËøôÊ†∑Â∞±Áõ∏ÂΩì‰∫éÊòØÂ∞ÜÂéüÊù•ÁöÑ‰π±‰∏ÉÂÖ´Á≥üËøûÊé•ÁöÑÂõæÂèòÊàê‰∫Ü‰∏ÄÊù°Êù°ÂçïÂêëÁöÑÈìæÔºåÂπ∂‰∏îËøô‰∫õÈìæÂèØ‰ª•Ë¶ÜÁõñÂéüÊù•ÁöÑÊâÄÊúâÊÉÖÂÜµ</p><h2 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;, b[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> minv[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">minv[root] = value;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) modify (lson, left, mid, posi, value);</span><br><span class="line"><span class="keyword">else</span> modify (rson, mid + <span class="number">1</span>, right, posi, value);</span><br><span class="line">minv[root] = min (minv[lson], minv[rson]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &gt; R) <span class="keyword">return</span> INF;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R)</span><br><span class="line"><span class="keyword">return</span> minv[root];</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> mv = INF;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) mv = min (mv, query (lson, left, mid, L, R));</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) mv = min (mv, query (rson, mid + <span class="number">1</span>, right, L, R));</span><br><span class="line"><span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> indeg[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt; &gt; que;</span><br><span class="line"><span class="keyword">int</span> ret[MAXN]= &#123;<span class="number">0</span>&#125;, rcnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">topo</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! indeg[i])</span><br><span class="line">que.push(i);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> p = que.top();</span><br><span class="line">que.pop();</span><br><span class="line">ret[p] = ++ rcnt;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[p]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">indeg[v] --;</span><br><span class="line"><span class="keyword">if</span> (! indeg[v]) que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">b[a[i]] = i;</span><br><span class="line"><span class="built_in">memset</span> (minv, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (minv));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt;= <span class="number">1</span>; i --) &#123;</span><br><span class="line"><span class="keyword">int</span> p1 = query (<span class="number">1</span>, <span class="number">1</span>, N, max (<span class="number">1</span>, b[i] - K + <span class="number">1</span>), b[i] - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> p2 = query (<span class="number">1</span>, <span class="number">1</span>, N, b[i] + <span class="number">1</span>, min (N, b[i] + K - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">if</span> (p1 &gt;= <span class="number">1</span> &amp;&amp; p1 &lt;= N) Insert (b[i], b[p1]), indeg[b[p1]] ++;</span><br><span class="line"><span class="keyword">if</span> (p2 &gt;= <span class="number">1</span> &amp;&amp; p2 &lt;= N) Insert (b[i], b[p2]), indeg[b[p2]] ++;</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, N, b[i], i);</span><br><span class="line">&#125;</span><br><span class="line">topo ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ret[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 2</span></span><br><span class="line"><span class="comment">4 2 3 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 1</span></span><br><span class="line"><span class="comment">5 4 3 2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8 3</span></span><br><span class="line"><span class="comment">4 5 7 8 3 1 2 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ÊÄùÁª¥ </category>
          
          <category> Êï∞ÊçÆÁªìÊûÑ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊÄùÁª¥ </tag>
            
            <tag> Á∫øÊÆµÊ†ë </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
