<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>It&#39;s Time To Learn PYTHON! (record of python challenges)</title>
      <link href="/2021/09/09/Time%20To%20Learn%20Python/"/>
      <url>/2021/09/09/Time%20To%20Learn%20Python/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="Itâ€™s-Time-To-Learn-PYTHON-record-of-python-challenges"><a href="#Itâ€™s-Time-To-Learn-PYTHON-record-of-python-challenges" class="headerlink" title="Itâ€™s Time To Learn PYTHON! (record of python challenges)"></a>Itâ€™s Time To Learn PYTHON! (record of python challenges)</h1><h3 id="The-First-Pass"><a href="#The-First-Pass" class="headerlink" title="The First Pass"></a>The First Pass</h3><p>The gibberish displayed on the screen is a passcode which is coded with Caeser cipeher, one of the simplest encryption techniques. From the Wikipedia, we can know that</p><blockquote><p>It is a type of substitution cipher in which each letter in the plaintext is replaced by a letter some fixed number of positions down the alphabet. For example, with a left shift of 3, D would be replaced by A, E would become B, and so on.</p></blockquote><p>So I first wrote a code like this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">para = input ()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> para:</span><br><span class="line">    <span class="keyword">if</span> ord (i) &gt;= ord (<span class="string">"a"</span>) <span class="keyword">and</span> ord (i) &lt;= ord (<span class="string">"z"</span>):</span><br><span class="line">        <span class="keyword">print</span> ((chr)((ord (i) + <span class="number">2</span> - ord (<span class="string">"a"</span>)) % <span class="number">26</span> + ord (<span class="string">"a"</span>)), end = <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">else</span>: <span class="keyword">print</span> (i, end = <span class="string">""</span>)</span><br></pre></td></tr></table></figure><p>Apparently, it is quite cumbersome. After decoding, we can learn from the text that $string.maketrans ()$ is recommanded to be used when facing such problem. So I rewrote the code:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">intext = <span class="string">"abcdefghijklmnopqrstuvwxyz"</span></span><br><span class="line">outext = <span class="string">"cdefghijklmnopqrstuvwxyzab"</span></span><br><span class="line">trans = str.maketrans (intext, outext);</span><br><span class="line"></span><br><span class="line">para = input ()</span><br><span class="line"><span class="keyword">print</span> (para.translate (trans))</span><br></pre></td></tr></table></figure><p>And the code is simpler now. Follow the tips translated, you only need to apply the encryption technique into the url â€œmapâ€ so that we can get â€œocrâ€. After replacing â€œmapâ€ with â€œocrâ€, we can get to the second pass.</p><h3 id="The-Second-Pass"><a href="#The-Second-Pass" class="headerlink" title="The Second Pass"></a>The Second Pass</h3><blockquote><p>recognize the characters. maybe they are in the book, but MAYBE they are in the page source.</p></blockquote><p>It hints us the solution hides in the page source. After opening the page source, we can see another hint and a long string containing various notations, that is</p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/15/hrOlSE9UHZdxpW8.png" alt="psource.png" style="zoom:50%;" /><p>It hints us to find the characters. But how can we get the content of page source? There is a package named $\text{urllib}$, where we can import function <code>urllib.request.urlopen</code> to load raw html data. Then we use function  <code>read</code> and  <code>decode</code>to decode the html and use regular expression to extract the comment blocks.</p><p>Now we have transformed the comment blocks into a string without <code>\n</code>, so the solution is obvious now. We apply <code>re.findall</code> to the string again then we can find the answer $\text{equality}$</p><p>The code is shown below</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">myURL = urlopen (<span class="string">"http://www.pythonchallenge.com/pc/def/ocr.html"</span>)</span><br><span class="line">url = myURL.read().decode()</span><br><span class="line">readl = re.findall (<span class="string">"&lt;!--\s%[\s\S]*--&gt;"</span>, url)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">""</span>.join (re.findall (<span class="string">"[a-zA-Z]"</span>, readl[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure><h3 id="The-Third-Pass"><a href="#The-Third-Pass" class="headerlink" title="The Third Pass"></a>The Third Pass</h3><p>Nearly the same as the second pass.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">myURL = urlopen (<span class="string">"http://www.pythonchallenge.com/pc/def/equality.html"</span>)</span><br><span class="line">url = myURL.read().decode()</span><br><span class="line">readl = re.findall (<span class="string">"&lt;!--[\s\S]*--&gt;"</span>, url)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">""</span>.join (re.findall (<span class="string">"[^A-Z][A-Z]&#123;3&#125;([a-z])[A-Z]&#123;3&#125;[^A-Z]"</span>, readl[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> AMP Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒNOTESã€Discrete Mathematical Tools for Computer Science</title>
      <link href="/2021/09/03/COMP2711H_Note/"/>
      <url>/2021/09/03/COMP2711H_Note/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="Discrete-Mathematical-Tools-for-Computer-Science"><a href="#Discrete-Mathematical-Tools-for-Computer-Science" class="headerlink" title="Discrete Mathematical Tools for Computer Science"></a>Discrete Mathematical Tools for Computer Science</h1><p>$\text{NOTES ABOUT THE LECTURE}$</p><h2 id="LOGIC"><a href="#LOGIC" class="headerlink" title="LOGIC"></a>LOGIC</h2><h3 id="Useful-Formulas"><a href="#Useful-Formulas" class="headerlink" title="Useful Formulas"></a>Useful Formulas</h3><h4 id="Propositional-Equivalences"><a href="#Propositional-Equivalences" class="headerlink" title="Propositional Equivalences"></a>Propositional Equivalences</h4><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/CNzWALQ7wJ1MftD.png" alt="image-20210906104439334" style="zoom:30%;" /><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/Iyh6MeRCoAqJtU8.png" alt="image-20210906104510549" style="zoom:30%;" /><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/rNxQnSZD6sw84Ro.png" alt="image-20210906104528796" style="zoom:30%;" /><h4 id="Logical-Equivalence"><a href="#Logical-Equivalence" class="headerlink" title="Logical Equivalence"></a>Logical Equivalence</h4><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/sHN6k1bIRJPZhMi.png" alt="image-20210906104751436" style="zoom:30%;" /><h4 id="Rules-of-Inference"><a href="#Rules-of-Inference" class="headerlink" title="Rules of Inference"></a>Rules of Inference</h4><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/HaWMgRPXd7oxOjN.png" alt="image-20210906105011875" style="zoom:30%;" /><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/6QrRVfxXP8ZjIUl.png" alt="image-20210906105030632" style="zoom:30%;" /><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2021/09/09/dN8gWExi5apYHyD.png" alt="image-20210906105050283" style="zoom:30%;" /><blockquote><p>A real number $r$ is <strong>rational</strong> if there exist integers $p$ and $q$ with $q \neq 0$ such that $r = p / q$. A real number that is not rational is called <strong>irrational</strong></p></blockquote><p>And thereâ€™s a brand new basic proof technique to me â€” Proof by Contraposition.</p><p>We take $\neg q$ as a hypothesis, and then show that $\neg p$ must follows.</p><blockquote><p>Let $f$: ğ™ â†’ ğ™ assign the square of an integer to this integer. Then $f(x) = x^2$, where the domain of $f$ is the set of all integers, we take the <strong>codomain</strong> of $f$ to be the set of all integers, and the <strong>range</strong> of $f$ is the set of all integers that are perfect squares, namely, $\{0, 1, 4, 9, â€¦\}$</p></blockquote><h3 id="Notes-of-solving-problems"><a href="#Notes-of-solving-problems" class="headerlink" title="Notes of solving problems"></a>Notes of solving problems</h3><ul><li><p>If you are required to proof $A \rightarrow B$ is true, then it suffices to show that whenever $A$ is true, $B$ is also true.</p></li><li><p>Sometimes some problems like â€œProof $\exists x \forall y P(x, y) \rightarrow \forall y \exists x P(x, y)$ is a tautologyâ€ , you donâ€™t need to proof it by developing a series of logical equivalences. Instead, you only need to use simple words to explain it. Take the problem above for example:</p><p>If $\exists x \forall y P(x, y)$ is true, then there is some $x$, namely $x_0$ such that for all $y$, $P(x_0, y)$ is true. Therefore, for all $y$, $x_0$ makes $P(x_0, y)$ true, which implies that $\forall y \exists x P(x, y)$ is true.    (Solution from professorâ€™s slide)</p></li><li><p>Use quantifiers to show â€˜uniqueâ€™</p><p>$e.g.$ <strong>Express the statement â€œEveryone has exactly one best friendâ€ as a logical expression involving predicates, quantiï¬ers with a domain consisting of all people, and logical connectives, where $B (x, y)$ means â€œ$y$ is the best friend of $x$â€</strong></p><p>Answerï¼š$\forall x \exists y ((B (x, y) \land \forall z((z \neq y) \rightarrow \lnot B (x, z)))$</p><p>To express $\exists ! x$, thereâ€™s an another form of formulaï¼š$\exists x P(x) \land \forall x \forall y ((P(x) \land P(y)) \rightarrow x = y)$</p></li><li><p>Example of proving certain number is rationalï¼šã€ŒProve that $\sqrt 2$ is irrationalã€</p><p>Let us prove it by contradiction.</p><p>Suppose $\sqrt 2$ is rational, then there exists integers $a$ and $b$ such that $\sqrt 2 = \frac{p}{q}$, where $a$ and $b$ have no common factors.</p><p>Then,<br>$$<br>\begin{aligned}<br>&amp;2 = \frac{p^2}{q^2} \\<br>\Rightarrow &amp;2q^2 = p^2 \\<br>\end{aligned}<br>$$<br>So $p^2$ is even, and we can deduce that $p$ is even.  Suppose an integer such that $p = 2m$. Therefore, $2q^2 = p^2 = 4m^2$. Therefore, $q^2 = 2m^2$. And we can see from the equation that $q$ is also even.</p><p>But $2 | p$ and $2 | q$â€™s both being true do not follow the premise that $p$ and $q$ have no common factors. Therefore, $\sqrt 2$ cannot be rational.</p></li><li><p><strong>Prove that the set of the rational numbers is countable</strong></p><p>There is a illumination proof in $Schroeder$ with a reference to $Sagher$. Let me give a brief illustration beneath.</p><p>For a rational number $t = \frac{a}{b}$, where $a, b$ are both integer. And the prime factor decompostion of $a$ is $p_1^{x_1}p_2^{x_2}â€¦p_n^{x_n}$, the same, $bâ€™s$ is $q_1^{y_1}q_2^{y_2}â€¦q_m^{y_m}$. We assume a function $f(x)$ to be $f(\frac{a}{b}) = p_1^{2x_1}p_2^{2x_2}â€¦p_n^{2x_n} \times q_1^{2y_1 - 1}q_2^{2y_2 - 1}â€¦q_m^{2y_m - 1}$, and it is easy to prove that the function is a one-to-one correspondence, for for all natural numbers $N$, it has a representatation as a fractor, then we seperate the primes with even and odd exponents. We can see that to any integer $N$ there correspond a rational number $t$ such that $f(t) = N$</p></li></ul><h2 id="Number-Theory"><a href="#Number-Theory" class="headerlink" title="Number Theory"></a>Number Theory</h2><h3 id="GCD-amp-ExGCD"><a href="#GCD-amp-ExGCD" class="headerlink" title="GCD &amp; ExGCD"></a>GCD &amp; ExGCD</h3><p>As we all know, it is easy to realize ExGCD algorithm by programming, but how can we realize it by hand?</p><p>Suppose we have two numbers, 252 and 198. Now we simulate the process of GCD (we suppose $a = kb + r (k \in \mathbb{Z})$:</p><table><thead><tr><th align="center">$a$</th><th align="center">$b$</th><th align="center">$r$</th></tr></thead><tbody><tr><td align="center">252</td><td align="center">198</td><td align="center">54</td></tr><tr><td align="center">198</td><td align="center">54</td><td align="center">36</td></tr><tr><td align="center">54</td><td align="center">36</td><td align="center">18</td></tr></tbody></table><p>Then we have<br>$$<br>54 = 252 - 198 \\<br>36 = 198 - 3 \times 54 \\<br>18 = 54 - 36<br>$$<br>Substitude<br>$$<br>\begin{aligned}<br>18 &amp;= 54 - 36 \\<br>&amp;= 54 - (198 - 3 \times 54) \\<br>&amp;= 4 \times 54 - 198 \\<br>&amp;= 4 \times (252 - 198) - 198 \\<br>&amp;= 4 \times 252 - 5 \times 198<br>\end{aligned}<br>$$<br>Follow the steps above, we finish the $\text{ExGCD}$ process.</p><p>And here we give out the normal $\text{ExGCD}$ process:<br>$$<br>\begin{aligned}<br>ax + by &amp;= (a, b) \\<br>&amp;= (b, a - \lfloor\frac{a}{b}\rfloor \times b) \\<br>&amp;= mb + n(a - \lfloor\frac{a}{b}\rfloor \times b) \\<br>&amp;= an + (m - \lfloor\frac{a}{b}\rfloor \times n) \times b<br>\end{aligned}<br>$$</p>]]></content>
      
      
      <categories>
          
          <category> æ•°å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>A.F.O.å¿ƒè·¯å†ç¨‹&amp;NOI2020æ¸¸è®°</title>
      <link href="/2021/07/19/A_F_O/"/>
      <url>/2021/07/19/A_F_O/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ä»¥ä¸€å— $Cu$ ç»“æŸäº†è¿™ä¹ˆå¤šå¹´çš„ $\text{OI}$ ç”Ÿæ¶¯</p><p>$Day ~ ~ 0$ çš„ç¬”è¯•ååˆ†é¡ºåˆ©åœ°æ‹¿åˆ°äº† $100$ åˆ†æ»¡åˆ†ï¼Œæ™šä¸Šä¸€ç›´åœ¨è‚æ¨¡æ¿ï¼Œä½†å¥½åƒå®é™…ä¸Šå¹¶æ²¡æœ‰å•¥ç”¨ï¼Œéœ€è¦æ¨¡æ¿çš„éƒ¨åˆ†åˆ†ä¼°æ‘¸ç€å¤§å¤šéƒ½å¿«åˆ°æ­£è§£äº†ï¼Œå’±ä¹Ÿæƒ³ä¸åˆ°</p><p>$Day ~ ~ 1$ å¼€å§‹å‰ï¼ŒæŒ‰ç…§å¾€å¹´æˆç»©ï¼Œæˆ‘ç»™è‡ªå·±å®šä¸‹åœ°åˆ†æ•°ç›®æ ‡å¤§æ¦‚æ˜¯ $Day ~ ~ 1$ è¦å¤§äºç­‰äº $150$ï¼Œ$Day ~ ~ 2$ å¤§äºç­‰äº $130$ å·¦å³ï¼Œä½†æˆ‘è®¤ä¸ºè¿™æ ·çš„ç›®æ ‡é—´æ¥é€ æˆäº† $Day ~~ 1$ æ¯”è¾ƒå¤§çš„å¤±åˆ©</p><p>$T1$ çœ‹äº†å¤§æ¦‚ $20min$ å·¦å³å°±æƒ³åˆ°äº† $O (kn^3\log n)$ çŸ©é˜µä¹˜æ³•çš„æ€è·¯ï¼Œä½†å¥½åƒæ€ä¹ˆç®—éƒ½æœ€å¤šåªèƒ½è¿‡ $k = 0$ çš„ç‚¹ï¼Œå‰©ä¸‹çš„æ€ä¹ˆç®—éƒ½è¿‡ä¸å»ï¼ˆå®é™…ä¸Šæˆ‘è®¤ä¸ºè¿™çŸ©ä¹˜å¯ä»¥è¿‡ $k = 0$ çš„æ—¶å€™æ—¶é—´ä¹Ÿå·²ç»è¿‡å»äº†å¾ˆä¹…ï¼‰ï¼Œç»“åˆæš´åŠ›è¿™æ ·å°±æœ‰ $65 pts$ äº†ï¼Œä½†ç”±äºç»™è‡ªå·±å®šä¸‹çš„ç›®æ ‡ï¼Œæˆ‘ä¸€ç›´åœ¨æƒ³åç»­è§£æ³•ï¼Œä¸€ç›´çŠ¹è±«åˆ°æƒ³åˆ°äº†  $1h45min$ å·¦å³ä¹Ÿæ²¡å•¥æƒ³æ³•ï¼Œè¿™æ—¶æˆ‘ç®—æ˜¯æ¯”è¾ƒæ…Œå¼ äº†ï¼Œå› ä¸ºæˆ‘æœ¬æ¥æ˜¯æ‰“ç®—æ¯é¢˜æ•´ä¸ª $1.5h$ï¼Œæ¯”è¾ƒä»å®¹ï¼Œä½†è¿™ä¹ˆä¼˜æŸ”å¯¡æ–­ä¸€ä¸‹å¯¼è‡´æˆ‘æœ€ç®€å•çš„æš´åŠ›éƒ½ä¸€ç›´æ‰“é”™ï¼Œæœ€ååˆ° $2.5h$ æ‰å‹‰å‹‰å¼ºå¼ºå†™å®Œäº† $50 pts$ï¼Œå‰©ä¸‹ $15 pts$ æ²¡åŠæ³•äº†åªèƒ½å…ˆæ™¾ä¸€è¾¹</p><p>è¿™æ—¶å€™å¼€ $T2$ï¼Œç®€å•å®¹æ–¥å¾ˆå¥½æƒ³ï¼Œä½†æˆ‘å¡åœ¨äº†å¦‚ä½•é«˜æ•ˆçš„è®¡ç®—é€‰å‡ºçš„æ¯ç§é›†åˆåŒ…å«çš„ç‚¹æ•°ï¼Œæƒ³æ¥æƒ³å»æ„Ÿè§‰æ ‘å‰–æ¯”è¾ƒåˆç†ï¼Œä½†è¿‡ $5e05$ è¿˜æ˜¯æ¯”è¾ƒæ‚¬ï¼Œæœ¬æ¥æƒ³ç€èƒ½ä¸èƒ½å¯¹æ¯æ¡è¾¹è€ƒè™‘æ¥è®¡ç®—ç­”æ¡ˆçœ‹çœ‹èƒ½ä¸èƒ½æ‹¿æ›´é«˜ï¼Œä½†å¥½åƒæä¸å‡ºæ¥ï¼Œæ­¤æ—¶å·²ç»åˆè¿‡äº† $1h$ï¼Œå¸å–äº† $T1$ çš„æ•™è®­ï¼Œæˆ‘æœæ–­å¼€å§‹æ ‘å‰–ï¼ŒèŠ±äº† $15 \sim 20min$ å·¦å³æ•²å®Œï¼Œå‘ç°æ¯æ¬¡ä¼šå¤šè¦†ç›–ä¸€ä¸ª $lca$ï¼Œæœ¬æ¥æƒ³ç€æ¯æ¬¡è·³å®ŒæŠŠ $lca$ å†åˆ å»ï¼Œç»“æœçº¿æ®µæ ‘éƒ¨åˆ†æ­»æ´»å†™ä¸å‡ºæ¥ï¼Œåªå¥½æ”¾å¼ƒï¼Œæ”¹ $bitset$ ç›´æ¥æš´åŠ›æ•´é›†åˆç„¶åå–å¹¶ï¼Œå†™å®Œå·²ç» $4h20min$ äº†</p><p>äºæ˜¯åªå‰©ä¸‹ $40min$ å†™ $T3$ï¼Œçœ‹å®Œé¢˜ç›®ç”¨ $5 \sim 10min$ å†™äº† $24 pts$ çš„æš´åŠ›ï¼Œå¼€å§‹æƒ³å‰©ä¸‹çš„éƒ¨åˆ†åˆ†ï¼Œè¿˜ä»¥ä¸º $Subtask 2$ å¯ä»¥ç›´æ¥ä¸€ä¸ªä¸»å¸­æ ‘äº†äº‹ï¼Œå†™å®Œäº†ä¸»å¸­æ ‘æ‰å‘ç°å‡äº†ï¼Œè¿™ä¸ªæ—¶å€™å¤§æ¦‚å°± $4h45min$ äº†ï¼Œæƒ³æ”¾å¼ƒäº†ï¼Œå·®ç‚¹ <code>freopen</code> æ²¡å¼€ç›´æ¥è§ç¥–å®—ï¼Œæƒ³ç€ä»Šå¤©åªæœ‰ $102 pts$ æœ‰ç‚¹å¿ƒæ€çˆ†ç‚¸ï¼Œäºæ˜¯åœ¨ä¸€ç‰‡æ··æ²Œä¹‹ä¸‹è¿‡å®Œäº†å‰©ä¸‹çš„ $15min$</p><p>æœ€ç»ˆ $T1$ å†™æŒ‚äº†ç¯çš„éƒ¨åˆ†ï¼Œ$T3$ å¤šäº† $8 pts$ï¼Œæœ€ç»ˆ $40 + 28 + 32 = 104$ï¼Œæ¯”é¢„æœŸé«˜äº† $2 pts$ï¼Œå‡ºæ¥ä¸€çœ‹å‡ ä¹æ‰€æœ‰äººéƒ½æ˜¯ $190+$ï¼Œè¿˜æœ‰ $270+$ ç”šè‡³ $AK$ çš„ï¼Œå‘ç° $T1$ ç”¨ $1 \times n$ çš„çŸ©é˜µæ¥ä¹˜ï¼ŒåŒæ—¶äºŒè¿›åˆ¶æ‹†åˆ†ä¸€ä¸‹çš„ $trick$ å°±å¯ä»¥ $O (kn^2\log n)$ ç›´æ¥åˆ‡æ‰ï¼Œå¥½åƒè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸è§„çš„ $trick$ï¼Ÿä¸è¿‡æˆ‘æ²¡è§è¿‡ï¼Œç®—äº†ã€‚$T2$ çš„ $40 pts$ ç›´æ¥è€ƒè™‘æ¯æ¡è¾¹çš„è´¡çŒ®ç„¶åå­é›†å’Œä¸€ä¸‹å°±å¥½ï¼Œå‰©ä¸‹çš„ $60 pts$ æ˜¯æ ‘å½¢ $dp$ï¼Œå¯æƒœäº†æ²¡æƒ³åˆ° $40 pts$ï¼Œè¿™è‚¯å®šåœ¨æˆ‘èƒ½åŠ›èŒƒå›´ä¹‹å†…</p><p>æ™šä¸Šå¬è®²è¯„ $T3$ æ˜¯ $lxl$ å‡ºçš„å¤§åˆ†å—é¢˜ï¼ŒåŸæ¥ $NOI$ ä¹Ÿè€ƒ $YnOI$ é‚£äº›ç©æ„å„¿å•Šã€‚ã€‚åæ­£æˆ‘åˆ†å—å†™çš„æ¯”è¾ƒå°‘ï¼Œä»€ä¹ˆé«˜ç»´è«é˜Ÿç¬¬åä¸‰åˆ†å—å•¥çš„æˆ‘ä¹Ÿä¸ä¼šï¼Œä¸è¿‡ $lxl$ çš„å¤´å‘å¥½é•¿ã€‚ã€‚<code>æœç”°è¯—ä¹ƒ</code> è¿‡æ¥å†™è¯´ä¸å®šèƒ½åˆ‡ï¼Ÿæœ€åè¯´äº†ä¸‹å¤§æ¦‚çš„æˆç»©åˆ†å¸ƒï¼Œç®—ä¸Šé›†è®­é˜Ÿå’Œ $Dã€E$ ç±»ï¼Œ$240+$ é˜Ÿçº¿ï¼Œ$148$ å‰ $200$ï¼Œæˆ‘ä¼°æ‘¸ç€å»æ‰é‚£äº›äººå¤§æ¦‚ $125 \sim 130$ åº”è¯¥æ˜¯æ­£ç»Ÿçš„å‰ $200$ï¼Œå¯æƒœäº†</p><p>$Day ~ ~ 1$ ä¸‹åˆå’Œæ™šä¸Šå°±é¢“ï¼Œç„¶åä¹°äº†ä¸¤æœ¬ä¹¦ï¼Œçœ‹äº†ä¼šå„¿ï¼Œç¡è§‰</p><p>$Day ~ ~ 2$ æƒ³ç€èƒ½ä¸èƒ½ç¿»ç›˜ï¼Œä½†å¥½åƒåˆæ²¡å•¥å¸Œæœ›ï¼Œäºæ˜¯å°±åœ¨ä¸¤ç§æ€æƒ³ä¸­æŒ£æ‰</p><p>è¿›è€ƒåœºå¼€ $T1$ï¼ŒèŠ±äº† $15min$ éšä¾¿æƒ³äº†ä¸€ä¸ªè´ªå¿ƒï¼Œè¯•äº†ä¸€ä¸‹ï¼Œå¥½åƒèƒ½è¿‡ $n \le 4$ å’Œ $m = n - 1$ çš„ï¼Ÿè¯´ä¸å®š $m \ge n$ çš„ä¹Ÿèƒ½è¿‡ï¼Œç„¶åå°±å‡è£…æœ‰ $35 pts$ï¼Œå¼€å§‹æƒ³å‰©ä¸‹çš„ï¼Œä¸€ç›´è§‰å¾—è¿™é¢˜åº”è¯¥æ˜¯ä¸€ä¸ªç½‘ç»œæµï¼Œä½†åªèƒ½é€‰ $1 \sim 2$ ä¸ªçš„é™åˆ¶å°±è®©æˆ‘æ­»æ´»æ„ä¸å‡ºå›¾æ¥ï¼Œå‡ æ¬¡æƒ³åˆ°äº†å‡ ä¸ªå›¾æ„Ÿè§‰æ²¡æ¯›ç—…ï¼Œç»“æœç­‰è´¹ç”¨æµçš„æ•²å®Œäº†æ‰å‘ç°å‡çš„ä¸èƒ½å†å‡ï¼Œäºæ˜¯å°±è¿™æ ·æ··æ²Œåœ°åº¦è¿‡äº† $1h45min$ï¼Œå»ç„äº†ä¸€çœ¼ $T2$ï¼Œé¢˜é¢è´¼é•¿ä½†æŒºæœ‰æ„æ€ï¼Œç†è§£å®Œé¢˜æ„è§‰å¾—è¿™ç©æ„å„¿ä¸€çœ‹å°±çŸ¥é“ä¸æ˜¯æˆ‘ä¼šå†™çš„ï¼Œç¥äº†çœ¼éƒ¨åˆ†åˆ†ï¼Œ$12 pts$ ä¸€çœ¼ï¼Œå‰©ä¸‹çš„éƒ½ä¸ä¼šï¼Œäºæ˜¯æˆ‘æ‰“ç®—å†™ $12 pts$ï¼Œå‰©ä¸‹çš„ç›´æ¥åŠ ä¸€äº›ç‰¹åˆ¤ç„¶å $rand ()$ï¼Œç„¶åæ»šå› $T1$</p><p>$Day ~ ~ 2$ ç”±äºé¢˜ç›®å¯¹æˆ‘æ¯”è¾ƒè‡ªé—­æ‰€ä»¥æ—¶é—´ä¹Ÿæ‡’å¾—ç®¡äº†ï¼Œåæ­£éƒ½ä¸ä¼šã€‚ã€‚ä¸çŸ¥ä½•æ—¶å¼€äº†ä¸‹ $T3$ï¼Œå‘ç°è¿ $30 pts$ éƒ½ä¸ä¼šï¼Œæƒ³ç€ç©çƒäº†ï¼Œç„¶åæ•²äº†ä¸ªæ·±æœå†éšä¾¿è¾“å‡ºäº†ä¸ªæœ€çŸ­è·¯éª—åˆ†</p><p>äºæ˜¯ $Day ~ ~ 2$ å°±åœ¨é¢˜ç›®äº¤å‰æ··æƒ³ï¼ˆä¸»è¦åœ¨æƒ³ $T1$ ç½‘ç»œæµï¼‰ä¸­ç»“æŸäº†ï¼ˆæœ€åæˆ‘ $T1$ ç”¨è´ªå¿ƒéª—åˆ†ï¼‰</p><p>$CCF$ æ™šäº† $1.5h$ æ‰å¼€æˆç»©ï¼Œåœ¨åœºå¤–æ‰‹æœºéƒ½å¿«çœ‹æ²¡ç”µäº†ã€‚ã€‚æœ€ç»ˆ $35 + 4 + 0 = 39$ï¼Œ$T2$ ä¼°è®¡æ˜¯åé¢é­”æ”¹å®Œå¿˜è®°å†æµ‹ä¸€ä¸‹ $h_{max} \le 2$ çš„æ•°æ®ç»“æœç¿»è½¦äº†ï¼Œ$T3$ å¿˜è®°è¾“å‡º $- 1$ ä¸ç„¶èƒ½æœ‰ $5 pts$ï¼Œäº‹å®è¯æ˜ä½ ä¸èƒ½ç”¨è„¸ç¿»ç›˜ï¼Œç²‰å…” $T1$ éšæœºåŒ– $70 +$ï¼Œ$nealchen$ è¾¾åˆ°äº† $200$ æ•´ï¼Œä»–ä»¬çœ‹ç€å¿…è¿›é˜Ÿå•Šï¼Œå¾ˆå‰å®³</p><p>è®²è¯„ä¹ŸæŒºä¸å¤ªæ‡‚ï¼Œå¥½åƒæˆ‘ $T1$ çš„ $35 pts$ çš„è´ªå¿ƒè·Ÿæ­£è§£ä¸æ˜¯ä¸€å›äº‹ï¼Ÿåæ­£å°±æ˜¯ä¼šçš„ä¼šï¼Œä¸ä¼šçš„è¿˜æ˜¯ä¸ä¼šï¼Œè¿™æ ·çš„è¯æ€»åˆ† $100 + 104 + 39 = 243$ï¼Œè¿™æˆç»©çœ‹ç€ç‚¼é“œæœ¯å£«ç¨³äº†ï¼Œä½†è¿˜æŠ±æœ‰ä¸€çº¿èƒ½ç»™é“œæŠ›å…‰ä¸Šé“¶çš„å¸Œæœ›ï¼Œæœ€ç»ˆé˜Ÿçº¿ $447$ï¼Œé“¶ç‰Œ $274$ï¼Œ$FJ$ å››ä¸ªè¿›é˜Ÿï¼Œå…”å·® $1$ åˆ† $Au$ï¼Œä½†é˜Ÿæ˜¯è‚¯å®šè¿›äº†</p><p>ä»Šå¹´ $Ag$ æ•°ç›®å¢åŠ äº† $50$ ä¸ªï¼Œçœé€‰å‰å¤§åŠå¹´æ²¡æäº†ï¼Œå¤šå°‘è¿˜æ˜¯ä¼šæœ‰äº›å¿ƒé‡Œæ²¡åº•ï¼Œä½†è¿˜æ˜¯è®¤ä¸ºæ‹¿ $Ag$ è¿˜æ˜¯æ¯”è¾ƒç¨³çš„ï¼Œå†µä¸”æ²¡æ‹¿åˆ° $Ag$ å¼ºåŸºä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆä¼˜æƒ ï¼Œæ‰€ä»¥ç­‰åˆ°ä¸¤å¤©æˆç»©å‡ºæ¥çš„æ—¶å€™ï¼Œè¿˜ç®—æ˜¯æ¯”è¾ƒå¤±æœ›çš„ï¼ˆè™½ç„¶åé¢é€æ¸ä½›ç³»ï¼‰ï¼Œæƒ³ç€å¦‚æœæˆ‘ $T1$ æ²¡ä¸¢é‚£ $10 pts$ï¼Œå†æŠŠ $k = 0$ æ•²å®Œï¼Œ$T2$ æ¡å› $13 pts$ï¼Œå¥½åƒèƒ½å‹ $Ag$ çº¿å‘¢ï¼Ÿæ„Ÿè§‰ä»Šå¹´çš„é¢˜æ¯”è¾ƒåï¼Œå¯¹æˆ‘è¿™ç§åˆ·é¢˜æ¯”è¾ƒå°‘çš„å¾ˆä¸å‹å¥½ï¼Œè¿™äº›ç±»å‹é¢˜æˆ‘éƒ½å‡ ä¹æ²¡åšè¿‡ï¼Œå¦‚æœæ¢åƒå»å¹´å¸¸è§„ä¸€ç‚¹çš„æˆ‘åº”è¯¥ä¹Ÿèƒ½ $Ag$ï¼Ÿä¸è¿‡è¿™éƒ½æ˜¯åè¯ï¼Œå¤šå°‘ä¼šæœ‰äº›ä¸ç”˜å¿ƒï¼Œä¸è¿‡è‡ªå·±çš„æ°´å¹³å°±æ‘†åœ¨é‚£å„¿ï¼ŒæŠ€ä¸å¦‚äººï¼Œç”˜æ‹œä¸‹é£</p><p>è¿™æ ·ç®—æ˜¯ç»™æ•´ä¸ª $\text{OI}$ ç”Ÿæ¶¯åˆ’ä¸Šäº†ä¸ªåœ†æ»¡çš„å¥å·ï¼Œè™½ç„¶æ²¡æœ‰å¼ºåŸºçš„ä¼˜æƒ è¿˜æ˜¯ä¼šå¤±è½ï¼Œä½†æ¯•ç«Ÿè¿›è¿‡äº†çœé˜Ÿï¼Œæ¥è¿‡äº†å›½èµ›ï¼Œè§åˆ°ç”šè‡³è®¤è¯†äº†é‚£äº›ä¹‹å‰åªé—»å…¶åå¯æœ›è€Œä¸å¯åŠçš„ç¥ä»™ï¼Œçœ¼ç•Œä¹Ÿä¸ä¸€æ ·äº†</p><p>è€ƒå®Œä¹‹åå’Œå…¶å®ƒå¼ºæ ¡çš„æ•™ç»ƒäº¤æµäº†ä¸€ä¸‹ï¼Œä»–ä»¬ä¹Ÿè¯´äº†ä»–ä»¬çš„æ•™å­¦æŒ‡å¯¼å’Œæ–¹æ³•ï¼Œå„ä¸ªéƒ¨åˆ†è¿æ¥ç´§å‡‘ï¼Œæœ‰ç†æœ‰æ®ï¼Œå¤§éƒ¨åˆ†é‡‡ç”¨çš„æ˜¯å•æˆ–åŒæ•™å¸ˆç»Ÿä¸€ç®¡ç†ï¼Œæœ‰å†å±Šé«˜æ‰‹ä¼ æ‰¿ï¼Œå­¦æœ¯äº¤æµèŒƒå›´æ›´å¹¿ï¼Œä¸è‡³äºè¯´å°±æˆ‘ä»¬åŒçº§å›¢é˜Ÿå†…éƒ¨äº¤æµï¼Œæ°´å¹³é¡¶å¤©äº†ä¹Ÿå°±é‚£ä¹ˆå¤šï¼Œäº¤æµæ¥äº¤æµå»ä¸è¿‡è¿˜æ˜¯é‚£ä¸€å›äº‹ï¼Œè¿›å±•ç¼“æ…¢ï¼Œä»–æ ¡ä»ä¸€å®šç¨‹åº¦å¼€å§‹å°±ç»å¸¸æœ‰æ¯”è¾ƒå¯†é›†çš„é˜Ÿå†…æˆ–å¤šæ ¡äº’æµ‹ï¼Œåœ¨ä½œä¸ºé€‰æ‰‹çš„åŒæ—¶ï¼Œè¿˜æœ‰å¾ˆå¤šä½œä¸ºå‡ºé¢˜äººä¸è€å¸ˆçš„æœºä¼šï¼Œæ‰€è°“ <code>æ•™å­¦ç›¸é•¿</code> ä¹Ÿæ­£æ˜¯å¦‚æ­¤ï¼Œé™¤æ­¤ä»¥å¤–è¿˜æœ‰æ›´å¤šæŒ‡å¯¼æ–¹æ³•ï¼Œè‹¥æ˜¯åœ¨å½“æ—¶åœè¯¾çš„æ—¶å€™ï¼Œç”šè‡³æ˜¯ä»åˆä¸­å¼€å§‹ä»¥è¿™ç§æ¨¡å¼è®­ç»ƒï¼Œæˆ‘ç›¸ä¿¡æˆ‘è¿˜æ˜¯æœ‰èƒ½åŠ›å»æ¥è¿‘é‚£äº›é«˜æ‰‹çš„æ°´å¹³</p><p>è¯´å®è¯ï¼Œè¿™æ¬¡æœ€é—æ†¾çš„å€’ä¸æ˜¯æ‹¿äº† $Cu$ï¼Œå› ä¸ºè™½ç„¶æœ‰ä¸€å®šå¤±è¯¯å› ç´ ï¼Œä½†ä¸»è¦è¿˜æ˜¯æŠ€ä¸å¦‚äººï¼Œæœ€é—æ†¾çš„å…¶å®ä¾¿æ˜¯æˆ‘æœ¬æ¥å¯èƒ½å¯ä»¥æ‹¥æœ‰é‚£äº›é«˜æ‰‹çš„å®åŠ›ï¼Œå´æˆäº†ç°åœ¨çš„æ ·å­</p><p>å¥½äº†ï¼Œ$\text{OI}$ ç”Ÿæ¶¯å°±æ­¤ç»“æŸï¼Œè¯¥æ»šå›å»è‚æ–‡åŒ–è¯¾äº†</p><p>$\text{A.F.O.}$ å¿«ä¹</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯´è¯´è¯</title>
      <link href="/2021/07/19/hello-world/"/>
      <url>/2021/07/19/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ç»ˆäºæå®Œäº†ã€‚ã€‚</p><p>è¿™æ˜¯ç¬¬ä¸‰ç‰ˆçš„åšå®¢è¿ç§»</p><p>ä¹‹å‰ç”±äºå’•äº†ä¸€æ®µæ—¶é—´OI</p><p>æçš„åŸåšå®¢æœåŠ¡å™¨è¿‡æœŸåŸŸåè¿‡æœŸæ•°æ®å…¨æ²¡äº†</p><p>ç„¶åå°±é‡æ–°æäº†è¿™ä¹ˆä¸€ä¸ªç©æ„å„¿</p><p>è‡³äºåŸå› </p><p>å¤§æ¦‚å°±æ˜¯å’•äº†åŠå¹´åå»çœé€‰æ‘¸ä¸ªé±¼ä¸€ä¸å°å¿ƒè¿›é˜Ÿäº†</p><p>äºæ˜¯å°±å¾—å‡†å¤‡NOIäº†</p><p>å½“ç„¶ï¼Œè¿™ä¸ªâ€œä¸€ä¸å°å¿ƒâ€ä¸å¸¦æœ‰ä»»ä½•è‡ªå‚²çš„æ„æ€</p><p>æˆ‘åªæ˜¯è§‰å¾—è‡ªå·±çš„æ°´å¹³è¿˜æ²¡æœ‰è¾¾åˆ°æ ‡å‡†ã€‚ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªæœˆï¼Œå‡ºå»é›†è®­</p><p>å¸Œæœ›åˆ°NOIçš„æ—¶å€™èƒ½è¾¾åˆ°è‡ªå·±æƒ³è¦çš„æ°´å¹³å§</p><p>ä¿é“¶äº‰é‡‘</p><p>é‚£ä¹ˆæˆ‘çš„åšå®¢ä¹Ÿå¾—é‡æ–°å›æ¥äº†</p><p>å—¯</p><p>å°±è¿™æ ·</p><p>$\text{Upd:}$ <a href="https://colythme.github.io/2020/08/21/A_F_O/">A.F.O.å¿ƒè·¯å†ç¨‹&amp;NOI2020æ¸¸è®°</a></p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CRTï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰åŠå…¶æ‰©å±•</title>
      <link href="/2021/07/19/CRT%EF%BC%88%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86%EF%BC%89%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/"/>
      <url>/2021/07/19/CRT%EF%BC%88%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86%EF%BC%89%E5%8F%8A%E5%85%B6%E6%89%A9%E5%B1%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="CRT"><a href="#CRT" class="headerlink" title="CRT"></a>CRT</h2><p>ç”¨äºæ±‚è§£ç±»ä¼¼<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x \equiv a_1 \pmod{m_1} \\<br>&amp;x \equiv a_2 \pmod{m_2} \\<br>&amp;â€¦ \\<br>&amp;x \equiv a_n \pmod{m_n}<br>\end{aligned}<br>\right.<br>$$<br>å…¶ä¸­ï¼Œ$\forall i, j, ~ (m_i, m_j) = 1$</p><p>è®¾ $M = \prod_{i = 1}^n m_i, ~ M_i = \frac{M}{m_i}$ï¼Œå†è®¾ $M_it_i \equiv 1 \pmod{m_i}$ï¼Œå…¶ä¸­ $1 \le i \le n$</p><p>åˆ™å¯æ„é€ ä¸€è§£ $x = \sum\limits_{i = 1}^n a_iM_it_i$ï¼Œä»»æ„è§£ $x_0 = x + k \times M$</p><h2 id="ExCRT"><a href="#ExCRT" class="headerlink" title="ExCRT"></a>ExCRT</h2><p>ç”¨äºæ±‚è§£ç±»ä¼¼<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x \equiv a_1 \pmod{m_1} \\<br>&amp;x \equiv a_2 \pmod{m_2} \\<br>&amp;â€¦ \\<br>&amp;x \equiv a_n \pmod{m_n}<br>\end{aligned}<br>\right.<br>$$<br>å…¶ä¸­ï¼Œä¸ä¸€å®šæ»¡è¶³ $\forall i, j, ~ (m_i, m_j) = 1$</p><p>è€ƒè™‘ä¸¤ä¸ªä¸¤ä¸ªå¤„ç†ï¼Œç„¶ååˆå¹¶</p><p>ç°åœ¨å…ˆè€ƒè™‘æ–¹ç¨‹<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x \equiv a_1 \pmod{m_1} \\<br>&amp;x \equiv a_2 \pmod{m_2}<br>\end{aligned}<br>\right.<br>$$<br>å°†åŒä½™å»æ‰ï¼Œå†è¿›è¡Œå˜æ¢<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;x = a_1 + k_1m_1 \\<br>&amp;x = a_2 + k_2m_2<br>\end{aligned}<br>\right. \\<br>\Rightarrow k_1m_1 - k_2m_2 = a_2 - a_1<br>$$</p><p>é‚£ä¹ˆæ­¤æ—¶è‹¥ $(m_1, m_2) | (a_2 - a_1)$ åˆ™æœ‰è§£ï¼Œåä¹‹åˆ™æ— è§£</p><p>å½“ç„¶è¿™æ—¶å°±å¯ä»¥ç”¨ $ExGCD$ ç›´æ¥æ±‚è§£ï¼Œä½†æ¥ä¸‹æ¥æŠŠå®ƒåŒ–æˆé€†å…ƒçš„å½¢å¼ä¼šæ›´å®¹æ˜“è§£å¼€ä¹Ÿæ›´ä¸è€—æ—¶</p><p>ä»¤ $d = (m_1, m_2)$ï¼Œåˆ™<br>$$<br>\begin{aligned}<br>\frac{k_1m_1}d - \frac{k_2m_2}d &amp;= \frac{a_2 - a_1}d \\<br>\frac{k_1m_1}d &amp;\equiv \frac{a_2 - a_1}d \pmod{\frac{m_2}d} \\<br>k_1 &amp;\equiv inv (\frac{m_1}d, \frac{m_2}d)\frac{a_2 - a_1}d \pmod{\frac{m_2}d} \\<br>k_1 &amp;= inv (\frac{m_1}d, \frac{m_2}d)\frac{a_2 - a_1}d + t\frac{m_2}d \\<br>\end{aligned}<br>$$<br>å…¶ä¸­ $inv (x, p)$ è¡¨ç¤º $x$ åœ¨æ¨¡ $p$ æ„ä¹‰ä¸‹çš„é€†å…ƒ</p><p>æ­¤æ—¶å°† $k_1$ ä»£å…¥ $x = a_1 + k_1m_1$ï¼Œåˆ™æœ‰<br>$$<br>x \equiv a_1 + m_1 \times inv(\frac{m_1}d, \frac{m_2}d)\frac{a_2 - a_1}d \pmod{\frac{m_1m_2}d}<br>$$<br>ç„¶ååˆå¹¶ $n - 1$ æ¬¡å³å¯</p><h2 id="Ex-ExCRT"><a href="#Ex-ExCRT" class="headerlink" title="Ex-ExCRT"></a>Ex-ExCRT</h2><p>If we suppose that our equation set is something like this:<br>$$<br>\left\{<br>\begin{aligned}<br>&amp;b_1x \equiv a_1 \pmod{p_1} \\<br>&amp;b_2x \equiv a_2 \pmod{p_2} \\<br>&amp;â€¦ \\<br>&amp;b_nx \equiv a_n \pmod{p_n}<br>\end{aligned}<br>\right.<br>$$<br>then we need to change the way we process the equations</p><p>Suppose that we have got the answer of the first $i - 1$ congruence equations, we call it $ans$. And suppose $M$ to be the least common multiple of $\{p_1,p_2, p_3, â€¦, p_n\}$, then obviously, the answer of the first $i$ congruence equations $ANS$ should be $ans + kM (k \in \mathbb Z)$. Let us start to derive:<br>$$<br>\begin{aligned}<br>&amp;ANS = ans + Mx \\<br>&amp;\Rightarrow b_i (ans + Mx) \equiv a_i \pmod{p_i} \\<br>&amp;\Rightarrow b_iMx \equiv a_i - b_i \times ans \pmod{p_i} \\<br>&amp;\Rightarrow b_iMx + p_iy = a_i - b_i \times ans<br>\end{aligned}<br>$$<br>Apparently, we can use $ExCRT$ to solve the last equation.</p>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CRT/ExCRT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆä¸‰åå…­ï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E5%85%AD%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E5%85%AD%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>$\text{OEIS}$ $trick$</p><p>$\text{scoreï¼š100 + 0 + 0 = 100            rkï¼š6/35}$</p><h2 id="Problem-Aï¼šæ•°æ’åˆ—"><a href="#Problem-Aï¼šæ•°æ’åˆ—" class="headerlink" title="Problem Aï¼šæ•°æ’åˆ—"></a>Problem Aï¼šæ•°æ’åˆ—</h2><h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/01/L1XrIYc2SMA5eDV.png" alt=""></p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>æ‰“è¡¨ï¼Œç„¶å $\text{OEIS}$ ç¬¬ <a href="http://oeis.org/A005802" target="_blank" rel="noopener">A005802</a> åºåˆ—</p><p>æœ¬æ¥æƒ³ç€é¢˜è§£å¯èƒ½ä¼šç»™å‡ºæ­£è§£ï¼Œç„¶è€Œä»–è¿™ä¹ˆè¯´</p><blockquote><p>é—®é¢˜æ˜¯æ±‚ä¸€ä¸ªæ•°åˆ—çš„ç¬¬ $n$ é¡¹ï¼Œä½†è¯¥æ•°åˆ—æ˜¾ç„¶ä¸æ˜¯çº¿æ€§é€’æ¨æ•°åˆ—ï¼Œ ä½†å¯ä»¥çŒœæƒ³è¯¥æ•°åˆ—æ˜¯æ•´å¼é€’æ¨æ•°åˆ—ã€‚åˆ©ç”¨é«˜æ–¯æ¶ˆå…ƒæˆ–æ‰©å±• $BM$ï¼Œå¯å¾—â€¦â€¦</p></blockquote><p>å¥½äº†é‚£ä¼°æ‘¸ç€æ­£è§£å°± $\text{OEIS}$ å§</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">4e05</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T; LL MOD;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL vis[MAXN];</span><br><span class="line"></span><br><span class="line">LL a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;, invfact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++) fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[MAX] = power (fact[MAX], MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = MAX - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --) invfact[i] = invfact[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">1</span>, a[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">1</span>; n &lt; (MAX &gt;&gt; <span class="number">1</span>); n ++) &#123;</span><br><span class="line">LL add = (<span class="number">10l</span>l * n % MOD * n % MOD + <span class="number">10l</span>l * n % MOD + <span class="number">3</span>) % MOD * a[n] % MOD;</span><br><span class="line">add = (add - <span class="number">9l</span>l * n % MOD * n % MOD * a[n - <span class="number">1</span>] % MOD + MOD) % MOD;</span><br><span class="line">a[n + <span class="number">1</span>] = add * power (<span class="number">1l</span>l * (n + <span class="number">1</span>) * (n + <span class="number">1</span>) % MOD, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* (n+1)^2 a(n+1) = (10*n^2+10*n+3) * a(n) - 9*n^2 * a(n-1). */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (vis, - <span class="number">1</span>, <span class="keyword">sizeof</span> (vis));</span><br><span class="line">T = getnum (); <span class="built_in">cin</span> &gt;&gt; MOD;</span><br><span class="line">init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line"><span class="keyword">int</span> n = getnum ();</span><br><span class="line"><span class="keyword">if</span> (~ vis[n]) &#123; <span class="built_in">cout</span> &lt;&lt; vis[n] &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">continue</span>; &#125;</span><br><span class="line">LL ans = ((<span class="number">18l</span>l * n + <span class="number">45</span>) % MOD * a[n]- (<span class="number">7l</span>l + <span class="number">2</span> * n) % MOD * a[n + <span class="number">1</span>] % MOD + MOD) % MOD;</span><br><span class="line">ans = ans * power (<span class="number">6l</span>l * (n + <span class="number">2</span>) % MOD * (n + <span class="number">2</span>) % MOD, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">vis[n] = ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">a(n) = 2 * Sum_&#123;k=0..n&#125; binomial(2*k, k) * (binomial(n, k))^2 * </span></span><br><span class="line"><span class="comment">  (3*k^2 + 2*k+1 - n - 2*k*n)/((k+1)^2 * (k+2) * (n-k+1)).</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šæ’åˆ—"><a href="#Problem-Bï¼šæ’åˆ—" class="headerlink" title="Problem Bï¼šæ’åˆ—"></a>Problem Bï¼šæ’åˆ—</h2><h3 id="é¢˜é¢-1"><a href="#é¢˜é¢-1" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/01/IZAX16L2sirGPgw.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/01/rZMB8nmuJ1YoweS.png" alt=""></p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>ç¬¬ä¸€æ¬¡è®¢æ­£çš„äº¤äº’é¢˜</p><p>å¤§æ¦‚è®°å½•ä¸€ä¸‹äº¤äº’é¢˜å’‹ç©</p><ul><li>ç¼–è¯‘å¯ä»¥é€šè¿‡åœ¨ç”µè„‘ $\text{path}â€‹$ ä¸­æ·»åŠ ç¼–è¯‘å™¨è·¯å¾„ï¼Œé€šè¿‡ $\text{cmd}â€‹$ $\text{cd}â€‹$ åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ï¼Œè¾“å…¥é¢˜ç›®ç»™å®šç¼–è¯‘è¯­å¥ç¼–è¯‘ï¼Œå†è¿è¡Œ $\text{xxx.exe}â€‹$ è¿è¡Œï¼Œè¾“å…¥æ•°æ®ï¼Œæœ€ååœ¨ $\text{cmd}â€‹$ ä¸­è¿”å›ç­”æ¡ˆæ­£ç¡®æ€§åŠè¯¢é—®æ¬¡æ•°</li><li>ç¼–è¯‘è¿è¡Œç®€æ˜“æ–¹æ³•ï¼Œå¯ç›´æ¥åŠ å…¥å¤´æ–‡ä»¶ <code>#include &quot;grader.cpp&quot;</code>ï¼Œæ­¤æ—¶å¯ç›´æ¥ç¼–è¯‘è¿è¡Œ</li></ul><p>å›åˆ°æ­£é¢˜</p><p>éšæœºä¸€ä¸ªæ’åˆ— $qâ€‹$ï¼Œå†éšæœºåœ°æ”¹å˜ $qâ€‹$ ä¸­çš„ $Sâ€‹$ ä¸ªå…ƒç´ ï¼Œä½¿è¿™ $Sâ€‹$ ä¸ªå…ƒç´ é‡æ–°é”™æ’ï¼Œè®¾å¾—åˆ°æ’åˆ— $râ€‹$ï¼Œæ”¹å˜äº†ä½ç½® $a_1, a_2, â€¦, a_Sâ€‹$ï¼Œé‚£ä¹ˆæœ‰ä¸€å®šæ¦‚ç‡æ»¡è¶³æ‰€æœ‰ $|p_{a_i} - q_{a_i}|â€‹$ æ„æˆçš„æ•°çš„é›†åˆ $Aâ€‹$ ä¸ $|p_{a_i} - r_{a_i}|â€‹$ æ„æˆçš„æ•°çš„é›†åˆ $Bâ€‹$ å®Œå…¨æ²¡æœ‰äº¤é›†ï¼Œæ­¤æ—¶å– $S = \frac{\sqrt n}{2}â€‹$ å¯ä»¥ä½¿è¯¥æ¦‚ç‡æ¯”è¾ƒå¤§ï¼ˆè¯æ˜å’±ä¹Ÿä¸ä¼šï¼‰</p><p>å‡å®šæ­¤æ—¶æ»¡è¶³ $|A \cup B| = 2Sâ€‹$ï¼Œå³æ»¡è¶³ä¸¤ä¸ªé›†åˆæ— äº¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”± $Aâ€‹$ å¯ä»¥å¯¹æ¯ä¸ª $q_{a_i}â€‹$ å¾—åˆ°æœ€å¤š $2 \times Sâ€‹$ ä¸ªå®ƒå¯ä»¥åŒ¹é…çš„ä½ç½®ï¼ŒåŒæ ·å¯¹ $Bâ€‹$ ä¸ $r_{a_i}â€‹$ ä¹Ÿæ˜¯ä¸€æ ·ï¼Œè¿™å®é™…ä¸Šå°±å˜æˆäº†ä¸€ä¸ªäºŒåˆ†å›¾ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå°†å…¶åè¿‡æ¥è®°ï¼Œå³æ¯æ¬¡ç”± $Aâ€‹$ å¾—åˆ°æ¯ä¸ª $q_{a_i}â€‹$ ä¸å¯èƒ½åŒ¹é…åˆ°çš„ä½ç½®ï¼Œç„¶ååœ¨äºŒåˆ†å›¾ä¸Šå°†è¿™äº›è¾¹åˆ å»ï¼Œé‚£ä¹ˆæœ€ç»ˆæ‰¾åˆ°ç­”æ¡ˆçš„æƒ…å†µç­‰ä»·äºäºŒåˆ†å›¾åŒ¹é…å…·æœ‰å”¯ä¸€æ€§ï¼Œè¿™ä¸ªç”¨ç½‘ç»œæµå’Œ $Tarjanâ€‹$ ç»´æŠ¤ä¸€ä¸‹å°±å¥½äº†</p><p>è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œéšæœºå‡ æ¬¡ä¹‹åå¯èƒ½ä¸€äº›ä½ç½®å·²ç»ç¡®å®šäº†å”¯ä¸€åŒ¹é…æ€§ï¼Œé‚£ä¹ˆæ¯æ¬¡éšæœºé€‰ $S$ ä¸ªå…ƒç´ çš„æ—¶å€™ä¼˜å…ˆé€‰è¿˜æœªæˆåŠŸåŒ¹é…çš„ä½ç½®</p><p>å†è€…ï¼Œåœ¨ $n$ æ¯”è¾ƒå°æ—¶å¯èƒ½å¾ˆéš¾éšåˆ°ç­”æ¡ˆï¼Œå°±å¯ä»¥åœ¨å¼€å¤´æ—¶éšåä¸ª $q$ï¼Œç„¶åæ¯æ¬¡éšæœºä½¿ç”¨å…¶ä¸­ä¸€ä¸ª $q$ï¼Œè¿™æ ·å¯ä»¥æ¯”è¾ƒå¤§çš„æ¦‚ç‡é¿å…è¿™æ ·çš„æƒ…å†µ</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"perm.h"</span></span></span><br><span class="line"><span class="comment">// #include "grader.cpp"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> graph &#123;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">800</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXM];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN], size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN], low[MAXN], bel[MAXN], ord = <span class="number">0</span>, bcc = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head)), size = ord = bcc = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) dfn[i] = low[i] = bel[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">stack</span>[MAXN], top = <span class="number">0</span>; <span class="keyword">bool</span> insta[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">dfn[u] = low[u] = ++ ord;</span><br><span class="line"><span class="built_in">stack</span>[++ top] = u, insta[u] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (! dfn[v]) &#123;</span><br><span class="line">Tarjan (v);</span><br><span class="line">low[u] = min (low[u], low[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (insta[v]) low[u] = min (low[u], dfn[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (low[u] == dfn[u]) &#123;</span><br><span class="line">bcc ++; <span class="keyword">int</span> tp;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">tp = <span class="built_in">stack</span>[top --];</span><br><span class="line">bel[tp] = bcc, insta[tp] = <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">while</span> (tp != u);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) <span class="keyword">if</span> (! dfn[i]) Tarjan (i);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">bool</span> con[<span class="number">1000</span>]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">namespace</span> net &#123;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">800</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, cap, next; &#125; ;</span><br><span class="line">LFS Link[MAXM];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].cap = cap;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Insert (u, v, cap), Insert (v, u, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, N, S, T;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123; <span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head)), size = <span class="number">1</span>; &#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que; <span class="keyword">int</span> depth[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) que.pop();</span><br><span class="line"><span class="built_in">memset</span> (depth, <span class="number">0</span>, <span class="keyword">sizeof</span> (depth));</span><br><span class="line">depth[S] = <span class="number">1</span>, que.push(S);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] || ! cap) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[u] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (v == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cur[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> flow)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (u == T) <span class="keyword">return</span> flow;</span><br><span class="line"><span class="keyword">int</span> rest = flow;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span>&amp; i = cur[u]; i &amp;&amp; rest; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] != depth[u] + <span class="number">1</span> || ! cap) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> k = Dinic (v, min (rest, cap));</span><br><span class="line"><span class="keyword">if</span> (! k) depth[v] = - <span class="number">1</span>;</span><br><span class="line">Link[i].cap -= k, Link[i ^ <span class="number">1</span>].cap += k;</span><br><span class="line">rest -= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow - rest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxflow</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (BFS ()) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cur[i] = Head[i];</span><br><span class="line">ret += Dinic (S, INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> match[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">graph::N = <span class="number">2</span> * n, graph::init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = Head[i]; j; j = Link[j].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[j].to, cap = Link[j].cap;</span><br><span class="line"><span class="keyword">if</span> (! cap) graph::Insert (i, match[i] = v);</span><br><span class="line"><span class="keyword">else</span> graph::Insert (v, i);</span><br><span class="line">&#125;</span><br><span class="line">graph::work ();</span><br><span class="line"><span class="keyword">bool</span> suc = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (graph::bel[i] == graph::bel[match[i]]) suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">else</span> con[i] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> suc;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">400</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> ext[MAXN][MAXN];</span><br><span class="line"><span class="keyword">int</span> N, S, B = <span class="number">10</span>;</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">trans</span> <span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p)</span> </span>&#123;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ret; ret.resize(N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) ret[p[i] - <span class="number">1</span>] = i + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">ask</span> <span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p)</span> </span>&#123; <span class="keyword">return</span> query (trans (p)); &#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; q[<span class="number">11</span>], r, rkc, rkd, rk;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; qq[<span class="number">11</span>], qr, f1, f2;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ret;</span><br><span class="line"><span class="keyword">int</span> cnt1[MAXN]= &#123;<span class="number">0</span>&#125;, cnt2[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">net::init (), net::n = N, net::N = <span class="number">2</span> * N + <span class="number">2</span>;</span><br><span class="line">net::S = <span class="number">2</span> * N + <span class="number">1</span>, net::T = <span class="number">2</span> * N + <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (ext[i][j]) net::addedge (i, j + N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) net::addedge (net::S, i, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) net::addedge (i + N, net::T, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vis1[MAXN], vis2[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = rand () % B + <span class="number">1</span>; rkc.clear();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) <span class="keyword">if</span> (! con[i + <span class="number">1</span>]) rkc.push_back(i);</span><br><span class="line">random_shuffle (rkc.begin(), rkc.end());</span><br><span class="line">rkd.clear(); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) <span class="keyword">if</span> (con[i + <span class="number">1</span>]) rkd.push_back(i);</span><br><span class="line">random_shuffle (rkd.begin(), rkd.end());</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) rkd.size(); i ++) rkc.push_back(rkd[i]);</span><br><span class="line">rk.clear(); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i ++) rk.push_back(rkc[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; S; i ++) swap (rk[i], rk[rand () % i]);</span><br><span class="line">r.resize(N); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) r[i] = q[p][i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i ++) r[rkc[i]] = q[p][rk[i]]; qr = ask (r);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) cnt1[i] = cnt2[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) cnt1[qq[p][i]] ++, cnt2[qr[i]] ++;</span><br><span class="line">f1.clear(), f2.clear();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">while</span> (cnt1[i] &gt; cnt2[i]) f1.push_back(i), cnt1[i] --;</span><br><span class="line"><span class="keyword">while</span> (cnt1[i] &lt; cnt2[i]) f2.push_back(i), cnt1[i] ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">int</span>) f1.size() != S || (<span class="keyword">int</span>) f2.size() != S) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x1 = q[p][rkc[i]], x2 = r[rkc[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) vis1[i] = vis2[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; S; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (x1 - f1[j] &gt;= <span class="number">1</span>) vis1[x1 - f1[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x1 + f1[j] &lt;= N) vis1[x1 + f1[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x2 - f2[j] &gt;= <span class="number">1</span>) vis2[x2 - f2[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x2 + f2[j] &lt;= N) vis2[x2 + f2[j]] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (! vis1[j] || ! vis2[j]) ext[rkc[i] + <span class="number">1</span>][j] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">build (); <span class="keyword">int</span> flow = net::maxflow ();</span><br><span class="line"><span class="keyword">if</span> (flow &lt; N) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (! net::check ()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret[net::match[i] - N - <span class="number">1</span>] = i;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">guess</span> <span class="params">(<span class="keyword">int</span> pn)</span></span>&#123;</span><br><span class="line">N = pn;</span><br><span class="line"><span class="keyword">if</span> (N &lt;= <span class="number">3</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret.push_back(i);</span><br><span class="line"><span class="keyword">while</span> (query (ret).back()) next_permutation (ret.begin(), ret.end());</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">srand (time (<span class="literal">NULL</span>));</span><br><span class="line">S = <span class="built_in">sqrt</span> (N) / <span class="number">2</span>; S = max (S, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) q[i].push_back(j);</span><br><span class="line">random_shuffle(q[i].begin(), q[i].end());</span><br><span class="line">qq[i] = ask (q[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">ext[i][j] = <span class="literal">true</span>;</span><br><span class="line">ret.resize(N); <span class="keyword">while</span> (! work ());</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// g++ grader.cpp perm.cpp -o perm -O2 -std=c++11</span></span><br></pre></td></tr></table></figure><h2 id="Problem-Cï¼šå¡”"><a href="#Problem-Cï¼šå¡”" class="headerlink" title="Problem Cï¼šå¡”"></a>Problem Cï¼šå¡”</h2>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é›†è®­ </tag>
            
            <tag> OEIS </tag>
            
            <tag> äº¤äº’é¢˜ </tag>
            
            <tag> éšæœºåŒ– </tag>
            
            <tag> ç½‘ç»œæµ </tag>
            
            <tag> Tarjan </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆä¸‰åäº”ï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%94%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%94%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>$\text{scoreï¼š0 + 0 + 0 = 0            rkï¼š32/39}$</p><h2 id="Problem-Aï¼šæœ€çŸ­è·¯"><a href="#Problem-Aï¼šæœ€çŸ­è·¯" class="headerlink" title="Problem Aï¼šæœ€çŸ­è·¯"></a>Problem Aï¼šæœ€çŸ­è·¯</h2><h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/29/uskNSrKd29XJQVq.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/29/FSp9RLq7WQkXEou.png" alt=""></p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¯¥è·¯å¾„ä¸€å®šæ˜¯ä» $1$ èµ°åˆ° $n$ åï¼Œåœ¨ä» $n$ è¿”å› $1$ æ—¶åœ¨å¤–å›´èµ°ä¸€é­ï¼Œå†å›åˆ° $1 \rightarrow n$ çš„è·¯å¾„èµ°ä¸€æ®µï¼Œå†å‡ºå»å‘ $1$ èµ°ä¸€æ®µã€‚ã€‚</p><p>è®¾å¾€å¤–å›´èµ°æ—¶çš„èµ·ç‚¹ä¸º $a$ ç±»ç‚¹ï¼Œå›åˆ° $1 \rightarrow n$ è·¯å¾„çš„ç‚¹ä¸º $b$ ç±»ç‚¹ï¼Œå®¹æ˜“çŸ¥é“ $a$ å’Œ $b$ äº¤é”™å‡ºç°æ‰å¯èƒ½æœ€ä¼˜ï¼Œé‚£ä¹ˆæ•´ä¸ªå›¾å¤§æ¦‚å°±è¿™ä¹ˆä¸ªæ ·ï¼ˆèµ·ç‚¹å’Œç»ˆç‚¹ä¸ä½œæ ‡è®°ï¼‰</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/29/1OtoEkzY6W78NwX.png" alt=""></p><p>ä»¤ $f_{i, j}$ è¡¨ç¤ºä» $1$ èµ°åˆ° $i$ï¼Œæœ€åä¸€ä¸ªç‚¹ä¸º $i$ï¼Œä¸º $a$ ç±»ç‚¹ï¼Œå€’æ•°ç¬¬äºŒä¸ªç‚¹ä¸º $j$ï¼Œä¸º $b$ ç±»ç‚¹</p><p>ä»¤ $g_{i, j}$ è¡¨ç¤ºä» $1$ èµ°åˆ° $i$ï¼Œæœ€åä¸€ä¸ªç‚¹ä¸º $i$ï¼Œ$i, j$  éƒ½ä¸º $b$ ç±»ç‚¹</p><p>å®é™…ä¸Š $f$ å¯ä»¥ç›´æ¥è½¬ç§»ï¼Œä¸éœ€è¦ $g$ï¼Œä½†è¿™æ ·å¤æ‚åº¦æ—¶ $O (n^4)$ çš„ï¼Œæ•… $g$ ç›¸å½“äºè¾…åŠ©å‡½æ•°</p><p>ç”¨ç±»ä¼¼ $Dijkstra$ çš„å½¢å¼è½¬ç§»ï¼Œè®¾ $i$ åˆ° $j$ çš„æœ€çŸ­è·¯å¾„ä¸º $d_{i, j}$ï¼ˆå³ä½¿è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹çš„æƒå€¼å’Œæœ€å°ï¼ŒåŒ…æ‹¬ $i, j$ï¼‰</p><p>å‡è®¾æ­¤æ—¶å–å‡º $f_{x, y}$ åˆ™æœ‰<br>$$<br>g_{k, y} = \min\{f_{x, y} + d_{x, k} - p_x\}<br>$$<br>å³å¤šå‡ºä¸€ä¸ª $a$ ç±»ç‚¹ $x$ åˆ° $b$ ç±»ç‚¹ $k$ çš„è·¯å¾„</p><p>å‡è®¾æ­¤æ—¶å–å‡º $g_{x, y}$ï¼Œåˆ™æœ‰<br>$$<br>f_{k, x} = \min \{g_{x, y} + d_{x, k} + d_{k, y} - p_x - p_y - p_k\}<br>$$<br>ç›´æ¥ç”¨å †ç»´æŠ¤æ˜¯ $O (n^3 \log n)$ çš„ï¼Œä½†è§‚å¯Ÿä¸€ä¸‹å‘ç°åœ¨ $j$ ç›¸åŒæ—¶ï¼Œæ¯æ¬¡å¯ä»¥æšä¸¾å–æœ€å°å€¼ï¼Œæ•…æœ€ç»ˆå¤æ‚åº¦ $O (n^3)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">250</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;, d[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN], g[MAXN][MAXN];</span><br><span class="line"><span class="keyword">bool</span> visit[<span class="number">2</span>][MAXN][MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> val, x, y;</span><br><span class="line">node (<span class="keyword">int</span> val = <span class="number">0</span>, <span class="keyword">int</span> x = <span class="number">0</span>, <span class="keyword">int</span> y = <span class="number">0</span>) : val (val), x (x), y (y) &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">node maxf[MAXN], maxg[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getm</span> <span class="params">(node&amp; a, node b)</span> </span>&#123; <span class="keyword">if</span> (b.val &lt; a.val) a = b; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">workf</span> <span class="params">(<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">maxf[j] = node (INF, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! visit[<span class="number">0</span>][i][j])</span><br><span class="line">getm (maxf[j], node (f[i][j], i, j));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">workg</span> <span class="params">(<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">maxg[j] = node (INF, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! visit[<span class="number">1</span>][i][j])</span><br><span class="line">getm (maxg[j], node (g[i][j], i, j));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (d, INF, <span class="keyword">sizeof</span> (d));</span><br><span class="line"><span class="built_in">memset</span> (f, INF, <span class="keyword">sizeof</span> (f));</span><br><span class="line"><span class="built_in">memset</span> (g, INF, <span class="keyword">sizeof</span> (g));</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123; a[i] = getnum (); d[i][i] = a[i]; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">d[u][v] = a[u] + a[v];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">d[i][j] = min (d[i][j], d[i][k] + d[k][j] - a[k]);</span><br><span class="line"><span class="keyword">if</span> (d[<span class="number">1</span>][N] &gt;= INF || d[N][<span class="number">1</span>] &gt;= INF) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">f[<span class="number">1</span>][<span class="number">1</span>] = a[<span class="number">1</span>]; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) workf (i), workg (i);</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">node mf, mg; mf = mg = node (INF, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) getm (mf, maxf[i]), getm (mg, maxg[i]);</span><br><span class="line"><span class="keyword">int</span> type = mf.val &lt;= mg.val ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">getm (mf, mg);</span><br><span class="line"><span class="keyword">if</span> (mf.val &gt;= INF) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">int</span> x = mf.x, y = mf.y;</span><br><span class="line"><span class="keyword">if</span> (type) &#123;</span><br><span class="line">visit[<span class="number">1</span>][x][y] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">if</span> (k != y)</span><br><span class="line">f[k][x] = min (f[k][x], g[x][y] + d[x][k] + d[k][y] - a[x] - a[y] - a[k]);</span><br><span class="line">workf (x), workg (y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">visit[<span class="number">0</span>][x][y] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line">g[k][y] = min (g[k][y], f[x][y] + d[x][k] - a[x]);</span><br><span class="line">workf (y), workg (y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; f[N][N] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é›†è®­ </tag>
            
            <tag> æœ€çŸ­è·¯DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>åˆæ¥ä¹åˆ°ï¼Œ4h20minçš„é¢˜æˆ‘æ‰“äº†2hï¼ŒæˆåŠŸå«åº•ï¼Œæ­å–œæˆ‘è‡ªå·±</p><p>$\text{scoreï¼š20 + 0 + 0 = 20   rkï¼š26/27}$</p><h2 id="Problen-A"><a href="#Problen-A" class="headerlink" title="Problen A"></a>Problen A</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p><img src= "/img/loading.gif" data-lazy-src="http://xsy.gdgzez.com.cn/JudgeOnline/upload/attachment/image/20200701/20200701213322_88297.png" alt=""></p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>çœ‹ä»–ä»¬éƒ½ä¼šå†™ã€‚ã€‚è¿™ç§æ¯”è¾ƒå¤æ‚çš„å®¹æ–¥æˆ‘å‡ ä¹éƒ½æ²¡å†™è¿‡ã€‚ã€‚</p><h4 id="å‰ç½®çŸ¥è¯†ï¼šé«˜ç»´å‰ç¼€å’Œ"><a href="#å‰ç½®çŸ¥è¯†ï¼šé«˜ç»´å‰ç¼€å’Œ" class="headerlink" title="å‰ç½®çŸ¥è¯†ï¼šé«˜ç»´å‰ç¼€å’Œ"></a>å‰ç½®çŸ¥è¯†ï¼šé«˜ç»´å‰ç¼€å’Œ</h4><p>ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹æ¯”å¦‚ç°åœ¨è¦æ±‚è§£ $\sum\limits_{s = 0}^{2^n - 1}\sum\limits_{j \in s} a_j$ï¼ˆæ­¤å¤„ $\in$ æ˜¯äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„æ„ä¹‰ï¼‰ï¼Œç›´æ¥æšä¸¾å­é›†æ˜¯ $O (3^n)$ çš„ï¼Œé‚£ä¹ˆé«˜ç»´å‰ç¼€å’Œå¯ä»¥ä¼˜åŒ–åˆ° $O (n2^n)$</p><p>è€ƒè™‘ä½ä½å‰ç¼€å’Œï¼Œæ¯”å¦‚ä¸‰ä½ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆå†™</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k ++)</span><br><span class="line">            a[i][j][k] += a[i - <span class="number">1</span>][j][k]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k ++)</span><br><span class="line">            a[i][j][k] += a[i][j - <span class="number">1</span>][k]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k ++)</span><br><span class="line">            a[i][j][k] += a[i][j][k - <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>å°±æ˜¯å¯¹æ¯ä¸€ç»´åˆ†åˆ«æ±‚å‰ç¼€å’Œï¼Œé‚£ä¹ˆé«˜ç»´å‰ç¼€å’Œä¹Ÿæ˜¯è¿™ä¸ªæ€æƒ³ï¼Œå³ $f_{s \oplus (1 &lt;&lt; j)} \rightarrow f_s$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> limit = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt;= limit; s ++)</span><br><span class="line">        <span class="keyword">if</span> (s &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)))</span><br><span class="line">            f[s] += f[s ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))];</span><br></pre></td></tr></table></figure><h4 id="å›åˆ°æ­£é¢˜"><a href="#å›åˆ°æ­£é¢˜" class="headerlink" title="å›åˆ°æ­£é¢˜"></a>å›åˆ°æ­£é¢˜</h4><p>ä»¤ $|s|$ è¡¨ç¤º $s$ çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹ $1$ çš„ä¸ªæ•°</p><p>è®¾ $g_s$ è¡¨ç¤ºæ„æˆæœ€ç»ˆçŠ¶æ€ $s$ çš„æ–¹æ¡ˆæ•°ï¼Œ$f_s$ è¡¨ç¤ºçŠ¶æ€ $s$ äºŒè¿›åˆ¶è¡¨ç¤ºä¸­çš„ä¸º $0$ ä½çš„å¡ç‰‡<strong>è‡³å°‘</strong>ä¸å­˜åœ¨äºæœ€ç»ˆæ”¶è—çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå®¹æ–¥ä¸€ä¸‹æœ‰<br>$$<br>g_s = \sum\limits_{j \in s} f_j \times (-1)^{|s - j|}ï¼ˆæ ¹æ®å¤šå‡ºæ¥çš„ 0 çš„ä¸ªæ•°è¿›è¡Œå®¹æ–¥ï¼‰<br>$$<br>é‚£ä¹ˆç°åœ¨è€ƒè™‘æ±‚ $f_s$</p><p>å…ˆè€ƒè™‘æš´åŠ›è®¡ç®—ï¼Œæšä¸¾ $s$ï¼Œå°†æ¯ä¸€è½®æ»¡è¶³ç›¸ä½ç½®æ˜¯é›¶çš„ç»„åˆçš„æ¦‚ç‡åŠ èµ·æ¥ä¸º $sum_i$ï¼Œæœ€ååˆ™æœ‰ $f_s = \prod sum_i$ï¼Œè¿™æ ·æ˜¾ç„¶ä¼š $T$</p><p>å¯¹æ¯ä¸€è½®ï¼Œå¯èƒ½æ»¡è¶³çš„ç»„åˆçš„ç»„åˆå…±æœ‰ $2^k$ ç§ï¼Œç°åœ¨è€ƒè™‘è¿™ $2^k$ ç§å¯èƒ½æ€§åˆ†åˆ«éƒ½è´¡çŒ®åˆ°å“ªå„¿äº†</p><p>è®¾å¯¹äºå½“å‰å– $2^k$ ç§çŠ¶æ€ä¸­çš„ä¸€ç§æ‰€è¡¨ç¤ºå‡ºçš„äºŒè¿›åˆ¶çŠ¶æ€ä¸º $s$ï¼Œè¯¥ç§ç»„åˆçš„ç»„åˆå¯¹åº”çš„å¡ç‰‡é›†åˆ $card_s$ï¼Œæ¦‚ç‡å’Œ $p_s$ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾å®ƒå¯ä»¥è´¡çŒ®åˆ°çš„å°±æ˜¯ $card_s$ çš„è¶…é›†ï¼Œå½“ç„¶ç”±äºå®ƒå­é›†ä¹Ÿä¼šè´¡çŒ®åˆ°é‚£äº›è¶…é›†ï¼Œæ•…è¿˜éœ€å®¹æ–¥æ‰ï¼Œè®¾å®ƒä½¿è¶…é›†éœ€è¦ä¹˜ä¸Šæ•° $L_{card_s}$<br>$$<br>L_{card_s} = \prod\limits_{j \in s} p_j^{(- 1)^{|s - j|}}<br>$$<br>ä¹‹åå°±å¯ä»¥é€šè¿‡è®¡ç®—å­é›†ç»™ $f_s$ çš„è´¡çŒ®ç›´æ¥æ±‚å‡º $f_s$ äº†</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ $j$ å–ç©ºé›†çš„æ—¶å€™ï¼Œ$p_j = 0$ï¼Œè€Œ $p_j$ åˆæœ‰å¯èƒ½è¢«ä½œä¸ºé™¤æ•°ï¼Œæ•…æ­¤æ—¶éœ€è¦å¼€ä¸€ä¸ªæ•°ç»„è®¡ç®—åˆ°æ­¤ä¸ºæ­¢ç©¶ç«Ÿä¹˜å’Œé™¤ä»¥äº†å¤šå°‘ä¸ªé›¶ï¼Œè‹¥æœ€ç»ˆä¹˜çš„æ¬¡æ•°å¤šï¼Œåˆ™ç›´æ¥å°† $f_s$ èµ‹é›¶</p><p>æœ€åä¸€éå®¹æ–¥æ±‚å‡º $g_s$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">10</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> KTRS = <span class="number">1</span> &lt;&lt; <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="keyword">int</span> mp[MAXM]= &#123;<span class="number">0</span>&#125;, pcnt[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD, p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> a[MAXK], p[MAXK];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> suma[KTRS]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sump[KTRS]= &#123;<span class="number">0</span>&#125;, undp[KTRS]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> zocnt[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL f[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL g[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">int</span> lim = (<span class="number">1</span> &lt;&lt; M) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= lim; i ++) mp[i] = mp[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lim; i ++) pcnt[i] = pcnt[i &gt;&gt; <span class="number">1</span>] + (i &amp; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= lim; i ++) f[i] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> K = getnum (), d = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) &#123;</span><br><span class="line">a[j] = getnum (), p[j] = getnum ();</span><br><span class="line">d += p[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> poe = power (<span class="number">1l</span>l * d, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) p[j] = <span class="number">1l</span>l * p[j] * poe % MOD;</span><br><span class="line"><span class="keyword">int</span> lik = (<span class="number">1</span> &lt;&lt; K) - <span class="number">1</span>;</span><br><span class="line">sump[<span class="number">0</span>] = undp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= lik; j ++) &#123;</span><br><span class="line">suma[j] = suma[j ^ lowbit (j)] | a[mp[lowbit (j)]];</span><br><span class="line">sump[j] = (sump[j ^ lowbit (j)] + p[mp[lowbit (j)]]) % MOD;</span><br><span class="line">undp[j] = power (sump[j], MOD - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">sump[<span class="number">0</span>] = undp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span> &lt;&lt; j;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= lik; k ++)</span><br><span class="line"><span class="keyword">if</span> (k &amp; l) &#123;</span><br><span class="line">sump[k] = sump[k] * undp[k ^ l] % MOD;</span><br><span class="line">undp[k] = undp[k] * sump[k ^ l] % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">zocnt[<span class="number">0</span>] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= lik; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (pcnt[j] &amp; <span class="number">1</span>) zocnt[suma[j]] --;</span><br><span class="line"><span class="keyword">else</span> zocnt[suma[j]] ++;</span><br><span class="line">f[suma[j]] = f[suma[j]] * sump[j] % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span> &lt;&lt; i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= lim; j ++)</span><br><span class="line"><span class="keyword">if</span> (j &amp; l) &#123;</span><br><span class="line">f[j] = f[j] * f[j ^ l] % MOD;</span><br><span class="line">zocnt[j] += zocnt[j ^ l];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= lim; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (zocnt[i] &gt; <span class="number">0</span>) g[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> g[i] = f[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span> &lt;&lt; i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= lim; j ++)</span><br><span class="line"><span class="keyword">if</span> (j &amp; l) g[j] = (g[j] - g[j ^ l] + MOD) % MOD; <span class="comment">// æ³¨æ„è¿™é‡Œä½¿å®¹æ–¥ï¼ŒæŸä¸ªg[j]è¢«å‡ä¸¤æ¬¡åˆ™å˜æˆåŠ </span></span><br><span class="line">&#125;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= lim; j ++) ans ^= g[j];</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-B"><a href="#Problem-B" class="headerlink" title="Problem B"></a>Problem B</h2><h3 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h3><p>ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„è¿é€šæ— å‘å›¾ï¼Œè¾¹ä¸Šæœ‰è¾¹æƒï¼Œæ±‚è¯¥æ— å‘å›¾çš„æœ€å°ç›´å¾„ç”Ÿæˆæ ‘ï¼Œå…¶å…·æœ‰æœ€å°çš„ç›´å¾„</p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>$1 \le n \le 500, ~ n - 1 \le m \le \frac{n(n - 1)}{2}, ~ 1 \le è¾¹æƒ \le 10^9$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿™ç©æ„å„¿å¥½åƒå’Œæ±‚ä»€ä¹ˆå›¾çš„ç»å¯¹ä¸­å¿ƒæ˜¯ä¸€æ ·çš„ï¼Œå›¾çš„ç»å¯¹ä¸­å¿ƒå°±æ˜¯æŒ‡ä¸€ä¸ªä¸­å¿ƒï¼Œåˆ°æœ€è¿œçš„ç‚¹è·¯å¾„æœ€çŸ­</p><p>é‚£å°±é€šè¿‡å›¾çš„ç»å¯¹ä¸­å¿ƒæ¥æ±‚è§£è¿™é“é¢˜</p><p>å‡è®¾æ”¹å›¾çš„ç»å¯¹ä¸­å¿ƒä¸ºç‚¹ $p$ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥æ˜¯æŸæ¡è¾¹çš„ç«¯ç‚¹ä¹Ÿå¯ä»¥åœ¨æŸæ¡è¾¹ä¸Š</p><p>é¦–å…ˆæœ‰ä¸€ä¸ªç»“è®º</p><blockquote><p>è·ç¦» $p$ æœ€è¿œçš„ç‚¹è‡³å°‘æœ‰ä¸¤ä¸ªç‚¹ $u, v$ï¼Œå¹¶ä¸”å®ƒä»¬åˆ° $p$ çš„è·ç¦»ç›¸ç­‰</p></blockquote><p>è¿™æ¡ç»“è®ºå¾ˆå®¹æ˜“è¯æ˜ï¼Œè‹¥ $dis (u, p) \ne dis (v, p)$ï¼Œé‚£ä¹ˆå°†ç‚¹ $p$ å¾€è¾ƒè¿œçš„é‚£ä¸ªç«¯ç‚¹ç¨å¾®ç§»åŠ¨ä¸€ä¸‹å³å¯å¾—åˆ°æ›´ä¼˜çš„ç­”æ¡ˆæ­¤æ—¶å‡å®š $p$ åœ¨è¾¹ $(u, v)$ ä¸Šï¼Œ$(u, v)$ é•¿ $L$ï¼Œ$p$ è·ç¦»ç‚¹ $u$ ä¸º $x$ï¼Œé‚£ä¹ˆä»»æ„ä¸€ç‚¹ $s$ åˆ° $p$ çš„è·ç¦»å³ä¸º $\min(dis (s, u) + x, dis (s, v) + L - x)$</p><p>å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªè·ç¦»ä»¥å‡½æ•°å½¢å¼è¡¨ç¤ºå‡ºæ¥æ˜¯ä¸€æ¡æŠ˜çº¿ï¼ˆä¸Šå‡éƒ¨åˆ†æ–œç‡ä¸º $1$ï¼Œä¸‹é™éƒ¨åˆ† $- 1$ï¼‰</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/13/Fn3jhbO9fVvUz2B.jpg" alt=""></p><p>ï¼ˆå›¾æºæ¥è‡ªè®ºæ–‡ã€ŠPlay with Trees Solutionsã€‹ï¼‰</p><p>ç„¶åä½ å°±å¯ä»¥æå‡º $n$ æ¡æŠ˜çº¿ï¼Œå…¶ä¸­æ¨ªåæ ‡å¯¹åº”æ¯ä¸€ç§ $x$ çš„å–å€¼ï¼Œæ‰€ä»¥åŒä¸€ $x$ åæ ‡å¯¹åº”åŒä¸€ä¸ªä¸­å¿ƒ</p><p>è€Œè¦æ±‚çš„æ˜¯æ‰€æœ‰è·ç¦»ä¸­çš„æœ€å¤§å€¼ï¼Œè¿™å¯¹åº”å®çº¿éƒ¨åˆ†</p><p>ä½ åˆè¦ä¿è¯æœ€å¤§çš„æœ€å°ï¼Œæ•…åªéœ€åœ¨å®ç°éƒ¨åˆ†å–æœ€å°å³ä¸ºç­”æ¡ˆï¼Œé€šè¿‡å›¾åƒå¯ä»¥çœ‹å‡ºï¼Œè¯¥æœ€å°å€¼ç‚¹ä¸€å®šä¸ºæŸä¸¤æ¡æŠ˜çº¿çš„äº¤ç‚¹</p><p>é‚£ä¹ˆå°±å¯ä»¥æšä¸¾æ‰€æœ‰ç‚¹å¯¹ $(u, v)$ï¼Œå¹¶æŒ‰ $dis_{u, s}$ è¿›è¡Œæ’åºï¼Œç”¨æ‰«æçš„åšæ³•æ±‚è§£äº†</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">500</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL f[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> rnk[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">f[i][j] = f[j][i] = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">f[u][v] = f[v][u] = w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">f[i][j] = min (f[i][j], f[i][k] + f[k][j]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) rnk[i][j] = j;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = j + <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">if</span> (f[i][rnk[i][j]] &gt; f[i][rnk[i][k]])</span><br><span class="line">swap (rnk[i][j], rnk[i][k]);</span><br><span class="line">&#125;</span><br><span class="line">LL ans = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> u = <span class="number">1</span>; u &lt;= N; u ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">1</span>; v &lt;= N; v ++) &#123;</span><br><span class="line">ans = min (ans, f[u][rnk[u][N]] &lt;&lt; <span class="number">1</span>); <span class="comment">// ä¸­å¿ƒå–ç«¯ç‚¹å¤„</span></span><br><span class="line">ans = min (ans, f[v][rnk[v][N]] &lt;&lt; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> k = N;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">if</span> (f[v][rnk[u][i]] &gt; f[v][rnk[u][k]]) &#123; <span class="comment">// åˆ¤æ–­ä¸¤æŠ˜çº¿æ˜¯å¦æœ‰äº¤</span></span><br><span class="line">ans = min (ans, f[u][rnk[u][i]] + f[u][v] + f[v][rnk[u][k]]);</span><br><span class="line">k = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-C"><a href="#Problem-C" class="headerlink" title="Problem C"></a>Problem C</h2>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> ç”Ÿæˆæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåå››ï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>æˆåŠŸç”±å«åº•è½¬è‡³ä¸­ä¸‹æ°´å¹³ã€‚ã€‚</p><p>æ­å–œã€‚ã€‚æˆ‘ï¼Ÿ</p><p>$\text{scoreï¼š55 + 0 + 0 = 55   rkï¼š21/33}$</p><h2 id="Problem-Aï¼šçŒœæƒ³"><a href="#Problem-Aï¼šçŒœæƒ³" class="headerlink" title="Problem Aï¼šçŒœæƒ³"></a>Problem Aï¼šçŒœæƒ³</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/11/lzHy4UCcSLXmiVD.png" alt=""></p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹äºæ‰€æœ‰æµ‹è¯•æ•°æ®ï¼Œè®° $l$ è¡¨ç¤º $n$ çš„é•¿åº¦ï¼Œåˆ™ $1 \le l \le 2 \times 10^5$ï¼Œä¿è¯ $n$ çš„æœ€é«˜ä½ä¸º $1$ï¼Œä¸”é™¤æ­¤ä¹‹å¤–çš„ $l - 1$ ä½ä½¿ç”¨ $\text{std::mt19937}$ éšæœºç”Ÿæˆ</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è€ƒåœºä¸Šæ•²äº†ä¸ª $55$ åˆ†çš„æš´åŠ›ï¼Œæœ¬æ¥æƒ³è¯´çœ‹èƒ½ä¸èƒ½æšä¸¾æ¯ä¸€ä½ç„¶åç›´æ¥ç®—å®ƒçš„çŠ¶æ€ï¼Œç„¶åä¸è¡Œ</p><p>å‡ºé¢˜äººæä¾›çš„é¢˜è§£æ²¡çœ‹æ‡‚ï¼Œå°±çœ‹äº†çœ‹å…¶ä»– $A$ æ‰çš„äººçš„æ€è·¯</p><p>é¦–å…ˆè€ƒè™‘åˆ†å—ï¼Œä½¿åˆ†å‡ºçš„å—å°½é‡å¤§ï¼Œå–å—å¤§å° $L = 24$ï¼Œå¯¹æ¯ä¸€å—åˆ†åˆ«å¤„ç†</p><p>å¤„ç†å½“å‰å—æ—¶å…ˆä¸è€ƒè™‘å³ç§»åˆ  $0$ çš„æƒ…å†µï¼Œå…ˆåªè€ƒè™‘ä¹˜ä¸‰åŠ ä¸€çš„æƒ…å†µï¼Œæœ€ååªè¦åœ¨ç­”æ¡ˆä¸ŠåŠ ä¸ŠäºŒè¿›åˆ¶ä½æ€»æ•°å³å¯</p><p>è®¾ç¬¬ $i$ å—å‚¨å­˜çš„æ•°ä¸º $a_i$</p><p>ç±»ä¼¼çº¿æ®µæ ‘å¤„ç†ä¹˜æ³•æ—¶çš„æ“ä½œï¼Œè®°ä¸¤ä¸ªå˜é‡ $mul, add$ è®°å½•æ€»å…±ä¹˜äº†å¤šå°‘ï¼Œæ€»å…±è¿›ä½å¤šå°‘ï¼Œé‚£ä¹ˆè½¬ç§»åˆ° $a_j$ æ—¶åˆ™æœ‰ $a_j = mul * a_j + add$ï¼Œä»¥æ­¤ç±»æ¨</p><p>ç»†èŠ‚å°±çœ‹ä»£ç å§</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">24</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">char</span> str[MAXN];</span><br><span class="line"></span><br><span class="line">LL a[MAXN]= &#123;<span class="number">0</span>&#125;, bn = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">lowbit</span> <span class="params">(LL x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; bn; i ++) &#123;</span><br><span class="line">LL mul = <span class="number">1</span>, add = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (a[i]) &#123;</span><br><span class="line">mul *= <span class="number">3</span>, add *= <span class="number">3</span>;</span><br><span class="line">a[i] = a[i] * <span class="number">3</span> + lowbit (a[i]); <span class="comment">// æ­¤å¤„ç”±äºæ²¡åˆ 0æ•…åŠ ä¸Šçš„æ˜¯lowbit</span></span><br><span class="line">add += a[i] &gt;&gt; L; a[i] &amp;= (<span class="number">1</span> &lt;&lt; L) - <span class="number">1</span>; <span class="comment">// ä¿æŒa[i]åªæœ‰Lä½ï¼ŒåŒæ—¶è®¡ç®—è¿›ä½add</span></span><br><span class="line">ans ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= bn; j ++) &#123;</span><br><span class="line">a[j] = a[j] * mul + add;</span><br><span class="line">add = a[j] &gt;&gt; L; a[j] &amp;= (<span class="number">1</span> &lt;&lt; L) - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (add) &#123; a[++ bn] = add &amp; ((<span class="number">1</span> &lt;&lt; L) - <span class="number">1</span>); add &gt;&gt;= L; &#125;</span><br><span class="line">ans += L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (a[bn] ^ <span class="number">1</span>) &#123;</span><br><span class="line">a[bn] = a[bn] &amp; <span class="number">1</span> ? a[bn] * <span class="number">3</span> + <span class="number">1</span> : a[bn] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">ans ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>);</span><br><span class="line">N = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (N == <span class="number">1</span> &amp;&amp; str[<span class="number">1</span>] == <span class="string">'1'</span>) &#123; <span class="built_in">puts</span> (<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">reverse (str + <span class="number">1</span>, str + N + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! ((i - <span class="number">1</span>) % L)) bn ++;</span><br><span class="line">a[bn] |= (str[i] - <span class="string">'0'</span>) &lt;&lt; ((i - <span class="number">1</span>) % L);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; solve () &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šè¦†ç›–"><a href="#Problem-Bï¼šè¦†ç›–" class="headerlink" title="Problem Bï¼šè¦†ç›–"></a>Problem Bï¼šè¦†ç›–</h2><h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/02/LuFUy4JASC3b1VZ.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/02/fe1ZOXTEyudg6m7.png" alt=""></p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿ç¥ä»™éƒ½è¯´ç¥ä»™çš„ç¥ä»™é¢˜</p><p>è®¾ $S_i$ è¡¨ç¤ºç‚¹ $i$ è¿æ¥çš„ç‚¹çš„é›†åˆ</p><p>ä»å°é—®é¢˜å¼€å§‹æ€è€ƒï¼Œè€ƒè™‘ç‚¹ $1, 2$ï¼Œè‹¥æœ‰ $S_1 - \{2\} \neq S_2 - \{1\}$ï¼Œé‚£ä¹ˆäº¤æ¢èŠ‚ç‚¹ $1, 2$ çš„æ ‡å·å¾—åˆ°ä¸€å¼ æ–°æ— å‘å›¾ï¼Œå¯ä»¥å‘ç°å®ƒä»¬çš„æœ€å°ç‚¹è¦†ç›–ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆå®ƒä»¬çš„è´¡çŒ®å’Œåœ¨ $\text{mod} ~~ 2$ çš„æƒ…å†µä¸‹ä¸€å®šæ˜¯ $0$ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹ç­”æ¡ˆæœ‰è´¡çŒ®çš„æ— å‘å›¾ä¸€å®šæ»¡è¶³ $\forall u, v, S_u - \{v\} = S_v - \{u\}$</p><p>æ¥ä¸‹æ¥è€ƒè™‘ $S_1 - \{2\} = S_2 - \{1\}$ çš„æƒ…å†µï¼Œåˆ†ç±»è®¨è®º</p><ul><li>è‹¥å­˜åœ¨è¾¹ $(1, 2)$ï¼Œåˆ™è¯´æ˜ $1, 2$ ä¸­å¿…é¡»å­˜åœ¨è‡³å°‘ä¸€ä¸ªç‚¹åŠ å…¥è¦†ç›–ç‚¹ï¼Œå¦åˆ™è¾¹ $(1, 2)$ å°±ä¸€å®šä¸ä¼šè¢«è¦†ç›–åˆ°ï¼Œä¸å¦¨å¼ºåˆ¶æ ‡å·å°çš„é‚£ä¸ªåŠ å…¥è¦†ç›–ç‚¹ï¼Œå†åˆ å»æ‰€æœ‰ä¸ä¹‹ç›¸è¿çš„è¾¹ï¼Œé‚£ä¹ˆå±€é¢å°±å˜æˆäº† $nâ€™ = n - 1, kâ€™ = k - 1$ ç»§ç»­ææœ€å°ç‚¹è¦†ç›–</li><li>è‹¥ä¸å­˜åœ¨è¾¹ $(1, 2)$ï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹© $S_1$ ä¸­æ‰€æœ‰ç‚¹åŠ å…¥è¦†ç›–ç‚¹æˆ– $1, 2$ åŒæ—¶åŠ å…¥è¦†ç›–ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬åŒæ—¶åŠ å…¥æˆ–ä¸åŠ å…¥è¦†ç›–ç‚¹ï¼Œåˆ™å®ƒä»¬å¯ä»¥åˆå¹¶æˆä¸€ä¸ªå¤§ç‚¹ï¼Œå¹¶åˆ å»é‡å¤çš„è¾¹</li></ul><p>å¾ˆå®¹æ˜“å‘ç°ï¼Œæ¯æ¬¡åˆå¹¶çš„ä¸¤ä¸ªç‚¹å®é™…å…·æœ‰çš„èŠ‚ç‚¹æ•°ç›®ä¸€å®šæ˜¯ç›¸åŒçš„</p><p>æš´åŠ›è®¡ç®—åˆ™éœ€è¦æšä¸¾ $S_1, S_2$ ç­‰ï¼Œä½†å®é™…ä¸Šåœ¨åˆå¹¶ $1, 2$ åï¼Œ$S_1$ æ˜¯ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æšä¸¾ $S_1$ æ˜¯åœ¨åé¢è¿‡ç¨‹å®Œæˆçš„ï¼Œåœ¨ä¸æ–­åˆå¹¶ã€æ¶ˆå»ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œæœ€ç»ˆæˆ‘ä»¬ä¸€å®šå¯ä»¥å¾—åˆ°å›¾ï¼Œä½¿ä¹‹æ»¡è¶³æ¡ä»¶ï¼Œæ‰€ä»¥å°±ä¸éœ€è¦æ‰€è°“æšä¸¾ $S_1$ è¿™æ ·çš„æ­¥éª¤äº†</p><p>ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œä¸å¦¨å‡å®šæ¯æ¬¡åˆå¹¶ï¼Œé€‰æ‹©ç”±å…·æœ‰ç›¸åŒèŠ‚ç‚¹æ•°ç›®ï¼Œä¸”è¯¥æ•°ç›®æœ€å°çš„ä¸¤ä¸ªç‚¹ï¼Œå¹¶ä¸”è¿™ä¸ªæ•°ç›®ä¸€å®šæ˜¯ $2$ çš„å¹‚æ¬¡ï¼Œè®¾å½“å‰æ‰¾åˆ°çš„è¿™ä¸¤ä¸ªç‚¹å…·æœ‰ $2^t$ ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥å‘ç°ä»»æ„å…·æœ‰ $2^d (d &lt; t)$ ä¸ªèŠ‚ç‚¹çš„ç‚¹ä¸€å®šæœ€å¤šåªæœ‰ä¸€ä¸ªï¼Œä¸”ä¸å­˜åœ¨å…·æœ‰ $2^{t + 2}$ ä¸ªèŠ‚ç‚¹çš„ç‚¹ï¼Œå› ä¸ºæ­¤æ—¶æœ€å¤šåªä¼šåˆå¹¶åˆ° $2^{t + 1}$</p><p>é‚£ä¹ˆè®¾ $f_{n, k, t}$ è¡¨ç¤ºå‰©ä½™èŠ‚ç‚¹æ•° $n$ï¼ˆå³æ²¡åŠ å…¥è¦†ç›–ç‚¹çš„å‰©ä½™ç‚¹çš„ä¸ªæ•°ï¼‰ï¼Œè¿˜å¯ä»¥åŠ å…¥ $k$ ä¸ªè¦†ç›–ç‚¹ï¼Œ$t$ çš„æ„ä¹‰å¦‚ä¸Šæ‰€è¿°</p><p>å¾ˆæ˜æ˜¾åœ¨çŸ¥é“äº† $n$ ä¹‹åæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“æ­¤æ—¶æ¯ç§å…·æœ‰ä¸åŒèŠ‚ç‚¹æ•°çš„ç‚¹çš„ä¸ªæ•°ï¼Œæ­¤æ—¶æœ‰ $tot = n &gt;&gt; t$ ä¸ªç”± $2^t$ ä¸ªèŠ‚ç‚¹ç»„æˆçš„ç‚¹ï¼Œæšä¸¾åœ¨ $tot$ ä¸­é€‰æ‹©å¤šå°‘ä¸ªè¿›è¡Œç•™ä¸‹ã€æ¶ˆå¤±ã€åˆå¹¶çš„æ“ä½œ</p><p>è®¾æœ‰ $r (r \in \{0, 1\})$ ä¸ªç‚¹ç•™ä¸‹ï¼Œ$m (0 \le m \le \frac{tot}2)$ <strong>å¯¹</strong>ç‚¹åˆå¹¶ï¼Œé‚£ä¹ˆå¯ä»¥è®¡ç®—å‡ºæœ‰ $d = tot - 2 * m - r$ ä¸ªç‚¹æ¶ˆå¤±ï¼Œè®¡ç®—æ–¹æ¡ˆæ•°ï¼Œå³è¦åœ¨ $m + d$ ä¸ªä½ç½®ä¸­é€‰æ‹© $d$ ä¸ªä½ç½®æ¶ˆå¤±ï¼Œå³æ–¹æ¡ˆæ•°ä¸º $\dbinom{m + d}d$ï¼Œä½†å®é™…ä¸Šè¿™æ˜¯é”™è¯¯çš„ï¼Œå› ä¸º</p><p>è‹¥ $r = 0$ åˆ™å¿…é¡»å¼ºåˆ¶è¦æ±‚æœ€åä¸€ç»„ç‚¹å¿…é¡»åˆå¹¶ï¼Œå‡å¦‚ä¸€ä¸ªéƒ½ä¸å‰©ä¸”æœ€åæ˜¯æ¶ˆå¤±çš„è¯ï¼Œé‚£å°±ç›¸å½“äºåœ¨æ“ä½œå‰æœ€åæ˜¯åªæœ‰ä¸€ä¸ªç‚¹çš„ï¼Œè€Œè¿™å”¯ä¸€çš„æœ€åä¸€ä¸ªç‚¹åœ¨ä¸ä¸å…¶å®ƒç‚¹ç»„åˆçš„æƒ…å†µä¸‹å®ƒç‹¬è‡ªæ¶ˆå¤±æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè¿™ç§æƒ…å†µå®é™…ä¸Šåº”è¯¥æ˜¯è¢« $r = 1$ æ—¶è®¡ç®—åˆ°çš„ï¼Œæ•…è‹¥ $r = 0$ åˆ™é¡»å¼ºåˆ¶ä»¤æœ€åä¸€ä¸ªæ“ä½œæ˜¯åˆå¹¶ï¼Œæ•…æ–¹æ¡ˆæ•°åº”ä¸º $\dbinom{m + d - [rem = 0]}d$</p><p>è®°å¿†åŒ–ä¸€ä¸‹å³å¯ï¼Œé€’å½’åˆ°æœ€å $n$ ä¸è¶³ä»¥æˆ–æ°åªèƒ½æä¾› $2^t$ ä¸ªèŠ‚ç‚¹æ—¶ï¼Œè‹¥è¯¥çŠ¶æ€äº§ç”Ÿè´¡çŒ®åˆ™å…¶å¿…é¡»æ»¡è¶³ $n \neq k \cap lowbit(n) = k$ï¼Œè¿™æ˜¯å› ä¸ºæœ€åå‰©ä¸‹è‹¥å¹²ä¸ªç‚¹ï¼Œå‘ç°åªæœ‰æœ€å°ç‚¹è¦†ç›–ä¸ºæœ€å°ç‚¹çš„æ—¶å€™ç­”æ¡ˆæ‰æ˜¯å¥‡æ•°ï¼Œè‹¥æ­¤æ—¶æœ€å°ç‚¹è¦†ç›–å¤§äºä¸€ï¼Œåˆ™è¦†ç›–ç‚¹ä¹‹é—´å¯ä»¥ä»»æ„è¿è¾¹ï¼Œåˆ™ç­”æ¡ˆä¼šæ˜¯ $2$ çš„å¹‚æ¬¡ï¼›è‹¥ä¸æ˜¯æœ€å°ç‚¹ï¼Œæ¯”è¿™ä¸ªç‚¹å°çš„ç‚¹å¯ä»¥é€‰æ‹©è¿æˆ–ä¸è¿è¿™ä¸ªç‚¹ï¼Œåˆ™ç­”æ¡ˆäº¦æ˜¯ $2$ çš„å¹‚æ¬¡</p><p>æ—¶é—´å¤æ‚åº¦ $O (n^2\log^2n)$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN][<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; <span class="number">0</span> || k &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (! k) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> ((n &gt;&gt; t) &lt;= <span class="number">1</span>) <span class="keyword">return</span> n != k &amp;&amp; lowbit (n) == k;</span><br><span class="line"><span class="keyword">if</span> (~ f[n][k][t]) <span class="keyword">return</span> f[n][k][t];</span><br><span class="line">f[n][k][t] = <span class="number">0</span>; <span class="keyword">int</span> lim = n &gt;&gt; (t + <span class="number">1</span>), tot = n &gt;&gt; t;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mer = <span class="number">0</span>; mer &lt;= lim; mer ++) <span class="comment">// åˆå¹¶</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> rem = <span class="number">0</span>; rem &lt;= <span class="number">1</span>; rem ++) &#123; <span class="comment">// ç•™ä¸‹</span></span><br><span class="line"><span class="keyword">int</span> des = tot - mer * <span class="number">2</span> - rem; <span class="comment">// æ¶ˆå¤±</span></span><br><span class="line"><span class="keyword">if</span> (des &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> c1 = mer + des - (! rem), c2 = des;</span><br><span class="line"><span class="keyword">if</span> ((c1 &amp; c2) == c2) f[n][k][t] ^= dp (n - (des &lt;&lt; t), k - (des &lt;&lt; t), t + <span class="number">1</span>);</span><br><span class="line"><span class="comment">// å¯¹ç»„åˆæ•° C (n, m) è‹¥æ»¡è¶³ (n &amp; m) == m åˆ™è¯´æ˜ C (n, m) æ˜¯å¥‡æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> f[n][k][t];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (f, - <span class="number">1</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line">Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= Q; Case ++) &#123;</span><br><span class="line"><span class="keyword">int</span> n = getnum (), k = getnum ();</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, dp (n, k, <span class="number">0</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> åˆ†å— </tag>
            
            <tag> é›†è®­ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåå…­ï¼‰</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ä»Šå¤©æ˜¯å‡ åœºä¸‹æ¥ç¬¬ä¸€æ¬¡å®Œæ•´æå‡ºä¸€é“é¢˜</p><p>è™½ç„¶è·‘çš„è´¼æ…¢ï¼Œæ–¹æ³•ä¸å¤Ÿä¼˜ï¼Œæ¯” $\text{std}$ æ…¢ $200ms$ã€‚ã€‚</p><p>$\text{scoreï¼š0 + 100 + 0 = 100   rkï¼š16/32}$</p><h2 id="Problem-Aï¼šGeometric-Progressions"><a href="#Problem-Aï¼šGeometric-Progressions" class="headerlink" title="Problem Aï¼šGeometric Progressions"></a>Problem Aï¼šGeometric Progressions</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>é¦–é¡¹ä¸º $a$ ä¸”å…¬æ¯”ä¸º $b$ çš„ç­‰æ¯”æ•°åˆ—æ˜¯ä¸€ä¸ªå½¢å¦‚ $a, ab, ab^2, ab^3, â€¦$ çš„æ•°å­—åºåˆ—</p><p>ä½ è¢«ç»™å®šäº† $n$ ä¸ªæ•´æ•°ç­‰æ¯”æ•°åˆ—ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ‰¾å‡ºæœ€å°çš„æ•´æ•° $x$ï¼Œä½¿å¾—å®ƒæ˜¯æ‰€æœ‰ç»™å®šçš„åºåˆ—çš„å…ƒç´ ï¼Œæˆ–è€…å£°æ˜è¿™æ ·çš„æ•´æ•°ä¸å­˜åœ¨</p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n \le 100, ~ 1 \le a, b \le 10^9$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>åŸé¢˜ <a href="https://codeforces.com/problemset/problem/571/E" target="_blank" rel="noopener">CF571E</a></p><p>é¦–å…ˆå°†æ‰€æœ‰ $a, b$ åˆ†è§£è´¨å› æ•°ï¼Œå¾—åˆ°å¤§å°ä¸º $m$ è´¨å› æ•°é›† $\{p_1, p_2, â€¦, p_m\}$</p><p>è®¾ $c_{i, j}$ è¡¨ç¤º $a_i$ åˆ†è§£è´¨å› æ•°å $p_j$ çš„å¹‚æ¬¡ï¼Œ$d_{i, j}$ è¡¨ç¤º $b_i$ åˆ†è§£è´¨å› æ•°å $p_j$ çš„å¹‚æ¬¡ï¼Œé‚£ä¹ˆç­”æ¡ˆå³å¯è¢«è¡¨ç¤ºä¸º $\prod\limits_{i = 1}^m p_i^{c_{1, i} + k \times d_{1, i}}$ï¼Œå…¶ä¸­ $k \in N$</p><p>è€ƒè™‘æ¯æ¬¡å°†ä¸¤å¯¹ $a, b$ åˆå¹¶ï¼Œè®¾ä¹‹å‰åˆå¹¶å¾—åˆ°çš„ $a, b$ åˆ†è§£è´¨å› æ•°åçš„è´¨å› æ•°å¹‚æ¬¡æ•°ç»„ $A, B$ï¼Œå…¶ä¸­ $A_i$ è¡¨ç¤ºç¬¬ $i$ ä¸ªè´¨å› æ•°çš„å¹‚æ¬¡ï¼Œå†è®¾å‡†å¤‡ä¸ä¹‹åˆå¹¶çš„ $a, b$ çš„è´¨å› æ•°å¹‚æ¬¡æ•°ç»„ $C, D$</p><p>é‚£ä¹ˆç°åœ¨åˆ†ä¸ºä»…æœ‰ä¸€è§£ã€æœ‰æ— æ•°è§£ã€æ— è§£ä¸‰ç§æƒ…å†µ</p><p>å¯¹ $A, B$ å•ç‹¬è€ƒè™‘ï¼Œè®¾ç­”æ¡ˆ $p_i$ å¹‚æ¬¡ $t_i$ï¼Œåˆ™æœ‰<br>$$<br>\left\{<br>    \begin{aligned}<br>        t_i &amp;= A_i + k \times B_i \\<br>        t_j &amp;= A_j + k \times B_j<br>    \end{aligned}<br>\right. \\<br>\Rightarrow<br>t_i = A_i + \frac{B_i}{B_j}(t_j - A_j)<br>$$<br>ä¹Ÿå°±æ˜¯è¯´ $t_j$ å’Œ $t_i$ çš„å…³ç³»æ˜¯ä¸€æ¡æ–œç‡ä¸º $\frac{B_i}{B_j}$ çš„ç›´çº¿</p><p>åŒç†å¯¹ $C, D$ï¼Œæœ‰ $t_i = C_i + \frac{D_i}{D_j}(t_j - C_j)$</p><p>é‚£ä¹ˆä»…æœ‰ä¸€è§£çš„æ¡ä»¶å³ä¸ºå®ƒä»¬ä¹‹é—´æœ‰äº¤ç‚¹ï¼Œå³ $\frac{B_i}{B_j} = \frac{D_i}{D_j}$ï¼Œè¿™ç§æƒ…å†µç›´æ¥è§£å‡ºæ¥å°±å¥½äº†</p><p>é‚£ä¹ˆè€ƒè™‘å‰©ä¸‹çš„æƒ…å†µï¼Œ$t_i = A_i + k_1 \times B_i = C_i + k_2 \times D_i$ å¯ä»¥è½¬åŒ–æˆ $k_2 \times D_i - k_1 \times B_i = A_i - C_i$ï¼Œç„¶åç”¨ $ExGCD$ æ±‚è§£ï¼Œæ³¨æ„ç”±äºå®ƒä»¬ $k_1, k_2$ éƒ½ç›¸åŒï¼Œæ‰€ä»¥è¦æ»¡è¶³æ¯ç»„æ–¹ç¨‹æ˜¯å¦æ»¡è¶³æ¯”ä¾‹å…³ç³»ï¼Œä¸æ»¡è¶³åˆ™æ— è§£ï¼Œå…¶å®æˆ‘è§‰å¾—ä¸Šé¢é‚£ä¸ª $\frac{B_i}{B_j} \ne \frac{D_i}{D_j}$ åˆ™åªæœ‰ä¸€è§£ä¹Ÿåº”è¯¥å¯ä»¥ç”¨è¿™ä¸ªæ¥ç†è§£ï¼Œç„¶åå°±ç›¸å½“äºè§£ä¸€ä¸ªäºŒå…ƒä¸€æ¬¡æ–¹ç¨‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">900</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e04</span>;</span><br><span class="line"><span class="keyword">int</span> oa[MAXN], ob[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">GCD</span> <span class="params">(LL a, LL b)</span> </span>&#123; <span class="keyword">return</span> ! b ? a : GCD (b, a % b); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exGCD</span> <span class="params">(LL a, LL b, LL&amp; x, LL&amp; y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! b) &#123; x = <span class="number">1</span>, y = <span class="number">0</span>; <span class="keyword">return</span> ; &#125;</span><br><span class="line">exGCD (b, a % b, y, x);</span><br><span class="line">y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXM]= &#123;<span class="number">0</span>&#125;, pn = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">separ</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i ++)</span><br><span class="line"><span class="keyword">if</span> (! (x % i)) &#123;</span><br><span class="line">prime[++ pn] = i;</span><br><span class="line"><span class="keyword">while</span> (! (x % i)) x /= i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (x &gt; <span class="number">1</span>) prime[++ pn] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> pcnt[<span class="number">2</span>][MAXN][MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cencus</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> id, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (! (x % prime[i])) &#123;</span><br><span class="line"><span class="keyword">while</span> (! (x % prime[i])) &#123;</span><br><span class="line">x /= prime[i];</span><br><span class="line">pcnt[p][id][i] ++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL a[MAXM], b[MAXM], c[MAXM], d[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">merge</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL sb = <span class="number">0</span>, sd = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) &#123; sb += b[i]; sd += d[i]; &#125;</span><br><span class="line"><span class="keyword">if</span> (! sb &amp;&amp; ! sd) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (a[i] != c[i])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (! sb || ! sd) &#123;</span><br><span class="line"><span class="keyword">if</span> (! sd) &#123; swap (sb, sd); swap (a, c); swap (b, d); &#125;</span><br><span class="line">LL k = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (d[i]) &#123;</span><br><span class="line"><span class="keyword">if</span> (c[i] &gt; a[i] || (a[i] - c[i]) % d[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">LL pk = (a[i] - c[i]) / d[i];</span><br><span class="line"><span class="keyword">if</span> (k != - <span class="number">1</span> &amp;&amp; pk != k) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">k = pk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (sb * d[i] != sd * b[i])</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (i &lt;= pn) &#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= pn; j ++)</span><br><span class="line"><span class="keyword">if</span> (b[i] * d[j] != d[i] * b[j]) <span class="comment">// åªæœ‰ä¸€ä¸ªè§£</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">LL ka = d[j] * (c[i] - a[i]) - d[i] * (c[j] - a[j]);</span><br><span class="line">LL kb = b[j] * (c[i] - a[i]) - b[i] * (c[j] - a[j]);</span><br><span class="line">LL down = d[j] * b[i] - d[i] * b[j];</span><br><span class="line"><span class="keyword">if</span> (down &lt; <span class="number">0</span>) ka = - ka, kb = - kb, down = - down;</span><br><span class="line"><span class="keyword">if</span> (ka &lt; <span class="number">0</span> || kb &lt; <span class="number">0</span> || ka % down || kb % down) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">ka /= down, kb /= down;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= pn; k ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[k] + ka * b[k] != c[k] + kb * d[k]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">a[k] = a[k] + ka * b[k], b[k] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ExGCDåˆå¹¶</span></span><br><span class="line">LL rb = <span class="number">0</span>, rd = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (b[i]) &#123;</span><br><span class="line">LL g = GCD (b[i], d[i]);</span><br><span class="line">rb = b[i] / g, rd = d[i] / g;</span><br><span class="line"><span class="keyword">if</span> ((a[i] - c[i]) % g) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">r = (a[i] - c[i]) / g;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line"><span class="keyword">if</span> (r * (b[i] / rb) != a[i] - c[i]) <span class="comment">// åˆ¤æ–­æ˜¯å¦æˆæ¯”ä¾‹</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (r &lt; <span class="number">0</span>) swap (a, c), swap (b, d), swap (rb, rd), r = - r;</span><br><span class="line">LL ka, kb;</span><br><span class="line">exGCD (rb, rd, ka, kb);</span><br><span class="line">ka = (ka * (- r) % rd + rd) % rd;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">a[i] += ka * b[i], b[i] *= rd;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) oa[i] = getnum (), ob[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) separ (oa[i]), separ (ob[i]);</span><br><span class="line">sort (prime + <span class="number">1</span>, prime + pn + <span class="number">1</span>);</span><br><span class="line">pn = unique (prime + <span class="number">1</span>, prime + pn + <span class="number">1</span>) - prime - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cencus (<span class="number">0</span>, i, oa[i]), cencus (<span class="number">1</span>, i, ob[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) a[i] = pcnt[<span class="number">0</span>][<span class="number">1</span>][i], b[i] = pcnt[<span class="number">1</span>][<span class="number">1</span>][i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pn; j ++) c[j] = pcnt[<span class="number">0</span>][i][j], d[j] = pcnt[<span class="number">1</span>][i][j];</span><br><span class="line"><span class="keyword">if</span> (! merge ()) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line">LL ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) ans = ans * power (prime[i], a[i]) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šBichrome-Spanning-Tree"><a href="#Problem-Bï¼šBichrome-Spanning-Tree" class="headerlink" title="Problem Bï¼šBichrome Spanning Tree"></a>Problem Bï¼šBichrome Spanning Tree</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>æˆ‘ä»¬æœ‰ä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„å¸¦æƒæ— å‘å›¾ã€‚å›¾ä¸­çš„ç¬¬ $i$ æ¡è¾¹è¿æ¥äº†èŠ‚ç‚¹ $u_i, v_i,$ï¼Œæƒé‡ä¸º $w_i$ã€‚å¦å¤–ï¼Œä½ è¿˜è¢«ç»™å®šäº†ä¸€ä¸ªæ•´æ•° $X$ã€‚</p><p>è¯·æ±‚å‡ºå°†æ¯æ¡è¾¹æŸ“æˆé»‘è‰²æˆ–ç™½è‰²ï¼Œä¸”æ»¡è¶³ä¸‹é¢çš„æ¡ä»¶çš„æ–¹æ¡ˆæ•°æ¨¡ $10^9 + 7$ çš„å€¼</p><ul><li>å›¾ä¸­å­˜åœ¨ä¸€æ£µåŒæ—¶åŒ…å«æŸ“æˆç™½è‰²çš„è¾¹å’ŒæŸ“æˆé»‘è‰²çš„è¾¹çš„ç”Ÿæˆæ ‘ã€‚å¦å¤–ï¼Œåœ¨æ‰€æœ‰è¿™ç§ç”Ÿæˆæ ‘ä¸­ï¼Œæƒé‡æœ€å°çš„ä¸€æ£µçš„æƒé‡æ°ä¸º $X$</li></ul><p>è¿™é‡Œï¼Œä¸€æ£µç”Ÿæˆæ ‘çš„æƒé‡å®šä¹‰ä¸ºç”Ÿæˆæ ‘ä¸­è¾¹çš„æƒé‡çš„å’Œ</p><h3 id="æ•°æ®èŒƒå›´-1"><a href="#æ•°æ®èŒƒå›´-1" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n \le 1000, ~ 1 \le m \le 2000, ~ 1 \le w_i \le 10^9, ~ 1 \le X \le 10^{12}$</p><p>ç»™å‡ºçš„æ•°æ®ä¿è¯å›¾è”é€šï¼Œä¸å­˜åœ¨é‡è¾¹ï¼Œä¸å­˜åœ¨è‡ªç¯</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>åŸé¢˜ <a href="https://atcoder.jp/contests/arc093/tasks/arc093_c" target="_blank" rel="noopener">ARC093C</a></p><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>å…ˆè®²è®²æˆ‘çš„æ–¹æ³•å§</p><p>æ˜¾ç„¶å¯¹ä¸€æ£µæƒé‡ $&lt; X$ çš„æ ‘ï¼Œå®ƒæ‰€æœ‰çš„è¾¹çš„é¢œè‰²éƒ½åº”è¯¥ç›¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘å¯¹æ¯æ¡è¾¹åˆ¤æ–­å®ƒä¼šä¸ä¼šæœ‰è¿™ç§é™åˆ¶</p><p>æ­¤æ—¶ç›´æ¥ç”¨ $Kruskal$ æ±‚å‡ºåŒ…å«è¯¥è¾¹çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œè‹¥å…¶æƒé‡ $&lt; X$ï¼Œåˆ™è¯¥è¾¹çš„æŸ“è‰²å°±ä¼šè¢«é™åˆ¶ï¼Œç§°ä¸€ç±»è¾¹ï¼›è‹¥å…¶æƒé‡ $&gt; X$ï¼Œåˆ™å®ƒå±äºæŸ“è‰²æƒ…å†µä¸è®ºå¦‚ä½•éƒ½ä¸ä¼šå¯¹ç­”æ¡ˆé€ æˆè´¡çŒ®çš„è¾¹ï¼Œç§°äºŒç±»è¾¹ï¼›è‹¥å…¶æƒé‡ $= X$ï¼Œåˆ™éœ€è¦ç€é‡è€ƒè™‘ï¼Œç§°ä¸‰ç±»è¾¹</p><p>è¿™é‡Œè€ƒè™‘ä¸¤æ£µåœ¨ç›¸åŒçš„å›¾ä¸Šä½†è¾¹é›†å®Œå…¨æ— äº¤é›†çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œå®ƒä»¬ä¸€å®šå¯ä»¥æ„æˆä¸€ä¸ªæ–°çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œè¯¥æœ€å°ç”Ÿæˆæ ‘çš„è¾¹é›†ä¸åŸä¸¤æ£µæ ‘çš„è¾¹é›†åˆ†åˆ«æœ‰äº¤ï¼Œè¿™ä¸ªä¹Ÿå¾ˆå¥½è¯æ˜ï¼Œå› ä¸ºæœ€å°ç”Ÿæˆæ ‘ä¸€å®šæ˜¯æœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘ï¼Œå³æœ€å¤§è¾¹æœ€å°ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´ä¸€å®šå¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œä»è€Œæ„æˆä¸€æ£µæ–°çš„ $MST$ï¼Œè‡³äºå¯¹é‚£äº›æƒé‡ $&lt; X$ çš„æ ‘ï¼Œä¹Ÿæ‹¥æœ‰ç±»ä¼¼è¯¥å®šç†ï¼Œè¯æ˜ç±»æ¯”ä¸€ä¸‹å°±å¥½äº†</p><p>è‡ªæ­¤æˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºæ‰€æœ‰äºŒç±»è¾¹çš„é¢œè‰²ä¸€å®šæ˜¯ç›¸åŒçš„</p><p>è®¾æŸæ¡ä¸‰ç±»è¾¹ $E$ï¼Œä¸‰ç±»è¾¹çš„æ€»æ•°ä¸º $m$</p><p>ç°åœ¨åªéœ€æšä¸¾ $E$ æ¥è¿›è¡Œç»„åˆè®¡æ•°ï¼Œå¼ºåˆ¶ä»¤ $E$ æŸ“è‰²ä¸ä¸€ç±»è¾¹ä¸åŒï¼Œåˆ™å‰©ä½™ $m - 1$ æ¡è¾¹åˆ™å¯éšæ„æŸ“è‰²ï¼Œä¸ºé¿å…ç®—é‡ï¼Œæšä¸¾ $m - 1$ æ¡è¾¹ä¸­ä¸ $E$ æŸ“è‰²ç›¸åŒçš„ä¸ªæ•° $j$ï¼Œåˆ™ $E$ åœ¨æšä¸¾åˆ° $j$ åŠ ä¸Šçš„è´¡çŒ®å³ä¸º $\frac{C (m - 1, j)}{j + 1}$ï¼Œè®°å¾—æœ€åä¹˜äºŒï¼Œä½†å¯¹ä¸å­˜åœ¨ä¸€ç±»è¾¹çš„æƒ…å†µè¦ç‰¹åˆ¤ä¸€ä¸‹</p><p>é‚£ä¹ˆæœ€åå†è®¾ä¸‰ç±»è¾¹ä¸ªæ•° $ext$ï¼Œå°†ä¹‹å‰ç»Ÿè®¡å¾—åˆ°çš„ç­”æ¡ˆä¹˜ä¸Š $2^{ext}$ å³å¯</p><p>æ—¶é—´å¤æ‚åº¦ $O \big(nm \times \alpha(n)\big)$</p><h4 id="ä»£ç ï¼ˆæ–¹æ³•ä¸€ï¼‰"><a href="#ä»£ç ï¼ˆæ–¹æ³•ä¸€ï¼‰" class="headerlink" title="ä»£ç ï¼ˆæ–¹æ³•ä¸€ï¼‰"></a>ä»£ç ï¼ˆæ–¹æ³•ä¸€ï¼‰</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">LL pow2[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125;;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, sze = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">Link[++ sze].to = v;</span><br><span class="line">Link[sze].w = w;</span><br><span class="line">Link[sze].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = sze;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL fact[MAXM]= &#123;<span class="number">0</span>&#125;, invfact[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL inv[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL X;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> u, v, w;</span><br><span class="line">Edge (<span class="keyword">int</span> u = <span class="number">0</span>, <span class="keyword">int</span> v = <span class="number">0</span>, <span class="keyword">int</span> w = <span class="number">0</span>) : u (u), v (v), w (w) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Edge&amp; p) <span class="keyword">const</span> &#123; <span class="keyword">return</span> w &lt; p.w; &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Edge edge[MAXM];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> fa[x] == x ? x : fa[x] = find (fa[x]); &#125;</span><br><span class="line"><span class="function">LL <span class="title">Kruskal</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = edge[i].u, y = edge[i].v, w = edge[i].w;</span><br><span class="line"><span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line"><span class="keyword">if</span> (fx == fy) <span class="keyword">continue</span>;</span><br><span class="line">fa[fx] = fy; ret += w;</span><br><span class="line">Insert (x, y, w), Insert (y, x, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> white[MAXM]= &#123;<span class="number">0</span>&#125;, black[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> wn = <span class="number">0</span>, bn = <span class="number">0</span>;</span><br><span class="line"><span class="function">LL <span class="title">cencus</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= bn; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> i = black[q];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123; fa[j] = j; Head[j] = <span class="number">0</span>; &#125;</span><br><span class="line">sze = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> u = edge[i].u, v = edge[i].v, w = edge[i].w;</span><br><span class="line">fa[u] = v;</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">Kruskal ();</span><br><span class="line">LL add = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= bn - <span class="number">1</span> - (! wn); j ++)</span><br><span class="line">add = (add + C (bn - <span class="number">1</span>, j) * inv[j + <span class="number">1</span>] % MOD) % MOD;</span><br><span class="line">ret = (ret + add) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (wn) ret = <span class="number">2l</span>l * ret % MOD;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>; <span class="keyword">int</span> ext = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">1l</span>l * edge[i].w &gt; X) &#123; ext ++; <span class="keyword">continue</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123; fa[j] = j; Head[j] = <span class="number">0</span>; &#125;</span><br><span class="line">sze = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> u = edge[i].u, v = edge[i].v, w = edge[i].w;</span><br><span class="line">fa[u] = v;</span><br><span class="line">LL x = w + Kruskal ();</span><br><span class="line"><span class="keyword">if</span> (x &lt; X) white[++ wn] = i;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x == X) black[++ bn] = i;</span><br><span class="line"><span class="keyword">else</span> ext ++;</span><br><span class="line">&#125;</span><br><span class="line">ans = cencus ();</span><br><span class="line">ans = ans * pow2[ext] % MOD;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (); <span class="built_in">cin</span> &gt;&gt; X;</span><br><span class="line"><span class="keyword">if</span> (N == <span class="number">1</span>) &#123; <span class="built_in">puts</span> (<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">pow2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= max (N, M); i ++) pow2[i] = pow2[i - <span class="number">1</span>] * <span class="number">2l</span>l % MOD;</span><br><span class="line">fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">inv[<span class="number">1</span>] = fact[<span class="number">1</span>] = invfact[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[i] = invfact[i - <span class="number">1</span>] * inv[i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">edge[i] = Edge (u, v, w);</span><br><span class="line">&#125;</span><br><span class="line">sort (edge + <span class="number">1</span>, edge + M + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; solve () &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>é¢˜è§£çš„æ–¹æ³•ï¼Œæˆ‘è§‰ç€æŒºå¦™</p><p>å…ˆéšä¾¿å–ä¸€ä¸ª $MST$ è®¾ä¸º $T$ï¼Œè®¾å…¶æƒé‡å’Œ $w(T)$ï¼Œæ˜¾ç„¶åªéœ€è€ƒè™‘ $w(T) \le X$</p><p>å¯¹ $w(T) = X$ï¼Œå¯ä»¥å…ˆåŠ ä¸Šè®©å…¶å†…éƒ¨ä¸å…¨éƒ¨æŸ“ç›¸åŒè‰²ï¼Œå‰©ä½™è¾¹éšæ„æŸ“è‰²ï¼Œå³è´¡çŒ® $(2^{n - 1} - 2) \cdot 2^{m - n + 1}$</p><p>æ¥ä¸‹æ¥è€ƒè™‘ $T$ æŸ“è‰²å…¨éƒ¨ç›¸åŒçš„æƒ…å†µï¼Œä¸å¦¨è®¾ $T$ ä¸­è¾¹å‡ä¸ºé»‘è¾¹</p><blockquote><p>æ¯æ¬¡æ›¿æ¢ä¸€ä¸ªä¸åœ¨ $T$ ä¸­çš„ç™½è¾¹åˆ° $T$ï¼Œåˆ™æœ€å¤šæ›¿æ¢ä¸€æ¬¡</p></blockquote><p>è¯æ˜åå‘æ€è€ƒä¸€ä¸‹å°±è¡Œäº†ï¼Œæ¯æ¬¡æ›¿æ¢æƒé‡ä¸€å®šä¸ä¼šå‡å°‘ï¼Œé‚£ä¹ˆå‡å®šç°åœ¨æ›¿æ¢äº†ä¸¤ä¸ªç™½è¾¹ï¼Œä½†å…¨å›¾çš„é»‘ç™½è¾¹ $MST$ ä»ä¸åŒ…æ‹¬ä½ ç¬¬äºŒæ¬¡æ›¿æ¢çš„è¾¹ï¼Œå› ä¸ºç¬¬äºŒæ¬¡æ›¿æ¢å‡ºæ¥çš„é»‘è¾¹æ­¤æ—¶å°±æ»¡è¶³æ¡ä»¶äº†</p><p>å¯¹æ¯æ¬¡æ›¿æ¢ï¼Œè‹¥æ›¿æ¢ç¬¬ $i$ æ¡è¾¹ï¼Œåˆ™ä¼šå¢å¤§ $cost(i) = w_i - \max\{w_j | (u_j, v_j) åœ¨Tä¸­(u_i, v_i)ä¸¤ç‚¹é—´è·¯å¾„ä¸Š\}$ï¼ˆé¢˜è§£è¡¨è¿°ï¼‰çš„è´¡çŒ®ï¼Œå› æ­¤ä¸€å®šé€‰æœ€å°è¾¹æ›¿æ¢</p><p>æ±‚ $cost(i)$ è·³ä¸ªå€å¢å°±å¥½äº†</p><p>é‚£ä¹ˆæœ€åå°†æ‰€æœ‰ $i$ çš„ $cost(i)$ æ’ä¸ªåºï¼Œè®¾æ’åºåæŸæ¡è¾¹æ’åœ¨ä½ç½® $p$ï¼Œåˆ™å…¶å¯¹ç­”æ¡ˆè´¡çŒ® $2^{n + m - 1 - p}$ï¼ˆåªæœ‰åé¢çš„è¾¹æ‰èƒ½ä»»æ„æŸ“è‰²ï¼‰</p><p>æ—¶é—´å¤æ‚åº¦ $O (m \log n)$</p><h2 id="Problem-Cï¼šNetwork"><a href="#Problem-Cï¼šNetwork" class="headerlink" title="Problem Cï¼šNetwork"></a>Problem Cï¼šNetwork</h2><h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/19/ZTh8wvO5FAqHKG4.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/19/DAaFX5Gpq2vzY8g.png" alt=""></p><h3 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å…ˆè®¡ç®—åœ¨ä¸åè½¬ç”¨æˆ·çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ç”¨æˆ·çš„ $MS(u)$</p><p>è€ƒè™‘ç‚¹åˆ†æ²»ï¼Œç°åœ¨é€’å½’åˆ°åˆ†æ²»ä¸­å¿ƒ $p$ï¼Œè®¾ $p$ å­æ ‘ç‚¹ $x$ åˆ° $p$ çš„è¾¹çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ $(mi_x, ma_x)$ï¼Œå‡è®¾ç°åœ¨æœ‰æœåŠ¡å™¨ $i$ï¼Œç”¨æˆ· $j$ï¼Œéƒ½æ˜¯ $p$ çš„å­æ ‘ç»“ç‚¹ï¼Œè®¡ç®— $MS(j)$ï¼Œè€ƒè™‘æœ‰å“ªå‡ ç§æƒ…å†µä¼šè´¡çŒ®åˆ° $MS(j)$ï¼Œå³æ˜¯ $ma_i - mi_x$ã€$ma_i - mi_j$ã€$ma_j - mi_i$ï¼ŒåŒæ—¶ $(mi_i, ma_i), (mi_j, ma_j)$ ä¹‹é—´ä¸å­˜åœ¨ä»»ä½•å…³ç³»ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´åªéœ€æ±‚å¾— $p$ å­æ ‘ä¸­æ»¡è¶³ $ma_i - mi_i$ æœ€å¤§ï¼Œæˆ– $ma_i$ æœ€å¤§ã€æˆ– $mi_i$ æœ€å¤§ï¼Œå³å¯æ›´æ–°å…¶å®ƒæ‰€æœ‰çš„ç”¨æˆ·ï¼ˆå½“ç„¶è¦ä¸ $i$ ä¸åŒå­æ ‘ï¼‰ï¼Œåˆè€ƒè™‘åˆ°åŒå­æ ‘ä¸èƒ½äº’ç›¸æ›´æ–°ï¼Œæ‰€ä»¥è¿˜å¾—è®°å½•ä¸Šé¢ä¸‰è€…çš„æ¬¡å¤§å€¼ï¼Œè¿™æ ·å°±å¯ä»¥æ±‚å‡ºæ‰€æœ‰ $MS(u)$</p><p>æ¥ä¸‹æ¥è®¡ç®—åè½¬ç”¨æˆ·çš„æƒ…å†µï¼Œæœ€å°å€¼æœ€å¤§ï¼Œè€ƒè™‘äºŒåˆ†ç­”æ¡ˆ</p><p>è®¾æ­¤æ—¶äºŒåˆ†ç­”æ¡ˆ $mid$ï¼Œç»§ç»­è€ƒè™‘ç‚¹åˆ†æ²»ï¼ˆå®é™…ä¸Šåªéœ€è¦çœ‹ç‚¹åˆ†æ ‘å°±å¥½äº†ï¼‰ï¼Œè®¾åˆ†æ²»ä¸­å¿ƒ $p$ï¼Œè®¾åœ¨ä¸¤ä¸ªå­æ ‘çš„ç”¨æˆ· $i, j$ï¼Œè‹¥ä½¿ $check$ å¤±è´¥åˆ™éœ€è¦æ‰¾åˆ°ä¸€å¯¹ $i, j$ï¼Œåè½¬ $i$ï¼Œä½¿å¾— $Waste (j, i) &lt; mid$</p><p>å°† $p$ æ‰€æœ‰å‚¨å­˜ä¸‹æ¥çš„ $(mi_x, ma_x)$ æŒ‰ $mi_x$ æ’åºï¼Œåˆ™å¯¹ $mi_j \le mi_x$ï¼Œæ¬²ä½¿å…¶å¤±è´¥åˆ™éœ€æ»¡è¶³ $ma_i - mi_j &lt; mid$ï¼Œå³ $ma_x &lt; mi_j + mid$ï¼Œå¯¹ $mi_j &gt; mi_x$ï¼Œæ¬²ä½¿å…¶å¤±è´¥åˆ™éœ€æ»¡è¶³ $mi_i &gt; \max(ma_i, ma_j) - mid$ï¼Œå½“ç„¶å·²ç»æ’é™¤äº†æ‰€æœ‰æ»¡è¶³ $ma_x - mi_x \ge mid$ï¼ˆå¯¹ç¬¬ä¸€ç§æƒ…å†µï¼‰æˆ– $MS(x) \ge mid$ï¼ˆå¯¹ä¸¤ç§æƒ…å†µï¼‰çš„ç‚¹ï¼Œç„¶åå’Œå‰é¢ç›¸åŒå¯ä»¥çº¿æ€§å¤„ç†</p><p>æ—¶é—´å¤æ‚åº¦ $O (n \log n \log V)$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> type[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> rt, minval = INF, fa;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">grvy</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">grvy (n, v, root);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line">maxpart = max (maxpart, subsize[v]);</span><br><span class="line">&#125;</span><br><span class="line">maxpart = max (maxpart, n - subsize[root]);</span><br><span class="line"><span class="keyword">if</span> (maxpart &lt; minval) &#123; rt = root; fa = father; minval = maxpart; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> l, r, id, bel;</span><br><span class="line"><span class="comment">// min value, max value, original index, å­æ ‘ä»å±</span></span><br><span class="line">node (<span class="keyword">int</span> l = <span class="number">0</span>, <span class="keyword">int</span> r = <span class="number">0</span>, <span class="keyword">int</span> id = <span class="number">0</span>, <span class="keyword">int</span> bel = <span class="number">0</span>) : l (l), r (r), id (id), bel (bel) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (l == p.l) <span class="keyword">return</span> r &lt; p.r;</span><br><span class="line"><span class="keyword">return</span> l &lt; p.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="built_in">vector</span>&lt;node&gt; a[MAXN];</span><br><span class="line"><span class="keyword">int</span> minv[MAXN], maxv[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father, <span class="keyword">int</span> bel)</span> </span>&#123;</span><br><span class="line">a[rt].push_back(node (minv[root], maxv[root], root, bel));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">minv[v] = min (minv[root], w);</span><br><span class="line">maxv[v] = max (maxv[root], w);</span><br><span class="line">DFS (v, root, bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> MS[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">minv[rt] = INF, maxv[rt] = <span class="number">0</span>;</span><br><span class="line">a[rt].push_back(node (minv[rt], maxv[rt], rt, rt));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[rt]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">minv[v] = min (minv[rt], w);</span><br><span class="line">maxv[v] = max (maxv[rt], w);</span><br><span class="line">DFS (v, rt, v);</span><br><span class="line">&#125;</span><br><span class="line">sort (a[rt].begin(), a[rt].end());</span><br><span class="line">pair&lt;int, int&gt;  fir (- INF, 0), sec (- INF, 0);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line"><span class="keyword">int</span> ms = x.r - x.l;</span><br><span class="line"><span class="keyword">if</span> (ms &gt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (ms, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ms &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (ms, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line"><span class="keyword">if</span> (now.second) &#123;</span><br><span class="line">MS[x.id] = max (MS[x.id], x.r - x.l);</span><br><span class="line">MS[x.id] = max (MS[x.id], now.first);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fir = make_pair (- INF, <span class="number">0</span>), sec = make_pair (- INF, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.r &gt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (x.r, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x.r &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.r, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second? sec : fir;</span><br><span class="line"><span class="keyword">int</span> r = max (x.r, now.first);</span><br><span class="line"><span class="keyword">if</span> (now.second) MS[x.id] = max (MS[x.id], r - x.l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fir = make_pair (INF, <span class="number">0</span>), sec = make_pair (INF, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.l &lt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (x.l, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x.l &lt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.l, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">node x = a[rt][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second? sec : fir;</span><br><span class="line"><span class="keyword">int</span> l = min (x.l, now.first);</span><br><span class="line"><span class="keyword">if</span> (now.second) MS[x.id] = max (MS[x.id], x.r - l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">minval = INF; grvy (n, x, <span class="number">0</span>);</span><br><span class="line">visit[rt] = <span class="literal">true</span>;</span><br><span class="line">work ();</span><br><span class="line">grvy (n, rt, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[rt]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">divide (subsize[v], v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> fail[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doit</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line">pair&lt;int, int&gt; fir (- INF, 0), sec (- INF, 0);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[u].size(); i ++) &#123;</span><br><span class="line">node x = a[u][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line"><span class="keyword">if</span> (now.second &amp;&amp; x.r &lt; now.first) fail[x.id] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (MS[x.id] &gt;= mid || x.r - x.l &gt;= mid) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (x.l + mid &gt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (x.l + mid, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x.l + mid &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.l + mid, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fir = make_pair (INF, <span class="number">0</span>), sec = make_pair (INF, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = a[u].size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">node x = a[u][i];</span><br><span class="line"><span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line"><span class="keyword">if</span> (now.second &amp;&amp; x.l &gt; max (x.r, now.first) - mid) fail[x.id] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (MS[x.id] &gt;= mid) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (x.r &lt;= fir.first) &#123;</span><br><span class="line"><span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">fir = make_pair (x.r, x.bel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x.r &lt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.r, x.bel);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) fail[i] = type[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) doit (i, mid);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! fail[i])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) type[i] = getnum ();</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) sum += type[i];</span><br><span class="line"><span class="keyword">if</span> (sum &gt;= N - <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (sum == N) &#123; <span class="built_in">puts</span> (<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! type[i]) &#123;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d 0\n"</span>, i);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> maxi = <span class="number">0</span>, mini = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">maxi = max (maxi, w); mini = min (mini, w);</span><br><span class="line">&#125;</span><br><span class="line">divide (N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> left = <span class="number">0</span>, right = maxi - mini, ans;</span><br><span class="line"><span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (check (mid)) &#123; ans = mid; left = mid + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="keyword">else</span> right = mid - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">check (ans);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! fail[i]) &#123;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d %d\n"</span>, i, ans);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç‚¹åˆ†æ²» </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> ExGCD </tag>
            
            <tag> æœ€å°ç”Ÿæˆæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåå…«ï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AB%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AB%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ä»Šæ—¥ä¾æ—§ä¸‰é“é›†è®­é˜ŸåŸé¢˜ï¼Œæ— éƒ¨åˆ†åˆ†ï¼Œè¿ç»­ä¸‰æ¬¡</p><p>çœŸè¯¥é—®å€™æ¬é¢˜äººä»–æ¯äº²å¤§äºº</p><p>$\text{scoreï¼šNULL   rkï¼šNULL}$</p><h2 id="Problem-Aï¼šSasha-And-Circles"><a href="#Problem-Aï¼šSasha-And-Circles" class="headerlink" title="Problem Aï¼šSasha And Circles"></a>Problem Aï¼šSasha And Circles</h2><h2 id="Problem-Bï¼šChoosing-Ads"><a href="#Problem-Bï¼šChoosing-Ads" class="headerlink" title="Problem Bï¼šChoosing Ads"></a>Problem Bï¼šChoosing Ads</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ—å’Œä¸€ä¸ªæ•´æ•° $p$ã€‚</p><p>æœ‰ $m$ ä¸ªæ“ä½œï¼Œæ“ä½œè¦ä¹ˆæ˜¯åŒºé—´èµ‹å€¼ï¼Œè¦ä¹ˆæ˜¯è¯¢é—®åŒºé—´å†…å‡ºç°æ¬¡æ•°è‡³å°‘å  $p\%$ çš„æ•°ã€‚</p><p>è¾“å‡ºè¯¢é—®çš„ç­”æ¡ˆæ—¶ï¼Œå¯ä»¥åŒ…å«é”™çš„æ•°ï¼Œä¹Ÿå¯ä»¥é‡å¤è¾“å‡ºï¼Œä½†å¯¹çš„æ•°ä¸€å®šè¦åœ¨ç­”æ¡ˆä¸­ï¼Œä¸”è¾“å‡ºçš„æ•°çš„ä¸ªæ•°ä¸è¶…è¿‡ $\lfloor \frac{100}p \rfloor$</p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$n, m \le 1.5 \times 10^5, ~ 20 \le p \le 100$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å…ˆè€ƒè™‘ $p = 51$ çš„æƒ…å†µï¼Œå¾ˆæ˜æ˜¾å°±æ˜¯æ±‚åŒºé—´ä¼—æ•°</p><p>æœ‰ä¸€ä¸ªç»å…¸åŒºé—´ä¼—æ•°å¥—è·¯ï¼Œç»™æ•°å­— $i$ ä¸€ä¸ªæ•°ç»„ $c_i$ï¼Œè®¾å½“å‰ä¼—æ•° $p$ï¼Œæ¯æ¬¡åŠ ä¸€ä¸ªæ•°å­— $t$ï¼Œè‹¥è¯¥æ•°å­—ç­‰äº $p$ï¼Œåˆ™ $c_p ++$ï¼Œåä¹‹åˆ™ $c_p â€“$ï¼Œè‹¥åˆ å‰ $c_p = 0$ï¼Œåˆ™ $p = t$ï¼ŒåŒæ—¶ $c_p = 1$</p><p>è¿™æ ·å­è™½ç„¶æ²¡æœ‰è®¡ç®—æ¯ç§æ•°å­—çš„å‡ºç°æ¬¡æ•°ï¼Œä½†ä¿ç•™äº†ç›¸å¯¹æ•°å­—ä¸ªæ•°å¤§å°çš„å…³ç³»ï¼Œæ¯•ç«Ÿè‹¥ä¸€ä¸ªæ•°çš„å‡ºç°æ¦‚ç‡ $&gt; 50\%$ï¼Œåˆ™å®ƒå¿…å®šä¼šç•™åˆ°æœ€å</p><p>é‚£ä¹ˆç°åœ¨è€ƒè™‘ $20 \le p \le 50$ï¼Œåˆ™è€ƒè™‘å­˜æ¯ä¸ªå‡ºç°æ¬¡æ•°è‡³å°‘å  $p\%$ çš„æ•°ï¼Œåˆ™å®ƒä»¬æœ€å¤š $5$ ä¸ªï¼Œåœ¨çº¿æ®µæ ‘ä¸Šç»´æŠ¤ï¼Œæ¯æ¬¡åŠ å…¥ä¸€ä¸ªæ•°ï¼Œè‹¥å®ƒä¸å…¶ä¸­ä¸€ä¸ªæ•°ç›¸ç­‰åˆ™å¯¹åº”çš„æ•°çš„ $c$ åŠ ä¸€ï¼Œåä¹‹æ‰€æœ‰æ•°çš„ $c$ å‡ä¸€ï¼Œç„¶åç”¨è¯¥æ•°æ›¿ä»£æœ€ç»ˆåº”å½“è¢«æ›¿ä»£çš„æ•°ï¼Œåˆå¹¶å¤æ‚åº¦æœ€å¤š $5 \times 5 = 25$ï¼Œå¤æ‚åº¦æ­£ç¡®</p><p>å¤æ‚åº¦ $O (nk^2 \log n)$ï¼Œå…¶ä¸­ $k = \lfloor \frac{100}p \rfloor$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">15e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, Q, P, m;</span><br><span class="line"><span class="keyword">int</span> ori[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">6</span>], cnt[<span class="number">6</span>], n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (a, <span class="number">0</span>, <span class="keyword">sizeof</span> (a));</span><br><span class="line"><span class="built_in">memset</span> (cnt, <span class="number">0</span>, <span class="keyword">sizeof</span> (cnt));</span><br><span class="line">n = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> <span class="keyword">operator</span> = (<span class="keyword">const</span> node&amp; p) &#123;</span><br><span class="line">n = p.n;</span><br><span class="line"><span class="built_in">memcpy</span> (a, p.a, <span class="keyword">sizeof</span> (a));</span><br><span class="line"><span class="built_in">memcpy</span> (cnt, p.cnt, <span class="keyword">sizeof</span> (cnt));</span><br><span class="line">&#125;</span><br><span class="line">node <span class="keyword">operator</span> + (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">node ret = p;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">bool</span> in = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ret.n; j ++)</span><br><span class="line"><span class="keyword">if</span> (a[i] == ret.a[j]) &#123;</span><br><span class="line">ret.cnt[j] += cnt[i];</span><br><span class="line">in = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (in) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (ret.n &lt; m) &#123;</span><br><span class="line">ret.a[++ ret.n] = a[i];</span><br><span class="line">ret.cnt[ret.n] = cnt[i];</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ret.n; j ++)</span><br><span class="line"><span class="keyword">if</span> (k == <span class="number">0</span> || ret.cnt[j] &lt; ret.cnt[k])</span><br><span class="line">k = j;</span><br><span class="line"><span class="keyword">if</span> (ret.cnt[k] &gt; cnt[i]) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ret.n; j ++) ret.cnt[j] -= cnt[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> tp = ret.cnt[k];</span><br><span class="line">ret.a[k] = a[i]; ret.cnt[k] = cnt[i] - ret.cnt[k];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ret.n; j ++)</span><br><span class="line"><span class="keyword">if</span> (j != k)</span><br><span class="line">ret.cnt[j] -= tp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">node T[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> lazy[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">setup</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">T[root].a[T[root].n = <span class="number">1</span>] = x;</span><br><span class="line">T[root].cnt[<span class="number">1</span>] = right - left + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">T[root].init ();</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">setup (root, left, right, ori[left]);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid); build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">T[root] = T[lson] + T[rson];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! lazy[root]) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">setup (lson, left, mid, lazy[root]);</span><br><span class="line">setup (rson, mid + <span class="number">1</span>, right, lazy[root]);</span><br><span class="line">lazy[lson] = lazy[rson] = lazy[root];</span><br><span class="line">lazy[root] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) &#123;</span><br><span class="line">setup (root, left, right, x);</span><br><span class="line">lazy[root] = x;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">pushdown (root, left, right);</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) modify (lson, left, mid, L, R, x);</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) modify (rson, mid + <span class="number">1</span>, right, L, R, x);</span><br><span class="line">T[root] = T[lson] + T[rson];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) <span class="keyword">return</span> T[root];</span><br><span class="line">pushdown (root, left, right);</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">node ret; ret.init ();</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) ret = ret + query (lson, left, mid, L, R);</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) ret = ret + query (rson, mid + <span class="number">1</span>, right, L, R);</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), Q = getnum (), P = getnum (); m = <span class="number">100</span> / P;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ori[i] = getnum ();</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= Q; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> type = getnum ();</span><br><span class="line"><span class="keyword">if</span> (type == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum (), id = getnum ();</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, N, l, r, id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">node ans = query (<span class="number">1</span>, <span class="number">1</span>, N, l, r);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, ans.n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ans.n; i ++) <span class="built_in">printf</span> (<span class="string">" %d"</span>, ans.a[i]);</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Cï¼šDistance-Sums"><a href="#Problem-Cï¼šDistance-Sums" class="headerlink" title="Problem Cï¼šDistance Sums"></a>Problem Cï¼šDistance Sums</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ç»™å‡º $n$ ä¸ªäº’ä¸ç›¸åŒçš„æ•° $d_i$ï¼Œè¡¨ç¤ºæ ‘ä¸Šçš„èŠ‚ç‚¹ $i$ åˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„è·ç¦»å’Œã€‚</p><p>è¯·åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¿™æ ·ä¸€æ£µæ ‘ï¼Œå…¶ä¸­æ¯æ¡è¾¹çš„é•¿åº¦å‡ä¸º $1$ã€‚è‹¥å­˜åœ¨è¯·è¾“å‡ºä¸€ç§æ–¹æ¡ˆï¼Œå¦åˆ™è¾“å‡º <code>-1</code>ã€‚</p><h3 id="æ•°æ®èŒƒå›´-1"><a href="#æ•°æ®èŒƒå›´-1" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n \le 10^5, ~ 1 \le d_i \le 10^{12}$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿™é¢˜æ„Ÿè§‰æ˜¯ä¸€ç›´æ¥åšçš„æ¯”è¾ƒæ°´çš„ã€‚ã€‚</p><p>å…ˆç»™æ‰€æœ‰ç»“ç‚¹ $i$ æŒ‰ $d_i$ æ’ä¸ªåºï¼Œå°† $d$ æœ€å°çš„çœ‹ä½œæ ¹èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ˜¾ç„¶å­ç»“ç‚¹çš„ $d$ æ¯”å…¶ç¥–å…ˆèŠ‚ç‚¹å°</p><p>è®¾ç»“ç‚¹ $u$ å­æ ‘å¤§å° $s_u$ï¼Œåˆ™è€ƒè™‘ç”± $u$ èµ°åˆ°å…¶å­ç»“ç‚¹ $v$ æ—¶ $d$ çš„å¢é‡ï¼Œæœ‰ $\Delta d = n - 2s_v$</p><p>é‚£ä¹ˆä»æ’åºåç¬¬ $n$ ä¸ªç»“ç‚¹å¼€å§‹å¾€ä¸Šæ‰«ï¼Œæ¯æ¬¡å°†å®ƒä¸è®¡ç®—åä¸å®ƒç›¸è¿çš„çˆ¶ç»“ç‚¹è¿è¾¹ï¼Œå¦‚è‹¥æ‰¾ä¸åˆ°çˆ¶ç»“ç‚¹åˆ™æ— è§£</p><p>æ³¨æ„æœ€åå»ºå®Œæ ‘è¦è®¡ç®—æ–°å»ºå‡ºçš„æ ‘çš„æ ¹èŠ‚ç‚¹çš„ $d$ æ˜¯å¦ä¸è¾“å…¥æ‰€ç»™ç›¸åŒ</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">pair&lt;LL, <span class="keyword">int</span>&gt; d[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;, fa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt; <span class="number">1</span>; i --) &#123;</span><br><span class="line">subsize[d[i].second] ++;</span><br><span class="line"><span class="keyword">int</span> up = N - <span class="number">2</span> * subsize[d[i].second];</span><br><span class="line"><span class="keyword">if</span> (up &lt; <span class="number">0</span>) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="built_in">exit</span> (<span class="number">0</span>); &#125;</span><br><span class="line"><span class="keyword">int</span> p = lower_bound (d + <span class="number">1</span>, d + N + <span class="number">1</span>, make_pair (d[i].first - up, <span class="number">0</span>)) - d;</span><br><span class="line"><span class="keyword">if</span> (p &gt;= i || d[p].first != d[i].first - up) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="built_in">exit</span> (<span class="number">0</span>); &#125;</span><br><span class="line">fa[d[i].second] = d[p].second;</span><br><span class="line">subsize[d[p].second] += subsize[d[i].second];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line">LL dist[MAXN]= &#123;<span class="number">0</span>&#125;, total = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123;</span><br><span class="line">total += dist[root];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) G[root].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = G[root][i];</span><br><span class="line">dist[v] = dist[root] + <span class="number">1</span>;</span><br><span class="line">DFS (v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) d[i].first = getnum (), d[i].second = i;</span><br><span class="line">sort (d + <span class="number">1</span>, d + N + <span class="number">1</span>);</span><br><span class="line">solve ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) G[fa[d[i].second]].push_back(d[i].second);</span><br><span class="line">DFS (d[<span class="number">1</span>].second);</span><br><span class="line"><span class="keyword">if</span> (total != d[<span class="number">1</span>].first) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d %d\n"</span>, fa[d[i].second], d[i].second);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> é›†è®­ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåäº”ï¼‰</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%94%EF%BC%89/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%94%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ä»Šå¤©æœ‰ç‚¹äººå“ï¼ŒT1çš„50ptsæš´åŠ›æ€’å‹æ­£è§£ã€‚ã€‚è¿™æ•°æ®ã€‚ã€‚ä¸è¨€è€Œå–»</p><p>$\text{score: 100 + 0 + 0 = 100   rk: 7/36}$</p><h2 id="Problem-Aï¼šæ—¶é—´ç®¡ç†å¸¦å¸ˆ"><a href="#Problem-Aï¼šæ—¶é—´ç®¡ç†å¸¦å¸ˆ" class="headerlink" title="Problem Aï¼šæ—¶é—´ç®¡ç†å¸¦å¸ˆ"></a>Problem Aï¼šæ—¶é—´ç®¡ç†å¸¦å¸ˆ</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œç½—è€å¸ˆæ˜¯æ—¶é—´ç®¡ç†å¸¦å¸ˆ</p><p>å› ä¸ºç½—è€å¸ˆæ˜¯æ—¶é—´ç®¡ç†å¸¦å¸ˆï¼Œæ‰€ä»¥ä»–çš„æ—¶é—´æ˜¯ä»¥ä¸œä¸ºå•ä½çš„</p><p>å…·ä½“æ¥è®²ï¼Œç½—è€å¸ˆä¸€å¤©æœ‰nnä¸œçš„æ—¶é—´</p><p>ç°åœ¨æœ‰å¾ˆå¤šå¦¹å­æƒ³è·Ÿç½—è€å¸ˆçº¦ä¼š</p><p>å¥‡ç‰¹çš„ï¼Œå¥¹ä»¬æ¯å¤©æ€»ä¼šæå‡ºä¸¤æ®µçº¦ä¼šæ—¶é—´ï¼ˆå¯èƒ½ç›¸åŒï¼Œä»£è¡¨ä¸€ç§ï¼‰ï¼Œå¹¶ä¸”æ¯å¤©æå‡ºçš„æ€»æ˜¯ä¸€æ ·çš„ã€‚</p><p>å¥¹ä»¬æå‡ºçš„çº¦ä¼šæ—¶é—´å½¢å¼å½¢å¦‚i,j,ä»£è¡¨å¸Œæœ›åœ¨[iä¸œ,(i+1)ä¸œ)[iä¸œ,(i+1)ä¸œ)æˆ–[jä¸œ,(j+1)ä¸œ)[jä¸œ,(j+1)ä¸œ)ä¸ç½—è€å¸ˆè¿›è¡Œçº¦ä¼šã€‚</p><p>å½“ç„¶ï¼Œç½—è€å¸ˆå¯ä»¥è¿™ä¸¤æ®µæ—¶é—´éƒ½ä¸è¿™ä¸ªå¦¹å­çº¦ä¼š,åªé€‰æ‹©ä¸€æ®µï¼Œæˆ–è€…ä¼¤å¿ƒåœ°æŠ›å¼ƒã€‚</p><p>é‚£ä¹ˆï¼Œä½œä¸ºæ—¶é—´ç®¡ç†å¸¦å¸ˆçš„ç½—è€å¸ˆï¼Œ<strong>æ¯å¤©ä¼šé€‰æ‹©å°½å¯èƒ½å¤šçš„å¦¹å­è¿›è¡Œçº¦ä¼š</strong></p><p>ä½†ä½ ä¸€å®šè¦æ³¨æ„,<strong>ç½—è€å¸ˆæœ€è¿‘å¹¶ä¸æ‰“ç®—è¿›è¡Œå¤šäººè¿åŠ¨ï¼Œæ‰€ä»¥ä»–ä¸ä¼šåœ¨1ä¸œçš„æ—¶é—´åŒæ—¶ä¸ä¸¤ä¸ªæˆ–å¤šä¸ªå¦¹å­çº¦ä¼š</strong></p><p><strong>ç½—è€å¸ˆå¹¶ä¸è„¸ç›²ï¼Œä¸ä¸€ä¸ªå¦¹å­çº¦ä¼š2æ¬¡å¹¶ä¸èƒ½ç®—æˆâ€2â€æ¬¡çš„è´¡çŒ®ï¼Œåªèƒ½æ˜¯â€1â€</strong></p><p><strong>ç½—è€å¸ˆæ˜¯æ—¶é—´ç®¡ç†å¸¦å¸ˆï¼Œåªè¦æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼Œä»–å°±å¯ä»¥å®‰æ’å¥½ä»–çš„æ—¶é—´ï¼Œä¸ç”¨æ‹…å¿ƒåˆ«çš„</strong></p><p><strong>è€Œä¸”,æ¯å¤©å¯èƒ½ä¼šæœ‰æ–°çš„å¦¹å­å‘ç½—è€å¸ˆæå‡ºçº¦ä¼šé‚€è¯·</strong></p><p><strong>ä½†æ˜¯æ—¶é—´ä¹…äº†ï¼Œä¸€äº›å¦¹å­è®¤è¯†åˆ°<del>ç½—è€å¸ˆæ˜¯ä¸ªæ¸£ç”·</del>ç½—è€å¸ˆå¤ªå¿™äº†ï¼Œå°±ä¸å†ç»™ç½—è€å¸ˆæå‡ºçº¦ä¼šé‚€è¯·</strong></p><p><strong>æ¯å¤©è¦ä¹ˆæœ‰å¦¹å­åŠ å…¥ï¼Œè¦ä¹ˆæœ‰å¦¹å­é€€å‡ºï¼Œè¿™ä¸¤ç§æƒ…å†µæœ‰ä¸”ä»…ä¼šå‘ç”Ÿä¸€ç§ï¼Œå¹¶ä¸”é€€å‡ºçš„å¦¹å­ä¸€å®šæ˜¯å½“å‰æƒ³è¦å’Œç½—è€å¸ˆçº¦ä¼šçš„å¦¹å­ä¸­æ—¶é—´æœ€ä¹…çš„ã€‚å…¶å®ï¼Œè¿™å°±å¯¹åº”äº†åŒç«¯é˜Ÿåˆ—çš„pushå’Œpopã€‚æˆ‘ä»¬ä¿è¯ï¼Œç½—è€å¸ˆæ¯å¤©çš„å¦¹å­æ•°é‡éè´Ÿ</strong></p><p>ç°åœ¨ï¼Œä½œä¸ºç½—è€å¸ˆçš„è´´èº«ç§˜ä¹¦ï¼Œä½ æ¯å¤©è¦ç»™ç½—è€å¸ˆè§„åˆ’å¥½ä»–çš„æ—¶é—´ï¼Œæ¯å¤©å‘Šè¯‰ç½—è€å¸ˆä»–ä»Šå¤©æœ€å¤šå¯ä»¥çº¦ä¼šå¤šå°‘ä¸ªå¦¹å­</p><p>ä¸è¿‡æœ¬é¢˜ä¸­ï¼Œæ“ä½œå¯ä»¥å¼ºåˆ¶åœ¨çº¿</p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n, m \le 10^5, 0 \le type \le 1, 0 \le op, a, b \le 10^6$</p><p>å…¶ä¸­ $a, b$ è¡¨ç¤ºå¦¹å­çš„çº¦ä¼šæ—¶é—´ä¸º $a, b$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿™ç¥å¥‡çš„é¢˜ç›®æè¿°ï¼ŒçœŸçš„æ—¶é—´ç®¡ç†å¸¦å¸ˆ</p><p>å…ˆè€ƒè™‘æš´åŠ›ï¼Œæ¯æ¬¡æ›¿æ¢å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªç±»ä¼¼åŒˆç‰™åˆ©ç®—æ³•çš„ä¸œè¥¿ï¼Œç„¶åå®ƒåªåˆ é˜Ÿé¦–çš„å¦¹å­ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°½å¯èƒ½è®©é˜Ÿé¦–çš„å¦¹å­å¯¹ç­”æ¡ˆæ— å½±å“ï¼Œæ‰€ä»¥æ¯æ¬¡é˜Ÿå°¾åŠ å…¥ä¸€ä¸ªå¦¹å­çš„æ—¶å€™ï¼Œå¦‚æœåˆ¤æ–­å‡ºå¯ä»¥ä¸ºå¥¹å‡‘å‡ºä¸€ä¸ªé¢å¤–çš„ä½ç½®é‚£å°±ç›´æ¥åšï¼ŒåŠ å…¥ä¸è¡Œåˆ™æ›¿æ¢æ‰å…¶ä¸­æœ€æ—©å…¥é˜Ÿçš„å¦¹å­ï¼ˆå®é™…ä¸Šè¿™æ•´ä¸ªå¯ä»¥çœ‹æˆå¤šæ£µå†…å‘åŸºç¯æ ‘ï¼Œå³å‡å¦‚ç¼–å·ä¸º $i$ çš„å¦¹å­å äº†ä¸€ä¸ªä½ç½®ï¼Œå¹¶ä¸”å çš„æ˜¯çº¦ä¼šæ—¶é—´ $a$ï¼Œé‚£ä¹ˆå¥¹å°±è¿ä¸€æ¡ $a \rightarrow b$ çš„æœ‰å‘è¾¹ï¼Œå¹¶ç»™è¿™ä¸ªè¾¹ä»¥å…¥é˜Ÿé¡ºåºçš„ç¼–å·ï¼Œé‚£ä¹ˆæ¯ä¸€æ¬¡ç±»ä¼¼åŒˆç‰™åˆ©ç®—æ³•çš„è¿‡ç¨‹å³æ˜¯è¿™ä¸ªå›¾ä¸­çš„ä¸€æ¡é“¾ï¼Œé‚£ä¹ˆå°±å–ç¼–å·æœ€å°çš„è¾¹å°±è¡Œäº†ï¼‰ï¼Œé‚£ä¹ˆåœ¨åˆ é˜Ÿé¦–å¦¹å­çš„æ—¶å€™å¥¹å°±åªæœ‰å¯¹ç­”æ¡ˆæ— å½±å“æˆ–è€…å äº†ä¸€ä¸ªä½ç½®è€Œä½¿ç­”æ¡ˆå‡ä¸€ä¸¤ç§æƒ…å†µäº†</p><p>è¿™ä¸ªç†è®ºå¤æ‚åº¦æ˜¾ç„¶ä¸èƒ½è¿‡ï¼Œéšä¾¿å‡ºä¸ªä¸€æ¡é“¾çš„æ•°æ®å°±å¡æ‰äº†ï¼Œä½†æˆ‘è¿˜æ˜¯ç¨å¾®æ”¾ä¸€ä¸‹å®ƒçš„ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXA = <span class="number">1e06</span> + <span class="number">10</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> A, M, type;</span><br><span class="line"><span class="keyword">int</span> ns = <span class="number">1</span>, ne = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> posi[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">bool</span> visit[MAXA]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> who[MAXA]= &#123;<span class="number">0</span>&#125;, use[MAXN]= &#123;<span class="number">0</span>&#125;, in[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">pair&lt;int, int&gt; findpos (int u) &#123; // pair&lt;int, int&gt; åˆ†åˆ«è¡¨ç¤ºæ‰¾åˆ°çš„ç©ºåº§ä½ä¸å ä½ç½®çš„ç¼–å·æœ€å°å¦¹å­</span><br><span class="line">    <span class="keyword">if</span> (visit[u]) <span class="keyword">return</span> make_pair (- <span class="number">1</span>, who[u]);</span><br><span class="line">    <span class="keyword">if</span> (! who[u]) <span class="keyword">return</span> make_pair (u, <span class="number">0</span>);</span><br><span class="line">    visit[u] = <span class="literal">true</span>;</span><br><span class="line">    pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ret = findpos (posi[who[u]][use[who[u]] ^ <span class="number">1</span>]);</span><br><span class="line">    visit[u] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> make_pair (ret.first, min (ret.second, who[u]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">select</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> aim)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (visit[u]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (u == aim) &#123;</span><br><span class="line">        in[who[u]] = <span class="number">0</span>; who[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    visit[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> ((suc = select (posi[who[u]][use[who[u]] ^ <span class="number">1</span>], aim))) &#123;</span><br><span class="line">        <span class="keyword">int</span> p = who[u]; who[u] = <span class="number">0</span>;</span><br><span class="line">        use[p] ^= <span class="number">1</span>; in[p] = posi[p][use[p]];</span><br><span class="line">        who[in[p]] = p;</span><br><span class="line">    &#125;</span><br><span class="line">    visit[u] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> suc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> tp)</span> </span>&#123;</span><br><span class="line">    use[p] = tp, in[p] = posi[p][tp];</span><br><span class="line">    who[in[p]] = p;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    A = getnum (), M = getnum (), type = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> op, a, b;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">0</span>) &#123;</span><br><span class="line">            op = getnum ();</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">1</span>) a = getnum (), b = getnum ();  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            op = (getnum () + ans) % <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">1</span>) a = (getnum () + ans) % A + <span class="number">1</span>, b = (getnum () + ans) % A + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            posi[++ ne][<span class="number">0</span>] = a, posi[ne][<span class="number">1</span>] = b;</span><br><span class="line">            pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ret1 = findpos (a), ret2;</span><br><span class="line">            <span class="keyword">if</span> (ret1.first == - <span class="number">1</span>) &#123;</span><br><span class="line">                ret2 = findpos (b);</span><br><span class="line">                <span class="keyword">if</span> (~ ret2.first) &#123;</span><br><span class="line">                    select (b, ret2.first); add (ne, <span class="number">1</span>);</span><br><span class="line">                    ans ++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (ret1.second &lt; ret2.second) &#123;</span><br><span class="line">                    select (posi[ne][<span class="number">0</span>], in[ret1.second]);</span><br><span class="line">                    add (ne, <span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    select (posi[ne][<span class="number">1</span>], in[ret2.second]);</span><br><span class="line">                    add (ne, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123; select (a, ret1.first); add (ne, <span class="number">0</span>), ans ++; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (in[ns]) &#123;</span><br><span class="line">                ans --;</span><br><span class="line">                who[in[ns]] = <span class="number">0</span>; in[ns] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ns ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æ­£è§£ï¼Œç”¨ $\text{LCT}$ æ¥ç»´æŠ¤è¿™ä¸ªæœ€å°ç¼–å·å¦¹å­</p><p>ç°åœ¨å…ˆè€ƒè™‘è¿è¾¹æ•´å‡ºæ¥çš„è¿é€šå—ï¼Œè®¾è¯¥è¿é€šå—æœ‰ç‚¹ $x$ ä¸ªï¼Œè¾¹ $y$ ä¸ªï¼Œé‚£ä¹ˆæ˜¾ç„¶è‹¥ $x &gt; y$ï¼Œåˆ™ç­”æ¡ˆä¸º $x - 1$ï¼Œè‹¥ $x \le y$ï¼Œå°±ä»£è¡¨æœ‰ç¯ï¼Œé‚£ä¹ˆç­”æ¡ˆå³ä¸º $x$</p><p>ç°åœ¨è€ƒè™‘ç”¨ $\text{LCT}$ æ¥ç»´æŠ¤ï¼Œé¦–å…ˆæŠŠè¿™ä¸ªè¿é€šå—é‡Œé€‰æ‹©çš„èŠ‚ç‚¹æŠ½æˆä¸€æ£µæ ‘ï¼Œå¹¶ä¸”è¾¹åŒ–ç‚¹ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„è¾¹æ— æ³•åœ¨ $\text{LCT}$ ä¸­è¡¨ç¤ºï¼Œä½†æ˜¯åªè¦å­˜åœ¨å…¶ä¸­ä¸€æ¡å°±è¯´æ˜ä¸€å®šä¼šæ„æˆç¯ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€ç»Ÿè®¡æ¯ä¸ªç‚¹å®ƒä¼šè¿å¤šå°‘è¿™æ ·çš„è¾¹å³å¯</p><p>æ¯æ¬¡åˆ  $\text{LCT}$ ä¸­è¾¹çš„æ—¶å€™ï¼Œåˆ å®Œè¾¹å°±ç»™è¯¥è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹æƒå€¼å„åŠ ä¸€ï¼Œè¯´æ˜å®ƒä»¬ä¹‹é—´çš„è¾¹å˜æˆäº†ä½¿æˆç¯çš„è¾¹ï¼Œé‚£ä¹ˆå°±å¾—æ›´æ–°ç­”æ¡ˆï¼›åŒç†åŠ è¾¹åˆ™æŠŠå®ƒä»¬åŸæ¥åŠ ä¸Šçš„æƒå€¼å‡æ‰</p><p>æ„Ÿè§‰è¯´ä¸æ¸…æ¥šå…·ä½“è¿˜æ˜¯çœ‹ä»£ç æ³¨é‡Šå§</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, type, n;</span><br><span class="line"><span class="keyword">int</span> posi[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">// n: è¾¹åŒ–ç‚¹</span></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;, son[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> rev[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> vimi[MAXN]= &#123;<span class="number">0</span>&#125;, fic[MAXN]= &#123;<span class="number">0</span>&#125;, vism[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">// å½“å‰èŠ‚ç‚¹è¿çš„éæ ‘èŠ‚ç‚¹ä¸ªæ•°ã€å½“å‰èŠ‚ç‚¹è™šå­æ ‘vimiå’Œã€å½“å‰èŠ‚ç‚¹è™šå®å­æ ‘vimiå’Œ</span></span><br><span class="line"><span class="keyword">int</span> mini[MAXN]= &#123;<span class="number">0</span>&#125;; <span class="comment">// æœ€æ—©å…¥é˜Ÿè¾¹</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> son[father[p]][<span class="number">0</span>] != p &amp;&amp; son[father[p]][<span class="number">1</span>] != p; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sonbel</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> son[father[p]][<span class="number">1</span>] == p; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! p) <span class="keyword">return</span> ;</span><br><span class="line">swap (son[p][<span class="number">0</span>], son[p][<span class="number">1</span>]); rev[p] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">vism[p] = vimi[p] + fic[p] + vism[son[p][<span class="number">0</span>]] + vism[son[p][<span class="number">1</span>]];</span><br><span class="line">mini[p] = min (p &lt;= N ? INF : p, min (mini[son[p][<span class="number">0</span>]], mini[son[p][<span class="number">1</span>]]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! rev[p]) <span class="keyword">return</span> ;</span><br><span class="line">reverse (son[p][<span class="number">0</span>]), reverse (son[p][<span class="number">1</span>]);</span><br><span class="line">rev[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fa = father[p], anc = father[fa];</span><br><span class="line"><span class="keyword">int</span> s = sonbel (p);</span><br><span class="line">son[fa][s] = son[p][s ^ <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (son[fa][s]) father[son[fa][s]] = fa;</span><br><span class="line"><span class="keyword">if</span> (! isroot (fa)) son[anc][sonbel (fa)] = p;</span><br><span class="line">father[p] = anc;</span><br><span class="line">son[p][s ^ <span class="number">1</span>] = fa, father[fa] = p;</span><br><span class="line">pushup (fa), pushup (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">stack</span>[MAXN], top;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">top = <span class="number">0</span>; <span class="built_in">stack</span>[++ top] = p;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> tp = p; ! isroot (tp); tp = father[tp]) <span class="built_in">stack</span>[++ top] = father[tp];</span><br><span class="line"><span class="keyword">while</span> (top &gt; <span class="number">0</span>) pushdown (<span class="built_in">stack</span>[top]), top --;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> fa = father[p]; ! isroot (p); rotate (p), fa = father[p])</span><br><span class="line"><span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">sonbel (p) == sonbel (fa) ? rotate (fa) : rotate (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">access</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> tp = <span class="number">0</span>; p; tp = p, p = father[p]) &#123;</span><br><span class="line">splay (p);</span><br><span class="line">fic[p] += vism[son[p][<span class="number">1</span>]] - vism[tp];</span><br><span class="line">son[p][<span class="number">1</span>] = tp; pushup (p);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">makeroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; access (p), splay (p); reverse (p); &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">access (p), splay (p);</span><br><span class="line"><span class="keyword">while</span> (son[p][<span class="number">0</span>]) &#123; pushdown (p); p = son[p][<span class="number">0</span>]; &#125;</span><br><span class="line">splay (p);</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">value</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> vism[p] &gt; <span class="number">0</span>; &#125; <span class="comment">// åˆ¤æ–­æ˜¯å¦æˆç¯ï¼Œè‹¥æˆç¯åˆ™ç­”æ¡ˆéœ€è¦å†ç‚¹ä¸ªæ•°ä¸ŠåŠ ä¸€</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hideit</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> delta)</span> </span>&#123; <span class="comment">// å°†æ ‘ä¸Šè¾¹å˜ä¸ºä½¿æˆç¯è¾¹</span></span><br><span class="line">makeroot (p); ans -= value (p);</span><br><span class="line">vimi[p] += delta, pushup (p); ans += value (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> in[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">makeroot (x), makeroot (y);</span><br><span class="line">ans -= value (x) + value (y); <span class="comment">// åˆ å»åŸæ¥ä¸¤ä¸ªåˆ†å¼€çš„è¿é€šå—çš„è´¡çŒ®å†åŠ ä¸Šæ–°åˆæˆè¿é€šå—è´¡çŒ®</span></span><br><span class="line">ans ++; father[x] = father[y] = id;</span><br><span class="line">fic[id] += vism[x] + vism[y], pushup (id);</span><br><span class="line">ans += value (id); in[id] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cut</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">makeroot (x), access (y), splay (id);</span><br><span class="line">ans --, ans -= value (id);</span><br><span class="line">father[x] = father[y] = <span class="number">0</span>; ans += value (x) + value (y);</span><br><span class="line">in[id] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PUSH</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == y) &#123; hideit (x, <span class="number">2</span>); <span class="keyword">return</span> ; &#125;</span><br><span class="line">makeroot (x);</span><br><span class="line"><span class="keyword">if</span> (findroot (y) == x) &#123;</span><br><span class="line">access (y), splay (y); <span class="keyword">int</span> p = mini[y];</span><br><span class="line">cut (p, posi[p][<span class="number">0</span>], posi[p][<span class="number">1</span>]);</span><br><span class="line">hideit (posi[p][<span class="number">0</span>], <span class="number">1</span>), hideit (posi[p][<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">link (id, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">POP</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! in[id]) &#123;</span><br><span class="line">hideit (x, - <span class="number">1</span>), hideit (y, - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">cut (id, x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">n = N = getnum (), M = getnum (), type = getnum ();</span><br><span class="line"><span class="keyword">int</span> st = N + <span class="number">1</span>; mini[<span class="number">0</span>] = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> op, a, b;</span><br><span class="line"><span class="keyword">if</span> (type == <span class="number">0</span>) &#123;</span><br><span class="line">op = getnum ();</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">1</span>) a = getnum (), b = getnum ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">op = (getnum () + ans) % <span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">1</span>) a = (getnum () + ans) % N + <span class="number">1</span>, b = (getnum () + ans) % N + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">posi[++ n][<span class="number">0</span>] = a, posi[n][<span class="number">1</span>] = b; <span class="comment">// ++ nè¡¨ç¤ºè¾¹åŒ–ç‚¹</span></span><br><span class="line">PUSH (n, a, b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; POP (st, posi[st][<span class="number">0</span>], posi[st][<span class="number">1</span>]); st ++; &#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šå¤§çŒ«ç†Šå’Œä»–çš„kè¾¹å½¢"><a href="#Problem-Bï¼šå¤§çŒ«ç†Šå’Œä»–çš„kè¾¹å½¢" class="headerlink" title="Problem Bï¼šå¤§çŒ«ç†Šå’Œä»–çš„kè¾¹å½¢"></a>Problem Bï¼šå¤§çŒ«ç†Šå’Œä»–çš„kè¾¹å½¢</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>èœé¸¡zjrä»Šå¤©è¢«ä¸€é“å¹¼å„¿å›­å‡ ä½•é¢˜æ‰“çˆ†äº†ï¼Œä¸€åˆ†éƒ½æ‹¿ä¸åˆ°ã€‚</p><p>äºæ˜¯ä»–å‘ä½ æ±‚åŠ©QwQ:</p><p>ç»™å®š $n,k$ï¼Œæ±‚å‡º $i(k \le i \le n)$ è¾¹å½¢çš„æ‰€æœ‰ä¸‰è§’å‰–åˆ†ä¸­, $k$ è¾¹å½¢çš„æ€»æ•°çš„å’Œå¯¹ $1e9 + 7$ å–æ¨¡çš„ç»“æœã€‚</p><p>$k$ è¾¹å½¢æŒ‡çš„æ˜¯ $n$ ä¸ªç‚¹ä¸­çš„ $k$ ä¸ªç‚¹ï¼Œä»–ä»¬åœ¨è¿™ä¸ªå‰–åˆ†ä¸­æ„æˆä¸€ä¸ªå°é—­å›¾å½¢ã€‚</p><h3 id="æ•°æ®èŒƒå›´-1"><a href="#æ•°æ®èŒƒå›´-1" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$3 \le k \le n \le 5 \times 10^6$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å®˜æ–¹é¢˜è§£çœ‹ä¸æ‡‚ã€‚ã€‚çœ‹åˆ«äººçš„é¢˜è§£ã€‚ã€‚</p><p>é¦–å…ˆè¿™ä¸ªé—®é¢˜å¯ä»¥çœ‹æˆæ±‚æ‰€æœ‰ $n - 2$ ä¸ªèŠ‚ç‚¹çš„äºŒå‰æ ‘ä¸­å¤§å°ä¸º $k - 2$ çš„è¿é€šå—çš„æ•°é‡ä¹‹å’Œ</p><p>é‚£ä¹ˆç°åœ¨ç›´æ¥ä»¤ $n, k$ å‡äºŒ</p><p>å•ç‹¬è€ƒè™‘æ¯ä¸ªè¿é€šå—çš„è´¡çŒ®ï¼Œé¦–å…ˆå®ƒæœ‰ $Cat_k$ ç§å½¢æ€ï¼Œè¯¥æ ‘æœ‰ $k + 1$ ç§æ¥å­æ ‘çš„æ–¹æ¡ˆï¼ˆæ•°ä¸€ä¸‹å°±çŸ¥é“äº†ï¼Œä¸åŒ…æ‹¬è¯¥æ ‘æ ¹èŠ‚ç‚¹å¾€å…¶çˆ¶äº²è¿ï¼‰ï¼Œé‚£ä¹ˆç¬¬ä¸€éƒ¨åˆ†ï¼ˆæ¥å„¿å­ï¼‰æ–¹æ¡ˆæ•°å³ä¸º<br>$$<br>\sum\limits_{i = 0}^{n - k} Cat_k[x^i]C^{k + 1}<br>$$<br>å…¶ä¸­ $i$ è¡¨ç¤ºæ¥å„¿å­å­æ ‘çš„æ€»å¤§å°ï¼Œ$C$ è¡¨ç¤ºå¡ç‰¹å…°æ•°åˆ—çš„ç”Ÿæˆå‡½æ•°</p><p>é‚£ä¹ˆç°åœ¨è€ƒè™‘æ¥çˆ¶äº²ï¼Œå®¹æ˜“çŸ¥é“æ–¹æ¡ˆæ•°ä¸º<br>$$<br>\sum\limits_{j = 0}^{n - k - i} Cat_j(j + 1)<br>$$<br>å…¶ä¸­ $j$ è¡¨ç¤ºæ¥çš„æ ‘çš„å¤§å°ï¼Œ$j + 1$ ä¹Ÿæ˜¯ä¸€æ ·è¡¨ç¤ºå¯¹æ¥çš„æ ‘æ¥è®²æœ‰ $j + 1$ ç§æ¥å„¿å­çš„æ–¹æ¡ˆ</p><p>ç°åœ¨æ—¶é—´å¤æ‚åº¦çš„ç—‡ç»“åœ¨äº $[x^n]C^m$ çš„è®¡ç®—ï¼Œè€ƒè™‘å®ƒçš„å‡ ä½•æ„ä¹‰</p><p>å®ƒç›¸å½“äº $i$ ä¸ªæŠ˜çº¿å›¾æ‹¼èµ·æ¥ï¼Œç°åœ¨è€ƒè™‘å¦‚ä½•å°†è¿™äº›æŠ˜çº¿å›¾åˆ†æ®µï¼Œå°±æ˜¯å°†æ¯ä¸€æ®µæŠ˜çº¿å›¾çš„ç»“å°¾ $-1$ï¼Œé‚£ä¹ˆæ€»å…±ä¼šå‡ $m - 1$ æ¬¡ï¼ˆæœ€åä¸€æ®µæ˜¯ä¸éœ€è¦å‡çš„ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´â€œç¬¬ä¸€æ¬¡å‡ºç° $0$ åˆ°ç¬¬ä¸€æ¬¡å‡ºç° $- 1$ çš„ä½ç½®â€å¯¹åº”ç¬¬ä¸€æ®µæŠ˜çº¿ï¼Œâ€œç¬¬ä¸€æ¬¡å‡ºç° $- 1$ åˆ°ç¬¬ä¸€æ¬¡å‡ºç° $- 2$ çš„ä½ç½®â€å¯¹åº”ç¬¬äºŒæ®µæŠ˜çº¿ã€‚ã€‚ã€‚</p><p>é‚£ä¹ˆç°åœ¨å°±æ˜¯ç»™ $n$ ä¸ª $+ 1$ï¼Œ$n + m - 1$ ä¸ª $- 1$ï¼Œè®¡ç®—å…¶ç”± $(0, 0)$ åˆ° $(2n + m - 1, - m + 1)$ï¼Œå¹¶ä¸”ä¿è¯å‰ç¼€å’Œ $\ge - m + 1$ çš„æ–¹æ¡ˆæ•°ï¼Œæ•…æ˜¾ç„¶æœ‰<br>$$<br>[x^n]C^m = \dbinom{2n + m - 1}{n} - \dbinom{2n + m - 1}{n - 1}<br>$$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>æˆ‘çš„ $\text{code}$ è·‘çš„è´¼æ…¢</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e07</span> + <span class="number">10</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1e07</span>;</span><br><span class="line"> </span><br><span class="line">LL inv[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;, invfact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line">LL cat[MAXN]= &#123;<span class="number">0</span>&#125;, g[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function">LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD; &#125;</span><br><span class="line"><span class="function">LL <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="keyword">return</span> (C (<span class="number">2</span> * n + m - <span class="number">1</span>, n) - C (<span class="number">2</span> * n + m - <span class="number">1</span>, n - <span class="number">1</span>) + MOD) % MOD; &#125;</span><br><span class="line"><span class="comment">// [x^n]C^m</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, k;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    n -= <span class="number">2</span>, k -= <span class="number">2</span>;</span><br><span class="line">    fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    fact[<span class="number">1</span>] = invfact[<span class="number">1</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line">        inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">        fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">        invfact[i] = invfact[i - <span class="number">1</span>] * inv[i] % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    cat[<span class="number">0</span>] = g[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">        cat[i] = cat[i - <span class="number">1</span>] * (<span class="number">4</span> * i  - <span class="number">2</span>) % MOD * inv[i + <span class="number">1</span>] % MOD;</span><br><span class="line">        g[i] = (g[i - <span class="number">1</span>] + cat[i] * (i + <span class="number">1</span>) % MOD) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - k; i ++)</span><br><span class="line">        ans = (ans + cat[k] * calc (i, k + <span class="number">1</span>) % MOD * g[n - i - k] % MOD) % MOD;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Cï¼šSUMMER-WC"><a href="#Problem-Cï¼šSUMMER-WC" class="headerlink" title="Problem Cï¼šSUMMER WC"></a>Problem Cï¼šSUMMER WC</h2><h3 id="é¢˜ç›®æè¿°-2"><a href="#é¢˜ç›®æè¿°-2" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>OIeræ˜¯ä¸ªå¯çˆ±çš„ç¾¤ä½“ï¼Œä»–ä»¬æœ‰å¾ˆå¤šçš„ç¦å¿Œè¯æ±‡ï¼Œå¯¹æ­¤ä»–ä»¬ä¼šæœ‰åæ„Ÿåº¦ï¼Œæˆ‘ä»¬è¡¨ç¤ºæˆ $- x$ çš„å½¢å¼ï¼Œ$x$ ä¸ºæ­£æ•´æ•°ï¼Œè¶Šå¤§ï¼Œè¡¨ç¤ºä»–ä»¬è¶Šè®¨åŒï¼Œæ¯”å¦‚:</p><p>$\text{ccf}$ $-250250$ $\text{summerwc}$ $-2600$ $\text{unitedshengxuan}$ $-700$</p><p>ä½†ä»–ä»¬ä¹Ÿä¼šå¯¹ä¸€äº›ä¸œè¥¿æœ‰å¥½æ„Ÿåº¦ï¼Œç±»ä¼¼çš„ï¼Œæˆ‘ä»¬åˆ—å‡ºä¾‹å­:</p><p>$\text{frog}$ $+1000000$ï¼ˆå…¶å®è¿œè¿œä¸æ­¢ï¼Œä½†æœ¬é¢˜çš„æƒå€¼ä¸Šé™ $1e6$ï¼‰$\text{apiadu}$ $+3681$ $\text{txdy}$ $+3669$</p><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šä¾‹å­</p><p>ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¥½æ„Ÿåº¦å°±æ˜¯é‡Œé¢å‡ºç°è¿‡çš„è¯æ±‡çš„æ„Ÿè§‰çš„å’Œï¼Œä¸€ä¸ªè¯æ±‡å‡ºç°å¤šæ¬¡ç®—å¤šæ¬¡</p><p>ä¾‹å¦‚ $\text{frogfrog}$ çš„å¥½æ„Ÿåº¦å°±æ˜¯ $2e6$</p><p>ç‰¹åˆ«çš„ï¼Œæˆ‘ä»¬è€ƒè™‘ç©ºä¸²ï¼Œå…¶å¥½æ„Ÿåº¦ä¸º $0$</p><p>ç°åœ¨æˆ‘ä¹ˆç»™å‡ºä¸€ä¸ªå¤§çš„ä¸²ï¼ŒåŒæ—¶ç»™å‡ºæ‰€æœ‰è¯æ±‡(å¥½æ„Ÿåº¦å¯ä»¥ä¸ºè´Ÿï¼Œè¡¨ç¤ºæœ‰å¤šè®¨åŒ),æˆ‘ä»¬éœ€è¦æ±‚å‡ºé‡Œé¢æœ€å¤§å¥½æ„Ÿåº¦å­ä¸²ï¼Œå¯ä»¥ä¸ºç©º</p><h3 id="æ•°æ®èŒƒå›´-2"><a href="#æ•°æ®èŒƒå›´-2" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>è®¾ $n$ ä¸ªè¯æ±‡çš„é•¿åº¦å’Œä¸º $L$ï¼Œ$L_{max}$ ä¸ºå…¶ä¸­çš„æœ€å¤§é•¿åº¦</p><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n, m, L, L_{max} \le 10^6, ~ 1 \le x \le 10^6$</p><h3 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å®Œå…¨ä¸ä¼šã€‚ã€‚æˆ‘å­—ç¬¦ä¸²å®åœ¨å¤ªèœäº†ã€‚ã€‚</p><p>å¥½åƒè¿™æ˜¯ $\text{GDOI2019}$ çš„ $D2T3$ çš„åŸé¢˜</p><p>ä¸»è¦æ€è·¯å°±å…ˆå»ºå‡ºä¸€ä¸ª$\text{AC}$è‡ªåŠ¨æœºç„¶ååœ¨ä¸Šé¢$dp$</p><p>å»ºå‡ºè‡ªåŠ¨æœºåé‚£äº›ç»“å°¾èŠ‚ç‚¹éƒ½ä¼šæœ‰ä¸€ä¸ªæƒå€¼ $val$ï¼Œé‚£ä¹ˆå¯¹æ–‡æœ¬ä¸² $[l, r]$ çš„å­ä¸²å°±æ˜¯åœ¨è‡ªåŠ¨æœºä¸Šèµ°ç„¶åæŠŠè·¯å¾„ä¸Šæ‰€æœ‰ $val$ åŠ èµ·æ¥å³å¯å¾—åˆ°å®ƒçš„å¥½æ„Ÿåº¦å’Œ</p><p>æ­¤æ—¶ä¸å¦¨è®¾è®¡çŠ¶æ€ $f_{i, j}$ è¡¨ç¤ºæ–‡æœ¬ä¸²åŒ¹é…åˆ° $i$ æ—¶ï¼Œ$\text{AC}$è‡ªåŠ¨æœºä¸Šèµ°åˆ°èŠ‚ç‚¹ $j$ æ—¶çš„æœ€å¤§å€¼ï¼Œè€Œé€ æˆè¿™ä¸ªæœ€å¤§å€¼çš„å­ä¸²å³æ˜¯ $1â€¦i$ çš„å…¶ä¸­ä¸€ä¸ªåç¼€å­ä¸²</p><p>å‡è®¾æ–‡æœ¬ä¸²å­ä¸² $[1, i]$ åœ¨è‡ªåŠ¨æœºä¸Šèµ°åˆ°èŠ‚ç‚¹ $node_i$ï¼Œé‚£ä¹ˆç°åœ¨è€ƒè™‘æœ‰å¯èƒ½è¢« $1â€¦i$ çš„åç¼€å­ä¸²éå†åˆ°çš„ $j$ï¼Œåˆ™ $j$ ä¸€å®šåœ¨ $fail$ æ ‘ä¸Šæ˜¯ $node_i$ çš„ç¥–å…ˆï¼Œæ•…æ€»çŠ¶æ€æœ‰ $mL_{max}$ ä¸ªï¼Œæ­¤æ—¶å¤æ‚åº¦ä¸º $O (mL_{max})$</p><p>ç°åœ¨å¯¹ä¸Šè¿° $dp$ è¿›è¡Œä¼˜åŒ–</p><p>åœ¨å¾€$\text{AC}$è‡ªåŠ¨æœºé‡Œæ’å…¥çš„æ—¶å€™ï¼Œå»ºç«‹çˆ¶å­å…³ç³»ï¼ˆå³$\text{trie}$æ ‘ä¸Šçš„çˆ¶å­å…³ç³»ï¼‰ï¼Œç”¨ $fa_i$ è¡¨ç¤º</p><p>æ¯ç»è¿‡è‡ªåŠ¨æœºä¸ŠæŸä¸€æ¡è¾¹ï¼Œè½¬ç§»ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œæ•…ç®€åŒ–ä¸€ä¸‹ï¼Œä»¤ $f_i$ è¡¨ç¤ºè‡ªåŠ¨æœºä¸Šèµ°åˆ° $i$ çš„ç­”æ¡ˆï¼ˆæ­¤æ—¶ä¸æ–‡æœ¬ä¸²æ— å…³ï¼Œå› ä¸ºèŠ‚ç‚¹ $i$ å·²ç»ç¡®å®šäº†å”¯ä¸€ä¸€ä¸ªåç¼€ï¼‰ï¼Œè€ƒè™‘ $f_i$ éƒ½ä»å“ªé‡Œè½¬ç§»ï¼Œä»¤å­—ç¬¦ä¸² $S_i$ è¡¨ç¤ºèŠ‚ç‚¹ $i$ è¡¨ç¤ºåç¼€</p><ul><li>ç›´æ¥ç­‰äº $f_{fail_i}$</li><li>ç”± $fa_i$ åŠå…¶åç¼€å†åŠ ä¸Š $val_{fail_i}$ è½¬ç§»ï¼ˆå³ä¸å– $S_i$ çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆ $val_i$ ä¹Ÿä¸èƒ½åŠ ä¸Šäº†ï¼‰</li><li>ç›´æ¥å–æ•´ä¸ª $S_i$</li></ul><p>æ•…æ­¤æ—¶å†è®¾ä¸¤ä¸ªçŠ¶æ€ $g_i, h_i$ï¼Œå…¶ä¸­ $g_i$ è¡¨ç¤ºç¬¬ä¸‰ç§æƒ…å†µï¼Œ$h_i$ è¡¨ç¤ºç¬¬äºŒç§æƒ…å†µï¼Œé‚£ä¹ˆ $f_i$ çš„è½¬ç§»å°±è¡¨ç¤ºä¸º<br>$$<br>f_i = \max (f_{fail_i}, \max (g_i, h_i))<br>$$<br>è‡³äºä¸ºä»€ä¹ˆè¿˜è¦è®¾ $h_i$ï¼Œå› ä¸ºå‡å¦‚ç›´æ¥ä» $f_{fail_i}$ è½¬ç§»çš„è¯å¯èƒ½ $S_i$ çš„æŸäº›æœ‰è´¡çŒ®åç¼€å°±æ— æ³•è¢«éå†åˆ°äº†ï¼Œä¸¾ä¸ªä¾‹å­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e</span><br><span class="line">de</span><br><span class="line">bd</span><br><span class="line">abde</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆåœ¨è®¡ç®— $f(abde)$ çš„æ—¶å€™ï¼Œè‹¥åªå–å…¶ $fail$ æ ‘ä¸Šçˆ¶äº²ï¼Œåˆ™åªä¼šè®¿é—®åˆ° $\text{de}$ï¼Œé‚£ä¹ˆ $\text{bd}$ åé¢æ‹¼ä¸Šä¸€ä¸ª $e$ çš„æƒ…å†µå°±éå†ä¸åˆ°äº†</p><p>å…¶ä¸­å¯¹ $h_i$ çš„è½¬ç§»åªè¦è€ƒè™‘ $S_i$ ä¸ $S_{fail_i}$ çš„å·®å€¼éƒ¨åˆ†å°±å¥½äº†ï¼Œæ•…æ€»è½¬ç§»å¤æ‚åº¦æ˜¯ $O (m + L)$ çš„</p><p>æ³¨æ„è®°å¾—å°†æ–‡æœ¬ä¸²æ’å…¥åˆ°è‡ªåŠ¨æœºä¸­ï¼Œä¸ç„¶æ˜¾ç„¶æ— æ³•ç»Ÿè®¡ç­”æ¡ˆ</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">char</span> str[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> tr[MAXN][<span class="number">26</span>]= &#123;<span class="number">0</span>&#125;, fail[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL value[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>; <span class="keyword">int</span> n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = str[i] - <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">if</span> (! tr[p][c]) &#123; tr[p][c] = ++ m; father[m] = p; &#125;</span><br><span class="line">p = tr[p][c];</span><br><span class="line">&#125;</span><br><span class="line">value[p] += x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line">LL f[MAXN]= &#123;<span class="number">0</span>&#125;, g[MAXN]= &#123;<span class="number">0</span>&#125;, h[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++)</span><br><span class="line"><span class="keyword">if</span> (tr[<span class="number">0</span>][i])</span><br><span class="line">que.push(tr[<span class="number">0</span>][i]);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line">value[u] += value[fail[u]];</span><br><span class="line">g[u] = g[father[u]] + value[u];</span><br><span class="line"><span class="keyword">if</span> (! fail[u]) h[u] = h[father[u]];</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">h[u] = - INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = father[u]; j != father[fail[u]]; j = fail[j])</span><br><span class="line">h[u] = max (h[u], h[j] + value[fail[u]]);</span><br><span class="line">&#125;</span><br><span class="line">f[u] = max (f[fail[u]], max (g[u], h[u]));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (tr[u][i]) &#123;</span><br><span class="line">fail[tr[u][i]] = tr[fail[u]][i];</span><br><span class="line">que.push(tr[u][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> tr[u][i] = tr[fail[u]][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>, n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = str[i] - <span class="string">'a'</span>;</span><br><span class="line">p = tr[p][c];</span><br><span class="line">ans = max (ans, f[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>);</span><br><span class="line">insert (getnum ());</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>); insert (<span class="number">0</span>);</span><br><span class="line">build ();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; solve () &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LCT </tag>
            
            <tag> ç»„åˆæ•°å­¦ </tag>
            
            <tag> å¡ç‰¹å…°æ•° </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> ACè‡ªåŠ¨æœº </tag>
            
            <tag> åŠ¨æ€è§„åˆ’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåäºŒï¼‰</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%8C%EF%BC%89/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%8C%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ä»Šæ—¥ç»§ç»­å«åº•ç³»åˆ—</p><p>T1é¢˜æ„ç†è§£é”™è¯¯æš´åŠ›å†™æŒ‚</p><p>T2æ€’æ•² $n \le 4$ æ±‚æ ¹å…¬å¼ç„¶åå‘ç°ç­”æ¡ˆè¿˜å¾—æ’åºã€‚ã€‚</p><p>$\text{scoreï¼š0 + 10 + 0 = 10   rkï¼š27/27}$</p><h2 id="Problem-Aï¼šæ¸¸æˆ"><a href="#Problem-Aï¼šæ¸¸æˆ" class="headerlink" title="Problem Aï¼šæ¸¸æˆ"></a>Problem Aï¼šæ¸¸æˆ</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ysghæ˜¯ä¸€åHerthstoneå¤§å¸ˆã€‚ç°åœ¨ä»–é‡åˆ°äº†ä¸€ä¸ªå¾ˆä¸¥å³»çš„é—®é¢˜ï¼š</p><p>åœºä¸Šæ€»å…±æœ‰ $n+m$ ä¸ªéšä»ï¼Œå…¶ä¸­ysghæ§åˆ¶ç€ $n$ ä¸ªï¼Œå¯¹æ‰‹æ§åˆ¶ç€ $m$ ä¸ªã€‚æ¯ä¸ªéšä»æœ‰è‡ªå·±çš„è¡€é‡ã€‚</p><p>å¦‚æœysghåœ¨è¿™ä¸€å›åˆæˆåŠŸè§£æ‰äº†å¯¹æ‰‹çš„æ‰€æœ‰éšä»ï¼Œåˆ™ysghè·èƒœã€‚å¦åˆ™ä¸‹ä¸€å›åˆå¯¹æ‰‹ç›´æ¥éª‘è„¸ï¼Œysghå°±ä¼šè¾“æ‰ã€‚</p><p>ysghç°åœ¨æ‰‹é‡Œä»…æœ‰ä¸€åœºç‰Œï¼Œå±æ€§å¦‚ä¸‹ï¼š</p><p>è¿›è¡Œ $d$ æ¬¡ï¼Œæ¯ä¸€æ¬¡ç­‰æ¦‚ç‡éšæœºä¸€ä¸ªåœ¨åœºä¸Šçš„æœªæ­»äº¡éšä»ï¼ˆåŒ…æ‹¬è‡ªå·±å’Œå¯¹æ‰‹çš„ï¼‰å¹¶ä¸”å¯¹å…¶é€ æˆä¸€ç‚¹ä¼¤å®³ã€‚è‹¥ä¸å­˜åœ¨æœªæ­»äº¡éšä»ï¼Œåˆ™ä¸è¿›è¡Œæ­¤æ¬¡æ”»å‡»ã€‚ä¸€ä¸ªéšä»æœªæ­»äº¡å½“ä¸”ä»…å½“å…¶è¡€é‡ä¸¥æ ¼å¤§äº $0$ã€‚æ¯ä¸€æ¬¡æ”»å‡»åï¼Œæ‰€æœ‰è¡€é‡å°äºç­‰äº $0$ çš„éšä»ç«‹å³æ­»äº¡ã€‚</p><p>ysghæƒ³è¦çŸ¥é“ï¼Œä»–æœ‰å¤šå¤§æ¦‚ç‡å¯ä»¥å–èƒœï¼Œä¹Ÿå°±æ˜¯å¤šå¤§çš„æ¦‚ç‡ä½¿å¾—åœ¨ä½¿ç”¨è¿™å¼ ç‰Œåï¼Œå¯¹æ‰‹çš„éšä»å…¨éƒ¨æ­»äº¡ã€‚</p><p><strong>ç‰¹åˆ«æé†’ï¼šç”±äºæè¿°ä¸å®é™…æ¸¸æˆè§„åˆ™æœ‰å‡ºå…¥ï¼Œä¸€åˆ‡ä»¥å®é™…é¢˜é¢æè¿°ä¸ºå‡†ã€‚</strong></p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹äºæ‰€æœ‰æµ‹è¯•æ•°æ®ï¼Œæ»¡è¶³ $1 \le n, m \le 6, ~ 1 \le d \le 400$</p><p>ä¿è¯æ‰€æœ‰éšä»è¡€é‡å‡ä¸º $1 \sim 12$ ä¹‹é—´çš„æ­£æ•´æ•°</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>æˆ‘æ²¡ç©è¿‡ç‚‰çŸ³è¿˜çœŸæ˜¯å¯¹ä¸èµ·å“¦ã€‚ã€‚åŸæ¥å‡å¦‚è¿™ä¸€ä¸ªæŠ€èƒ½ç»“æŸå…¨åœºéƒ½æ²¡äº†çš„è¯æ˜¯ç®—æˆ‘æ–¹èƒœåˆ©è€Œä¸æ˜¯å¹³æ‰‹ã€‚ã€‚</p><p>å°† $n + m$ ä¸ªéšä»ä¸€èµ·è€ƒè™‘ï¼Œè®¾ç¬¬ $i$ ä¸ªéšä»è¡€é‡ $a_i$</p><p>å¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°è®¾ $f_{i, state}$ è¡¨ç¤ºå‰ $i$ è½®ï¼Œæ­»äº¡çŠ¶æ€ä¸ºä¸º $state$ çš„æ¦‚ç‡</p><p>æ˜¾ç„¶ä¸€ä¸ªéšä»æ­»äº¡åä¼šåˆ†ä¸€æ®µï¼Œå°±æ˜¯ä½ æ¥ä¸‹æ¥è¦ä¹˜çš„æ¦‚ç‡åˆ†æ¯è¦å‡ä¸€</p><p>å¤šåŠ ä¸€ä¸ªæ­»äº¡éšä»å¾ˆå¥½è½¬ç§»ï¼Œä½†æ˜¯å½“æ—¶æˆ‘å°±å¡åœ¨å¦‚ä½•è®¡ç®—è¯¥éšä»çš„è¡€é‡åˆ†é…åœ¨å‰é¢å‡ æ®µéœ€è¦ä¹˜ä¸Šçš„æ¦‚ç‡</p><p>å®é™…ä¸Šå¾ˆç®€å•ï¼Œåªè¦åœ¨è½¬ç§»è¯¥è½®æ”»å‡»åæ— æ–°äººæ­»äº¡çš„æ—¶å€™â€œé¢„æ”¯â€ä¸€ä¸‹è¿™ä¸ªæ¦‚ç‡å°±å¥½äº†ï¼Œ$\text{dp}$ å¼å­å¦‚ä¸‹ï¼Œå…¶ä¸­ï¼Œä»¤ $|state|$ è¡¨ç¤º $state$ äºŒè¿›åˆ¶è¡¨ç¤º $1$ çš„ä¸ªæ•°ï¼Œ$s (state)$ è¡¨ç¤º $state$ è¡¨ç¤ºå‡ºçš„æ­»äº¡éšä»çš„æ€»è¡€é‡<br>$$<br>\begin{aligned}<br>æ”»å‡»åæ— æ–°äººæ­»äº¡ï¼š&amp;f_{i, state} \times \frac1{n + m - |state|} \rightarrow f_{i + 1, state} \\<br>æ”»å‡»åå­˜åœ¨æ–°éšä»k(k \not\in state)æ­»äº¡ï¼š&amp;f_{i, state} \times \frac{\dbinom{i - s (state)}{a_k - 1}}{n + m - |state|} \rightarrow f_{i, state | (1 &lt;&lt; (k - 1))}<br>\end{aligned}<br>$$<br>â€œé¢„æ”¯â€è¿‡ååœ¨æ­»äº¡éšä»è½¬ç§»æ—¶å°±åªè¦ç›´æ¥åœ¨å‰é¢é¢„ç•™ä¸‹çš„ä½ç½®ä¸­é€‰å‡ ä¸ªå°±å¥½äº†</p><p>å½“ç„¶ç°åœ¨è¿˜éœ€è¦å°†å‰©ä¸‹çš„æœªæ­»äº¡çš„éšä»çš„è¡€é‡åˆ†é…ï¼ˆå³ä»–ä»¬å¯èƒ½è¢«æ”»å‡»ä½†æœªæ­»äº¡ï¼‰ï¼Œä¸€ä¸ªå¤šé‡èƒŒåŒ…å°±å¥½äº†</p><p>æ—¶é—´å¤æ‚åº¦ $O (2^{n + m}144^2)$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1</span> &lt;&lt; <span class="number">12</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">12</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXD = <span class="number">144</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD, p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N, M, D;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL inv[MAXD]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL fact[MAXD]= &#123;<span class="number">0</span>&#125;, ifact[MAXD]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (m &gt; n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> fact[n] * ifact[m] % MOD * ifact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL f[MAXD][MAX]= &#123;<span class="number">0</span>&#125;, g[MAXN][MAXD]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (state &gt; <span class="number">0</span>) &#123;</span><br><span class="line">cnt ++; state ^= lowbit (state);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> b[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), D = getnum (); T = N + M;</span><br><span class="line">fact[<span class="number">0</span>] = ifact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">fact[<span class="number">1</span>] = ifact[<span class="number">1</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= max (T, D); i ++) &#123;</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">ifact[i] = ifact[i - <span class="number">1</span>] * inv[i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N + M; i ++) &#123; a[i] = getnum (); tot += a[i]; &#125;</span><br><span class="line">D = min (D, tot);</span><br><span class="line"><span class="keyword">int</span> limit = (<span class="number">1</span> &lt;&lt; T) - <span class="number">1</span>;</span><br><span class="line">f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; D; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">0</span>; state &lt;= limit; state ++) &#123;</span><br><span class="line"><span class="keyword">int</span> s = calc (state), sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= T; j ++)</span><br><span class="line"><span class="keyword">if</span> (state &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)))</span><br><span class="line">sum += a[j];</span><br><span class="line"><span class="keyword">if</span> (i &lt; sum) <span class="keyword">continue</span>;</span><br><span class="line">f[i + <span class="number">1</span>][state] = (f[i + <span class="number">1</span>][state] + f[i][state] * inv[T - s] % MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= T; k ++)</span><br><span class="line"><span class="keyword">if</span> (! (state &amp; (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>)))) &#123;</span><br><span class="line">LL mul = C (i - sum, a[k] - <span class="number">1</span>) % MOD * inv[T - s] % MOD;</span><br><span class="line">f[i + <span class="number">1</span>][state | (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))] = (f[i + <span class="number">1</span>][state | (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))] + f[i][state] * mul % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> stan = <span class="number">0</span>;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = N + <span class="number">1</span>; j &lt;= T; j ++) stan |= (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">0</span>; state &lt;= limit; state ++)</span><br><span class="line"><span class="keyword">if</span> ((state &amp; stan) == stan) &#123;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>, m = <span class="number">0</span>;</span><br><span class="line">g[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= T; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (state &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))) sum += a[j];</span><br><span class="line"><span class="keyword">else</span> b[++ m] = a[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> V = D - sum;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= V; k ++) &#123;</span><br><span class="line">g[j][k] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt;= min (k, b[j] - <span class="number">1</span>); l ++)</span><br><span class="line">g[j][k] = (g[j][k] + g[j - <span class="number">1</span>][k - l] * C (V - (k - l), l) % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">ans = (ans + f[D][state] * g[m][V] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šæ–¹ç¨‹"><a href="#Problem-Bï¼šæ–¹ç¨‹" class="headerlink" title="Problem Bï¼šæ–¹ç¨‹"></a>Problem Bï¼šæ–¹ç¨‹</h2><h3 id="é¢˜é¢æè¿°"><a href="#é¢˜é¢æè¿°" class="headerlink" title="é¢˜é¢æè¿°"></a>é¢˜é¢æè¿°</h3><p>æ±‚è§£ä¸€å…ƒ $n$ æ¬¡æ–¹ç¨‹ $f(x) = \sum a_ix^i = 0$ çš„æ‰€æœ‰å®æ•°æ ¹</p><p>æœ‰ $T$ ç»„æ•°æ®</p><p><strong>æ³¨æ„è¾“å‡ºçš„å®æ•°æ ¹è¦æŒ‰ä»å¤§åˆ°å°æ’åº</strong></p><h3 id="æ•°æ®èŒƒå›´-1"><a href="#æ•°æ®èŒƒå›´-1" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>$1 \le n \le 6$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>ï¼ˆç™¾åº¦é•¿çš„è·Ÿä»€ä¹ˆä¸€æ ·çš„æ±‚æ ¹å…¬å¼çš„å‘å¾®çš„æˆ‘ï¼‰</p><p>å¯¹ $f(x)$ï¼Œè€ƒè™‘å…¶å¯¼æ•° $fâ€™(x)$ï¼Œå¯¹äº $fâ€™(x)$ çš„ç›¸é‚»ä¸¤å®æ•°æ ¹ $x_1, x_2$ æ˜¾ç„¶æœ‰ $f(x)$ åœ¨ $(x_1, x_2)$ å•è°ƒ</p><p>é‚£ä¹ˆæ±‚å‡º $fâ€™(x)$ å®æ•°æ ¹ååœ¨ä¸Šè¿°å•è°ƒåŒºé—´äºŒåˆ†ç­”æ¡ˆå³å¯</p><p>é€’å½’å¤„ç†</p><p>æ—¶é—´å¤æ‚åº¦ $O (Tn^3)$</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> Ld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">6</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Ld eps = <span class="number">1e-12</span>;</span><br><span class="line"><span class="keyword">const</span> Ld INF = <span class="number">1e20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dcmp</span> <span class="params">(Ld p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">fabs</span> (p) &lt; eps) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> p &lt; <span class="number">0</span> ? - <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> t[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> cnt[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">Ld zero[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function">Ld <span class="title">value</span> <span class="params">(<span class="keyword">int</span> n, Ld val)</span> </span>&#123;</span><br><span class="line">Ld x = <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++, x = x * val)</span><br><span class="line">ret += t[n][i] * x;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> n, Ld L, Ld R, Ld&amp; ze)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> d1 = dcmp (value (n, L));</span><br><span class="line"><span class="keyword">int</span> d2 = dcmp (value (n, R));</span><br><span class="line"><span class="keyword">if</span> (d1 * d2 &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (d1 * d2 == <span class="number">0</span>) &#123; ze = d1 == <span class="number">0</span> ? L : R; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (d1 &lt; <span class="number">0</span>) &#123;</span><br><span class="line">Ld left = L, right = R;</span><br><span class="line"><span class="keyword">while</span> (dcmp (right - left) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Ld mid = (left + right) / <span class="number">2.0</span>;</span><br><span class="line"><span class="keyword">if</span> (dcmp (value (n, mid)) &lt;= <span class="number">0</span>) left = mid;</span><br><span class="line"><span class="keyword">else</span> right = mid;</span><br><span class="line">&#125;</span><br><span class="line">ze = left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">Ld left = L, right = R;</span><br><span class="line"><span class="keyword">while</span> (dcmp (right - left) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">Ld mid = (left + right) / <span class="number">2.0</span>;</span><br><span class="line"><span class="keyword">if</span> (dcmp (value (n, mid)) &gt;= <span class="number">0</span>) left = mid;</span><br><span class="line"><span class="keyword">else</span> right = mid;</span><br><span class="line">&#125;</span><br><span class="line">ze = left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">Ld a = t[n][<span class="number">1</span>], b = t[n][<span class="number">0</span>];</span><br><span class="line">zero[n][++ cnt[n]] = - b / a;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">2</span>) &#123;</span><br><span class="line">Ld a = t[n][<span class="number">2</span>], b = t[n][<span class="number">1</span>], c = t[n][<span class="number">0</span>];</span><br><span class="line">Ld delta = b * b - <span class="number">4</span> * a * c;</span><br><span class="line"><span class="keyword">if</span> (dcmp (delta) &lt; <span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (dcmp (delta) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (dcmp (delta) == <span class="number">0</span>) delta = <span class="number">0</span>;</span><br><span class="line">Ld x1, x2;</span><br><span class="line"><span class="keyword">if</span> (dcmp (a) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">x1 = (- b - <span class="built_in">sqrt</span> (delta)) / (<span class="number">2.0</span> * a);</span><br><span class="line">x2 = (- b + <span class="built_in">sqrt</span> (delta)) / (<span class="number">2.0</span> * a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">x1 = (- b + <span class="built_in">sqrt</span> (delta)) / (<span class="number">2.0</span> * a);</span><br><span class="line">x2 = (- b - <span class="built_in">sqrt</span> (delta)) / (<span class="number">2.0</span> * a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (dcmp (delta) == <span class="number">0</span>) zero[n][++ cnt[n]] = x1;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">zero[n][++ cnt[n]] = x1;</span><br><span class="line">zero[n][++ cnt[n]] = x2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">work (n - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (! cnt[n - <span class="number">1</span>]) &#123;</span><br><span class="line">Ld posi;</span><br><span class="line"><span class="keyword">if</span> (find (n, - INF, INF, posi))</span><br><span class="line">zero[n][++ cnt[n]] = posi;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">zero[n - <span class="number">1</span>][<span class="number">0</span>] = - INF, zero[n - <span class="number">1</span>][cnt[n - <span class="number">1</span>] + <span class="number">1</span>] = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= cnt[n - <span class="number">1</span>]; i ++) &#123;</span><br><span class="line">Ld posi;</span><br><span class="line"><span class="keyword">if</span> (find (n, zero[n - <span class="number">1</span>][i], zero[n - <span class="number">1</span>][i + <span class="number">1</span>], posi))</span><br><span class="line">zero[n][++ cnt[n]] = posi;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++)</span><br><span class="line">t[i][j] = t[i + <span class="number">1</span>][j + <span class="number">1</span>] * (j + <span class="number">1</span>);</span><br><span class="line">work (n);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, cnt[n]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt[n]; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%.8Lf\n"</span>, zero[n][i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line"><span class="built_in">memset</span> (t, <span class="number">0</span>, <span class="keyword">sizeof</span> (t));</span><br><span class="line"><span class="built_in">memset</span> (cnt, <span class="number">0</span>, <span class="keyword">sizeof</span> (cnt));</span><br><span class="line"><span class="built_in">memset</span> (zero, <span class="number">0</span>, <span class="keyword">sizeof</span> (zero));</span><br><span class="line"><span class="keyword">int</span> n = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++) t[n][i] = getnum ();</span><br><span class="line">solve (n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Cï¼šæ—…æ¸¸"><a href="#Problem-Cï¼šæ—…æ¸¸" class="headerlink" title="Problem Cï¼šæ—…æ¸¸"></a>Problem Cï¼šæ—…æ¸¸</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ysghæ˜¯æœ€ä¼˜åŒ–å¤§å¸ˆ</p><p>ysghæƒ³å»æ—…æ¸¸ï¼Œä»–æ‰€åœ¨çš„åŸå¸‚å…±æœ‰ $n$ ä¸ªæ™¯ç‚¹ï¼Œæ™¯ç‚¹ä¹‹é—´æœ‰ $m$ æ¡åŒå‘é“è·¯è¿æ¥ã€‚ä¿è¯ $n$ ä¸ªæ™¯ç‚¹å¯ä»¥é€šè¿‡ $m$ æ¡é“è·¯äº’ç›¸åˆ°è¾¾ã€‚é“è·¯é•¿åº¦å‡ä¸º $1$ã€‚</p><p>ysghå¯ä»¥é€šè¿‡ä¹˜åå‡ºç§Ÿè½¦å®Œæˆæ—…è¡Œã€‚å…·ä½“çš„ï¼Œç¬¬ $i$ ä¸ªæ™¯ç‚¹çš„å‡ºç§Ÿè½¦æœ€å¤šå¯ä»¥å°†å…¶è½½åˆ°è·ç¦» $i$ ä¸è¶…è¿‡ $f_i$ çš„åœ°æ–¹ã€‚åœ¨ç¬¬ $T$ å¤©ï¼Œæ­ä¹˜ä»ç¬¬ $i$ ä¸ªæ™¯ç‚¹å‡ºå‘çš„å‡ºç§Ÿè½¦éœ€è¦èŠ±è´¹ $c_i \times T + w_i$ å…ƒã€‚</p><p>ysghçš„é’±å·²ç»åœ¨å°å–éƒ¨ä¸­æŒ¥éœä¸€ç©ºï¼Œå› æ­¤ä»–æƒ³è¦é€‰æ‹© $1$ è‡³ $T_{max}$ ä¸­çš„ä¸€å¤©ï¼Œä»æ™¯ç‚¹ $1$ å‡ºå‘ï¼Œæ­ä¹˜å‡ºç§Ÿè½¦åˆ°è¾¾æ™¯ç‚¹$x$ï¼ŒåŒæ—¶èŠ±è´¹å°½é‡åœ°å°ã€‚</p><p>ç”±äºä»–æ²¡æœ‰å®šä¸‹æ¥åœ¨é‚£ä¸ªåŸå¸‚æ¸¸ç©ï¼Œå› æ­¤ä»–æƒ³è¦å¯¹æ‰€æœ‰çš„ $x \in [1, n]$ æ±‚å‡ºç­”æ¡ˆã€‚</p><h3 id="æ•°æ®èŒƒå›´-2"><a href="#æ•°æ®èŒƒå›´-2" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/06/52phqVItFKWuRNg.png" alt=""></p><p>ä¿è¯å¯¹æ‰€æœ‰ $1 \le T \le T_{max}, c_i \times T + w_i &gt; 0$</p><h3 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è®¾ $v_i = c_i \times T + w_i$</p><p>è€ƒè™‘æš´åŠ›ï¼Œå¯¹æ¯ä¸ªç‚¹å‘å®ƒèƒ½åˆ°è¾¾çš„æ‰€æœ‰ç‚¹è¿ä¸€ä¸ªè¾¹æƒä¸º $v_i$ çš„è¾¹ï¼Œä¸”å®¹æ˜“å‘ç°ï¼Œç­”æ¡ˆä¸€å®šåœ¨ $T$ å– $1$ æˆ– $T_{max}$ ä¸­é€‰ï¼Œç„¶åä» $1$ å¼€å§‹è·‘æœ€çŸ­è·¯</p><p>ç”±äºæ¯ä¸ªç‚¹å‘å¤–å‡ºè¾¹è¾¹æƒç›¸åŒï¼Œæ‰€ä»¥è€ƒè™‘ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–å»ºå›¾è¿‡ç¨‹</p><p>ä» $m = n - 1$ çš„æƒ…å†µå¼€å§‹è¯´æ˜ï¼Œé¦–å…ˆè´ªå¿ƒæ€æƒ³ï¼Œæ¯ä¸ªç‚¹åªä¼šè¢«æ›´æ–°ä¸€æ¬¡ï¼Œæ¯æ¬¡ä½¿ç”¨å †ä¸­ $d$ï¼ˆå·²çŸ¥æœ€çŸ­è·¯ï¼‰æœ€å°çš„ç‚¹æ¥æ›´æ–°å…¶å®ƒç‚¹</p><p>è®¾ $dist(u, v)$ è¡¨ç¤º $u, v$ çš„æœ€çŸ­è·ç¦»ï¼ˆæ­¤æ—¶å³æ ‘ä¸Šè·ç¦»ï¼‰å»ºç«‹ç‚¹åˆ†æ ‘ï¼Œå‡è®¾ç°åœ¨æœ€çŸ­è·¯è·‘åˆ°ä» $u$ å¼€å§‹æ›´æ–°å…¶å®ƒèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæšä¸¾ $u$ åœ¨ç‚¹åˆ†æ ‘ä¸Šçš„æ¯ä¸ªç¥–å…ˆï¼Œé‚£ä¹ˆå…¶æ¯ä¸ªç¥–å…ˆ $fa$ åŒ…å«çš„èŠ‚ç‚¹ä¸­ï¼Œæ»¡è¶³ $dist (u, fa) + dist (fa, v) \le f_u$ çš„æ‰€æœ‰èŠ‚ç‚¹ $v$ æ˜¯ $u$ åº”å½“å»æ›´æ–°çš„ï¼Œä¸éš¾å‘ç°ï¼Œè¿™æ ·çš„ $v$ ä¸€å®šæ˜¯æŒ‰å®ƒåˆ° $fa$ çš„è·ç¦»è¢«é¡ºåºæ›´æ–°çš„ï¼Œæ‰€ä»¥å¯ä»¥è®°å½•æ¯ä¸ªç‚¹ $p$ åœ¨ç‚¹åˆ†æ ‘ä¸ŠæŒ‰åˆ° $p$ è·ç¦»é€’å¢æ’åˆ—çš„å­èŠ‚ç‚¹ï¼Œå¹¶è®°å½•ä¸€ä¸ªæŒ‡é’ˆï¼Œå³å·²ç»æ›´æ–°åˆ°å“ªä¸ªå­èŠ‚ç‚¹ï¼Œä»¥ååœ¨ç‚¹åˆ†æ ‘ä¸Šæšä¸¾åˆ° $p$ åªéœ€ä»æŒ‡é’ˆè®°å½•ä½ç½®å¼€å§‹æšä¸¾å³å¯ï¼Œè¿™æ ·å­æ¯ä¸ªèŠ‚ç‚¹è¢«è®¿é—®åˆ° $log n$ æ¬¡ï¼Œæ•…æ€»æ—¶é—´å¤æ‚åº¦ $O (n \log n)$</p><p>å¯¹äº $m \ge n$ çš„æƒ…å†µï¼Œç”¨ä¸ä¸Šé¢ç±»ä¼¼çš„ç®—æ³•ï¼Œç”±äºå®ƒæœ€å¤šå¤šå‡º $50$ æ¡è¾¹ï¼Œä¸å¦¨å°±ä»¥ $m = n + 50$ æ¥è®º</p><p>åœ¨å›¾ä¸­éšæ„æŠ½å‡ºä¸€æ£µç”Ÿæˆæ ‘ï¼Œé‚£ä¹ˆé‚£äº›ä¸åœ¨ç”Ÿæˆæ ‘ä¸­çš„è¾¹ $(u, v)$ æˆ‘ä»¬å°† $u$ è®°ä½œå†—ä½™èŠ‚ç‚¹ï¼Œå³è¿™æ ·çš„è¾¹ä¸ºå†—ä½™è¾¹ï¼Œå¾ˆæ˜¾ç„¶è¿™æ ·çš„èŠ‚ç‚¹æœ€å¤š $50$ ä¸ª</p><p>é‚£ä¹ˆä»ç‚¹ $u$ åˆ°ç‚¹ $v$ çš„æœ€çŸ­è·ç¦»å°±æœ‰ä¸¤ç§æƒ…å†µ</p><ul><li>å…¨éƒ¨èµ°æ ‘ä¸Šè·¯å¾„</li><li>äº¤æ›¿èµ°æ ‘ä¸Šè·¯å¾„ä¸å†—ä½™è·¯å¾„ï¼Œé‚£ä¹ˆå®ƒä¸€å®šè‡³å°‘ç»è¿‡ä¸€ä¸ªå†—ä½™èŠ‚ç‚¹ $x$ï¼Œæ»¡è¶³ $dist (u, x) + dist (x, v) \le f_u$</li></ul><p>å¯¹ç¬¬ä¸€ç§æƒ…å†µï¼Œåœ¨ç”Ÿæˆæ ‘ä¸­è¿è¡Œä¸Šé¢æ‰€è¿° $m = n - 1$ åŒæ ·çš„ç®—æ³•å³å¯ï¼Œé—®é¢˜åœ¨äºç¬¬äºŒç§æƒ…å†µ</p><p>å®é™…ä¸Šä¸¤ç§æƒ…å†µæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå¯¹æ¯ä¸ªå†—ä½™èŠ‚ç‚¹ $p$ï¼Œå°†æ‰€æœ‰ $n$ ä¸ªèŠ‚ç‚¹æŒ‰åˆ° $p$ çš„è·ç¦»é€’å¢æ’åºå­˜åœ¨æ•°ç»„ä¸­ï¼Œé‚£ä¹ˆæœ€çŸ­è·¯è¿è¡Œåˆ° $u$ æ—¶åŒæ ·ä¹Ÿåªè¦ç”¨æŒ‡é’ˆåœ¨æ•°ç»„é‡Œèµ°å°±å¥½äº†ï¼Œæ­¥éª¤å’Œ $m = n - 1$ çš„æƒ…å†µä¹Ÿæ˜¯ä¸€æ ·çš„</p><p>è¿™æ ·æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šè¢«è®¿é—® $50 + \log n$ æ¬¡ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ $O \left(n (50 + \log n)\right)$</p><h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">50</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="keyword">const</span> LL LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span>  <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, E = <span class="number">0</span>, Tm;</span><br><span class="line"><span class="keyword">int</span> b[MAXN];</span><br><span class="line"><span class="keyword">int</span> f[MAXN], c[MAXN], w[MAXN];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; pt[MAXN], ex[<span class="number">60</span>];</span><br><span class="line"><span class="keyword">int</span> poi[MAXN]= &#123;<span class="number">0</span>&#125;, pex[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> ances[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ances[x] == x ? x : ances[x] = find (ances[x]); &#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; edge[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ances[i] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = edge[i].first, y = edge[i].second;</span><br><span class="line"><span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line"><span class="keyword">if</span> (fx == fy) &#123; b[++ E] = x; <span class="keyword">continue</span>; &#125;</span><br><span class="line">ances[fx] = fy; Insert (x, y), Insert (y, x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> subsize[MAXN], g, mini;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">acsize</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>; <span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">acsize (v, root, n);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line">maxpart = max (maxpart, subsize[v]);</span><br><span class="line">&#125;</span><br><span class="line">maxpart = max (maxpart, n - subsize[root]);</span><br><span class="line"><span class="keyword">if</span> (maxpart &lt; mini) g = root, mini = maxpart;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lev[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> depth[<span class="number">25</span>][MAXN], d[MAXN], m = <span class="number">0</span>, mdep = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father, <span class="keyword">int</span> l)</span> </span>&#123;</span><br><span class="line">d[++ m] = root; mdep = max (mdep, depth[l][root]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">depth[l][v] = depth[l][root] + <span class="number">1</span>;</span><br><span class="line">DFS (v, root, l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> buck[MAXN]= &#123;<span class="number">0</span>&#125;, topo[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> n, <span class="keyword">int</span> l, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">mini = INF, acsize (u, <span class="number">0</span>, n);</span><br><span class="line">father[g] = fa; visit[g] = <span class="literal">true</span>;</span><br><span class="line">mdep = m = <span class="number">0</span>, lev[g] = l, depth[l][g] = <span class="number">0</span>; DFS (g, <span class="number">0</span>, l);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= mdep; i ++) buck[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) buck[depth[l][d[i]]] ++, topo[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= mdep; i ++) buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) topo[buck[depth[l][d[i]]] --] = d[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) pt[g].push_back(topo[i]);</span><br><span class="line">acsize (g, <span class="number">0</span>, n); <span class="keyword">int</span> fg = g;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[fg]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">divide (v, subsize[v], l + <span class="number">1</span>, fg);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="keyword">int</span> deep[<span class="number">51</span>][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linkit</span> <span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) que.pop();</span><br><span class="line"><span class="built_in">memset</span> (vis, <span class="literal">false</span>, <span class="keyword">sizeof</span> (vis));</span><br><span class="line">que.push(S), deep[id][S] = <span class="number">0</span>, vis[S] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) G[u].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = G[u][i];</span><br><span class="line"><span class="keyword">if</span> (vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">deep[id][v] = deep[id][u] + <span class="number">1</span>;</span><br><span class="line">que.push(v); vis[v] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++) buck[i] = topo[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) buck[deep[id][i]] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) topo[buck[deep[id][i]] --] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ex[id].push_back(topo[i]);</span><br><span class="line">&#125;</span><br><span class="line">LL value[MAXN], ans[MAXN]= &#123;<span class="number">0</span>&#125;, dist[MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> id; LL d;</span><br><span class="line">node (<span class="keyword">int</span> id = <span class="number">0</span>, LL d = <span class="number">0</span>) : id (id), d (d) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123; <span class="keyword">return</span> d &gt; p.d; &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">priority_queue&lt;node&gt; heap;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trans</span> <span class="params">(<span class="keyword">int</span> u, LL d)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> p = u; p; p = father[p]) &#123;</span><br><span class="line"><span class="keyword">int</span> l = lev[p];</span><br><span class="line"><span class="keyword">for</span> ( ; poi[p] &lt; (<span class="keyword">int</span>) pt[p].size(); poi[p] ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = pt[p][poi[p]];</span><br><span class="line"><span class="keyword">if</span> (depth[l][u] + depth[l][v] &gt; f[u]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (dist[v] &lt; LINF) <span class="keyword">continue</span>;</span><br><span class="line">dist[v] = dist[u] + value[v];</span><br><span class="line">heap.push(node (v, dist[v]));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= E; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> ( ; pex[i] &lt; (<span class="keyword">int</span>) ex[i].size(); pex[i] ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = ex[i][pex[i]];</span><br><span class="line"><span class="keyword">if</span> (deep[i][u] + deep[i][v] &gt; f[u]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (dist[v] &lt; LINF) <span class="keyword">continue</span>;</span><br><span class="line">dist[v] = dist[u] + value[v];</span><br><span class="line">heap.push(node (v, dist[v]));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> T)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) value[i] = <span class="number">1l</span>l * c[i] * T + w[i];</span><br><span class="line"><span class="built_in">memset</span> (poi, <span class="number">0</span>, <span class="keyword">sizeof</span> (poi)); <span class="built_in">memset</span> (pex, <span class="number">0</span>, <span class="keyword">sizeof</span> (pex));</span><br><span class="line"><span class="keyword">while</span> (! heap.empty()) heap.pop();</span><br><span class="line"><span class="built_in">memset</span> (dist, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (dist));</span><br><span class="line">dist[<span class="number">1</span>] = value[<span class="number">1</span>], heap.push(node (<span class="number">1</span>, dist[<span class="number">1</span>]));</span><br><span class="line"><span class="keyword">while</span> (! heap.empty()) &#123;</span><br><span class="line">node top = heap.top(); heap.pop();</span><br><span class="line"><span class="keyword">int</span> u = top.id; LL d = top.d;</span><br><span class="line">trans (u, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ans[i] = min (ans[i], dist[i] - value[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), Tm = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) f[i] = getnum (), c[i] = getnum (), w[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">G[u].push_back(v), G[v].push_back(u);</span><br><span class="line">edge[i] = make_pair (u, v);</span><br><span class="line">&#125;</span><br><span class="line">build ();</span><br><span class="line">sort (b + <span class="number">1</span>, b + E + <span class="number">1</span>);</span><br><span class="line">E = unique (b + <span class="number">1</span>, b + E + <span class="number">1</span>) - b - <span class="number">1</span>;</span><br><span class="line">divide (<span class="number">1</span>, N, <span class="number">1</span>, <span class="number">0</span>); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= E; i ++) linkit (b[i], i);</span><br><span class="line"><span class="built_in">memset</span> (ans, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (ans));</span><br><span class="line">solve (<span class="number">1</span>), solve (Tm);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) write (ans[i]), <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èƒŒåŒ…DP </tag>
            
            <tag> æœ€çŸ­è·¯ </tag>
            
            <tag> çŠ¶å‹DP </tag>
            
            <tag> ç‚¹åˆ†æ²» </tag>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> æ¦‚ç‡DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåä¹ï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B9%9D%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B9%9D%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>å†æ¬¡å«åº•$\text{.jpg}$</p><p>$\text{scoreï¼š20 + 0 + 10 = 30   rkï¼š27/29}$</p><h2 id="Problem-Aï¼šsign"><a href="#Problem-Aï¼šsign" class="headerlink" title="Problem Aï¼šsign"></a>Problem Aï¼šsign</h2><h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/18/v9ViJtBL6OAnzYG.png" alt=""></p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿™é¢˜è´¼æ°´ï¼Œä½†æˆ‘æ²¡æƒ³å‡ºæ¥ã€‚ã€‚</p><p>æˆ‘å¤§æ¦‚ä»¥ä¸ºè¿™ä¸æ˜¯æ•°å­¦æ‰€ä»¥æ²¡æƒ³åˆ°ä»£å…¥ï¼Œæˆ–è€…æ˜¯æˆ‘å¿˜è®°è¯¥ç‚¹å€¼è¡¨ç¤ºå¯ä»¥ $O (\log A)$</p><p>åæ­£å…¨æ‘å°±æˆ‘æ²¡åˆ°åŠæ ¼çº¿</p><p>é¢˜è§£æ‡’å¾—å†™äº†ï¼Œå°±æ¬å‡ºé¢˜äººç»™çš„å§</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/18/Pu2fmObx8V4RDnZ.png" alt=""></p><p>äº‹å®ä¸Šï¼Œè¿™ä¸ªåšæ³•ä¸èƒ½é€šè¿‡ã€‚</p><p>è€ƒè™‘ä¸Šé¢åšæ³•å¤æ‚åº¦ç“¶é¢ˆæ˜¯å¿«é€Ÿå¹‚ã€‚ä¸€ä¸ªç®€å•çš„$\text{trick}$æ˜¯å¯¹äºä¸€ä¸ªå›ºå®šçš„ $son_u = k$ï¼Œä»¤ $M = \lceil \sqrt{A} \rceil$ï¼Œé¢„å¤„ç†å‡º $k^0, k^1, k^2, â€¦, k^{M - 1}$ ä»¥åŠ $(k^M)^0, (k^M)^1, â€¦, (k^M)^{M - 1}$ã€‚è¿™æ ·å•æ¬¡æ±‚æŸä¸ªç‚¹å€¼å°±å¯ä»¥ç”¨ $O (1)$ æ¬¡ç®—æœ¯è¿ç®—æ±‚å¾—ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ä¸º $O ((n + \sqrt{A})\sqrt{n})$ã€‚</p><p>ä»¥ä¸Šæ˜¯å‡ºé¢˜äººæä¾›é¢˜è§£</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e04</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;, son[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> b[MAXN]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line">LL ans[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL inv;</span><br><span class="line">LL f1[MAXN]= &#123;<span class="number">0</span>&#125;, f2[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> base = p / M, rest = p - base * M;</span><br><span class="line"><span class="keyword">return</span> f2[base] * f1[rest] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">work</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">LL r;</span><br><span class="line"><span class="keyword">if</span> (t == <span class="number">1</span>) r = a[root] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> r = (<span class="number">1</span> - calc (a[root] + <span class="number">1</span>) + MOD) % MOD * inv % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">r = r * work (v, t) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (t == son[root]) ans[root] = r;</span><br><span class="line"><span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> fa = getnum ();</span><br><span class="line">Insert (fa, i); son[fa] ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) b[++ m] = son[i];</span><br><span class="line">sort (b + <span class="number">1</span>, b + m + <span class="number">1</span>);</span><br><span class="line">m = unique (b + <span class="number">1</span>, b + m + <span class="number">1</span>) - b - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) &#123;</span><br><span class="line">inv = power (<span class="number">1</span> - b[i] + MOD, MOD - <span class="number">2</span>);</span><br><span class="line">f1[<span class="number">0</span>] = <span class="number">1</span>, f2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) f1[j] = f1[j - <span class="number">1</span>] * b[i] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) f2[j] = f2[j - <span class="number">1</span>] * f1[M] % MOD;</span><br><span class="line">work (<span class="number">1</span>, b[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šmatch"><a href="#Problem-Bï¼šmatch" class="headerlink" title="Problem Bï¼šmatch"></a>Problem Bï¼šmatch</h2><h2 id="Problem-Cï¼štree"><a href="#Problem-Cï¼štree" class="headerlink" title="Problem Cï¼štree"></a>Problem Cï¼štree</h2><h3 id="é¢˜é¢-1"><a href="#é¢˜é¢-1" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/18/rxE7RpM2lkOtGWi.png" alt=""></p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿™é¢˜æœ€åŸºæœ¬çš„æ€è·¯æˆ‘ä¸€å¼€å§‹æƒ³äº†ä¸€ä¸‹ï¼Œç„¶åé©¬ä¸Šæ‰”äº†ã€‚ã€‚</p><p>é¦–å…ˆè€ƒè™‘æ¯ä¸ªç‚¹å®ƒèƒ½å¤Ÿä½œä¸ºè¢« $LCA$ çš„æƒ…å†µ</p><p>è€ƒè™‘é‡é“¾å‰–åˆ†ï¼Œå¯å‘å¼åˆå¹¶ï¼Œè®¾ç‚¹ $u$ é‡å­æ ‘ $A$ï¼Œå¦ä¸€å­æ ‘ $B$ï¼Œåˆ™å¯¹ $i \in B, j \in A$ï¼Œæ»¡è¶³ $LCA (i, j) = u$ï¼Œæ­¤æ—¶é€‰æ‹© $i, j$ï¼Œ$u$ å¯ä»¥è´¡çŒ®ç»™åŒºé—´ $[l, r]$ æ»¡è¶³ $l \in [1, i], r \in [j, n]$ï¼ˆå‡å®š $i &lt; j)$ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæé™æƒ…å†µå³æ˜¯å– $i$ åœ¨ $A$ ä¸­çš„å‰é©± $pre$ ä¸åç»§ $nxt$ï¼Œåˆ™æœ€å¤§ $u$ å¯è´¡çŒ®åŒºé—´å³ä¸º $[1, pre] \cup [i, n]$ ä¸ $[1, i] \cup [nxt, n]$</p><p>æ­¤æ—¶ä¸å¦¨æŠŠåŒºé—´ $l, r$ è§†ä¸ºäºŒç»´å¹³é¢ä¸Šçš„ç‚¹ $(l, r)$ï¼Œé‚£ä¹ˆä¸Šé¢æ‰€è¯´çš„ $i$ å¯¼è‡´çš„ $u$ çš„æœ€å¤§å¯è´¡çŒ®åŒºé—´åœ¨å¹³é¢ä¸Šåˆ™æŠ•å½±ä¸ºçŸ©å½¢ $(1, i), (1, n), (pre, i), (pre, n)$ ä¸çŸ©å½¢ $(1, nxt), (1, n), (i, nxt), (i, n)$ï¼ˆå–çŸ©å½¢çš„å››ä¸ªè§’ï¼‰</p><p>è€ƒè™‘æŠŠæ‰€æœ‰  $depth$ ä¸€è‡´çš„ç‚¹æ‰€è´¡çŒ®çš„çŸ©å½¢æ¶‚ä¸Šç›¸åŒçš„é¢œè‰²ï¼Œæ±‚æ¯ç§é¢œè‰²çš„çŸ©å½¢å„è‡ªçš„å¹¶ï¼Œé‚£ä¹ˆæœ€ç»ˆè¯¢é—®ç‚¹ $(l, r)$ è¢«å¤šå°‘ç§é¢œè‰²çš„é¢ç§¯æ‰€è¦†ç›–åˆ™æ˜¯ç­”æ¡ˆ</p><p>æ±‚çŸ©å½¢çš„å¹¶ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºè¿™äº›çŸ©å½¢éƒ½æ˜¯ä¸¥æ ¼è´´ç€å¹³é¢å·¦ä¸Šè§’ï¼ˆå³ $(1, n)$ï¼‰çš„</p><p>ç„¶åæ‰«æçº¿ä¸€æ³¢å°±åšå®Œäº†</p><p>ä¸è¿‡ä¸è¦å¿˜äº†é¢˜é¢æ‰€è¯´çš„ $i, j$ å¯ä»¥ç›¸åŒï¼Œæ‰€ä»¥å¯¹æ¯ä¸ª $i, i \in [1, n]$ï¼Œè¿˜å¾—åŠ ä¸Š $(1, i), (1, n), (i, i), (i, n)$ çš„çŸ©å½¢</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125; ;</span><br><span class="line">LFS Link[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> son[MAXN]= &#123;<span class="number">0</span>&#125;, subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> d[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL dist[MAXN]= &#123;<span class="number">0</span>&#125;, mpp[MAXN]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line">mpp[++ m] = dist[root];</span><br><span class="line">son[root] = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">dist[v] = dist[root] + w;</span><br><span class="line">DFS (v, root);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line"><span class="keyword">if</span> (son[root] == - <span class="number">1</span> || subsize[v] &gt; subsize[son[root]])</span><br><span class="line">son[root] = v;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; mat[MAXN]; <span class="comment">// &lt;çºµåæ ‡, æ¨ªåæ ‡&gt;</span></span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; st[MAXN];</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; :: iterator it, it2;</span><br><span class="line"><span class="keyword">int</span> ext[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (it = st[y].begin(); it != st[y].end(); it ++) &#123;</span><br><span class="line"><span class="keyword">int</span> i = * it;</span><br><span class="line">it2 = st[x].lower_bound(i);</span><br><span class="line"><span class="keyword">int</span> pre = i, nxt = i;</span><br><span class="line"><span class="keyword">if</span> (it2 != st[x].begin()) &#123; it2 --; pre = * it2; &#125;</span><br><span class="line">it2 = st[x].upper_bound(i);</span><br><span class="line"><span class="keyword">if</span> (it2 != st[x].end()) nxt = * it2;</span><br><span class="line"><span class="keyword">if</span> (nxt != i) mat[id].push_back(make_pair (nxt, i));</span><br><span class="line"><span class="keyword">if</span> (pre != i) mat[id].push_back(make_pair (i, pre));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (it = st[y].begin(); it != st[y].end(); it ++) st[x].insert(* it);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (son[root] == - <span class="number">1</span>) &#123;</span><br><span class="line">st[root].insert(root); ext[root] = root;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">make (son[root], root);</span><br><span class="line">ext[root] = ext[son[root]];</span><br><span class="line">st[ext[root]].insert(root);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father || v == son[root]) <span class="keyword">continue</span>;</span><br><span class="line">make (v, root);</span><br><span class="line">merge (ext[root], ext[v], d[root]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> x, y, type, id;</span><br><span class="line"><span class="comment">// type: - 1, + 1, 2(dot)</span></span><br><span class="line">node (<span class="keyword">int</span> x = <span class="number">0</span>, <span class="keyword">int</span> y = <span class="number">0</span>, <span class="keyword">int</span> type = <span class="number">0</span>, <span class="keyword">int</span> id = <span class="number">0</span>) : x (x), y (y), type (type), id (id) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (x == p.x) <span class="keyword">return</span> type &lt; p.type;</span><br><span class="line"><span class="keyword">return</span> x &lt; p.x;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">node a[MAXM &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mesh</span> <span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">sort (mat[id].begin(), mat[id].end());</span><br><span class="line"><span class="keyword">int</span> lx = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) mat[id].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> y = mat[id][i].first, x = mat[id][i].second;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= lx) &#123;</span><br><span class="line">a[++ n] = node (lx, y, <span class="number">1</span>, id);</span><br><span class="line">a[++ n] = node (x + <span class="number">1</span>, y, - <span class="number">1</span>, id);</span><br><span class="line">lx = x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> answer[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (- x); &#125;</span><br><span class="line"><span class="keyword">int</span> subsum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (x &lt;= N) &#123;</span><br><span class="line">subsum[x] += delta;</span><br><span class="line">x += lowbit (x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (x &gt; <span class="number">0</span>) &#123;</span><br><span class="line">ret += subsum[x];</span><br><span class="line">x -= lowbit (x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">sort (a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> y = a[i].y, type = a[i].type, id = a[i].id;</span><br><span class="line"><span class="keyword">if</span> (type == <span class="number">2</span>) answer[id] = query (y);</span><br><span class="line"><span class="keyword">else</span> add (y, type);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">&#125;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">sort (mpp + <span class="number">1</span>, mpp + m + <span class="number">1</span>);</span><br><span class="line">m = unique (mpp + <span class="number">1</span>, mpp + m + <span class="number">1</span>) - mpp - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) d[i] = lower_bound (mpp + <span class="number">1</span>, mpp + m + <span class="number">1</span>, dist[i]) - mpp;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) mat[d[i]].push_back(make_pair (i, i));</span><br><span class="line">make (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) mesh (i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= M; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">a[++ n] = node (l, r, <span class="number">2</span>, q);</span><br><span class="line">&#125;</span><br><span class="line">solve ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, answer[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> å¯å‘å¼åˆå¹¶ </tag>
            
            <tag> æ‰«æçº¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåä¸ƒï¼‰</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%83%EF%BC%89/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%83%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ä»Šæ—¥åˆæ˜¯ä¸‰é“é›†è®­é˜Ÿä½œä¸šåŸé¢˜ã€‚ã€‚åˆæ²¡éƒ¨åˆ†åˆ†ã€‚ã€‚</p><p>åæ­£æˆ‘éƒ½ä¸ä¼šå¿…å®šçˆ†é›¶å°±æ²¡äº¤äº†ã€‚ã€‚</p><p>$\text{scoreï¼šNULL   rkï¼šNULL}$</p><h2 id="Problem-Aï¼šBirthday"><a href="#Problem-Aï¼šBirthday" class="headerlink" title="Problem Aï¼šBirthday"></a>Problem Aï¼šBirthday</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ç»™å®š $n$ ä¸ªä»…åŒ…å« <code>a,b</code> çš„å­—ç¬¦ä¸²ã€‚</p><p>ä½ éœ€è¦å»æ‰å°½å¯èƒ½å°‘çš„å­—ç¬¦ä¸²ï¼Œä½¿å¾—å‰©ä¸‹çš„å­—ç¬¦ä¸²ä¸­ä¸å­˜åœ¨æŸä¸€ä¸ªä¸²æ˜¯å¦ä¸€ä¸ªä¸²çš„å­ä¸²ã€‚</p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n \le 750, ~ \sum\limits_{i = 1}^n |s_i \le 10^7$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>åŸé¢˜ <a href="https://codeforces.com/problemset/problem/590/E?f0a28=2" target="_blank" rel="noopener">CF590E</a></p><p>ç”±äº $n$ å¾ˆå°ï¼Œå¾ˆæ˜¾ç„¶å¯ä»¥å¯¹æ¯ä¸€å¯¹å­—ç¬¦ä¸²åˆ¤æ–­ä¸€ä¸ªæ˜¯ä¸æ˜¯å¦ä¸€ä¸ªçš„å­ä¸²ï¼Œå¦‚æœæ˜¯å°±è¿ä¸ªå•å‘è¾¹ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ª $DAG$ ç„¶ååœ¨ä¸Šé¢æ</p><p>é‚£ä¹ˆå¯¹äºå»ºå›¾ï¼Œå…ˆå»ºä¸ª$\text{AC}$è‡ªåŠ¨æœºï¼Œåœ¨ $trie$ çš„ç»“å°¾å­˜ä¸€ä¸‹ç¼–å·ï¼Œç„¶åæŠŠæ¯ä¸ªä¸²æ‰”ä¸Šå»åŒ¹é…ï¼Œæ¯æ¬¡åŒ¹é…ä¸èµ°åˆ°èŠ‚ç‚¹ $fail$ æ ‘ä¸Šçš„æ‰€æœ‰ç¼–å·ï¼ˆå³å®ƒçš„å­ä¸²ï¼‰è¿è¾¹</p><p>å½“ç„¶ç›´æ¥è¿è¾¹è‚¯å®šä¼š $T$ï¼Œå®é™…ä¸Šä½ åªè¦å¾€åœ¨ $fail$ æ ‘å¾€ä¸Šæ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªç¼–å·ä»¥åŠæœ¬èº«èŠ‚ç‚¹çš„ç¼–å·ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰è¿è¾¹ï¼Œç„¶åä¼ é€’é—­åŒ…å°±å¥½äº†ï¼Œè¿™æ ·å¤æ‚åº¦å°±æ­£ç¡®äº†</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„ä»»åŠ¡å°±æ˜¯åœ¨ $DAG$ ä¸Šæ±‚å‡ºæœ€é•¿åé“¾å¹¶æ„é€ æ–¹æ¡ˆ</p><p>é‚£è¿™å°±æ˜¯ <a href="https://colythme.github.io/2020/07/15/[CTSC2008]ç¥­ç¥€ï¼ˆDAGæœ€é•¿åé“¾åŠå…¶æ–¹æ¡ˆæ„é€ ï¼‰/">[CTSC2008]ç¥­ç¥€</a></p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">750</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e07</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">2</span> * MAXN + MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFDS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125;;</span><br><span class="line">LFDS iLink[MAXN * MAXN];</span><br><span class="line"><span class="keyword">int</span> iHead[MAXM]= &#123;<span class="number">0</span>&#125;, isize = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">iLink[++ isize].to = v;</span><br><span class="line">iLink[isize].next = iHead[u];</span><br><span class="line"></span><br><span class="line">iHead[u] = isize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">char</span> str[MAXM];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sve[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tr[MAXM][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span> <span class="params">(<span class="keyword">int</span> ind)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>, n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = str[i] - <span class="string">'a'</span>;</span><br><span class="line">sve[ind].push_back(c);</span><br><span class="line"><span class="keyword">if</span> (! tr[p][c]) tr[p][c] = ++ m;</span><br><span class="line">p = tr[p][c];</span><br><span class="line">&#125;</span><br><span class="line">Insert (p, ind);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> fail[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="keyword">int</span> lastp[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">bitset</span>&lt;MAXN&gt; g[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i ++)</span><br><span class="line"><span class="keyword">if</span> (tr[<span class="number">0</span>][i])</span><br><span class="line">que.push(tr[<span class="number">0</span>][i]);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line">lastp[u] = iHead[fail[u]] ? fail[u] : lastp[fail[u]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (tr[u][i]) &#123;</span><br><span class="line">fail[tr[u][i]] = tr[fail[u]][i];</span><br><span class="line">que.push(tr[u][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> tr[u][i] = tr[fail[u]][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">(<span class="keyword">int</span> ind)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) sve[ind].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = sve[ind][i];</span><br><span class="line">p = tr[p][c];</span><br><span class="line"><span class="keyword">int</span> tp = p;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">2</span>; j ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = iHead[tp]; k; k = iLink[k].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = iLink[k].to;</span><br><span class="line"><span class="keyword">if</span> (v == ind) <span class="keyword">continue</span>;</span><br><span class="line">g[v][ind] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">tp = lastp[tp];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, cap, next; &#125; ;</span><br><span class="line">LFS Link[MAXL &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;, size = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].cap = cap;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Insert (x, y, cap); Insert (y, x, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> S, T, _N;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) que.pop();</span><br><span class="line"><span class="built_in">memset</span> (depth, <span class="number">0</span>, <span class="keyword">sizeof</span> (depth));</span><br><span class="line">depth[S] = <span class="number">1</span>, que.push(S);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] || ! cap) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[u] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (v == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cur[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> flow)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (p == T) <span class="keyword">return</span> flow;</span><br><span class="line"><span class="keyword">int</span> rest = flow;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> &amp;i = cur[p]; i &amp;&amp; rest; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] != depth[p] + <span class="number">1</span> || ! cap) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> k = Dinic (v, min (cap, rest));</span><br><span class="line"><span class="keyword">if</span> (! k) depth[v] = - <span class="number">1</span>;</span><br><span class="line">Link[i].cap -= k, Link[i ^ <span class="number">1</span>].cap += k;</span><br><span class="line">rest -= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow - rest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">MAXFLOW</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (BFS ()) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= _N; i ++) cur[i] = Head[i];</span><br><span class="line">ret += Dinic (S, INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> match[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> tagl[MAXN]= &#123;<span class="literal">false</span>&#125;, tagr[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">tagr[u - N] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][u - N] &amp;&amp; ! tagl[i]) &#123;</span><br><span class="line">tagl[i] = <span class="literal">true</span>;</span><br><span class="line">DFS (match[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>);</span><br><span class="line">insert (i);</span><br><span class="line">&#125;</span><br><span class="line">build ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) work (i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][k])</span><br><span class="line">g[i] |= g[k];</span><br><span class="line">S = <span class="number">2</span> * N + <span class="number">1</span>, _N = T = <span class="number">2</span> * N + <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">add (S, i, <span class="number">1</span>), add (i + N, T, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][j])</span><br><span class="line">add (i, j + N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> ans = N - MAXFLOW ();</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! Link[<span class="number">4</span> * i - <span class="number">2</span>].cap)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = Head[i]; j; j = Link[j].next)</span><br><span class="line"><span class="keyword">if</span> (! Link[j].cap) &#123;</span><br><span class="line">match[i] = Link[j].to;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (Link[<span class="number">4</span> * i].cap)</span><br><span class="line">DFS (i + N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! tagl[i] &amp;&amp; tagr[i])</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d "</span>, i);</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šA-Sequence-of-Permutations"><a href="#Problem-Bï¼šA-Sequence-of-Permutations" class="headerlink" title="Problem Bï¼šA Sequence of Permutations"></a>Problem Bï¼šA Sequence of Permutations</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ç»™å®šä¸¤ä¸ªé•¿ä¸º $n$ çš„æ’åˆ— $p, q$ï¼Œè®¾ $f(p, q)$ ä¸ºä½¿ç¬¬ $p_i$ ä¸ªæ•°ä¸º $q_i$ çš„æ’åˆ—</p><p>å·²çŸ¥ $a_1 = p, a_2 = q, a_{n + 2} = f(a_n, a_{n + 1})$ï¼Œæ±‚ $a_k$</p><h3 id="æ•°æ®èŒƒå›´-1"><a href="#æ•°æ®èŒƒå›´-1" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$n \le 10^5, ~ k \le 10^9$</p><h3 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h3><p>å®šä¹‰ä¸¤ä¸ªæ’åˆ— $p, q$ çš„ä¹˜æ³•ä¸ºï¼Œè®¾ $r = pq$ï¼Œåˆ™æœ‰<br>$$<br>r_i = p_{q_i}<br>$$<br>è¯¥ä¹˜æ³•æ»¡è¶³ç»“åˆå¾‹ï¼Œä½†ä¸æ»¡è¶³äº¤æ¢å¾‹</p><p>è¯¥ä¹˜æ³•çš„å•ä½å…ƒä¸º $e$ æ»¡è¶³ $e_i = i$ï¼Œé‚£ä¹ˆæ’åˆ— $p$ çš„é€†å…ƒ $p^{- 1}$ å³å¯å®šä¹‰ä¸º $p^{- 1}$ æ»¡è¶³ $p^{- 1}_{p_i} = i$</p><p>å¯¹é€†å…ƒï¼Œæœ‰ $(pq)^{- 1} = q^{- 1}p^{- 1}$ï¼ŒåŒç†å¯¹å¤šä¸ªæ’åˆ—ç›¸ä¹˜çš„é€†å…ƒï¼Œå°†å®ƒä»¬åè¿‡æ¥å†åˆ†åˆ«æ±‚é€†ï¼Œæœ€åæŒ‰é¡ºåºç›¸ä¹˜å³å¯</p><p>ä¸‹é¢ç»™å‡ºè¯¥é€†å…ƒå…¬å¼çš„ç®€å•è¯æ˜ï¼š</p><ul><li>è®¾ $A = (pq)^{- 1}$ï¼Œåˆ™æœ‰ $A_{p_{q_i}} = i$</li><li>è®¾ $B = q^{-  1}p^{- 1}$ï¼Œåˆ™æœ‰ $B_i = q^{- 1}<em>{p^{- 1}_i}$ï¼Œä»¤ $i = p_i$ï¼Œæœ‰ $B</em>{p_i} = q^{- 1}<em>i$ï¼Œå†ä»¤ $i = q_i$ï¼Œæœ€åæœ‰ $B</em>{p_{q_i}} = i$</li><li>å³ $A_{p_{q_i}} = B_{p_{q_i}}$ï¼Œæ•…ç­‰å¼æˆç«‹</li></ul><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>$$<br>\begin{aligned}<br>&amp;f(p, q)_{p_i} = q_i \\<br>\Rightarrow &amp;f(p, q) * p = q \\<br>\Rightarrow &amp;f(p, q) = qp^{- 1}<br>\end{aligned}<br>$$</p><p>ç„¶åæ‰“è¡¨æ‰¾è§„å¾‹<br>$$<br>\begin{aligned}<br>a_1 &amp;= p \\<br>a_2 &amp;= q \\<br>a_3 &amp;= qp^{- 1} \\<br>a_4 &amp;= qp^{- 1}q^{- 1} \\<br>a_5 &amp;= qp^{- 1}q^{- 1}pq^{- 1} \\<br>a_6 &amp;= qp^{- 1}q^{- 1}p^2q^{- 1} \\<br>a_7 &amp;= qp^{- 1}q^{- 1}pqpq^{- 1} \\<br>a_8 &amp;= qp^{- 1}q^{- 1}pqp^{- 1}qpq^{- 1} \\<br>\cdots<br>\end{aligned}<br>$$<br>ä»¤ $t = qp^{- 1}q^{- 1}p$ï¼Œåˆ™ $a_7 = tpt^{- 1}, a_8 = tqt^{- 1}$ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ° $a_{6k + 1} = t^kpt^{- k}, a_{6k + 2} = t^kqt^{- k}$ï¼Œå¯¹ $t$ åšä¸ªå¿«é€Ÿå¹‚ï¼Œç„¶åå‰©ä¸‹çš„å‡ é¡¹æš´åŠ›ä¸€ä¸‹å°±å¥½äº†</p><p>æ—¶é—´å¤æ‚åº¦ $O (n \log \frac{k}{6})$</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="keyword">int</span> P[MAXN], Q[MAXN];</span><br><span class="line"><span class="keyword">int</span> IP[MAXN], IQ[MAXN];</span><br><span class="line"><span class="keyword">int</span> T[MAXN], IT[MAXN];</span><br><span class="line"><span class="keyword">int</span> Tk[MAXN], ITk[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span> <span class="params">(<span class="keyword">int</span>* ret, <span class="keyword">int</span>* p, <span class="keyword">int</span>* q)</span> </span>&#123; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret[i] = p[q[i]]; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inv</span> <span class="params">(<span class="keyword">int</span>* I, <span class="keyword">int</span>* p)</span> </span>&#123; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) I[p[i]] = i; &#125;</span><br><span class="line"><span class="keyword">int</span> A[MAXN], ret[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">power</span> <span class="params">(<span class="keyword">int</span>* x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret[i] = i;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) &#123; mul (A, ret, x); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ret[i] = A[i]; &#125;</span><br><span class="line">mul (A, x, x); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) x[i] = A[i];</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) x[i] = ret[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span> <span class="params">(<span class="keyword">int</span>* a)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">1</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, a[i]);</span><br><span class="line">&#125; <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">7</span>][MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">0</span>) n = <span class="number">6</span>;</span><br><span class="line">mul (a[<span class="number">1</span>], P, ITk), mul (A, Tk, a[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[<span class="number">1</span>][i] = A[i];</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">1</span>) &#123; print (a[<span class="number">1</span>]); <span class="keyword">return</span> ; &#125;</span><br><span class="line">mul (a[<span class="number">2</span>], Q, ITk), mul (A, Tk, a[<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[<span class="number">2</span>][i] = A[i];</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">2</span>) &#123; print (a[<span class="number">2</span>]); <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">2</span>; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) a[i + <span class="number">2</span>][a[i][j]] = a[i + <span class="number">1</span>][j];</span><br><span class="line">print (a[n]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) P[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) Q[i] = getnum ();</span><br><span class="line">inv (IP, P), inv (IQ, Q);</span><br><span class="line">mul (T, IQ, P), mul (A, IP, T);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) T[i] = A[i];</span><br><span class="line">mul (A, Q, T); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) T[i] = A[i];</span><br><span class="line">inv (IT, T); <span class="keyword">int</span> k = K / <span class="number">6</span>; <span class="keyword">if</span> (! (K % <span class="number">6</span>)) k --;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) Tk[i] = T[i]; power (Tk, k);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ITk[i] = IT[i]; power (ITk, k);</span><br><span class="line"><span class="keyword">int</span> r = K % <span class="number">6</span>; solve (r);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Cï¼šSynchronized-Subsequence"><a href="#Problem-Cï¼šSynchronized-Subsequence" class="headerlink" title="Problem Cï¼šSynchronized Subsequence"></a>Problem Cï¼šSynchronized Subsequence</h2><h3 id="é¢˜ç›®æè¿°-2"><a href="#é¢˜ç›®æè¿°-2" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>æœ‰ä¸€ä¸ªé•¿åº¦ä¸º $2n$ çš„ä»…ç”±å­—ç¬¦ $\mathtt{a}, \mathtt{b}$ æ„æˆçš„å­—ç¬¦ä¸²ï¼Œä¸” $\mathtt{a}$ çš„ä¸ªæ•°æ°å¥½ç­‰äº $\mathtt{b}$ çš„ä¸ªæ•°ï¼Œéƒ½å‡ºç°äº† $n$ æ¬¡</p><p>ä½ éœ€è¦ä¿ç•™ä¸€äº›å­—ç¬¦ï¼Œå‰©ä¸‹çš„å­—ç¬¦åˆ æ‰ã€‚å¯¹äºä¸€ä¸ª $i$ï¼Œä½ å¯ä»¥ä¿ç•™ä»å·¦å¾€å³æ•°çš„ç¬¬ $i$ ä¸ª $\mathtt{a}$ å’Œç¬¬ $i$ ä¸ª $\mathtt{b}$</p><p>æ³¨æ„ï¼Œå¯¹äºè¿™ä¸¤ä¸ªå­—ç¬¦ï¼Œåªèƒ½åŒæ—¶ä¿ç•™æˆ–åŒæ—¶åˆ æ‰ï¼Œä¸èƒ½åªä¿ç•™å…¶ä¸­ä¸€ä¸ª</p><p>è¯·ä½ æ±‚å‡ºèƒ½å¾—åˆ°çš„å­—å…¸åºæœ€å¤§çš„ä¸²</p><h3 id="æ•°æ®èŒƒå›´-2"><a href="#æ•°æ®èŒƒå›´-2" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n \le 3000$</p><h3 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å…¶å®å¥½åƒå¯ä»¥ç›´æ¥è´ªå¿ƒæ¥ç€ï¼Œä½†æˆ‘è§‰å¾— è´ªå¿ƒ + $dp$ çš„æ–¹æ³•æ›´å€¼å¾—è®°å½•</p><p>ç°åœ¨è€ƒè™‘è‹¥å¼ºåˆ¶è¦æ±‚ç¬¬ $i$ å¯¹ $a, b$ å­˜åœ¨æœ‰ä»€ä¹ˆæ ·çš„å±€é¢ï¼Œè®¾ç¬¬ $i$ å¯¹ $a, b$ åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½® $apos_i. bpos_i$</p><ul><li>è‹¥ $apos_i &lt; bpos_i$ï¼Œé‚£ä¹ˆåœ¨æŠŠè¯¥å¯¹ $a, b$ ä¹‹é—´çš„ $a$ å…¨éƒ¨åˆ æ‰ä¹‹å‰éƒ½ä¸æ˜¯æ›´ä¼˜çš„ï¼Œæ•…å®ƒä»¬ä¹‹é—´çš„ $a$ åº”å…¨éƒ¨åˆ å»ï¼Œæœ€ç»ˆç•™ä¸‹ $ab$</li><li>è‹¥ $apos_i &gt; bpos_i$ï¼Œæ˜¾ç„¶å®ƒä»¬ä¹‹é—´çš„ $b$ éƒ½å¿…é¡»å…¨éƒ¨å­˜åœ¨</li></ul><p>é‚£ä¹ˆç°åœ¨è®° $f_i$ è¡¨ç¤ºå¼ºåˆ¶é€‰ç¬¬ $i$ å¯¹ $a,b$ï¼Œå¯¹ $iâ€¦n$ å¯¹ $a, b$ ç»„åˆæˆçš„æœ€å¤§ä¸²ï¼Œè®° $g_i$ è¡¨ç¤º $\max (f_i, f_i + 1, â€¦, f_n)$</p><p>æ³¨æ„ $f, g$ éƒ½æ˜¯ $\text{string}$ ç±»å‹</p><p>è½¬ç§»å°±çœ‹ä»£ç æŠŠ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">char</span> str[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> apos[MAXN]= &#123;<span class="number">0</span>&#125;, bpos[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> an = <span class="number">0</span>, bn = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> f[MAXN], g[MAXN];</span><br><span class="line"><span class="comment">// f[i]: å¼ºåˆ¶é€‰ç¬¬iå¯¹aã€bï¼Œå¯¹i...nå¯¹aã€bçš„æœ€å¤§ä¸²</span></span><br><span class="line"><span class="comment">// g[i]: max (f[i], f[i + 1], ..., f[n])</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%s"</span>, &amp; N, str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N &lt;&lt; <span class="number">1</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (str[i] == <span class="string">'a'</span>) apos[++ an] = i;</span><br><span class="line"><span class="keyword">if</span> (str[i] == <span class="string">'b'</span>) bpos[++ bn] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt;= <span class="number">1</span>; i --) &#123;</span><br><span class="line"><span class="keyword">if</span> (apos[i] &lt; bpos[i]) &#123;</span><br><span class="line"><span class="keyword">int</span> j = i;</span><br><span class="line"><span class="keyword">while</span> (j &lt;= N &amp;&amp; apos[j] &lt; bpos[i]) j ++;</span><br><span class="line">f[i] = <span class="string">"ab"</span> + g[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> j = i;</span><br><span class="line"><span class="keyword">while</span> (j &lt;= N &amp;&amp; bpos[j] &lt; apos[i]) j ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= j - i; k ++) f[i] += <span class="string">'b'</span>;</span><br><span class="line">f[i] += <span class="string">'a'</span> + (i + <span class="number">1</span> == j ? g[i + <span class="number">1</span>] : f[i + <span class="number">1</span>]).substr(j - i - <span class="number">1</span>, <span class="built_in">string</span>::npos); <span class="comment">// j-i-1è¡¨ç¤ºi...j-1éƒ½å·²ç»æ”¾å®Œï¼Œå–g[i+1]æˆ–f[i+1]çš„j...næ®µ</span></span><br><span class="line">&#125;</span><br><span class="line">g[i] = max (f[i], g[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; g[<span class="number">1</span>] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒåˆ†å›¾ </tag>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> ACè‡ªåŠ¨æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆäºŒåä¸€ï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%80%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%80%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>å¥½äº†ï¼Œåˆæ˜¯çˆ†é›¶çš„ä¸€å¤©ï¼Œæ­å–œæˆ‘è‡ªå·±</p><p>$\text{scoreï¼š0 + 0 + 0 = 0   rkï¼š27/27}$</p><h2 id="Problem-Aï¼šå°å–éƒ¨"><a href="#Problem-Aï¼šå°å–éƒ¨" class="headerlink" title="Problem Aï¼šå°å–éƒ¨"></a>Problem Aï¼šå°å–éƒ¨</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ysgh æ˜¯ä¸€åæ•°æ•°å¤§å¸ˆã€‚</p><p>ç°åœ¨å°å–éƒ¨æœ‰ $n$ ç§å•†å“ï¼Œç¬¬ $i$ ç§æœ‰ $a_i$ ä¸ªï¼Œä»·æ ¼ä¸º $b_i$ã€‚</p><p>ysgh æ€»å…±å»äº† $Q$ å¤©å°å–éƒ¨ï¼Œç¬¬ $i$ å¤©ä»–åªä¼šè´­ä¹°ç¼–å·åœ¨ $l_i \sim r_i$ çš„å•†å“ã€‚ä»–çš„å¡é‡Œæœ‰ $c_i$ å…ƒï¼Œå› æ­¤ä»–åªèƒ½è´­ä¹°ä»·å€¼å’Œä¸è¶…è¿‡ $c_i$ å…ƒçš„ç‰©å“ã€‚</p><p>ysgh æƒ³è¦çŸ¥é“æœ‰å¤šå°‘ç§è´­ä¹°ç‰©å“çš„æ–¹æ¡ˆã€‚ç”±äºç­”æ¡ˆå¾ˆå¤§ï¼Œä½ åªéœ€è¦è¾“å‡ºç­”æ¡ˆå¯¹ $1000000007$ å–æ¨¡åçš„ç»“æœã€‚ä¸¤ç§æ–¹æ¡ˆè¢«è®¤ä¸ºæ˜¯ä¸åŒçš„å½“ä¸”ä»…å½“å­˜åœ¨ä¸€ç§ç‰©å“ï¼Œå…¶è´­ä¹°æ•°é‡ä¸åŒã€‚</p><p>å½“ç„¶ï¼Œysghç©äº†ä¸ªå°èŠ±æ‹›ï¼Œä½ éœ€è¦é€šè¿‡ä¸Šä¸€ä¸ªè¯¢é—®çš„ç­”æ¡ˆæ¥æ¨å¯¼ä¸‹ä¸€ä¸ªè¯¢é—®çš„å‚æ•°ã€‚</p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹äºæ‰€æœ‰æµ‹è¯•æ•°æ®ï¼Œæ»¡è¶³ $1 \le n \le 10000, ~ 1 \le Q \le 50000, ~ 1 \le a_i, b_i, c_i \le 1000, 1 \le lâ€™_i, râ€™_i \le n$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>ä»¤ $C = 1000$</p><p>é¦–å…ˆçœ‹å¾—å‡ºæ¥å¯ä»¥ç”¨ç”Ÿæˆå‡½æ•°æï¼Œæ˜¾ç„¶ç­”æ¡ˆä¸º $F_i(x) = \prod\limits_{i = 1}^n \left(\sum\limits_{k = 0}^{a_i}x^{k \times b_i}\right)$</p><p>å¯¹ $F(x)$ æ±‚ä¸ªå‰ç¼€å’Œ $SF_n (x)$ï¼Œå¹¶è®¾ $SF_n(x)$ é€†å…ƒä¸º $I_n(x)$ï¼Œç­”æ¡ˆå°±æ˜¯ $SF_r(x)I_{l - 1}(x)$ çš„å‰ $c$ é¡¹ç³»æ•°å’Œ</p><p>ç„¶åæˆ‘å°±å¼€å§‹ $FFT$ã€å¤šé¡¹å¼æ±‚é€†ä»€ä¹ˆçš„ä¹±æï¼Œæ—¶é—´çˆ†ç‚¸ï¼Œç„¶åçˆ†é›¶ï¼ˆè™½ç„¶æˆ‘è¿æ¯æ¬¡è¯¢é—®çš„ $l, r$ éƒ½ç®—é”™äº†ï¼‰</p><p>å¥½å§å®é™…ä¸Šä¸Šé¢é‚£ç©æ„å„¿ç»§ç»­åŒ–ï¼Œå¯ä»¥å˜æˆ $F_i(x) = \frac{1 - x^{(a_i + 1)b_i}}{1 - x^{b_i}}$</p><p>æ¥ä¸‹æ¥çš„æ­¥éª¤æˆ‘è§‰ç€å¾ˆæœ‰æ„æ€</p><p>é¦–å…ˆæŠŠåˆ†å­åˆ†æ¯åˆ†å¼€ï¼Œå°±å˜æˆ $F_i(x) = (1 + x^{b_i} + x^{2b_i} + â€¦)(1 - x^{(a_i + 1)b_i})$</p><p>å‡è®¾ç°åœ¨è¦å¤„ç† $SF_i(x) = SF_{i - 1}(x)F_i(x)$ï¼Œé‚£ä¹ˆè®¾ $SF_i(X), SF_{i - 1}(x)$ çš„ç¬¬ $k$ é¡¹åˆ†åˆ«ä¸º $g_k, f_k$ï¼Œåˆ™æœ‰ $g_k = f_k + f_{k - b_i} + f_{k - 2b_i} + â€¦$ï¼ˆä¹˜ $F(x)$ å‰åŠéƒ¨åˆ†ï¼‰ï¼Œç„¶å $g_k = g_k - g_{k - (a_i + 1)b_i}$ï¼ˆä¹˜ $F(x)$ ååŠéƒ¨åˆ†ï¼‰ï¼Œè®°å¾—ç¬¬äºŒéƒ¨åˆ†è¦å€’æ¨</p><p>æ¥ä¸‹æ¥åªéœ€å¤„ç†é€†å…ƒï¼Œå…ˆç›´æ¥ $O (C^2)$ æ±‚å‡º $I_{n}(x)$ï¼Œç„¶å $I_i(x) = I_{i + 1}(x)F_{i + 1}(x)$ å¤„ç†å³å¯</p><p>è¿˜æœ‰ä¸€éƒ¨å¤„ç†ï¼Œå‡è®¾å¾—åˆ°çš„æœ€ç»ˆå¤šé¡¹å¼ $A(x) = SF_r(x)I_{l - 1}(x)$ï¼Œç„¶åè¦æ±‚ $\sum\limits_{i = 0}^cA(x)[x^i]$ï¼Œè¿™æ ·è¿˜æ˜¯éœ€è¦ä¸€æ¬¡å¤šé¡¹å¼ä¹˜æ³•ï¼Œæ—¶é—´è¿˜æ˜¯ä¸è¡Œ</p><p>æ­¤æ—¶å¯ä»¥ä»¤ $B(x) = \frac{A(x)}{1 - x} = A(x)(1 + x + x^2 + â€¦)$ï¼Œé‚£ä¹ˆ $\sum\limits_{i = 0}^cA(x)[x^i] = B(x)[x^c]$ï¼Œå°±å¯ä»¥ $O (C)$ å¤„ç†</p><p>è¯´å®è¯æˆ‘è§‰å¾—è¿™äº›å¤„ç†æ˜¯çœŸæŒºå‰å®³çš„ï¼ˆä½†æˆ‘è§‰å¾—åªæ˜¯å› ä¸ºæˆ‘å¤ªèœäº†ï¼‰</p><p>æ—¶é—´å¤æ‚åº¦ $O \left((n + Q)C\right)$</p><h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e04</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXC = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> C = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">power</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = <span class="number">1l</span>l * cnt * x % MOD;</span><br><span class="line">x = <span class="number">1l</span>l * x * x % MOD, p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, Q;</span><br><span class="line"><span class="keyword">int</span> a[MAXN], b[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span> <span class="params">(<span class="keyword">int</span>* A, <span class="keyword">int</span>* B, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= C; i ++) A[i] = (B[i] + (i &gt;= b[p] ? A[i - b[p]] : <span class="number">0</span>)) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = C; i &gt;= (a[p] + <span class="number">1</span>) * b[p]; i --)</span><br><span class="line">A[i] = (A[i] - A[i - (a[p] + <span class="number">1</span>) * b[p]] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span>* A, <span class="keyword">int</span>* inv)</span> </span>&#123;</span><br><span class="line">inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= C; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j ++)</span><br><span class="line">inv[i] = (inv[i] - <span class="number">1l</span>l * inv[j] * A[i - j] % MOD + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> sum[MAXN][MAXC]= &#123;<span class="number">0</span>&#125;, inv[MAXN][MAXC]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// freopen ("A.in", "r", stdin);</span></span><br><span class="line"><span class="comment">// freopen ("A.out", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">N = getnum (), Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = getnum (), b[i] = getnum ();</span><br><span class="line">sum[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, inv[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) mul (sum[i], sum[i - <span class="number">1</span>], i);</span><br><span class="line">inverse (sum[N], inv[N]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --) mul (inv[i], inv[i + <span class="number">1</span>], i + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; j ++)</span><br><span class="line">inv[i][j] = (inv[i][j] + inv[i][j - <span class="number">1</span>]) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= Q; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum (), V = getnum ();</span><br><span class="line">l = (l + ans) % N + <span class="number">1</span>, r = (r + ans) % N + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (l &gt; r) swap (l, r);</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= V; i ++) ans = (ans + <span class="number">1l</span>l * sum[r][i] * inv[l - <span class="number">1</span>][V - i] % MOD) % MOD;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3</span></span><br><span class="line"><span class="comment">1 1</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 3 1</span></span><br><span class="line"><span class="comment">1 3 2</span></span><br><span class="line"><span class="comment">1 3 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šåšå¼ˆ"><a href="#Problem-Bï¼šåšå¼ˆ" class="headerlink" title="Problem Bï¼šåšå¼ˆ"></a>Problem Bï¼šåšå¼ˆ</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ysgh æœ‰ä¸€æ£µ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ ‘ä¸Šåœ¨ $1$ æœ‰ä¸€é¢—æ£‹å­ã€‚</p><p>ysgh å’Œ ysgs åˆ©ç”¨è¿™ä¸ªæ£‹å­å¼€å§‹ van æ¸¸æˆã€‚å…·ä½“çš„ï¼Œysgh å’Œ ysgs è½®æµç§»åŠ¨è¿™ä¸ªæ£‹å­ï¼Œysgh å…ˆæ‰‹ã€‚æ¯æ¬¡ç§»åŠ¨æ—¶ï¼Œéœ€è¦æ»¡è¶³æœ¬æ¬¡ç§»åŠ¨çš„æ ‘ä¸Šè·ç¦»ä¸¥æ ¼å¤§äºä¸Šä¸€æ¬¡ç§»åŠ¨çš„æ ‘ä¸Šè·ç¦»ï¼ˆç¬¬ä¸€æ¬¡ç§»åŠ¨éœ€è¦æ»¡è¶³æ ‘ä¸Šè·ç¦»ä¸ä¸º $0$ï¼‰ï¼Œæ— æ³•ç§»åŠ¨ç€è¾“ã€‚ä»–ä»¬ç§°æ­¤æ¸¸æˆä¸º ogscã€‚ysgh å’Œ ysgs éƒ½ä¼šåšå‡ºæ¸¸æˆçš„æœ€ä¼˜å†³ç­–ã€‚</p><p>ysgh å’Œ ysgs van äº†å¾ˆå¤šæ¸¸æˆï¼Œæ¸æ¸è§‰å¾—æ— èŠäº†ã€‚</p><p>ç°åœ¨ä»–ä»¬æ‰“ç®— van ä»¥ä¸‹æ¸¸æˆï¼š</p><p>ç»™å®šä¸€é¢— $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ã€‚ysgs ä¼šé€‰å‡ºä¸€ä¸ªåŒ…å«èŠ‚ç‚¹ $1$ çš„è”é€šå­æ ‘è¿›è¡Œ ogsc æ¸¸æˆã€‚åœ¨ä¸¤äººå‡ä½œæœ€ä¼˜å†³ç­–çš„æƒ…å†µä¸‹ï¼Œæœ‰å¤šå°‘ä¸ª ysgs å¿…èƒœçš„æ¸¸æˆã€‚ç”±äºç­”æ¡ˆå¾ˆå¤§ï¼Œåªéœ€è¦ç®—å¯¹ $998244353$ å–è†œçš„ç»“æœã€‚</p><p>ysgs èŠ±äº† $0.5s$ æŠ¥å‡ºäº†ç­”æ¡ˆï¼Œä½†æ˜¯ ysgh ä¸çŸ¥é“æ˜¯ä¸æ˜¯å¯¹çš„ï¼Œäºæ˜¯ä»–ä»¬æ‰¾åˆ°äº†åœ¨ä¸€æ—åƒç“œçš„ä½ ã€‚</p><h3 id="æ•°æ®èŒƒå›´-1"><a href="#æ•°æ®èŒƒå›´-1" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n \le 2e05, ~ T \le 10$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><blockquote><p>åæ‰‹å¿…èƒœçš„æ¡ä»¶ï¼š$1$ ä½äºæ ‘ç›´å¾„çš„ä¸­ç‚¹ä¸Š</p></blockquote><p>æ­¤æ—¶è‹¥å…ˆæ‰‹åˆ°è¾¾ä¸€ä¸ªè·ç¦» $1$ ä¸º $d$ çš„ç‚¹ä¸Šï¼Œé‚£ä¹ˆåæ‰‹æ€»æ˜¯å¯ä»¥åˆæ³•åœ°åˆ°è¾¾ä¸å…ˆæ‰‹ä¸åœ¨åŒä¸€æ£µ $1$ çš„å­æ ‘ï¼Œå¹¶ä¸”<strong>è·ç¦» $1$ ä¹Ÿä¸º $d$</strong> çš„ç‚¹ï¼Œé‚£ä¹ˆå…ˆæ‰‹æœ€ç»ˆä¸€å®šä¼šè¢«è¿«åˆ°è¾¾ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹ï¼Œä¹‹ååæ‰‹èµ°åˆ°å¦ä¸€ä¸ªç›´å¾„çš„ç«¯ç‚¹ï¼Œé‚£ä¹ˆå…ˆæ‰‹å°±æ— æ³•ç§»åŠ¨äº†</p><p>è€Œè‹¥ $1$ ä¸åœ¨æ ‘ç›´å¾„çš„ä¸­ç‚¹ä¸Šï¼Œé‚£ä¹ˆå…ˆæ‰‹å¯ä»¥ç§»åŠ¨åˆ°æ ‘ç›´å¾„ä¸­ç‚¹ï¼Œè€Œä½¿å¾—åæ‰‹å¿…è¾“</p><p>ç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºæœ‰å¤šå°‘æ£µè¿é€šå­æ ‘æ»¡è¶³ $1$ ä½äºæ ‘ç›´å¾„ä¸­ç‚¹ä¸Š</p><p>è®¾ $f_{u, j}$ è¡¨ç¤ºä»¥ç‚¹ $u$ ä¸ºæ ¹ï¼Œæœ‰å¤šå°‘ä¸ªè¿é€šå­æ ‘ $Tâ€™$ æ»¡è¶³ $\forall p \in Tâ€™, ~ dist (u, p) \le j$ï¼Œå…¶ä¸­ $dist (u, v)$ è¡¨ç¤ºç‚¹ $u, v$ çš„æ ‘ä¸Šè·ç¦»</p><p>å‡è®¾æˆ‘ä»¬æ±‚å‡ºæ‰€æœ‰ä»¥ $1$ ä¸ºæ ¹çš„è¿é€šå­æ ‘ä¸ªæ•°ä¸º $tot$ï¼Œé‚£ä¹ˆæ­¤æ—¶åªéœ€æšä¸¾ $1$ çš„æ¯ä¸ªå„¿å­ $u$ï¼Œä»¥åŠ $u$ çš„è¿é€šå­æ ‘ç¦» $u$ çš„æœ€å¤§è·ç¦» $j$ï¼Œå¼ºåˆ¶ä»¤ $u$ çš„è¿é€šå­æ ‘ä¸ºæ·±åº¦æœ€æ·±çš„ï¼Œä»¥å…¶ä½™ $1$ çš„å„¿å­ä¸ºæ ¹çš„è¿é€šå­æ ‘æœ€å¤§æ·±åº¦éƒ½å°äºå®ƒï¼Œé‚£ä¹ˆè¿™æ ·çš„æ–¹æ¡ˆä¸€å®šæ˜¯ä¸åˆæ³•çš„ï¼Œå› ä¸ºç›´å¾„ä¸­ç‚¹ä¸å¯èƒ½æ˜¯ $1$ï¼Œç»Ÿè®¡æ–¹æ¡ˆæ•°</p><p>ä»¤ $S_u$ è¡¨ç¤º $u$ çš„å„¿å­é›†åˆï¼Œ$l_u$ è¡¨ç¤ºç‚¹ $u$ åœ¨å­æ ‘ä¸­å¯ä»¥åˆ°è¾¾çš„æœ€è¿œè·ç¦»ï¼Œå…¬å¼åŒ–åœ°ï¼Œæœ‰<br>$$<br>ans = tot - \sum\limits_{u \in S_1}\sum\limits_{j = 0}^{l_u} (f_{u, j} - f_{u, j - 1}) \prod\limits_{v \in S_1 \cap u \neq v} f_{v, \min(l_v, j - 1)}<br>$$<br>é‚£ä¹ˆç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£ $f_{u, j}$</p><p>è€ƒè™‘æš´åŠ›ï¼Œæ˜¾ç„¶æœ‰<br>$$<br>\begin{aligned}<br>&amp;f_{u, 0} = 2 \\<br>&amp;f_{u, j} = 1 + \prod\limits_{v \in S_u} f_{v, j - 1}<br>\end{aligned}<br>$$<br>å¤æ‚åº¦çš„ç—‡ç»“åœ¨äº $j$ çš„å¤§å°æ˜¯ç”± $l_1$ å†³å®šçš„ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬è§‚å¯Ÿ $f_{v, j - 1}$ å¯¹ $f_{u, j}$ çš„è´¡çŒ®ï¼Œåªæœ‰æ»¡è¶³ $j \le l_v$ çš„æ‰æœ‰å¯èƒ½è¢«è´¡çŒ®åˆ°ï¼Œå› ä¸º $\forall j \in (l_v, l_1], f_{v, j} = f_{v, l_v}$ï¼Œçœ‹åˆ°è¿™å…¬å¼å¯ä»¥æƒ³åˆ°ä»€ä¹ˆï¼Ÿé•¿é“¾å‰–åˆ†ï¼</p><p>éœ€è¦é¢å¤–å¤„ç†çš„æ˜¯ $f_{v, l_v}$ å¯¹ $f_{u, j}, j \in (l_v + 1, l_u]$ï¼Œä¸å¦¨ç”¨ä¸€ä¸ªæ•°ç»„ $g$ æ¥å‚¨å­˜å®ƒï¼Œå³ $g_u = f_{u, l_u}$ï¼Œè€Œæ˜¾ç„¶æˆ‘ä»¬åˆä¸èƒ½æšä¸¾ $l_u$ï¼Œè¿™ä¸€éƒ¨åˆ†çš„ç­”æ¡ˆä¸€å¼€å§‹æ˜¯ç”±é‡å„¿å­ç»§æ‰¿è¿‡æ¥çš„ï¼Œä½†å®ƒä»¬éƒ½ä¹˜ä¸Šç›¸åŒçš„ $g_v$ï¼Œé‚£ä¹ˆä¸å¦¨ç”¨ç±»ä¼¼æ ‡è®°æ°¸ä¹…åŒ–çš„æ–¹æ³•æ¥è®°å½•è¿™ä¸ª $g_v$ï¼Œæ ‡è®° $\forall j \in [0, l_u] f_{u, j} = f_{u, j} \times g_v$ï¼Œå¾ˆæ˜¾ç„¶å¯¹ $j \in [0, l_v + 1]$ è¿˜éœ€è¦æŠŠ $g_v$ é™¤æ‰ï¼Œå› ä¸ºå®ƒä»¬ä¸éœ€è¦è¿™ä¸ªè´¡çŒ®</p><p>ç„¶è€Œè½¬ç§»å…¬å¼é‡Œè¿˜æœ‰ä¸€ä¸ª $+ 1$ï¼Œé‚£ä¹ˆç”¨ $mul_u, add_u$ åˆ†åˆ«è¡¨ç¤ºæ ‡è®°æ°¸ä¹…åŒ–çš„ä¹˜å’ŒåŠ ï¼Œè¿˜éœ€è¦è®°å½•ä¸€ä¸ª $imul_u$ æ¥è®°å½•éœ€è¦é™¤æ‰çš„ $g_v$ï¼Œç”¨ $dp_{u, j}$ æ¥è¡¨ç¤ºæ²¡æœ‰ä¹˜ä¸Šè¿‡æ ‡è®°çš„æ•°å€¼ï¼Œå®ƒå¯ä»¥å’Œ $f$ äº’ç›¸è½¬åŒ–<br>$$<br>\begin{aligned}<br>&amp;f_{u, j} = dp_{u, j} \times mul_u + add_u \\<br>&amp;dp_{u, j} = \frac{f_{u, j} - add_u}{mul_u}<br>\end{aligned}<br>$$<br>ä¸å¦¨ç”¨å‡½æ•°æ¥è¡¨ç¤ºè¿™ä¹ˆä¸€ä¸ªå˜æ¢ï¼Œ$f(u, j) = dp_{u, j} \times mul_u + add_u$ ä»¥åŠ $df (u, r) = \frac{r - add_u}{mul_u}$ï¼Œé‚£ä¹ˆ $dp_{u, j}$ åœ¨è½¬ç§»çš„æ—¶å€™å°±éœ€è¦ä¸€ç›´ä¿æŒæ²¡ç´¯è®¡è¿‡æ ‡è®°çš„æ•°å€¼ï¼Œå³ $dp_{u, j} = df (u, f(u, j) \times f(v, j - 1))$</p><p>ä½†æ˜¯æ³¨æ„ï¼Œå¯èƒ½ä¼šå­˜åœ¨æŸæ—¶åˆ» $f (v, l_u) \equiv 0 \pmod{998244353}$ï¼Œä¹Ÿå°±æ˜¯ $\forall j \in (l_v, l_u], f (u, j) = 0$ï¼Œç”¨ $lim_u$ æ¥è®°å½•è¿™ç§ $l_v + 1$ï¼Œ$z_u$ æ¥è®°å½•åœ¨å½“å‰æƒ…å†µä¸‹ï¼Œ$0$ æ‰€å¯¹åº”çš„æœªç´¯è®¡æ ‡è®°è¿‡çš„æ•°å€¼ï¼Œå³ $df (u, 0)$ï¼Œé‚£ä¹ˆå¯¹ $j &lt; lim_u$ åˆ™ç…§å¸¸ï¼Œå¯¹ $j \ge lim_u$ åˆ™æœ‰ $f(u, j) = z_u \times mul_u + add_u$ï¼Œå…¶å®å°±æ˜¯ç›´æ¥èµ‹å€¼ $z_u \rightarrow dp_{u, j}$</p><p>æ—¶é—´å¤æ‚åº¦ $O (T \times n)$</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">power</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = <span class="number">1l</span>l * cnt * x % MOD;</span><br><span class="line">x = <span class="number">1l</span>l * x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inv2 = power (<span class="number">2</span>, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> len[MAXN]= &#123;<span class="number">0</span>&#125;, son[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">len[root] = <span class="number">0</span>, son[root] = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">DFS (v, root);</span><br><span class="line"><span class="keyword">if</span> (son[root] == - <span class="number">1</span> || len[v] &gt; len[son[root]])</span><br><span class="line">son[root] = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (~ son[root]) len[root] = len[son[root]] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tmp[MAXN &lt;&lt; <span class="number">1</span>], *dp[MAXN], *id;</span><br><span class="line"><span class="keyword">int</span> mul[MAXN], imul[MAXN], add[MAXN], g[MAXN], ig[MAXN];</span><br><span class="line"><span class="keyword">int</span> lim[MAXN], zero[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">k = min (k, len[n]);</span><br><span class="line"><span class="keyword">if</span> (lim[n] &lt;= k) <span class="keyword">return</span> (<span class="number">1l</span>l * zero[n] * mul[n] % MOD + add[n]) % MOD;</span><br><span class="line"><span class="keyword">return</span> (<span class="number">1l</span>l * dp[n][k] * mul[n] % MOD + add[n]) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">df</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> r)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1l</span>l * (<span class="number">1l</span>l * r - add[n] + MOD) % MOD * imul[n] % MOD; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DP</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (son[u] == - <span class="number">1</span>) &#123;</span><br><span class="line">mul[u] = imul[u] = <span class="number">1</span>;</span><br><span class="line">add[u] = g[u] = <span class="number">2</span>;</span><br><span class="line">lim[u] = N + <span class="number">1</span>, ig[u] = inv2;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">dp[son[u]] = dp[u] + <span class="number">1</span>;</span><br><span class="line">DP (son[u], u);</span><br><span class="line">mul[u] = mul[son[u]], imul[u] = imul[son[u]], add[u] = add[son[u]];</span><br><span class="line">lim[u] = lim[son[u]], zero[u] = zero[son[u]];</span><br><span class="line">dp[u][<span class="number">0</span>] = df (u, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == fa || v == son[u]) <span class="keyword">continue</span>;</span><br><span class="line">dp[v] = id, id += len[v] + <span class="number">1</span>, DP (v, u);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= len[v] + <span class="number">1</span>; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (lim[u] == j) dp[u][j] = zero[u], lim[u] ++;</span><br><span class="line">dp[u][j] = df (u, <span class="number">1l</span>l * f (u, j) * f (v, j - <span class="number">1</span>) % MOD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (! g[v]) &#123; lim[u] = len[v] + <span class="number">2</span>, zero[u] = df (u, <span class="number">0</span>); <span class="keyword">continue</span>; &#125;</span><br><span class="line">mul[u] = <span class="number">1l</span>l * mul[u] * g[v] % MOD;</span><br><span class="line">imul[u] = <span class="number">1l</span>l * imul[u] * ig[v] % MOD;</span><br><span class="line">add[u] = <span class="number">1l</span>l * add[u] * g[v] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= len[v] + <span class="number">1</span>; j ++)</span><br><span class="line">dp[u][j] = df (u, <span class="number">1l</span>l * f (u, j) * ig[v] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">add[u] = (<span class="number">1l</span>l * add[u] + <span class="number">1</span>) % MOD;</span><br><span class="line"><span class="keyword">if</span> (son[fa] != u) &#123; g[u] = f (u, len[u]); ig[u] = power (g[u], MOD - <span class="number">2</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> gr[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stati</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">gr[u] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">stati (v, u);</span><br><span class="line">gr[u] = <span class="number">1l</span>l * gr[u] * (gr[v] + <span class="number">1</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> subpro[MAXN], subflo[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head)), size = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span> (tmp, <span class="number">0</span>, <span class="keyword">sizeof</span> (tmp));</span><br><span class="line">id = tmp;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">mul[i] = imul[i] = add[i] = lim[i] = zero[i] = g[i] = ig[i] = <span class="number">0</span>;</span><br><span class="line">subpro[i] = subflo[i] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>); dp[<span class="number">1</span>] = id, id += len[<span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[<span class="number">1</span>]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">dp[v] = id, id += len[v] + <span class="number">1</span>; DP (v, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= len[v]; j ++)</span><br><span class="line">subpro[j] = <span class="number">1l</span>l * subpro[j] * f (v, j) % MOD;</span><br><span class="line"><span class="keyword">if</span> (len[v] + <span class="number">1</span> &lt;= len[<span class="number">1</span>]) subflo[len[v] + <span class="number">1</span>] = <span class="number">1l</span>l * subflo[len[v] + <span class="number">1</span>] * f (v, len[v]) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len[<span class="number">1</span>]; i ++) subflo[i] = <span class="number">1l</span>l * subflo[i - <span class="number">1</span>] * subflo[i] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= len[<span class="number">1</span>]; i ++) subpro[i] = <span class="number">1l</span>l * subpro[i] * subflo[i] % MOD;</span><br><span class="line">stati (<span class="number">1</span>, <span class="number">0</span>); <span class="keyword">int</span> ans = gr[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[<span class="number">1</span>]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= len[v]; j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> del = (<span class="number">1l</span>l * f (v, j) - (j &gt; <span class="number">0</span> ? f (v, j - <span class="number">1</span>) : <span class="number">1</span>) + MOD) % MOD;</span><br><span class="line"><span class="keyword">if</span> (j &gt; <span class="number">0</span>) del = <span class="number">1l</span>l * del * subpro[j - <span class="number">1</span>] % MOD * power (f (v, j - <span class="number">1</span>), MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">ans = (<span class="number">1l</span>l * ans - del + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line">N = getnum (); init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">Insert (u, v), Insert (v, u);</span><br><span class="line">&#125;</span><br><span class="line">solve ();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem-Cï¼šç½‘ç»œæµ"><a href="#Problem-Cï¼šç½‘ç»œæµ" class="headerlink" title="Problem Cï¼šç½‘ç»œæµ"></a>Problem Cï¼šç½‘ç»œæµ</h3>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
            <tag> æ ‘ä¸ŠDP </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> åšå¼ˆè®º </tag>
            
            <tag> é•¿é“¾å‰–åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆä¸‰åï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>æ™šäº†å‡ å¤©å†™ï¼Œæš´åŠ›åœº</p><p>$\text{scoreï¼š40 + 40 + 45 = 125   rkï¼š17/30}$</p><h2 id="Problem-Aï¼šTree"><a href="#Problem-Aï¼šTree" class="headerlink" title="Problem Aï¼šTree"></a>Problem Aï¼šTree</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/22/At2B5jTuCRhF9Yv.png" alt=""></p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n \le 10^8, ~ 1000 \le k \le 10^8$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å¾ˆå®¹æ˜“å‘ç°ï¼Œæ»¡è¶³æ¡ä»¶ç­‰ä»·äºè¦æ±‚æ ‘ä¸­æ²¡æœ‰ä»»æ„ä¸€æ¡ä»æ ¹å‡ºå‘çš„è·¯å¾„ç»è¿‡è¶…è¿‡ $k - 1$ ä¸ªå·¦å„¿å­</p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªå¾ˆå¦™çš„è½¬æ¢ï¼Œå°†æ ‘æŒ‰å¦‚ä¸‹è§„åˆ™å˜ä¸ºæ‹¬å·åºåˆ—ï¼š</p><p>å­æ ‘ $u$ æ‹¬å·åº = â€˜(â€˜ + â€˜$u$ å·¦å­æ ‘æ‹¬å·åºâ€™ + â€˜)â€™ + â€˜$u$ å³å­æ ‘æ‹¬å·åº</p><p>ç»™ä¸ªé¢˜è§£çš„å›¾ä¾‹</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/22/UzbMDAGx3FZ7nJX.jpg" alt=""></p><p>å®é™…ä¸Šå¯ä»¥ä¸ç”¨è€ƒè™‘å¶èŠ‚ç‚¹ï¼Œé‚£ä¹ˆç°åœ¨å°† $n$ å˜ä¸º $n - 1$ï¼Œ$k$ å˜ä¸º $k - 2$</p><p>é‚£ä¹ˆç°åœ¨çš„ä»»åŠ¡å°±å˜ä¸ºåœ¨åæ ‡ç³»ä¸­å°†å·¦æ‹¬å·çœ‹ä½œå¾€å³ä¸Šè§’èµ°ï¼Œå³æ‹¬å·çœ‹ä½œå¾€å³ä¸‹è§’èµ°ï¼Œä» $(0, 0)$ æœ€ç»ˆèµ°åˆ° $(2n, 0)$ çš„æ–¹æ¡ˆæ•°ï¼Œå¹¶éœ€è¦æ»¡è¶³è¿‡ç¨‹ä¸­çºµåæ ‡å§‹ç»ˆåœ¨ $[0, k]$ ä¸­çš„æ–¹æ¡ˆæ•°ï¼ˆæ³¨æ„æ­¤æ—¶ $n, k$ å·²å˜åŒ–ï¼‰</p><p>è¿™å°±æ˜¯ç±»ä¼¼å¡ç‰¹å…°æ•°ï¼Œä½†æ˜¯æœ‰ä¸¤æ¡é™åˆ¶ï¼Œå³ä¸èƒ½ç¢°åˆ° $y = - 1$ ä¹Ÿä¸èƒ½ç¢°åˆ° $y = k + 1$</p><p>åˆä» $(x1, y1)$ èµ°åˆ° $(x_2, y_2)$ æ— é™åˆ¶çš„æ–¹æ¡ˆæ•°ä¸º $f(x_1, y_1, x_2, y_2) = \dbinom{|x_1 - x_2|}{\frac{|x_1 - x_2| + |y_1 - y_2|}{2}}$</p><p>è€ƒè™‘å®¹æ–¥ï¼Œé¦–å…ˆæœ‰æ€»æ–¹æ¡ˆæ•° $f(0, 0, 2n, 0)$ï¼Œå†å–å¯¹ç§°ä¸€æ¬¡ã€ä¸¤æ¬¡ã€ä¸‰æ¬¡ã€‚ã€‚æ±‚æ–¹æ¡ˆæ•°</p><p>å¯¹ç§°ä¸€æ¬¡å³å¯¹ç§°åˆ° $(0, -2), (0, 2k + 2)$ï¼Œå‡å»å…¶åˆ° $(2n, 0)$ çš„æ–¹æ¡ˆæ•°</p><p>å¯¹ç§°ä¸¤æ¬¡åˆ†ç±»è®¨è®ºï¼Œå…ˆç»è¿‡ $y = - 1$ å†ç»è¿‡ $y = k + 1$ æˆ–å…ˆç»è¿‡ $y = k + 1$ å†ç»è¿‡ $y = - 1$ï¼Œå¯¹ç¬¬ä¸€ç§æƒ…å†µï¼Œå¯¹ç§°ä¸¤æ¬¡ååˆ° $(0, 2k + 4)$ï¼Œå¯¹ç¬¬äºŒç§ï¼Œåˆ° $(0, - 2k - 4)$ï¼Œå†åŠ ä¸Šå®ƒä»¬åˆ° $(2n, 0)$ çš„æ–¹æ¡ˆæ•°</p><p>ä½†æ˜¯ä¼šå‘ç°è¿™æ ·ä¼šå¤šåŠ ä¸Šå¯¹ç§°ä¸‰æ¬¡çš„ç­”æ¡ˆï¼Œæ‰€ä»¥è¿˜éœ€å‡å»å¯¹ç§°ä¸‰æ¬¡ä¸­è®¨è®ºçš„ç­”æ¡ˆ</p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/22/7TaRXmWoSwKB61p.png" alt=""></p><p>ä¸¾ä¸ªä¾‹å­ï¼Œè€ƒè™‘ä¸Šå›¾è¿™æ ·ä¸€ä¸ªè¿åŠ¨è½¨è¿¹ï¼Œé‚£ä¹ˆå®ƒä¸€å…±ä¼šè¢«è¿™äº›æ‰€è®¡ç®—åˆ°ï¼šå…ˆä¸‹å†ä¸Šã€å…ˆä¸Šå†ä¸‹ã€ä¸‹ä¸Šä¸‹ã€ä¸Šä¸‹ä¸Šã€ä¸‹ä¸Šä¸‹ä¸Š</p><p>å®é™…ä¸Šæœ‰åº”è¯¥ä½œè´¡çŒ®çš„åªæœ‰æœ€åä¸€ä¸ªâ€œä¸‹ä¸Šä¸‹ä¸Šâ€è€Œå·²ï¼Œæ‰€ä»¥æ˜¯è¦å®¹æ–¥çš„</p><p>å¯ä»¥çŸ¥é“æ²¡ä¸¤æ¬¡å¯¹ç§°å°±å¯ä»¥ä½¿çºµåæ ‡ç»å¯¹å€¼å¢åŠ  $2k + 4$ï¼Œå½“çºµåæ ‡ç»å¯¹å€¼è¶…è¿‡ $2n$ æ—¶ï¼Œæ˜¾ç„¶è´¡çŒ®ä¸º $0$ï¼Œæ­¤æ—¶å°±å¯ä»¥åœæ­¢ï¼Œé‚£ä¹ˆè®¡ç®—æ€»æ¬¡æ•°å¤§çº¦ä¸º $\frac{4n}{k}$</p><p>æ—¶é—´å¤æ‚åº¦ $O (\frac{n}k \log_p n)$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 10007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = MOD + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"></span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;, invfact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">lucas</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == m) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MOD &amp;&amp; m &lt;= MOD) <span class="keyword">return</span> C (n, m);</span><br><span class="line"><span class="keyword">return</span> C (n % MOD, m % MOD) * lucas (n / MOD, m / MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sym</span> <span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> p)</span> </span>&#123; <span class="keyword">return</span> p ? - y - <span class="number">2</span> : - y + <span class="number">2</span> * k + <span class="number">2</span>; &#125; <span class="comment">// y = - 1 &amp; y = k + 1</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">path</span> <span class="params">(<span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> lucas (<span class="number">2</span> * n, n + y / <span class="number">2</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K;</span><br><span class="line">n = N - <span class="number">1</span>, k = K - <span class="number">2</span>;</span><br><span class="line">fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MOD; i ++) fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[MOD - <span class="number">1</span>] = power (fact[MOD - <span class="number">1</span>], MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = MOD - <span class="number">2</span>; i &gt;= <span class="number">1</span>; i --) invfact[i] = invfact[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line"><span class="keyword">int</span> up = <span class="number">2</span> * k + <span class="number">2</span>, down = - <span class="number">2</span>, p = <span class="number">1</span>;</span><br><span class="line">LL ans = lucas (<span class="number">2</span> * n, n);</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">abs</span> (up) &gt; <span class="number">2</span> * n &amp;&amp; <span class="built_in">abs</span> (down) &gt; <span class="number">2</span> * n) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">int</span> t = p == <span class="number">1</span> ? - <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">ans = (ans + t * path (up) % MOD + MOD) % MOD;</span><br><span class="line">ans = (ans + t * path (down) % MOD + MOD) % MOD;</span><br><span class="line">up = sym (up, p), down = sym (down, p ^ <span class="number">1</span>);</span><br><span class="line">p ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šæ–‡æœ¬ç¼–è¾‘å™¨"><a href="#Problem-Bï¼šæ–‡æœ¬ç¼–è¾‘å™¨" class="headerlink" title="Problem Bï¼šæ–‡æœ¬ç¼–è¾‘å™¨"></a>Problem Bï¼šæ–‡æœ¬ç¼–è¾‘å™¨</h2><h2 id="Problem-Cï¼šç¬¬kæ·±-kth"><a href="#Problem-Cï¼šç¬¬kæ·±-kth" class="headerlink" title="Problem Cï¼šç¬¬kæ·±(kth)"></a>Problem Cï¼šç¬¬kæ·±(kth)</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ä¸€ä¸ª $n$ ä¸ªç‚¹çš„æœ‰æ ¹æ ‘ï¼Œ$1$ ä¸ºæ ¹ï¼Œå¸¦è¾¹æƒï¼Œæœ‰ $m$ æ¬¡æ“ä½œ</p><ul><li>æ“ä½œ $1$ï¼šæ±‚ $x$ çš„å­æ ‘ä¸­ç¬¬ $k$ å°çš„æ·±åº¦çš„å€¼ï¼Œå¦‚æœå­æ ‘ä¸­æ²¡æœ‰ $k$ ä¸ªç‚¹åˆ™è¾“å‡º $- 1$</li><li>æ“ä½œ $2$ï¼šå°† $x$ ä¸ $x$ çˆ¶äº²çš„è¾¹æƒåŠ ä¸Š $k$</li></ul><p>ä¿è¯æ¯æ¬¡æ“ä½œ $2$ çš„ $k$ ä»¥åŠåŸæ ‘çš„è¾¹æƒå°äºç­‰äºä¸€ä¸ªæ•° $len$<br>å¦‚æœæ“ä½œ $2$ ä¸­ $x$ ä¸º $1$ï¼Œé‚£ä¹ˆè§†ä¸ºå°† $x$ çš„åŸºç¡€æ·±åº¦åŠ ä¸Šäº† $k$</p><h3 id="æ•°æ®èŒƒå›´-1"><a href="#æ•°æ®èŒƒå›´-1" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n, m \le 10^5, ~ 1 \le len \le 10, ~ k \in N^+$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>åŸé¢˜ <a href="https://www.luogu.com.cn/problem/P3712" target="_blank" rel="noopener">å°‘å¥³ä¸æˆ˜è½¦</a></p><p>$\text{lxl}$ åˆ†å—é¢˜ã€‚ã€‚</p><p>é¦–å…ˆæå‡ºæ¯ä¸ªç‚¹çš„ $DFS$ åºï¼Œé‚£ä¹ˆæ¯æ¬¡ä¿®æ”¹å°±æ˜¯åŒºé—´åŠ </p><p>ç°åœ¨è€ƒè™‘å¦‚ä½•åˆ†å—ï¼Œæ®è¯´è¿™ç§åˆ†å—æ–¹å¼å¯èƒ½å«åŒå…³é”®å­—åˆ†å—ï¼Ÿ</p><p>å¯¹æ¯ä¸€å—ï¼Œä¿è¯</p><ul><li>æ¯ä¸€å—æœ€å¤§ï¼ˆå°ï¼‰å€¼ $max(min)$ï¼Œå—å·¦å³ç«¯ç‚¹ $l, r$ï¼Œæ»¡è¶³ï¼Œ$max - min \le 2\sqrt{10m}$ ä¸” $r - l + 1 \le \sqrt n$</li></ul><p>é‚£ä¹ˆè¿™æ ·å°±å¯ä»¥ä¿è¯å—çš„åˆ†å‰²ç‚¹ä¸ªæ•°ä¸è¶…è¿‡ $\frac{10m}{\sqrt{10m}} + \frac{n}{\sqrt n}$</p><p>æŸ¥è¯¢äºŒåˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå—å†…å­˜å—æ¯ä¸ªå…ƒç´ æ¯”å—ä¸­æœ€å°å€¼å¤§å¤šå°‘ï¼Œå¹¶è®°å½•å®ƒä»¬çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆæ¯æ¬¡ $check$ çš„æ—¶å€™å°±å¯ä»¥ $O (1)$ æŸ¥è¯¢å—å†…æ¯” $mid$ å°çš„ç‚¹çš„ä¸ªæ•°</p><p>ç„¶åæ¯ä¿®æ”¹ $1000$ é‡æ–°åˆ†å—ï¼Œä¿®æ”¹ $1000$ æ¬¡åå—å†…æœ€å¤§æœ€å°å€¼å·®ä¸ä¼šæ–°å¢è¶…è¿‡ $20000$ï¼Œè¿™ä¹Ÿæ˜¯æ•°ç»„èƒ½å­˜ä¸‹çš„æé™</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXB = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXV = <span class="number">20000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> LL LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> V = <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, len;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN]= &#123;<span class="number">0</span>&#125;, ord = <span class="number">0</span>;</span><br><span class="line">LL d[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, LL dist)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line">dfn[root] = ++ ord; d[ord] = dist;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line">DFS (v, dist + w);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> lim;</span><br><span class="line"><span class="keyword">int</span> bel[MAXN]= &#123;<span class="number">0</span>&#125;, bl[MAXB]= &#123;<span class="number">0</span>&#125;, br[MAXB]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line">LL mini[MAXB]= &#123;<span class="number">0</span>&#125;, maxi[MAXB]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> subsum[MAXB][MAXV]= &#123;<span class="number">0</span>&#125;, lazy[MAXB]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span> <span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">mini[i] = LINF, maxi[i] = - LINF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = bl[i]; j &lt;= br[i]; j ++) &#123;</span><br><span class="line">d[j] += lazy[i];</span><br><span class="line">mini[i] = min (mini[i], d[j]);</span><br><span class="line">maxi[i] = max (maxi[i], d[j]);</span><br><span class="line">&#125;</span><br><span class="line">lazy[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= maxi[i] - mini[i]; j ++) subsum[i][j] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = bl[i]; j &lt;= br[i]; j ++) subsum[i][d[j] - mini[i]] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= maxi[i] - mini[i]; j ++) subsum[i][j] += subsum[i][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! lazy[p]) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bl[p]; i &lt;= br[p]; i ++) d[i] += lazy[p];</span><br><span class="line">lazy[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) pushdown (i);</span><br><span class="line">LL mi = LINF, ma = - LINF; m = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">mi = min (mi, d[i]), ma = max (ma, d[i]);</span><br><span class="line"><span class="keyword">if</span> (ma - mi &gt; V || i - br[m - <span class="number">1</span>] &gt; lim) &#123;</span><br><span class="line">bl[m] = br[m - <span class="number">1</span>] + <span class="number">1</span>, br[m] = i - <span class="number">1</span>;</span><br><span class="line">mi = ma = d[i]; m ++;</span><br><span class="line">&#125;</span><br><span class="line">bel[i] = m;</span><br><span class="line">&#125;</span><br><span class="line">bl[m] = br[m - <span class="number">1</span>] + <span class="number">1</span>, br[m] = N;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) maintain (i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (bel[l] + <span class="number">1</span> &gt;= bel[r]) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) d[i] += x;</span><br><span class="line">maintain (bel[l]); maintain (bel[r]);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= br[bel[l]]; i ++) d[i] += x;</span><br><span class="line">maintain (bel[l]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bel[l] + <span class="number">1</span>; i &lt;= bel[r] - <span class="number">1</span>; i ++) &#123; lazy[i] += x; mini[i] += x, maxi[i] += x; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bl[bel[r]]; i &lt;= r; i ++) d[i] += x;</span><br><span class="line">maintain (bel[r]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, LL mid)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (bel[l] + <span class="number">1</span> &gt;= bel[r]) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) cnt += d[i] &lt;= mid;</span><br><span class="line"><span class="keyword">return</span> cnt &gt;= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= br[bel[l]]; i ++) cnt += d[i] &lt;= mid;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bel[l] + <span class="number">1</span>; i &lt;= bel[r] - <span class="number">1</span>; i ++)</span><br><span class="line"><span class="keyword">if</span> (mid - mini[i] &gt;= <span class="number">0</span>)</span><br><span class="line">cnt += subsum[i][min (maxi[i] - mini[i], mid - mini[i])];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bl[bel[r]]; i &lt;= r; i ++) cnt += d[i] &lt;= mid;</span><br><span class="line"><span class="keyword">return</span> cnt &gt;= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">pushdown (bel[l]); pushdown (bel[r]);</span><br><span class="line">LL left = LINF, right = - LINF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bel[l]; i &lt;= bel[r]; i ++) &#123;</span><br><span class="line">left = min (left, mini[i]);</span><br><span class="line">right = max (right, maxi[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> left;</span><br><span class="line">LL ans = left;</span><br><span class="line"><span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">LL mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (check (l, r, k, mid)) &#123; ans = mid; right = mid - <span class="number">1</span>; &#125;</span><br><span class="line"><span class="keyword">else</span> left = mid + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), len = getnum ();</span><br><span class="line">lim = <span class="built_in">sqrt</span> (N); </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> fa = getnum (), w = getnum ();</span><br><span class="line">Insert (fa, i, w);</span><br><span class="line">&#125;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">int</span> modi = <span class="number">0</span>;</span><br><span class="line">build ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= M; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> opt = getnum (), x = getnum (), k = getnum ();</span><br><span class="line"><span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (subsize[x] &lt; k) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">continue</span>; &#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, query (dfn[x], dfn[x] + subsize[x] - <span class="number">1</span>, k));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">modi ++;</span><br><span class="line"><span class="keyword">if</span> (! (modi % <span class="number">1000</span>)) build ();</span><br><span class="line">modify (dfn[x], dfn[x] + subsize[x] - <span class="number">1</span>, k);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> ç»„åˆæ•°å­¦ </tag>
            
            <tag> äºŒåˆ†ç­”æ¡ˆ </tag>
            
            <tag> åˆ†å— </tag>
            
            <tag> é›†è®­ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆä¸‰åäºŒï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%8C%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%8C%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ä¸­ä¸‹</p><p>$\text{scoreï¼š24 + 40 + 0 = 64   rkï¼š23/34}$</p><h2 id="Problem-Aï¼šMythological-V"><a href="#Problem-Aï¼šMythological-V" class="headerlink" title="Problem Aï¼šMythological V"></a>Problem Aï¼šMythological V</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>å°Sæ‰“ç®—é€ç»™å°Mä¸€æ£µ $n$ ä¸ªç‚¹çš„åœ£è¯æ ‘ï¼Œç‚¹ä» $1$ åˆ° $n$ æ ‡å·ï¼Œä»–æ‰“ç®—ç»™æ ‘ä¸ŠæŒ‚ä¸Š $m$ ä¸ªç¤¼ç‰©ï¼Œæ¯ä¸ªç¤¼ç‰©åœ¨æ ‘ä¸Šçš„æŸä¸ªç‚¹ä¸Šï¼Œç¤¼ç‰©å¯ä»¥é‡å ã€‚</p><p> å°Mç»™äº†å°S $q$ ä¸ªé™åˆ¶ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªå½¢å¦‚â€œç¬¬ $a_i$ ä¸ªç¤¼ç‰©å’Œç¬¬ $b_i$ ä¸ªç¤¼ç‰©åœ¨æ ‘ä¸Šçš„æœ€çŸ­è·¯å¾„ç»è¿‡äº†ç‚¹ $c_i$â€ã€‚</p><p> å°Sæƒ³è¦æ„é€ å‡ºç¬¦åˆå°Mæ¡ä»¶çš„æŒ‚ç¤¼ç‰©æ–¹æ¡ˆã€‚å¯æ€œçš„å°Så½“ç„¶ä¸ä¼šå•¦ï¼Œæ‰€ä»¥ä»–å‘ä½ æ±‚åŠ©ã€‚</p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$n, m \le 250, ~ q \le 5 \times 10^4$</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å¥½ä¹…æ²¡å†™è¿‡ $2-SAT$ äº†</p><p>è™½ç„¶æˆ‘çš„æš´åŠ›è™½ç„¶ $\text{WA}$ äº†ä½†ç«Ÿç„¶æ²¡æœ‰ $\text{T}$ï¼Ÿè¯´ä¸å®šæ”¹å¯¹äº†èƒ½è¿‡å‘¢</p><p>è€ƒè™‘ä¸¤ä¸ªç¤¼ç‰© $a, b$ æ”¾ç½®ä½ç½®ç»è¿‡ $c$ ä»£è¡¨ç€ä»€ä¹ˆï¼Œè¯´æ˜ $a, b$ æ”¾ç½®çš„ä½ç½®åœ¨ä»¥ $c$ ä¸ºæ ¹çš„æ ‘ä¸Šä½äºä¸åŒçš„ $c$ å„¿å­çš„å­æ ‘ä¸Š</p><p>é‚£ä¹ˆç°åœ¨ä»¥ $1$ ä¸ºæ ¹ï¼Œè®¾ $g_{i, j, 0}$ è¡¨ç¤ºç¬¬ $j$ ä¸ªç¤¼ç‰©ä¸åœ¨ $i$ ç‚¹çš„å­æ ‘ä¸Šï¼Œè€Œ $g_{i, j, 1}$ è¡¨ç¤ºåœ¨</p><p>å¯¹æ¯ä¸ªé¢˜ç›®æ‰€ç»™é™åˆ¶ï¼Œè¿è¾¹æœ‰ $g_{c, a, 0} \rightarrow g_{c, b, 1}$ï¼ˆè¡¨ç¤º $a$ åœ¨ $c$ ç¥–å…ˆä¸åŒ…æ‹¬ $c$ çš„å­æ ‘ä¸­ï¼Œé‚£ä¹ˆ $b$ ä¸€å®šåœ¨ $c$ å­æ ‘ä¸­ï¼‰ã€$g_{i, a, 1} \rightarrow g_{i, b, 0}$ã€$g_{i, b, 1} \rightarrow g_{i, a, 0}$ï¼ˆå…¶ä¸­ $i$ è¡¨ç¤º $c$ çš„å„¿å­ç»“ç‚¹ï¼‰</p><p>å½“ç„¶è¿˜æœ‰æœ€åŸºæœ¬çš„é™åˆ¶ï¼Œå¯¹æŸä¸ªèŠ‚ç‚¹ $u$ ä»¥åŠæŸä¸ªç¤¼ç‰© $i$ï¼Œ$g_{1, i, 0} \rightarrow g_{1, i, 1}$ï¼ˆå¼ºåˆ¶è¦æ±‚ $i$ åœ¨ $1$ çš„å­æ ‘ä¸­ï¼‰ã€$g_{u, i, 1} \rightarrow g_{fa_u, i, 1}$ã€$g_{u, i, 0} \rightarrow g_{son_u, i, 0}$ã€$g_{u, i, 1} \rightarrow g_{v, i, 0}$ï¼ˆå…¶ä¸­ $u, v$ çš„ä¸¤ä¸ªå­æ ‘æ— äº¤é›†ï¼‰</p><p>æ—¶é—´å¤æ‚åº¦ $O (N + M) = O (n^2m + qn^2)$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">250</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">250</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = MAXN * MAXN * <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">3e07</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, next; &#125; ;</span><br><span class="line">LFS Link[MAXL];</span><br><span class="line"><span class="keyword">int</span> Head[MAXK]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;, depth[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">father[root] = fa;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) G[root].size(); i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = G[root][i];</span><br><span class="line"><span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[root] + <span class="number">1</span>;</span><br><span class="line">DFS (v, root);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isanc</span> <span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! x) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> x == y ? <span class="literal">true</span> : isanc (y, father[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line"><span class="keyword">int</span> g[MAXN][MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dfn[MAXK]= &#123;<span class="number">0</span>&#125;, low[MAXK]= &#123;<span class="number">0</span>&#125;, ord = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">stack</span>[MAXK]= &#123;<span class="number">0</span>&#125;, top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> insta[MAXK]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> bel[MAXK]= &#123;<span class="number">0</span>&#125;, co = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">dfn[u] = low[u] = ++ ord;</span><br><span class="line"><span class="built_in">stack</span>[++ top] = u; insta[u] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (! dfn[v]) &#123;</span><br><span class="line">Tarjan (v);</span><br><span class="line">low[u] = min (low[u], low[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (insta[v]) low[u] = min (low[u], dfn[v]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (dfn[u] == low[u]) &#123;</span><br><span class="line">co ++; <span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">x = <span class="built_in">stack</span>[top --];</span><br><span class="line">insta[x] = <span class="literal">false</span>, bel[x] = co;</span><br><span class="line">&#125; <span class="keyword">while</span> (x != u);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">G[u].push_back(v); G[v].push_back(u);</span><br><span class="line">&#125;</span><br><span class="line">depth[<span class="number">1</span>] = <span class="number">1</span>, DFS (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line">g[i][j][<span class="number">1</span>] = ++ m, g[i][j][<span class="number">0</span>] = ++ m;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> a = getnum (), b = getnum (), u = getnum ();</span><br><span class="line"><span class="keyword">if</span> (father[u]) &#123; Insert (g[u][a][<span class="number">0</span>], g[u][b][<span class="number">1</span>]); Insert (g[u][b][<span class="number">0</span>], g[u][a][<span class="number">1</span>]); &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) G[u].size(); j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = G[u][j];</span><br><span class="line"><span class="keyword">if</span> (v != father[u]) &#123;</span><br><span class="line">Insert (g[v][a][<span class="number">1</span>], g[v][b][<span class="number">0</span>]);</span><br><span class="line">Insert (g[v][b][<span class="number">1</span>], g[v][a][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (father[i]) Insert (g[i][j][<span class="number">1</span>], g[father[i]][j][<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; (<span class="keyword">int</span>) G[i].size(); k ++)</span><br><span class="line"><span class="keyword">if</span> (G[i][k] != father[i])</span><br><span class="line">Insert (g[i][j][<span class="number">0</span>], g[G[i][k]][j][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) Insert (g[<span class="number">1</span>][i][<span class="number">0</span>], g[<span class="number">1</span>][i][<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (! isanc (i, j) &amp;&amp; ! isanc (j, i))</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= M; k ++)</span><br><span class="line">Insert (g[i][k][<span class="number">1</span>], g[j][k][<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)</span><br><span class="line"><span class="keyword">if</span> (! dfn[i])</span><br><span class="line">Tarjan (i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line"><span class="keyword">if</span> (bel[g[i][j][<span class="number">1</span>]] &lt; bel[g[i][j][<span class="number">0</span>]])</span><br><span class="line">ans[j] = depth[ans[j]] &lt; depth[i] ? i : ans[j];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">1</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, ans[i]);</span><br><span class="line">&#125; <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šMythological-IV"><a href="#Problem-Bï¼šMythological-IV" class="headerlink" title="Problem Bï¼šMythological IV"></a>Problem Bï¼šMythological IV</h2><h2 id="Problem-Cï¼šMythological-VII"><a href="#Problem-Cï¼šMythological-VII" class="headerlink" title="Problem Cï¼šMythological VII"></a>Problem Cï¼šMythological VII</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>æ•°è½´ä¸Šæœ‰ä¸€è¡Œ $n$ ä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹æœ‰æƒå€¼ã€‚å°Må’Œå°Såœ¨ä¸Šé¢ç©æ¸¸æˆã€‚</p><p>å°Må’Œå°Sä¸€å¼€å§‹éƒ½åœ¨ç¬¬ $k$ å·ç‚¹ä¸Šï¼Œå°Måªèƒ½å‘å·¦ç§»åŠ¨ï¼Œå°Såªèƒ½å‘å³ç§»åŠ¨ã€‚</p><p>ä»¤ $p_x$ è¡¨ç¤ºå½“å‰æ—¶åˆ»å°Mçš„ä½ç½®ï¼Œ$p_y$ è¡¨ç¤ºå½“å‰æ—¶åˆ»å°Sçš„ä½ç½®ï¼Œè¦æ±‚ä»»æ„æ—¶åˆ»éƒ½æ»¡è¶³ $(p_x, p_y]$ è¿™ä¸ªåŒºé—´çš„æ‰€æœ‰æ•°å’Œéƒ½ $\le 0$ã€‚</p><p>ç°åœ¨ï¼Œå°Mæƒ³è¦çŸ¥é“ $p_x, p_y$ èƒ½å¦åŒæ—¶ç­‰äº $1, n$ã€‚å¯æ€œçš„å°Må½“ç„¶ä¸ä¼šå•¦ï¼Œæ‰€ä»¥å¥¹å‘ä½ æ±‚åŠ©ã€‚</p><h3 id="æ•°æ®èŒƒå›´-1"><a href="#æ•°æ®èŒƒå›´-1" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le n \le 10^5, ~ T \le 20, ~ a_i \in [- 10^{13}, 10^{13}]$</p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>é¢˜ç›®æ˜¯è¦æ»¡è¶³å‰ç¼€å’Œ $sum_l \ge sum_r$</p><p>ä¸ <a href="https://colythme.github.io/2020/07/26/ã€ŒJOISC%202017%20Day%201ã€çƒŸèŠ±æ£’/">ã€ŒJOISC 2017 Day 1ã€çƒŸèŠ±æ£’</a> è´ªå¿ƒéƒ¨åˆ†æ˜¯ç›¸åŒçš„</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1e09</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N, K;</span><br><span class="line">LL a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (a[<span class="number">1</span>] &lt; a[N]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> l = K, r = K, ll = K, lr = K;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">if</span> (a[i] &gt;= a[ll])</span><br><span class="line">ll = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (a[i] &lt;= a[lr])</span><br><span class="line">lr = i;</span><br><span class="line"><span class="keyword">while</span> (l != ll || r != lr) &#123;</span><br><span class="line"><span class="keyword">int</span> pl, pr; <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (pl = l; pl &gt; ll; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pl - <span class="number">1</span>] &lt; a[r]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[-- pl] &gt;= a[l]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pl &lt; l &amp;&amp; a[pl] &gt;= a[l]) &#123; l = pl; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (pr = r; pr &lt; lr; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pr + <span class="number">1</span>] &gt; a[l]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[++ pr] &lt;= a[r]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pr &gt; r &amp;&amp; a[pr] &lt;= a[r]) &#123; r = pr; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (! suc) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">l = <span class="number">1</span>, r = N;</span><br><span class="line"><span class="keyword">while</span> (l != ll || r != lr) &#123;</span><br><span class="line"><span class="keyword">int</span> pl, pr; <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (pl = l; pl &lt; ll; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pl + <span class="number">1</span>] &lt; a[r]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[++ pl] &gt;= a[l]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pl &gt; l &amp;&amp; a[pl] &gt;= a[l]) &#123; l = pl; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (pr = r; pr &gt; lr; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pr - <span class="number">1</span>] &gt; a[l]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[-- pr] &lt;= a[r]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pr &lt; r &amp;&amp; a[pr] &lt;= a[r]) &#123; r = pr; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (! suc) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) a[i] += a[i - <span class="number">1</span>];</span><br><span class="line">solve () ? <span class="built_in">puts</span> (<span class="string">"Yes"</span>) : <span class="built_in">puts</span> (<span class="string">"No"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> 2-SAT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿ä¹é›†è®­ - NOIæ¨¡æ‹Ÿèµ›ï¼ˆä¸‰åä¸‰ï¼‰ã€Œè®¢æ­£æœªå®Œæˆã€</title>
      <link href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%89%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"/>
      <url>/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%89%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>æ²¡äº¤</p><p>$\text{scoreï¼šNULL            rkï¼šNULL}$</p><h2 id="Problem-Aï¼šåŒºé—´ç¬¬kå°"><a href="#Problem-Aï¼šåŒºé—´ç¬¬kå°" class="headerlink" title="Problem Aï¼šåŒºé—´ç¬¬kå°"></a>Problem Aï¼šåŒºé—´ç¬¬kå°</h2><h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/znS2C4hFuYj79VT.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/c8je9HNIn4CoEyW.png" alt=""></p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å…ˆè€ƒè™‘ç¦»çº¿ï¼Œæ•´ä½“äºŒåˆ†ï¼ŒäºŒåˆ†ç­”æ¡ˆ $mid$ï¼Œå¤„ç†æ‰€æœ‰ $\le mid$ çš„æ•°ï¼Œé‚£ä¹ˆæ­¤æ—¶é—®é¢˜å°±è½¬åŒ–ä¸ºåœ¨åŒºé—´å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ $w$ çš„æ•°æœ‰å¤šå°‘ä¸ª</p><p>ä¸å¦¨å…³æ³¨æ¯ä¸ªæ•°å¯¹è¯¢é—®åŒºé—´ $[L, R]$ çš„è´¡çŒ®ï¼Œå¯¹æŸä¸ªæ•° $a$ï¼Œè‹¥å®ƒæ˜¯ä»å·¦å¾€å³å $w$ ä¸ªå‡ºç°ä¸º $a$ çš„æ•°ï¼Œåˆ™å®ƒçš„è´¡çŒ®ä¸º $1$ï¼Œè‹¥ä¸ºå€’æ•°ç¬¬ $w + 1$ ä¸ªåˆ™è´¡çŒ®ä¸º $- w$ï¼Œå‰©ä¸‹çš„è´¡çŒ®éƒ½ä¸º $0$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé¦–å…ˆæ€»å¤§å°ï¼ˆå³ä¸åˆ å»è¶…è¿‡ $w$ çš„ï¼‰ç®—å‡ºæ¥ï¼Œæ­¤æ—¶è®¡ç®—éœ€è¦åˆ å»çš„ï¼Œé˜Ÿåˆ—å¤§å°æœªåˆ° $w$ æ—¶æ²¡æœ‰éœ€è¦åˆ çš„ï¼Œè‹¥å¤§äº $w$ æ—¶æ¯æ¬¡å°±è®©é˜Ÿé¦–ç‚¹è´¡çŒ®å‡å» $w + 1$ï¼Œå½“ç„¶ä¹‹å‰å¤šå‡çš„è¿˜è¦åŠ å›æ¥</p><p>é‚£ä¹ˆç°åœ¨å°±å¯ä»¥è€ƒè™‘ä»ç¦»çº¿è½¬æˆåœ¨çº¿ï¼Œåœ¨æ•´ä½“äºŒåˆ†çš„è¿‡ç¨‹ä¸­æ¯ä¸€å±‚ï¼ˆå³æ¯ä¸€æ¬¡äºŒåˆ†çš„ $[l, r]$ï¼‰éƒ½ä¼šå»ºä¸€äº›å¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼Œè€Œå®ƒåˆæœ€å¤šä¼šä¿®æ”¹ $O (n \log n)$ æ¬¡ï¼Œå¼€ $O (n \log^2 n)$ ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥æŠŠæ¯ä¸€å±‚çš„å¯æŒä¹…åŒ–çº¿æ®µæ ‘éƒ½å­˜ä¸‹æ¥ï¼Œåœ¨çº¿äºŒåˆ†æ—¶å³å¯ç›´æ¥æŸ¥æ‰¾ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ $O (n \log^2 n)$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lp p &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rp p &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN * MAXL * MAXL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, W, Q, type;</span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> lson[MAXM]= &#123;<span class="number">0</span>&#125;, rson[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> subsum[MAXM]= &#123;<span class="number">0</span>&#125;, nd = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> pre, <span class="keyword">int</span>&amp; p, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">lson[p = ++ nd] = lson[pre], rson[p] = rson[pre];</span><br><span class="line">subsum[p] = subsum[pre] + x;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) modify (lson[pre], lson[p], left, mid, posi, x);</span><br><span class="line"><span class="keyword">else</span> modify (rson[pre], rson[p], mid + <span class="number">1</span>, right, posi, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi)</span> </span>&#123; <span class="comment">// &gt;= posiçš„å’Œ</span></span><br><span class="line"><span class="keyword">if</span> (right &lt; posi) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= left) <span class="keyword">return</span> subsum[p];</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) <span class="keyword">return</span> subsum[rson[p]] + query (lson[p], left, mid, posi);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> query (rson[p], mid + <span class="number">1</span>, right, posi);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rt[MAXN &lt;&lt; <span class="number">2</span>], posi[MAXL + <span class="number">10</span>], use[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que[MAXN];</span><br><span class="line"><span class="keyword">int</span> ldel[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> p, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>, n = posi[d].size();</span><br><span class="line">use[p].resize(n); posi[d + <span class="number">1</span>].clear(), posi[d + <span class="number">1</span>].push_back(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = posi[d][i];</span><br><span class="line"><span class="keyword">if</span> (a[t] &lt;= mid) &#123;</span><br><span class="line">posi[d + <span class="number">1</span>].push_back(t);</span><br><span class="line">use[p][i] = use[p][i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">ldel[a[t]] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> use[p][i] = use[p][i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lim = posi[d + <span class="number">1</span>].size();</span><br><span class="line">rt[p].resize(lim);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; lim; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = posi[d + <span class="number">1</span>][i], x = a[t];</span><br><span class="line">que[x].push(i);</span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">int</span>) que[x].size() &gt; W) &#123;</span><br><span class="line">modify (rt[p][i - <span class="number">1</span>], rt[p][i], <span class="number">1</span>, lim - <span class="number">1</span>, que[x].front(), - W - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (ldel[x]) modify (rt[p][i], rt[p][i], <span class="number">1</span>, lim - <span class="number">1</span>, ldel[x], W);</span><br><span class="line">ldel[x] = que[x].front(); que[x].pop();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> rt[p][i] = rt[p][i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; lim; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = posi[d + <span class="number">1</span>][i], x = a[t];</span><br><span class="line"><span class="keyword">while</span> (! que[x].empty()) que[x].pop();</span><br><span class="line">&#125;</span><br><span class="line">build (left, mid, lp, d + <span class="number">1</span>);</span><br><span class="line">posi[d + <span class="number">1</span>].clear(), posi[d + <span class="number">1</span>].push_back(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = posi[d][i];</span><br><span class="line"><span class="keyword">if</span> (a[t] &gt; mid) posi[d + <span class="number">1</span>].push_back(t);</span><br><span class="line">&#125;</span><br><span class="line">build (mid + <span class="number">1</span>, right, rp, d + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> left;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> l = use[p][L], r = use[p][R], n = rt[p].size();</span><br><span class="line"><span class="keyword">int</span> sum = r - l + query (rt[p][r], <span class="number">1</span>, n - <span class="number">1</span>, l + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (sum &gt;= k) <span class="keyword">return</span> solve (lp, left, mid, l, r, k);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> solve (rp, mid + <span class="number">1</span>, right, L - l, R - r, k - sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), W = getnum (), Q = getnum (), type = getnum ();</span><br><span class="line">posi[<span class="number">1</span>].resize(N + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123; a[i] = getnum (); posi[<span class="number">1</span>][i] = i; &#125;</span><br><span class="line">build (<span class="number">0</span>, N, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> xxo = type * ans;</span><br><span class="line"><span class="keyword">int</span> l = getnum () ^ xxo, r = getnum () ^ xxo, k = getnum () ^ xxo;</span><br><span class="line">ans = solve (<span class="number">1</span>, <span class="number">0</span>, N, l - <span class="number">1</span>, r, k);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-Bï¼šæ±‚å’Œ"><a href="#Problem-Bï¼šæ±‚å’Œ" class="headerlink" title="Problem Bï¼šæ±‚å’Œ"></a>Problem Bï¼šæ±‚å’Œ</h2><h3 id="é¢˜é¢-1"><a href="#é¢˜é¢-1" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/eBd1iKnvg7Gf92A.png" alt=""></p><p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/YW1rji2cIUylMm5.png" alt=""></p><h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>é¦–å…ˆå¯¹å¼å­è¿›è¡Œå˜æ¢<br>$$<br>\begin{aligned}<br>ans &amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^n\sum\limits_{d = 1}^k f_d(gcd(i, j)) \\<br>&amp;= \sum\limits_{x = 1}^n\sum\limits_{d = 1}^k f_d(x)\sum\limits_{i = 1}^{\lfloor\frac{n}{x}\rfloor}\sum\limits_{j = 1}^{\lfloor\frac{n}{x}\rfloor}[(i, j) = 1] \\<br>&amp;= \sum\limits_{x = 1}^n\sum\limits_{d = 1}^k f_d(x)\left((2\sum\limits_{i = 1}^{\lfloor\frac{n}{x}\rfloor}\varphi(i)) - 1\right)<br>\end{aligned}<br>$$<br>é‚£ä¹ˆè¿™æ—¶å¯¹ $n$ æ•´é™¤åˆ†å—åˆ°ï¼Œ$\sum\limits_{i = 1}^n \varphi(i)$ å°±å¯ä»¥ç›´æ¥æœæ•™ç­›æ±‚å‡ºï¼Œè®¾æ­¤æ—¶åˆ†å—åˆ° $[l, r]$ï¼Œç°åœ¨è€ƒè™‘æ±‚è§£ $\sum\limits_{x = l}^r\sum\limits_{d = 1}^k f_d(x)$ï¼Œå½“ç„¶å‰ç¼€å’Œæ˜¯è‚¯å®šçš„</p><p>ä»¤ $F_d(x) = \sum\limits_{i = 1}^n f_d(i)$ï¼Œè®¾è´¨å› æ•°åˆ†è§£ $n = \prod\limits_i p_i^{c_i}$ï¼Œä»¤ $\lambda(x) = \prod\limits_i (- 1)^{c_i}$ï¼Œ$F_d(x)$ åˆ™å¯ä»¥é€šè¿‡å®¹æ–¥æ±‚å‡º<br>$$<br>\begin{aligned}<br>F_d(x) &amp;= \sum\limits_{i = 1}^x \mu(i)\sum\limits_{j = 1}^{\lfloor\frac{x}{i^{d + 1}}\rfloor}\lambda(i^{d + 1}j) \\<br>&amp;= \sum\limits_{i = 1}^x \lambda^{d + 1}(i)\mu(i)\sum\limits_{j = 1}^{\lfloor\frac{x}{i^{d + 1}}\rfloor}\lambda(j)<br>\end{aligned}<br>$$<br>ç¬¬ä¸€æ­¥å®é™…ä¸Šå°±æ˜¯ç±»ä¼¼æ±‚ $n$ ä»¥å†…æ— å¹³æ–¹å› å­æ•°çš„æ–¹æ³•ï¼Œ$i = 1$ æ—¶ä¸ºæ€»æ–¹æ¡ˆï¼Œåé¢å®¹æ–¥åˆ å»ä¸åˆæ³•</p><p>è€Œç¬¬äºŒæ­¥æ˜¯å› ä¸º $\lambda(x)$ æ˜¯ä¸€ä¸ªå®Œå…¨ç§¯æ€§å‡½æ•°</p><p>ç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºæ±‚ $\sum\limits_{i = 1}^n \lambda(i)$ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªæ€§è´¨ï¼Œ$\sum\limits_{d |n} \lambda(i) = [nä¸ºå®Œå…¨å¹³æ–¹æ•°]$</p><p>ä¸‹é¢ç»™å‡ºè¯æ˜</p><ul><li>è®¾ $n = \prod\limits_i p_i^{c_i}$ï¼Œè€ƒè™‘ä¸¤ä¸ªæ•° $p_1^2x, p_1^3x$ï¼Œæ»¡è¶³ $p_1^2x, p_1^3x | n$ï¼Œè‹¥ $p_1^2x$ çš„è´¡çŒ®ä¸º $1$ï¼Œé‚£ä¹ˆ $p_1^3x$ çš„è´¡çŒ®åˆ™ä¸€å®šä¸º $- 1$ï¼Œé‚£ä¹ˆä»¥æ­¤ç±»æ¨ï¼Œä¹Ÿå°±æ˜¯ $0, 1$ æ¬¡ã€$2, 3$ æ¬¡ã€$4, 5$ æ¬¡â€¦åˆ†åˆ«ä¸¤ä¸¤é…å¯¹ï¼Œè‹¥ $c_i$ ä¸ºå¥‡æ•°ï¼Œåˆ™æœ€åè´¡çŒ®æ€»å’Œä¸€å®šä¸º $0$ï¼Œè‹¥ä¸ºå¶æ•°ï¼Œæœ€ååˆ™ä¸€å®šä¸º $1$</li></ul><p>è¿™æ ·çš„è¯å°±æ˜¯ $\sqrt n = \lambda * 1$ï¼Œå°±å¯ä»¥æœæ•™ç­›äº†</p><p>é‚£ä¹ˆå¯¹ $F_d(x)$ï¼Œç±»ä¼¼æœæ•™ç­›é¢„å¤„ç† $x$ æ¯”è¾ƒå°çš„ï¼ˆæ³¨æ„ç”¨åŸå¼ï¼Œå³ $F_d(x) = \sum\limits_{i = 1}^n f_d(i)$ æ¥é¢„å¤„ç†ï¼‰ï¼Œç„¶åå¤§çš„å°±ç›´æ¥æš´åŠ›æšä¸¾ï¼Œæœ€å¤š $O (\sqrt n)$ï¼Œé‚£ä¹ˆè¿™æ ·æ€»æ—¶é—´å¤æ‚åº¦æ˜¯ $O (n^{\frac23})$ çš„</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1073741824</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4e06</span> + <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">3000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL N; <span class="keyword">int</span> K;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN / <span class="number">10</span>], pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line">uint mu[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">uint phi[MAXN]= &#123;<span class="number">0</span>&#125;, sphi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">uint lamda[MAXN]= &#123;<span class="number">0</span>&#125;, suml[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">uint sumf[MAXN]= &#123;<span class="number">0</span>&#125;; <span class="comment">// sumf(x): Î£(d=1~k)f[d](x)</span></span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;, b[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">4e06</span> + <span class="number">5e05</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">mu[<span class="number">1</span>] = phi[<span class="number">1</span>] = lamda[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">sumf[<span class="number">1</span>] = K;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! visit[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">mu[i] = - <span class="number">1</span>;</span><br><span class="line">phi[i] = i - <span class="number">1</span>, lamda[i] = - <span class="number">1</span>;</span><br><span class="line">a[i] = b[i] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">visit[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j])) &#123;</span><br><span class="line">phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line">lamda[i * prime[j]] = - lamda[i];</span><br><span class="line">a[i * prime[j]] = a[i] + <span class="number">1</span>;</span><br><span class="line">b[i * prime[j]] = max (a[i * prime[j]], b[i]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">mu[i * prime[j]] = - mu[i];</span><br><span class="line">phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</span><br><span class="line">lamda[i * prime[j]] = - lamda[i];</span><br><span class="line">a[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">b[i * prime[j]] = b[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line">suml[i] = suml[i - <span class="number">1</span>] + lamda[i];</span><br><span class="line">sphi[i] = sphi[i - <span class="number">1</span>] + phi[i];</span><br><span class="line">sumf[i] = sumf[i - <span class="number">1</span>]  + lamda[i] * max (<span class="number">0</span>, K - max (b[i], <span class="number">1</span>) + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vp[MAXM]= &#123;<span class="literal">false</span>&#125;, vl[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line">uint sp[MAXM], sl[MAXM];</span><br><span class="line"><span class="function">uint <span class="title">phi_sieve</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sphi[n];</span><br><span class="line"><span class="keyword">if</span> (vp[N / n]) <span class="keyword">return</span> sp[N / n];</span><br><span class="line">uint ret = n * (n + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">ret -= <span class="number">1u</span> * (r - l + <span class="number">1</span>) * phi_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line">vp[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> sp[N / n] = ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">uint <span class="title">lamda_sieve</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> suml[n];</span><br><span class="line"><span class="keyword">if</span> (vl[N / n]) <span class="keyword">return</span> sl[N / n];</span><br><span class="line">uint ret = <span class="built_in">sqrt</span> (n);</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">ret -= <span class="number">1u</span> * (r - l + <span class="number">1</span>) * lamda_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line">vl[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> sl[N / n] = ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL mpow[MAXL][<span class="number">42</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> lim = <span class="built_in">sqrt</span> (N) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lim; i ++) &#123;</span><br><span class="line">mpow[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K + <span class="number">1</span>; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (mpow[i][j - <span class="number">1</span>] &gt; N) <span class="keyword">break</span>;</span><br><span class="line">mpow[i][j] = mpow[i][j - <span class="number">1</span>] * i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vf[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line">uint sf[MAXM];</span><br><span class="line"><span class="function">uint <span class="title">work</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sumf[n];</span><br><span class="line"><span class="keyword">if</span> (vf[N / n]) <span class="keyword">return</span> sf[N / n];</span><br><span class="line">uint ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">1</span>; d &lt;= K; d += <span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; mpow[i][d + <span class="number">1</span>] &amp;&amp; mpow[i][d + <span class="number">1</span>] &lt;= n; i ++)</span><br><span class="line">ret += mu[i] * lamda_sieve (n / mpow[i][d + <span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">2</span>; d &lt;= K; d += <span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; mpow[i][d + <span class="number">1</span>] &amp;&amp; mpow[i][d + <span class="number">1</span>] &lt;= n; i ++)</span><br><span class="line">ret += lamda[i] * mu[i] * lamda_sieve (n / mpow[i][d + <span class="number">1</span>]);</span><br><span class="line">vf[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> sf[N / n] = ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K;</span><br><span class="line">init (); sieve ();</span><br><span class="line">uint ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">1</span>, r; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = N / (N / l);</span><br><span class="line">ans += (<span class="number">2u</span> * phi_sieve (N / l) - <span class="number">1</span>) * (work (r) - work (l - <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans % MOD &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Problem-C-æ ‘"><a href="#Problem-C-æ ‘" class="headerlink" title="Problem C: æ ‘"></a>Problem C: æ ‘</h2>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è«æ¯”ä¹Œæ–¯åæ¼” </tag>
            
            <tag> æœæ•™ç­› </tag>
            
            <tag> é›†è®­ </tag>
            
            <tag> æ•´ä½“äºŒåˆ† </tag>
            
            <tag> å¯æŒä¹…åŒ–çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘æ±‚æ ‘çš„ç›´å¾„</title>
      <link href="/2020/08/04/%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%B1%82%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84/"/>
      <url>/2020/08/04/%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%B1%82%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>çº¿æ®µæ ‘æ±‚ç›´å¾„å¯ä»¥æ±‚ä»»æ„å­æ ‘ï¼ˆåŒ…æ‹¬è¿å­æ ‘éƒ½ä¸ç®—çš„åˆ†æ•£èŠ‚ç‚¹é›†åˆï¼‰çš„ç›´å¾„ï¼Œé€‚ç”¨èŒƒå›´å¹¿ã€‚</p><p>çº¿æ®µæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹æ‰€å¯¹åº”çš„åŒºé—´$[L, R]$ï¼ŒæŒ‡ä»£äº†$Dfn$åœ¨$[L, R]$å†…èŠ‚ç‚¹ï¼Œå…¶ä¸­çº¿æ®µæ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨äº†$diam$ï¼ˆå½“å‰åŒºé—´ç›´å¾„ï¼‰åŠ$lp,  rp$ï¼ˆå½“å‰ç›´å¾„å¯¹åº”çš„å·¦å³ç«¯ç‚¹ï¼‰ï¼Œæ¯æ¬¡$Merge$æ“ä½œåˆ†ä¸ºå…¨å·¦åŒºé—´ã€å…¨å³åŒºé—´å’Œæ¨ªè·¨ä¸¤ä¸ªåŒºé—´ä½œè®¨è®ºï¼Œå¯¹äºç¬¬ä¸‰ç§æƒ…å†µï¼Œé€‰æ‹©ä¸¤ä¾§åŸç›´å¾„ç«¯ç‚¹æ±‚$Dist$å–æœ€å€¼å³å¯ï¼Œæ­£ç¡®æ€§æ˜¾ç„¶ï¼ŒæŸ¥è¯¢ç›´æ¥é€šè¿‡$Dfn$æŸ¥è¯¢å³å¯ã€‚</p><p>å½“ç„¶å¯èƒ½æœ‰ä¸€äº›åŒºé—´å†…çš„ç‚¹ä¸è¿é€šï¼Œå…ˆå½“ä½œå®ƒä»¬è¿é€šå³å¯ã€‚</p><p>å¯¹äºåˆ é™¤æŸäº›å­æ ‘ï¼Œç›¸å½“äºæŠŠæ•´æ£µæ ‘åˆ†ä¸º$n$éƒ¨åˆ†ï¼ŒæŸ¥è¯¢æ¯ä¸ªéƒ¨åˆ†ï¼Œå…¨éƒ¨$Merge$èµ·æ¥å³å¯ã€‚</p><h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><p><a href="https://www.luogu.org/problemnew/show/T55282" target="_blank" rel="noopener">Snowçš„è¿½å¯»</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line">  <span class="number">2</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line">  <span class="number">3</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line">  <span class="number">4</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line">  <span class="number">5</span> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line">  <span class="number">6</span> </span><br><span class="line">  <span class="number">7</span> <span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line">  <span class="number">8</span> <span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line">  <span class="number">9</span> </span><br><span class="line"> <span class="number">10</span> <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> <span class="number">11</span> </span><br><span class="line"> <span class="number">12</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"> <span class="number">13</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"> <span class="number">14</span> </span><br><span class="line"> <span class="number">15</span> <span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"> <span class="number">16</span>     <span class="keyword">int</span> to;</span><br><span class="line"> <span class="number">17</span> </span><br><span class="line"> <span class="number">18</span>     <span class="keyword">int</span> next;</span><br><span class="line"> <span class="number">19</span> &#125; ;</span><br><span class="line"> <span class="number">20</span> </span><br><span class="line"> <span class="number">21</span> LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"> <span class="number">22</span> <span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> <span class="number">23</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"> <span class="number">24</span> </span><br><span class="line"> <span class="number">25</span> <span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line"> <span class="number">26</span>     Link[++ size].to = v;</span><br><span class="line"> <span class="number">27</span>     Link[size].next = Head[u];</span><br><span class="line"> <span class="number">28</span> </span><br><span class="line"> <span class="number">29</span>     Head[u] = size;</span><br><span class="line"> <span class="number">30</span> &#125;</span><br><span class="line"> <span class="number">31</span> </span><br><span class="line"> <span class="number">32</span> <span class="keyword">const</span> <span class="keyword">int</span> Root = <span class="number">1</span>;</span><br><span class="line"> <span class="number">33</span> </span><br><span class="line"> <span class="number">34</span> <span class="keyword">int</span> Deep[MAXN];</span><br><span class="line"> <span class="number">35</span> <span class="keyword">int</span> Size[MAXN];</span><br><span class="line"> <span class="number">36</span> <span class="keyword">int</span> Val[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"> <span class="number">37</span> <span class="keyword">int</span> Dfn[MAXN], DDfn[MAXN];</span><br><span class="line"> <span class="number">38</span> <span class="keyword">int</span> Rank[MAXN];</span><br><span class="line"> <span class="number">39</span> <span class="keyword">int</span> dfsord = <span class="number">0</span>, dod2 = <span class="number">0</span>;</span><br><span class="line"> <span class="number">40</span> </span><br><span class="line"> <span class="number">41</span> <span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line"> <span class="number">42</span>     Size[root] = <span class="number">1</span>;</span><br><span class="line"> <span class="number">43</span>     Dfn[root] = ++ dfsord;</span><br><span class="line"> <span class="number">44</span>     Rank[dfsord] = root;</span><br><span class="line"> <span class="number">45</span>     DDfn[root] = ++ dod2;</span><br><span class="line"> <span class="number">46</span>     Val[dod2] = Deep[root];</span><br><span class="line"> <span class="number">47</span>     <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"> <span class="number">48</span>         <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"> <span class="number">49</span>         <span class="keyword">if</span> (v == father)</span><br><span class="line"> <span class="number">50</span>             <span class="keyword">continue</span>;</span><br><span class="line"> <span class="number">51</span> </span><br><span class="line"> <span class="number">52</span>         Deep[v] = Deep[root] + <span class="number">1</span>;</span><br><span class="line"> <span class="number">53</span>         DFS (v, root);</span><br><span class="line"> <span class="number">54</span>         Size[root] += Size[v];</span><br><span class="line"> <span class="number">55</span>         Val[++ dod2] = Deep[root];</span><br><span class="line"> <span class="number">56</span>     &#125;</span><br><span class="line"> <span class="number">57</span> &#125;</span><br><span class="line"> <span class="number">58</span> </span><br><span class="line"> <span class="number">59</span> <span class="keyword">int</span> ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">30</span>];</span><br><span class="line"> <span class="number">60</span> </span><br><span class="line"> <span class="number">61</span> <span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"> <span class="number">62</span>     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dod2; i ++)</span><br><span class="line"> <span class="number">63</span>         ST[i][<span class="number">0</span>] = Val[i];</span><br><span class="line"> <span class="number">64</span>     <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">20</span>; j ++)</span><br><span class="line"> <span class="number">65</span>         <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dod2; i ++)</span><br><span class="line"> <span class="number">66</span>             <span class="keyword">if</span> (i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)) &lt;= dod2)</span><br><span class="line"> <span class="number">67</span>                 ST[i][j] = min (ST[i][j - <span class="number">1</span>], ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line"> <span class="number">68</span> &#125;</span><br><span class="line"> <span class="number">69</span> </span><br><span class="line"> <span class="number">70</span> <span class="function"><span class="keyword">int</span> <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"> <span class="number">71</span>     <span class="keyword">int</span> k = log2 (R - L + <span class="number">1</span>);</span><br><span class="line"> <span class="number">72</span>     <span class="keyword">return</span> min (ST[L][k], ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line"> <span class="number">73</span> &#125;</span><br><span class="line"> <span class="number">74</span> </span><br><span class="line"> <span class="number">75</span> <span class="function"><span class="keyword">int</span> <span class="title">Dist</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"> <span class="number">76</span>     <span class="keyword">if</span> (DDfn[x] &gt; DDfn[y])</span><br><span class="line"> <span class="number">77</span>         swap (x, y);</span><br><span class="line"> <span class="number">78</span> </span><br><span class="line"> <span class="number">79</span>     <span class="keyword">int</span> deeplca = Query (DDfn[x], DDfn[y]);</span><br><span class="line"> <span class="number">80</span>     <span class="keyword">return</span> Deep[x] + Deep[y] - <span class="number">2</span> * deeplca;</span><br><span class="line"> <span class="number">81</span> &#125;</span><br><span class="line"> <span class="number">82</span> </span><br><span class="line"> <span class="number">83</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line"> <span class="number">84</span>     <span class="keyword">int</span> diam;</span><br><span class="line"> <span class="number">85</span>     <span class="keyword">int</span> lp, rp;</span><br><span class="line"> <span class="number">86</span> </span><br><span class="line"> <span class="number">87</span>     Node () &#123;</span><br><span class="line"> <span class="number">88</span>         diam = <span class="number">0</span>;</span><br><span class="line"> <span class="number">89</span>         lp = rp = <span class="number">0</span>;</span><br><span class="line"> <span class="number">90</span>     &#125;</span><br><span class="line"> <span class="number">91</span> </span><br><span class="line"> <span class="number">92</span>     Node (<span class="keyword">int</span> fdiam, <span class="keyword">int</span> flp, <span class="keyword">int</span> frp) :</span><br><span class="line"> <span class="number">93</span>         diam (fdiam), lp (flp), rp (frp) &#123;&#125;</span><br><span class="line"> <span class="number">94</span> &#125; ;</span><br><span class="line"> <span class="number">95</span> </span><br><span class="line"> <span class="number">96</span> Node Tree[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"> <span class="number">97</span> </span><br><span class="line"> <span class="number">98</span> </span><br><span class="line"> <span class="number">99</span> <span class="function">Node <span class="title">Merge</span> <span class="params">(Node s1, Node s2)</span> </span>&#123;</span><br><span class="line"><span class="number">100</span>     <span class="keyword">if</span> (s1.diam == - <span class="number">1</span>)</span><br><span class="line"><span class="number">101</span>         <span class="keyword">return</span> s2;</span><br><span class="line"><span class="number">102</span>     Node news = s1.diam &gt;= s2.diam ? s1 : s2; <span class="comment">// ä»¥ä¸‹è®¨è®º</span></span><br><span class="line"><span class="number">103</span>     <span class="keyword">if</span> (Dist (s1.lp, s2.lp) &gt; news.diam)</span><br><span class="line"><span class="number">104</span>         news = Node (Dist (s1.lp, s2.lp), s1.lp, s2.lp);</span><br><span class="line"><span class="number">105</span>     <span class="keyword">if</span> (Dist (s1.lp, s2.rp) &gt; news.diam)</span><br><span class="line"><span class="number">106</span>         news = Node (Dist (s1.lp, s2.rp), s1.lp, s2.rp);</span><br><span class="line"><span class="number">107</span>     <span class="keyword">if</span> (Dist (s1.rp, s2.lp) &gt; news.diam)</span><br><span class="line"><span class="number">108</span>         news = Node (Dist (s1.rp, s2.lp), s1.rp, s2.lp);</span><br><span class="line"><span class="number">109</span>     <span class="keyword">if</span> (Dist (s1.rp, s2.rp) &gt; news.diam)</span><br><span class="line"><span class="number">110</span>         news = Node (Dist (s1.rp, s2.rp), s1.rp, s2.rp);</span><br><span class="line"><span class="number">111</span> </span><br><span class="line"><span class="number">112</span>     <span class="keyword">return</span> news;</span><br><span class="line"><span class="number">113</span> &#125;</span><br><span class="line"><span class="number">114</span> </span><br><span class="line"><span class="number">115</span> <span class="function"><span class="keyword">void</span> <span class="title">Build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line"><span class="number">116</span>     Tree[root] = Node ();</span><br><span class="line"><span class="number">117</span> </span><br><span class="line"><span class="number">118</span>     <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line"><span class="number">119</span>         Tree[root].diam = <span class="number">0</span>;</span><br><span class="line"><span class="number">120</span>         Tree[root].lp = Tree[root].rp = Rank[left];</span><br><span class="line"><span class="number">121</span>         <span class="keyword">return</span> ;</span><br><span class="line"><span class="number">122</span>     &#125;</span><br><span class="line"><span class="number">123</span> </span><br><span class="line"><span class="number">124</span>     <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="number">125</span>     Build (lson, left, mid);</span><br><span class="line"><span class="number">126</span>     Build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line"><span class="number">127</span> </span><br><span class="line"><span class="number">128</span>     Tree[root] = Merge (Tree[lson], Tree[rson]);</span><br><span class="line"><span class="number">129</span> &#125;</span><br><span class="line"><span class="number">130</span> </span><br><span class="line"><span class="number">131</span> <span class="function">Node <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="number">132</span>     <span class="keyword">if</span> (L == left &amp;&amp; R == right)</span><br><span class="line"><span class="number">133</span>         <span class="keyword">return</span> Tree[root];</span><br><span class="line"><span class="number">134</span> </span><br><span class="line"><span class="number">135</span>     <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="number">136</span>     <span class="keyword">if</span> (R &lt;= mid)</span><br><span class="line"><span class="number">137</span>         <span class="keyword">return</span> Query (lson, left, mid, L, R);</span><br><span class="line"><span class="number">138</span>     <span class="keyword">else</span> <span class="keyword">if</span> (L &gt; mid)</span><br><span class="line"><span class="number">139</span>         <span class="keyword">return</span> Query (rson, mid + <span class="number">1</span>, right, L, R);</span><br><span class="line"><span class="number">140</span>     <span class="keyword">else</span></span><br><span class="line"><span class="number">141</span>         <span class="keyword">return</span> Merge (Query (lson, left, mid, L, mid), Query (rson, mid + <span class="number">1</span>, right, mid + <span class="number">1</span>, R));</span><br><span class="line"><span class="number">142</span> &#125;</span><br><span class="line"><span class="number">143</span> </span><br><span class="line"><span class="number">144</span> <span class="keyword">int</span> N, Q;</span><br><span class="line"><span class="number">145</span> </span><br><span class="line"><span class="number">146</span> <span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="number">147</span>     <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="number">148</span>     <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="number">149</span> </span><br><span class="line"><span class="number">150</span>     <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line"><span class="number">151</span>         ch = getchar ();</span><br><span class="line"><span class="number">152</span>     <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line"><span class="number">153</span>         num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="number">154</span> </span><br><span class="line"><span class="number">155</span>     <span class="keyword">return</span> num;</span><br><span class="line"><span class="number">156</span> &#125;</span><br><span class="line"><span class="number">157</span> </span><br><span class="line"><span class="number">158</span> <span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="number">159</span>     <span class="comment">// freopen ("Input.txt", "r", stdin);</span></span><br><span class="line"><span class="number">160</span> </span><br><span class="line"><span class="number">161</span>     N = getnum (), Q = getnum ();</span><br><span class="line"><span class="number">162</span> </span><br><span class="line"><span class="number">163</span>     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="number">164</span>         <span class="keyword">int</span> u, v;</span><br><span class="line"><span class="number">165</span>         u = getnum (), v = getnum ();</span><br><span class="line"><span class="number">166</span>         Insert (u, v), Insert (v, u);</span><br><span class="line"><span class="number">167</span>     &#125;</span><br><span class="line"><span class="number">168</span> </span><br><span class="line"><span class="number">169</span>     DFS (Root, <span class="number">0</span>);</span><br><span class="line"><span class="number">170</span>     RMQ ();</span><br><span class="line"><span class="number">171</span> </span><br><span class="line"><span class="number">172</span>     Build (Root, <span class="number">1</span>, dfsord);</span><br><span class="line"><span class="number">173</span>     <span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= Q; Case ++) &#123;</span><br><span class="line"><span class="number">174</span>         <span class="keyword">int</span> x, y;</span><br><span class="line"><span class="number">175</span>         x = getnum (), y = getnum ();</span><br><span class="line"><span class="number">176</span> </span><br><span class="line"><span class="number">177</span>         Node res = Node (- <span class="number">1</span>, - <span class="number">1</span>, - <span class="number">1</span>);</span><br><span class="line"><span class="number">178</span>         <span class="keyword">if</span> (Dfn[x] &gt; Dfn[y])</span><br><span class="line"><span class="number">179</span>             swap (x, y);</span><br><span class="line"><span class="number">180</span>         <span class="keyword">int</span> sx = Dfn[x], ex = sx + Size[x] - <span class="number">1</span>;</span><br><span class="line"><span class="number">181</span>         <span class="keyword">int</span> sy = Dfn[y], ey = sy + Size[y] - <span class="number">1</span>;</span><br><span class="line"><span class="number">182</span>         <span class="keyword">if</span> (sx &gt; <span class="number">1</span>) <span class="comment">// ç¬¬ä¸€éƒ¨åˆ†</span></span><br><span class="line"><span class="number">183</span>             res = Merge (res, Query (Root, <span class="number">1</span>, dfsord, <span class="number">1</span>, sx - <span class="number">1</span>));</span><br><span class="line"><span class="number">184</span>         <span class="keyword">if</span> (ex + <span class="number">1</span> &lt; sy) <span class="comment">// ç¬¬äºŒéƒ¨åˆ†</span></span><br><span class="line"><span class="number">185</span>             res = Merge (res, Query (Root, <span class="number">1</span>, dfsord, ex + <span class="number">1</span>, sy - <span class="number">1</span>));</span><br><span class="line"><span class="number">186</span>         <span class="keyword">int</span> fen = max (ex, ey);</span><br><span class="line"><span class="number">187</span>         <span class="keyword">if</span> (fen &lt; dfsord) <span class="comment">// ç¬¬ä¸‰éƒ¨åˆ†</span></span><br><span class="line"><span class="number">188</span>             res = Merge (res, Query (Root, <span class="number">1</span>, dfsord, fen + <span class="number">1</span>, dfsord));</span><br><span class="line"><span class="number">189</span>         <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, res.diam == - <span class="number">1</span> ? <span class="number">0</span> : res.diam);</span><br><span class="line"><span class="number">190</span>     &#125;</span><br><span class="line"><span class="number">191</span> </span><br><span class="line"><span class="number">192</span>     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">193</span> &#125;</span><br><span class="line"><span class="number">194</span> </span><br><span class="line"><span class="number">195</span> <span class="comment">/*</span></span><br><span class="line"><span class="comment">196 5 2</span></span><br><span class="line"><span class="comment">197 1 3</span></span><br><span class="line"><span class="comment">198 3 2</span></span><br><span class="line"><span class="comment">199 3 4</span></span><br><span class="line"><span class="comment">200 2 5</span></span><br><span class="line"><span class="comment">201 2 4</span></span><br><span class="line"><span class="comment">202 5 4</span></span><br><span class="line"><span class="comment">203 */</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç«èµ›å›¾æŸ“è‰²</title>
      <link href="/2020/08/04/%E7%AB%9E%E8%B5%9B%E5%9B%BE%E6%9F%93%E8%89%B2/"/>
      <url>/2020/08/04/%E7%AB%9E%E8%B5%9B%E5%9B%BE%E6%9F%93%E8%89%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote><p>ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹çš„ç«èµ›å›¾ï¼Œç»™è¯¥å›¾çš„æ¯æ¡è¾¹æŸ“è‰²ï¼Œé¢œè‰²æ•°é‡ä¸èƒ½è¶…è¿‡ $m$ ä¸ªï¼Œä¸€ä¸ªæŸ“è‰²åˆæ³•å½“ä¸”ä»…å½“ä¸å­˜åœ¨é•¿åº¦ä¸º $2$ çš„è·¯å¾„ï¼Œå³å¯¹æœ‰å‘å›¾ä¸­ä»»æ„è·¯å¾„ $i \rightarrow j \rightarrow k$ å‡æœ‰è¾¹ $i \rightarrow j$ å’Œè¾¹ $j \rightarrow k$ é¢œè‰²ä¸åŒ</p></blockquote><blockquote><p>$2 \le n \le 3000, ~ 2 \le m \le 26$</p></blockquote><p>è®¾è¯¥ç«èµ›å›¾ç‚¹é›† $V$</p><p>è€ƒè™‘æŸ“æ¯ä¸€ç§é¢œè‰²æ„å‘³ç€ä»€ä¹ˆï¼Œç›¸å½“äºé€‰æ‹©ä¸€ä¸ªç‚¹é›† $S \subseteq V$ï¼Œå°†æ‰€æœ‰è¾¹ $(u, v)$ æ»¡è¶³ $u \in S \cap v \in \complement_VS$ æŸ“ä¸Šè¯¥é¢œè‰²ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æ‰¾åˆ°è‡³å¤š $m$ ä¸ªè¿™æ ·çš„é›†åˆæ¥è¦†ç›–æ‰€æœ‰çš„è¾¹</p><p>è¿™æ ·å¯ä»¥ç»™å‡ºä¸€ä¸ª $m = 2\log n$ çš„æŸ“è‰²æ–¹æ¡ˆï¼Œå¯¹æ‰€æœ‰ç‚¹åˆ†æ²»ï¼Œæ¯æ¬¡ä¸€åˆ†ä¸ºäºŒï¼Œç»™ $S, \complement_V S$ ä¹‹é—´çš„è¾¹æŒ‰ä¸¤ç§æ–¹å‘æŸ“ä¸Šä¸åŒçš„é¢œè‰²ï¼Œè¿™æ ·æ€»å…±éœ€è¦é¢œè‰²æ˜¯ $2\log n$ çš„</p><p>ä½†å®é™…ä¸Šå¯ä»¥ç”¨äºŒè¿›åˆ¶æ¥è¡¨ç¤ºè¿™ç§æ˜¯å¦åœ¨æ¯ä¸ª $S$ ä¸­çš„å…³ç³»ï¼Œå¯¹æ¯ä¸ª $S_i$ï¼Œè‹¥å½“å‰ç‚¹ $u$ å¾—åˆ°çš„äºŒè¿›åˆ¶ä½ä¸º $1$ï¼Œåˆ™ä»£è¡¨ $u \in S_i$ï¼Œå¦åˆ™ $u \in \complement_VS_i$ï¼Œå³ä»£è¡¨ $i$ ä¸å­˜åœ¨é¢œè‰²ä¸º $i$ çš„å¤–å‘è¾¹ï¼Œé‚£ä¹ˆç‚¹ $i$ çš„é€‰æ‹©æ–¹æ¡ˆå¯ä»¥çœ‹ä½œ $\{1, 2, â€¦, m\}$ çš„ä¸€ä¸ªå­é›†ï¼Œè®¾ä¸º $A_i$ï¼Œæˆ‘ä»¬åˆ™è¦é€‰å‡º $n$ ä¸ªé›†åˆæ»¡è¶³ $\forall i, j$ï¼Œæœ‰ $\exists x, y, ~ x \in A_i, y \in A_j$ æ»¡è¶³ $x \notin A_j, y \notin A_i$</p><p>é‚£ä¹ˆä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ„é€ æ–¹æ³•å°±æ˜¯å–æ‰€æœ‰å¤§å°æ°ä¸º $\lfloor\frac{m}2\rfloor$ çš„é›†åˆï¼Œåˆ $\dbinom{14}{7} = 3432 \ge 3000$ï¼Œæ•…å®é™…ä¸Š $m \le 14$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3432</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">char</span> in[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sve[MAXN]= &#123;<span class="number">0</span>&#125;, m = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> lim = (<span class="number">1</span> &lt;&lt; M) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">0</span>; state &lt;= lim; state ++) &#123;</span><br><span class="line"><span class="keyword">int</span> cnt = __builtin_popcount (state);</span><br><span class="line"><span class="keyword">if</span> (cnt == (M &gt;&gt; <span class="number">1</span>)) sve[++ m] = state;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">if</span> (M &gt; <span class="number">14</span>) M = <span class="number">14</span>;</span><br><span class="line">work ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, in + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; M; k ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (in[j] == <span class="string">'1'</span> &amp;&amp; ((sve[i] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">1</span> &amp;&amp; ((sve[j] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="built_in">putchar</span> (k + <span class="string">'a'</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (in[j] == <span class="string">'0'</span> &amp;&amp; ((sve[i] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">0</span> &amp;&amp; ((sve[j] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="built_in">putchar</span> (k + <span class="string">'a'</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ€ç»´ </category>
          
          <category> å›¾è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ„é€  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”Ÿæˆå‡½æ•°ä¸ç»„åˆè®¡æ•°åˆæ­¥</title>
      <link href="/2020/08/04/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0%E5%88%9D%E6%AD%A5/"/>
      <url>/2020/08/04/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0%E5%88%9D%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>è¯¥æ–‡ä¸ºï¼ˆé‡‘ç­–ã€Šç”Ÿæˆå‡½æ•°çš„è¿ç®—ä¸ç»„åˆè®¡æ•°é—®é¢˜ã€‹ï¼‰å­¦ä¹ ç¬”è®°</p><h3 id="å¹‚çº§æ•°"><a href="#å¹‚çº§æ•°" class="headerlink" title="å¹‚çº§æ•°"></a>å¹‚çº§æ•°</h3><p>çº§æ•°ï¼šä¸€ä¸ªæœ‰ç©·æˆ–æ— ç©·åºåˆ— $a_0, a_1, a_2, â€¦$ çš„å½¢å¼å’Œã€Œå³ $\sum\limits_{i = 0} a_i$ã€è¢«ç§°ä¸ºçº§æ•°ï¼Œåºåˆ—ä¸­çš„é¡¹ç§°ä½œçº§æ•°çš„é€šé¡¹</p><p>æ•›æ•£æ€§ï¼šæé™æ˜¯æ— ç©·å³ä¸ºå‘æ•£ã€Œå¦‚ $f(x) = x$ã€ï¼›æé™ä¸ä¸ºæ— ç©·å³ä¸ºæ”¶æ•›ã€Œå¦‚ $f(x) = \frac{1}{x}$ã€</p><p>é‚£ä¹ˆå¹‚çº§æ•°å³ä¸ºå½¢å¦‚ $\sum\limits_{n = 0}^{\infty} a_n(x - c)^n$ æˆ–è€…åŒ–ç®€ä¸º $\sum\limits_{n = 0}^{\infty} a_nx^n$ çš„å½¢å¼</p><h3 id="å½¢å¼å¹‚çº§æ•°"><a href="#å½¢å¼å¹‚çº§æ•°" class="headerlink" title="å½¢å¼å¹‚çº§æ•°"></a>å½¢å¼å¹‚çº§æ•°</h3><p>å½¢å¼å¹‚çº§æ•°<br>$$<br>A(x) = \sum\limits_{n = 0}^{\infty} a_nx^n<br>$$<br>å½¢å¼ä¸å¹‚çº§æ•°å¾ˆåƒï¼Œä½†è¿™é‡Œ $x$ ä½œä¸ºä¸€ä¸ªç¬¦å·è€Œä¸ç”¨å…·ä½“æ•°å€¼å¸¦è¿›å»ç®—ï¼Œä¹Ÿä¸ç ”ç©¶æ•›æ•£æ€§ä»€ä¹ˆçš„</p><p>å½¢å¼å¹‚çº§æ•°çš„åŠ å‡ä¹˜æ³•ä¸å¤šé¡¹å¼çš„æœ‰ç€ç±»ä¼¼çš„å®šä¹‰</p><p>å®é™…è¿ç®—æ—¶ä¸€èˆ¬åœ¨ $\bmod{x^n}$ çš„æ„ä¹‰ä¸‹è¿›è¡Œï¼Œå³ä»…å–æ¬¡æ•°ä¸è¶…è¿‡ $n - 1$ çš„é¡¹</p><h3 id="ç¬›å¡å„¿ç§¯ã€Œç›´ç§¯ã€"><a href="#ç¬›å¡å„¿ç§¯ã€Œç›´ç§¯ã€" class="headerlink" title="ç¬›å¡å„¿ç§¯ã€Œç›´ç§¯ã€"></a>ç¬›å¡å„¿ç§¯ã€Œç›´ç§¯ã€</h3><p>æœ‰é›†åˆ $A, B$ï¼Œåˆ™ $A, B$ çš„ç¬›å¡å„¿ç§¯è®°ä½œ $A \times B$ï¼Œæ˜¯æ‰€æœ‰å¯èƒ½ç»„æˆçš„æœ‰åºå¯¹çš„é›†åˆï¼Œä¸”åˆ†åˆ«ä¸º $A, B$ çš„æˆå‘˜ï¼Œå³ $A \times B = \{(a, b) | a \in A \land b \in B\}$</p><ul><li><p>ç¬›å¡å„¿ç§¯ä¸€èˆ¬ä¸æ»¡è¶³äº¤æ¢å¾‹ä¸ç»“åˆå¾‹</p></li><li><p>ç¬›å¡å„¿ç§¯å¯¹é›†åˆçš„å¹¶å’Œäº¤æ»¡è¶³åˆ†é…å¾‹<br>$$<br>A \times (B \cup C) = (A \times B) \cup (A \times C) \\<br>A \times (B \cap C) = (A \times B) \cap (A \times C) \\<br>(A \times B) \cap (C \times D) = (A \cap C) \times (B \cap D)<br>$$</p></li></ul><h2 id="ç”Ÿæˆå‡½æ•°ä¸ç»„åˆè®¡æ•°"><a href="#ç”Ÿæˆå‡½æ•°ä¸ç»„åˆè®¡æ•°" class="headerlink" title="ç”Ÿæˆå‡½æ•°ä¸ç»„åˆè®¡æ•°"></a>ç”Ÿæˆå‡½æ•°ä¸ç»„åˆè®¡æ•°</h2><h3 id="ç»„åˆå¯¹è±¡"><a href="#ç»„åˆå¯¹è±¡" class="headerlink" title="ç»„åˆå¯¹è±¡"></a>ç»„åˆå¯¹è±¡</h3><p>åœ¨ç»„åˆè®¡æ•°é—®é¢˜ä¸­ï¼Œä¸€èˆ¬å®šä¹‰äº†ä¸€ç±»ç»„åˆå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯èƒ½æ˜¯æ»¡è¶³æŸä¸€æ€§è´¨çš„æ ‘ã€å›¾ç­‰çš„é›†åˆï¼Œä¸”ä¸€ç±»ç»„åˆå¯¹è±¡ $A$ å…¶ä¸­çš„å¯¹è±¡ $a \in A$ æœ‰å¤§å° $size(a)$ï¼Œé‚£ä¹ˆé€šå¸¸çš„è®¡æ•°ä»»åŠ¡å³ä¸ºæ±‚å‡º $A_n = (size (a) = n)$ çš„æ•°å€¼</p><p>ç»„åˆå¯¹è±¡åˆ†ä¸ºæœ‰æ ‡å·ä¸æ— æ ‡å·ï¼Œå°±æ¯”å¦‚ç»“ç‚¹æœ‰æ ‡å·çš„æ— å‘å›¾ä¸ªæ•°ä¸ç»“ç‚¹æ— æ ‡å·çš„æ— å‘å›¾ä¸ªæ•°</p><p><strong>è¿™ä¸€éƒ¨åˆ†éå¸¸é‡è¦ï¼Œå¯¹äºé¢˜ç›®å¿…é¡»å…ˆæ˜ç¡®ç»„åˆå¯¹è±¡ï¼Œæ‰å¯ä»¥é€šè¿‡ OGF æˆ– EGF çš„å…¬å¼æ¥è¿›è¡Œæ±‚è§£</strong></p><h3 id="æ™®é€šç”Ÿæˆå‡½æ•°ã€ŒOGFã€"><a href="#æ™®é€šç”Ÿæˆå‡½æ•°ã€ŒOGFã€" class="headerlink" title="æ™®é€šç”Ÿæˆå‡½æ•°ã€ŒOGFã€"></a>æ™®é€šç”Ÿæˆå‡½æ•°ã€ŒOGFã€</h3><p>æ•°åˆ— $A_0, A_1, A_2, â€¦$ çš„ OGF å®šä¹‰ä¸ºå½¢å¼å¹‚çº§æ•°<br>$$<br>A(x) = \sum\limits_{n = 0}^{\infty} A_nx^n<br>$$</p><p>å…¶ä¸­ï¼Œ$A$ æ˜¯ä¸€ç±»æ— æ ‡å·å¯¹è±¡ï¼Œ$A_n$ è¡¨ç¤ºæ»¡è¶³ $size(a) = n$ çš„å¯¹è±¡ $a \in A$ çš„æ•°é‡</p><p>æˆ–è€…å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œå¯¹äºé›†åˆ $A = \{A_0, A_1, A_2, â€¦\}$ï¼Œå…¶ä¸­ $A_i$ çš„å‡ºç°é›†åˆä¸º $M_i$ï¼Œé‚£ä¹ˆ $A$ çš„ OGF å³ä¸º $\prod\limits_{n = 0}^{\infty} \left(\sum\limits_{m \in M_n} x^m\right)$</p><p>è€ƒè™‘é›†åˆ $A, B$ çš„ç¬›å¡å„¿ç§¯ $D = A \times B$ï¼Œå¹¶æœ‰ $size(d) = size(a) + size(b)$ï¼Œé‚£ä¹ˆæ˜¾ç„¶<br>$$<br>D_k = \sum\limits_{i + j = k} A_iB_j<br>$$<br>åˆ™æœ‰<br>$$<br>D(x) = A(x)B(x)<br>$$</p><h4 id="ç”Ÿæˆå‡½æ•°-frac-1-1-x-n"><a href="#ç”Ÿæˆå‡½æ•°-frac-1-1-x-n" class="headerlink" title="ç”Ÿæˆå‡½æ•° $\frac{1}{(1 - x)^n}$"></a>ç”Ÿæˆå‡½æ•° $\frac{1}{(1 - x)^n}$</h4><p>è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ç”Ÿæˆå‡½æ•°ï¼Œæ¥ä¸‹æ¥è¯æ˜å®ƒçš„åŸæ•°åˆ—ä¸º<br>$$<br>\sum\limits_{k = 0}^{\infty} \dbinom{k + n - 1}{n - 1} x^k<br>$$<br>æœ‰ä¸¤ç§æ–¹æ³•</p><h5 id="è¯æ˜æ–¹æ³•ä¸€"><a href="#è¯æ˜æ–¹æ³•ä¸€" class="headerlink" title="è¯æ˜æ–¹æ³•ä¸€"></a>è¯æ˜æ–¹æ³•ä¸€</h5><p>é¦–å…ˆæ˜¾ç„¶<br>$$<br>\frac{1}{(1 - x)^n} = \prod_{i = 1}^n\left(\sum\limits_{k = 0}^{\infty} x^k\right)<br>$$<br>é‚£ä¹ˆä½¿ç”¨éš”æ¿æ³•å°±å¯ä»¥ç›´æ¥è¯æ˜äº†</p><h5 id="è¯æ˜æ–¹æ³•äºŒ"><a href="#è¯æ˜æ–¹æ³•äºŒ" class="headerlink" title="è¯æ˜æ–¹æ³•äºŒ"></a>è¯æ˜æ–¹æ³•äºŒ</h5><ul><li>ç»“è®ºï¼šè‹¥æ•°åˆ— $a_0, a_1, a_2, â€¦$ çš„ OGF æ˜¯ $A(x)$ï¼Œä»¤ $s_n = \sum\limits_{i = 0}^n a_i$ï¼Œåˆ™ $s_0, s_1, s_2, â€¦$ çš„ OGF $B(x)$ ä¸º $\frac{A(x)}{1 - x}$</li><li>è¯æ˜ï¼šæ˜¾ç„¶ $B(x) = \sum\limits_{n = 0}^{\infty} x^nA(x)$ï¼Œå¾—è¯</li></ul><p>é‚£ä¹ˆå¯¹äº $\frac{1}{(1 - x)^n}$ çš„ç³»æ•°æ¥è®²ï¼Œå‡å¦‚æŒ‰ç…§æ‹¬å·é¡ºåºåˆå¹¶ï¼Œé‚£ä¹ˆç¬¬ $n$ é¡¹çš„ç³»æ•°å°±æ˜¯ç¬¬ $n - 1$ é¡¹çš„ç³»æ•°åŠ ä¸Šä¸Šä¸€ç‰ˆçš„ç¬¬ $n$ é¡¹ç³»æ•°ï¼Œåˆåˆå§‹ç³»æ•°å…¨éƒ¨ä¸º $1$ï¼Œæ‰€ä»¥è¿™å°±æ˜¯æ¨è¾‰ä¸‰è§’çš„é€’æ¨å…³ç³»ï¼Œå¾—è¯</p><h3 id="æŒ‡æ•°ç”Ÿæˆå‡½æ•°ã€ŒEGFã€"><a href="#æŒ‡æ•°ç”Ÿæˆå‡½æ•°ã€ŒEGFã€" class="headerlink" title="æŒ‡æ•°ç”Ÿæˆå‡½æ•°ã€ŒEGFã€"></a>æŒ‡æ•°ç”Ÿæˆå‡½æ•°ã€ŒEGFã€</h3><p>æ•°åˆ— $A_0, A_1, A_2, â€¦$ çš„ EGF å®šä¹‰ä¸ºå½¢å¼å¹‚çº§æ•°<br>$$<br>A(x) = \sum\limits_{n = 0}^{\infty} A_n\frac{x^n}{n!}<br>$$<br>å…¶ä¸­ï¼Œ$A$ æ˜¯ä¸€ç±»æœ‰æ ‡å·å¯¹è±¡ï¼Œ$A_n$ çš„æ„ä¹‰åŒ OGF</p><p>OGF è¡¨ç¤ºçš„æ˜¯åºåˆ—ï¼Œè€Œ EGF è¡¨ç¤ºçš„æ˜¯é›†åˆï¼Œè€Œé›†åˆä¸åŒäºåºåˆ—çš„å°±æ˜¯å…¶æ²¡æœ‰é¡ºåºå…³ç³»ï¼Œæ•…éœ€é™¤ä»¥ $n!$</p><p>æ¢ä¸ªå±‚é¢ç†è§£ï¼Œå¯¹äºå¤šé‡é›† $A = \{\infty \times A_0, \infty \times A_1, \infty \times A_2, â€¦\}$</p><p>é¦–å…ˆå¤šé‡é›†çš„æ’åˆ—æ•°ä¸º $\frac{n!}{n_0!n_1!n_2!â€¦}$</p><p>åˆå…¶ä¸­ $A_i$ çš„å‡ºç°é›†åˆä¸º $M_i$ï¼Œé‚£ä¹ˆ $A$ çš„ EGF å³ä¸º $\prod\limits_{n = 0}^{\infty} \left(\sum\limits_{m \in M_n} \frac{x^m}{m!}\right)$</p><p>è¿™ä¸ªå¼å­å’Œä¸Šé¢é‚£ä¸ªå®šä¹‰å¼æ˜¯ä¸€æ ·çš„</p><p>åŒæ ·åœ°ï¼Œè€ƒè™‘æœ‰æ ‡å·å¯¹è±¡çš„æ‹¼æ¥ï¼Œä» $A, B$ ä¸­å„é€‰ $n, m$ ä»¶ï¼Œå› ä¸ºæ˜¯æœ‰æ ‡å·çš„ï¼Œæ‰€ä»¥éœ€è¦ä»¤å…¶ä¿æŒé¡ºåºï¼Œæ•…é€‰æ‹©æ–¹æ³•å…±æœ‰<br>$$<br>\dbinom{n + m}{n}<br>$$<br>ç§ï¼Œé‚£ä¹ˆ<br>$$<br>\begin{aligned}<br>D_k &amp;= \sum\limits_{i + j = k} a_ib_j\frac{k!}{i!j!} \\<br>\frac{D_k}{k!} &amp;= \sum\limits_{i + j = k} \frac{a_i}{i!}\frac{b_j}{j!}<br>\end{aligned}<br>$$<br>è¯´æ˜<br>$$<br>\begin{aligned}<br>D(x) &amp;= \sum\limits_{k = 0}^{\infty}\left(\sum\limits_{i = 0}^{\infty} \dbinom{k}{i} a_ib_{k - i}\right)\frac{x^k}{k!} \\<br>&amp;= \sum\limits_{k = 0}^{\infty}\sum\limits_{i = 0}^{\infty} \frac{a_i}{i!}\frac{b_{k - i}}{(k - i)!} \\<br>&amp;= A(x)B(x)<br>\end{aligned}<br>$$</p><h3 id="å¤šé¡¹å¼æ±‚é€†"><a href="#å¤šé¡¹å¼æ±‚é€†" class="headerlink" title="å¤šé¡¹å¼æ±‚é€†"></a>å¤šé¡¹å¼æ±‚é€†</h3><p>è¯¥éƒ¨åˆ†è§ <a href="https://colythme.github.io/2020/07/01/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86/">å¤šé¡¹å¼æ±‚é€†</a></p><h3 id="ç”Ÿæˆå‡½æ•°ç›¸å…³åº”ç”¨"><a href="#ç”Ÿæˆå‡½æ•°ç›¸å…³åº”ç”¨" class="headerlink" title="ç”Ÿæˆå‡½æ•°ç›¸å…³åº”ç”¨"></a>ç”Ÿæˆå‡½æ•°ç›¸å…³åº”ç”¨</h3><h4 id="OGF-æ±‚-Fibonacci-æ•°åˆ—é€šé¡¹"><a href="#OGF-æ±‚-Fibonacci-æ•°åˆ—é€šé¡¹" class="headerlink" title="OGF æ±‚ $Fibonacci$ æ•°åˆ—é€šé¡¹"></a>OGF æ±‚ $Fibonacci$ æ•°åˆ—é€šé¡¹</h4><p>å®šä¹‰ $Fibonacci$ æ•°åˆ—çš„ OGF<br>$$<br>F(x) = \sum\limits_{n = 1}^{\infty} fibo_n x^n<br>$$<br>å› ä¸º $Fibonacci$ æ•°åˆ—ä¸å…¶å³ç§»ä¸€ä½çš„ $Fibonacci$ æ•°åˆ—çš„å·®æ˜¯å…¶å³ç§»ä¸¤ä½ï¼Œå¾—<br>$$<br>\begin{aligned}<br>F(x) - xF(x) &amp;= x + x^2 \times F(x) \\<br>F(x) &amp;= \frac{x}{1 - x - x^2} \\<br>&amp;= \frac{x}{(1 - \frac{1 - \sqrt5}{2}x)(1 - \frac{1 + \sqrt5}{2}x)}<br>\end{aligned}<br>$$<br>ç°åœ¨è¦å°†è¯¥å¼è£‚é¡¹ï¼Œå‡å®š $F(x) = \frac{x}{(x - x_1)(x - x_2)}$ï¼Œåˆ™è£‚é¡¹ç»“æœä¸º $\frac{t_1}{x - x_1} + \frac{t_2}{x - x_2}$ï¼Œé€šé¡¹ï¼Œå¾—<br>$$<br>F(x) = \frac{t_1x - t_1x_2 + t_2x - t_2x_1}{(1 - x_1)(1 - x_2)}<br>$$<br>ç°åœ¨æ±‚è§£ $t_ 1, t_2$ï¼Œæœ‰æ–¹ç¨‹ç»„<br>$$<br>\begin{cases}<br>t_1 + t_2 = 1 \\<br>t_1x_1 + t_2x_2 = 0<br>\end{cases}<br>$$<br>è§£å‡º $t_1, t_2$ å³å¯è£‚é¡¹ï¼Œå¾—<br>$$<br>F(x) = -\frac{1}{\sqrt5}\frac{1}{1 - \frac{1 - \sqrt5}{2}x} + \frac{1}{\sqrt5}\frac{1}{1 - \frac{1 + \sqrt5}{2}x}<br>$$<br>æ³¨æ„å¼å­ $\frac{1}{1 - \frac{1 - \sqrt5}{2}x}$ ï¼Œè¿™å’Œå¼å­ $\sum\limits_{n = 0}^{\infty} x^n = \frac{1}{1 - x}$ï¼Œæ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥ç›´æ¥è¿˜åŸä¸ºæ•°åˆ—ï¼Œæ•…<br>$$<br>fibo_n = - \frac{1}{\sqrt5}\left(\frac{1 - \sqrt5}{2}\right)^n + \frac{1}{\sqrt5}\left(\frac{1 + \sqrt5}{2}\right)^n<br>$$</p><h4 id="ç”Ÿæˆå‡½æ•°æ±‚ä¼¯åŠªåˆ©æ•°"><a href="#ç”Ÿæˆå‡½æ•°æ±‚ä¼¯åŠªåˆ©æ•°" class="headerlink" title="ç”Ÿæˆå‡½æ•°æ±‚ä¼¯åŠªåˆ©æ•°"></a>ç”Ÿæˆå‡½æ•°æ±‚ä¼¯åŠªåˆ©æ•°</h4><h5 id="ä¼¯åŠªåˆ©æ•°"><a href="#ä¼¯åŠªåˆ©æ•°" class="headerlink" title="ä¼¯åŠªåˆ©æ•°"></a>ä¼¯åŠªåˆ©æ•°</h5><p>ä¼¯åŠªåˆ©æ•°åˆ†ä¸ºä¸¤ç±»ï¼š</p><p>$B_n^-$ è¡¨ç¤ºç¬¬ä¸€ç±»ä¼¯åŠªåˆ©æ•°ï¼Œ$B_n^+$ è¡¨ç¤ºç¬¬äºŒç±»ä¼¯åŠªåˆ©æ•°ï¼Œå®ƒä»¬çš„å·®åˆ«åœ¨äºç¬¬ä¸€é¡¹ï¼Œåˆ†åˆ«ä¸º $B_1^- = - \frac{1}{2}, B_1^+ = + \frac{1}{2}$</p><p>å¹¶ä¸”å¯¹äºæ‰€æœ‰å¤§äº $1$ çš„å¥‡æ•° $n$ï¼Œå…¶ä¼¯åŠªåˆ©æ•° $B_n = 0$</p><p>ç°åœ¨å®šä¹‰ç­‰å¹‚å’Œ<br>$$<br>S_m(n) = \sum\limits_{k = 1}^n k^m<br>$$<br>è¯¥å¼æˆä¸ºä¼¯åŠªåˆ©å¤šé¡¹å¼ï¼Œå˜é‡ä¸º $n$ï¼Œæ¬¡æ•°ä¸º $m$ï¼Œåˆ<br>$$<br>S_m(n) = \frac{1}{m + 1}\sum\limits_{k = 0}^n \dbinom{m + 1}{k} B_k^+ n^{m + 1 - k}<br>$$<br>è¿™å°±æ˜¯ä¼¯åŠªåˆ©æ•°ä¸ä¼¯åŠªåˆ©å¤šé¡¹å¼çš„å…³ç³»</p><p>ä¼¯åŠªåˆ©æ•°å¯ä»¥é€šè¿‡é€’æ¨å¼è®¡ç®—<br>$$<br>\sum\limits_{j = 0}^m \dbinom{m + 1}{j} B_j = 0  (B_0 = 1)<br>$$<br>å®ƒè¿˜å¯ä»¥é€šè¿‡ EGF è¡¨è¾¾ã€Œè¯æ˜å å‘ã€<br>$$<br>\frac{x}{e^x - 1} = \sum\limits_{n = 0}^{\infty} B_n\frac{x^n}{n!}<br>$$</p><h5 id="ä¹˜æ³•é€†å…ƒæ±‚ä¼¯åŠªåˆ©æ•°"><a href="#ä¹˜æ³•é€†å…ƒæ±‚ä¼¯åŠªåˆ©æ•°" class="headerlink" title="ä¹˜æ³•é€†å…ƒæ±‚ä¼¯åŠªåˆ©æ•°"></a>ä¹˜æ³•é€†å…ƒæ±‚ä¼¯åŠªåˆ©æ•°</h5><p>$$<br>\begin{aligned}<br>\sum\limits_{n = 0}^{\infty} B_n\frac{x^n}{n!} &amp;= \frac{x}{e^x - 1} \\<br>&amp;= \frac{x}{\sum\limits_{n = 1}^{\infty} \frac{x^n}{n!}} \\<br>&amp;= \frac{1}{\left(\sum\limits_{n = 0}^{\infty} \frac{x^n}{(n + 1)!}\right)}<br>\end{aligned}<br>$$</p><p>é‚£ä¹ˆæ±‚ä¸€æ¬¡ä¹˜æ³•é€†å…ƒå³å¯</p><h4 id="ç”Ÿæˆå‡½æ•°ä¼˜åŒ–-DP"><a href="#ç”Ÿæˆå‡½æ•°ä¼˜åŒ–-DP" class="headerlink" title="ç”Ÿæˆå‡½æ•°ä¼˜åŒ– $DP$"></a>ç”Ÿæˆå‡½æ•°ä¼˜åŒ– $DP$</h4><p>å…ˆç»™å‡ºä¸€é“æ¥è‡ªè®ºæ–‡çš„ä¾‹é¢˜</p><blockquote><p>å­—ç¬¦é›†å¤§å°ä¸º $m$ã€‚ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $k$ çš„å­—ç¬¦ä¸² $s$ï¼Œæ±‚å‡ºæ‰€æœ‰é•¿ä¸º $n$ çš„ä¸²ä¸­ï¼Œä¸åŒ…å«å­ä¸² $s$ çš„æœ‰å¤šå°‘ä¸ªã€‚$(n, m, k \le 10^5)$</p></blockquote><p>ç›´æ¥ $DP$ å¾ˆå¥½æƒ³ï¼Œä»¤ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªä½ç½®å¡«å­—ç¬¦ï¼Œå¹¶ä¸”ç¬¬ä¸€æ¬¡æ»¡è¶³ $substr[i - k + 1, i] = s$<br>$$<br>f_i = m^{i - k} - \sum\limits_{j = 1}^{i - k} f_jm^{i - j - k} - \sum\limits_{j \in Next} f_{i - j}<br>$$<br>æ³¨æ„ï¼Œæ­¤å¤„çš„ $Next$ é›†åˆå®šä¹‰ä¸º $\{j \ge 0 | s[1, k - j] = s[j + 1, k]\}$ï¼Œä¸ç„¶ä¸‹é¢ä¸å¥½è¿›è¡Œä¼˜åŒ–</p><p>æ¥ä¸‹æ¥å¯¹ $DP$ è¿›è¡Œä¼˜åŒ–</p><p>è€ƒè™‘ç”Ÿæˆå‡½æ•° $f(x) = \sum\limits_{n = 0}^{\infty} f_nx^n, N(x) = \sum\limits_{j \in Next} x^j$ï¼Œæ ¹æ®ä¸Šé¢çš„ $DP$ æ–¹ç¨‹ï¼Œå¯ä»¥å¾—åˆ°<br>$$<br>f(x) = \frac{x^k}{1 - mx} + \frac{x^k}{1 - mx}f(x) + f(x)(N(x) - 1)<br>$$<br>å…¶ä¸­ï¼Œç¬¬ä¸€é¡¹ç›´æ¥ç­‰æ¯”æ•°åˆ—æ±‚å’Œå³å¯å¾—åˆ°ï¼Œè‡³äº $2, 3$ é¡¹ï¼Œä¼šå‘ç°è¿™å®é™…ä¸Šå°±æ˜¯ä¸¤ä¸ªç”Ÿæˆå‡½æ•°ç›¸ä¹˜æ¯ä¸€é¡¹çš„ç³»æ•°å˜åŒ–ï¼Œå¹¶ä¸”æ³¨æ„æ­¤æ—¶ $N(x)$ éœ€å‡ $1$ï¼Œé˜²æ­¢è®¡ç®—åˆ° $f_i$ï¼Œæ•…å¾—è¯¥è¡¨ç¤º</p><p>åŒ–ç®€ï¼Œå¾—<br>$$<br>f(x) = \frac{x^k}{x^k + (1 - mx)N(x)}<br>$$</p><p>é‚£ä¹ˆæœ€ç»ˆç­”æ¡ˆä¸º $g_n = m^n - \sum\limits_{j = 1}^n f_jm^{n - j}$ï¼Œå…¶ OGF $g(x)$ ä¸º<br>$$<br>\begin{aligned}<br>g(x) &amp;= \frac{1}{1 - mx} - \frac{1}{1 - mx}f(x) \\<br>&amp;= \frac{N(x)}{x^k + (1 - mx)N(x)}<br>\end{aligned}<br>$$<br>ç„¶åæŠŠä¸‹é¢é‚£ä¸œè¥¿ä¹˜å‡ºæ¥åŒ–ç®€ä¸€ä¸‹å°±åˆå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„å¤šé¡¹å¼ï¼Œç„¶åå°±å¯ç›´æ¥è§£äº†</p><p>å¤æ‚åº¦ $O (n \log n)$</p><h3 id="å¯¹æ•°ä¸æŒ‡æ•°è¿ç®—"><a href="#å¯¹æ•°ä¸æŒ‡æ•°è¿ç®—" class="headerlink" title="å¯¹æ•°ä¸æŒ‡æ•°è¿ç®—"></a>å¯¹æ•°ä¸æŒ‡æ•°è¿ç®—</h3><h4 id="å½¢å¼å¹‚çº§æ•°çš„å¤åˆè¿ç®—"><a href="#å½¢å¼å¹‚çº§æ•°çš„å¤åˆè¿ç®—" class="headerlink" title="å½¢å¼å¹‚çº§æ•°çš„å¤åˆè¿ç®—"></a>å½¢å¼å¹‚çº§æ•°çš„å¤åˆè¿ç®—</h4><p>è®¾ $A(x) = \sum\limits_{i = 0}^{\infty} a_ix^i, B(x) = \sum\limits_{i = 1}^{\infty} b_ix^i$ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å¤åˆä¸º<br>$$<br>C(x) = A(B(x)) = \sum\limits_{i = 0}^{\infty} a_i(B(x))^i<br>$$<br>æ˜¾ç„¶æœ€ç»ˆ $C(x)$ å¯ä»¥å½’çº³æˆ $C(x) = \sum\limits_{i = 0}^{\infty} c_ix^i$ çš„å½¢å¼</p><p>æ³¨æ„å› ä¸º $B(x)$ æ˜¯æ²¡æœ‰å¸¸æ•°é¡¹çš„ï¼Œæ‰€ä»¥ $B(x)^i$ æ˜¯ä» $x^i$ èµ·æ­¥çš„ï¼Œæ•… $B(x)$ ä¸ $A(x)$ çš„å¤åˆå¯ä»¥å®šä¹‰ã€ŒçŒœæµ‹æ˜¯è¿™æ ·ï¼ŒçœŸæ­£åŸå› å å‘ã€</p><h4 id="å½¢å¼å¯¼æ•°"><a href="#å½¢å¼å¯¼æ•°" class="headerlink" title="å½¢å¼å¯¼æ•°"></a>å½¢å¼å¯¼æ•°</h4><p>å¯¹äº $A(x) = \sum\limits_{n = 0} ^{\infty} a_nx^n$ï¼Œå®šä¹‰å…¶å½¢å¼å¯¼æ•°<br>$$<br>Aâ€™(x) = \sum\limits_{n = 1}^{\infty} na_nx^{n - 1}<br>$$<br>ç»è¿‡éªŒè¯å¯çŸ¥<br>$$<br>\begin{matrix}<br>&amp;(cA(x))â€™ = cAâ€™(x) \\<br>&amp;(A(x) \pm B(x))â€™ = Aâ€™(x) \pm Bâ€™(x) \\<br>&amp;(A(x)B(x))â€™ = Aâ€™(x)B(x) + A(x)Bâ€™(x) \\<br>&amp;\left(\frac{1}{A(x)}\right) = - \frac{Aâ€™(x)}{A(x)^2} \\<br>&amp;(A(B(x))â€™ = Aâ€™(B(x))Bâ€™(x)<br>\end{matrix}<br>$$<br>è¿™äº›åŸºæœ¬æ±‚å¯¼æ³•åˆ™å¯¹å½¢å¼å¯¼æ•°ä»ç„¶æˆç«‹</p><h4 id="å¯å¾®å‡½æ•°"><a href="#å¯å¾®å‡½æ•°" class="headerlink" title="å¯å¾®å‡½æ•°"></a>å¯å¾®å‡½æ•°</h4><p>å¯å¾®å‡½æ•°æŒ‡é‚£äº›åœ¨å…¶å®šä¹‰åŸŸä¸­æ‰€æœ‰ç‚¹éƒ½å­˜åœ¨å¯¼æ•°çš„å‡½æ•°ï¼Œå› æ­¤ï¼Œå¯å¾®å‡½æ•°çš„å›¾åƒä¸å­˜åœ¨ä»»ä½•é—´æ–­ç‚¹ã€å°–ç‚¹æˆ–æ˜¯æœ‰å‚ç›´åˆ‡çº¿çš„ç‚¹</p><h4 id="æ³°å‹’çº§æ•°"><a href="#æ³°å‹’çº§æ•°" class="headerlink" title="æ³°å‹’çº§æ•°"></a>æ³°å‹’çº§æ•°</h4><p>å¯¹äºä¸€ä¸ªåœ¨å®æ•°æˆ–å¤æ•° $a$ é‚»åŸŸä¸Šï¼Œä»¥å®æ•°æˆ–å¤æ•°ä½œä¸ºå˜é‡ï¼Œå¹¶ä¸”æ˜¯æ— ç©·ä¸”å¯å¾®çš„å‡½æ•°ï¼Œå…¶æ³°å‹’çº§æ•°å®šä¹‰ä¸ºä»¥ä¸‹å½¢å¼çš„å¹‚çº§æ•°<br>$$<br>\sum\limits_{n = 0}^{\infty} \frac{f^{(n)}(a)}{n!}(x - a)^n<br>$$<br>å¦‚æœ $a = 0$ï¼Œé‚£ä¹ˆè¯¥çº§æ•°äº¦ç§°ä½œéº¦å…‹åŠ³æ—çº§æ•°</p><p>å®é™…ä¸Šè¯¥å¼ä¹Ÿå°±æ˜¯æ³°å‹’å±•å¼€çš„å¼å­ï¼Œè¯æ˜ï¼š<a href="https://baike.baidu.com/item/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F/7681487?fr=aladdin" target="_blank" rel="noopener">æ³°å‹’å±•å¼€è¯æ˜</a></p><h5 id="å¸¸ç”¨å‡½æ•°çš„éº¦å…‹åŠ³æ—åºåˆ—"><a href="#å¸¸ç”¨å‡½æ•°çš„éº¦å…‹åŠ³æ—åºåˆ—" class="headerlink" title="å¸¸ç”¨å‡½æ•°çš„éº¦å…‹åŠ³æ—åºåˆ—"></a>å¸¸ç”¨å‡½æ•°çš„éº¦å…‹åŠ³æ—åºåˆ—</h5><p>$$<br>\begin{matrix}<br>\frac{1} {1 - x} = \sum\limits_{n = 0}^{\infty} x^n ~ ~ ~ ~ \forall x \in (- 1, 1) \\\<br>e^x = \sum\limits_{n = 0}^{\infty} \frac{x^n} {n!}  ~ ~ ~ ~ \forall x \\\<br>\ln (1 + x) = \sum\limits_{n = 1}^{\infty} \frac{(- 1)^{n + 1} } {n}x^n ~ ~ ~ ~ \forall x \in (- 1, 1) \\\<br>\ln (1 - x) = - \sum\limits_{n = 1}^{\infty} \frac{x^i} {i}<br>\end{matrix}<br>$$</p><h4 id="å¯¹æ•°å‡½æ•°çš„è®¡ç®—"><a href="#å¯¹æ•°å‡½æ•°çš„è®¡ç®—" class="headerlink" title="å¯¹æ•°å‡½æ•°çš„è®¡ç®—"></a>å¯¹æ•°å‡½æ•°çš„è®¡ç®—</h4><p>ç»™å®š $A(x) = 1 + \sum\limits_{n = 1}^{\infty} a_nx^n$ ã€Œæ­¤å¤„ $+ 1$ æ˜¯ä¸ºäº†ä¿è¯å¤šé¡¹å¼æ±‚é€†æœ‰è§£ã€<br>$$<br>\begin{aligned}<br>B(x) &amp;= ln (A(x)) \\\<br>Bâ€™(x) &amp;= \frac{A(x)}{Aâ€™(x)} \\\<br>B(x) &amp;= \int \frac{A(x)}{Aâ€™(x)} \mathrm{d}x<br>\end{aligned}<br>$$<br>æ—¶é—´å¤æ‚åº¦ $O (n \log n)$</p><h4 id="æŒ‡æ•°å‡½æ•°çš„è®¡ç®—"><a href="#æŒ‡æ•°å‡½æ•°çš„è®¡ç®—" class="headerlink" title="æŒ‡æ•°å‡½æ•°çš„è®¡ç®—"></a>æŒ‡æ•°å‡½æ•°çš„è®¡ç®—</h4><p>ç»™å®š $A(x) = \sum\limits_{i = 1}^{\infty} a_ix^i$ï¼Œä»¤<br>$$<br>B(x) = e^{A(x)}<br>$$<br>é‚£ä¹ˆç»è¿‡å½’çº³ä¹‹åå¯ä»¥è¡¨ç¤ºä¸º $B(x) = \sum\limits_{i = 0}^{\infty} b_ix^i$</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„äº‹æƒ…å°±æ˜¯è¦è®¡ç®—ç³»æ•° $b_i$</p><p>æ˜¾ç„¶ $b_0 = 1$ï¼Œé‚£ä¹ˆæ‰©å±•ï¼Œå¾—<br>$$<br>b_i = \frac{1}{i}\sum\limits_{k = 1}^i a_kb_{i - k}<br>$$<br>æ¥ä¸‹æ¥è¯æ˜è¿™ä¸ªç»“è®º</p><h5 id="è¯æ˜æ–¹æ³•ä¸€-1"><a href="#è¯æ˜æ–¹æ³•ä¸€-1" class="headerlink" title="è¯æ˜æ–¹æ³•ä¸€"></a>è¯æ˜æ–¹æ³•ä¸€</h5><p>å…ˆä»ç®€å•çš„å¼€å§‹çœ‹èµ·<br>$$<br>\begin{aligned}<br>&amp;b_1 = \frac{a_1}{1!} \\\<br>&amp;b_2 = \frac{a_2}{1!} + \frac{a_1 \times a_1}{2!} \\\<br>&amp;b_3 = \frac{a_3}{1!} + \frac{a_1 \times a_2 + a_2 \times a_1}{2!} + \frac{a_1 \times a_1 \times a_1}{3!}<br>\end{aligned}<br>$$<br>å¯¹äº $b_4$ å…ˆåªåˆ—ä¸¾ä¸€ä¸ªï¼š<br>$$<br>b_4 = â€¦ + \frac{a_1 \times a_1 \times a_2 + a_1 \times a_2 \times a_1 + a_2 \times a_1 \times a_1}{3!} + â€¦<br>$$<br>å¯ä»¥å‘ç°ï¼Œç›¸å½“äºç°åœ¨å¤„ç†çš„é—®é¢˜æ˜¯ï¼Œä»¤ $n = \sum\limits_{i = 1}^{total} m_ip_i$ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ°ä¸€ä¸ªé›†åˆ $\{m_1 \times p_1, m_2 \times p_2, â€¦\}$ï¼Œé‚£ä¹ˆè¦å¦‚ä½•é€šè¿‡é›†åˆ $\{\{m_1 \times p_1, â€¦, (m_i - 1) \times p_i, â€¦, m_{total} \times p_{total}\}(i = 1, 2, â€¦, total)\}$ è½¬ç§»åˆ°è¯¥é›†åˆ</p><p>ç”±äºæœ€ç»ˆå¾—åˆ°çš„ $a_{p_1}a_{p_2}a_{p_3}â€¦$ æ— å…³ç´§è¦ï¼Œæ•…åªè€ƒè™‘å…¶ç³»æ•°</p><p>å…ˆè€ƒè™‘æœ€ç»ˆéœ€è¦çš„å€¼<br>$$<br>\begin{aligned}<br>final &amp;= \frac{\frac{m!}{m_1!m_2!m_3!â€¦}}{m!} \\\<br>&amp;= \frac{1}{m_1!m_2!m_3!â€¦}<br>\end{aligned}<br>$$<br>å¯¹äºæ¯ä¸ª $i$ï¼Œå®¹æ˜“çŸ¥é“å®ƒçš„è´¡çŒ®ä¸º $\frac{1}{m_1!â€¦(m_i - 1)!â€¦m_{total}!}$</p><p>ç°åœ¨åªæœ‰ $n$ å…³äº $m_i, p_i$ï¼Œçš„å…¬å¼ï¼Œè€ƒè™‘å°†æ¯ä¸ª $i$ çš„è´¡çŒ®ä¹˜ä¸Š $p_i$ï¼Œæ±‚å’Œï¼Œåˆ™æœ‰<br>$$<br>\frac{\sum\limits_i m_ip_i}{m_1!m_2!m_3!â€¦} = \frac{n}{m_1!m_2!m_3!â€¦}<br>$$<br>ä¸Šä¸‹åŒé™¤ä¸€ä¸ª $n$ å³å¯å¾—è§£</p><p>å¥½åƒè¿™ä¸ªè¯æ˜æœ‰ç‚¹éº»çƒ¦ï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸€ä¸ª</p><h5 id="è¯æ˜æ–¹æ³•äºŒ-1"><a href="#è¯æ˜æ–¹æ³•äºŒ-1" class="headerlink" title="è¯æ˜æ–¹æ³•äºŒ"></a>è¯æ˜æ–¹æ³•äºŒ</h5><p>ä¸¤è¾¹æ±‚å¯¼ï¼Œå¾—<br>$$<br>Bâ€™(x) = Aâ€™(x)B(x)<br>$$<br>é‚£ä¹ˆå±•å¼€ä¸€ä¸‹å°±å¾—åˆ°è¯¥å¼äº†</p><p>é‚£ä¹ˆæœ‰äº†è¿™ä¸ªç»“è®ºä¹‹åæ±‚ $b_i$ ç›´æ¥åˆ†æ²» $FFT$ è§£å†³å³å¯</p><p>æ—¶é—´å¤æ‚åº¦ $O (n \log^2 n)$</p><h4 id="ç‰›é¡¿è¿­ä»£æ³•"><a href="#ç‰›é¡¿è¿­ä»£æ³•" class="headerlink" title="ç‰›é¡¿è¿­ä»£æ³•"></a>ç‰›é¡¿è¿­ä»£æ³•</h4><p>ç»™å®š $g(x)$ï¼Œæ±‚è§£ $f(x)$<br>$$<br>g(f(x)) = 0<br>$$<br>å‡è®¾å·²ç»å¤„ç†å‡º $f(x)$ çš„å‰ $n$ é¡¹ $f_0(x)$ï¼Œåˆ™æœ‰<br>$$<br>\begin{aligned}<br>f(x) &amp;\equiv f_0(x) &amp;\pmod{x^n} \\\<br>f(x) - f_0(x) &amp;\equiv 0 &amp;\pmod{x^n} \\\<br>(f(x) - f_0(x))^2 &amp;\equiv 0 &amp;\pmod{x^{2n}}<br>\end{aligned}<br>$$<br>é‚£ä¹ˆå°† $g(f(x))$ æ³°å‹’å±•å¼€ï¼Œå¾—<br>$$<br>\begin{aligned}<br>0 &amp;= g(f(x)) \\\<br>&amp;= \sum\limits_{n = 0}^{\infty} \frac{g^{(n)}(f_0(x))}{n!}(f(x) - f_0(x))^n \\\<br>&amp;\equiv g(f_0(x)) + gâ€™(f_0(x))(f(x) - f_0(x)) \pmod{x^{2n}} \\\<br>f(x) &amp;\equiv f_0(x) - \frac{g(f_0(x))}{gâ€™(f_0(x))} \pmod{x^{2n}}<br>\end{aligned}<br>$$<br>é‚£ä¹ˆå°±å¯ä»¥ $O (n \log n)$ æ±‚è§£ $f(x)$ äº†</p><h5 id="ç‰›é¡¿è¿­ä»£æ³•è®¡ç®—æŒ‡æ•°å‡½æ•°"><a href="#ç‰›é¡¿è¿­ä»£æ³•è®¡ç®—æŒ‡æ•°å‡½æ•°" class="headerlink" title="ç‰›é¡¿è¿­ä»£æ³•è®¡ç®—æŒ‡æ•°å‡½æ•°"></a>ç‰›é¡¿è¿­ä»£æ³•è®¡ç®—æŒ‡æ•°å‡½æ•°</h5><p>ç»™å®š $A(x) = \sum\limits_{i = 1}^{\infty} a_ix^i$ï¼Œæ±‚è§£ $e^{A(x)}$</p><p>ä»¤ $g(x) = \ln (x) - A(x)$ï¼Œåˆ™æœ‰<br>$$<br>\begin{aligned}<br>f(x) &amp;= f_0(x) - \frac{\ln (f_0(x)) - A(x)}{\frac{1}{f_0(x)}} \\<br>&amp;= f_0(x)\left(1 - \ln (f_0(x)) + A(x)\right)<br>\end{aligned}<br>$$</p><h4 id="ç‰›é¡¿è¿­ä»£æ³•è®¡ç®—-k-æ¬¡å¹‚"><a href="#ç‰›é¡¿è¿­ä»£æ³•è®¡ç®—-k-æ¬¡å¹‚" class="headerlink" title="ç‰›é¡¿è¿­ä»£æ³•è®¡ç®— $k$ æ¬¡å¹‚"></a>ç‰›é¡¿è¿­ä»£æ³•è®¡ç®— $k$ æ¬¡å¹‚</h4><p>ç»™å®šå¤šé¡¹å¼ $A(x) = \sum\limits_{i = 0}^n a_ix^i$ åŠæ­£æ•´æ•° $k$ï¼Œæ±‚è§£ $A(x)^k$</p><p>ç›´æ¥å¿«é€Ÿå¹‚å¤æ‚åº¦ $O (n \log^2 n)$ï¼Œå¤æ‚åº¦è¾ƒé«˜</p><p>æ¥ä¸‹æ¥è®¨è®ºï¼š</p><p>è‹¥ $A(x)$ å¸¸æ•°é¡¹ä¸º $1$ï¼Œåˆ™<br>$$<br>A(x)^k = e^{k \ln A(x)}<br>$$<br>è‹¥ $A(x)$ å¸¸æ•°é¡¹ä¸ä¸º $1$ï¼Œåˆ™è¿›è¡Œè½¬åŒ–</p><p>è®¾ $A(x)$ å¾—æœ€ä½æ¬¡é¡¹ä¸º $a_tx^t$ï¼Œè½¬åŒ–ä¸ºå¸¸æ•°é¡¹ä¸º $1$ï¼Œå³<br>$$<br>A(x)^k = a_t^kx^{kt}\left(\frac{A(x)}{a_tx^t}\right)^k<br>$$<br>åŒæ ·ç‰›é¡¿è¿­ä»£æ³•å³å¯</p><p>æ—¶é—´å¤æ‚åº¦ $O (n \log n)$</p><h3 id="ç»„åˆè®¡æ•°"><a href="#ç»„åˆè®¡æ•°" class="headerlink" title="ç»„åˆè®¡æ•°"></a>ç»„åˆè®¡æ•°</h3><h4 id="åºåˆ—è®¡æ•°"><a href="#åºåˆ—è®¡æ•°" class="headerlink" title="åºåˆ—è®¡æ•°"></a>åºåˆ—è®¡æ•°</h4><p>æœ‰ä¸€ç±»ç»„åˆå¯¹è±¡ $A$ï¼Œ$A$ çš„å…ƒç´ å¯ä»¥ç»„æˆåºåˆ—ã€Œæœ€ç®€å•çš„ä¾‹å­å°±æ˜¯ç”± $\{n_1 \times l_1, n_2 \times l_2, â€¦\}$ è¿™æ ·çš„é•¿åº¦é›†åˆæ‹¼æˆé•¿åº¦ä¸º $k (k = 1, 2, â€¦)$ çš„æ–¹æ¡ˆæ•°æ‰€æ„æˆçš„åºåˆ—ã€ï¼Œåˆ™è¿™äº›åºåˆ—å®šä¹‰äº†æ–°çš„ä¸€ç±»ç»„åˆå¯¹è±¡ $B$ï¼Œå³<br>$$<br>B(x) = \sum\limits_{k = 0}^{\infty} A(x)^k = \frac{1}{1 - A(x)}<br>$$<br>è¯¥ç»“è®ºå¯¹æœ‰æ— æ ‡å·éƒ½æˆç«‹</p><h4 id="é›†åˆè®¡æ•°"><a href="#é›†åˆè®¡æ•°" class="headerlink" title="é›†åˆè®¡æ•°"></a>é›†åˆè®¡æ•°</h4><h5 id="æœ‰æ ‡å·çš„é›†åˆè®¡æ•°"><a href="#æœ‰æ ‡å·çš„é›†åˆè®¡æ•°" class="headerlink" title="æœ‰æ ‡å·çš„é›†åˆè®¡æ•°"></a>æœ‰æ ‡å·çš„é›†åˆè®¡æ•°</h5><p>é›†åˆä¸åºåˆ—çš„åŒºåˆ«åœ¨äºå…ƒç´ æ²¡æœ‰é¡ºåºï¼Œæ•…éœ€å»é™¤é‡å¤çš„ï¼Œåˆ™<br>$$<br>B(x) = \sum\limits_{n = 0}^{\infty} \frac{A(x)^n}{n!} = e^{A(x)}<br>$$</p><h6 id="æœ‰æ ‡å·çš„è¿é€šå›¾è®¡æ•°"><a href="#æœ‰æ ‡å·çš„è¿é€šå›¾è®¡æ•°" class="headerlink" title="æœ‰æ ‡å·çš„è¿é€šå›¾è®¡æ•°"></a>æœ‰æ ‡å·çš„è¿é€šå›¾è®¡æ•°</h6><p>è®¾ $G$ æ˜¯æ‰€æœ‰ç®€å•è¿é€šå›¾ï¼Œåˆ™å…¶ EGF ä¸º<br>$$<br>G(x) = \sum\limits_{n = 0}^{\infty} 2^{\frac{n(n - 1)}{2}}\frac{x^n}{n!}<br>$$<br>å¯ä»¥å°†æ‰€æœ‰ç®€å•è¿é€šå›¾çœ‹ä½œè¿é€šåˆ†é‡ã€Œå…¶é›†åˆä¸º $C(x)$ã€çš„é›†åˆï¼Œæ•…<br>$$<br>\begin{aligned}<br>G(x) &amp;= e^{C(x)} \\<br>C(x) &amp;= \ln G(x)<br>\end{aligned}<br>$$<br>æ—¶é—´å¤æ‚åº¦ $O (n \log n)$</p><h5 id="æ— æ ‡å·çš„é›†åˆè®¡æ•°"><a href="#æ— æ ‡å·çš„é›†åˆè®¡æ•°" class="headerlink" title="æ— æ ‡å·çš„é›†åˆè®¡æ•°"></a>æ— æ ‡å·çš„é›†åˆè®¡æ•°</h5><h6 id="å®Œå…¨èƒŒåŒ…è®¡æ•°"><a href="#å®Œå…¨èƒŒåŒ…è®¡æ•°" class="headerlink" title="å®Œå…¨èƒŒåŒ…è®¡æ•°"></a>å®Œå…¨èƒŒåŒ…è®¡æ•°</h6><blockquote><p>ä½“ç§¯ä¸º $i$ çš„æœ‰ $a_i$ ç§ä¸åŒçš„ç‰©å“ï¼Œæ¯ç§ç‰©å“æœ‰æ— é™ä¸ªï¼Œé‚£ä¹ˆæœ€ç»ˆè£…æ»¡ä½“ç§¯ä¸º $V$ çš„èƒŒåŒ…çš„æ–¹æ¡ˆæ•°</p></blockquote><p>æ˜¾ç„¶ç­”æ¡ˆä¸º<br>$$<br>\begin{aligned}<br>Ans &amp;= \prod_{i = 1}^n\left(\sum\limits_{j = 0}x^{ij}\right)^{a_i} \\<br>&amp;= \prod_{i = 1}^n\left(\frac{1}{1 - x^i}\right)^{a_i} \\<br>\end{aligned}<br>$$</p><p>æ¥ä¸‹æ¥ç”¨å¯¹æ•°å‡½æ•°åŒ–ä¹˜ä¸ºåŠ <br>$$<br>\begin{aligned}<br>Ans &amp;= \exp (\sum\limits_{i = 1}^n \ln \left(\left(\frac{1}{1 - x^i}\right)^{a_i}\right)) \\<br>&amp;= \exp (- \sum\limits_{i = 1}^n a_i\ln(1 - x^i)) \\<br>&amp;= \exp (\sum\limits_{i = 1}^na_i\left(\sum\limits_{n = 1}^{\infty} \frac{x^{in}}{n}\right)) \\<br>\end{aligned}<br>$$<br>æ¥ä¸‹æ¥ä»¤ $A(x) = \sum\limits_{i = 1}^{\infty} a_ix^i$ï¼Œæ¢ä¸ºæšä¸¾ $n$ï¼Œå¾—<br>$$<br>Ans = \exp (\sum\limits_{n = 1}^{\infty} \frac{1}{n}A(x^n))<br>$$<br>é‚£ä¹ˆæ—¶é—´å¤æ‚åº¦çš„è®¡ç®—å°±æ˜¯è°ƒå’Œçº§æ•°ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ $O (n \log n)$</p><h4 id="ç¯çš„è®¡æ•°"><a href="#ç¯çš„è®¡æ•°" class="headerlink" title="ç¯çš„è®¡æ•°"></a>ç¯çš„è®¡æ•°</h4><h5 id="æœ‰æ ‡å·çš„ç¯çš„è®¡æ•°"><a href="#æœ‰æ ‡å·çš„ç¯çš„è®¡æ•°" class="headerlink" title="æœ‰æ ‡å·çš„ç¯çš„è®¡æ•°"></a>æœ‰æ ‡å·çš„ç¯çš„è®¡æ•°</h5><h6 id="åœ†æ’åˆ—é—®é¢˜"><a href="#åœ†æ’åˆ—é—®é¢˜" class="headerlink" title="åœ†æ’åˆ—é—®é¢˜"></a>åœ†æ’åˆ—é—®é¢˜</h6><blockquote><p>ä» $n$ ä¸ªå…ƒç´ ä¸­ä¸é‡å¤åœ°å–å‡º $m$ ä¸ªå…ƒç´ åœ¨ä¸€ä¸ªåœ†å‘¨ä¸Šï¼Œå¹¶ä¸”æ¯ä¸ªæ’åˆ—ç»è¿‡æ—‹è½¬åä¸ä¼šä¸å…¶å®ƒä»»æ„ä¸€ä¸ªæ’åˆ—ç›¸åŒï¼Œå«åšè¿™ $n$ ä¸ªå…ƒç´ çš„åœ†æ’åˆ—</p></blockquote><p>æ˜¾ç„¶ $n$ ä¸ªå…ƒç´ å– $m$ ä¸ªä½œåœ†æ’åˆ—çš„æ–¹æ¡ˆæ•°ä¸º<br>$$<br>total = \frac{A_n^m}{m}<br>$$<br>é‚£ä¹ˆï¼Œå¯¹äºä¸€ç±»ç»„åˆå¯¹è±¡ $A$ï¼Œå…¶åœ†æ’åˆ—çš„ç”Ÿæˆå‡½æ•°ä¸º<br>$$<br>\sum\limits_{k = 1}^{\infty} \frac{A(x)^k}{k} = - \ln (1 - A(x))<br>$$</p><h6 id="æœ‰æ ‡å·çš„æ— å‘è¿é€šå›¾ä¸­çš„åŸºç¯æ ‘ä¸ªæ•°è®¡æ•°"><a href="#æœ‰æ ‡å·çš„æ— å‘è¿é€šå›¾ä¸­çš„åŸºç¯æ ‘ä¸ªæ•°è®¡æ•°" class="headerlink" title="æœ‰æ ‡å·çš„æ— å‘è¿é€šå›¾ä¸­çš„åŸºç¯æ ‘ä¸ªæ•°è®¡æ•°"></a>æœ‰æ ‡å·çš„æ— å‘è¿é€šå›¾ä¸­çš„åŸºç¯æ ‘ä¸ªæ•°è®¡æ•°</h6><p>è€ƒè™‘å°†åŸºç¯æ ‘æ‹†åˆ†ä¸ºè‹¥å¹²æ£µæ ‘çš„æ‹¼å‡‘</p><p>æ³¨æ„æ­¤æ—¶éœ€è€ƒè™‘çš„æ˜¯æœ‰æ ¹æ ‘ï¼Œå³å…ˆå°†èŠ‚ç‚¹çœ‹ä½œç»„åˆå¯¹è±¡ï¼Œæ ¹æ® $Cayley$ å®šç†ï¼Œ$n$ ä¸ªèŠ‚ç‚¹çš„å®Œå…¨å›¾æœ‰ $n^{n - 1}$ æ£µæœ‰æ ¹æ ‘ï¼Œåˆ™æœ‰æ ¹æ ‘çš„ EGF $T(x)$ ä¸º<br>$$<br>T(x) = \sum\limits_{n = 1}^{\infty} n^{n - 1}\frac{x^n}{n!}<br>$$<br>é‚£ä¹ˆæ­¤æ—¶å°†æœ‰æ ¹æ ‘çœ‹ä½œç»„åˆå¯¹è±¡ï¼Œåˆ™å°†å®ƒä»¬ç»„æˆç¯ï¼Œå³åŸºç¯æ ‘çš„ EGF $G(x)$ ä¸º<br>$$<br>\begin{aligned}<br>G(x) &amp;= \frac{1}{2}\sum\limits_{n = 3}^{\infty} \frac{T(x)^k}{k} \\<br>&amp;= - \frac{1}{2}\ln (1 - T(x)) - \sum\limits_{k = 1}^2 \frac{T(x)^k}{k}<br>\end{aligned}<br>$$</p><h5 id="æ— æ ‡å·çš„ç¯çš„è®¡æ•°"><a href="#æ— æ ‡å·çš„ç¯çš„è®¡æ•°" class="headerlink" title="æ— æ ‡å·çš„ç¯çš„è®¡æ•°"></a>æ— æ ‡å·çš„ç¯çš„è®¡æ•°</h5><p>ã€Œç”±äºéœ€è¦ç¾¤è®ºçŸ¥è¯†ï¼Œæ•…ç•™å‘ã€</p><p>ã€Œä»¥ä¸‹ç•™å‘ã€</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»„åˆæ•°å­¦ </tag>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‹„åˆ©å…‹é›·å·ç§¯ä¸è«æ¯”ä¹Œæ–¯åæ¼”</title>
      <link href="/2020/08/04/%E7%8B%84%E5%88%A9%E5%85%8B%E9%9B%B7%E5%8D%B7%E7%A7%AF%E4%B8%8E%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
      <url>/2020/08/04/%E7%8B%84%E5%88%A9%E5%85%8B%E9%9B%B7%E5%8D%B7%E7%A7%AF%E4%B8%8E%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="æ¦‚å¿µå¼•å…¥"><a href="#æ¦‚å¿µå¼•å…¥" class="headerlink" title="æ¦‚å¿µå¼•å…¥"></a>æ¦‚å¿µå¼•å…¥</h2><h3 id="æ•°è®ºå‡½æ•°"><a href="#æ•°è®ºå‡½æ•°" class="headerlink" title="æ•°è®ºå‡½æ•°"></a>æ•°è®ºå‡½æ•°</h3><p>ã€€ã€€ã€€ã€€æŒ‡å®šä¹‰åŸŸä¸ºæ­£æ•´æ•°çš„å‡½æ•°<br>ã€€ã€€ã€€ã€€å®šä¹‰å…¶åŠ æ³•ä¸ºé€é¡¹ç›¸åŠ ï¼Œå³$(f + g)(n) = f(n) + g(n)$<br>ã€€ã€€ã€€ã€€å®šä¹‰å…¶æ•°ä¹˜ä¸ºé€é¡¹ç›¸ä¹˜ï¼Œå³$(xf)(n) = x Ã— f(n)$</p><h3 id="å•ä½å…ƒ"><a href="#å•ä½å…ƒ" class="headerlink" title="å•ä½å…ƒ"></a>å•ä½å…ƒ</h3><p>ã€€ã€€ã€€ã€€å•ä½å…ƒæ˜¯é›†åˆä¸­ä¸€ç§ç‰¹åˆ«çš„å…ƒç´ ï¼Œå½“å•ä½å…ƒä¸å…¶å®ƒå…ƒç´ ç›¸ç»“åˆæ—¶ï¼Œä¸ä¼šæ”¹å˜å…¶å®ƒå…ƒç´ çš„å€¼</p><h3 id="é€†å…ƒ"><a href="#é€†å…ƒ" class="headerlink" title="é€†å…ƒ"></a>é€†å…ƒ</h3><p>ã€€ã€€ã€€ã€€é€†å…ƒæ˜¯æŒ‡å¯ä»¥å–æ¶ˆå¦ä¸€ç»™å®šå…ƒç´ è¿ç®—çš„å…ƒç´ ï¼Œå³å°†å…¶å˜å›å•ä½å…ƒ</p><h3 id="ç¬¦å·è¡¨ç¤º"><a href="#ç¬¦å·è¡¨ç¤º" class="headerlink" title="ç¬¦å·è¡¨ç¤º"></a>ç¬¦å·è¡¨ç¤º</h3><p>ã€€ã€€ã€€ã€€$[A]$è¡¨ç¤ºæ¡ä»¶$A$æ˜¯å¦ä¸ºçœŸ<br>ã€€ã€€ã€€ã€€æ­¤å¤„çš„ç¬¦å·â€$*$â€è¡¨ç¤ºç‹„åˆ©å…‹é›·å·ç§¯</p><h2 id="ç‹„åˆ©å…‹é›·å·ç§¯"><a href="#ç‹„åˆ©å…‹é›·å·ç§¯" class="headerlink" title="ç‹„åˆ©å…‹é›·å·ç§¯"></a>ç‹„åˆ©å…‹é›·å·ç§¯</h2><p>ã€€ã€€ä»¤$t(n) = f(n) * g(n)$ï¼Œåˆ™ã€€ã€€</p><p>$$<br>t(n) = \sum\limits_{i | n} f(i)g(\frac{n}{i})<br>$$</p><p>ã€€ã€€é‚£ä¹ˆç‹„åˆ©å…‹é›·å·ç§¯æ˜¾ç„¶æœ‰ä¸‹é¢å‡ ä¸ªæ€§è´¨ï¼š</p><h3 id="æ»¡è¶³ä¹˜æ³•äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€åˆ†é…å¾‹"><a href="#æ»¡è¶³ä¹˜æ³•äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€åˆ†é…å¾‹" class="headerlink" title="æ»¡è¶³ä¹˜æ³•äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€åˆ†é…å¾‹"></a>æ»¡è¶³ä¹˜æ³•äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€åˆ†é…å¾‹</h3><ul><li>å¯¹äºå•ä½å…ƒ$\epsilon(n) = [n = 1]$ï¼Œæ»¡è¶³$\epsilon(n)*f(n) = f(n)$<br>ã€€ã€€ã€€ã€€- å¯¹äºæ¯ä¸€ä¸ª$f(1) \ne 1$çš„æ•°è®ºå‡½æ•°$f(n)$ï¼Œçš†å­˜åœ¨å…¶é€†å…ƒ$f^{- 1}(n)$ï¼Œæ»¡è¶³$f(n) * f^{- 1}(n) = \epsilon(n)$ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªç»“è®ºï¼Œå¯ä»¥ä»¤$f^{- 1}(n) = \frac{1}{f(1)}\left(\epsilon(n) - \sum\limits_{i | n, i \ne 1} f(i)f^{- 1}(\frac{n}{i})\right)$ï¼Œå†ä»£å›åŸå¼ï¼Œæ»¡è¶³æ¡ä»¶</li></ul><h3 id="ç‹„åˆ©å…‹é›·å·ç§¯ä¸ç§¯æ€§å‡½æ•°"><a href="#ç‹„åˆ©å…‹é›·å·ç§¯ä¸ç§¯æ€§å‡½æ•°" class="headerlink" title="ç‹„åˆ©å…‹é›·å·ç§¯ä¸ç§¯æ€§å‡½æ•°"></a>ç‹„åˆ©å…‹é›·å·ç§¯ä¸ç§¯æ€§å‡½æ•°</h3><h3 id="ç§¯æ€§å‡½æ•°"><a href="#ç§¯æ€§å‡½æ•°" class="headerlink" title="ç§¯æ€§å‡½æ•°"></a>ç§¯æ€§å‡½æ•°</h3><p>ã€€ã€€ã€€ã€€ç§¯æ€§å‡½æ•°æ»¡è¶³å½“$(n, m) = 1$ï¼Œæœ‰$f(nm) = f(n)f(m)$</p><h3 id="ç›¸å…³æ€§è´¨"><a href="#ç›¸å…³æ€§è´¨" class="headerlink" title="ç›¸å…³æ€§è´¨"></a>ç›¸å…³æ€§è´¨</h3><ul><li><p>è‹¥$(n, m) = 1,  d | nm$ï¼Œåˆ™å¿…å®šå­˜åœ¨$a | n,  b | m$ä¸”æ»¡è¶³$ab = d$ï¼Œè¯æ˜æ˜¾ç„¶</p></li><li><p>è‹¥$(n, m) = 1,  a | n,  b | m$ï¼Œåˆ™æœ‰$(a, b) = 1$ï¼Œè¯æ˜æ˜¾ç„¶</p></li></ul><p>â€‹       è¿™æ ·çš„è¯ï¼Œå°±æœ‰æ€§è´¨ï¼šä¸¤ä¸ªç§¯æ€§å‡½æ•°çš„ç‹„åˆ©å…‹é›·å·ç§¯ä»æ˜¯ç§¯æ€§å‡½æ•°ï¼Œè¯æ˜ï¼š<br>ã€€ã€€è‹¥$(n, m) = 1$ï¼Œåˆ™æœ‰<br>$$<br>\begin{aligned}<br>t(nm) &amp;= \sum\limits_{i | nm} f(i)g(\frac{nm}{i}) \\<br>&amp;= \sum\limits_{a | n, b | m} f(ab)g(\frac{nm}{ab}) \\<br>&amp;= \sum\limits_{a | n, b | m} f(a)f(b)g(\frac{n}{a})g(\frac{m}{b}) \\<br>&amp;= t(n) * t(m)<br>\end{aligned}<br>$$</p><p>ã€€ã€€å¦å¤–ä¸€ä¸ªæ€§è´¨ï¼Œå°±æ˜¯ä¸¤ä¸ªç§¯æ€§å‡½æ•°çš„é€†å…ƒä»æ˜¯ç§¯æ€§å‡½æ•°ï¼Œæ˜¯ç”¨æ•°å­¦å½’çº³æ³•è¯æ˜ï¼š<br>ã€€ã€€ã€€ã€€ä»¤$(n, m) = 1$ï¼Œå½“$nm = 1$æ—¶ï¼Œç»“è®ºæ˜¾ç„¶æˆç«‹<br>ã€€ã€€ã€€ã€€å½“$nm &gt; 1$ä¸”$n_1m_1 &lt; nm$æ—¶$n_1m_1$ç»“è®ºæˆç«‹ï¼Œå†å‡è®¾$nm$æ—¶ç»“è®ºæˆç«‹ï¼Œåˆ™æœ‰ï¼ˆæ³¨æ„ï¼Œç§¯æ€§å‡½æ•°ä¸­ä¸€å®šæ»¡è¶³$f(1) = 1$ï¼‰<br>$$<br>\begin{aligned} f^{- 1}(nm) &amp;= - \sum\limits_{i | nm, i \ne 1} f(i)f^{- 1}(\frac{nm}{i}) \\ &amp;= - \sum\limits_{a | n, b | m, ab \ne 1} f(a)f(b)f^{- 1}(\frac{n}{a})f^{- 1}(\frac{m}{b}) \\ &amp;= f(1)f(1)f^{- 1}(n)f^{- 1}(m) - \sum\limits_{a | n, b | m, ab \ne 1} f(a)f(b)f^{- 1}(\frac{n}{a})f^{- 1}(\frac{m}{b}) \\ &amp;= f^{- 1}(n)f^{- 1}(m) - \epsilon(n)\epsilon(m) \\ &amp;= f^{- 1}(n)f^{- 1}(m) \end{aligned}<br>$$<br>ã€€ã€€æ³¨ï¼šç§¯æ€§å‡½æ•°$f(1) = 1$</p><h3 id="ç‹„åˆ©å…‹é›·å·ç§¯ä¸è«æ¯”ä¹Œæ–¯åæ¼”"><a href="#ç‹„åˆ©å…‹é›·å·ç§¯ä¸è«æ¯”ä¹Œæ–¯åæ¼”" class="headerlink" title="ç‹„åˆ©å…‹é›·å·ç§¯ä¸è«æ¯”ä¹Œæ–¯åæ¼”"></a>ç‹„åˆ©å…‹é›·å·ç§¯ä¸è«æ¯”ä¹Œæ–¯åæ¼”</h3><p>ã€€ã€€ä»¤$\mu$è¡¨ç¤º$1$åœ¨ç‹„åˆ©å…‹é›·å·ç§¯æ„ä¹‰ä¸‹çš„é€†å…ƒï¼Œä»¤$g = f * 1$ï¼Œåˆ™æœ‰$f = f * 1 * \mu = g * \mu$ï¼Œå†ä»¤$g(n) = \sum\limits_{d | n} f(d)$ï¼Œåˆ™æœ‰</p><p>$$<br>f(n) = g(n) * \mu(n) = \sum\limits_{d | n} g(d)\mu(\frac{n}{d})<br>$$<br>ã€€ã€€è¿™å°±æ˜¯è«æ¯”ä¹Œæ–¯åæ¼”çš„å¼å­äº†<br>ã€€ã€€é‚£ä¹ˆå¯¹äºå‡½æ•°$\mu(n)$ï¼Œç”±äº$1$æ˜¯ç§¯æ€§å‡½æ•°ï¼Œåˆ™$\mu$ä¹Ÿæ˜¯ç§¯æ€§å‡½æ•°ï¼Œåˆæ˜“çŸ¥ï¼ˆä»£å›åŸå¼å°±å¥½äº†ï¼‰<br>$$<br>\mu(p^k) = \left\{\begin{aligned} 1     k = 0 \\ - 1     k = 1 \\ 0     k &gt; 1 \end{aligned}\right.<br>$$<br>ã€€ã€€é‚£ä¹ˆç”±ç§¯æ€§å‡½æ•°ï¼Œå¯å¾—<br>ã€€ã€€- è‹¥$n = p_1p_2â€¦p_k$ä¸”$p_1 \ne p_2 \ne â€¦ \ne p_k$ï¼Œåˆ™æœ‰</p><p>$$<br>\mu(n) = (- 1)^k<br>$$</p><p>ã€€ã€€- è‹¥$p_k^r | n (r &gt; 1)$ï¼Œåˆ™æœ‰</p><p>$$<br>\mu(n) = 0<br>$$</p><p>ã€€ã€€é‚£ä¹ˆç§¯æ€§ç­›å³å¯</p><h4 id="å¦é™„"><a href="#å¦é™„" class="headerlink" title="å¦é™„"></a>å¦é™„</h4><p>ã€€ã€€è«æ¯”ä¹Œæ–¯åæ¼”çš„å¦ä¸€ç§å½¢å¼ï¼Œæœ‰</p><p>$$<br>g(n) = \sum\limits_{n | d}f(d)<br>$$<br>ã€€ã€€åˆ™æœ‰</p><p>$$<br>f(n) = \sum\limits_{n | d} \mu(\frac{d}{n})g(d)<br>$$</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è«æ¯”ä¹Œæ–¯åæ¼” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ´›è°·3768 - ç®€å•çš„æ•°å­¦é¢˜</title>
      <link href="/2020/08/04/%E6%B4%9B%E8%B0%B7%203768%20-%20%E7%AE%80%E5%8D%95%E7%9A%84%E6%95%B0%E5%AD%A6%E9%A2%98/"/>
      <url>/2020/08/04/%E6%B4%9B%E8%B0%B7%203768%20-%20%E7%AE%80%E5%8D%95%E7%9A%84%E6%95%B0%E5%AD%A6%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>æ ¹æ®<a href="https://www.cnblogs.com/Colythme/p/10275893.html" target="_blank" rel="noopener">Crashçš„æ•°å­—è¡¨æ ¼</a>ï¼Œå¾ˆå®¹æ˜“å¯ä»¥å°†å¼å­åŒ–ç®€ä¸º<br>$$<br>\begin{aligned} Ans &amp;= \sum\limits_{i = 1}^n \sum\limits_{j = 1} ij(i, j) \\ &amp;= \sum\limits_{d = 1}^n d^3 \sum\limits_{k = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(k) k^2 \left( \sum\limits_{i = 1}^{\left\lfloor\frac{n}{kd}\right\rfloor} i \right)^2 \end{aligned}<br>$$<br>æ„Ÿè§‰ $d, k$ æ”¾åœ¨ä¸€èµ·å¼å­æ— æ³•ç»§ç»­åŒ–ç®€ï¼Œä¸»è¦æ˜¯æœ‰ $kd$ å­˜åœ¨ï¼Œæ•…ä»¤ $T = kd$ ï¼Œåˆ™æœ‰<br>$$<br>Ans = \sum\limits_{T = 1}^n \left( \sum\limits_{i = 1}^{\left\lfloor\frac{n}{T}\right\rfloor} i \right)^2 T^2 \sum\limits_{d | T} d \mu(\frac{T}{d})<br>$$<br>é‚£ä¹ˆè€ƒè™‘æ•´é™¤åˆ†å—ï¼Œç°åœ¨éœ€è¦å¤„ç†çš„æ˜¯ååŠéƒ¨åˆ†</p><p>é€šè¿‡è§‚å¯Ÿï¼ˆçœ‹é¢˜è§£ï¼‰å¯ä»¥å‘ç°ï¼Œ $\sum\limits_{d | T} d \mu(\frac{T}{d})$ å¯ä»¥çœ‹æˆ $\mu * id$ ï¼Œæ•…å¯æ›¿æ¢æˆ $\phi(T)$ ï¼Œåˆ™æœ‰<br>$$<br>Ans = \sum\limits_{T = 1}^n \left( \sum\limits_{i = 1}^{\left\lfloor\frac{n}{T}\right\rfloor} i \right)^2 T^2 \phi(T)<br>$$<br>ç°åœ¨è€ƒè™‘å°† $T^2 \phi(T)$ éƒ¨åˆ†ç”¨æœæ•™ç­›è§£å†³<br>$$<br>h(n) = \sum\limits_{d | n} d^2 \phi(d) g(\frac{n}{d})<br>$$<br>ä¸ºäº†æ¶ˆé™¤ $d^2$ ï¼Œä»¤ $g(\frac{n}{d}) = n^2$ ï¼Œåˆ™æœ‰<br>$$<br>h(n) = n^3<br>$$<br>æ•…å¾—<br>$$<br>S(n) = \sum\limits_{i = 1}^n i^3 - \sum\limits_{d = 2}^n d^2 S(\left\lfloor\frac{n}{d}\right\rfloor)<br>$$<br>åˆï¼ˆé€šè¿‡çœ‹é¢˜è§£ï¼‰æœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹<br>$$<br>\sum\limits_{i = 1}^n i^3 = \left( \sum\limits_{i = 1}^n i \right)<br>$$<br>é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥æœæ•™ç­›äº†</p><p>è‡³äºå¤æ‚åº¦ï¼Œå°†æœ€å¤–å›´çš„æ•´é™¤åˆ†å—ä¸æœæ•™ç­›çœ‹ä¸ºä¸€ä½“ï¼Œæ•…å¤æ‚åº¦ä¸º $O (n^{\frac{2}{3}})$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">6e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL MOD, N;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">LL inv2, inv6;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN];</span><br><span class="line"><span class="keyword">int</span> vis[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> pcnt = <span class="number">0</span>;</span><br><span class="line">LL phi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumphi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> MAX = <span class="number">6e06</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linear_sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! vis[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">phi[i] = i - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j])) &#123;</span><br><span class="line">phi[i * prime[j]] = phi[i] * <span class="number">1l</span>l * prime[j] % MOD;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">phi[i * prime[j]] = phi[i] * <span class="number">1l</span>l * (prime[j] - <span class="number">1</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++)</span><br><span class="line">sumphi[i] = (sumphi[i - <span class="number">1</span>] + <span class="number">1l</span>l * i % MOD * <span class="number">1l</span>l * i % MOD * phi[i] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tr1::<span class="built_in">unordered_map</span>&lt;LL, LL&gt; maphi;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">sqr</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x * x % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">eqm</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (n + <span class="number">1</span>) % MOD * (n % MOD) % MOD * (<span class="number">2</span> * n % MOD + <span class="number">1</span>) % MOD * inv6 % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">oseqm</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> n % MOD * ((n + <span class="number">1</span>) % MOD) % MOD * inv2 % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">phi_sieve</span> <span class="params">(LL n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX)</span><br><span class="line"><span class="keyword">return</span> sumphi[n];</span><br><span class="line"><span class="keyword">if</span> (maphi[n])</span><br><span class="line"><span class="keyword">return</span> maphi[n];</span><br><span class="line">LL total = sqr (oseqm (n));</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">total = (total - (eqm (r) - eqm (l - <span class="number">1</span>) + MOD) % MOD * phi_sieve (n / l) % MOD + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maphi[n] = total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">Solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (LL l = <span class="number">1</span>, r; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = N / (N / l);</span><br><span class="line">ans = (ans + sqr (oseqm (N / l)) * ((phi_sieve (r) - phi_sieve (l - <span class="number">1</span>) + MOD) % MOD) % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%lld%lld"</span>, &amp; MOD, &amp; N);</span><br><span class="line">inv2 = power (<span class="number">2l</span>l, MOD - <span class="number">2</span>), inv6 = power (<span class="number">6l</span>l, MOD - <span class="number">2</span>);</span><br><span class="line">MAX = (<span class="keyword">int</span>) min (<span class="number">1l</span>l * MAX, N), linear_sieve ();</span><br><span class="line">LL ans = Solve ();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">998244353 2000</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1000000007 9786510294</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è«æ¯”ä¹Œæ–¯åæ¼” </tag>
            
            <tag> æœæ•™ç­› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ´›è°·3676 - å°æ¸…æ–°æ•°æ®ç»“æ„é¢˜</title>
      <link href="/2020/08/04/%E6%B4%9B%E8%B0%B7%203676%20-%20%E5%B0%8F%E6%B8%85%E6%96%B0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E9%A2%98/"/>
      <url>/2020/08/04/%E6%B4%9B%E8%B0%B7%203676%20-%20%E5%B0%8F%E6%B8%85%E6%96%B0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>è¯´å®è¯è¿™é¢˜å†™æ ‘å‰– $LCT$ ä»€ä¹ˆçš„çœŸçš„æ€æƒ³åˆä¸éš¾åˆå¥½å®ç°çš„æ ·å­ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯é€‰æ‹©è‡ªè™é€‰æ‹©äº†åŠ¨æ€ç‚¹åˆ†æ²»</p><p>é‚£å°±ä¸¤ç§åšæ³•éƒ½ç¨å¾®æä¸€ä¸‹ï¼š</p><h3 id="æ ‘é“¾å‰–åˆ†-LCT"><a href="#æ ‘é“¾å‰–åˆ†-LCT" class="headerlink" title="æ ‘é“¾å‰–åˆ† / $LCT$"></a>æ ‘é“¾å‰–åˆ† / $LCT$</h3><p>å¾ˆå®¹æ˜“å¯ä»¥å‘ç°ä¸€ä¸ªæ¢æ ¹æ“ä½œåªä¼šå¯¹å½“å‰æ ¹åœ¨åŸæ ‘ï¼ˆæ ¹ä¸º $1$ ï¼‰ä¸Šçš„ç¥–å…ˆä¸€æ¡é“¾é€ æˆå½±å“ï¼Œä¹Ÿå°±æ˜¯å°†å®ƒä»¬çš„å­æ ‘å˜æˆé™¤å½“å‰é“¾æ–¹å‘å…¶å®ƒä¸ä¹‹ç›¸è¿çš„ç‚¹é›†ï¼Œé‚£ä¹ˆç”¨æ ‘å‰–è·³ï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹åŸæ ‘ä¸Šä»ä¸Šé¢æ¥çš„å’Œä»ä¸‹é¢æ¥çš„ï¼Œå†å°†æ‰€æœ‰æ¶‰åŠçš„èŠ‚ç‚¹åˆå¹¶ï¼Œå¹¶ä¸”åˆ å»ç®—é‡å¤çš„å’Œä¸è¯¥ç®—çš„å³å¯ï¼ˆè™½ç„¶æˆ‘æ²¡å®ç°ä½†æ˜¯è¿™ä¸ªæ€è·¯åº”è¯¥æ˜¯å¯¹çš„</p><h3 id="åŠ¨æ€ç‚¹åˆ†æ²»"><a href="#åŠ¨æ€ç‚¹åˆ†æ²»" class="headerlink" title="åŠ¨æ€ç‚¹åˆ†æ²»"></a>åŠ¨æ€ç‚¹åˆ†æ²»</h3><p>é¦–å…ˆæœ‰ä¸¤ç¯‡åšå®¢ï¼š<a href="https://www.luogu.org/blog/user4134/solution-p3676" target="_blank" rel="noopener">zzq</a>ã€<a href="http://www.cnblogs.com/zhoushuyu/p/8309410.html" target="_blank" rel="noopener">ç§Ÿé…¥é›¨</a></p><p>å› ä¸ºæˆ‘ä»¬è¦ç®— $\sum\limits_{i = 1}^n s_i^2$ ï¼Œå¯ä»¥å…ˆæƒ³ä¸€ä¸‹ $\sum\limits_{i = 1}^n s_i$ æ€ä¹ˆç®—ï¼Œå› ä¸ºæ¯ä¸ªç‚¹çš„è´¡çŒ®åªä¼šè¢«ç¥–å…ˆè®¡ç®—åˆ°ï¼Œé‚£ä¹ˆæ˜“çŸ¥ $\sum\limits_{i = 1}^n s_i = \sum\limits_{i = 1}^n value_i * (depth_i + 1)$ ï¼Œè¿™ä¸ªç›´æ¥ç”¨åŠ¨æ€ç‚¹åˆ†æ²»ç»´æŠ¤ä¸‰ä¸ªå˜é‡ $sumo_i, sumt_i, sumfa_i$ ï¼ˆsumo -&gt; $p$ å­èŠ‚ç‚¹æƒå€¼ä¹‹å’Œ,  $sumt$ -&gt; å­èŠ‚ç‚¹æƒå€¼ä¸è·ç¦»çš„ä¹˜ç§¯åˆ° $p$ ä¹‹å’Œ,  $sumfa$ -&gt; å­èŠ‚ç‚¹æƒå€¼ä¸è·ç¦»çš„ä¹˜ç§¯åˆ° $fa$ ï¼ˆç‚¹åˆ†æ ‘ä¸Šï¼‰ä¹‹å’Œï¼‰å³å¯å¾—åˆ°</p><p>æ¥ä¸‹æ¥æœ‰ä¸ªå¾ˆé‡è¦çš„ç»“è®ºï¼ˆåæ­£æˆ‘æ˜¯è‚¯å®šæƒ³ä¸åˆ°</p><p>â€‹    - ä¸è®ºæ ¹å¦‚ä½•æ¢ï¼Œ $\sum\limits_{i = 1}^n s_i (sum - s_i)$ ä¸€å®šæ˜¯ä¸€ä¸ªå®šå€¼ï¼ˆè¯´å®è¯ä¸€å¼€å§‹ä¸€ç›´æƒ³ç€å¦‚ä½•åŒ–ç®€ $\sum\limits_{i = 1}^n s_i$ ï¼Œæ‰€ä»¥æ˜¯çœŸçš„æ²¡æœ‰æƒ³åˆ°å¯ä»¥é€šè¿‡æ„é€ å®šå€¼çš„æ–¹æ³•æ¥è§£å‡º $\sum\limits_{i = 1}^n s_i^2$ ï¼‰</p><p>å…ˆæ¥æ„ä¼šä¸€ä¸‹è¿™ä¸ªç»“è®ºï¼šå°±æ˜¯æ¯ä¸€æ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹åœ¨ä»–ä»¬çš„å­æ ‘ä¸­å„è‡ªé€‰ä¸¤ä¸ªç‚¹è®©å®ƒä»¬æƒå€¼ç›¸ä¹˜ï¼Œæ±‚æ€»æƒå€¼</p><p>é‚£ä¹ˆå°±æ¯”è¾ƒå®¹æ˜“çŸ¥é“è¯æ˜äº†ï¼šæ¯æ¡è¾¹çš„è¾¹æƒä¸ºæ‰€æœ‰å¯¹åº”è·¯å¾„ç»è¿‡è¿™æ¡è¾¹çš„ä¸¤ä¸ªç‚¹çš„æƒå€¼å’Œï¼Œæ±‚æ€»è¾¹æƒï¼Œå³æ±‚çš„æ˜¯ $\sum\limits_{i = 1}^n \sum\limits_{j = 1}^n value_i * value_j * dist (i, j)$ ï¼Œæ‰€ä»¥æœ‰ $\sum\limits_{i = 1}^n s_i (sum - s_i) = \sum\limits_{i = 1}^n \sum\limits_{j = 1}^n value_i * value_j * dist (i, j)$</p><p>å› ä¸ºè¯¥å¼æ˜¯ä¸ªå®šå€¼ï¼Œæ‰€ä»¥æ±‚å‡º $\sum\limits_{i = 1}^n s_i$ åç›´æ¥è§£å‡º $Ans$ å°±å®Œæˆäº†æŸ¥è¯¢æ“ä½œ</p><p>å¯¹äºä¿®æ”¹æ“ä½œï¼Œè‹¥ä¿®æ”¹å®Œåä¸åŸæƒå€¼çš„å·®å€¼ä¸º $\Delta value$ ï¼Œé‚£ä¹ˆ $\Delta total = \Delta value \sum\limits_{j = 1}^n value_j * dist (p, j)$ ï¼ˆ $p$ ä¸ºä¿®æ”¹ç‚¹ï¼‰</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    Link[++ size].to = v;</span><br><span class="line">    Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">    Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, Q;</span><br><span class="line"><span class="keyword">int</span> value[MAXN];</span><br><span class="line"></span><br><span class="line">LL Deep[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Dfn[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> val[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;, belong[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> dfsord = <span class="number">0</span>;</span><br><span class="line">LL sum = <span class="number">0</span>;</span><br><span class="line">LL subtree[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL s1 = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    Dfn[root] = ++ dfsord;</span><br><span class="line">    val[dfsord] = Deep[root], belong[dfsord] = root;</span><br><span class="line">    sum += value[root];</span><br><span class="line">    subtree[root] = value[root];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Deep[v] = Deep[root] + <span class="number">1</span>;</span><br><span class="line">        DFS (v, root);</span><br><span class="line">        val[++ dfsord] = Deep[root], belong[dfsord] = root;</span><br><span class="line">        subtree[root] += subtree[v];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">25</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dfsord; i ++)</span><br><span class="line">        ST[i][<span class="number">0</span>] = make_pair (val[i], belong[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">20</span>; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= dfsord; i ++)</span><br><span class="line">            ST[i][j] = ST[i][j - <span class="number">1</span>].first &lt; ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>].first ? ST[i][j - <span class="number">1</span>] : ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> L = Dfn[x], R = Dfn[y];</span><br><span class="line">    <span class="keyword">if</span> (L &gt; R)</span><br><span class="line">        swap (L, R);</span><br><span class="line">    <span class="keyword">int</span> k = log2 (R - L + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ST[L][k].first &lt; ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].first ? ST[L][k].second : ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].second;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">dist</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lca = LCA (x, y);</span><br><span class="line">    <span class="keyword">return</span> Deep[x] + Deep[y] - (Deep[lca] &lt;&lt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> Vis[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Size[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> minv = INF, grvy;</span><br><span class="line"><span class="keyword">int</span> total;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Grvy_Acqu</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    Size[root] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa || Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Grvy_Acqu (v, root);</span><br><span class="line">        Size[root] += Size[v];</span><br><span class="line">        maxpart = max (maxpart, Size[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    maxpart = max (maxpart, total - Size[root]);</span><br><span class="line">    <span class="keyword">if</span> (maxpart &lt; minv)</span><br><span class="line">        minv = maxpart, grvy = root;</span><br><span class="line">&#125;</span><br><span class="line">LL sumo[MAXN]= &#123;<span class="number">0</span>&#125;, sumt[MAXN]= &#123;<span class="number">0</span>&#125;, sumfa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">// sumo -&gt; på­èŠ‚ç‚¹æƒå€¼ä¹‹å’Œ, sumt -&gt; å­èŠ‚ç‚¹æƒå€¼ä¸è·ç¦»çš„ä¹˜ç§¯åˆ°pä¹‹å’Œ, sumfa -&gt; å­èŠ‚ç‚¹æƒå€¼ä¸è·ç¦»çš„ä¹˜ç§¯åˆ°fa(ç‚¹åˆ†æ ‘ä¸Š)ä¹‹å’Œ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sums_Acqu</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    sumo[grvy] += value[root], sumt[grvy] += value[root] * dist (root, grvy);</span><br><span class="line">    <span class="keyword">if</span> (father[grvy])</span><br><span class="line">        sumfa[grvy] += value[root] * dist (root, father[grvy]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i =    Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa || Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        sums_Acqu (v, root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">point_DAC</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> pre)</span> </span>&#123;</span><br><span class="line">    minv = INF, grvy = p, total = Size[p];</span><br><span class="line">    Grvy_Acqu (p, <span class="number">0</span>);</span><br><span class="line">    Vis[grvy] = <span class="literal">true</span>, father[grvy] = pre;</span><br><span class="line">    sums_Acqu (grvy, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> fgrvy = grvy;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[fgrvy]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        point_DAC (v, fgrvy);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    LL tsum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> p = op; p; p = father[p]) &#123;</span><br><span class="line">        tsum += sumt[p];</span><br><span class="line">        <span class="keyword">if</span> (p != op)</span><br><span class="line">            tsum += sumo[p] * dist (p, op);</span><br><span class="line">        <span class="keyword">if</span> (father[p])</span><br><span class="line">            tsum -= sumo[p] * dist (father[p], op) + sumfa[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tsum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Modify</span> <span class="params">(<span class="keyword">int</span> op, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> p = op; p; p = father[p]) &#123;</span><br><span class="line">        sumo[p] -= value[op] - delta;</span><br><span class="line">        sumt[p] -= value[op] * dist (p, op) - delta * dist (p, op);</span><br><span class="line">        <span class="keyword">if</span> (father[p])</span><br><span class="line">            sumfa[p] -= value[op] * dist (father[p], op) - delta * dist (father[p], op);</span><br><span class="line">    &#125;</span><br><span class="line">    sum -= value[op] - delta;</span><br><span class="line">    LL s = Query (op);</span><br><span class="line">    s1 += (delta - value[op]) * s;</span><br><span class="line">    value[op] = delta;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">int</span> isneg = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>)</span><br><span class="line">            isneg = <span class="number">1</span>;</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), Q = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">        Insert (u, v), Insert (v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        value[i] = getnum ();</span><br><span class="line">    DFS (<span class="number">1</span>, <span class="number">0</span>), RMQ ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        s1 += subtree[i] * (sum - subtree[i]);</span><br><span class="line">    Size[<span class="number">1</span>] = N, point_DAC (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">/*cout &lt;&lt; "Next----------------------" &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    for (int i = 1; i &lt;= N; i ++)</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; sumo[i] &lt;&lt; ' ' &lt;&lt; sumt[i] &lt;&lt; ' ' &lt;&lt; sumfa[i] &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; "End-----------------------" &lt;&lt; endl;*/</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= Q; Case ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> opt = getnum ();</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> p = getnum (), delta = getnum ();</span><br><span class="line">            Modify (p, delta);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> p = getnum ();</span><br><span class="line">            LL ans = (Query (p) + sum) * sum - s1;</span><br><span class="line">            <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">4 3 2 1</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">1 1 3</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">1 2 4</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 1</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">4 3 2 1</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŠ¨æ€ç‚¹åˆ†æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ¹å·ç®—æ³•ç›¸å…³</title>
      <link href="/2020/08/04/%E6%A0%B9%E5%8F%B7%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/"/>
      <url>/2020/08/04/%E6%A0%B9%E5%8F%B7%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="æ ‘ä¸Šè«é˜Ÿ"><a href="#æ ‘ä¸Šè«é˜Ÿ" class="headerlink" title="æ ‘ä¸Šè«é˜Ÿ"></a>æ ‘ä¸Šè«é˜Ÿ</h2><p>é¦–å…ˆæœ‰ä¸€é“é¢˜</p><h3 id="ç‹å®¤è”é‚¦"><a href="#ç‹å®¤è”é‚¦" class="headerlink" title="ç‹å®¤è”é‚¦"></a>ç‹å®¤è”é‚¦</h3><h4 id="é¢˜ç›®å¤§æ„"><a href="#é¢˜ç›®å¤§æ„" class="headerlink" title="é¢˜ç›®å¤§æ„"></a>é¢˜ç›®å¤§æ„</h4><p>ç»™å®šä¸€æ£µæ ‘ï¼Œå°†æ ‘åˆ†ä¸ºå¤§å°èŒƒå›´ä¸º $[B, 3B]$ çš„è¿é€šå—é›†ï¼Œæ±‚æ–¹æ¡ˆ</p><h4 id="æ ‘ä¸Šåˆ†å—æ–¹æ³•ä¹‹ä¸€"><a href="#æ ‘ä¸Šåˆ†å—æ–¹æ³•ä¹‹ä¸€" class="headerlink" title="æ ‘ä¸Šåˆ†å—æ–¹æ³•ä¹‹ä¸€"></a>æ ‘ä¸Šåˆ†å—æ–¹æ³•ä¹‹ä¸€</h4><p>ç±»ä¼¼è´ªå¿ƒï¼Œç”¨æ ˆç»´æŠ¤è¿˜æ²¡æœ‰åœ¨è¿é€šå—ä¸­çš„å­èŠ‚ç‚¹ï¼Œå¯¹äºé€’å½’åˆ°çš„å½“å‰çš„ç‚¹ $p$ ï¼Œæ‰«æå®ƒçš„å­æ ‘ï¼Œèƒ½æ‹¼å‡‘å°±æ‹¼å‡‘</p><p>ä½†æ˜¯æ³¨æ„æœ€åå¯èƒ½è¿˜ä¼šæœ‰ä¸€äº›ç‚¹ï¼ˆä¸€å®šåŒ…æ‹¬æ ¹ï¼‰å‰©ä¸‹ï¼Œé‚£ä¹ˆå°†è¿™äº›ç‚¹å¹¶åˆ°æœ€åä¸€ä¸ªè¿é€šå—å³å¯</p><p>æ˜¾ç„¶æ¯ä¸ªè¿é€šå—éƒ½æ»¡è¶³å¤§å°ä¸º $[B, 3B]$</p><h4 id="æ ¸å¿ƒä»£ç "><a href="#æ ¸å¿ƒä»£ç " class="headerlink" title="æ ¸å¿ƒä»£ç "></a>æ ¸å¿ƒä»£ç </h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> bot = top;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        DFS (v, root);</span><br><span class="line">        <span class="keyword">if</span> (top - bot &gt;= B) &#123;</span><br><span class="line">            capt[++ bind] = root;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; bot)</span><br><span class="line">                belong[Stack[top --]] = bind;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Stack[++ top] = root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ ‘ä¸Šè«é˜Ÿ-1"><a href="#æ ‘ä¸Šè«é˜Ÿ-1" class="headerlink" title="æ ‘ä¸Šè«é˜Ÿ"></a>æ ‘ä¸Šè«é˜Ÿ</h3><p>é¦–å…ˆç”¨ç‹å®¤è”é‚¦çš„æ–¹æ³•å°†æ ‘åˆ†å—</p><p>ç”¨ä¸€ä¸ªæ•°ç»„ $state_p$ æ¥ç»´æŠ¤ $p$ ç‚¹æ˜¯å¦åœ¨å½“å‰è¯¢é—®çš„è·¯å¾„ä¸Šï¼Œé‚£ä¹ˆæ¯æ¬¡è®¿é—®å°±å°† $state_p$ ç¿»è½¬ï¼Œé¡ºä¾¿ä¿®æ”¹ $ans$ ï¼Œç›¸å½“äºåŸåºåˆ—ä¸Šè«é˜Ÿçš„ $add, del$ æ“ä½œ</p><p>é‚£ä¹ˆï¼Œæ¯æ¬¡éœ€è¦ä¿®æ”¹é‚£äº›ç‚¹å‘¢ï¼Ÿ</p><p>å‡è®¾å½“å‰å¤„ç†åˆ° $(px, py)$ ï¼Œç°åœ¨éœ€è¦å¤„ç† $(x, y)$ ï¼Œé‚£ä¹ˆåªéœ€ä¿®æ”¹ $px$ åˆ° $x$ ä»¥åŠ $py$ åˆ° $y$ çš„è·¯å¾„ä¸Šçš„ç‚¹å³å¯</p><p>æ¥ä¸‹æ¥è¯æ˜è¯¥æ“ä½œçš„æ­£ç¡®æ€§ï¼š</p><p>ä»¤ $T (x, y)$ è¡¨ç¤º $x$ åˆ° $y$ è·¯å¾„ä¸Šçš„ç‚¹é›†ï¼Œ $xor$ æ“ä½œç±»ä¼¼ä½è¿ç®—çš„å¼‚æˆ–ï¼Œå³æœ‰ç›¸åŒç‚¹åˆ™åˆ å»ï¼Œæ— åˆ™åŠ å…¥</p><p>åˆ™æœ‰ $T (x, y) = T (x, root) xor T (y, root)$ ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œçš„ $T (x, y)$ æ˜¯ä¸åŒ…æ‹¬ $lca$ çš„ï¼Œæ•… <strong>$lca$ éœ€å•ç‹¬å¤„ç†</strong>ï¼‰</p><p>æ¥ä¸‹æ¥æ˜¯è¯æ˜<br>$$<br>\begin{aligned} &amp;T (px, py)  xor  T (x, y) \\ &amp;= [T (px, root)  xor  T (py, root)]  xor  [T (x, root)  xor  T (y, root)] \\ &amp;=  [T (px, root)  xor  T (x, root)]  xor  [T (py, root)  xor  T (y, root)] \\ &amp;= T (px, x)  xor  T (py, y) \end{aligned}<br>$$<br>é‚£ä¹ˆå…¶å®ƒçš„ä¿®æ”¹ä»€ä¹ˆçš„å°±å’Œåºåˆ—ä¸Šè«é˜Ÿä¸€æ ·äº†</p><h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><p><a href="https://www.luogu.org/problemnew/show/P4074" target="_blank" rel="noopener">[WC2013]ç³–æœå…¬å›­</a></p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXQ = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    Link[++ size].to = v;</span><br><span class="line">    Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">    Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line">LL V[MAXN], W[MAXN];</span><br><span class="line"><span class="keyword">int</span> pcol[MAXN];</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> belong[MAXN];</span><br><span class="line"><span class="keyword">int</span> lind = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> Stack[MAXN];</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS_bel</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> bot = top;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        DFS_bel (v, root);</span><br><span class="line">        <span class="keyword">if</span> (top - bot &gt;= limit) &#123;</span><br><span class="line">            lind ++;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; bot)</span><br><span class="line">                belong[Stack[top --]] = lind;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Stack[++ top] = root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> deep[MAXN];</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN];</span><br><span class="line"><span class="keyword">int</span> value[MAXN &lt;&lt; <span class="number">1</span>], ranking[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> dfsord = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS_LCA</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    father[root] = fa;</span><br><span class="line">    dfn[root] = ++ dfsord;</span><br><span class="line">    value[dfsord] = deep[root], ranking[dfsord] = root;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == fa)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        deep[v] = deep[root] + <span class="number">1</span>;</span><br><span class="line">        DFS_LCA (v, root);</span><br><span class="line">        value[++ dfsord] = deep[root], ranking[dfsord] = root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dfsord; i ++)</span><br><span class="line">        ST[i][<span class="number">0</span>] = make_pair (value[i], ranking[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">18</span>; j ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= dfsord; i ++)</span><br><span class="line">            ST[i][j] = ST[i][j - <span class="number">1</span>].first &lt; ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>].first ? ST[i][j - <span class="number">1</span>] : ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> L = dfn[x], R = dfn[y];</span><br><span class="line">    <span class="keyword">if</span> (L &gt; R)</span><br><span class="line">        swap (L, R);</span><br><span class="line">    <span class="keyword">int</span> k = log2 (R - L + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ST[L][k].first &lt; ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].first ? ST[L][k].second : ST[R - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QuerySt</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> index;</span><br><span class="line">    <span class="keyword">int</span> time;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line"></span><br><span class="line">    QuerySt (<span class="keyword">int</span> find = <span class="number">0</span>, <span class="keyword">int</span> ftime = <span class="number">0</span>, <span class="keyword">int</span> fx = <span class="number">0</span>, <span class="keyword">int</span> fy = <span class="number">0</span>) :</span><br><span class="line">        index (find), time (ftime), x (fx), y (fy) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> QuerySt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (belong[x] != belong[p.x])</span><br><span class="line">            <span class="keyword">return</span> belong[x] &lt; belong[p.x];</span><br><span class="line">        <span class="keyword">if</span> (belong[y] != belong[p.y])</span><br><span class="line">            <span class="keyword">return</span> belong[y] &lt; belong[p.y];</span><br><span class="line">        <span class="keyword">return</span> time &lt; p.time;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">QuerySt Query[MAXQ];</span><br><span class="line"><span class="keyword">int</span> qind = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> modposi[MAXQ], modtime[MAXQ];</span><br><span class="line"><span class="keyword">int</span> modpre[MAXQ], modval[MAXQ];</span><br><span class="line"><span class="keyword">int</span> mind = <span class="number">0</span>, cur = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> state[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> donet[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (state[p])</span><br><span class="line">        ans -= V[pcol[p]] * W[donet[pcol[p]]], donet[pcol[p]] --;</span><br><span class="line">    state[p] ^= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (state[p])</span><br><span class="line">        donet[pcol[p]] ++, ans += V[pcol[p]] * W[donet[pcol[p]]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lca = LCA (u, v);</span><br><span class="line">    <span class="keyword">while</span> (u != lca)</span><br><span class="line">        reverse (u), u = father[u];</span><br><span class="line">    <span class="keyword">while</span> (v != lca)</span><br><span class="line">        reverse (v), v = father[v];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">extime</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> exist = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (state[modposi[p]]) &#123;</span><br><span class="line">        exist = <span class="literal">true</span>;</span><br><span class="line">        reverse (modposi[p]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (type == <span class="number">1</span>) &#123;</span><br><span class="line">        modpre[p] = pcol[modposi[p]];</span><br><span class="line">        pcol[modposi[p]] = modval[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        pcol[modposi[p]] = modpre[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (exist)</span><br><span class="line">        reverse (modposi[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">timemod</span> <span class="params">(<span class="keyword">int</span> ptime)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (cur &lt; mind &amp;&amp; modtime[cur + <span class="number">1</span>] &lt;= ptime)</span><br><span class="line">        extime (++ cur, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (cur &gt; <span class="number">0</span> &amp;&amp; modtime[cur] &gt; ptime)</span><br><span class="line">        extime (cur --, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">LL answer[MAXQ]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Moqueue</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> px = <span class="number">1</span>, py = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qind; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> ind = Query[i].index, time = Query[i].time;</span><br><span class="line">        <span class="keyword">int</span> x = Query[i].x, y = Query[i].y;</span><br><span class="line">        timemod (time);</span><br><span class="line">        move (px, x), px = x;</span><br><span class="line">        move (py, y), py = y;</span><br><span class="line">        <span class="keyword">int</span> lca = LCA (px, py);</span><br><span class="line">        reverse (lca);</span><br><span class="line">        answer[ind] = ans;</span><br><span class="line">        reverse (lca);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum (), Q = getnum ();</span><br><span class="line">    limit = (<span class="keyword">int</span>) <span class="built_in">ceil</span> (<span class="built_in">pow</span> ((<span class="keyword">double</span>) N, <span class="number">2.0</span> / <span class="number">3.0</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">        V[i] = (LL) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        W[i] = (LL) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">        Insert (u, v), Insert (v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        pcol[i] = getnum ();</span><br><span class="line">    DFS_bel (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (top &gt; <span class="number">0</span>)</span><br><span class="line">        belong[Stack[top --]] = lind;</span><br><span class="line">    DFS_LCA (<span class="number">1</span>, <span class="number">0</span>), RMQ ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> opt = getnum ();</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> p = getnum (), col = getnum ();</span><br><span class="line">            modposi[++ mind] = p, modtime[mind] = i, modval[mind] = col;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = getnum (), y = getnum ();</span><br><span class="line">            qind ++, Query[qind] = (QuerySt (qind, i, x, y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sort (Query + <span class="number">1</span>, Query + qind + <span class="number">1</span>);</span><br><span class="line">    Moqueue ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qind; i ++)</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, answer[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 3 5</span></span><br><span class="line"><span class="comment">1 9 2</span></span><br><span class="line"><span class="comment">7 6 5 1</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">1 2 3 2</span></span><br><span class="line"><span class="comment">1 1 2</span></span><br><span class="line"><span class="comment">1 4 2</span></span><br><span class="line"><span class="comment">0 2 1</span></span><br><span class="line"><span class="comment">1 1 2</span></span><br><span class="line"><span class="comment">1 4 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="äºŒæ¬¡ç¦»çº¿è«é˜Ÿ"><a href="#äºŒæ¬¡ç¦»çº¿è«é˜Ÿ" class="headerlink" title="äºŒæ¬¡ç¦»çº¿è«é˜Ÿ"></a>äºŒæ¬¡ç¦»çº¿è«é˜Ÿ</h2><p>è€ƒè™‘æŸä¸ªè«é˜Ÿçš„å¤æ‚åº¦æ˜¯ $O (n\sqrt{n}T)$ï¼Œå…¶ä¸­ $x$ æ˜¯æŸç§å¤æ‚åº¦ï¼Œå³è«é˜Ÿåœ¨ç§»åŠ¨ç«¯ç‚¹æ—¶çš„æ›´æ–°ä¸æ˜¯ $O (1)$ è€Œæ˜¯ $O (x)$ çš„ï¼Œå³å¯ç”¨äºŒæ¬¡ç¦»çº¿è«é˜Ÿä¼˜åŒ–æ‰ $O (T)$</p><p>è€ƒè™‘å³ç«¯ç‚¹çš„ä¸€æ¬¡ç”± $R_{i - 1}$ åˆ° $R_i (R_i &gt; R_{i - 1})$ çš„ä¸€æ¬¡ç§»åŠ¨ï¼Œå¯¹äº $x \in (R_{i - 1}, R_i]$ï¼Œä»¤å…¶å¯¹åŒºé—´ $[l, r]$ çš„è´¡çŒ®ä¸º $c (x, [l, r])$ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ $x$ æ¯æ¬¡ç§»åŠ¨æˆ‘ä»¬éœ€è¦çŸ¥é“ $c (x, [l, x - 1])$ï¼Œå·®åˆ†ï¼Œå¾—<br>$$<br>c (x, [l, x - 1]) = c (x, [1, x - 1]) - c (x, [1, l - 1])<br>$$<br>å¯¹äº $c (x, [1, x - 1])$ï¼Œæ˜¾ç„¶å¯ä»¥ç›´æ¥å‰ç¼€å’Œç»´æŠ¤ï¼›å¯¹äº $c (x, [1, l - 1])$ï¼Œç”±äºåœ¨ä¸€æ¬¡ç§»åŠ¨ä¸­æ°¸è¿œéƒ½æ˜¯ç»™ $[1, l - 1]$ åšè´¡çŒ®ï¼Œé‚£ä¹ˆå¯ä»¥åªåœ¨ $l - 1$ çš„ä½ç½®æ‰“ä¸ªæ ‡è®°è¯´æœ‰å“ªäº› $x$ éœ€è¦äº†è§£å®ƒåœ¨è¯¥åŒºé—´çš„è´¡çŒ®ï¼Œå†è®¡ç®—ä¸€ä¸‹å°±å¥½äº†</p><p>ä¹Ÿå°±æ˜¯è¯´ç¬¬ä¸€æ¬¡ç¦»çº¿å¤„ç†å‡º $c (x, [1, x - 1])$ å¹¶ä¸”ç»™æ¯ä¸ªç«¯ç‚¹æ‰“ä¸Šæ ‡è®°è¯´æ˜ä»éœ€è®¡ç®—çš„åŒºé—´ï¼Œç¬¬äºŒæ¬¡ç¦»çº¿åˆ™å¤„ç†ç¬¬ä¸€æ¬¡ç¦»çº¿åˆ†ç¦»å‡ºçš„åŒºé—´</p><p>æ•…æ€»æ—¶é—´å¤æ‚åº¦ $O (nT + n\sqrt{n})$ï¼Œç©ºé—´å¤æ‚åº¦ $O (n)$</p><hr><p>ä»¥ ã€Œç¬¬åå››åˆ†å—(å‰ä½“)ã€ ä¸ºä¾‹</p><p>é¢˜ç›®æè¿°ï¼šæŸ¥è¯¢ $l \le i &lt; j \le r$ï¼Œä¸” $a_i \bigoplus a_j$ çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹å­˜åœ¨ $k$ ä¸ª $1$ çš„äºŒå…ƒç»„ $(i, j)$ ä¸ªæ•°</p><p>ä»¤äºŒè¿›åˆ¶ä¸‹æœ‰ $k$ ä¸ª $1$ çš„æ•°çš„é›†åˆä¸º $A$ï¼ˆæœ€å¤šæœ‰ $3432$ ä¸ªï¼‰ï¼Œæ•°å­— $x$ å‡ºç°çš„æ¬¡æ•°ä¸º $ap (x)$ï¼Œé‚£ä¹ˆåŠ å…¥ä¸€ä¸ªæ•° $y$ æ—¶æ‰€å¢åŠ çš„è´¡çŒ®å³ä¸º<br>$$<br>\Delta c(x, [l, r]) = \sum\limits_{x \in A} ap (x \bigoplus y)<br>$$<br>äºŒæ¬¡ç¦»çº¿è«é˜Ÿå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXU = <span class="number">16384</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, K;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> limit = <span class="number">0</span>, bel[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; bits;</span><br><span class="line">LL buck[MAXU]= &#123;<span class="number">0</span>&#125;, preans[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">querySt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> l, r, ind;</span><br><span class="line">LL ans;</span><br><span class="line"></span><br><span class="line">querySt () &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> querySt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> bel[l] == bel[p.l] ? r &lt; p.r : l &lt; p.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">querySt query[MAXM];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">T</span> &#123;</span><span class="keyword">int</span> l, r, delt;&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;T&gt; subs[MAXN];</span><br><span class="line"></span><br><span class="line">LL answer[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), K = getnum ();</span><br><span class="line">limit = <span class="built_in">sqrt</span> (N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">a[i] = getnum ();</span><br><span class="line">bel[i] = (i - <span class="number">1</span>) / limit + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">query[i].l = getnum (), query[i].r = getnum ();</span><br><span class="line">query[i].ind = i, query[i].ans = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16384</span>; i ++)</span><br><span class="line"><span class="keyword">if</span> (__builtin_popcount (i) == K)</span><br><span class="line">bits.push_back(i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">preans[i] = buck[a[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) bits.size(); j ++)</span><br><span class="line">buck[a[i] ^ bits[j]] ++;</span><br><span class="line">&#125;</span><br><span class="line">sort (query + <span class="number">1</span>, query + M + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, pl = <span class="number">1</span>, pr = <span class="number">0</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = query[i].l, r = query[i].r;</span><br><span class="line"><span class="keyword">if</span> (pl &lt; l) subs[pr].push_back((T) &#123;pl, l - <span class="number">1</span>, - i&#125;);</span><br><span class="line"><span class="keyword">while</span> (pl &lt; l) query[i].ans += preans[pl], pl ++;</span><br><span class="line"><span class="keyword">if</span> (pl &gt; l) subs[pr].push_back((T) &#123;l, pl - <span class="number">1</span>, i&#125;);</span><br><span class="line"><span class="keyword">while</span> (pl &gt; l) query[i].ans -= preans[pl - <span class="number">1</span>], pl --;</span><br><span class="line"><span class="keyword">if</span> (pr &lt; r) subs[pl - <span class="number">1</span>].push_back((T) &#123;pr + <span class="number">1</span>, r, - i&#125;);</span><br><span class="line"><span class="keyword">while</span> (pr &lt; r) query[i].ans += preans[pr + <span class="number">1</span>], pr ++;</span><br><span class="line"><span class="keyword">if</span> (pr &gt; r) subs[pl - <span class="number">1</span>].push_back((T) &#123;r + <span class="number">1</span>, pr, i&#125;);</span><br><span class="line"><span class="keyword">while</span> (pr &gt; r) query[i].ans -= preans[pr], pr --;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span> (buck, <span class="number">0</span>, <span class="keyword">sizeof</span> (buck));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) bits.size(); j ++)</span><br><span class="line">buck[a[i] ^ bits[j]] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) subs[i].size(); j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l = subs[i][j].l, r = subs[i][j].r, ind = subs[i][j].delt;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= r; k ++) &#123;</span><br><span class="line"><span class="keyword">int</span> tmp = buck[a[k]];</span><br><span class="line"><span class="keyword">if</span> (k &lt;= i &amp;&amp; ! K) tmp --;</span><br><span class="line"><span class="keyword">if</span> (ind &gt; <span class="number">0</span>) query[ind].ans += tmp;</span><br><span class="line"><span class="keyword">else</span> query[- ind].ans -= tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= M; i ++) query[i].ans += query[i - <span class="number">1</span>].ans;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) answer[query[i].ind] = query[i].ans;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">write (answer[i]), <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5 2</span></span><br><span class="line"><span class="comment">3 4 8 0 2</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">3 5</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">2 5</span></span><br><span class="line"><span class="comment">1 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å½’çº³ </tag>
            
            <tag> åˆ†å— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœæ•™ç­›</title>
      <link href="/2020/08/04/%E6%9D%9C%E6%95%99%E7%AD%9B/"/>
      <url>/2020/08/04/%E6%9D%9C%E6%95%99%E7%AD%9B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="å‰ç½®ç›¸å…³"><a href="#å‰ç½®ç›¸å…³" class="headerlink" title="å‰ç½®ç›¸å…³"></a>å‰ç½®ç›¸å…³</h2><ul><li><p>ç±»å‹ç§¯æ€§å‡½æ•°ï¼ˆæ³¨ï¼šä»¥ä¸‹çš†ä¸ºå®Œå…¨ç§¯æ€§å‡½æ•°ï¼Œå³æ— éœ€æ»¡è¶³ $x \perp y$ å³æœ‰ $f(x) Â· f(y) = f(xy)$</p><p>$\epsilon (n) = [n = 1]$</p><p>$id (n) = n$</p></li><li><p><a href="https://www.cnblogs.com/Colythme/p/9972264.html" target="_blank" rel="noopener">ç‹„åˆ©å…‹é›·å·ç§¯ä¸è«æ¯”ä¹Œæ–¯å‡½æ•°</a></p></li><li><p>ç‹„åˆ©å…‹é›·å·ç§¯ä¸æ¬§æ‹‰å‡½æ•°</p><p>æ­¤å¤„è‹¥ä»¥ $id $ ä½œå•ä½å…ƒï¼Œåˆ™ $1$ ä¸º $\phi$ çš„é€†ï¼Œå³ $\phi * 1 = id$</p><p>è¯æ˜ï¼šç”± $\sum\limits_{d | n} \phi (d) = n$ ï¼Œå†å¸¦å›åŸå¼å¯è¯</p></li><li><p>è«æ¯”ä¹Œæ–¯å‡½æ•°ä¸æ¬§æ‹‰å‡½æ•°çš„è½¬åŒ–<br>$$<br>\begin{aligned} \phi * 1 &amp;= id \ \phi * 1 * \mu &amp;= id * \mu \ \phi * \epsilon &amp;= id * \mu \ \phi &amp;= \sum\limits_{d | n} \mu(d) \frac{n}{d} \ \frac{\phi}{n} &amp;= \sum\limits_{d | n} \frac{\mu(d)}{d} \end{aligned}<br>$$</p></li></ul><h2 id="æœæ•™ç­›"><a href="#æœæ•™ç­›" class="headerlink" title="æœæ•™ç­›"></a>æœæ•™ç­›</h2><ul><li><p>æœæ•™ç­›ç”¨äºæ±‚è§£ç§¯æ€§å‡½æ•°å‰ç¼€å’Œä¸€ç±»é—®é¢˜</p></li><li><p>ä¸‹é¢æ±‚è§£ç§¯æ€§å‡½æ•° $f$ çš„å‰ç¼€å’Œ</p></li><li><p>è®¾ç§¯æ€§å‡½æ•° $f, g, h$ ï¼Œä¸” $h = f * g$ ï¼Œåˆ™æœ‰</p></li></ul><p>$$<br>\begin{aligned} \sum\limits_{i = 1}^n h(n) &amp;= \sum\limits_{i = 1}^n \sum\limits_{d | n} g(d)f(\frac{n}{d}) \\ &amp;= \sum\limits_{d = 1}^n g(d) \sum\limits_{i = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} f(i) \end{aligned}<br>$$</p><ul><li>ä»¤ $S(n) = \sum\limits_{i = 1}^n f(i)$</li><li>å°† $d = 1$ æ—¶çš„æå‡ºï¼Œå†ç§»é¡¹ï¼Œå¾—</li></ul><p>$$<br>S(n) = \sum\limits_{i = 1}^n h(i) - \sum\limits_{d = 2}^n g(d)S(\left\lfloor\frac{n}{d}\right\rfloor)<br>$$</p><ul><li>é‚£ä¹ˆé¢„å¤„ç† $h, g$ çš„å‰ç¼€å’Œï¼ˆä¸€èˆ¬é¢„å¤„ç† $n^{\frac{2}{3}}$ ä¸ªï¼Ÿï¼‰ï¼Œå†é€’å½’æ•´é™¤åˆ†å—å³å¯å¤„ç†ï¼Œä¸è¿‡ä¸€èˆ¬ $h, g$ éœ€è¦è‡ªå·±é…</li><li>ä½†å®é™…ä¸Šå¹¶ä¸éœ€è¦ç”¨ $\text{unordered_map}$ æ¥è®°å¿†åŒ–ï¼Œè®¾é¢˜ç›®ç»™å®š $N$ï¼Œå½“å‰é€’å½’åˆ° $n$ï¼Œåˆ™ $n$ çš„ç­”æ¡ˆå¯ä»¥è¢« $N / n$ è®°å½•ï¼Œä¹Ÿå°±æ˜¯ç”¨ $visit(\lfloor\frac{N}n\rfloor)$ æ¥åˆ¤æ–­æ˜¯å¦å·²è¢«æœè¿‡ï¼Œä¸‹é¢ç»™å‡ºåˆ«äººçš„ç®€å•è¯æ˜ä¸ºä»€ä¹ˆä¸ä¼šåˆ¤é‡</li><li><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/07/25/sG79MC6wLoOvu8k.png" alt=""></li></ul><h2 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h2><h3 id="æ±‚-sum-limits-i-1-n-mu-i-sum-limits-i-1-n-phi-i"><a href="#æ±‚-sum-limits-i-1-n-mu-i-sum-limits-i-1-n-phi-i" class="headerlink" title="æ±‚$\sum\limits_{i = 1}^n \mu(i), \sum\limits_{i = 1}^n \phi(i)$"></a>æ±‚$\sum\limits_{i = 1}^n \mu(i), \sum\limits_{i = 1}^n \phi(i)$</h3><p>ç”± $\mu * 1 = \epsilon$ ï¼Œå¯ä»¤ $g = 1, h = \epsilon$ ï¼Œé‚£ä¹ˆå¾—åˆ°<br>$$<br>S(n) = 1 - \sum\limits_{d = 2}^n S(\left\lfloor\frac{n}{d}\right\rfloor)<br>$$<br>æ±‚ $\sum \phi$ åŒç†</p><h3 id="æ±‚-sum-limits-i-1-n-i-phi-i-ï¼ˆéœ€è¦ç”¨é…çš„ï¼‰"><a href="#æ±‚-sum-limits-i-1-n-i-phi-i-ï¼ˆéœ€è¦ç”¨é…çš„ï¼‰" class="headerlink" title="æ±‚$\sum\limits_{i = 1}^n i \phi(i) ï¼ˆéœ€è¦ç”¨é…çš„ï¼‰$"></a>æ±‚$\sum\limits_{i = 1}^n i \phi(i) ï¼ˆéœ€è¦ç”¨é…çš„ï¼‰$</h3><p>$$<br>h(n) = \sum\limits_{d | n} d \phi(d) g(\frac{n}{d})<br>$$</p><p>å¸Œæœ›å°† $d$ æ¶ˆå»ï¼Œæ•…é… $g = id$ ï¼Œå¾— $h(n) = n^2$<br>$$<br>S(n) = \sum\limits_{i = 1}^n i - \sum\limits_{d = 2}^n d S(\left\lfloor\frac{n}{d}\right\rfloor)<br>$$<br>å³å¯è§£</p><h2 id="ä»£ç ï¼ˆæ±‚è§£-sum-mu-sum-phi-ï¼‰"><a href="#ä»£ç ï¼ˆæ±‚è§£-sum-mu-sum-phi-ï¼‰" class="headerlink" title="ä»£ç ï¼ˆæ±‚è§£$\sum \mu, \sum \phi$ ï¼‰"></a>ä»£ç ï¼ˆæ±‚è§£$\sum \mu, \sum \phi$ ï¼‰</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e06</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">3000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN / <span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> vis[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mu[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL phi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> sumu[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumphi[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">4e06</span> + <span class="number">5e05</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linear_sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">mu[<span class="number">1</span>] = phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! vis[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">mu[i] = - <span class="number">1</span>, phi[i] = i - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j])) &#123;</span><br><span class="line">phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">mu[i * prime[j]] = - mu[i];</span><br><span class="line">phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line">sumu[i] = sumu[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">sumphi[i] = sumphi[i - <span class="number">1</span>] + phi[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> mapmu[MAXM];</span><br><span class="line">LL maphi[MAXM];</span><br><span class="line"><span class="keyword">bool</span> vmu[MAXM]= &#123;<span class="literal">false</span>&#125;, vphi[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mu_sieve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sumu[n];</span><br><span class="line"><span class="keyword">if</span> (vmu[N / n]) <span class="keyword">return</span> mapmu[N / n];</span><br><span class="line"><span class="keyword">int</span> total = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">total -= (r - l + <span class="number">1</span>) * mu_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line">vmu[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> mapmu[N / n] = total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">phi_sieve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sumphi[n];</span><br><span class="line"><span class="keyword">if</span> (vphi[N / n]) <span class="keyword">return</span> maphi[N / n];</span><br><span class="line">LL total = n * <span class="number">1l</span>l * (n + <span class="number">1</span>) / <span class="number">2l</span>l;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">total -= <span class="number">1l</span>l * (r - l + <span class="number">1</span>) * phi_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line">vphi[N / n] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> maphi[N / n] = total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">linear_sieve ();</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; T);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line"><span class="built_in">memset</span> (vmu, <span class="literal">false</span>, <span class="keyword">sizeof</span> (vmu));</span><br><span class="line"><span class="built_in">memset</span> (vphi, <span class="literal">false</span>, <span class="keyword">sizeof</span> (vphi));</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; N);</span><br><span class="line">LL ans1 = phi_sieve (N);</span><br><span class="line"><span class="keyword">int</span> ans2 = mu_sieve (N);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld %d\n"</span>, ans1, ans2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœæ•™ç­› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢ã€ŒFWTã€</title>
      <link href="/2020/08/04/%E5%BF%AB%E9%80%9F%E6%B2%83%E5%B0%94%E4%BB%80%E5%8F%98%E6%8D%A2%E3%80%8CFWT%E3%80%8D/"/>
      <url>/2020/08/04/%E5%BF%AB%E9%80%9F%E6%B2%83%E5%B0%94%E4%BB%80%E5%8F%98%E6%8D%A2%E3%80%8CFWT%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="å¤„ç†é—®é¢˜"><a href="#å¤„ç†é—®é¢˜" class="headerlink" title="å¤„ç†é—®é¢˜"></a>å¤„ç†é—®é¢˜</h2><p>$$<br>C_i = \sum\limits_{i \oplus j} A_iB_j<br>$$</p><h2 id="ç¦»æ•£æ²ƒå°”ä»€å˜æ¢ã€ŒDWTã€"><a href="#ç¦»æ•£æ²ƒå°”ä»€å˜æ¢ã€ŒDWTã€" class="headerlink" title="ç¦»æ•£æ²ƒå°”ä»€å˜æ¢ã€ŒDWTã€"></a>ç¦»æ•£æ²ƒå°”ä»€å˜æ¢ã€ŒDWTã€</h2><p>è®¾ $DWT_i (A) = \sum\limits_{j = 0}^n A_jf(i, j)$ ï¼ˆç¬¬ä¸€æ¬¡çŸ¥é“åŸæ¥ç¦»æ•£å˜æ¢æ˜¯è¿™ä¹ˆè®¾çš„ï¼‰</p><p>åˆç”±äº<br>$$<br>\begin{aligned}<br>DWT_i(A)DWT_i(B) &amp;= DWT_i(C) \\<br>\sum\limits_{j = 0}^{n - 1} \sum\limits_{k = 0}^{n - 1} A_jB_kf(i, j)f(i, k) &amp;= \sum\limits_{j = 0}^{n - 1} \sum\limits_{k = 0}^{n - 1} A_jB_kf(i, j \oplus k)<br>\end{aligned}<br>$$<br>æ•… $f(i, j)f(i, k) = f(i, j \oplus k)â€‹$</p><p>äºæ˜¯å°±æœ‰ä¸€äº›ç»“è®º</p><ul><li>$and:  f(i, j) = [(i  and   j) = i]$ </li><li>$or:  f(i, j) = [(i  and  j) = j]$</li><li>$xor:  f(i, j) = (- 1)^{cnt (i  and  j)}$ ï¼ˆ$cnt (x)$ æ˜¯ $x$ çš„äºŒè¿›åˆ¶ä½æ•°ï¼‰</li></ul><p>è‡³äºè¯æ˜è‡ªå·±æ„ä¼šä¸€ä¸‹å°±å¥½äº†</p><p>åˆç”±äº $f(i, j)$ æ»¡è¶³äºŒè¿›åˆ¶æ‹†åˆ†ï¼Œå³<br>$$<br>f(i, j) = \prod\limits_{bit = 0}^{cntbit - 1} f(i_{bit}, j_{bit})<br>$$<br>é‚£ä¹ˆå°†å…¶å·¦å³æ‹†åˆ†ï¼Œæ¨ä¸€ä¸‹å¼å­ï¼Œå¾—ï¼ˆæ³¨æ„ä¸‹é¢çš„ $i_{bit}$ è¡¨ç¤ºçš„æ˜¯<strong>ä»é«˜åˆ°ä½</strong>çš„ç¬¬ $bitâ€‹$ ä½ï¼‰<br>$$<br>\begin{aligned}<br>DWT_i(A) &amp;= \sum\limits_{j = 0}^n A_jf(i, j) \\<br>&amp;= \sum\limits_{j = 0}^{\frac{n}{2} - 1} A_jf(i, j) + \sum\limits_{j = \frac{n}{2}}^{n - 1} A_jf(i, j)<br>\end{aligned}<br>$$<br>ç„¶åå°†å®ƒä»¬çš„æœ€é«˜ä½æå‡ºæ¥ï¼Œå¾—<br>$$<br>\begin{aligned}<br>DWT_i(A) = f(i_0, 0)\sum\limits_{j = 0}^{\frac{n}{2} - 1} A_j\prod_{bit = 1}^{cntbit - 1}  f(i_{bit}, j_{bit}) + f(i_0, 1)\sum\limits_{j = \frac{n}{2}}^{n - 1}A_j\prod_{bit = 1}^{cntbit - 1} f(i_{bit}, j_{bit})<br>\end{aligned}<br>$$<br>æ•´ç†ä¸€ä¸‹ï¼Œå¾— $(i \in [0, \frac{n}{2} - 1])$<br>$$<br>\begin{aligned}<br>DWT_i(A) &amp;= f(0, 0)DWT_{\frac{n}{2}}(A_{left}) + f(0, 1)DWT_{\frac{n}{2}}(A_{right}) \\<br>DWT_{i + \frac{n}{2}}(A) &amp;= f(1, 0))DWT_{\frac{n}{2}}(A_{left}) + f(1, 1)DWT_{\frac{n}{2}}(A_{right})<br>\end{aligned}<br>$$<br>è‡³äº $iDWT$ï¼Œå°±æ˜¯è§£ä¸ªäºŒå…ƒä¸€æ¬¡æ–¹ç¨‹çš„é—®é¢˜</p><p>æ¥ä¸‹æ¥åªè¦æŠŠ $FFT$ çš„éƒ¨åˆ†ç¨‹åºæ”¹ä¸€ä¸‹å°±å¥½äº†</p><p>ä¸‹é¢è®°å½•ä¸€äº›å¸¸è§å…¬å¼<br>$$<br>and:  a[i + j] += a[i + j + k]  (DWT) \\<br>and:  a[i + j] -= a[i + j + k]  (iDWT) \\<br> \\<br>or:  a[i + j + k] += a[i + j]  (DWT) \\<br>or:  a[i + j + k] -= a[i + j]  (iDWT) \\<br> \\<br>xor:  a[i + j] = a[i + j] + a[i + j + k],  a[i + j + k] = a[i + j] - a[i + j + k]  (DWT) \\<br>xor:  a[i + j] = \frac{a[i + j] + a[i + j + k]}{2},  a[i + j + k] = \frac{a[i + j] - a[i + j + k]}{2}  (iDWT)<br>$$</p><h2 id="ä»£ç ã€Œ-and-or-xor-ã€"><a href="#ä»£ç ã€Œ-and-or-xor-ã€" class="headerlink" title="ä»£ç ã€Œ$and,  or,  xor$ã€"></a>ä»£ç ã€Œ$and,  or,  xor$ã€</h2>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FWT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç³»æ•°çº¿æ€§é€’æ¨</title>
      <link href="/2020/08/04/%E5%B8%B8%E7%B3%BB%E6%95%B0%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8/"/>
      <url>/2020/08/04/%E5%B8%B8%E7%B3%BB%E6%95%B0%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><h3 id="å¤šé¡¹å¼é™¤æ³•-å–æ¨¡"><a href="#å¤šé¡¹å¼é™¤æ³•-å–æ¨¡" class="headerlink" title="å¤šé¡¹å¼é™¤æ³•|å–æ¨¡"></a>å¤šé¡¹å¼é™¤æ³•|å–æ¨¡</h3><p>è¯¥éƒ¨åˆ†è§ <a href="https://colythme.github.io/2020/07/22/å¤šé¡¹å¼æ“ä½œ/">å¤šé¡¹å¼æ“ä½œ</a></p><h3 id="ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡"><a href="#ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡" class="headerlink" title="ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡"></a>ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡</h3><p>ï¼ˆè¿™éƒ¨åˆ†æˆ‘ä¹Ÿä¸æ€ä¹ˆç†è§£ï¼Œå°±å¤§æ¦‚è®°ä¸ªç»“è®ºï¼‰</p><p>å¯¹ $n$ é˜¶çŸ©é˜µ $A$ çš„ç‰¹å¾å‘é‡ $\vec{v}$ ä¸ï¼Œæœ‰ç‰¹å¾å€¼ $\lambda$ æ»¡è¶³<br>$$<br>A\vec v = \lambda\vec v<br>$$<br>ç§»é¡¹åˆ™æœ‰ $(\lambda I - A)\vec v = 0$ï¼Œå…¶ä¸­ $I$ ä¸ºå•ä½çŸ©é˜µ</p><p>é‚£ä¹ˆæœ‰è§£çš„å……è¦æ¡ä»¶æ˜¯ $det(\lambda I - A) = 0$</p><p>ä»¤ $f(\lambda) = det(\lambda I - A)$ï¼Œå³æ­¤æ—¶å¯å°† $det (\lambda I - A)$ çœ‹ä½œä¸€ä¸ª $n$ é˜¶å¤šé¡¹å¼ï¼Œåˆ™ç§° $f(\lambda)$ ä¸ºçŸ©é˜µ $A$ çš„ç‰¹å¾å¤šé¡¹å¼ï¼Œå¯¹çŸ©é˜µ $A$ï¼Œå…¶ä»»æ„ç‰¹å¾å€¼ $\lambda_0$ éƒ½æ»¡è¶³ $f(\lambda_0) = 0$</p><h3 id="text-Hamiton-Cayley-å®šç†"><a href="#text-Hamiton-Cayley-å®šç†" class="headerlink" title="$\text{Hamiton-Cayley}$å®šç†"></a>$\text{Hamiton-Cayley}$å®šç†</h3><p>å¯¹çŸ©é˜µ $A$ åŠå…¶ç‰¹å¾å¤šé¡¹å¼ $f(x)$ï¼Œæ»¡è¶³ $f(A) = O$ï¼Œå…¶ä¸­ $O$ ä¸ºé›¶çŸ©é˜µ</p><p>è¯æ˜ç•™å‘</p><h2 id="å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨"><a href="#å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨" class="headerlink" title="å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨"></a>å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</h2><p>æ±‚ä¸€ä¸ªæ»¡è¶³ $k$ é˜¶é½æ¬¡çº¿æ€§é€’æ¨æ•°åˆ— $h_i$ çš„ç¬¬ $n$ é¡¹ï¼Œå³<br>$$<br>h_n = \sum\limits_{i = 1}^k f_i \times h_{n - i}<br>$$<br>å®ƒæœ‰ä¸‰ä¸ªç‰¹ç‚¹</p><ul><li>å¸¸ç³»æ•°ï¼šé€’æ¨ç³»æ•°ä¸ä¸‹æ ‡æ— å…³</li><li>é½æ¬¡ï¼šé€’æ¨å¼ä¸å­˜åœ¨å¸¸æ•°é¡¹ï¼Œå°±ç±»ä¼¼ $y = ax + b$ ä¸­ $b = 0$</li><li>çº¿æ€§ï¼šéƒ½ä¸ºä¸€æ¬¡é¡¹</li></ul><h3 id="çŸ©é˜µå¿«é€Ÿå¹‚"><a href="#çŸ©é˜µå¿«é€Ÿå¹‚" class="headerlink" title="çŸ©é˜µå¿«é€Ÿå¹‚"></a>çŸ©é˜µå¿«é€Ÿå¹‚</h3><p>åŠ é€ŸçŸ©é˜µ $A$ $\times$ åˆå§‹çŸ©é˜µ $H$ï¼š<br>$$<br>\begin{pmatrix}<br>f_1 &amp; f_2 &amp; f_3 &amp; \cdots &amp; f_n \\<br>1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\<br>0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\<br>\vdots &amp; \vdots &amp; \ddots &amp; \cdots &amp; \vdots \\<br>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1<br>\end{pmatrix}<br>\times<br>\begin{pmatrix}<br>h_k \\<br>\vdots \\<br>h_3 \\<br>h_2 \\<br>h_1<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>h_{k + 1} \\<br>\vdots \\<br>h_4 \\<br>h_3 \\<br>h_2<br>\end{pmatrix}<br>$$<br>é‚£ä¹ˆå¿«é€Ÿå¹‚ $A^nH$ å³å¯ï¼Œå¤æ‚åº¦ $O (k^3 \log n)$</p><h3 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><p>è€ƒè™‘ $A\vec v = \lambda\vec v$ï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨å­˜åœ¨<br>$$<br>\begin{pmatrix}<br>h_{k + 1} \\<br>\vdots \\<br>h_4 \\<br>h_3 \\<br>h_2<br>\end{pmatrix}<br>=<br>\begin{pmatrix}<br>\lambda h_k \\<br>\vdots \\<br>\lambda h_3 \\<br>\lambda h_2 \\<br>\lambda h_1<br>\end{pmatrix}<br>$$<br>æ¨å¹¿ä¸€ä¸‹ï¼Œ$h_n = \lambda^{n - 1} h_1$ï¼Œåˆ™<br>$$<br>\begin{aligned}<br>h_{k + 1} &amp;= f_1h_{k -1} + f_2h_{k - 2} + â€¦ + f_kh_1 \\<br>\lambda^kh_1 &amp;= f_1\lambda^{k - 1}h_1 + f_2\lambda^{k - 2}h_2 + â€¦ + f_kh_1 \\<br>\lambda^k &amp;= f_1\lambda^{k - 1} + f_2\lambda^{k - 2} + â€¦ + f_k<br>\end{aligned}<br>$$<br>å°† $\lambda$ æ›¿æ¢ä¸º $x$ï¼Œåˆ™æœ‰ $F(x) = x^k - f_1x^{k - 1} - f_2x^{k - 2} - â€¦ - f_k$</p><p>æ­¤æ—¶ $F(x)$ å°±æ˜¯çŸ©é˜µ $A$ çš„ç‰¹å¾å¤šé¡¹å¼ï¼Œæœ‰ $F(A) = 0$</p><p>è€ƒè™‘ç­‰å¼<br>$$<br>x^n = F(x)Q(x) + R(x)<br>$$<br>ä»¥ $A$ ä»£å…¥ï¼Œåˆ™æœ‰<br>$$<br>A^n = R(A)<br>$$<br>åˆ«å¿˜äº†ç°åœ¨è¦æ±‚çš„æ˜¯ $A^n\vec v$ï¼Œé‚£ä¹ˆä¸¤è¾¹åŒä¹˜ $\vec v$ï¼Œæœ‰ $A^n\vec v = R(A)\vec v$</p><p>$R(x)$ å¯ä»¥é€šè¿‡ç”± $A(x) = x^n$ å¯¹ $F(x)$ å–æ¨¡æ±‚å¾—ï¼Œæ³¨æ„æ­¤æ—¶ä¸èƒ½ç›´æ¥å–æ¨¡ï¼Œå› ä¸º $n$ å¯ä»¥éå¸¸å¤§ï¼ˆæ¯”å¦‚ $n = 1e9ï¼‰$ï¼Œæ— æ³•å­˜ä¸‹å¤šé¡¹å¼ $x^n$ï¼Œéœ€è¦é€šè¿‡å¿«é€Ÿå¹‚æ±‚è§£</p><p>è®¾ $R(x) = \sum\limits_{i = 0}^{k - 1} c_ix^i$ï¼Œåˆ™<br>$$<br>A^n\vec v = \sum\limits_{i = 0}^{k - 1}c_iA^i\vec v<br>$$<br>è€Œ $A^i\vec v$ å®é™…ä¸Šå°±æ˜¯<br>$$<br>\begin{pmatrix}<br>h_{k + i} \\<br>\vdots \\<br>h_{i + 3} \\<br>h_{i + 2} \\<br>h_{i + 1}<br>\end{pmatrix}<br>$$<br>$A$ çš„æ¬¡æ•°æœ€å¤š $k - 1$ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€å¤šåªä¼šå–åˆ°å‰ $2k - 1$ ä¸ª $h_i$ï¼Œæˆ‘ä»¬æœ€åè¦å–å¾—æ˜¯ $A^n\vec v$ çš„ç¬¬ä¸€ä½ï¼Œæ¯æ¬¡ä¹˜ä¸Šä¸€ä¸ª $A$ åˆ™ä»¤ $h$ æ•°ç»„å‘ä¸‹ç§»ä¸€ä½ï¼Œé‚£ä¹ˆæœ€ç»ˆç­”æ¡ˆå³ä¸º $ans = \sum\limits_{i = 0}^{k - 1} c_ih_i$</p><p>æ—¶é—´å¤æ‚åº¦ $O (k \log k \log n)$</p><p>å…¶å®æ¯æ¬¡åœ¨æ±‚å¤šé¡¹å¼å–æ¨¡çš„æ—¶å€™éƒ½æ˜¯å¯¹ $F(x)$ å–æ¨¡ï¼Œæ‰€ä»¥å¯ä»¥æå‰å¯¹ $F(x)$ é¢„å¤„ç†ï¼Œæ±‚å‡ºå…¶é€†ï¼Œé‚£ä¹ˆå¯ä»¥å°‘å¾ˆå¤šå¸¸æ•°ï¼ˆè™½ç„¶æˆ‘çš„å¸¸æ•°è¿˜æ˜¯è´¼å¤§å°±æ˜¯äº†ã€‚ã€‚ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">32000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN]= &#123;<span class="number">0</span>&#125;, limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">LL ome = power (inv == <span class="number">1</span> ? g : invg, (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">LL x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome % MOD) &#123;</span><br><span class="line">LL a1 = a[j + k], xa2 = x * a[j + mid + k] % MOD;</span><br><span class="line">a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">a[j + mid + k] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">LL A[MAXN], B[MAXN], O[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span> <span class="params">(LL* X, LL* Y, <span class="keyword">int</span> fn, <span class="keyword">int</span> fm, <span class="keyword">int</span> rst)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= fn + fm; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fn; i ++) A[i] = X[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fm; i ++) B[i] = Y[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = A[i] * B[i] % MOD;</span><br><span class="line">NTT (A, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= rst; i ++) X[i] = A[i] * invn % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = rst + <span class="number">1</span>; i &lt;= fn + fm; i ++) X[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* a)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123; a[<span class="number">0</span>] = power (O[<span class="number">0</span>], MOD - <span class="number">2</span>); <span class="keyword">return</span> ; &#125;</span><br><span class="line">inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, a);</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= deg &lt;&lt; <span class="number">1</span>; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++) A[i] = O[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg &lt;&lt; <span class="number">1</span>; i ++) B[i] = a[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) B[i] = B[i] * ((<span class="number">2l</span>l - A[i] * B[i] % MOD + MOD) % MOD) % MOD;</span><br><span class="line">NTT (B, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++) a[i] = B[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL R[MAXN], INVG[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prep</span> <span class="params">(LL* G, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i ++) O[i] = G[i];</span><br><span class="line">reverse (O, O + m + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - m + <span class="number">2</span>; i &lt;= m; i ++) O[i] = <span class="number">0</span>;</span><br><span class="line">inverse (n - m + <span class="number">1</span>, INVG);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PolyMod</span> <span class="params">(LL* F, LL* G, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123; <span class="comment">// F mod G = R</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++) R[i] = F[i];</span><br><span class="line">reverse (R, R + n + <span class="number">1</span>); mul (R, INVG, n, n - m + <span class="number">1</span>, n);</span><br><span class="line">reverse (R, R + n - m + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - m + <span class="number">1</span>; i &lt;= n; i ++) R[i] = <span class="number">0</span>;</span><br><span class="line">mul (R, G, n - m, m, n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i ++) R[i] = (F[i] - R[i] + MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++) &#123; F[i] = i &lt; m ? R[i] : <span class="number">0</span>; R[i] = <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K, L;</span><br><span class="line">LL F[MAXK]= &#123;<span class="number">0</span>&#125;, h[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL X[MAXN]= &#123;<span class="number">0</span>&#125;, ANS[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PolyPow</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; <span class="comment">// X ^ p (mod F)</span></span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) &#123; mul (ANS, X, K - <span class="number">1</span>, K - <span class="number">1</span>, L); PolyMod (ANS, F, L, K); &#125;</span><br><span class="line">mul (X, X, K - <span class="number">1</span>, K - <span class="number">1</span>, L); PolyMod (X, F, L, K);</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum (); L = (K - <span class="number">1</span>) &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++) F[K - i] = (MOD - getnum () % MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) h[i] = getnum () % MOD;</span><br><span class="line">F[K] = X[<span class="number">1</span>] = ANS[<span class="number">0</span>] = <span class="number">1</span>; prep (F, L, K);</span><br><span class="line">PolyPow (N);</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i ++) ans = (ans + ANS[i] * h[i] % MOD + MOD) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç³»æ•°éé½æ¬¡çº¿æ€§é€’æ¨"><a href="#å¸¸ç³»æ•°éé½æ¬¡çº¿æ€§é€’æ¨" class="headerlink" title="å¸¸ç³»æ•°éé½æ¬¡çº¿æ€§é€’æ¨"></a>å¸¸ç³»æ•°éé½æ¬¡çº¿æ€§é€’æ¨</h2><p>æ±‚ä¸€ä¸ªæ»¡è¶³ $k$ é˜¶é½æ¬¡çº¿æ€§é€’æ¨æ•°åˆ— $h_i$ çš„ç¬¬ $n$ é¡¹ï¼Œå³<br>$$<br>h_n = P(n) + \sum\limits_{i = 1}^k f_i \times h_{n - i}<br>$$</p>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šé¡¹å¼ </tag>
            
            <tag> FFT/NTT </tag>
            
            <tag> çŸ©é˜µä¹˜æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ´›è°·4233 - å°„å‘½ä¸¸æ–‡çš„ç¬”è®°</title>
      <link href="/2020/08/04/%E5%B0%84%E5%91%BD%E4%B8%B8%E6%96%87%E7%9A%84%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/08/04/%E5%B0%84%E5%91%BD%E4%B8%B8%E6%96%87%E7%9A%84%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>æ˜¾ç„¶ç­”æ¡ˆæ˜¯æ€»å“ˆå¯†é¡¿å›è·¯æ•°é™¤ä»¥å€¼å¾—è®°å½•çš„ç«èµ›å›¾æ•°</p><p>é‚£ä¹ˆå…ˆæ±‚è§£æ€»å“ˆå¯†é¡¿å›è·¯æ•°ï¼Œè€ƒè™‘æ¯ä¸ªå“ˆå¯†é¡¿å›è·¯ä¼šåœ¨å‡ ä¸ªå€¼å¾—è®°å½•çš„ç«èµ›å›¾ä¸­ï¼Œåˆ™æœ‰<br>$$<br>Hamitons = (n - 1)!2^{C_n^2 - n}<br>$$<br>å³æ€»å…±æœ‰ $(n - 1)!$ ç§å“ˆå¯†é¡¿å›è·¯ï¼Œç„¶åå‰©ä¸‹çš„è¾¹éšä¾¿é€‰</p><p>äºæ˜¯ç°åœ¨è€ƒè™‘å€¼å¾—è®°å½•çš„ç«èµ›å›¾æ•°</p><p>é¦–å…ˆå¦‚æœä¸€ä¸ªç«èµ›å›¾è¦æœ‰å“ˆå¯†é¡¿å›è·¯ï¼Œé‚£ä¹ˆå®ƒè‡³å°‘è¦æœ‰ä¸€ä¸ªåŒ…å«æ‰€æœ‰èŠ‚ç‚¹çš„ç¯ï¼Œå³è¯¥å›¾æ˜¯å¼ºè¿é€šçš„ï¼Œå¹¶ä¸”æ˜¾ç„¶éå¼ºè¿é€šç«èµ›å›¾å®ƒä¸€å®šä¸å­˜åœ¨å“ˆå¯†é¡¿å›è·¯ï¼Œæ‰€ä»¥æœ‰ç»“è®º</p><blockquote><p>æœ‰ä¸”ä»…æœ‰å¼ºè¿é€šç«èµ›å›¾å­˜åœ¨å“ˆå¯†é¡¿å›è·¯</p></blockquote><p>é‚£ä¹ˆé—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£å¼ºè¿é€šç«èµ›å›¾</p><p>å‘ç°æ­£é¢éš¾ä»¥æ±‚è§£ï¼Œå°±è€ƒè™‘åé¢æ±‚è§£</p><p>è®¾ $f_n$ è¡¨ç¤º $n$ ä¸ªèŠ‚ç‚¹çš„å¼ºè¿é€šç«èµ›å›¾æ•°ï¼Œ$g_n$ è¡¨ç¤º $n$ ä¸ªèŠ‚ç‚¹çš„ç«èµ›å›¾æ•°ï¼ˆå³ $2^{C_n^2}$ï¼‰ï¼Œå¯å¾— $DP$ æ–¹ç¨‹<br>$$<br>f_n = g_n - \sum\limits_{j = 1}^{n - 1} f_jg_{n - j}\dbinom{n}{j}<br>$$<br>å…¶ä¸­æ±‚è§£éå¼ºè¿é€šç«èµ›å›¾éƒ¨åˆ†æ˜¯æ¯æ¬¡å°†æ‹“æ‰‘åºæœ€å°çš„å¼ºè¿é€šåˆ†é‡æå–å‡ºæ¥è®¡æ•°ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ç‚¹éšæ„è¿æ¥ï¼ˆæ³¨æ„ï¼Œæ­¤æ—¶å–çš„æ˜¯<strong>æ‹“æ‰‘åºæœ€å°çš„å¼ºè”é€šåˆ†é‡</strong>ï¼Œæ•…è¯¥å¼ºè”é€šåˆ†é‡ä¸å…¶å®ƒè¿é€šåˆ†é‡çš„è¿è¾¹æ–¹å‘æ˜¯å›ºå®šçš„ï¼‰</p><p>ç°åœ¨è€ƒè™‘ä¼˜åŒ–<br>$$<br>\frac{f_n}{n!} = \frac{g_n}{n!} - \sum\limits_{j = 1}^{n - 1} \frac{f_j}{j!}\frac{g_{n - j}}{(n - j)!}<br>$$</p><p>ä»¤æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•° $F(x) = \sum\limits_n^{\infty} \frac{f_n}{n!}, G(x) = \sum\limits_n^{\infty} \frac{g_n}{n!}$ï¼Œæ˜“çŸ¥<br>$$<br>\begin{aligned}<br>F(x) &amp;= G(x) - F(x)G(x) \\<br>F(x) &amp;= \frac{G(x)}{1 + G(x)}<br>\end{aligned}<br>$$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFT</span> <span class="params">(LL* a, <span class="keyword">int</span> limit, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">LL omega = power (inv == <span class="number">1</span> ? g : invg, <span class="number">1l</span>l * (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">LL x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * omega % MOD) &#123;</span><br><span class="line">LL a1 = a[j + k], xa2 = x * a[j + mid + k] % MOD;</span><br><span class="line">a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">a[j + mid + k] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">LL a1[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;, a2[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* A, LL* B, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> limit, lim;</span><br><span class="line"><span class="keyword">for</span> (limit = <span class="number">1</span>, lim = <span class="number">0</span>; limit &lt; n + m; limit &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">a1[i] = a2[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">a1[i] = A[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i ++)</span><br><span class="line">a2[i] = B[i];</span><br><span class="line">DFT (a1, limit, <span class="number">1</span>), DFT (a2, limit, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">a1[i] = a1[i] * a2[i] % MOD;</span><br><span class="line">DFT (a1, limit, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (limit, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">A[i] = a1[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL temp[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* A, LL* B)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123;</span><br><span class="line">B[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, A, B);</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= (deg &lt;&lt; <span class="number">1</span>); n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">temp[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">temp[i] = A[i];</span><br><span class="line">NTT (temp, B, deg, deg), NTT (temp, B, deg, deg);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">B[i] = (<span class="number">2l</span>l * B[i] % MOD - temp[i] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">LL F[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL G[MAXN]= &#123;<span class="number">0</span>&#125;, invG[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL answer[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; N);</span><br><span class="line">fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">F[i] = G[i] = power (<span class="number">2l</span>l, <span class="number">1l</span>l * i * (i - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) * power (fact[i], MOD - <span class="number">2</span>);</span><br><span class="line">G[<span class="number">0</span>] ++;</span><br><span class="line">inverse (N, G, invG);</span><br><span class="line">NTT (F, invG, N, N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i == <span class="number">1</span>)</span><br><span class="line">answer[i] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">2</span>)</span><br><span class="line">answer[i] = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">answer[i] = fact[i - <span class="number">1</span>] * power (<span class="number">2l</span>l, <span class="number">1l</span>l * i * (i - <span class="number">1</span>) / <span class="number">2l</span>l - i) % MOD * power (F[i] * fact[i] % MOD, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, answer[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯¼æ•°ä¸ç§¯åˆ†</title>
      <link href="/2020/08/04/%E5%AF%BC%E6%95%B0%E4%B8%8E%E7%A7%AF%E5%88%86/"/>
      <url>/2020/08/04/%E5%AF%BC%E6%95%B0%E4%B8%8E%E7%A7%AF%E5%88%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="å¯¼æ•°"><a href="#å¯¼æ•°" class="headerlink" title="å¯¼æ•°"></a>å¯¼æ•°</h2><h3 id="å¹³å‡å˜åŒ–ç‡"><a href="#å¹³å‡å˜åŒ–ç‡" class="headerlink" title="å¹³å‡å˜åŒ–ç‡"></a>å¹³å‡å˜åŒ–ç‡</h3><p>å‡½æ•° $y = f(x)$ ä» $x_1$ åˆ° $x_2$ çš„å¹³å‡å˜åŒ–ç‡ä¸º $\frac{f(x_2) - f(x_1)}{x_2 - x_1}$ï¼Œç®€è®°ä½œ $\frac{\Delta y}{\Delta x}$</p><h3 id="ç¬æ—¶å˜åŒ–ç‡ä¸å¯¼æ•°"><a href="#ç¬æ—¶å˜åŒ–ç‡ä¸å¯¼æ•°" class="headerlink" title="ç¬æ—¶å˜åŒ–ç‡ä¸å¯¼æ•°"></a>ç¬æ—¶å˜åŒ–ç‡ä¸å¯¼æ•°</h3><p>å‡½æ•° $y = f(x)$ åœ¨ $x = x_0$ å¤„çš„ç¬æ—¶å˜åŒ–ç‡æ˜¯å‡½æ•° $f(x)$ ä» $x_0$ åˆ° $x_0 + \Delta x$ çš„å¹³å‡å˜åŒ–ç‡åœ¨ $\Delta x \to 0$ æ—¶çš„æé™ï¼Œè®°ä½œ $\lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x) - f(x)}{\Delta x} = \lim_{\Delta x \to 0} \frac{\Delta y}{\Delta x}$</p><p>ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬ç§°ä¸Šæ–‡çš„ç¬æ—¶å˜åŒ–ç‡ä¸ºå‡½æ•° $y = f(x)$ åœ¨ $x = x_0$ å¤„çš„å¯¼æ•°ï¼Œè®°ä½œ $fâ€™(x_0)$ æˆ– $\frac{\mathrm{d} y}{\mathrm{d} x} \bigg|_{x = x_0}$</p><p>å®é™…ä¸Šï¼Œå¯¼æ•°æè¿°çš„å³ä¸ºä»»ä½•äº‹ç‰©çš„ç¬æ—¶å˜åŒ–ç‡</p><p>Exampleï¼š</p><p>æ±‚ $y = f(x) = x^2 - 7x + 5$ åœ¨ $x = 2$ çš„å¯¼æ•°ï¼Œåˆ™æœ‰<br>$$<br>\begin{aligned} \frac{\Delta y}{\Delta x} &amp;= \frac{f(2 + \Delta x) - f(2)}{\Delta x} \\ &amp;= \Delta x - 3  \end{aligned}<br>$$<br>æ‰€ä»¥<br>$$<br>fâ€™(2) = \lim\limits_{\Delta x \to 0} \frac{\Delta y}{\Delta x} = \lim\limits_{\Delta x \to 0} (\Delta x - 3) = - 3<br>$$</p><h3 id="å¸¸è§çš„åŸºæœ¬åˆç­‰å‡½æ•°çš„å¯¼æ•°å…¬å¼"><a href="#å¸¸è§çš„åŸºæœ¬åˆç­‰å‡½æ•°çš„å¯¼æ•°å…¬å¼" class="headerlink" title="å¸¸è§çš„åŸºæœ¬åˆç­‰å‡½æ•°çš„å¯¼æ•°å…¬å¼"></a>å¸¸è§çš„åŸºæœ¬åˆç­‰å‡½æ•°çš„å¯¼æ•°å…¬å¼</h3><table><thead><tr><th align="center">$f(x)$</th><th align="center">$fâ€™(x)$</th><th align="center">$f(x)$</th><th align="center">$fâ€™(x)$</th></tr></thead><tbody><tr><td align="center">$c$</td><td align="center">$0$</td><td align="center">$x^a$</td><td align="center">$ax^{a - 1}$</td></tr><tr><td align="center">$\sin x$</td><td align="center">$\cos x$</td><td align="center">$\cos x$</td><td align="center">$- \sin x$</td></tr><tr><td align="center">$a^x$</td><td align="center">$a^x \ln a$</td><td align="center">$e^x$</td><td align="center">$e^x$</td></tr><tr><td align="center">$\log_a x$</td><td align="center">$\frac{1}{x \ln a}$</td><td align="center">$\ln x$</td><td align="center">$\frac{1}{x}$</td></tr><tr><td align="center">$\tan x$</td><td align="center">$\sec^2 x = \frac{1}{\cos^2 x}$</td><td align="center">$\cot x$</td><td align="center">$- \csc^2 x = - \frac{1}{\sin^2 x}$</td></tr></tbody></table><h3 id="æ±‚å¯¼æ³•åˆ™"><a href="#æ±‚å¯¼æ³•åˆ™" class="headerlink" title="æ±‚å¯¼æ³•åˆ™"></a>æ±‚å¯¼æ³•åˆ™</h3><p>$$<br>[f(x) \pm g(x)]â€™ = fâ€™(x) \pm gâ€™(x) \\<br>[cf(x)]â€™ = cfâ€™(x) \\<br>[f(x) \cdot g(x)]â€™ = fâ€™(x)g(x) + f(x)gâ€™(x) \\<br>[\frac{f(x)}{g(x)}]â€™ = \frac{fâ€™(x)g(x) - f(x)gâ€™(x)}{[g(x)]^2}<br>$$</p><p>å¤åˆå‡½æ•° $y = f(g(x))â€‹$ çš„å¯¼æ•°å’Œå‡½æ•° $y = f(u), u = g(x)â€‹$ çš„å¯¼æ•°é—´çš„å…³ç³»ä¸º $y_xâ€™ = y_uâ€™ \cdot u_xâ€™â€‹$ï¼Œå³ $yâ€‹$ å¯¹ $xâ€‹$ çš„å¯¼æ•°ï¼Œç­‰äº $yâ€‹$ å¯¹ $uâ€‹$ çš„å¯¼æ•°ä¸ $uâ€‹$ å¯¹ $xâ€‹$ çš„å¯¼æ•°çš„ä¹˜ç§¯</p><p>Exampleï¼š</p><p>å¯¹ $y = cos^2 \left(2x + \frac{\pi}{3}\right)$ æ±‚å¯¼<br>$$<br>è¿™ä¸ªå¤åˆå‡½æ•°æ˜¯ f(x) = x^2 å¥— f(x) = \cos x å¥— f(x) = 2x + \frac{\pi}{3} \\<br>å®¹æ˜“å¾—åˆ° yâ€™ = -4\sin (2x + \frac{\pi}{3})\cos (2x + \frac{\pi}{3}) \\<br>åˆ™æœ‰ yâ€™ = -2\sin (4x + \frac{2\pi}{3})<br>$$</p><h3 id="åå¯¼æ•°"><a href="#åå¯¼æ•°" class="headerlink" title="åå¯¼æ•°"></a>åå¯¼æ•°</h3><p>å¦‚æœæœ‰å‡½æ•°è‡ªå˜é‡ä¸ªæ•°å¤§äºä¸€ï¼Œå¦‚<br>$$<br>f(x, y) = x^2 + xy + y^2<br>$$<br>é‚£ä¹ˆå¯ä»¥å›ºå®šä¸€ä¸ªå¹³é¢ï¼Œå¦‚ $x$ å¹³é¢ï¼Œé‚£ä¹ˆ $f(x, y)$ å¯ä»¥çœ‹ä½œæ˜¯å…³äº $y$ çš„å‚æ•°å‡½æ•° $f_x(y)$ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ª $x$ å®šä¹‰äº†ä¸€ä¸ªä¸€å…ƒå‡½æ•° $f_x(y)$</p><p>æ¯”å¦‚ç°åœ¨ä»¤ $x = a$ï¼Œåˆ™æœ‰<br>$$<br>f_a(y) = a^2 + ay + y^2<br>$$<br>å¯¹å…¶æ±‚å¯¼ï¼Œåˆ™æœ‰<br>$$<br>fâ€™_a(y) = a + 2y<br>$$<br>é‚£ä¹ˆå¯¹äºæ‰€æœ‰ $x$ çš„å–å€¼ï¼Œå®šä¹‰<br>$$<br>\frac{\partial f}{\partial y}(x, y) = x + 2y<br>$$<br>è¿™å°±æ˜¯ $f$ å…³äº $y$ çš„åå¯¼æ•°</p><p>é‚£ä¹ˆå¯¹äºå¤šå…ƒå‡½æ•° $f(x_1, x_2, â€¦, x_n)$ åœ¨ç‚¹ $(a_1, a_2, â€¦, a_n)$ å…³äº $x_k$ çš„åå¯¼æ•°å®šä¹‰ä¸º<br>$$<br>\frac{\partial f}{\partial x_k}(a_1, â€¦, a_n) = \lim\limits_{\Delta x_k \to -} \frac{f(a_1, â€¦, a_k + \Delta x_k, â€¦, a_n) - f(a_1, â€¦, a_n)}{\Delta x_k}<br>$$<br>è¿™å°±åšåˆ°äº†åå¯¼æ•°é€šè¿‡ä¸€å…ƒå‡½æ•°è¿›è¡Œè®¡ç®—</p><p>è¿™è¯´æ˜<br>$$<br>\frac{\partial f}{\partial x_k}(a_1, â€¦, a_n) = \frac{\mathrm{d} f(a_1, â€¦, a_{k - 1}, a_{k + 1}, â€¦, a_n)}{\mathrm{d} x_k}(a_1, â€¦, a_n)<br>$$</p><h3 id="é«˜é˜¶å¯¼æ•°"><a href="#é«˜é˜¶å¯¼æ•°" class="headerlink" title="é«˜é˜¶å¯¼æ•°"></a>é«˜é˜¶å¯¼æ•°</h3><h4 id="äºŒé˜¶å¯¼æ•°"><a href="#äºŒé˜¶å¯¼æ•°" class="headerlink" title="äºŒé˜¶å¯¼æ•°"></a>äºŒé˜¶å¯¼æ•°</h4><p>å¦‚ä½•å‡½æ•°çš„å¯¼æ•° $fâ€™(x)$ åœ¨ $x$ å¤„å¯å¯¼ï¼Œåˆ™ç§° $[fâ€™(x)]â€™$ ä¸º $x$ çš„äºŒé˜¶å¯¼æ•°</p><h4 id="é«˜é˜¶å¯¼æ•°-1"><a href="#é«˜é˜¶å¯¼æ•°-1" class="headerlink" title="é«˜é˜¶å¯¼æ•°"></a>é«˜é˜¶å¯¼æ•°</h4><p>é‚£ä¹ˆé«˜é˜¶å¯¼æ•°çš„å®šä¹‰å³ä¸ºäºŒé˜¶å¯¼æ•°çš„æ‰©å±•</p><p>$n$ é˜¶å¯¼æ•°è®°ä½œ $f^{(n)}(x), y^{(n)}, \frac{\mathrm{d}^ny}{\mathrm{d}x^n}$ æˆ– $\frac{\mathrm{d}^nf(x)}{\mathrm{d}x^n}$</p><h4 id="é«˜é˜¶å¯¼æ•°æ±‚å¯¼æ³•åˆ™"><a href="#é«˜é˜¶å¯¼æ•°æ±‚å¯¼æ³•åˆ™" class="headerlink" title="é«˜é˜¶å¯¼æ•°æ±‚å¯¼æ³•åˆ™"></a>é«˜é˜¶å¯¼æ•°æ±‚å¯¼æ³•åˆ™</h4><p>$$<br>\frac{\mathrm{d}^n}{\mathrm{d}^nx^n}(cu) = c\frac{\mathrm{d}}{\mathrm{d}x^n}u \\<br>\frac{\mathrm{d}^n}{\mathrm{d}x^n}(u \pm v) = \frac{\mathrm{d}^n}{\mathrm{d}x^n}u \pm \frac{\mathrm{d}^n}{\mathrm{d}x^n}v \\<br>\frac{\mathrm{d}^n}{\mathrm{d}x^n}(u \times v) = \sum\limits_{k = 0}^n \dbinom{n}{k}\frac{\mathrm{d}^{d - k}}{\mathrm{d}x^{d - k}}u\frac{\mathrm{d^k}}{\mathrm{d}x^k}v ã€Œè±å¸ƒå°¼å…¹å…¬å¼ã€<br>$$</p><h4 id="å¸¸ç”¨é«˜é˜¶å¯¼æ•°å…¬å¼"><a href="#å¸¸ç”¨é«˜é˜¶å¯¼æ•°å…¬å¼" class="headerlink" title="å¸¸ç”¨é«˜é˜¶å¯¼æ•°å…¬å¼"></a>å¸¸ç”¨é«˜é˜¶å¯¼æ•°å…¬å¼</h4><p>$$<br>(x^{\alpha})^{(n)} = x^{\alpha - n} \prod\limits_{k = 0}^{n - 1}(\alpha - k) \\<br>(\frac{1}{x})^{(n)} = (- 1)^n\frac{n!}{x^{n + 1}} \\<br>(\ln x)^{(n)} = (- 1)^{n - 1}\frac{(n - 1)!}{x^n} \\<br>(e^x)^{(n)} = e^x \\<br>(a^x){(n)} = a^x \cdot \ln^n a (a &gt; 0) \\<br>(\sin (kx + b))^{(n)} = k^n\sin (kx + b + \frac{n\pi}{2}) \\<br>(\cos (kx + b))^{(n)} = k^n\cos (kx + b + \frac{n\pi}{2})<br>$$</p><h2 id="ç§¯åˆ†"><a href="#ç§¯åˆ†" class="headerlink" title="ç§¯åˆ†"></a>ç§¯åˆ†</h2><h3 id="å®šç§¯åˆ†"><a href="#å®šç§¯åˆ†" class="headerlink" title="å®šç§¯åˆ†"></a>å®šç§¯åˆ†</h3><p>å‡½æ•° $f(x)$ åœ¨åŒºé—´ $[a, b]$ ä¸Šè¿ç»­ï¼Œç”¨åˆ†ç‚¹ $a = x_0 &lt; x_1 &lt; â€¦ &lt; x_{i - 1} &lt; x_i &lt; â€¦ &lt; x_n = b$ï¼Œåœ¨æ¯ä¸ªå°åŒºé—´ $[x_{i - 1}, x_i]$ ä¸Šäººå»ä¸€ç‚¹ $\xi (i = 1, 2, â€¦, n)$ï¼Œä½œå’Œå¼ $S_n = \sum\limits_{i = 1}^n f(\xi_i)\Delta x = \sum\limits_{i = 1}^n \frac{b - a}{n} f(\xi_i)$ï¼Œå½“ $n \to \infty$ æ—¶ï¼Œå’Œå¼æ— é™æ¥è¿‘çš„å¸¸æ•°è¢«ç§°ä½œå‡½æ•° $f(x)$ åœ¨åŒºé—´ $[a, b]$ ä¸Šçš„å®šç§¯åˆ†ï¼Œè®°ä½œ $\int_a^b f(x) \mathrm{d} x = \lim\limits_{n \to \infty} \sum\limits_{i = 1}^n \frac{b - a}{n} f(\xi_i)$ ï¼Œ$a, b$ åˆ†åˆ«ç§°ä½œç§¯åˆ†ä¸‹é™ä¸ç§¯åˆ†ä¸Šé™ï¼ŒåŒºé—´ $[a, b]$ ç§°ä½œç§¯åˆ†åŒºé—´ï¼Œ$f(x)$ ç§°ä½œè¢«ç§¯å‡½æ•°ï¼Œ$x$ ç§°ä½œç§¯åˆ†å˜é‡ï¼Œ$f(x)\, \mathrm{d} x$ ç§°ä½œç§¯å¼</p><p>å…¶å‡ ä½•æ„ä¹‰è¡¨ç¤ºç”±ç›´çº¿ $x = a, x = b, y = 0â€‹$ åŠæ›²çº¿ $y = f(x)â€‹$ æ‰€å›´æˆçš„æ›²è¾¹æ¢¯å½¢é¢ç§¯</p><p>å½“ $x \in [a, b]â€‹$ æ—¶ï¼Œè‹¥ $f(x) &lt; 0â€‹$ï¼Œåˆ™ç›´çº¿ $x = a, x = b, xâ€‹$ è½´å’Œæ›²çº¿ $f(x)â€‹$ å›´æˆçš„å›¾å½¢çš„é¢ç§¯åº”ä¸º $- \int_a^b f(x) \mathrm{d} xâ€‹$</p><h4 id="å®šç§¯åˆ†çš„æ€§è´¨"><a href="#å®šç§¯åˆ†çš„æ€§è´¨" class="headerlink" title="å®šç§¯åˆ†çš„æ€§è´¨"></a>å®šç§¯åˆ†çš„æ€§è´¨</h4><p>$$<br>\int_a^b kf(x) \mathrm{d} x = k\int_a^b f(x) \mathrm{d} \\<br>\int_a^b[f_1(x) \pm f_2(x)] \mathrm{d} x = \int_a^b f_1(x) \mathrm{d} x \pm \int_a^b f_2(x) \mathrm{d} x \\<br>\int_a^b f(x) \mathrm{d} = \int_a^c f(x) \mathrm{d} x + \int_c^b f(x) \mathrm{d} x (å…¶ä¸­ a &lt; c &lt; b)<br>$$</p><h3 id="å¾®ç§¯åˆ†åŸºæœ¬å®šç†"><a href="#å¾®ç§¯åˆ†åŸºæœ¬å®šç†" class="headerlink" title="å¾®ç§¯åˆ†åŸºæœ¬å®šç†"></a>å¾®ç§¯åˆ†åŸºæœ¬å®šç†</h3><p>ä¸€èˆ¬åœ°ï¼Œå¦‚æœ $f(x)$ æ˜¯åŒºé—´ $[a, b]$ ä¸Šçš„è¿ç»­å‡½æ•°ï¼Œå¹¶ä¸” $Fâ€™(x) = f(x)$ï¼Œé‚£ä¹ˆ<br>$$<br>\int_a^b f(x) \mathrm{d} x = F(x) \big|_a^b = F(b) - F(a)<br>$$</p><h3 id="ä¸å®šç§¯åˆ†"><a href="#ä¸å®šç§¯åˆ†" class="headerlink" title="ä¸å®šç§¯åˆ†"></a>ä¸å®šç§¯åˆ†</h3><p>ä¸å®šç§¯åˆ†å®é™…ä¸Šå°±æ˜¯ $f(x)$ çš„åŸå‡½æ•° $F(x)$ï¼Œ$F(x)$ ä¹Ÿè¢«ç§°ä½œ $f(x)$ çš„ä¸å®šç§¯åˆ†</p><p>å‡½æ•°æ— $f = \{F(x) + C | C \in \mathbb{R}\}â€‹$ ç§°ä¸ºå‡½æ•° $f = kâ€‹$ çš„åŸå‡½æ•°æ—ï¼Œä¹Ÿå°±æ˜¯ $f = k(x)â€‹$ çš„æ‰€æœ‰å¯èƒ½çš„åŸå‡½æ•°çš„é›†åˆï¼Œå…¶ä¸­ $f = Câ€‹$ ç§°ä½œç§¯åˆ†å¸¸æ•°ï¼Œæ˜¯ $f = k(x)â€‹$ ç»è¿‡å‚ç›´å¹³ç§»å¾—åˆ°çš„ä¸€ç»„å¸¸æ•°ã€Œå› ä¸ºä¸ç®¡æ€ä¹ˆæ ·å¯¹äºæ¯ä¸ª $xâ€‹$ å®ƒä»¬çš„å¯¼æ•°æ˜¯ç›¸åŒçš„ã€</p><h3 id="å¸¸è§ä¸å®šç§¯åˆ†å…¬å¼è¡¨"><a href="#å¸¸è§ä¸å®šç§¯åˆ†å…¬å¼è¡¨" class="headerlink" title="å¸¸è§ä¸å®šç§¯åˆ†å…¬å¼è¡¨"></a>å¸¸è§ä¸å®šç§¯åˆ†å…¬å¼è¡¨</h3><table><thead><tr><th align="center">$\int_a^b c \mathrm{d}x = cx \mid_a^b$</th></tr></thead><tbody><tr><td align="center">$\int_a^b x^n \mathrm{d}x = \frac{1}{n + 1}x^{n + 1} \mid_a^b$</td></tr><tr><td align="center">$\int_a^b \frac{1}{x} \mathrm{d}x = \ln x \mid_a^b$</td></tr><tr><td align="center">$\int_a^b \sin x \mathrm{d}x = - \cos x \mid_a^b$</td></tr><tr><td align="center">$\int_a^b \cos x \mathrm{d}x = \sin x \mid_a^b$</td></tr><tr><td align="center">$\int_a^b e^x \mathrm{d}x = e^x \mid_a^b$</td></tr><tr><td align="center">$\int_a^b a^x \mathrm{d}x = \frac{a^x}{\ln a} \mid_a^b$ $(a &gt; 0$ ä¸” $a \neq 1)$</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> æ•°å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­—ç¬¦ä¸²ç±»é¢˜è®°å½•</title>
      <link href="/2020/08/04/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2020/08/04/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="åç¼€æ•°ç»„"><a href="#åç¼€æ•°ç»„" class="headerlink" title="åç¼€æ•°ç»„"></a>åç¼€æ•°ç»„</h2><h3 id="åœ¨æ–‡æœ¬ä¸²ä¸­å¯»æ‰¾å­ä¸²"><a href="#åœ¨æ–‡æœ¬ä¸²ä¸­å¯»æ‰¾å­ä¸²" class="headerlink" title="åœ¨æ–‡æœ¬ä¸²ä¸­å¯»æ‰¾å­ä¸²"></a>åœ¨æ–‡æœ¬ä¸²ä¸­å¯»æ‰¾å­ä¸²</h3><p>åœ¨æ–‡æœ¬ä¸² $T$ ä¸­å¯»æ‰¾æ¨¡å¼ä¸² $S$ï¼Œé‚£ä¹ˆ $S$ ä¸€å®šæ˜¯ $T$ çš„æŸä¸ªåç¼€çš„å‰ç¼€ï¼Œåç¼€æ’åºåï¼Œåœ¨ $SA$ ä¸­äºŒåˆ† $S$ çš„ä½ç½®ï¼Œæ¯æ¬¡ $check$ æ¯”è¾ƒæ—¶é—´ $O (|S|)$ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ $O (|S| \log |T|)$</p><h3 id="æ¯”è¾ƒä¸¤ä¸ªå­ä¸²çš„å¤§å°å…³ç³»"><a href="#æ¯”è¾ƒä¸¤ä¸ªå­ä¸²çš„å¤§å°å…³ç³»" class="headerlink" title="æ¯”è¾ƒä¸¤ä¸ªå­ä¸²çš„å¤§å°å…³ç³»"></a>æ¯”è¾ƒä¸¤ä¸ªå­ä¸²çš„å¤§å°å…³ç³»</h3><p>æ¯”è¾ƒ $S$ çš„å­ä¸² $A = S[l_1â€¦r_1], B = S[l_2â€¦r_2]$ çš„å¤§å°å…³ç³»</p><p>è‹¥ $lcp (l_1, l_2) \ge \min (|A|, |B|)$ï¼Œåˆ™ $A &lt; B \Longleftrightarrow |A| &lt; |B|$ï¼Œåä¹‹ $A &lt; B \Longleftrightarrow rk_{l_1} &lt; rk_{l_2}$</p><h3 id="æœ¬è´¨ä¸åŒå­ä¸²æ•°ç›®"><a href="#æœ¬è´¨ä¸åŒå­ä¸²æ•°ç›®" class="headerlink" title="æœ¬è´¨ä¸åŒå­ä¸²æ•°ç›®"></a>æœ¬è´¨ä¸åŒå­ä¸²æ•°ç›®</h3><p>è®¾å­—ç¬¦ä¸² $S$ é•¿åº¦ä¸º $n$</p><p>$ans = \frac{n(n + 1)}2 - \sum\limits_{i = 2}^n height[i]$</p><h3 id="ä»å­—ç¬¦ä¸²é¦–æˆ–å°¾å–å­—ç¬¦æ„æˆæœ€å°å­—å…¸åºçš„å­—ç¬¦ä¸²"><a href="#ä»å­—ç¬¦ä¸²é¦–æˆ–å°¾å–å­—ç¬¦æ„æˆæœ€å°å­—å…¸åºçš„å­—ç¬¦ä¸²" class="headerlink" title="ä»å­—ç¬¦ä¸²é¦–æˆ–å°¾å–å­—ç¬¦æ„æˆæœ€å°å­—å…¸åºçš„å­—ç¬¦ä¸²"></a>ä»å­—ç¬¦ä¸²é¦–æˆ–å°¾å–å­—ç¬¦æ„æˆæœ€å°å­—å…¸åºçš„å­—ç¬¦ä¸²</h3><p><a href="https://www.luogu.com.cn/problem/P2870" target="_blank" rel="noopener">[USACO07DEC]Best Cow Line G</a></p><p>æœ€åŸºæœ¬è´ªå¿ƒï¼Œè‹¥ä¸¤ç«¯å­—ç¬¦ä¸åŒï¼Œä¼˜å…ˆå–å¤§çš„ï¼Œé‚£ä¹ˆé—®é¢˜å°±åœ¨äºä¸¤ç«¯ç›¸åŒ</p><p>è®¾ $pre_i, suf_i$ åˆ†åˆ«è¡¨ç¤ºå­—ç¬¦ä¸² $i$ å¼€å§‹çš„å‰ã€åç¼€ï¼Œé‚£ä¹ˆæ¯æ¬¡åªè¦æ¯”è¾ƒ $pre_i$ å’Œ $suf_i$ çš„å¤§å°å°±å¯ä»¥å†³å®šï¼Œä½†æ˜¯è¿™æ ·æ˜¯ $O (n^2)$ çš„</p><p>è€ƒè™‘å°†åä¸²éš”ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦æ’åœ¨åŸä¸²åï¼Œè·‘ä¸€è¾¹åç¼€æ•°ç»„ï¼Œå‡è®¾æ­¤æ—¶åŸä¸²å‰©ä½™ $[l, r]$ æ²¡å¤„ç†ï¼Œé‚£ä¹ˆåªè¦æ¯”è¾ƒ $SA[2n - l + 2]$ å’Œ $SA[r]$ å³å¯ï¼ˆä¸²ä»¥ $1$ ä¸ºèµ·å§‹ä½ç½®ï¼‰</p><h3 id="åˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨æŸå­ä¸²ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡"><a href="#åˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨æŸå­ä¸²ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡" class="headerlink" title="åˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨æŸå­ä¸²ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡"></a>åˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨æŸå­ä¸²ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡</h3><p>äºŒåˆ†å­ä¸²é•¿åº¦ $L$ï¼Œåˆ™ $height$ æ•°ç»„èƒ½è¢«åˆ†ä¸ºè‹¥å¹²æ»¡è¶³æ®µå†… $height$ æ•°ç»„å¤§å°éƒ½ $\ge L$ çš„æ®µï¼Œå†åˆ©ç”¨ $RMQ$ æ±‚å‡ºæ®µå†…æœ€å¤§ä¸æœ€å°çš„ $SA$ å€¼ï¼Œåˆ¤æ–­å…¶æ’å€¼ä¸ $L$ çš„å…³ç³»</p><h2 id="åç¼€è‡ªåŠ¨æœº"><a href="#åç¼€è‡ªåŠ¨æœº" class="headerlink" title="åç¼€è‡ªåŠ¨æœº"></a>åç¼€è‡ªåŠ¨æœº</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">append</span> <span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fa = last, p = ++ m;</span><br><span class="line">last = p;</span><br><span class="line">len[p] = len[fa] + <span class="number">1</span>, subsize[p] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; ! tr[fa][c])</span><br><span class="line">tr[fa][c] = p, fa = father[fa];</span><br><span class="line"><span class="keyword">if</span> (! fa) &#123; father[p] = <span class="number">1</span>; <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="keyword">int</span> x = tr[fa][c];</span><br><span class="line"><span class="keyword">if</span> (len[x] == len[fa] + <span class="number">1</span>) &#123; father[p] = x; <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="keyword">int</span> np = ++ m;</span><br><span class="line">len[np] = len[fa] + <span class="number">1</span>, father[np] = father[x];</span><br><span class="line">father[x] = father[p] = np;</span><br><span class="line"><span class="built_in">memcpy</span> (tr[np], tr[x], <span class="keyword">sizeof</span> (tr[x]));</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; tr[fa][c] == x)</span><br><span class="line">tr[fa][c] = np, fa = father[fa];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°"><a href="#æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°" class="headerlink" title="æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°"></a>æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°</h3><p>å»ºç«‹åç¼€è‡ªåŠ¨æœºï¼Œåœ¨ $parent$ æ ‘ä¸Šå¯¹æ‰€æœ‰çŠ¶æ€ $u$ï¼Œç»Ÿè®¡ $\sum\limits_u len(u) - fa(len(u))$ å³å¯</p><h3 id="æ‰€æœ‰ä¸åŒå­ä¸²çš„æ€»é•¿åº¦"><a href="#æ‰€æœ‰ä¸åŒå­ä¸²çš„æ€»é•¿åº¦" class="headerlink" title="æ‰€æœ‰ä¸åŒå­ä¸²çš„æ€»é•¿åº¦"></a>æ‰€æœ‰ä¸åŒå­ä¸²çš„æ€»é•¿åº¦</h3><p>å»ºç«‹åç¼€è‡ªåŠ¨æœºï¼Œåœ¨ $parent$ æ ‘ä¸Šä¸€ä¸ªç‚¹ $u$ ä»£è¡¨çš„æ‰€æœ‰åç¼€çš„è´¡çŒ®ä¸º $\frac{(1 + len(u))len(u)}2$ï¼Œç„¶åå†å‡å» $fa(u)$ ç›¸åº”çš„è´¡çŒ®å³æ˜¯å…¶å‡€è´¡çŒ®</p><h3 id="å­—å…¸åºç¬¬-k-å¤§å­ä¸²"><a href="#å­—å…¸åºç¬¬-k-å¤§å­ä¸²" class="headerlink" title="å­—å…¸åºç¬¬ $k$ å¤§å­ä¸²"></a>å­—å…¸åºç¬¬ $k$ å¤§å­ä¸²</h3><p><a href="https://www.luogu.com.cn/problem/P3975" target="_blank" rel="noopener">[TJOI2015]å¼¦è®º</a></p><p>å…¶ä¸­ $T$ ä¸º $0$ åˆ™è¡¨ç¤ºä¸åŒä½ç½®çš„ç›¸åŒå­ä¸²ç®—ä½œä¸€ä¸ªï¼Œ$T$ ä¸º $1$ åˆ™è¡¨ç¤ºä¸åŒä½ç½®çš„ç›¸åŒå­ä¸²ç®—ä½œå¤šä¸ª</p><p>å’±æŒ‰ç€è·¯å¾„æ¥èµ°ï¼Œé‚£ä¹ˆæ­¤æ—¶èµ°åˆ°çš„æ¯ä¸ªçŠ¶æ€å¯¹åº”å”¯ä¸€ä¸€ä¸ªåç¼€ï¼Œè®¾ $sum_i$ è¡¨ç¤ºèŠ‚ç‚¹ $i$ èƒ½å¤Ÿåˆ°è¾¾çš„æ‰€æœ‰å­ä¸²ä¸ªæ•°ï¼Œåˆå§‹åŒ– $sum_i$ï¼Œè‹¥ $T = 0$ åˆ™ $sum_i = 1$ï¼Œè‹¥ $T = 1$ åˆ™ $sum_i = size(i)$ï¼Œç„¶åå†æ±‚ä¸ªå’Œï¼Œå³ $sum_i += \sum\limits_c sum_{trans(i, c)}$</p><p>ç„¶åæŒ‰ä½åˆ¤æ–­èµ°ä¸€ä¸‹å°±å¥½äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">T == <span class="number">0</span> ? Size[i] = Sum[i] = <span class="number">1</span> : Sum[i] = Size[i];</span><br><span class="line">Size[<span class="number">1</span>] = Sum[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = nodes; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j ++)</span><br><span class="line"><span class="keyword">if</span> (Tree[Topo[i]][j])</span><br><span class="line">Sum[Topo[i]] += Sum[Tree[Topo[i]][j]];</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (k &lt;= Size[x]) <span class="keyword">return</span> ;</span><br><span class="line">k -= Size[x];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> t = Tree[x][i];</span><br><span class="line"><span class="keyword">if</span> (! t) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (k &gt; Sum[t]) &#123; k -= Sum[t]; <span class="keyword">continue</span>; &#125;</span><br><span class="line"><span class="built_in">putchar</span> (i + <span class="string">'a'</span>), print (t, k);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ€å°å¾ªç¯ç§»ä½"><a href="#æœ€å°å¾ªç¯ç§»ä½" class="headerlink" title="æœ€å°å¾ªç¯ç§»ä½"></a>æœ€å°å¾ªç¯ç§»ä½</h3><blockquote><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $S$ï¼Œæ±‚å…¶å­—å…¸åºæœ€å°çš„å¾ªç¯ç§»ä½</p></blockquote><p>ä¸éš¾å‘ç° $S + S$ ä¸€å®šåŒ…å« $S$ çš„æœ€å°å¾ªç¯ç§»ä½ï¼Œé‚£ä¹ˆæ„é€ å‡º $S + S$ çš„åç¼€è‡ªåŠ¨æœºï¼Œç„¶åè´ªå¿ƒè®¿é—®æœ€å°çš„å­—ç¬¦å³å¯</p><h3 id="æ¨¡å¼ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®"><a href="#æ¨¡å¼ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®" class="headerlink" title="æ¨¡å¼ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®"></a>æ¨¡å¼ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</h3><blockquote><p>ç»™å®šä¸€ä¸ªæ–‡æœ¬ä¸² $T$ï¼Œå¤šç»„æŸ¥è¯¢ã€‚æ¯æ¬¡æŸ¥è¯¢å­—ç¬¦ä¸² $P$ åœ¨å­—ç¬¦ä¸² $T$ ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆ$P$ çš„å¼€å¤´ä½ç½®ï¼‰</p></blockquote><p>è®¾ $firstpos(i)$ è¡¨ç¤ºçŠ¶æ€ $i$ ä»£è¡¨åç¼€ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p><p>åœ¨ $parent$ æ ‘ä¸Šè€ƒè™‘ï¼Œæ˜¾ç„¶åº•å±‚èŠ‚ç‚¹çš„ $endpos$ ä¸€å®šæ˜¯å”¯ä¸€çš„ï¼Œé‚£ä¹ˆå®ƒä»¬çš„ $firstpos$ ä¹Ÿå¯ç›´æ¥ç¡®å®šï¼Œé‚£ä¹ˆå¯¹ä¸€ä¸ªä¸åœ¨åº•å±‚çš„çŠ¶æ€ $i$ï¼Œæœ‰ $firstpos(i) = \min\limits_{j \cap fa(j) = i}\{firstpos(j)\}$</p><p>å®é™…ä¸Šä¸Šè¿°è¿‡ç¨‹å¯ä»¥åœ¨æ„é€ æ—¶åšå®Œï¼ˆä»¥ä¸‹æ“ä½œå‰æä¸º $T$ ä½ç½®ç¼–å·ä» $1$ å¼€å§‹ï¼‰</p><p>åœ¨æ–°åŠ å…¥ä¸€ä¸ªç‚¹ $p$ æ—¶ï¼Œæœ‰ $firstpos(p) = len(p)$</p><p>åœ¨å°†èŠ‚ç‚¹ $q$ å¤åˆ¶åˆ° $np$ æ—¶ï¼Œæœ‰ $firstpos(np) = \min(firstpos(q), firstpos(p)) = firstpos(q)$</p><p>ä»¤ $t$ è¡¨ç¤º $P$ åœ¨ $T$ ä¸­èµ°åˆ°çš„çŠ¶æ€ï¼Œé‚£ä¹ˆç­”æ¡ˆä¾¿ä¸º $firstpos(t) - |P| + 1$</p><h3 id="æœ€çŸ­çš„æ²¡æœ‰å‡ºç°è¿‡çš„å­—ç¬¦ä¸²"><a href="#æœ€çŸ­çš„æ²¡æœ‰å‡ºç°è¿‡çš„å­—ç¬¦ä¸²" class="headerlink" title="æœ€çŸ­çš„æ²¡æœ‰å‡ºç°è¿‡çš„å­—ç¬¦ä¸²"></a>æœ€çŸ­çš„æ²¡æœ‰å‡ºç°è¿‡çš„å­—ç¬¦ä¸²</h3><blockquote><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $S$ å’Œä¸€ä¸ªç‰¹å®šçš„å­—ç¬¦é›† $M$ï¼Œæˆ‘ä»¬è¦æ‰¾ä¸€ä¸ªé•¿åº¦æœ€çŸ­çš„ç”± $M$ ä¸­å­—ç¬¦æ„æˆçš„æ²¡æœ‰åœ¨ $S$ ä¸­å‡ºç°è¿‡çš„å­—ç¬¦ä¸²</p></blockquote><p>åœ¨åç¼€è‡ªåŠ¨æœºä¸ŠåŠ¨æ€è§„åˆ’ï¼Œä»¤ $f_u$ è¡¨ç¤ºå·²ç»å¤„ç†äº†ä¸€æ®µå­ä¸²ï¼Œå½“å‰åœ¨çŠ¶æ€ $u$ï¼Œä¸ºæ‰¾åˆ°ä¸è¿ç»­è½¬ç§»è¿˜éœ€è¦æ·»åŠ çš„æœ€å°‘å­—ç¬¦æ•°é‡ï¼Œè½¬ç§»ä¹Ÿæ¯”è¾ƒç®€å•<br>$$<br>f_u = 1 + \min\limits_{c \in M \cap trans(u, c) \in SAM} f_{trans(u, c)}<br>$$<br>é‚£ä¹ˆæœ€ç»ˆç­”æ¡ˆä¸º $f_0$ï¼Œè¾“å‡ºå­—ç¬¦ä¸²åˆ™é€†æ¨å›å»å³å¯</p><h3 id="ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²"><a href="#ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²" class="headerlink" title="ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²"></a>ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²</h3><blockquote><p>ç»™å®šå­—ç¬¦ä¸² $S$ å’Œ $T$ï¼Œæ±‚å®ƒä»¬çš„æœ€é•¿å…¬å…±å­ä¸²</p></blockquote><p>å¯¹ $S$ æ„é€ åç¼€è‡ªåŠ¨æœº</p><p>å¯¹ $T$ çš„æ¯ä¸ªå‰ç¼€ï¼Œè®¾å½“å‰å‰ç¼€ $[1, i]$ï¼Œæ±‚å‡ºè¯¥å‰ç¼€çš„åœ¨ $S$ ä¸Šçš„æœ€é•¿åç¼€é•¿åº¦ $l_i$ï¼Œé‚£ä¹ˆç­”æ¡ˆå³ä¸º $\max\limits_i \{l_i\}$</p><p>å°†æ¯ä¸ªå‰ç¼€æ”¾åœ¨åç¼€è‡ªåŠ¨æœºä¸Šè·‘ï¼Œè®¾å½“å‰å‰ç¼€ $i$ æœ€ç»ˆèµ°åˆ°çŠ¶æ€ $u$ï¼Œé‚£ä¹ˆç°åœ¨æ‰©å±•åˆ°å‰ç¼€ $i + 1$ï¼Œå¤šå‡ºå­—ç¬¦ $T_{i + 1} = c$ï¼Œæœ‰ä¸¤ç§æƒ…å†µ</p><ul><li>å¦‚æœå­˜åœ¨ $trans(u, c)$ï¼Œé‚£ä¹ˆ $u = trans(u, c), l_{i + 1} = l_i + 1$</li><li>å¦‚è‹¥ä¸ç„¶ï¼Œåˆ™åœ¨åç¼€è‡ªåŠ¨æœºæ‰¾åˆ°å‰ç¼€ $i$ ç¬¬ä¸€ä¸ªç‚¹ $p$ï¼Œä½¿å…¶æ»¡è¶³ $trans (p, c)$ å­˜åœ¨ï¼Œå°±æ˜¯ $p$ åœ¨ $parent$ ä¸Šæ˜¯ $u$ çš„ç¥–å…ˆï¼ŒåŒæ—¶ $l_{i + 1} = len(p)$ï¼Œå¦‚æœæœ€ç»ˆæ‰¾ä¸åˆ°ï¼Œé‚£å°±è¿”å›æºç‚¹ï¼ŒåŒæ—¶ $l_{i + 1} = 0$</li></ul><p>$l_n$ æœ€å¤šä¸º $|T|$ï¼Œè€Œæ¯ä½åˆæœ€å¤šè¢«åˆ ä¸€æ¬¡ï¼Œæ•…æœ€ç»ˆæ—¶é—´å¤æ‚åº¦ $O (|S| + |T|)$</p><h3 id="å¤šä¸ªå­—ç¬¦ä¸²é—´çš„æœ€é•¿å…¬å…±å­ä¸²"><a href="#å¤šä¸ªå­—ç¬¦ä¸²é—´çš„æœ€é•¿å…¬å…±å­ä¸²" class="headerlink" title="å¤šä¸ªå­—ç¬¦ä¸²é—´çš„æœ€é•¿å…¬å…±å­ä¸²"></a>å¤šä¸ªå­—ç¬¦ä¸²é—´çš„æœ€é•¿å…¬å…±å­ä¸²</h3><blockquote><p>ç»™å®š $k$ ä¸ªå­—ç¬¦ä¸² $S$ã€‚æˆ‘ä»¬éœ€è¦æ‰¾åˆ°å®ƒä»¬çš„æœ€é•¿å…¬å…±å­ä¸²ï¼Œå³ä½œä¸ºå­ä¸²å‡ºç°åœ¨æ¯ä¸ªå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ä¸² $X$</p></blockquote><p><a href="https://www.spoj.com/problems/LCS2/" target="_blank" rel="noopener">Longest Common Substring II</a></p><p>è¿™å’Œæ±‚ä¸¤ä¸ªçš„å®é™…ä¸Šæ˜¯å·®ä¸å¤šçš„</p><p>å…ˆå¯¹ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å»ºä¸€ä¸ªåç¼€è‡ªåŠ¨æœºï¼Œå‰©ä¸‹çš„ä¸²åœ¨ä¸Šé¢åŒ¹é…</p><p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ $i$ï¼Œè®¾ $mx_i$ è¡¨ç¤ºå½“å‰åŒ¹é…ä¸²èµ°åˆ°çŠ¶æ€ $i$ å¯åŒ¹é…çš„æœ€é•¿é•¿åº¦ï¼Œ$pl_i$ è¡¨ç¤ºèµ°åˆ°çŠ¶æ€ $i$ çš„æ‰€æœ‰ä¸²åœ¨è¯¥å¤„ç•™ä¸‹çš„æœ€é•¿åŒ¹é…é•¿åº¦çš„æœ€å°å€¼</p><p>å½“ç„¶ $mx_i$ è¦å…ˆå¯¹å®ƒçš„å­æ ‘çš„æ‰€æœ‰ $mx$ å–ä¸€ä¸ªæœ€å¤§å€¼ï¼Œè¿™æ ·æ–¹ä¾¿ç»Ÿè®¡ç­”æ¡ˆ</p><p>é‚£ä¹ˆæœ€åç­”æ¡ˆä¾¿æ˜¯ $\max\limits_i \{pl_i\}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (~ <span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>)) &#123;</span><br><span class="line">n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">1</span>, l = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = str[i] - <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">while</span> (p &amp;&amp; ! tr[p][c])</span><br><span class="line">p = father[p], l = len[p];</span><br><span class="line"><span class="keyword">if</span> (! p) p = <span class="number">1</span>, l = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">l ++, p = tr[p][c];</span><br><span class="line">mx[p] = max (mx[p], l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &gt;= <span class="number">1</span>; i --) &#123;</span><br><span class="line"><span class="keyword">int</span> x = topo[i];</span><br><span class="line">pl[x] = min (pl[x], mx[x]);</span><br><span class="line">mx[father[x]] = max (mx[father[x]], min (len[father[x]], mx[x]));</span><br><span class="line">mx[x] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i ++) ans = max (ans, pl[i]);</span><br></pre></td></tr></table></figure><p>å¯¹å¦å¤–ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯æŠŠæ¯ä¸ªå­—ç¬¦ä¸²éš”ä¸€ä¸ªä¸åŒçš„ç‰¹æ®Šå­—ç¬¦æ‹¼åœ¨ä¸€èµ·ï¼Œç„¶åæŠŠæ‹¼å¥½çš„å­—ç¬¦ä¸²æ‹¿å»å»ºåç¼€è‡ªåŠ¨æœºçš„æ–¹æ³•ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„</p><h3 id="æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²æœ¬è´¨ä¸åŒçš„çš„å­ä¸²æ€»æ•°"><a href="#æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²æœ¬è´¨ä¸åŒçš„çš„å­ä¸²æ€»æ•°" class="headerlink" title="æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²æœ¬è´¨ä¸åŒçš„çš„å­ä¸²æ€»æ•°"></a>æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²æœ¬è´¨ä¸åŒçš„çš„å­ä¸²æ€»æ•°</h3><blockquote><p>ç»™å®šå­—ç¬¦ä¸² $S$ å’Œ $T$ï¼Œå¹¶ç»™å®š $l, r$ï¼Œæ±‚ $T$ ä¸­ä¸åœ¨ $S[lâ€¦r]$ å†…å‡ºç°çš„å­ä¸²ä¸ªæ•°</p></blockquote><p><a href="https://www.luogu.com.cn/problem/P4770" target="_blank" rel="noopener">[NOI2018]ä½ çš„åå­—</a></p><p>å…ˆè€ƒè™‘ $l = 1, r = |T|$ çš„æƒ…å†µï¼š</p><p>å› ä¸ºä»»æ„å­ä¸²ä¸ºå­—ç¬¦ä¸²å‰ç¼€çš„æŸäº›åç¼€ï¼Œé‚£ä¹ˆä»¤ $lim[i]$ è¡¨ç¤º $T[1â€¦i]$ åœ¨ $S$ ä¸Šæ‰€èƒ½åŒ¹é…çš„æœ€å¤§é•¿åº¦ï¼Œ$posi[i]$ è¡¨ç¤º$T$çš„åç¼€è‡ªåŠ¨æœºä¸Šçš„ç‚¹ $i$ çš„ $endpos$ é›†åˆä¸­æœ€é å‰çš„ä½ç½®ï¼Œé‚£ä¹ˆç­”æ¡ˆå³ä¸º<br>$$<br>ans = \sum\limits_i \max (0, len(i) - min (len(fa(i)), lim[posi[i]]))<br>$$<br>å…¶ä¸­ $i$ æšä¸¾ $T$ åç¼€è‡ªåŠ¨æœºä¸­çš„æ‰€æœ‰ç‚¹</p><p>æ¥ä¸‹æ¥è€ƒè™‘ $l, r$ ä»»æ„çš„æƒ…å†µï¼š</p><p>åŸæ¥èƒ½å¦åœ¨ $S$ çš„åç¼€è‡ªåŠ¨æœºä¸Šå¾€ä¸‹èµ°çš„åˆ¤æ–­ä¾æ®åªæœ‰å½“å‰èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ $c$ è¾¹ï¼Œé‚£ä¹ˆæœ‰äº† $l, r$ çš„é™åˆ¶ï¼Œå°±å¤šéœ€è¦åˆ¤æ–­å‘ä¸‹çš„è¿™ä¸ªèŠ‚ç‚¹çš„ $endpos$ æ˜¯å¦æœ‰å­˜åœ¨äº $[l + len, r]$ï¼ˆ$len$ è¡¨ç¤ºå·²åŒ¹é…é•¿åº¦ï¼‰åŒºé—´çš„ä½ç½®ï¼Œ$endpos$ é›†åˆç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹å°±å¥½äº†</p><p><a href="https://colythme.github.io/2020/07/01/[NOI2018]ä½ çš„åå­—/">ä»£ç </a></p><h3 id="æ±‚æ‰€æœ‰é•¿åº¦ä¸º-k-çš„å­ä¸²çš„æœ€å¤§å‡ºç°æ¬¡æ•°"><a href="#æ±‚æ‰€æœ‰é•¿åº¦ä¸º-k-çš„å­ä¸²çš„æœ€å¤§å‡ºç°æ¬¡æ•°" class="headerlink" title="æ±‚æ‰€æœ‰é•¿åº¦ä¸º $k$ çš„å­ä¸²çš„æœ€å¤§å‡ºç°æ¬¡æ•°"></a>æ±‚æ‰€æœ‰é•¿åº¦ä¸º $k$ çš„å­ä¸²çš„æœ€å¤§å‡ºç°æ¬¡æ•°</h3><blockquote><p>ç»™å®šå­—ç¬¦ä¸² $S$ï¼Œæ±‚ $S$ ä¸­é•¿åº¦ä¸º $k = 1â€¦n$ çš„å­ä¸²çš„æœ€å¤§å‡ºç°æ¬¡æ•°ï¼ˆå¯¹æ¯ä¸ª $k$ å•ç‹¬è€ƒè™‘ï¼‰</p></blockquote><p>è€ƒè™‘å¯¹æŸä¸ª $k$ï¼Œæ˜¾ç„¶å¯¹å®ƒæœ‰è´¡çŒ®çš„åªå¯èƒ½æ˜¯ $minlen(i) \le k \le maxlen(i)$ çš„æ‰€æœ‰çŠ¶æ€ $i$</p><p>ç›´æ¥ç®—çš„è¯å¾—å»ºæ£µçº¿æ®µæ ‘ï¼Œå®é™…ä¸Šå¯¹æŸä¸ªå­ä¸²ï¼Œå®ƒçš„è´¡çŒ®ä¸€å®šæ˜¯å®ƒè‡ªå·±ç›´æ¥ç»™å‡ºè´¡çŒ®æˆ–æ˜¯å°†å®ƒä½œä¸ºåç¼€çš„å­ä¸²ç»™å‡ºçš„ï¼Œæ‰€ä»¥æ¯æ¬¡åªéœ€åœ¨ $maxlen(i)$ å¤„æ ‡è®°ä¸€ä¸‹ï¼Œç„¶åå† $parent$ æ ‘ä¸Šå¯¹å­æ ‘æ‰€æœ‰çš„è´¡çŒ®å– $max$ å°±å¥½äº†</p><h3 id="å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº"><a href="#å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº" class="headerlink" title="å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº"></a>å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">append</span> <span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> last, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fa = last;</span><br><span class="line"><span class="keyword">if</span> (tr[fa][c]) &#123; <span class="comment">// ä¸å•ä¸²åç¼€è‡ªåŠ¨æœºä¸åŒå¤„</span></span><br><span class="line"><span class="keyword">int</span> x = tr[fa][c];</span><br><span class="line"><span class="keyword">if</span> (len[x] == len[fa] + <span class="number">1</span>) &#123; subsize[x][id] = <span class="number">1</span>; <span class="keyword">return</span> x; &#125; <span class="comment">// ç‰¹åˆ¤ä¸€</span></span><br><span class="line"><span class="keyword">int</span> np = ++ m;</span><br><span class="line">father[np] = father[x], len[np] = len[fa] + <span class="number">1</span>;</span><br><span class="line">father[x] = np;</span><br><span class="line"><span class="built_in">memcpy</span> (tr[np], tr[x], <span class="keyword">sizeof</span> (tr[x]));</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; tr[fa][c] == x)</span><br><span class="line">tr[fa][c] = np, fa = father[fa];</span><br><span class="line">subsize[np][id] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> np; <span class="comment">// ç‰¹åˆ¤äºŒ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> p = ++ m;</span><br><span class="line">len[p] = len[fa] + <span class="number">1</span>, subsize[p][id] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; ! tr[fa][c])</span><br><span class="line">tr[fa][c] = p, fa = father[fa];</span><br><span class="line"><span class="keyword">if</span> (! fa) &#123; father[p] = <span class="number">1</span>; <span class="keyword">return</span> p; &#125;</span><br><span class="line"><span class="keyword">int</span> x = tr[fa][c];</span><br><span class="line"><span class="keyword">if</span> (len[x] == len[fa] + <span class="number">1</span>) &#123; father[p] = x; <span class="keyword">return</span> p; &#125;</span><br><span class="line"><span class="keyword">int</span> np = ++ m;</span><br><span class="line">father[np] = father[x], len[np] = len[fa] + <span class="number">1</span>;</span><br><span class="line">father[p] = father[x] = np;</span><br><span class="line"><span class="built_in">memcpy</span> (tr[np], tr[x], <span class="keyword">sizeof</span> (tr[x]));</span><br><span class="line"><span class="keyword">while</span> (fa &amp;&amp; tr[fa][c] == x)</span><br><span class="line">tr[fa][c] = np, fa = father[fa];</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> last;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span>; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, str + <span class="number">1</span>); <span class="keyword">int</span> n = <span class="built_in">strlen</span> (str + <span class="number">1</span>);</span><br><span class="line">last = <span class="number">1</span>; <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j ++) last = append (str[j] - <span class="string">'a'</span>, last, i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ $size$ è¦å¯¹æ¯ä¸ªä¸²åˆ†å¼€å­˜</p><h3 id="çº¿æ®µæ ‘åˆå¹¶ç»´æŠ¤å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº-size"><a href="#çº¿æ®µæ ‘åˆå¹¶ç»´æŠ¤å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº-size" class="headerlink" title="çº¿æ®µæ ‘åˆå¹¶ç»´æŠ¤å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº $size$"></a>çº¿æ®µæ ‘åˆå¹¶ç»´æŠ¤å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº $size$</h3><p><a href="http://codeforces.com/problemset/problem/666/E" target="_blank" rel="noopener">Forensic Examination</a></p><blockquote><p>ç»™ä½ ä¸€ä¸ªä¸² $S$ ä»¥åŠ $m$ ä¸ªå­—ç¬¦ä¸²æ•°ç»„ $T_1, T_2, â€¦, T_m$ï¼Œ$q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡é—® $S$ çš„å­ä¸² $S[p_lâ€¦p_r]$ åœ¨ $T_l, â€¦, T_r$ ä¸­çš„å“ªä¸ªä¸²é‡Œçš„å‡ºç°æ¬¡æ•°æœ€å¤šï¼Œå¹¶è¾“å‡ºå‡ºç°æ¬¡æ•°ã€‚å¦‚æœ‰å¤šè§£è¾“å‡ºæœ€é å‰çš„é‚£ä¸€ä¸ª</p></blockquote><p>å¯¹æ‰€æœ‰ä¸²å»ºç«‹å¹¿ä¹‰åç¼€è‡ªåŠ¨æœºï¼Œå¼€ä¸€æ£µåŒºé—´ä¸º $[1, m]$ çš„çº¿æ®µæ ‘ï¼Œå°†æ¯ä¸ªçŠ¶æ€çš„ $size$ å­˜ä¸‹æ¥ï¼ˆç±»ä¼¼ $\text{modify} (rt[p], 1, m, id)$ï¼Œå…¶ä¸­ $id$ è¡¨ç¤ºå½“å‰æ’å…¥çš„æ˜¯ $m$ ä¸ªå­—ç¬¦ä¸²ä¸­çš„å“ªä¸ªï¼Œæ³¨æ„ $S$ æ’å…¥åç¼€è‡ªåŠ¨æœºæ—¶å°±ä¸ç”¨ä¿®æ”¹çº¿æ®µæ ‘äº†ï¼‰ï¼Œå¹¶è¿›è¡Œçº¿æ®µæ ‘åˆå¹¶</p><p>é‚£ä¹ˆæ¯æ¬¡åªè¦åœ¨ $parent$ æ ‘ä¸Šå€å¢è·³åˆ°åŒ…å«åŒºé—´ $S[p_lâ€¦p_r]$ çš„ç‚¹ï¼Œå°±å¯ä»¥ç›´æ¥ç»Ÿè®¡å…¶å¯¹åº”çº¿æ®µæ ‘ $[l, r]$ åŒºé—´çš„æœ€å¤§å€¼ï¼ˆå³å®ƒå­æ ‘çš„ç­”æ¡ˆï¼‰</p><h3 id="Parent-æ ‘ä¸Šä¸¤ç‚¹é—´è·ç¦»"><a href="#Parent-æ ‘ä¸Šä¸¤ç‚¹é—´è·ç¦»" class="headerlink" title="$Parent$ æ ‘ä¸Šä¸¤ç‚¹é—´è·ç¦»"></a>$Parent$ æ ‘ä¸Šä¸¤ç‚¹é—´è·ç¦»</h3><p><a href="https://www.luogu.com.cn/problem/P4248" target="_blank" rel="noopener">[AHOI2013]å·®å¼‚</a></p><blockquote><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸² $S$ï¼Œä»¤ $T_i$ è¡¨ç¤ºå®ƒä»ç¬¬ $i$ ä¸ªå­—ç¬¦å¼€å§‹çš„åç¼€ï¼Œæ±‚ $\sum\limits_{1 \le i &lt; j \le n} len(T_i) + len(T_j) - 2 \times LCP(T_i, T_j)$</p></blockquote><p>å°†ä¸²åè¿‡æ¥ï¼Œåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€å°±å˜æˆäº†å‰ç¼€çš„æœ€é•¿å…¬å…±åç¼€</p><p>ä»¥ $len(i) - len(fa(i))$ ä½œä¸ºçŠ¶æ€ $i$ åœ¨ $parent$ æ ‘ä¸Šåˆ°çˆ¶äº²çš„è¾¹æƒï¼Œé‚£ä¹ˆåŸå¼å°±å¯ä»¥çœ‹ä½œ $parent$ æ ‘ä¸Šä¸¤ä¸ªå‰ç¼€å¯¹åº”çš„ç‚¹ $u, v$ ä¹‹é—´çš„è·¯å¾„é•¿åº¦</p><p>ç”±äºåªæœ‰å‰ç¼€çŠ¶æ€çš„ $size$ æ‰å¯èƒ½è¢«åˆå§‹åŒ–ä¸º $1$ï¼Œé‚£ä¹ˆå¯¹ç‚¹ $i$ åˆ°å…¶çˆ¶äº²çš„è¾¹ï¼Œå…¶è´¡çŒ®å³ä¸º $w_i \times size(i) \times (n - size(i))$ï¼Œå¯¹æ‰€æœ‰è¾¹æ±‚å’Œå³å¯</p>]]></content>
      
      
      <categories>
          
          <category> å½’çº³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åç¼€è‡ªåŠ¨æœº </tag>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> å½’çº³ </tag>
            
            <tag> åç¼€æ•°ç»„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤šé¡¹å¼æ±‚é€†</title>
      <link href="/2020/08/04/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86/"/>
      <url>/2020/08/04/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>é¦–å…ˆå®šä¹‰å¤šé¡¹å¼çš„åº¦æ•° $degA$ ä¸ºå¤šé¡¹å¼ $A(x)$ çš„æœ€é«˜æ¬¡æ•°</p><p>é‚£ä¹ˆå¤šé¡¹å¼ $A(x)$ çš„é€†å³ä¸ºå­˜åœ¨å¤šé¡¹å¼ $B(x)$ ä½¿å¾—æ¡ä»¶æ»¡è¶³ï¼š<br>$$<br>A(x)B(x) \equiv 1 \pmod{x^n}<br>$$</p><h2 id="æ±‚è§£è¿‡ç¨‹"><a href="#æ±‚è§£è¿‡ç¨‹" class="headerlink" title="æ±‚è§£è¿‡ç¨‹"></a>æ±‚è§£è¿‡ç¨‹</h2><h3 id="åˆ†æ²»-FFT"><a href="#åˆ†æ²»-FFT" class="headerlink" title="åˆ†æ²» $FFT$"></a>åˆ†æ²» $FFT$</h3><p>å¯¹ $A(x) = \sum\limits_{k = 0}^{n - 1} a_kx^k, B(x) = \sum\limits_{k = 0}^{n - 1} b_kx^k$</p><p>ä»å¸¸æ•°é¡¹è€ƒè™‘ï¼Œæœ‰ $b_0 = \frac1{a_0}$ï¼Œåˆ™ç”± $\sum\limits_{k = 0}^n b_ka_{n - k} = 0$ å¯å¾—<br>$$<br>b_k = \sum\limits_{i = 0}^{k - 1} b_i\left(- \frac{a_{k - i}}{a_0}\right)<br>$$</p><h3 id="å€å¢è¿­ä»£"><a href="#å€å¢è¿­ä»£" class="headerlink" title="å€å¢è¿­ä»£"></a>å€å¢è¿­ä»£</h3><p>å‡è®¾å­˜åœ¨å¤šé¡¹å¼ $A(x)$ ï¼Œä»¥åŠå…¶é€† $B(x)$ æ»¡è¶³æ¡ä»¶ ï¼Œé‚£ä¹ˆå¿…å®šæœ‰$A(x)B(x) \equiv 1 \pmod{x^{\left\lceil\frac{n}{2}\right\rceil}}  â€¦  (1)$ ï¼Œå› ä¸º $x^n$ æ˜¯ $x^{\left\lceil\frac{n}{2}\right\rceil}$ çš„å€æ•°</p><p>å¹¶ä¸”å­˜åœ¨ $A(x)Bâ€™(x) \equiv 1 \pmod{x^{\left\lceil\frac{n}{2}\right\rceil}}  â€¦  (2)$</p><p>$(1) - (2)$ ï¼Œå¾—<br>$$<br>\begin{aligned} B(x) - Bâ€™(x) &amp;\equiv 0 \pmod{x^{\left\lceil\frac{n}{2}\right\rceil}}  â€¦  (3) \\ B(x)^2 - 2B(x)Bâ€™(x) + Bâ€™(x)^2 &amp;\equiv 0 \pmod{x^n} \end{aligned}<br>$$<br>ä¸Šä¸€æ­¥è§£é‡Šä¸€ä¸‹ï¼Œæ˜¯ä¸¤è¾¹å¹³æ–¹</p><p>è‡³äºä¸ºä»€ä¹ˆæ¨¡æ•°ä¹Ÿéœ€è¦å¹³æ–¹ï¼Œæ˜¯å› ä¸º $(3)$ å¼æ»¡è¶³å·¦è¾¹çš„å¤šé¡¹å¼åœ¨å…¶æ¨¡æ„ä¹‰ä¸‹ä¸º $0$ ï¼Œä¸”å¼å­æ’æˆç«‹ï¼Œæ•…å…¶é™¤äº†ç¬¬ $x^{\left\lceil\frac{n}{2}\right\rceil}$ é¡¹å…¶ä½™ç³»æ•°çš†ä¸º $0$ ï¼Œé‚£ä¹ˆç°åœ¨è€ƒè™‘ $0 \le x \le n - 1$ ï¼Œåˆå› ä¸º $a_i = \sum\limits_{j = 1}^i a_j b_{i - j}$ ï¼Œæ‰€ä»¥å¿…å®šå­˜åœ¨ $i$ æˆ–è€… $i - j$ å°äº $x^{\left\lceil\frac{n}{2}\right\rceil}$ ï¼Œæ•… $a_i = 0$ ï¼Œæ‰€ä»¥å¹³æ–¹æ— å¦¨</p><p>åŒä¹˜ $A(x)$ ï¼Œç§»é¡¹ï¼Œå¾—<br>$$<br>B(x) \equiv 2Bâ€™(x) - A(x)Bâ€™(x)^2 \pmod{x^n}<br>$$<br>åœ¨é€’å½’è¿‡ç¨‹ä¸­æœ€åä¼šé€’å½’åˆ° $n = 1$ ï¼Œé‚£ä¹ˆæ­¤æ—¶ $A(x)Bâ€™â€™(x) \equiv c \pmod{x}$ ï¼Œå– $c^{- 1}$ å°±å¥½äº†</p><p>é‚£ä¹ˆå†ç”¨ $FFT$ ä¼˜åŒ–å°±å¯ä»¥åšåˆ° $O (n \log n)$ æ±‚è§£</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">LL f[MAXN], invf[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL A[MAXN]= &#123;<span class="number">0</span>&#125;, B[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> oppo[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">LL omega = power (inv == <span class="number">1</span> ? g : invg, (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">LL x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * omega % MOD) &#123;</span><br><span class="line">LL a1 = a[j + k], xa2 = x * a[j + k + mid] % MOD;</span><br><span class="line">a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">a[j + k + mid] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* ps)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123;</span><br><span class="line">ps[<span class="number">0</span>] = power (f[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">Inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, ps);</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt; (deg &lt;&lt; <span class="number">1</span>); n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">A[i] = f[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg &lt;&lt; <span class="number">1</span>; i ++)</span><br><span class="line">B[i] = ps[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">B[i] = B[i] * ((<span class="number">2l</span>l - A[i] * B[i] % MOD + MOD) % MOD) % MOD;</span><br><span class="line">NTT (B, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">ps[i] = B[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">f[i] = getnum ();</span><br><span class="line">Inverse (N, invf);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>)</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld"</span>, invf[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">1 6 3 4 9</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">2 3 3 3 1233 211 23 3 3 322</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šé¡¹å¼ </tag>
            
            <tag> FFT/NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤šé¡¹å¼æ“ä½œ</title>
      <link href="/2020/08/04/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%93%8D%E4%BD%9C/"/>
      <url>/2020/08/04/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="å¤šé¡¹å¼æ±‚é€†"><a href="#å¤šé¡¹å¼æ±‚é€†" class="headerlink" title="å¤šé¡¹å¼æ±‚é€†"></a>å¤šé¡¹å¼æ±‚é€†</h2><p>è¯¥éƒ¨åˆ†è§ <a href="https://colythme.github.io/2020/07/01/å¤šé¡¹å¼æ±‚é€†/">å¤šé¡¹å¼æ±‚é€†</a></p><h2 id="å¤šé¡¹å¼é™¤æ³•-å–æ¨¡"><a href="#å¤šé¡¹å¼é™¤æ³•-å–æ¨¡" class="headerlink" title="å¤šé¡¹å¼é™¤æ³•|å–æ¨¡"></a>å¤šé¡¹å¼é™¤æ³•|å–æ¨¡</h2><p>æœ‰ $F(x) = G(x)Q(x) + R(x)$ï¼Œç»™å®š $F(x)$ ä¸ $G(x)$ï¼Œæ±‚è§£ $Q(x), R(x)$ï¼Œå…¶ä¸­ $F(x), G(x)$ æœ€é«˜æ¬¡æ•°åˆ†åˆ«ä¸º $n, m$</p><p>æ˜¾ç„¶åœ°ï¼Œ$Q(x), R(x)$ çš„æœ€é«˜æ¬¡æ•°å¿…å®šä¸è¶…è¿‡ $n - m, m - 1$ï¼Œè€ƒè™‘å¼å­å˜å½¢<br>$$<br>\begin{aligned}<br>&amp;F(x) = G(x)Q(x) + R(x) \\<br>\Rightarrow &amp;F(\frac1x) = G(\frac1x)Q(\frac1x) + R(\frac1x) \\<br>\Rightarrow &amp;x^nF(\frac1x) = x^mG(\frac1x)x^{n - m}Q(\frac1x) + x^{n - m + 1}x^{m - 1}R(\frac1x) \\<br>\end{aligned}<br>$$<br>ä»¤ $A_R(x)$ è¡¨ç¤º $A(x)$ ç³»æ•°ç¿»è½¬åå¾—åˆ°çš„å¤šé¡¹å¼ï¼Œå³ $A(x)$ ç³»æ•° $(a_0, a_1, â€¦, a_n)$ï¼Œ$A_R(x)$ ç³»æ•° $(a_n, a_{n - 1}, â€¦, a_1)$ï¼Œæœ‰<br>$$<br>\begin{aligned}<br>\Rightarrow &amp;x^nF(\frac1x) = x^mG(\frac1x)x^{n - m}Q(\frac1x) + x^{n - m + 1}x^{m - 1}R(\frac1x) \\<br>\Rightarrow &amp;F_R(x) = G_R(x)Q_R(x) + x^{n - m + 1}R_R(x) \\<br>\Rightarrow &amp;F_R(x) \equiv G_R(x)Q_R(x) \pmod{x^{n - m + 1}} \\<br>\Rightarrow &amp;Q_R(x) \equiv \frac{F_R(x)}{G_R(x)}<br>\end{aligned}<br>$$<br>é‚£ä¹ˆè¿™æ ·å°±å¯ä»¥æ±‚å‡º $Q(x)$ï¼Œä¹‹ååˆ™æœ‰ $R(x) = F(x) - G(x)Q(x)$</p><p>æ—¶é—´å¤æ‚åº¦ $O (n \log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN]= &#123;<span class="number">0</span>&#125;, limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">LL ome = power (inv == <span class="number">1</span> ? g : invg, (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">LL x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome % MOD) &#123;</span><br><span class="line">LL a1 = a[j + k], xa2 = x * a[j + mid + k] % MOD;</span><br><span class="line">a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">a[j + mid + k] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">LL A[MAXN], B[MAXN], f[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span> <span class="params">(LL* X, LL* Y, <span class="keyword">int</span> fn, <span class="keyword">int</span> fm)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= fn + fm; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fn; i ++) A[i] = X[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fm; i ++) B[i] = Y[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = A[i] * B[i] % MOD;</span><br><span class="line">NTT (A, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= fn + fm; i ++) X[i] = A[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* a)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123; a[<span class="number">0</span>] = power (f[<span class="number">0</span>], MOD - <span class="number">2</span>); <span class="keyword">return</span> ; &#125;</span><br><span class="line">inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, a);</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= (deg &lt;&lt; <span class="number">1</span>); n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">limit = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++) A[i] = f[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg &lt;&lt; <span class="number">1</span>; i ++) B[i] = a[i];</span><br><span class="line">NTT (A, <span class="number">1</span>), NTT (B, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++) B[i] = B[i] * ((<span class="number">2l</span>l - A[i] * B[i] % MOD + MOD) % MOD) % MOD;</span><br><span class="line">NTT (B, - <span class="number">1</span>);</span><br><span class="line">LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++) a[i] = B[i] * invn % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL F[MAXN], G[MAXN], INVG[MAXN];</span><br><span class="line">LL RF[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++) RF[i] = F[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++) f[i] = G[i] = getnum ();</span><br><span class="line">reverse (RF, RF + N + <span class="number">1</span>); reverse (f, f + M + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - M + <span class="number">2</span>; i &lt;= M; i ++) f[i] = <span class="number">0</span>;</span><br><span class="line">inverse (N - M + <span class="number">1</span>, INVG); mul (RF, INVG, N, N - M + <span class="number">1</span>);</span><br><span class="line">reverse (RF, RF + N - M + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - M + <span class="number">1</span>; i &lt;= N; i ++) RF[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N - M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld"</span>, RF[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">mul (RF, G, N - M, M);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) RF[i] = (F[i] - RF[i] + MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld"</span>, RF[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šé¡¹å¼ </tag>
            
            <tag> FFT/NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒJOISC2017Day1ã€çƒŸèŠ±æ£’</title>
      <link href="/2020/08/04/%E3%80%8CJOISC%202017%20Day%201%E3%80%8D%E7%83%9F%E8%8A%B1%E6%A3%92/"/>
      <url>/2020/08/04/%E3%80%8CJOISC%202017%20Day%201%E3%80%8D%E7%83%9F%E8%8A%B1%E6%A3%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>æœ‰ $N$ äººç«™åœ¨ä¸€æ¡æ•°è½´ä¸Šã€‚ä»–ä»¬äººæ‰‹ä¸€ä¸ªçƒŸèŠ±ï¼Œæ¯äººæ‰‹ä¸­çš„çƒŸèŠ±éƒ½æ°å¥½èƒ½ç‡ƒçƒ§ $T$ ç§’ã€‚æ¯ä¸ªçƒŸèŠ±åªèƒ½è¢«ç‚¹ç‡ƒä¸€æ¬¡ã€‚<br>$1$ å·ç«™åœ¨åŸç‚¹ï¼Œ$i$ å· $(1 \le i \le N)$ åˆ° $1$ å·çš„è·ç¦»ä¸º $X_i$ã€‚ä¿è¯ $X_1 = 0$ï¼Œ$X_1, X_2, â€¦, X_N$ <strong>å•è°ƒ</strong>é€’å¢ï¼ˆå¯èƒ½æœ‰äººä½ç½®é‡å ï¼‰<br>å¼€å§‹æ—¶ï¼Œ$K$ å·çš„çƒŸèŠ±åˆšå¼€å§‹ç‡ƒçƒ§ï¼Œå…¶ä»–äººçš„çƒŸèŠ±å‡æœªç‚¹ç‡ƒã€‚ä»–ä»¬çš„ç‚¹ç«å·¥å…·åäº†ï¼Œåªèƒ½ç”¨ç‡ƒç€çš„çƒŸèŠ±å°†æœªç‚¹ç‡ƒçš„çƒŸèŠ±ç‚¹ç‡ƒã€‚å½“ä¸¤äººä½ç½®é‡å ä¸”å…¶ä¸­ä¸€äººæ‰‹ä¸­çš„çƒŸèŠ±ç‡ƒç€æ—¶ï¼Œå¦ä¸€äººæ‰‹ä¸­çš„çƒŸèŠ±å°±å¯ä»¥è¢«ç‚¹ç‡ƒã€‚å¿½ç•¥ç‚¹ç«æ‰€éœ€æ—¶é—´ã€‚<br>æ±‚è‡³å°‘éœ€è¦ä»¥å¤šå¿«çš„é€Ÿåº¦è·‘ï¼Œæ‰èƒ½ç‚¹ç‡ƒæ‰€æœ‰äººçš„çƒŸèŠ±ï¼ˆæ­¤æ—¶å¯èƒ½æœ‰äº›äººçš„çƒŸèŠ±å·²ç»ç†„ç­äº†ï¼‰ã€‚<strong>é€Ÿåº¦å¿…é¡»æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°</strong></p><h2 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h2><p>å¯¹ $100\%$ çš„æ•°æ®ï¼Œ$1 \le K, N \le 10^5, ~ 1 \le T \le 10^9, ~ 0 \le X_i \le 10^9, ~ X_1 = 0$</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å¾ˆæ˜¾ç„¶æ‰€æœ‰äººä¸€å®šä¼šä¸æ–­å‘æ‹¿çƒŸèŠ±çš„äººé è¿‘</p><p>å¯ä»¥å‘ç°ï¼Œä¸€ä¸ªæ‹¿çƒŸèŠ±æ£’çš„äººå’Œå¦ä¸€ä¸ªäººç›¸é‡æ—¶ï¼Œè®©å¦ä¸€ä¸ªäººè·Ÿç€æ‹¿çƒŸèŠ±çš„äººèµ°ç›´è‡³çƒŸèŠ±åœ¨ç­æ‰çš„ç¬é—´å°†çƒŸèŠ±ä¼ é€’çš„æƒ…å†µå’Œåœ¨ç›¸é‡æ—¶ä¼ é€’æ—¶ä¸€æ ·çš„ï¼ˆæ³¨æ„ç›¸å¯¹ä½ç½®ï¼Œä»”ç»†æƒ³ä¸€ä¸‹å°±å¯ä»¥è¯æ˜ï¼‰</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ªè¿‡ç¨‹å¯ä»¥çœ‹ä½œåªæœ‰ä¸€ä¸ªæ‹¿çƒŸèŠ±çš„äººï¼Œè¿›ä¸€æ­¥æ¨ç†å¯ä»¥å‘ç°ï¼Œæ‹¿çƒŸèŠ±çš„äººå’Œå¦ä¸€ä¸ªäººç›¸é‡ç­‰ä»·äºä»–çš„çƒŸèŠ±ç‡ƒçƒ§æ—¶é—´åŠ ä¸Š $T$ï¼ˆåœ¨æœ€ä¼˜æƒ…å†µä¸‹ï¼‰</p><p>åˆä¸¤äººç›¸å‘è€Œè¡Œæ—¶ç›¸å¯¹é€Ÿåº¦ä¸º $2v$ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªåŒºé—´ $[L, R]$ï¼Œå®ƒæ»¡è¶³æ¡ä»¶çš„å¿…è¦æ¡ä»¶å³æ˜¯<br>$$<br>2vT(R - L) \ge x_R - x_L<br>$$<br>è€Œæˆ‘ä»¬ä» $K$ å¼€å§‹ä¸æ–­å‘ä¸¤è¾¹æ‰©å±•ï¼Œä½¿å¾—æ¯æ¬¡æ‰©å±•éƒ½æ»¡è¶³æ¡ä»¶ï¼Œé‚£ä¹ˆæ‰©å±•åˆ° $[L, R]$ æ—¶ï¼Œè¯¥æ¡ä»¶ä¾¿æˆä¸ºå……è¦æ¡ä»¶</p><p>å¯¹ä¸Šå¼è¿›è¡Œå˜æ¢ï¼Œæœ‰<br>$$<br>x_L - 2vTL \ge x_R - 2vTR<br>$$<br>ä¸å¦¨ä»¤ $a_i = x_i - 2vTi$ï¼Œé‚£ä¹ˆè¯¥æ¡ä»¶ä¾¿è½¬åŒ–ä¸º $a_L \ge a_R$</p><p>è¿›è¡ŒäºŒåˆ†ç­”æ¡ˆ</p><p>åœ¨ $check$ æ—¶è¿›è¡Œè´ªå¿ƒï¼Œè´ªå¿ƒæ‰©å±•å½“å‰æ‰€åˆ°åŒºé—´ $[l, r]$ï¼Œå¯¹ $l$ï¼Œä¸æ–­æ‰¾åˆ°ä¸€ä¸ª $k$ï¼Œä½¿å¾— $a_k \ge a_l \cap k &lt; l \cap a_k \ge a_r$ï¼Œå¯¹ $r$ åŒç†ï¼Œæœ€ç»ˆä¼šæ‰©å±•åˆ°ä¸€ä¸ªæå¤§åŒºé—´ $[ll, lr]$</p><p>è‹¥ $ll = 1 \cap lr = N$ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿”å› $true$ï¼Œå¦‚è‹¥ä¸ç„¶ï¼Œåˆ™è§‚å¯Ÿå½“å‰æƒ…å†µ</p><p>ç°åœ¨å±€é¢æ˜¯ $l, r$ ä¸èƒ½ç»§ç»­å¾€å·¦å³æ‰©å±•ï¼Œä¹Ÿå°±æ˜¯ $l$ å¾€å·¦ä¸å­˜åœ¨ $a_k \ge a_l$ æˆ– $a_k \ge a_r$ï¼Œ$r$ å¾€å³ä¸å­˜åœ¨ $a_k \le a_r$ æˆ– $a_k \le a_l$ï¼Œå¯¹ä¸å­˜åœ¨ $a_{k_1} \ge a_r \cup a_{k_2} \le a_l$ çš„å±€é¢ï¼Œæ˜¾ç„¶å°±ç›´æ¥è¿”å› $false$ï¼Œé‚£ä¹ˆå¯¹å¦ä¸€ç§å±€é¢ï¼Œè€ƒè™‘ $l$ å¾€å·¦ï¼Œè¯´æ˜ä¸€æ®µä¸€æ®µçš„æœ€å¤§å€¼æ˜¯é€’å‡çš„ï¼Œä½†æ˜¯ä¸å¦¨å°†å…¶åè¿‡æ¥ï¼Œé‚£ä¸å°±å’Œä¸Šé¢ $K$ å¾€ä¸¤è¾¹æ‰©å±•çš„æƒ…å†µä¸€æ ·äº†å—ï¼Œ$r$ å¾€å³åŒç†ï¼Œé‚£ä¹ˆç°åœ¨è¦åšçš„å°±æ˜¯é‡æ–°ä»¤ $l = 1, r = N$ï¼Œç„¶åå‘å†…ç¼©ï¼Œçœ‹èƒ½å¦ç¼©åˆ° $[ll, lr]$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1e09</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K, T;</span><br><span class="line"><span class="keyword">int</span> X[MAXN];</span><br><span class="line"></span><br><span class="line">LL a[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = X[i] - <span class="number">2l</span>l * v * T * i;</span><br><span class="line"><span class="keyword">if</span> (a[<span class="number">1</span>] &lt; a[N]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">int</span> l = K, r = K, ll = K, lr = K;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">if</span> (a[i] &gt;= a[ll])</span><br><span class="line">ll = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (a[i] &lt;= a[lr])</span><br><span class="line">lr = i;</span><br><span class="line"><span class="keyword">while</span> (l != ll || r != lr) &#123;</span><br><span class="line"><span class="keyword">int</span> pl, pr; <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (pl = l; pl &gt; ll; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pl - <span class="number">1</span>] &lt; a[r]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[-- pl] &gt;= a[l]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pl &lt; l &amp;&amp; a[pl] &gt;= a[l]) &#123; l = pl; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (pr = r; pr &lt; lr; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pr + <span class="number">1</span>] &gt; a[l]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[++ pr] &lt;= a[r]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pr &gt; r &amp;&amp; a[pr] &lt;= a[r]) &#123; r = pr; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (! suc) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">l = <span class="number">1</span>, r = N;</span><br><span class="line"><span class="keyword">while</span> (l != ll || r != lr) &#123;</span><br><span class="line"><span class="keyword">int</span> pl, pr; <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (pl = l; pl &lt; ll; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pl + <span class="number">1</span>] &lt; a[r]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[++ pl] &gt;= a[l]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pl &gt; l &amp;&amp; a[pl] &gt;= a[l]) &#123; l = pl; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">for</span> (pr = r; pr &gt; lr; ) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[pr - <span class="number">1</span>] &gt; a[l]) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (a[-- pr] &lt;= a[r]) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pr &lt; r &amp;&amp; a[pr] &lt;= a[r]) &#123; r = pr; suc = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">if</span> (! suc) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum (), T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) X[i] = getnum ();</span><br><span class="line"><span class="keyword">int</span> left = <span class="number">0</span>, right = INF, ans;</span><br><span class="line"><span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (check (mid)) &#123; ans = mid; right = mid - <span class="number">1</span>; &#125;</span><br><span class="line"><span class="keyword">else</span> left = mid + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ€ç»´ </category>
          
          <category> è´ªå¿ƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> äºŒåˆ†ç­”æ¡ˆ </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Œçœé€‰æ¨¡æ‹Ÿèµ›ã€çŸ©é˜µï¼ˆmatrixï¼‰</title>
      <link href="/2020/08/04/%5B%E7%9C%81%E9%80%89%E6%A8%A1%E6%8B%9F%E8%B5%9B%5D%E7%9F%A9%E9%98%B5%EF%BC%88matrix%EF%BC%89/"/>
      <url>/2020/08/04/%5B%E7%9C%81%E9%80%89%E6%A8%A1%E6%8B%9F%E8%B5%9B%5D%E7%9F%A9%E9%98%B5%EF%BC%88matrix%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>æœ‰ä¸€ä¸ª $n*m$ çš„ $01$ çŸ©é˜µï¼ŒçŸ©é˜µä¸­ $k$ ä¸ªæ ¼å­çš„æ•°å·²ç»ç¡®å®šï¼Œä½ éœ€è¦æ±‚å‡ºæœ‰å¤šå°‘ç§æ–¹æ¡ˆä½¿å¾—çŸ©é˜µæ¯è¡Œæ¯åˆ—çš„å¼‚æˆ–å’Œå‡ä¸º $1$ã€‚å¯¹ $998244353$ å–æ¨¡ã€‚</p><h2 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.luogu.org/upload/pic/53120.png" alt=""></p><hr><h3 id="Subtask-1"><a href="#Subtask-1" class="headerlink" title="Subtask 1"></a>Subtask 1</h3><p>æš´åŠ›è‡ªä¸å¿…è¯´</p><h3 id="Subtask-2"><a href="#Subtask-2" class="headerlink" title="Subtask 2"></a>Subtask 2</h3><p>å¯¹äº $k = 0$ çš„æ•°æ®ï¼Œå¦‚ä½•åšï¼Ÿ</p><p>é‚£ä¹ˆæˆ‘ä»¬åªè¦ç©ºå‡ºä¸€åˆ—ï¼ˆæˆ–ä¸€è¡Œæˆ–æ˜¯ä¸€è¡Œä¸€åˆ—ï¼‰ï¼Œè®©å…¶å®ƒçš„æ ¼å­éšä¾¿å¡«ï¼Œå› ä¸ºä¸ç®¡æ€ä¹ˆæ ·ï¼Œæœ€åç©ºå‡ºçš„è¿™ä¸€åˆ—ï¼ˆè¡Œï¼‰æ€»æ˜¯å¯ä»¥å°†æ•´è¡Œï¼ˆåˆ—ï¼‰çš„å¼‚æˆ–å’Œå˜ä¸º $1$</p><p>åŒç† $k &lt;= m$ çš„æ•°æ®æ‰¾å‡ºä¸€ä¸ªå…¨ç©ºçš„åˆ—å°±å¥½äº†</p><h3 id="Subtask-3"><a href="#Subtask-3" class="headerlink" title="Subtask 3"></a>Subtask 3</h3><p>ä»¿ç…§ $Subtask  2$ çš„æ€è·¯ï¼Œè¿˜æ˜¯æ‰¾å‡ºä¸€ä¸ªè¢«é™åˆ¶çš„æ ¼å­æœ€å°‘çš„åˆ—ï¼Œä»¤è¯¥åˆ—è¢«é™åˆ¶çš„æ ¼å­æ•°ä¸º $p$ï¼Œè€ƒè™‘åˆ° $k \le 10m$ï¼Œæ•… $p \le 10$ï¼Œé‚£ä¹ˆå¯¹äºå…¶å®ƒåˆ—ï¼Œåªè¦å…³æ³¨è¿™ $p$ è¡Œä»¥åŠå®ƒä»¬æœ¬èº«åˆ—çš„å¼‚æˆ–å’Œå°±å¥½äº†</p><p>è€ƒè™‘ä½¿ç”¨ $DP$ï¼Œè®¾ $f_{i, j, k, state}$ è¡¨ç¤ºå‰ $i$ åˆ—å‰ $j$ è¡Œï¼Œç›®å‰è¯¥åˆ—çš„å¼‚æˆ–å’Œä¸º $k$ï¼Œé‚£ $p$ è¡Œçš„å¼‚æˆ–æƒ…å†µçŠ¶å‹åä¸º $state$</p><p>å¤æ‚åº¦ $O (nm2^{\frac{k}{m}})$</p><h3 id="Subtask-4"><a href="#Subtask-4" class="headerlink" title="Subtask 4"></a>Subtask 4</h3><p>å› ä¸ºçŠ¶æ€æ•°å¤ªå¤šï¼Œè€ƒè™‘èƒ½å¤Ÿç›´æ¥è®¡ç®—çš„çŠ¶æ€æ•°å°±ç›´æ¥æ¶ˆå»</p><p>å¯¹äºé™¤äº†é‚£ $p$ è¡Œä»¥å¤–è¿˜å­˜åœ¨ä¸è¢«é™åˆ¶çš„æ ¼å­çš„åˆ—ï¼Œå¯ä»¥ç©ºå‡ºä¸€ä¸ªæ ¼å­ï¼Œç„¶åå…¶å®ƒæ ¼å­éšä¾¿å¡«ï¼Œç„¶åå°†è¿™äº›åˆ—åˆ å»</p><p>åœ¨åˆ å»ä¸Šè¿°åˆ—ä¹‹å‰ï¼Œè¿˜è¦è®¡ç®—å®ƒä»¬å¯¹äºè¡Œçš„è´¡çŒ®</p><p>å‡è®¾åœ¨ $p$ è¡Œçš„å…¶ä¸­ä¸€è¡Œï¼Œåœ¨ä¸Šè¿°åˆ—ä¸­è¯¥è¡Œæ€»å…±æœ‰ $k$ ä¸ªç©ºæ ¼ï¼Œé‚£ä¹ˆåŒç†è¿˜æ˜¯åªè¦ç•™å‡ºä¸€ä¸ªç©ºæ ¼å…¶å®ƒéšä¾¿å¡«ï¼Œæ•…ç­”æ¡ˆè¦ç®—ä¸Š $2^{k - 1}$</p><p>é‚£ä¹ˆå¯¹äºæœªåˆ å»çš„åˆ—åªéœ€è€ƒè™‘é‚£ $p$ è¡Œå°±å¯ä»¥äº†ï¼ˆå› ä¸ºå…¶å®ƒè¡Œä¸€å®šæ˜¯è¢«é™åˆ¶çš„ï¼‰ï¼Œç„¶åä»¿ç…§ $Subtask  3$ åš $DP$ å³å¯</p><p>å¤æ‚åº¦ $O (\frac{k^2}{nm}2^{\frac{k}{m}})$</p><p>æ„Ÿè§‰æ•´é¢˜å°±æ˜¯å°†ç©ºä¸€è¡Œç®—å¼‚æˆ–çš„æ€æƒ³å®Œå…¨è´¯å½»çš„è¯´</p><p>è‡³äºä»£ç ï¼Œæ„Ÿè§‰ç†è®ºä¸Šé‚£äº›å­˜åœ¨ç©ºæ ¼çš„è¡Œ $DP$ ä¹‹åä¸ç®¡å–å…¶å¼‚æˆ–ä¸º $0$ æˆ– $1$ éƒ½æ˜¯å¯ä»¥çš„ï¼ˆå¯æƒœå› ä¸ºå†™åˆ°å¿ƒæ€çˆ†ç‚¸ç„¶åå°±æ”¾å¼ƒäº†ä»£ç çš„è¯´</p><p>ï¼ˆè‡³äºè€ƒåœºä¸Šè¿ $Subtask  2$ éƒ½æ²¡æƒ³å‡ºæ¥ï¼Œåªæ˜¯çæ‰“äº† $k = 0$ çš„è§„å¾‹è€Œä¸”è¿˜æœ‰å¯èƒ½é”™çš„æˆ‘æ„Ÿè§‰æˆ‘å¥½èœå•Š</p>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Œæ¸…åé›†è®­2016ã€ä½ çš„ç”Ÿå‘½å·²å¦‚é£ä¸­æ®‹çƒ›ï¼ˆå¡ç‰¹å…°æ•°çš„å¦ä¸€ç§ç»„åˆæ„ä¹‰ï¼‰</title>
      <link href="/2020/08/04/%5B%E6%B8%85%E5%8D%8E%E9%9B%86%E8%AE%AD2016%5D%E4%BD%A0%E7%9A%84%E7%94%9F%E5%91%BD%E5%B7%B2%E5%A6%82%E9%A3%8E%E4%B8%AD%E6%AE%8B%E7%83%9B%EF%BC%88%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E7%BB%84%E5%90%88%E6%84%8F%E4%B9%89%EF%BC%89/"/>
      <url>/2020/08/04/%5B%E6%B8%85%E5%8D%8E%E9%9B%86%E8%AE%AD2016%5D%E4%BD%A0%E7%9A%84%E7%94%9F%E5%91%BD%E5%B7%B2%E5%A6%82%E9%A3%8E%E4%B8%AD%E6%AE%8B%E7%83%9B%EF%BC%88%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E7%BB%84%E5%90%88%E6%84%8F%E4%B9%89%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>å°†é¢˜æ„è½¬åŒ–ä¸€ä¸‹</p><p>æœ‰ $m = \sum\limits_{i = 1}^n w_i$ ä¸ªæ•°ï¼Œå‰ $n$ ä¸ªä¸­ç¬¬ $i$ ä¸ªä¸º $w_i âˆ’ 1$ ï¼Œå‰©ä¸‹çš„ $m âˆ’ n$ ä¸ªæ•°éƒ½æ˜¯ $âˆ’ 1$</p><p>æ±‚å¯¹è¿™ $m$ ä¸ªæ•° $m!$ ç§é‡æ’çš„æ–¹æ¡ˆä¸­ï¼Œæœ‰å¤šå°‘ç§æ»¡è¶³é‡æ’åçš„åºåˆ—ä»»æ„å‰ç¼€å’Œä¸ä¸ºè´Ÿ</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><h3 id="å¡ç‰¹å…°æ•°çš„å¦ä¸€ç§ç»„åˆæ„ä¹‰"><a href="#å¡ç‰¹å…°æ•°çš„å¦ä¸€ç§ç»„åˆæ„ä¹‰" class="headerlink" title="å¡ç‰¹å…°æ•°çš„å¦ä¸€ç§ç»„åˆæ„ä¹‰"></a>å¡ç‰¹å…°æ•°çš„å¦ä¸€ç§ç»„åˆæ„ä¹‰</h3><p>é¦–å…ˆæœ‰ä¸€ä¸ªå¼•ç†</p><ul><li>ç»™å®š $n$ ä¸ª $1$ å’Œ $n$ ä¸ª $- 1$ï¼Œå®ƒä»¬ç»„æˆä¸€ä¸ªé•¿åº¦ä¸º $2n$ çš„åºåˆ— $a$ï¼Œåˆ™å¿…å®šå­˜åœ¨ä¸€ä¸ª $i$ ä½¿å¾—åºåˆ— $a_{i + 1â€¦2n} + a_{1â€¦i}$ æ»¡è¶³ä»»æ„å‰ç¼€éƒ½ä¸å°äºé›¶</li><li>è¯æ˜ä¹Ÿå¾ˆç®€å•ï¼Œæ‰¾åˆ°ä¸€ä¸ªä½¿å¾—å‰ç¼€å’Œæœ€å°çš„ä½ç½® $i$ï¼Œè®¾ $s_{i,j}$ è¡¨ç¤º $a$ ä¸Š $a_i$ åˆ° $a_j$ çš„å’Œï¼Œé‚£ä¹ˆæ˜¾ç„¶ $s_{i + 1, 2n} \ge 0$ï¼Œå¯¹ $\forall k \in [1, i]$ï¼Œ$s_{i + 1, 2n} + s_{1, k} \ge 0$</li></ul><p>é‚£ä¹ˆæ¥ä¸‹æ¥æ±‚è§£ $n$ ä¸ª $1$ å’Œ $n$ ä¸ª $- 1$ ç»„æˆçš„åˆæ³•åºåˆ—ï¼ˆå³ä»»æ„å‰ç¼€å’Œä¸å°äºé›¶ï¼‰çš„æ–¹æ¡ˆæ•°ï¼Œä¹Ÿå°±æ˜¯å¡ç‰¹å…°æ•°</p><p>$1$ çš„ç¼–å·ä¸º $1 \sim n$ï¼Œ$- 1$ çš„ç¼–å·ä¸º $n + 1 \sim 2n$</p><p>ç°åœ¨å…ˆå‡å®šæ‰€æœ‰ $1$ å’Œ $- 1$ éƒ½æ˜¯æœ‰æ ‡å·çš„ï¼Œé‚£ä¹ˆæœ€åä¹˜ä¸Šä¸€ä¸ª $\frac1{n!n!}$ å°±å¥½äº†</p><p>ç”±äºç›´æ¥çœ‹ $2n$ çš„ç¯å¯ä»¥æ–­çš„åœ°æ–¹è¾ƒå¤šæ— æ³•å¤„ç†ï¼Œæ•…è€ƒè™‘åœ¨åé¢æ¥ä¸Šä¸€ä¸ªç¼–å·ä¸º $2n + 1$ çš„ $- 1$ï¼Œé‚£ä¹ˆç°åœ¨é—®é¢˜å°±å˜æˆç»™å®šä¸€ä¸ª $2n + 1$ é•¿åº¦çš„ç¯ï¼Œæ–­å¼€å…¶ä¸­ä¸€å¤„ $- 1$ï¼Œå¾—åˆ°çš„åºåˆ—å‰ $2n$ é¡¹ä»»æ„å‰ç¼€å’Œéè´Ÿï¼Œå‰ $2n + 1$ é¡¹å‰ç¼€å’Œä¸º $- 1$</p><p>é‚£ä¹ˆå’Œä¸Šé¢åŒæ ·å–ä¸€ä¸ªä½¿å‰ç¼€å’Œæœ€å°çš„ä½ç½® $i$ï¼ˆè‹¥æœ‰å¤šä¸ªåˆ™å–æœ€å°çš„é‚£ä¸€ä¸ªï¼‰ï¼Œå¯ä»¥è¯æ˜ $i$ ä½¿å”¯ä¸€çš„</p><p>å°±é‚£å–ç¬¬äºŒä¸ªä¸ºä¾‹ï¼Œè®¾å–ç¬¬äºŒä¸ªä½¿å‰ç¼€å’Œæœ€å°çš„ä½ç½®ä¸º $j$ï¼Œé‚£ä¹ˆæœ‰ $s_{j + 1, 2n + 1} + s_{1, j} = - 1$ï¼Œå³ $s_{j + 1, 2n + 1} + s_{1, i} = - 1$ï¼Œè¿™æ ·å­å°±å·²ç»ä¸æ»¡è¶³æ¡ä»¶äº†</p><p>è¯æ˜äº†å”¯ä¸€æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´æ–­å¼€æ–¹å¼æ˜¯å”¯ä¸€çš„</p><p>ç”±äºæ­¤æ—¶ $- 1$ ä½¿æœ‰æ ‡å·çš„ï¼Œæ€»å…±æœ‰ $n + 1$ ä¸ª $- 1$ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰ $2n + 1$ ä¸ªå…ƒç´ ç»„æˆçš„ç¯ä¸­å¹³å‡æ¯ $n + 1$ ä¸ªç¯å°±å­˜åœ¨ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°å¡ç‰¹å…°æ•°çš„é€šé¡¹<br>$$<br>Cat_n = \frac{\frac{(2n + 1)!}{2n + 1}}{(n + 1)(n!)^2} = \frac{\dbinom{2n}{n}}{n + 1}<br>$$</p><h3 id="å›åˆ°é¢˜ç›®"><a href="#å›åˆ°é¢˜ç›®" class="headerlink" title="å›åˆ°é¢˜ç›®"></a>å›åˆ°é¢˜ç›®</h3><p>åŒæ ·çš„ï¼Œè¿™ $m$ ä¸ªæ•°ç»„æˆçš„åºåˆ—åŒæ ·ä¹Ÿæ»¡è¶³å­˜åœ¨ä¸€ä¸ªä½ç½® $i$ ä½¿å¾— $s_{i + 1, m} + s_{1, i}$ ä¸å°äºé›¶</p><p>æ•…ä¹Ÿåœ¨è¯¥åºåˆ—åé¢åŠ å…¥ä¸€ä¸ªç¼–å·ä¸º $m + 1$ çš„ $- 1$ï¼Œè¿æˆç¯åæ–­ç¯æ–¹å¼å”¯ä¸€</p><p>é‚£ä¹ˆç­”æ¡ˆå³ä¸º $\frac{m!}{m - n + 1}$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">4e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">n = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) m += getnum ();</span><br><span class="line">LL fact = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= m; i ++) fact = fact * i % MOD;</span><br><span class="line">cout &lt;&lt; fact * power (m - n + 1, MOD - 2) % MOD &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»„åˆæ•°å­¦ </tag>
            
            <tag> å¡ç‰¹å…°æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Œå›½å®¶é›†è®­é˜Ÿã€middle</title>
      <link href="/2020/08/04/%5B%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%5Dmiddle/"/>
      <url>/2020/08/04/%5B%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%5Dmiddle/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ä¸€é“å…¶å®å¾ˆç®€å•ç„¶è€Œæˆ‘è¿˜æ˜¯ç„äº†é¢˜è§£çš„é¢˜</p><p>é¦–å…ˆè€ƒè™‘äºŒåˆ†ç­”æ¡ˆ</p><p>æ˜¾ç„¶å°†å°äº $mid$ çš„èµ‹ä¸º $-1$ï¼Œå°†å¤§äºç­‰äº $mid$ èµ‹ä¸º $1$</p><p>é‚£ä¹ˆæ˜¾ç„¶ $total =  $ $[q_1, q_2]$ æœ€é•¿åç¼€ $+$ ä¸­é—´å¿…é€‰ $+$ $[q_3, q_4]$ æœ€é•¿å‰ç¼€</p><p>ç„¶åè‹¥ $total \ge 0$ åˆ™ $check (mid)$ è¿”å› $true$</p><p>å¾ˆå¥½ç„¶åæˆ‘å°±ä¸ä¼šå¤„ç†äº†</p><p>äºæ˜¯é¢˜è§£å°±è¯´å°†æ¯ä¸ª $mid$ å»ºä¸€æ£µçº¿æ®µæ ‘ï¼Œç„¶åç”¨ä¸»å¸­æ ‘å°±ä¸ä¼š $MLE$ï¼ˆå¥½å§åŸæ¥æœ¬æ¥æ˜¯æƒ³å»ºåºåˆ—ä¸Šçš„ä¸»å¸­æ ‘çš„è¯´å½“ç„¶å¹¶ä¸å¯è¡Œ</p><p>é‚£ä¹ˆæ¯æ¬¡ $check$ å°±åœ¨ $mid$ å·ç‰ˆæœ¬ä¸Šçš„æ ‘æŸ¥è¯¢å³å¯</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e04</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXLOG = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXT = MAXN * MAXLOG;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, Q;</span><br><span class="line"><span class="keyword">int</span> a[MAXN], mapp[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> q[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">valueSt</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> subsum;</span><br><span class="line">    <span class="keyword">int</span> lmax, rmax;</span><br><span class="line"></span><br><span class="line">    valueSt () &#123;</span><br><span class="line">        subsum = <span class="number">0</span>;</span><br><span class="line">        lmax = rmax = - INF;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">int</span> ctree[MAXT]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> lson[MAXT]= &#123;<span class="number">0</span>&#125;, rson[MAXT]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">valueSt value[MAXT];</span><br><span class="line"><span class="keyword">int</span> nodes = <span class="number">0</span>;</span><br><span class="line"><span class="function">valueSt <span class="title">maintain</span> <span class="params">(valueSt A, valueSt B)</span> </span>&#123;</span><br><span class="line">    valueSt res;</span><br><span class="line">    res.subsum = A.subsum + B.subsum;</span><br><span class="line">    res.lmax = max (A.lmax, A.subsum + B.lmax);</span><br><span class="line">    res.rmax = max (B.rmax, A.rmax + B.subsum);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span>&amp; root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    root = ++ nodes;</span><br><span class="line">    value[root] = valueSt ();</span><br><span class="line">    <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">        value[root].subsum = value[root].lmax = value[root].rmax = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build (lson[root], left, mid);</span><br><span class="line">    build (rson[root], mid + <span class="number">1</span>, right);</span><br><span class="line">    value[root] = maintain (value[lson[root]], value[rson[root]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span> <span class="params">(<span class="keyword">int</span> pre, <span class="keyword">int</span>&amp; root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi)</span> </span>&#123;</span><br><span class="line">    root = ++ nodes;</span><br><span class="line">    lson[root] = lson[pre], rson[root] = rson[pre];</span><br><span class="line">    value[root] = value[pre];</span><br><span class="line">    <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">        value[root].subsum = value[root].lmax = value[root].rmax = - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (posi &lt;= mid) update (lson[pre], lson[root], left, mid, posi);</span><br><span class="line">    <span class="keyword">else</span> update (rson[pre], rson[root], mid + <span class="number">1</span>, right, posi);</span><br><span class="line">    value[root] = maintain (value[lson[root]], value[rson[root]]);</span><br><span class="line">&#125;</span><br><span class="line">valueSt tans;</span><br><span class="line"><span class="comment">// ä»¥ä¸‹æ³¨æ„ï¼ˆä»¥rmaxä¸ºä¾‹ï¼‰</span></span><br><span class="line"><span class="comment">// ç”±äºquery_sumæ˜¯ç”±å·¦è‡³å³èµ°ï¼Œå¹¶ä¸”maintainä¸­æ˜¯å–Bçš„rmaxæˆ–è€…å°†Aä¸Båˆå¹¶</span></span><br><span class="line"><span class="comment">// é‚£ä¹ˆåœ¨query_sumä¸­value[root]ä¸å¯èƒ½ä½œä¸ºB</span></span><br><span class="line"><span class="comment">// æ•…æœ€ç»ˆè·å¾—çš„tans.rmaxçš„èµ·å§‹ç‚¹ä¸€å®šä¸ºq[2]</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query_sum</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) &#123;</span><br><span class="line">        tans = maintain (tans, value[root]);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= mid) query_sum (lson[root], left, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span> (R &gt; mid) query_sum (rson[root], mid + <span class="number">1</span>, right, L, R);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (q[<span class="number">2</span>] + <span class="number">1</span> &lt;= q[<span class="number">3</span>] - <span class="number">1</span>) &#123;</span><br><span class="line">        tans = valueSt (), query_sum (ctree[mid], <span class="number">1</span>, N, q[<span class="number">2</span>] + <span class="number">1</span>, q[<span class="number">3</span>] - <span class="number">1</span>);</span><br><span class="line">        total += tans.subsum;</span><br><span class="line">    &#125;</span><br><span class="line">    tans = valueSt (), query_sum (ctree[mid], <span class="number">1</span>, N, q[<span class="number">1</span>], q[<span class="number">2</span>]);</span><br><span class="line">    total += tans.rmax;</span><br><span class="line">    tans = valueSt (), query_sum (ctree[mid], <span class="number">1</span>, N, q[<span class="number">3</span>], q[<span class="number">4</span>]);</span><br><span class="line">    total += tans.lmax;</span><br><span class="line">    <span class="keyword">return</span> total &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; x, <span class="keyword">const</span> <span class="keyword">int</span>&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a[x] &lt; a[y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        a[i] = getnum (), mapp[i] = i;</span><br><span class="line">    sort (mapp + <span class="number">1</span>, mapp + N + <span class="number">1</span>, comp);</span><br><span class="line">    build (ctree[<span class="number">1</span>], <span class="number">1</span>, N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        ctree[i] = ctree[i - <span class="number">1</span>];</span><br><span class="line">        update (ctree[i - <span class="number">1</span>], ctree[i], <span class="number">1</span>, N, mapp[i - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    Q = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= Q; Case ++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i ++)</span><br><span class="line">            q[i] = (getnum () + ans) % N + <span class="number">1</span>;</span><br><span class="line">        sort (q + <span class="number">1</span>, q + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">1</span>, right = N;</span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            check (mid) ? (ans = a[mapp[mid]], left = mid + <span class="number">1</span>) : right = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">170337785</span></span><br><span class="line"><span class="comment">271451044</span></span><br><span class="line"><span class="comment">22430280</span></span><br><span class="line"><span class="comment">969056313</span></span><br><span class="line"><span class="comment">206452321</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">3 1 0 2</span></span><br><span class="line"><span class="comment">2 3 1 4</span></span><br><span class="line"><span class="comment">3 1 4 0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> äºŒåˆ†ç­”æ¡ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Œå›½å®¶é›†è®­é˜Ÿã€Crashçš„æ•°å­—è¡¨æ ¼</title>
      <link href="/2020/08/04/%5B%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%5DCrash%E7%9A%84%E6%95%B0%E5%AD%97%E8%A1%A8%E6%A0%BC/"/>
      <url>/2020/08/04/%5B%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%5DCrash%E7%9A%84%E6%95%B0%E5%AD%97%E8%A1%A8%E6%A0%BC/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æ±‚ $\sum\limits_{i = 1}^N \sum\limits_{j = 1}^M lcm (i, j)$</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>æ˜“çŸ¥ï¼ŒåŸå¼<br>$$<br>\sum\limits_{i = 1}^N \sum\limits_{j = 1}^M \frac{ij}{\gcd (i, j)}<br>$$<br>æšä¸¾ $\gcd (i, j)$ ï¼Œä¸”å°† $d$ æå‡ºæ¥å¾—<br>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{i = 1}^{\left\lfloor\frac{N}{d}\right\rfloor} \sum\limits_{j = 1}^{\left\lfloor\frac{M}{d}\right\rfloor} ij[(i, j) = 1]<br>$$<br>å°†å…¬å¼ $\sum\limits_{k | n} \mu(k) = [n = 1]$ ä»£å…¥ï¼Œå¾—<br>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{i = 1}^{\left\lfloor\frac{N}{d}\right\rfloor} \sum\limits_{j = 1}^{\left\lfloor\frac{M}{d}\right\rfloor} ij \sum\limits_{k | (i, j)} \mu(k)<br>$$<br>å¥—è·¯æšä¸¾ $k$ ï¼Œå¾—</p><p>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{k = 1}^{\min (\left\lfloor\frac{N}{d}\right\rfloor, \left\lfloor\frac{M}{d}\right\rfloor)} \mu(k) \sum\limits_{i = 1}^{\left\lfloor\frac{N}{d}\right\rfloor} \sum\limits_{j = 1}^{\left\lfloor\frac{M}{d}\right\rfloor} ij [k | (i, j)]<br>$$<br>é‚£ä¹ˆ $ij$ å­˜åœ¨è´¡çŒ®æ—¶å…¶å¿…å®šæ˜¯ $k$ çš„å€æ•°ï¼Œæ•…<br>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{k = 1}^{\min (\left\lfloor\frac{N}{d}\right\rfloor, \left\lfloor\frac{M}{d}\right\rfloor)} \mu(k) \sum\limits_{ki = 1}^{\left\lfloor\frac{N}{d}\right\rfloor} \sum\limits_{kj = 1}^{\left\lfloor\frac{M}{d}\right\rfloor} k^2 ij<br>$$<br>å°† $k$ æå‡ºï¼Œå¾—<br>$$<br>\sum\limits_{d = 1}^{\min (N, M)} d \sum\limits_{k = 1}^{\min (\left\lfloor\frac{N}{d}\right\rfloor, \left\lfloor\frac{M}{d}\right\rfloor)} k^2 \mu(k) ( \sum\limits_{i = 1}^{\left\lfloor\frac{N}{kd}\right\rfloor} i) (\sum\limits_{j = 1}^{\left\lfloor\frac{M}{kd}\right\rfloor} j)<br>$$<br>é‚£ä¹ˆå°±å¯ä»¥é¢„å¤„ç† $\sum\limits_{k = 1}^n k^2 \mu(k)$ ï¼Œåé¢çš„ç”¨æ•´é™¤åˆ†å—å°±å¥½äº†</p><h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 20101009</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e07</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN];</span><br><span class="line"><span class="keyword">int</span> vis[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mu[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1e07</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prime_Acqu</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! vis[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">mu[i] = - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j]))</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">mu[i * prime[j]] = - mu[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX; i ++)</span><br><span class="line">sum[i] = (sum[i - <span class="number">1</span>] + <span class="number">1l</span>l * i * <span class="number">1l</span>l * i % MOD * mu[i] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">LL fn = (LL) n;</span><br><span class="line"><span class="keyword">return</span> (fn * (fn + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> limit = min (N, M);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">1</span>; d &lt;= limit; d ++) &#123;</span><br><span class="line">LL total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> minlim = min (N / d, M / d);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r; l &lt;= minlim; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = min ((N / d) / ((N / d) / l), (M / d) / ((M / d) / l));</span><br><span class="line">total = (total + (sum[r] - sum[l - <span class="number">1</span>] + MOD) % MOD * calc (N / d / l) % MOD * calc (M / d / l) % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">ans = (ans + (LL) (d) * total % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">prime_Acqu ();</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d"</span>, &amp; N, &amp; M);</span><br><span class="line">LL ans = Solve ();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è«æ¯”ä¹Œæ–¯åæ¼” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Œå››æ ¡è”è€ƒã€å¯†ç </title>
      <link href="/2020/08/04/%5B%E5%9B%9B%E6%A0%A1%E8%81%94%E8%80%83%5D%E5%AF%86%E7%A0%81/"/>
      <url>/2020/08/04/%5B%E5%9B%9B%E6%A0%A1%E8%81%94%E8%80%83%5D%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®š $n$ è¡Œ $m$ åˆ—çš„ $01$ çŸ©é˜µï¼Œæ±‚æ»¡è¶³ $\big(\sum_{\forall i \in A, j \in B} value_{i, j}\big) \equiv 0 \pmod{2}$ çš„äºŒå…ƒç»„çš„æ•°é‡</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é¦–å…ˆè€ƒè™‘ $n = 1$ï¼Œä»¤ $1$ çš„ä¸ªæ•°ä¸º $t$ï¼Œå¯ä»¥å‘ç°ç­”æ¡ˆ<br>$$<br>\sum\limits_{k = 0}^{\lfloor\frac{m}{2}\rfloor} \dbinom{t}{2k} \times 2^{m - t} - 1 = 2^{m - 1} - 1<br>$$<br>è‡³äºè¯æ˜ï¼Œå¯ä»¥è€ƒè™‘å·²ç»é€‰å¥½çš„æ•°åˆ— $\{a_1, a_2, â€¦, a_n\}$ï¼Œé‚£ä¹ˆç°åœ¨è€ƒè™‘åŠ å…¥ç¬¬ $n +1$ ä¸ªï¼Œæ˜¾ç„¶åŠ å…¥ $0, 1$ éƒ½æ˜¯å¤šäº†ä¸¤ç§é€‰æ‹©</p><p>é‚£ä¹ˆç°åœ¨è€ƒè™‘å°†è¡Œåˆå¹¶æˆä¸€åˆ—</p><p>ä½†æ˜¯é—®é¢˜æ˜¯å¦‚æœéœ€è¦æšä¸¾é€‰çš„è¡Œè¿˜æ˜¯éœ€è¦ $2^n$ çš„å¤æ‚åº¦ï¼Œç„¶åæˆ‘è€ƒåœºä¸Šå°±æƒ³åˆ°è¿™å°±å‡‰äº†</p><p>é‚£ä¹ˆæ˜¾ç„¶æ¯æ¬¡é€‰å¥½äº†è¡Œï¼Œå†é€‰åˆ—çš„æ—¶å€™è¿™è‹¥å¹²ä¸ªåˆ—ä¼šè´¯ç©¿æ‰€æœ‰è¡Œï¼Œé‚£å°±å¯ä»¥å°†æ¯è¡Œçœ‹ä½œä¸€ä¸ªæ•°ï¼Œå¹¶ä¸”å°†å®ƒä»¬åˆå¹¶ï¼ˆå¼‚æˆ–ï¼‰èµ·æ¥ï¼Œè¿™æ ·å°±å˜æˆåš $n = 1$ çš„æƒ…å†µäº†</p><p>æ¥ä¸‹æ¥åªè¦è€ƒè™‘æœ‰å‡ ç§æƒ…å†µä¼šä½¿å¾—å…¶å¼‚æˆ–å’Œä¸º $1$ ï¼ˆæˆ–ä¸ä¸º $1$ï¼‰å°±è¡Œäº†</p><p>å°†å®ƒä»¬æ±‚çº¿æ€§åŸºï¼Œå› ä¸ºè¡¨ç¤ºåŸºçš„è¡Œå‘é‡ä¸å¯èƒ½ç»„æˆ $0$ï¼Œæ•…å¼‚æˆ–å’Œä¸º $0$ çš„æƒ…å†µå°±æ˜¯ $2^{\text{æ‰€æœ‰çš„é›¶å‘é‡ä¸ªæ•°}}$</p><p>ä»¤æ‰€æœ‰é›¶å‘é‡ä¸ªæ•°ä¸º $k$ï¼Œé‚£ä¹ˆç­”æ¡ˆå³ä¸º $(2^k - 1)(2^m - 1) + (2^n - 2^k)(2^{m - 1} - 1)$</p><p>ç„¶åé«˜æ–¯æ¶ˆå…ƒå†ç”¨ $bitset$ ç»´æŠ¤ä¸€ä¸‹å°±å¥½äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="built_in">bitset</span>&lt;MAXN&gt; bit[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Guass</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> row, col;</span><br><span class="line"><span class="keyword">for</span> (row = <span class="number">1</span>, col = <span class="number">1</span>; row &lt;= N &amp;&amp; col &lt;= M; row ++, col ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = row + <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (bit[i][col])</span><br><span class="line">swap (bit[row], bit[i]);</span><br><span class="line"><span class="keyword">if</span> (! bit[row][col]) &#123;</span><br><span class="line">row --;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = row + <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (bit[i][col])</span><br><span class="line">bit[i] ^= bit[row];</span><br><span class="line">&#125;</span><br><span class="line">row --;</span><br><span class="line"><span class="keyword">return</span> N - row;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">freopen (<span class="string">"password.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">freopen (<span class="string">"password.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> p = getnum ();</span><br><span class="line">bit[i][j] = p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> zero = Guass ();</span><br><span class="line">LL ans = ((power (<span class="number">2l</span>l, zero) - <span class="number">1</span> + MOD) % MOD * ((power (<span class="number">2l</span>l, M) - <span class="number">1</span> + MOD) % MOD) % MOD +</span><br><span class="line"> (power (<span class="number">2l</span>l, N) - power (<span class="number">2l</span>l, zero) + MOD) % MOD * ((power (<span class="number">2l</span>l, M - <span class="number">1</span>) - <span class="number">1</span> + MOD) % MOD) % MOD) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">0 0</span></span><br><span class="line"><span class="comment">0 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3</span></span><br><span class="line"><span class="comment">1 1 0</span></span><br><span class="line"><span class="comment">0 1 0</span></span><br><span class="line"><span class="comment">1 0 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§åŸº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Œå››æ ¡è”è€ƒã€å¤§æ°´é¢˜ ã€Œç®€å•pruferåºåˆ—ã€</title>
      <link href="/2020/08/04/%5B%E5%9B%9B%E6%A0%A1%E8%81%94%E8%80%83%5D%E5%A4%A7%E6%B0%B4%E9%A2%98%20%E3%80%8C%E7%AE%80%E5%8D%95prufer%E5%BA%8F%E5%88%97%E3%80%8D/"/>
      <url>/2020/08/04/%5B%E5%9B%9B%E6%A0%A1%E8%81%94%E8%80%83%5D%E5%A4%A7%E6%B0%B4%E9%A2%98%20%E3%80%8C%E7%AE%80%E5%8D%95prufer%E5%BA%8F%E5%88%97%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="pruferåºåˆ—"><a href="#pruferåºåˆ—" class="headerlink" title="pruferåºåˆ—"></a>pruferåºåˆ—</h2><p>pruferåºåˆ—æ˜¯ä¸€ç§æ— æ ¹æ ‘çš„åºåˆ—è¡¨ç¤ºæ–¹æ³•ï¼Œ<strong>ä¸€ä¸ªèŠ‚ç‚¹ä¸ªæ•°ä¸º $n$ çš„æ— æ ¹æ ‘å¯¹åº”ç€å”¯ä¸€ä¸€ç§é•¿åº¦ä¸º $n - 2$ çš„pruferåºåˆ—</strong></p><h3 id="æ— æ ¹æ ‘åŒ–pruferåºåˆ—"><a href="#æ— æ ¹æ ‘åŒ–pruferåºåˆ—" class="headerlink" title="æ— æ ¹æ ‘åŒ–pruferåºåˆ—"></a>æ— æ ¹æ ‘åŒ–pruferåºåˆ—</h3><p>æ¯æ¬¡å–ç¼–å·æœ€å°çš„å¶å­èŠ‚ç‚¹ï¼Œå°†å…¶æŒ‡å‘çš„â€œçˆ¶äº²â€ï¼ˆå°±æ˜¯å®ƒå”¯ä¸€æŒ‡å‘çš„ï¼‰èŠ‚ç‚¹åŠ å…¥pruferåºåˆ—ä¸­ï¼Œæœ€ç»ˆå‰©ä½™ä¸¤ä¸ªè¿æ¥çš„èŠ‚ç‚¹ç»“æŸ</p><h3 id="pruferåºåˆ—åŒ–æ— æ ¹æ ‘"><a href="#pruferåºåˆ—åŒ–æ— æ ¹æ ‘" class="headerlink" title="pruferåºåˆ—åŒ–æ— æ ¹æ ‘"></a>pruferåºåˆ—åŒ–æ— æ ¹æ ‘</h3><p>å¯¹äºpruferåºåˆ— $A= \{a_1, a_2, a_3, â€¦\}$ï¼Œæ¯æ¬¡å–æœ€å‰é¢çš„å…ƒç´  $a_s$ï¼Œåœ¨æ€»ç‚¹é›†ä¸­æ‰¾åˆ°æœ€å°çš„æ²¡æœ‰åœ¨ $A$ ä¸­çš„èŠ‚ç‚¹ $t$ï¼Œå°† $a_s,  t$ è¿è¾¹å¹¶åˆ å» $a_s$ï¼Œå¯ä»¥ä½¿ç”¨ $set$ ç­‰ç»´æŠ¤</p><h3 id="ç›¸å…³å®šç†"><a href="#ç›¸å…³å®šç†" class="headerlink" title="ç›¸å…³å®šç†"></a>ç›¸å…³å®šç†</h3><ul><li>$n$ ä¸ªç‚¹çš„æœ‰æ ‡å·å®Œå…¨å›¾æ— æ ¹æ ‘è®¡æ•°ï¼š$n^{n - 2}$</li><li>$n$ ä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹çš„åº¦æ•°ä¸º $\{d_1, d_2, d_3, â€¦\}$ çš„æœ‰æ ‡å·æ— æ ¹æ ‘è®¡æ•°ï¼š$\frac{(n - 2)!}{d_1!d_2!d_3!â€¦}$ï¼ˆå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¤šé‡é›†çš„æ’åˆ—æ•°ï¼‰</li><li>$n$ ä¸ªç‚¹çš„pruferåºåˆ—ä¸­ç¬¬ $i$ ä¸ªç‚¹æ°å¥½å‡ºç° $d_i - 1$ æ¬¡</li><li>$n$ ä¸ªç‚¹åº¦æ•°ä¸º $\{d_1, d_2, â€¦, d_k\}$ï¼Œå‰©ä½™ $k + 1 \thicksim n$ æœªçŸ¥åº¦æ•°çš„èŠ‚ç‚¹çš„æœ‰æ ‡å·æ— æ ¹æ ‘è®¡æ•°ï¼šè®¾å‰©ä½™çš„ä½ç½® $d_l = (n - 2) - \sum\limits_{i = 1}^k (d_i- 1) $ï¼Œå…ˆå°†å®ƒä»¬çœ‹ä½œä¸€ä¸ªæ•´ä½“å†å±€éƒ¨æ±‚è§£å¾—åˆ° $ans = \frac{(n - 2)!}{d_1!d_2!â€¦d_k!d_l!}(n - k)^{d_l}$</li><li>$n$ ä¸ªç‚¹çš„æœ‰æ ‡å·æœ‰æ ¹æ ‘è®¡æ•°ï¼š$n^{n - 1}$</li><li>$n$ ä¸ªç‚¹çš„æ— æ ‡å·æœ‰æ ¹æ ‘è®¡æ•°ï¼šå¾…ç»­</li><li>$n$ ä¸ªç‚¹çš„æ— æ ‡å·æ— æ ¹æ ‘è®¡æ•°ï¼šå¾…ç»­</li></ul><h2 id="æœ¬é¢˜é¢˜è§£"><a href="#æœ¬é¢˜é¢˜è§£" class="headerlink" title="æœ¬é¢˜é¢˜è§£"></a>æœ¬é¢˜é¢˜è§£</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>æœ‰ $n$ ä¸ªæœ‰æ ‡å·ç‚¹ï¼Œç¬¬ $i$ ä¸ªç‚¹çš„åº¦æ•°ä¸Šé™ä¸º $A_i$</p><p>ç°åœ¨å¯¹äºæ¯ä¸ª $s (1 \le s \le n)$ï¼Œé—®ä»è¿™ $n$ ä¸ªç‚¹ä¸­é€‰å‡ºä¸€äº›ç‚¹ç»„æˆå¤§å°ä¸º $s$ çš„æœ‰æ ‡å·æ— æ ¹æ ‘çš„æ–¹æ¡ˆæ•°</p><h3 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h3><p>å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$n \le 100$</p><p>è€ƒè™‘ç›´æ¥å°†æ— æ ¹æ ‘è½¬åŒ–ä¸ºpruferåºåˆ—ï¼Œç”±å”¯ä¸€æ€§åœ¨åºåˆ—ä¸Šç›´æ¥ $dp$<br>ä»¤ $f_{i, j, k}$ è¡¨ç¤ºå‰ $i$ ä¸ªç‚¹é€‰ $j$ ä¸ªç»„æˆé•¿åº¦ä¸º $k$ çš„pruferåºåˆ—çš„æ–¹æ¡ˆæ•°</p><p>æ˜¾ç„¶<br>$$<br>\begin{aligned}<br>f_{i + 1, j, k} &amp;+= f_{i, j, k} \\<br>f_{i + 1, j + 1, k + l(l \in [0, A_{i + 1} - 1])} &amp;+= f_{i, j, k} \times \dbinom{k + l}{l}<br>\end{aligned}<br>$$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1004535809</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL C[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL f[MAXN][MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> limit[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>)</span><br><span class="line">write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">freopen (<span class="string">"tree.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">freopen (<span class="string">"tree.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">limit[i] = getnum ();</span><br><span class="line">C[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">C[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">C[i][j] = (C[i - <span class="number">1</span>][j - <span class="number">1</span>] + C[i - <span class="number">1</span>][j]) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= N; k ++) &#123; <span class="comment">// æ³¨æ„éœ€çœ¼ç¥åˆ°N</span></span><br><span class="line">f[i][j][k] = f[i - <span class="number">1</span>][j][k];</span><br><span class="line"><span class="keyword">if</span> (j &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt;= k &amp;&amp; l &lt; limit[i]; l ++) <span class="comment">// æ³¨æ„å› ä¸ºå¯ä»¥ä½œå¶å­æ‰€ä»¥léœ€è¦ä»0å¼€å§‹æšä¸¾</span></span><br><span class="line">f[i][j][k] = (f[i][j][k] + f[i - <span class="number">1</span>][j - <span class="number">1</span>][k - l] * C[k][l] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">write (N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">' '</span>), write (f[N][i][i - <span class="number">2</span>]);</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">2 2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">1 5 2 4 4 4</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">output:</span></span><br><span class="line"><span class="comment">6 15 50 160 392 509</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> pruferåºåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒåŒ—äº¬çœé€‰é›†è®­2019ã€ç”Ÿæˆæ ‘è®¡æ•°ã€ŒMatrix-Treeã€</title>
      <link href="/2020/08/04/%5B%E5%8C%97%E4%BA%AC%E7%9C%81%E9%80%89%E9%9B%86%E8%AE%AD2019%5D%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0%E3%80%8CMatrix-Tree%E3%80%8D/"/>
      <url>/2020/08/04/%5B%E5%8C%97%E4%BA%AC%E7%9C%81%E9%80%89%E9%9B%86%E8%AE%AD2019%5D%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0%E3%80%8CMatrix-Tree%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><h3 id="Matrix-Treeå®šç†"><a href="#Matrix-Treeå®šç†" class="headerlink" title="Matrix-Treeå®šç†"></a>Matrix-Treeå®šç†</h3><p>å¯¹äºæ— å‘å›¾ $G$ï¼Œå®šä¹‰å…¶åº¦æ•°çŸ©é˜µ $D$<br>$$<br>\left[<br>\begin{matrix}<br>deg_1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\<br>0 &amp; deg_2 &amp; 0 &amp; \cdots &amp; 0 \\<br>0 &amp; 0 &amp; deg_3 &amp; \cdots &amp; 0 \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; deg_n<br>\end{matrix}<br>\right]<br>$$<br>å®šä¹‰å…¶é‚»æ¥çŸ©é˜µ $C$<br>$$<br>\left[<br>\begin{matrix}<br>0 &amp; a_{1,2} &amp; a_{1,3} &amp; \cdots &amp; a_{1,n} \\<br>a_{2,1} &amp; 0 &amp; a_{2,3} &amp; \cdots &amp; a_{2,n} \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>a_{n,1} &amp; a_{n,2} &amp; a_{n,3} &amp; a_{n,4} &amp; 0<br>\end{matrix}<br>\right]<br>$$<br>å…¶ä¸­ $a_{i, j} \in \{0, ~1\}$</p><p>å®šäºå…¶çš„åŸºå°”éœå¤«çŸ©é˜µ $L(G) = D - C$ï¼Œåˆ™æœ‰ $L(G)$ çš„ä»»æ„ä»£æ•°ä½™å­å¼å³ä¸ºæ— å‘å›¾ $G$ çš„ç”Ÿæˆæ ‘ä¸ªæ•°</p><p>è‡³äºæ±‚ä»£æ•°ä½™å­å¼åˆ™ä»»æ„åˆ å»ç¬¬ $i$ è¡Œ $i$ åˆ—é«˜æ–¯æ¶ˆå…ƒå¾—å…¶æ–œä¸Šä¸‰è§’çŸ©é˜µæœ€åå³æœ‰ $ans = \sum\limits_i a_{i,i}$</p><p>è‡³äºè¯æ˜å°±ç•™å‘å§</p><h4 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h4><ul><li>å¸¦æƒå›¾ç”Ÿæˆæ ‘ï¼šå®šä¹‰ä¸€æ£µç”Ÿæˆæ ‘çš„æƒå€¼ä¸ºè¾¹æƒä¹‹ç§¯ï¼Œæ±‚è§£æ‰€æœ‰ç”Ÿæˆæ ‘çš„æƒå€¼ä¹‹å’Œã€‚      å°† $D$ ä¸­çš„ $deg_i$ æ”¹ä¸ºè¿æ¥å…¶çš„ç‚¹çš„æƒå€¼å’Œï¼Œå†ä»¤ $C$ ä¸­ $a_{i, j} = w_{i, j}$ ï¼ˆ$w_{i, j}$ ä¸ºè¾¹æƒï¼‰ï¼Œæœ€åMatrix-Treeå®šç†å³å¯</li><li>æœ‰å‘å›¾çš„ç”Ÿæˆæ ‘å½¢å›¾è®¡æ•°ï¼šæˆ‘ä»¬å°†åº¦æ•°çŸ©é˜µæ”¹ä¸ºå…¥åº¦ï¼Œé‚»æ¥çŸ©é˜µæ”¹ä¸ºæœ‰å‘è¾¹çš„é‚»æ¥çŸ©é˜µï¼Œä»¥ $p$ ä¸ºæ ¹çš„æ ‘å½¢å›¾ä¸ªæ•°æ˜¯å»æ‰ $p$ è¡Œ $p$ åˆ—ååšè¡Œåˆ—å¼å¾—çš„ç­”æ¡ˆ</li></ul><h3 id="å¤šé¡¹å¼æ±‚é€†-O-n-2"><a href="#å¤šé¡¹å¼æ±‚é€†-O-n-2" class="headerlink" title="å¤šé¡¹å¼æ±‚é€† $O (n^2)$"></a>å¤šé¡¹å¼æ±‚é€† $O (n^2)$</h3><p>äºæ˜¯æˆ‘å…ˆä¼š $O (n \log n)$ å†ä¼š $O (n^2)$ æˆ‘ä¹Ÿå¾ˆç»æœ›å•Š</p><p>ä»¤ $C(x) = A(x)B(x) \pmod p$ï¼Œé¦–å…ˆæœ‰ $C_0 = A_0B_0 = 1 \pmod p$ ï¼ˆæ­¤å¤„è¡¨ç¤ºåœ¨ $\mod p$ æ„ä¹‰ä¸‹ï¼Œç„¶åä»¥ $C_1$ ä¸ºä¾‹ï¼Œåˆ™æœ‰ $C_1 = A_0B_1 + A_1B_0 = 0 \pmod p$ï¼Œå¯è§£å¾— $B_1 = - \frac{A_1B_0}{A_0}$ï¼Œå…¶å®ƒåŒç†</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é¦–å…ˆå¯¹äº $(w_1 + w_2 + w_3 + \wedge ~+ w_n)^k = \sum\prod\limits_{i = 1}^n w_{\forall}$</p><p>é‚£ä¹ˆå¯ä»¥è”æƒ³åˆ°æœ‰æ ‡å·çš„æ•´æ•°æ‹†åˆ†ï¼Œé‚£ä¹ˆå³å¯å°†æ¯æ¡è¾¹çš„è¾¹æƒè®¾ä¸ºåŸè¾¹æƒçš„ EGFï¼Œå³ $value = \sum\limits_{n \ge 0} w^n\frac{x^n}{n!}$ ï¼ˆ$w$ ä¸ºåŸè¾¹æƒï¼‰ï¼Œæ¥ä¸‹æ¥Matrix-Treeå³å¯</p><p>æœ€åå¾—åˆ°ä¸€ä¸ªå¤šé¡¹å¼ $G(x)$ï¼Œç­”æ¡ˆå³ä¸º $ans = G_k \cdot fact_k$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">30</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">30</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">LL invf[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, k;</span><br><span class="line"></span><br><span class="line">LL <span class="built_in">map</span>[MAXN][MAXN][MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL res[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL temp[MAXK]= &#123;<span class="number">0</span>&#125;, tmp[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multiply</span> <span class="params">(LL* a, LL* b, LL* ret)</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (temp, <span class="number">0</span>, <span class="keyword">sizeof</span> (temp));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++)</span><br><span class="line">temp[i] = (temp[i] + a[j] * b[i - j] % MOD) % MOD;</span><br><span class="line"><span class="built_in">memcpy</span> (ret, temp, <span class="keyword">sizeof</span> (temp));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inv</span> <span class="params">(LL* a, LL* ret)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; i ++)</span><br><span class="line">temp[i] = tmp[i] = <span class="number">0</span>;</span><br><span class="line">temp[<span class="number">0</span>] = power (a[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i ++)</span><br><span class="line">tmp[i] = a[i] * temp[<span class="number">0</span>] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j ++)</span><br><span class="line">temp[i] = (temp[i] - tmp[j] * temp[i - j] % MOD + MOD) % MOD;</span><br><span class="line"><span class="built_in">memcpy</span> (ret, temp, <span class="keyword">sizeof</span> (temp));</span><br><span class="line">&#125;</span><br><span class="line">LL ret[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Gauss</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">res[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">multiply (<span class="built_in">map</span>[i][i], res, res);</span><br><span class="line">inv (<span class="built_in">map</span>[i][i], ret);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; N; j ++)</span><br><span class="line">multiply (<span class="built_in">map</span>[i][j], ret, <span class="built_in">map</span>[i][j]);</span><br><span class="line"><span class="built_in">memset</span> (<span class="built_in">map</span>[i][i], <span class="number">0</span>, <span class="keyword">sizeof</span> (<span class="built_in">map</span>[i][i]));</span><br><span class="line"><span class="built_in">map</span>[i][i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> t = N - <span class="number">1</span>; t &gt;= i; t --) &#123;</span><br><span class="line">multiply (<span class="built_in">map</span>[i][t], <span class="built_in">map</span>[j][i], ret);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt;= k; l ++) &#123;</span><br><span class="line"><span class="built_in">map</span>[j][t][l] = (<span class="built_in">map</span>[j][t][l] - ret[l] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), k = getnum ();</span><br><span class="line">invf[<span class="number">0</span>] = invf[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= k; i ++)</span><br><span class="line">invf[i] = (- MOD / i + MOD) % MOD * invf[MOD % i] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i ++)</span><br><span class="line">invf[i] = invf[i] * invf[i - <span class="number">1</span>] % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123;</span><br><span class="line">LL delta = getnum ();</span><br><span class="line"><span class="keyword">if</span> (j &lt;= i) <span class="keyword">continue</span>;</span><br><span class="line">LL <span class="built_in">pow</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt;= k; l ++) &#123;</span><br><span class="line">LL value = <span class="built_in">pow</span> * invf[l] % MOD;</span><br><span class="line"><span class="built_in">map</span>[i][j][l] = <span class="built_in">map</span>[j][i][l] = (- value + MOD) % MOD;</span><br><span class="line"><span class="built_in">map</span>[i][i][l] = (<span class="built_in">map</span>[i][i][l] + value) % MOD;</span><br><span class="line"><span class="built_in">map</span>[j][j][l] = (<span class="built_in">map</span>[j][j][l] + value) % MOD;</span><br><span class="line"><span class="built_in">pow</span> = <span class="built_in">pow</span> * delta % MOD;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Gauss ();</span><br><span class="line">LL ans = res[k];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i ++)</span><br><span class="line">ans = ans * i % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 3</span></span><br><span class="line"><span class="comment">0 0 1 1</span></span><br><span class="line"><span class="comment">0 0 1 1</span></span><br><span class="line"><span class="comment">1 1 0 0</span></span><br><span class="line"><span class="comment">1 1 0 0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çŸ©é˜µæ ‘å®šç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Problem 5280 - [ZJOI2019]çº¿æ®µæ ‘</title>
      <link href="/2020/08/04/%5BZJOI2019%5D%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
      <url>/2020/08/04/%5BZJOI2019%5D%E7%BA%BF%E6%AE%B5%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>çœ‹é¢˜è§£é‡Œæœ‰äººè¯´è¿™é¢˜å®åœ¨å¤ªæ°´</p><p>ä½†æˆ‘è¿ç¬¬ä¸€æ­¥å¯¹ç‚¹åˆ†ç±»éƒ½ä¸ä¼šï¼ˆè™½ç„¶åˆ†ç±»å®Œåçš„ç¡®ä¸ä¼šå¾ˆéš¾ï¼‰</p><p>æˆ‘ä¾æ—§æ˜¯å¤ªèœ</p><p>å¥½äº†è¿›å…¥æ­£é¢˜</p><p>çº¿æ®µæ ‘ä¸Šæ‰“ $\text{tag}$ï¼Œå› ä¸ºå®ƒä¸€ç›´å¤åˆ¶æ¥å¤åˆ¶å»ï¼Œä¸å¯èƒ½åœ¨æ²¡æ£µçº¿æ®µæ ‘ä¸Šéƒ½è¿›è¡Œä¿®æ”¹ï¼Œå°±è€ƒè™‘ç‚¹çš„å…±åŒæ€§è´¨ï¼Œç›¸åŒæ€§è´¨çš„ç‚¹å¯ä»¥ä¸€èµ·ä¿®æ”¹ï¼Œé‚£ä¹ˆæ­¤æ—¶ç›¸å½“äºåªè¿›è¡Œä¸€æ¬¡ $\text{modify}$ å°±è¡Œäº†</p><p>å¯ä»¥å°†ç‚¹åˆ†æˆäº”ç±»ï¼š</p><ul><li>ä¸€ç±»ç‚¹ï¼šåŠè¦†ç›–ï¼ˆå°±æ˜¯ä¿®æ”¹æ—¶ä¼šç»è¿‡ä½†æ˜¯ä¸æ‰“æ ‡è®°ï¼‰</li><li>äºŒç±»ç‚¹ï¼šå…¨è¦†ç›–ï¼Œæ‰“æ ‡è®°ï¼ˆåŒºé—´è¢«ä¿®æ”¹åŒºé—´å®Œå…¨è¦†ç›–ï¼Œä¼šè¢«è®¿é—®åˆ°ï¼Œè¢«æ‰“æ ‡è®°ï¼‰</li><li>ä¸‰ç±»ç‚¹ï¼šå…¨è¦†ç›–ï¼Œä¸æ‰“æ ‡è®°ï¼ˆåŒºé—´è¢«ä¿®æ”¹åŒºé—´å®Œå…¨è¦†ç›–ï¼Œä½†ä¸ä¼šè¢«è®¿é—®åˆ°ï¼Œå°±æ˜¯æ‰“æ ‡è®°å…¨è¦†ç›–èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œä¸è¢«æ‰“æ ‡è®°ï¼‰</li><li>å››ç±»ç‚¹ï¼šè®¿é—®ä¸åˆ°ï¼Œä¼šè¢«ä¸‹ä¼ æ ‡è®°</li><li>äº”ç±»ç‚¹ï¼šè®¿é—®ä¸åˆ°ï¼Œä¸ä¼šè¢«ä¸‹ä¼ æ ‡è®°</li></ul><p>é‚£ä¹ˆæ­¤æ—¶æ–¹æ¡ˆæ•°è½¬æ¦‚ç‡ï¼Œä»¤ $f_u$ è¡¨ç¤ºèŠ‚ç‚¹ $u$ æœ‰è¢«æ‰“æ ‡è®°çš„æ¦‚ç‡ï¼Œå³ $u$ æœ‰è¢«æ‰“æ ‡è®°çš„çº¿æ®µæ ‘å æ¯”ï¼Œé‚£ä¹ˆæœ€ç»ˆè¢«æ‰“æ ‡è®°çš„èŠ‚ç‚¹ $u$ ä¸ªæ•°å³ä¸º $f_u \times 2^n$ï¼ˆå…¶ä¸­ $n$ è¡¨ç¤ºè¢«ä¿®æ”¹æ¬¡æ•°ï¼‰</p><p>ä½†æ˜¯ä¼šå‘ç°å†™å››ç±»ç‚¹çš„æ—¶å€™è¿˜éœ€è¦çŸ¥é“å®ƒç¥–å…ˆæœ‰æ²¡æœ‰è¢«æ‰“æ ‡è®°ï¼Œæ‰€ä»¥è¿˜éœ€è¦è®¾ä¸€ä¸ª $g_u$ è¡¨ç¤ºèŠ‚ç‚¹ $u$ åŠå…¶ç¥–å…ˆè¢«æ‰“æ ‡è®°çš„æ¦‚ç‡ï¼Œå¼€å§‹è½¬ç§»</p><p>å¯¹ä¸€ç±»ç‚¹ï¼Œå¤åˆ¶åä¸€åŠä¿æŒåŸæ ·ï¼Œä¸€åŠå¿…å®šæ— æ ‡è®°ï¼ˆå› ä¸ºæ˜¯ç»è¿‡ç‚¹è‚¯å®šä¼šè¢«ä¸‹ä¼ ï¼‰ï¼Œå…¶ç¥–å…ˆåŒç†<br>$$<br>f_u = \frac12(f_u + 0), g_u = \frac12(g_u + 0)<br>$$<br>å¯¹äºŒç±»ç‚¹ï¼Œå¤åˆ¶åä¸€åŠä¿æŒåŸæ ·ï¼Œä¸€åŠå¿…å®šä¼šè¢«æ‰“æ ‡è®°<br>$$<br>f_u = \frac12(f_u + 1), g_u = \frac12(g_u + 1)<br>$$<br>å¯¹ä¸‰ç±»ç‚¹ï¼Œå¤åˆ¶åä¸€åŠä¿æŒåŸæ ·ï¼Œä¸€åŠå¿…å®šä¸ä¼šè¢«ä¸‹ä¼ æ ‡è®°ï¼Œä½†å…¶ç¥–å…ˆå¿…å®šä¼šè¢«æ ‡è®°<br>$$<br>f_u = f_u, g_u = \frac12(g_u + 1)<br>$$<br>å¯¹å››ç±»ç‚¹ï¼Œå¤åˆ¶åä¸€åŠä¿æŒåŸæ ·ï¼Œä¸€åŠå¯èƒ½ä¼šè¢«ä¸‹ä¼ æ ‡è®°ï¼ˆå¿…å®šä¼šç»è¿‡å…¶çˆ¶èŠ‚ç‚¹ï¼Œå¦åˆ™å®ƒä¸å¯èƒ½æˆä¸ºå››ç±»ç‚¹ï¼ŒåŒæ—¶æ˜¯å¦ä¼šè¢«ä¸‹ä¼ æ ‡è®°å–å†³äºå®ƒç¥–å…ˆæ˜¯å¦æœ‰æ ‡è®°ï¼Œå³ $g_u$ï¼‰<br>$$<br>f_u = \frac12(f_u + g_u), g_u = g_u<br>$$<br>å¯¹äº”ç±»ç‚¹ï¼Œå¤åˆ¶åä¸€åŠä¿æŒåŸæ ·ï¼Œä¸€åŠä¹Ÿä¸ä¼šè¢«å½±å“<br>$$<br>f_u = f_u, g_u = g_u<br>$$<br>æ•…äº”ç±»ç‚¹å¯ä¸åšå¤„ç†</p><p>ä½†æ˜¯ä¸‰ç±»ç‚¹çš„æ•°ç›®å¾ˆå¤šï¼Œæ˜¯ $O (n)$ çº§åˆ«ï¼Œæ•…å¯¹ä¸‰ç±»ç‚¹çš„ä¿®æ”¹è¿˜éœ€è¦æ‰“æ‡’æ ‡è®°</p><p>å†å¼€ä¸€ä¸ª $sumf_u$ ç»´æŠ¤å…¶å­æ ‘ç­”æ¡ˆ</p><p>æœ€ç»ˆç­”æ¡ˆå³ä¸º $sumf_1 \times 2^n$</p><p>æ—¶é—´å¤æ‚åº¦ $O (m\log n)$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">8e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL inv2 = <span class="number">499122177</span>;</span><br><span class="line"></span><br><span class="line">LL f[MAXN]= &#123;<span class="number">0</span>&#125;, g[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumf[MAXN]= &#123;<span class="number">0</span>&#125;, lazy[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">lazy[root] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid);</span><br><span class="line">build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123; sumf[root] = (f[root] + sumf[lson] + sumf[rson]) % MOD; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushG</span> <span class="params">(<span class="keyword">int</span> root, LL value)</span> </span>&#123;</span><br><span class="line">g[root] = (g[root] * value % MOD + <span class="number">1l</span>l - value + MOD) % MOD;</span><br><span class="line">lazy[root] = lazy[root] * value % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushF</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123; f[root] = (f[root] + g[root]) % MOD * inv2 % MOD; maintain (root); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (lazy[root] == <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">pushG (lson, lazy[root]); pushG (rson, lazy[root]);</span><br><span class="line">lazy[root] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) &#123;</span><br><span class="line">f[root] = (f[root] + <span class="number">1</span>) % MOD * inv2 % MOD; <span class="comment">// äºŒç±»ç‚¹</span></span><br><span class="line">g[root] = (g[root] + <span class="number">1</span>) % MOD * inv2 % MOD;</span><br><span class="line">pushG (lson, inv2); pushG (rson, inv2); <span class="comment">// ä¸‰ç±»ç‚¹</span></span><br><span class="line">maintain (root);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">pushdown (root); <span class="comment">// ä¸‰ç±»ç‚¹pushdown</span></span><br><span class="line">f[root] = f[root] * inv2 % MOD; <span class="comment">// ä¸€ç±»ç‚¹</span></span><br><span class="line">g[root] = g[root] * inv2 % MOD;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) modify (lson, left, mid, L, R);</span><br><span class="line"><span class="keyword">else</span> pushF (lson); <span class="comment">// å››ç±»ç‚¹</span></span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) modify (rson, mid + <span class="number">1</span>, right, L, R);</span><br><span class="line"><span class="keyword">else</span> pushF (rson); <span class="comment">// å››ç±»ç‚¹</span></span><br><span class="line">maintain (root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line">LL down = <span class="number">1</span>;</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= M; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> type = getnum ();</span><br><span class="line"><span class="keyword">if</span> (type == <span class="number">2</span>) &#123; write (sumf[<span class="number">1</span>] * down % MOD); <span class="built_in">puts</span> (<span class="string">""</span>); &#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">down = down * <span class="number">2l</span>l % MOD;</span><br><span class="line"><span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, N, l, r);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 1 3</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 3 5</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ä¸ŠDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒZJOI2016ã€å¤§æ£®æ—</title>
      <link href="/2020/08/04/%5BZJOI2016%5D%E5%A4%A7%E6%A3%AE%E6%9E%97/"/>
      <url>/2020/08/04/%5BZJOI2016%5D%E5%A4%A7%E6%A3%AE%E6%9E%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ï¼ˆè²Œä¼¼æ•´ä¸ªä»£ç ä¸èƒ½ç”¨ $makeroot$ ï¼Ÿæ˜¯å› ä¸ºæ˜¯æœ‰æ ¹æ ‘ï¼Ÿï¼‰</p><p>å› ä¸ºæ˜¯åŒºé—´æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘åœ¨åŒºé—´å†…ä¸åŒºé—´å¤–çš„å·®å¼‚</p><p>å¯¹äºæ“ä½œ $1$ ï¼Œå¯ä»¥çœ‹ä½œä¸€ä¸ªç”ŸæˆèŠ‚ç‚¹åŒ…å«äº†åˆ°ä¸‹ä¸€ä¸ª $1$ æ“ä½œä¹‹é—´é•¿å‡ºçš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªæ“ä½œ $l, r$ ï¼Œç›¸å½“äºæ˜¯åœ¨ $l$ å¤„å°†å½“å‰ç”ŸæˆèŠ‚ç‚¹åŠå…¶åŒ…å«çš„èŠ‚ç‚¹æ•´ä¸ªç§»æ¤åˆ°å®ƒæ›´æ”¹åçš„ä½ç½®ï¼Œåˆ° $r + 1$ æ—¶å†ç§»æ¤å›å»ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘å°†ä¸€ä¸ª $1$ æ“ä½œåˆ†è§£ä¸ºä¸¤ä¸ªæ“ä½œï¼ˆä¸€ä¸ªç§»æ¤ï¼Œä¸€ä¸ªç§»æ¤å›å»ï¼‰ï¼Œæ•…å¯ä»¥å°†æ‰€æœ‰æ“ä½œæŒ‰ç«¯ç‚¹ã€æ—¶é—´æ’åºï¼ˆä»¥åŠåŒä½ç½®ä¿®æ”¹æ“ä½œå¿…å®šåœ¨æŸ¥è¯¢æ“ä½œå‰ï¼Œå› ä¸ºå¯ä»¥å…ˆæŠŠæ ‘å»ºå®Œå†æŸ¥è¯¢å¯¹ç»“æœæ²¡æœ‰å½±å“ï¼‰ï¼Œæ‰«æä¸€éå³å¯</p><p>åŒæ—¶ï¼Œä¸ºäº†æ–¹ä¾¿ç§»æ¤ï¼Œå°†æ¯ä¸ªç”ŸæˆèŠ‚ç‚¹çœ‹ä½œæ–°å»ºçš„ä¸€ä¸ªè™šç‚¹</p><p>å¯¹äºæ“ä½œ $0$ ï¼Œç›´æ¥åœ¨è™šç‚¹ä¸‹ $link$ å³å¯ï¼Œå› ä¸ºå°±ç®—å·²ç»å»ºäº†ä¸€äº›å¯¹äºå½“å‰æ“ä½œä¸å­˜åœ¨çš„è™šç‚¹ï¼Œä¹Ÿä¸ä¼šå¯¹ç­”æ¡ˆé€ æˆå½±å“</p><p>å¯¹äºæ“ä½œ $2$ ï¼Œæ— æ³•æ­£é¢åœ¨ $LCT$ ä¸Šç®—å‡ºä¸¤ç‚¹çš„è·ç¦»ï¼Œæ•…å¯è€ƒè™‘å·®åˆ†ï¼Œå¾—åˆ° $Ans = Sum_x + Sum_y - 2 * Sum_{lca}$ ï¼Œå…¶ä¸­å®ç‚¹è´¡çŒ®ä¸º $1$ ï¼Œè™šç‚¹è´¡çŒ®ä¸º $0$</p><p>å¯¹äºæ±‚ $LCA$ ï¼Œå…ˆ $access (y)$ ï¼Œå†åœ¨ $access (x)$ çš„æ—¶å€™å¾—åˆ°çš„æœ€åä¸€ä¸ªè·³è™šè¾¹çš„ç‚¹å³æ˜¯å®ƒä»¬çš„ $LCA$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QuerySt</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> pos, time;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line"></span><br><span class="line">    QuerySt () &#123;&#125;</span><br><span class="line">    QuerySt (<span class="keyword">int</span> fpos, <span class="keyword">int</span> ftime, <span class="keyword">int</span> fx, <span class="keyword">int</span> fy) :</span><br><span class="line">        pos (fpos), time (ftime), x (fx), y (fy) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> QuerySt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> pos == p.pos ? time &lt; p.time : pos &lt; p.pos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">QuerySt Query[MAXN];</span><br><span class="line"><span class="keyword">int</span> que = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> son[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Sum[MAXN]= &#123;<span class="number">0</span>&#125;, value[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> son[father[p]][<span class="number">0</span>] != p &amp;&amp; son[father[p]][<span class="number">1</span>] != p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sonbel</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> son[father[p]][<span class="number">1</span>] == p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    Sum[p] = Sum[son[p][<span class="number">0</span>]] + Sum[son[p][<span class="number">1</span>]] + value[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fa = father[p], anc = father[fa];</span><br><span class="line">    <span class="keyword">int</span> s = sonbel (p);</span><br><span class="line">    son[fa][s] = son[p][s ^ <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (son[fa][s])</span><br><span class="line">        father[son[fa][s]] = fa;</span><br><span class="line">    <span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">        son[anc][sonbel (fa)] = p;</span><br><span class="line">    father[p] = anc;</span><br><span class="line">    son[p][s ^ <span class="number">1</span>] = fa, father[fa] = p;</span><br><span class="line">    pushup (fa), pushup (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> fa = father[p]; ! isroot (p); rotate (p), fa = father[p])</span><br><span class="line">        <span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">            sonbel (p) == sonbel (fa) ? rotate (fa) : rotate (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Access</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( ; p; tp = p, p = father[p])</span><br><span class="line">        splay (p), son[p][<span class="number">1</span>] = tp, pushup (p);</span><br><span class="line">    <span class="keyword">return</span> tp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="comment">// æ³¨æ„æ­¤æ—¶æ²¡æœ‰makerootæ‰€ä»¥éœ€è¦æ³¨æ„æ˜¯å°†yè¿åˆ°xä¸‹</span></span><br><span class="line">    splay (y);</span><br><span class="line">    father[y] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cut</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    Access (x), splay (x);</span><br><span class="line">    father[son[x][<span class="number">0</span>]] = <span class="number">0</span>, son[x][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    pushup (x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> totq = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> ans[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    sort (Query + <span class="number">1</span>, Query + que + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= que; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> time = Query[i].time;</span><br><span class="line">        <span class="keyword">int</span> x = Query[i].x, y = Query[i].y;</span><br><span class="line">        <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            Access (x), splay (x), ans[time] += Sum[x];</span><br><span class="line">            <span class="keyword">int</span> lca = Access (y);</span><br><span class="line">            splay (y), ans[time] += Sum[y];</span><br><span class="line">            Access (lca), splay (lca), ans[time] -= (Sum[lca] &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cut (x), link (y, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ind[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> liml[MAXN], limr[MAXN];</span><br><span class="line"><span class="keyword">int</span> nodes = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum ();</span><br><span class="line">    <span class="keyword">int</span> lastr = <span class="number">1</span>, real = <span class="number">1</span>;</span><br><span class="line">    ind[<span class="number">1</span>] = Sum[<span class="number">1</span>] = value[<span class="number">1</span>] = <span class="number">1</span>, liml[<span class="number">1</span>] = <span class="number">1</span>, limr[<span class="number">1</span>] = N;</span><br><span class="line">    link (<span class="number">1</span>, nodes = lastr = <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> opt = getnum ();</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">            link (lastr, ind[++ real] = ++ nodes);</span><br><span class="line">            value[nodes] = Sum[nodes] = <span class="number">1</span>;</span><br><span class="line">            liml[real] = l, limr[real] = r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> l = getnum (), r = getnum (), x = getnum ();</span><br><span class="line">            l = max (l, liml[x]), r = min (r, limr[x]);</span><br><span class="line">            <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            link (lastr, ++ nodes);</span><br><span class="line">            Query[++ que] = QuerySt (l, i - M, nodes, ind[x]); <span class="comment">// ç”±nodesç¦»å¼€linkå‘index[x]</span></span><br><span class="line">            Query[++ que] = QuerySt (r + <span class="number">1</span>, i - M, nodes, lastr);</span><br><span class="line">            lastr = nodes;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = getnum (), u = getnum (), v = getnum ();</span><br><span class="line">            Query[++ que] = QuerySt (x, ++ totq, ind[u], ind[v]); <span class="comment">// ç”±index[u]åˆ°index[v]çš„è·ç¦»</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Solve ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= totq; i ++)</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5</span></span><br><span class="line"><span class="comment">0 1 5</span></span><br><span class="line"><span class="comment">1 2 4 2</span></span><br><span class="line"><span class="comment">0 1 4</span></span><br><span class="line"><span class="comment">2 1 1 3</span></span><br><span class="line"><span class="comment">2 2 1 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LCT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒYnoi2013ã€D1T1</title>
      <link href="/2020/08/04/%5BYnoi2013%5DD1T1/"/>
      <url>/2020/08/04/%5BYnoi2013%5DD1T1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>$\text{opt} = 1$ æ—¶ï¼Œä»£è¡¨æŠŠä¸€ä¸ªåŒºé—´  $l, r$ å†…çš„æ‰€æœ‰æ•°éƒ½ $\text{xor}$ ä¸Š $v$ã€‚</p><p>$\text{opt} = 2$ æ—¶ï¼Œ æŸ¥è¯¢ä¸€ä¸ªåŒºé—´ $[l, r]$ å†…é€‰ä»»æ„ä¸ªæ•°ï¼ˆåŒ…æ‹¬ $0$ ä¸ªï¼‰æ•° $\text{xor}$ èµ·æ¥ï¼Œè¿™ä¸ªå€¼ä¸ $v$ çš„æœ€å¤§ $\text{xor}$ å’Œæ˜¯å¤šå°‘ã€‚</p><hr><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å‡ ä¹æ²¡å†™è¿‡å·®åˆ†ï¼Œçœ‹å®Œè¿™é¢˜ä¹‹åé¡¿æ—¶æ„Ÿè§‰åˆ°äº†å·®åˆ†çš„å¼ºå¤§</p><p>é¦–å…ˆæ˜¾ç„¶ç¬¬äºŒä¸ªæ“ä½œéœ€è¦ç»´æŠ¤çº¿æ€§åŸºï¼Œç„¶å $O (\log{n})$ æ±‚è§£</p><p>ç„¶åå› ä¸ºæœ‰ $1$ æ“ä½œï¼Œæ‰€ä»¥è‹¥æ˜¯ç›´æ¥ç»´æŠ¤åŒºé—´çº¿æ€§åŸºï¼Œåœ¨è®¡ç®—ç­”æ¡ˆæ—¶ä¸çŸ¥é“ $1$ æ“ä½œä¸­çš„ $v$ åœ¨å½“å‰ç­”æ¡ˆä¸­è¢«å¼‚æˆ–ä¸Šäº†å¥‡æ•°è¿˜æ˜¯å¶æ•°æ¬¡ï¼Œæ•…æ— æ³•æ±‚è§£</p><p>ä½†æ˜¯åœ¨å•ç‚¹ä¿®æ”¹çš„æƒ…æ™¯ä¸‹å°±ä¸ä¼šæœ‰ä¸Šè¿°é—®é¢˜ï¼Œæ•…ç°åœ¨çš„é—®é¢˜æ˜¯å¦‚ä½•å°†åŒºé—´é—®é¢˜è½¬åŒ–ä¸ºå•ç‚¹é—®é¢˜</p><p>äºæ˜¯å°±éœ€è¦å·®åˆ†ï¼Œè®©æ¯ä¸ª $b_{i + 1} = a_{i + 1} ~ \text{xor} ~ a_i$ï¼Œé‚£ä¹ˆæ­¤æ—¶ $v$ çš„è´¡çŒ®å°±åªä½œç”¨äº $b_l$ ä¸ $b_{r + 1}$ï¼Œå¯ç›´æ¥å•ç‚¹ä¿®æ”¹ï¼Œç„¶ååœ¨çº¿æ®µæ ‘ä¸ŠåŒæ—¶ç»´æŠ¤åŒºé—´çº¿æ€§åŸºï¼ŒæŸ¥è¯¢æ—¶åªéœ€æŸ¥è¯¢ $1â€¦l$ çš„å‰ç¼€å’Œï¼ˆå³ $b_l$ï¼‰ï¼Œå†å°†ä¹‹ä¸ $l + 1â€¦r$ çš„åŒºé—´çº¿æ€§åŸºåˆå¹¶å³å¯æ±‚è§£ç­”æ¡ˆ</p><p>å¤æ‚åº¦ $O (n \log^2{n})$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e04</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">baseSt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> b[<span class="number">32</span>];</span><br><span class="line"><span class="keyword">int</span> subsum;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (b, <span class="number">0</span>, <span class="keyword">sizeof</span> (b));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">append</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">31</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line"><span class="keyword">if</span> (x &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))) &#123;</span><br><span class="line"><span class="keyword">if</span> (! b[j]) &#123;</span><br><span class="line">b[j] = x;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> x ^= b[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">baseSt base[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function">baseSt <span class="title">merge</span> <span class="params">(baseSt A, baseSt B)</span> </span>&#123;</span><br><span class="line">baseSt ret; ret.init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">31</span>; j &gt;= <span class="number">1</span>; j --) &#123;</span><br><span class="line"><span class="keyword">if</span> (A.b[j]) ret.b[j] = A.b[j];</span><br><span class="line"><span class="keyword">else</span> ret.b[j] = B.b[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">31</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line"><span class="keyword">if</span> (A.b[j] &amp;&amp; B.b[j])</span><br><span class="line">ret.append (B.b[j]);</span><br><span class="line">ret.subsum = A.subsum ^ B.subsum;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">base[root].init ();</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">base[root].subsum = a[left];</span><br><span class="line">base[root].append (base[root].subsum);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid);</span><br><span class="line">build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">base[root] = merge (base[lson], base[rson]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">base[root].init ();</span><br><span class="line">base[root].subsum ^= delta, base[root].append (base[root].subsum);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) modify (lson, left, mid, posi, delta);</span><br><span class="line"><span class="keyword">else</span> modify (rson, mid + <span class="number">1</span>, right, posi, delta);</span><br><span class="line">base[root] = merge (base[lson], base[rson]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">baseSt <span class="title">query_base</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R)</span><br><span class="line"><span class="keyword">return</span> base[root];</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">baseSt ret; ret.init ();</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) ret = merge (ret, query_base (lson, left, mid, L, R));</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) ret = merge (ret, query_base (rson, mid + <span class="number">1</span>, right, L, R));</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query_value</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right)</span><br><span class="line"><span class="keyword">return</span> base[root].subsum;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) <span class="keyword">return</span> query_value (lson, left, mid, posi);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> query_value (rson, mid + <span class="number">1</span>, right, posi) ^ base[lson].subsum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> x, baseSt A)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = x;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">31</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line">ret = max (ret, ret ^ A.b[j]);</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">a[i + <span class="number">1</span>] ^= a[i];</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> opt = getnum (), l = getnum (), r = getnum (), x = getnum ();</span><br><span class="line"><span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, N, l, x);</span><br><span class="line"><span class="keyword">if</span> (r &lt; N) modify (<span class="number">1</span>, <span class="number">1</span>, N, r + <span class="number">1</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> delta = query_value (<span class="number">1</span>, <span class="number">1</span>, N, l);</span><br><span class="line"><span class="keyword">if</span> (l == r) <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, max (x ^ delta, x));</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">baseSt bas = query_base (<span class="number">1</span>, <span class="number">1</span>, N, l + <span class="number">1</span>, r);</span><br><span class="line">bas.append (delta);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, solve (x, bas));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">1 14 51 4</span></span><br><span class="line"><span class="comment">2 1 3 0</span></span><br><span class="line"><span class="comment">1 2 3 3</span></span><br><span class="line"><span class="comment">2 1 4 10</span></span><br><span class="line"><span class="comment">1 1 4 514</span></span><br><span class="line"><span class="comment">2 3 4 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> çº¿æ€§åŸº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒYnoi2012ã€D2T1</title>
      <link href="/2020/08/04/%5BYnoi2012%5DD2T1/"/>
      <url>/2020/08/04/%5BYnoi2012%5DD2T1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>é¦–å…ˆæœ‰ä¸€ä¸ªæ€§è´¨</p><blockquote><p>å¯¹äº $n \ge 11$ï¼Œæ“ä½œ $1$ å¿…å®šæœ‰è§£</p></blockquote><p>ä¸€ä¸ªæ¥è‡ª $\text{Okami}$ çš„ä¸¥è°¨è¯æ˜ï¼š</p><p>è€ƒè™‘äº’ä¸ç›¸åŒçš„æ•° $x, y, z, â€¦$ï¼Œåˆ™æœ‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x</span><br><span class="line">x y x+y</span><br><span class="line">x y z x+y x+z y+z x+y+z</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯å¯¹äº $n$ ä¸ªäº’ä¸ç›¸åŒçš„æ•°å®ƒä»¬æ˜¾ç„¶å¯ä»¥æ‹¼å‡º $2^n - 1$ï¼Œé‚£ä¹ˆæ ¹æ®æŠ½å±‰åŸç†ï¼Œåˆ™æœ‰ $2^n - 1 \ge 1000$ æ—¶å¿…å®šæœ‰è§£ï¼Œåˆ™å‘½é¢˜æˆç«‹</p><p>é‚£ä¹ˆå‰©ä¸‹çš„å°±ç›´æ¥ $\text{bitset}$ ä¼˜åŒ–èƒŒåŒ…å°±å¥½äº†ï¼ˆæ³¨æ„å¯ä»¥ç›´æ¥èƒŒåŒ…å› ä¸ºè‹¥é›†åˆ $X$ å’Œ $Y$ åŒæ—¶é€‰äº†ä¸€ä¸ªæ•°ï¼Œé‚£ä¹ˆå®ƒä»¬åŒæ—¶å»é™¤è¯¥æ•°ä¹Ÿæ˜¯ç›¸ç­‰çš„ï¼‰ï¼Œè‡³äºæ“ä½œ $2$ çš„å½±å“åˆ™ç›´æ¥æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡æ¯ä¸ªæ•°è¦ç«‹æ–¹å‡ æ¬¡ï¼Œç”±äº $\bmod V$ï¼Œé‚£ä¹ˆç›´æ¥å€å¢å¤„ç†å³å¯</p><p>å•è¯è¯¢é—®å¤æ‚åº¦ $O (\frac{(r - l + 1)^2V}{32})$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXV = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, V;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> powv[MAXV][<span class="number">25</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V; i ++) powv[i][<span class="number">0</span>] = i * i * i % V;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">18</span>; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V; i ++)</span><br><span class="line">powv[i][j] = powv[powv[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">19</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line"><span class="keyword">if</span> (p &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)))</span><br><span class="line">x = powv[x][j - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x &amp; (- x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (x &lt;= N) &#123;</span><br><span class="line">subsum[x] += delta;</span><br><span class="line">x += lowbit (x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (x &gt; <span class="number">0</span>) &#123;</span><br><span class="line">cnt += subsum[x];</span><br><span class="line">x -= lowbit (x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bitset</span>&lt;12 * MAXV&gt; f;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), V = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum ();</span><br><span class="line">init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= M; q ++) &#123;</span><br><span class="line"><span class="keyword">int</span> opt = getnum (), l = getnum (), r = getnum ();</span><br><span class="line"><span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (r - l + <span class="number">1</span> &gt;= <span class="number">12</span>) <span class="built_in">puts</span> (<span class="string">"Yuno"</span>);</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">f.reset(); <span class="keyword">bool</span> suc = <span class="literal">false</span>; f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = calc (a[i], query (i));</span><br><span class="line"><span class="keyword">if</span> ((f &amp; (f &lt;&lt; x)).any()) &#123;</span><br><span class="line">suc = <span class="literal">true</span>; <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">f = f | (f &lt;&lt; x);</span><br><span class="line">&#125;</span><br><span class="line">suc ? <span class="built_in">puts</span> (<span class="string">"Yuno"</span>) : <span class="built_in">puts</span> (<span class="string">"Yuki"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> add (l, <span class="number">1</span>), add (r + <span class="number">1</span>, - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">20 20 152</span></span><br><span class="line"><span class="comment">3 26 133 54 79 81 72 109 66 91 82 100 35 23 104 17 51 114 12 58</span></span><br><span class="line"><span class="comment">2 1 17</span></span><br><span class="line"><span class="comment">2 6 12</span></span><br><span class="line"><span class="comment">1 1 12</span></span><br><span class="line"><span class="comment">2 3 5</span></span><br><span class="line"><span class="comment">2 11 11</span></span><br><span class="line"><span class="comment">2 7 19</span></span><br><span class="line"><span class="comment">2 6 15</span></span><br><span class="line"><span class="comment">1 5 12</span></span><br><span class="line"><span class="comment">1 1 9</span></span><br><span class="line"><span class="comment">1 10 19</span></span><br><span class="line"><span class="comment">2 3 19</span></span><br><span class="line"><span class="comment">2 6 20</span></span><br><span class="line"><span class="comment">2 1 13</span></span><br><span class="line"><span class="comment">2 1 15</span></span><br><span class="line"><span class="comment">2 1 9</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">2 1 7</span></span><br><span class="line"><span class="comment">2 7 19</span></span><br><span class="line"><span class="comment">2 6 19</span></span><br><span class="line"><span class="comment">2 3 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èƒŒåŒ…DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒWC2018ã€é€šé“</title>
      <link href="/2020/08/04/%5BWC2018%5D%E9%80%9A%E9%81%93/"/>
      <url>/2020/08/04/%5BWC2018%5D%E9%80%9A%E9%81%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>è¿™é¢˜çœŸçš„æ˜¯å†™åˆ°å¿ƒæ€çˆ†ç‚¸ã€‚ã€‚</p><p>ä¸€é“è¾¹åˆ†æ²» + è™šæ ‘</p><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><h3 id="è¾¹åˆ†æ²»"><a href="#è¾¹åˆ†æ²»" class="headerlink" title="è¾¹åˆ†æ²»"></a>è¾¹åˆ†æ²»</h3><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯é€‰æ‹©ä¸€æ¡è¾¹ï¼Œç±»ä¼¼ç‚¹åˆ†æ²»å¯¹æ‰€æœ‰ç»è¿‡è¯¥è¾¹çš„è·¯å¾„è¿›è¡Œå¤„ç†ï¼Œä½†ä¸ç‚¹åˆ†æ²»ä¸åŒçš„æ˜¯ï¼Œè¾¹åˆ†æ²»å¯èƒ½ä¼šè¢«èŠèŠ±å›¾å¡åˆ° $O (n^2)$ï¼Œæ•…æ­¤æ—¶éœ€è¦é‡æ„æ ‘ï¼Œå°†ä¹‹å˜ä¸ºåº¦æ•°ä¸è¶…è¿‡ä¸‰çš„äºŒå‰æ ‘</p><h4 id="æ ‘é‡æ„"><a href="#æ ‘é‡æ„" class="headerlink" title="æ ‘é‡æ„"></a>æ ‘é‡æ„</h4><p>é€šè¿‡å»ºç«‹æ–°çš„è™šç‚¹è¿›è¡Œé‡æ„ï¼Œä½†è¦æ»¡è¶³åŠ å…¥çš„è™šç‚¹ä¸å½±å“æœ€åç­”æ¡ˆè®¡ç®—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rebuild</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> nf = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">LL w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (! nf) &#123;</span><br><span class="line">Insert (root, v, w), Insert (v, root, w);</span><br><span class="line">nf = root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> k = ++ m; <span class="comment">// è™šç‚¹</span></span><br><span class="line">Insert (nf, k, <span class="number">0</span>), Insert (k, nf, <span class="number">0</span>);</span><br><span class="line">Insert (k, v, w), Insert (v, k, w);</span><br><span class="line">nf = k;</span><br><span class="line">&#125;</span><br><span class="line">rebuild (v, root);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ±‚ä¸­å¿ƒè¾¹"><a href="#æ±‚ä¸­å¿ƒè¾¹" class="headerlink" title="æ±‚ä¸­å¿ƒè¾¹"></a>æ±‚ä¸­å¿ƒè¾¹</h4><p>äºç‚¹åˆ†æ²»çš„æ±‚é‡å¿ƒç•¥æœ‰ä¸åŒï¼Œä½†æœ¬è´¨æ˜¯ä¸€æ ·çš„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> cet, mini; <span class="comment">// é‡å¿ƒè¾¹</span></span><br><span class="line"><span class="keyword">bool</span> visit[MAXM &lt;&lt; <span class="number">3</span>]= &#123;<span class="literal">false</span>&#125;; <span class="comment">// è¾¹æ˜¯å¦å·²ç»è¢«ç»è¿‡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findc</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; ~ i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (visit[i &gt;&gt; <span class="number">1</span>] || v == father) <span class="keyword">continue</span>;</span><br><span class="line">findc (n, v, root);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line"><span class="keyword">int</span> maxpart = max (subsize[v], n - subsize[v]); <span class="comment">// æ³¨æ„æ­¤å¤„</span></span><br><span class="line"><span class="keyword">if</span> (maxpart &lt; mini) &#123; mini = maxpart; cet = i; &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç°åœ¨å¼€å§‹è¾¹åˆ†æ²»ï¼Œåˆ†æ²»åˆ°æŸä¸€è¾¹ $E$ï¼Œå°†ç›¸åº”ç‚¹åˆ†ä¸ºä¸¤ä¸ªè¿é€šå— $A, B$</p><p>è€ƒè™‘åŸå¼ï¼Œå…¶ä¸­ $d_T(x)$ è¡¨ç¤ºåœ¨æ ‘ $T$ ä¸­ $x$ è·æ ¹èŠ‚ç‚¹ï¼ˆæˆ–åˆ†æ²»ä¸­å¿ƒï¼‰çš„é•¿åº¦ï¼Œå¯¹ä¸¤ç‚¹ $i \in A, j \in B$<br>$$<br>ans = \max \{d_{T_1}(i) + d_{T_1}(j) + dist_{T_2}(i, j) + dist_{T_3}(i, j)\}<br>$$<br>æ­¤æ—¶å¯¹ $A \cup B$ å»ºç«‹è™šæ ‘ï¼Œåœ¨è™šæ ‘ä¸Šè·‘ $\text{DFS}$ï¼Œè®¾æ­¤æ—¶è®¿é—®åˆ°è™šæ ‘ä¸Šç‚¹ $p$ï¼Œåˆ™å¼å­å¯å˜ä¸º<br>$$<br>\begin{aligned}<br>ans &amp;= \max \{d_{T_1}(i) + d_{T_1}(j) + d_{T_2}(i) + d_{T_2}(j) - 2 \times d_{T_2}(p) + dist_{T_3}(i, j)\} \\<br>&amp;= \max \{(d_{T_1} + d_{T_2})(i) + (d_{T_1} + d_{T_2})(j)- 2 \times d_{T_2}(p) + dist_{T_3}(i, j)\}<br>\end{aligned}<br>$$<br>è¿™å°±ç›¸å½“äºç»™ $T_3$ çš„ç‚¹ $i, j$ åˆ†åˆ«èµ‹ä¸Šæƒå€¼ $value_i = d_{T_1}(i) + d_{T_2}(i), value_j = d_{T_1}(j) + d_{T_2}(j)$ï¼Œç„¶åæ±‚ $T_3$ ä¸Šç‚¹ $i \in A, j \in B$ çš„ $i, j$ é—´è¾¹æƒå’Œåœ¨åŠ ä¸Š $i, j$ ç‚¹æƒçš„æœ€å¤§å€¼å³å¯æ±‚å¾—ç­”æ¡ˆï¼Œå°±æ˜¯ç»™ $T_3$ ä¸Šçš„ç‚¹é»‘ç™½æŸ“è‰²ï¼Œæ±‚ç™½ç‚¹åˆ°é»‘ç‚¹çš„ç«¯ç‚¹ç‚¹æƒå³è¾¹æƒå’Œçš„æœ€å¤§å€¼</p><p>é‚£ä¹ˆæ­¤æ—¶å‘ç°è¾¹æƒ $w_i$ éƒ½æ˜¯æ­£æ•´æ•°ï¼Œè¯´æ˜å®ƒä»¬æ»¡è¶³ç›´å¾„åˆå¹¶çš„å®šç†ï¼Œå³æ–°ç›´å¾„å¿…å®šç”±åŸæ¥ä¸¤æ¡ç›´å¾„çš„ç«¯ç‚¹äº§ç”Ÿï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥æ±‚äº†ï¼Œåœ¨ $T_2$ ä¸Š $\text{dp}$ æ—¶é¡ºä¾¿åˆå¹¶ $T_3$ çš„ç­”æ¡ˆ</p><p>è¿™ä¹ˆç›´æ¥åšæ—¶ $O (n \log^2 n)$ çš„ï¼Œå¸¸æ•°ä¸€å¤§é‚£å°±ç©çƒ</p><p>å…¶å®ä¼˜åŒ–åˆ° $O (n \log n)$ ä¹Ÿæ˜¯å¾ˆæ˜¾ç„¶çš„ï¼Œå†™ä¸ª $\text{RMQ}$ çš„ $\text{LCA}$ï¼Œå¹¶ä¸”åœ¨å»ºè™šæ ‘æ—¶ä¸ç”¨ $\text{sort}$ è€Œæ˜¯åŸºæ•°æ’åºå°±å¥½äº†</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>357è¡Œï¼ˆåŒ…å«å°‘é‡æ³¨é‡Šï¼‰ã€‚ã€‚éƒ½ä¸çŸ¥å¤šä¹…æ²¡æœ‰æ‰“ä»£ç æ‰“çš„è¿™ä¹ˆå¸¦æ„Ÿè¿‡äº†ã€‚ã€‚</p><p>$\text{debug}$ çœŸçš„å°±å¤Ÿå—äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">LL num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="comment">//T3</span></span><br><span class="line">LL val[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree3</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span> <span class="keyword">int</span> to, next; LL w; &#125; ;</span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN], size;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v; Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u]; Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dfn[MAXN], ord, cnt;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN], value[MAXN &lt;&lt; <span class="number">1</span>], bel[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line">LL d[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">dfn[root] = ++ ord;</span><br><span class="line">value[ord] = depth[root], bel[ord] = root;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">LL w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[root] + <span class="number">1</span>;</span><br><span class="line">d[v] = d[root] + w;</span><br><span class="line">DFS (v, root);</span><br><span class="line">value[++ ord] = depth[root];</span><br><span class="line">bel[ord] = root;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ord; i ++) ST[i][<span class="number">0</span>] = make_pair (value[i], bel[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">20</span>; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= ord; i ++)</span><br><span class="line"><span class="keyword">if</span> (ST[i][j - <span class="number">1</span>].first &lt; ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>].first) ST[i][j] = ST[i][j - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> ST[i][j] = ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">LCA</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = log2 (r - l + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (ST[l][k].first &lt; ST[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].first) <span class="keyword">return</span> ST[l][k].second;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> ST[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].second;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">dist</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (dfn[x] &gt; dfn[y]) swap (x, y);</span><br><span class="line"><span class="keyword">int</span> lca = LCA (dfn[x], dfn[y]);</span><br><span class="line"><span class="keyword">return</span> val[x] + val[y] + d[x] + d[y] - <span class="number">2l</span>l * d[lca];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">LL w = getnum ();</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">&#125;</span><br><span class="line">ord = <span class="number">0</span>;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>); RMQ ();</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Tree3 T3;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">diam</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> x, y; LL d;</span><br><span class="line">diam (<span class="keyword">int</span> fx = <span class="number">0</span>, <span class="keyword">int</span> fy = <span class="number">0</span>, LL fd = <span class="number">0</span>) : x (fx), y (fy), d (fd) &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">diam f[MAXN][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">query</span> <span class="params">(diam A, diam B)</span> </span>&#123;</span><br><span class="line">LL d1 = max (T3.dist (A.x, B.x), T3.dist (A.x, B.y));</span><br><span class="line">LL d2 = max (T3.dist (A.y, B.x), T3.dist (A.y, B.y));</span><br><span class="line"><span class="keyword">return</span> max (d1, d2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">diam <span class="title">merge</span> <span class="params">(diam A, diam B)</span> </span>&#123;</span><br><span class="line">LL maxi; diam ret;</span><br><span class="line">ret = A.d &gt; B.d ? diam (A.x, A.y, maxi = A.d) : diam (B.x, B.y, maxi = B.d);</span><br><span class="line"><span class="keyword">if</span> (T3.dist (A.x, B.x) &gt; maxi) &#123; ret = diam (A.x, B.x, maxi = T3.dist (A.x, B.x)); &#125;</span><br><span class="line"><span class="keyword">if</span> (T3.dist (A.x, B.y) &gt; maxi) &#123; ret = diam (A.x, B.y, maxi = T3.dist (A.x, B.y)); &#125;</span><br><span class="line"><span class="keyword">if</span> (T3.dist (A.y, B.x) &gt; maxi) &#123; ret = diam (A.y, B.x, maxi = T3.dist (A.y, B.x)); &#125;</span><br><span class="line"><span class="keyword">if</span> (T3.dist (A.y, B.y) &gt; maxi) &#123; ret = diam (A.y, B.y, maxi = T3.dist (A.y, B.y)); &#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dfn[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; a, <span class="keyword">const</span> <span class="keyword">int</span>&amp; b)</span> </span>&#123; <span class="keyword">return</span> dfn[a] &lt; dfn[b]; &#125;</span><br><span class="line"><span class="comment">//T2</span></span><br><span class="line"><span class="keyword">int</span> dye[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> iskey[MAXN]= &#123;<span class="number">0</span>&#125;, isdye[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree2</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span> <span class="keyword">int</span> to, next; LL w; &#125; ;</span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN], size;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v; Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u]; Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ord;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN], value[MAXN &lt;&lt; <span class="number">1</span>], bel[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line">LL d[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">dfn[root] = ++ ord;</span><br><span class="line">value[ord] = depth[root], bel[ord] = root;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">LL w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[root] + <span class="number">1</span>;</span><br><span class="line">d[v] = d[root] + w;</span><br><span class="line">DFS (v, root);</span><br><span class="line">value[++ ord] = depth[root];</span><br><span class="line">bel[ord] = root;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ST[MAXN &lt;&lt; <span class="number">1</span>][<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ord; i ++) ST[i][<span class="number">0</span>] = make_pair (value[i], bel[i]);</span><br><span class="line"><span class="keyword">int</span> MAX = log2 (ord) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= MAX; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= ord; i ++)</span><br><span class="line"><span class="keyword">if</span> (ST[i][j - <span class="number">1</span>].first &lt; ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>].first) ST[i][j] = ST[i][j - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> ST[i][j] = ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">LCA</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (dfn[x] &gt; dfn[y]) swap (x, y);</span><br><span class="line"><span class="keyword">int</span> l = dfn[x], r = dfn[y];</span><br><span class="line"><span class="keyword">int</span> k = log2 (r - l + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (ST[l][k].first &lt; ST[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].first) <span class="keyword">return</span> ST[l][k].second;</span><br><span class="line"><span class="keyword">return</span> ST[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k].second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">stack</span>[MAXN], top;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! top) &#123; <span class="built_in">stack</span>[++ top] = x; <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="keyword">int</span> lca = LCA (<span class="built_in">stack</span>[top], x);</span><br><span class="line"><span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; depth[lca] &lt; depth[<span class="built_in">stack</span>[top - <span class="number">1</span>]]) &#123;</span><br><span class="line">Insert (<span class="built_in">stack</span>[top - <span class="number">1</span>], <span class="built_in">stack</span>[top], <span class="number">0</span>); top --;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (depth[lca] &lt; depth[<span class="built_in">stack</span>[top]]) &#123; Insert (lca, <span class="built_in">stack</span>[top], <span class="number">0</span>); top --; &#125;</span><br><span class="line"><span class="keyword">if</span> (! top || <span class="built_in">stack</span>[top] != lca) <span class="built_in">stack</span>[++ top] = lca;</span><br><span class="line"><span class="built_in">stack</span>[++ top] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cstr</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; <span class="comment">// è™šæ ‘æ„å»º</span></span><br><span class="line">size = <span class="number">0</span>;</span><br><span class="line">top = <span class="number">0</span>; <span class="keyword">if</span> (a[l] != <span class="number">1</span>) <span class="built_in">stack</span>[++ top] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) &#123; add (a[i]); val[a[i]] += d[a[i]]; iskey[a[i]] = <span class="literal">true</span>; &#125;</span><br><span class="line"><span class="keyword">while</span> (top &gt; <span class="number">1</span>) &#123; Insert (<span class="built_in">stack</span>[top - <span class="number">1</span>], <span class="built_in">stack</span>[top], <span class="number">0</span>); top --; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123; <span class="comment">// dp</span></span><br><span class="line">vis[u] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (iskey[u]) &#123;</span><br><span class="line">isdye[u][dye[u]] = <span class="literal">true</span>;</span><br><span class="line">f[u][dye[u]] = diam (u, u, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">dp (v);</span><br><span class="line"><span class="keyword">if</span> (isdye[u][<span class="number">0</span>] &amp;&amp; isdye[v][<span class="number">1</span>]) ans = max (ans, query (f[u][<span class="number">0</span>], f[v][<span class="number">1</span>]) - <span class="number">2l</span>l * d[u]);</span><br><span class="line"><span class="keyword">if</span> (isdye[u][<span class="number">1</span>] &amp;&amp; isdye[v][<span class="number">0</span>]) ans = max (ans, query (f[u][<span class="number">1</span>], f[v][<span class="number">0</span>]) - <span class="number">2l</span>l * d[u]);</span><br><span class="line"><span class="keyword">if</span> (isdye[v][<span class="number">0</span>]) &#123;</span><br><span class="line"><span class="keyword">if</span> (! isdye[u][<span class="number">0</span>]) f[u][<span class="number">0</span>] = f[v][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">else</span> f[u][<span class="number">0</span>] = merge (f[u][<span class="number">0</span>], f[v][<span class="number">0</span>]);</span><br><span class="line">isdye[u][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (isdye[v][<span class="number">1</span>]) &#123;</span><br><span class="line"><span class="keyword">if</span> (! isdye[u][<span class="number">1</span>]) f[u][<span class="number">1</span>] = f[v][<span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> f[u][<span class="number">1</span>] = merge (f[u][<span class="number">1</span>], f[v][<span class="number">1</span>]);</span><br><span class="line">isdye[u][<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to; del (v);</span><br><span class="line">&#125;</span><br><span class="line">Head[u] = val[u] = dye[u] = <span class="number">0</span>; iskey[u] = isdye[u][<span class="number">0</span>] = isdye[u][<span class="number">1</span>] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">LL w = getnum ();</span><br><span class="line">Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">&#125;</span><br><span class="line">ord = <span class="number">0</span>;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>); RMQ ();</span><br><span class="line">size = <span class="number">0</span>; <span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) a[i] = i;</span><br><span class="line">sort (a + <span class="number">1</span>, a + N + <span class="number">1</span>, comp);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Tree2 T2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// T1</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree1_ori</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span> <span class="keyword">int</span> to, next; LL w; &#125; ;</span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN], size;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v; Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u]; Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Tree1_ori T1;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line">LL w;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> size = - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rebuild</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> nf = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = T1.Head[root]; i; i = T1.Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = T1.Link[i].to;</span><br><span class="line">LL w = T1.Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (! nf) &#123;</span><br><span class="line">Insert (root, v, w), Insert (v, root, w);</span><br><span class="line">nf = root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> k = ++ m;</span><br><span class="line">Insert (nf, k, <span class="number">0</span>), Insert (k, nf, <span class="number">0</span>);</span><br><span class="line">Insert (k, v, w), Insert (v, k, w);</span><br><span class="line">nf = k;</span><br><span class="line">&#125;</span><br><span class="line">rebuild (v, root);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> subsize[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> cet, mini; <span class="comment">// é‡å¿ƒè¾¹</span></span><br><span class="line"><span class="keyword">bool</span> visit[MAXM &lt;&lt; <span class="number">3</span>]= &#123;<span class="literal">false</span>&#125;; <span class="comment">// è¾¹æ˜¯å¦å·²ç»è¢«ç»è¿‡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findc</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; ~ i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (visit[i &gt;&gt; <span class="number">1</span>] || v == father) <span class="keyword">continue</span>;</span><br><span class="line">findc (n, v, root);</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line"><span class="keyword">int</span> maxpart = max (subsize[v], n - subsize[v]);</span><br><span class="line"><span class="keyword">if</span> (maxpart &lt; mini) &#123; mini = maxpart; cet = i; &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">coll</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> root, <span class="keyword">int</span> father, LL d)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (root &lt;= N) &#123; dye[root] = p; val[root] = d; &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; ~ i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">LL w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (visit[i &gt;&gt; <span class="number">1</span>] || v == father) <span class="keyword">continue</span>;</span><br><span class="line">coll (p, v, root, d + w);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tp[<span class="number">2</span>][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> n, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">cet = - <span class="number">1</span>, mini = INF; findc (n, u, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (cet == - <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">visit[cet &gt;&gt; <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> x = Link[cet].to, y = Link[cet ^ <span class="number">1</span>].to;</span><br><span class="line">coll (<span class="number">0</span>, x, y, Link[cet].w); coll (<span class="number">1</span>, y, x, <span class="number">0</span>);</span><br><span class="line">T2.cstr (l, r); T2.dp (<span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> cnt[<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) tp[dye[a[i]]][++ cnt[dye[a[i]]]] = a[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= l + cnt[<span class="number">0</span>] - <span class="number">1</span>; i ++) a[i] = tp[<span class="number">0</span>][i - l + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l + cnt[<span class="number">0</span>]; i &lt;= r; i ++) a[i] = tp[<span class="number">1</span>][i - l - cnt[<span class="number">0</span>] + <span class="number">1</span>];</span><br><span class="line">T2.del (<span class="number">1</span>); <span class="keyword">int</span> szr = n - subsize[x];</span><br><span class="line">divide (x, subsize[x], l, l + cnt[<span class="number">0</span>] - <span class="number">1</span>);</span><br><span class="line">divide (y, szr, l + cnt[<span class="number">0</span>], r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">LL w = getnum ();</span><br><span class="line">T1.Insert (u, v, w), T1. Insert (v, u, w);</span><br><span class="line">&#125;</span><br><span class="line">T2.build (); T3.build ();</span><br><span class="line"><span class="built_in">memset</span> (Head, - <span class="number">1</span>, <span class="keyword">sizeof</span> (Head));</span><br><span class="line">m = N; rebuild (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">divide (<span class="number">1</span>, m, <span class="number">1</span>, N);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">1 3 0</span></span><br><span class="line"><span class="comment">1 4 1</span></span><br><span class="line"><span class="comment">4 5 7</span></span><br><span class="line"><span class="comment">1 2 0</span></span><br><span class="line"><span class="comment">2 3 1</span></span><br><span class="line"><span class="comment">2 4 1</span></span><br><span class="line"><span class="comment">2 5 3</span></span><br><span class="line"><span class="comment">1 5 2</span></span><br><span class="line"><span class="comment">2 3 8</span></span><br><span class="line"><span class="comment">3 4 5</span></span><br><span class="line"><span class="comment">4 5 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ä¸ŠDP </tag>
            
            <tag> è¾¹åˆ†æ²» </tag>
            
            <tag> è™šæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒWC2008ã€æ¸¸è§ˆè®¡åˆ’ ã€Œæ–¯å¦é‚£æ ‘æ¨¡æ¿ã€</title>
      <link href="/2020/08/04/%5BWC2008%5D%E6%B8%B8%E8%A7%88%E8%AE%A1%E5%88%92%20%E3%80%8C%E6%96%AF%E5%9D%A6%E9%82%A3%E6%A0%91%E6%A8%A1%E6%9D%BF%E3%80%8D/"/>
      <url>/2020/08/04/%5BWC2008%5D%E6%B8%B8%E8%A7%88%E8%AE%A1%E5%88%92%20%E3%80%8C%E6%96%AF%E5%9D%A6%E9%82%A3%E6%A0%91%E6%A8%A1%E6%9D%BF%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="æ–¯å¦é‚£æ ‘"><a href="#æ–¯å¦é‚£æ ‘" class="headerlink" title="æ–¯å¦é‚£æ ‘"></a>æ–¯å¦é‚£æ ‘</h3><p>ç™¾åº¦é‡Šä¹‰</p><blockquote><p>æ–¯å¦çº³æ ‘é—®é¢˜æ˜¯ç»„åˆä¼˜åŒ–é—®é¢˜ï¼Œä¸æœ€å°ç”Ÿæˆæ ‘ç›¸ä¼¼ï¼Œæ˜¯æœ€çŸ­ç½‘ç»œçš„ä¸€ç§ã€‚æœ€å°ç”Ÿæˆæ ‘æ˜¯åœ¨ç»™å®šçš„ç‚¹é›†å’Œè¾¹ä¸­å¯»æ±‚æœ€çŸ­ç½‘ç»œä½¿æ‰€æœ‰ç‚¹è¿é€šã€‚è€Œæœ€å°æ–¯å¦çº³æ ‘å…è®¸åœ¨ç»™å®šç‚¹å¤–å¢åŠ é¢å¤–çš„ç‚¹ï¼Œä½¿ç”Ÿæˆçš„æœ€çŸ­ç½‘ç»œå¼€é”€æœ€å°ã€‚</p></blockquote><p>å³æœ€å°æ–¯å¦é‚£æ ‘å³ä¸ºå¹¶éé€‰æ‹©æ‰€æœ‰çš„ç»“ç‚¹ï¼Œè€Œæ˜¯é€‰æ‹©ä¸€éƒ¨åˆ†ç»“ç‚¹ï¼Œä¸ºä¿è¯å®ƒä»¬è¿é€šï¼Œä¸”æ±‚è§£æœ€å°å¼€é”€</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>æ–¯å¦é‚£æ ‘æ¨¡æ¿</p><p>å‘ç°ç›´æ¥è¡¨ç¤ºç‚¹çš„å­˜åœ¨æ€§æ²¡æœ‰æ„ä¹‰</p><p>è®¾å‡½æ•° $f[i][state]$ è¡¨ç¤ºï¼šå¯¹äºç‚¹ $i$ï¼Œå…¶å®ƒç»“ç‚¹ä¸å…¶è¿é€šæƒ…å†µ</p><p>é‚£ä¹ˆæœ‰ä¸¤ç§è½¬ç§»</p><p>å…¶ä¸€ã€ç”±å…¶å­é›†è½¬ç§»<br>$$<br>f[i][state] = \min\limits_{sub \in state} \{f[i][sub] + f[i][\complement_{state}sub] - value_i\}<br>$$<br>ä¹‹æ‰€ä»¥è¦å‡å» $value_i$ æ˜¯å› ä¸ºä¼šç®—é‡</p><p>é™„ï¼šæšä¸¾å­é›†çš„æ–¹æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> sub = state &amp; (state - <span class="number">1</span>); sub; sub = (sub - <span class="number">1</span>) &amp; state)</span><br></pre></td></tr></table></figure><p>å…¶äºŒã€ç”±ç›¸é‚»å½“å‰çŠ¶æ€ä¸‹ç»“ç‚¹è½¬ç§»<br>$$<br>f[i][state] = \min\limits_{state_p = true} \{f[p][state] + value_i\}<br>$$<br>å‘ç°å¾ˆåƒä¸‰è§’å½¢ä¸ç­‰å¼ï¼Œæ•…è€ƒè™‘ $SPFA$ è½¬ç§»</p><p>æ€»å¤æ‚åº¦ $O (n3^n + kE2^n)$ï¼Œ$3^n$ ä¸ºæšä¸¾å­é›†æ€»å¤æ‚åº¦</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">10</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1</span> &lt;&lt; <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NextX[<span class="number">4</span>]= &#123;- <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, NextY[<span class="number">4</span>]= &#123;<span class="number">0</span>, - <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> Map[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">preSt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"><span class="keyword">int</span> state;</span><br><span class="line"></span><br><span class="line">preSt (<span class="keyword">int</span> fx = <span class="number">0</span>, <span class="keyword">int</span> fy = <span class="number">0</span>, <span class="keyword">int</span> fs = <span class="number">0</span>) :</span><br><span class="line">x (fx), y (fy), state (fs) &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN][MAXM];</span><br><span class="line">preSt pre[MAXN][MAXN][MAXM];</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; que;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span> <span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; top = que.front();</span><br><span class="line">que.pop();</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> x = top.first, y = top.second;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> tx = x + NextX[i];</span><br><span class="line"><span class="keyword">int</span> ty = y + NextY[i];</span><br><span class="line"><span class="keyword">if</span> (tx &lt; <span class="number">1</span> || tx &gt; N || ty &lt; <span class="number">1</span> || ty &gt; M)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (f[x][y][state] + Map[tx][ty] &lt; f[tx][ty][state]) &#123;</span><br><span class="line">f[tx][ty][state] = f[x][y][state] + Map[tx][ty];</span><br><span class="line">pre[tx][ty][state] = preSt (x, y, state);</span><br><span class="line">que.push(make_pair (tx, ty));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tag[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">traceback</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! x || ! y)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">tag[x][y] = <span class="number">1</span>;</span><br><span class="line">preSt pr = pre[x][y][state];</span><br><span class="line">traceback (pr.x, pr.y, pr.state);</span><br><span class="line"><span class="keyword">if</span> (pr.x == x &amp;&amp; pr.y == y)</span><br><span class="line">traceback (pr.x, pr.y, state - pr.state);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">memset</span> (f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">int</span> px, py;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line">Map[i][j] = getnum ();</span><br><span class="line"><span class="keyword">if</span> (! Map[i][j]) &#123;</span><br><span class="line">cnt ++, f[i][j][<span class="number">1</span> &lt;&lt; (cnt - <span class="number">1</span>)] = <span class="number">0</span>;</span><br><span class="line">px = i, py = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> limit = (<span class="number">1</span> &lt;&lt; cnt) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">1</span>; state &lt;= limit; state ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> sub = state &amp; (state - <span class="number">1</span>); sub; sub = (sub - <span class="number">1</span>) &amp; state) <span class="comment">// from subset</span></span><br><span class="line"><span class="keyword">if</span> (f[i][j][sub] + f[i][j][state - sub] - Map[i][j] &lt; f[i][j][state]) &#123;</span><br><span class="line">f[i][j][state] = f[i][j][sub] + f[i][j][state - sub] - Map[i][j];</span><br><span class="line">pre[i][j][state] = preSt (i, j, sub);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (f[i][j][state] &lt; INF)</span><br><span class="line">que.push(make_pair (i, j));</span><br><span class="line">&#125;</span><br><span class="line">SPFA (state); <span class="comment">// from other nodes</span></span><br><span class="line">&#125;</span><br><span class="line">traceback (px, py, limit);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, f[px][py][limit]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! Map[i][j])</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">'x'</span>);</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">tag[i][j] ? <span class="built_in">putchar</span> (<span class="string">'o'</span>) : <span class="built_in">putchar</span> (<span class="string">'_'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 4</span></span><br><span class="line"><span class="comment">0 1 1 0</span></span><br><span class="line"><span class="comment">2 5 5 1</span></span><br><span class="line"><span class="comment">1 5 5 1</span></span><br><span class="line"><span class="comment">0 1 1 0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–¯å¦çº³æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒSDOI2009ã€HHå»æ•£æ­¥ ã€ŒçŸ©é˜µä¹˜æ³•è®¡æ•°ã€</title>
      <link href="/2020/08/04/%5BSDOI2009%5DHH%E5%8E%BB%E6%95%A3%E6%AD%A5%20%E3%80%8C%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95%E8%AE%A1%E6%95%B0%E3%80%8D/"/>
      <url>/2020/08/04/%5BSDOI2009%5DHH%E5%8E%BB%E6%95%A3%E6%AD%A5%20%E3%80%8C%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95%E8%AE%A1%E6%95%B0%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>è®¡æ•°é—®é¢˜ä¹Ÿè®¸å¯ä»¥è½¬åŒ–ä¸ºçŸ©é˜µä¹˜æ³•å½¢å¼</p><p>æ¯”å¦‚è‹¥è¯¥é¢˜æ²¡æœ‰ä¸èƒ½åœ¨ä¸€æ¡è¾¹ä¸Šé‡å¤èµ°çš„æ¡ä»¶é™åˆ¶ï¼Œé‚£ä¹ˆç›´æ¥å°†é‚»æ¥çŸ©é˜µè½¬åŒ–ä¸ºçŸ©é˜µä¹˜æ³•å³å¯</p><p>æ•…</p><h3 id="çŸ©é˜µä¹˜æ³•è®¡æ•°"><a href="#çŸ©é˜µä¹˜æ³•è®¡æ•°" class="headerlink" title="çŸ©é˜µä¹˜æ³•è®¡æ•°"></a>çŸ©é˜µä¹˜æ³•è®¡æ•°</h3><p>å¯¹äºè®¡æ•°é—®é¢˜ï¼Œè‹¥å¯ä»¥å°† $n$ ä¸ªç‚¹è¡¨ç¤ºæˆ $n \times n$ çš„çŸ©é˜µï¼Œå¹¶ä¸”å¯ä»¥ä¿è¯ä¸­é€”è½¬ç§»å¯¹è±¡ä¸ä¼šå˜åŒ–ï¼Œå³å¯ç”¨çŸ©é˜µä¹˜æ³•è®¡æ•°</p><h3 id="è‡³äºè¯¥é¢˜"><a href="#è‡³äºè¯¥é¢˜" class="headerlink" title="è‡³äºè¯¥é¢˜"></a>è‡³äºè¯¥é¢˜</h3><p>é‚£ä¹ˆè€ƒè™‘è¯¥é¢˜ï¼ŒåŠ å…¥äº†ä¸èƒ½é‡å¤åœ¨ä¸€æ¡è¾¹ä¸Šèµ°çš„é™åˆ¶ï¼Œé‚£ä¹ˆæœ€ç®€å•çš„æ€æƒ³å°±æ˜¯æ‹†ç‚¹ï¼Œå¹¶ä¸”è®©æ”¹ç‚¹å±è”½æ‰å½“å‰æ–¹å‘ï¼Œä½†æ˜¯å¦‚æœè€ƒè™‘è¾¹ï¼Œä¸€æ¡æ— å‘è¾¹å¯ä»¥æ‹†æˆä¸¤æ¡æœ‰å‘è¾¹ï¼Œé‚£æ‹†å‡ºæ¥çš„å°±æ¯”ç‚¹å°‘å¾ˆå¤šäº†ï¼Œæ•…è€ƒè™‘ç‚¹è¾¹è½¬åŒ–</p><p>é‚£ä¹ˆåªè¦åœ¨èµ·å§‹ç‚¹åŠ ä¸€æ¡è¶…çº§æºè¾¹ï¼ŒåŒæ ·çŸ©é˜µä¹˜æ³•å³å¯ç»Ÿè®¡ç­”æ¡ˆ</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 45989</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">50</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">120</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, K;</span><br><span class="line"><span class="keyword">int</span> st, ed;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">LL a[MAXM][MAXM];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= size; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= size; j ++)</span><br><span class="line">a[i][j] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">Matrix newmat;</span><br><span class="line">newmat.init ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= size; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= size; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= size; k ++)</span><br><span class="line">newmat.a[i][j] = (newmat.a[i][j] + a[i][k] * p.a[k][j] % MOD) % MOD;</span><br><span class="line"><span class="keyword">return</span> newmat;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Matrix mats, bem;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">mats = mats * bem;</span><br><span class="line">bem = bem * bem;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[ed]; i; i = Link[i].next)</span><br><span class="line">ans = (ans + mats.a[<span class="number">1</span>][i ^ <span class="number">1</span>]) % MOD;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), K = getnum (), st = getnum () + <span class="number">1</span>, ed = getnum () + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum () + <span class="number">1</span>, v = getnum () + <span class="number">1</span>;</span><br><span class="line">Insert (u, v), Insert (v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[st]; i; i = Link[i].next)</span><br><span class="line">bem.a[<span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= size; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = Head[v]; j; j = Link[j].next) &#123;</span><br><span class="line"><span class="keyword">if</span> ((j ^ <span class="number">1</span>) == i)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">bem.a[i][j] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= size; i ++)</span><br><span class="line">mats.a[i][i] = <span class="number">1</span>;</span><br><span class="line">LL ans = power (K);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5 3 0 0</span></span><br><span class="line"><span class="comment">0 1</span></span><br><span class="line"><span class="comment">0 2</span></span><br><span class="line"><span class="comment">0 3</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çŸ©é˜µä¹˜æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒSCOI2016ã€èŒèŒå“’</title>
      <link href="/2020/08/04/%5BSCOI2016%5D%E8%90%8C%E8%90%8C%E5%93%92/"/>
      <url>/2020/08/04/%5BSCOI2016%5D%E8%90%8C%E8%90%8C%E5%93%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ç¬¬ä¸€æ¬¡åšåˆ°è¿™ç§å€å¢é¢˜ï¼Œæœ‰ç‚¹æœ‰è¶£</p><p>é¦–å…ˆåŒºé—´å†…çš„æ¯ä¸ªç‚¹å¯¹åº”ç›¸ç­‰ç”¨å¹¶æŸ¥é›†ç»´æŠ¤ä¸€ä¸‹å°±å¥½äº†ï¼Œæ˜¾ç„¶æœ€åçš„ç­”æ¡ˆå°±æ˜¯ï¼ˆå¹¶æŸ¥é›†ä¸ªæ•°ä¸º $t$ï¼‰ $9 \cdot 10^{t - 1}$</p><p>å½“ç„¶è¿™æ ·ä¼šé€ æˆ $O (n^2)$ çš„å¤æ‚åº¦ï¼Œé‚£ä¹ˆé€šè¿‡å€å¢æ¥ä¼˜åŒ–ï¼Œå³å°†åŒºé—´äºŒè¿›åˆ¶æ‹†åˆ†ï¼Œç„¶åæ¯æ¬¡å°† $[l_1, l_1 + 2^k - 1]$ ä¸ $[l_2, l_2 +2^k - 1]$ åˆå¹¶ï¼Œå…¶ä¸­ $k$ ä¸ºäºŒè¿›åˆ¶æ‹†åˆ†ç»“æœæ‰€å¾—å¹‚æ¬¡çš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆè¿™æ ·ä¿®æ”¹å°±å˜æˆ $O (n \log n)$ äº†</p><p>å¯¹äºæŸ¥è¯¢ï¼Œæ˜¾ç„¶æ˜¯ä¸èƒ½ç›´æ¥æŸ¥è¯¢äº†ï¼Œé‚£ä¹ˆå°±é€šè¿‡ç”±å¤§åŒºé—´åˆ°å°åŒºé—´çš„ä¼ é€’ï¼ˆå³å°†å¤§åŒºé—´æ‹†åˆ†ä¸ºå·¦å³ä¸¤æ®µï¼Œç„¶ååˆ†åˆ«ä¸ä¹‹ç¥–å…ˆæ‹†åˆ†å¾—å·¦å³ä¸¤æ®µåˆå¹¶ï¼‰æ¥å°†ä¿¡æ¯è½¬ç§»åˆ°æœ€å°çš„ï¼ˆå³ä»¥ç‚¹ä¸ºå•ä½çš„ï¼‰åŒºé—´æ®µä¸Š</p><p>é‚£ä¹ˆæœ€åå³ $O (n)$ æŸ¥è¯¢å¹¶æŸ¥é›†ä¸ªæ•°å³å¯</p><p>æ•…è¯¥å€å¢æ•´ä½“æ€æƒ³å³ä¸ºï¼šå°†ä»¥ç‚¹ä¸ºå•ä½å¤„ç†æ”¹ä¸ºä»¥å¹‚æ¬¡åŒºé—´æ®µä¸ºå•ä½å¤„ç† $\rightarrow$ å°†å¹‚æ¬¡åŒºé—´æ®µçš„ä¿¡æ¯è½¬ç§»åˆ°å°åŒºé—´ç›´è‡³å•ä½åŒºé—´ $\rightarrow$ ç­”æ¡ˆå¤„ç†</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXN][<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> father[x][j] == x ? x : father[x][j] = find (father[x][j], j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fx = find (x, j), fy = find (y, j);</span><br><span class="line">father[fx][j] = fy;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span>; j &gt;= <span class="number">1</span>; j --)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> fx = find (i, j);</span><br><span class="line">merge (i, fx, j - <span class="number">1</span>);</span><br><span class="line">merge (i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)), fx + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)), j - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">18</span>; j ++)</span><br><span class="line">father[i][j] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> l1 = getnum (), r1 = getnum ();</span><br><span class="line"><span class="keyword">int</span> l2 = getnum (), r2 = getnum ();</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span>; j &gt;= <span class="number">0</span>; j --)</span><br><span class="line"><span class="keyword">if</span> (l1 + p + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= r1) &#123;</span><br><span class="line">merge (l1 + p, l2 + p, j);</span><br><span class="line">p += (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">pushdown ();</span><br><span class="line"><span class="keyword">int</span> group = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (find (i, <span class="number">0</span>) == i)</span><br><span class="line">group ++;</span><br><span class="line">LL ans = <span class="number">9l</span>l * power (<span class="number">10l</span>l, group - <span class="number">1</span>) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 2</span></span><br><span class="line"><span class="comment">1 2 3 4</span></span><br><span class="line"><span class="comment">3 3 3 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">100000 1</span></span><br><span class="line"><span class="comment">1 99999 2 100000</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ€ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å€å¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒPOI2009ã€LYZ-Ice Skates</title>
      <link href="/2020/08/04/%5BPOI2009%5DLYZ-Ice%20Skates/"/>
      <url>/2020/08/04/%5BPOI2009%5DLYZ-Ice%20Skates/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="å‰ç½®ã€ŒHallå®šç†ã€"><a href="#å‰ç½®ã€ŒHallå®šç†ã€" class="headerlink" title="å‰ç½®ã€ŒHallå®šç†ã€"></a>å‰ç½®ã€ŒHallå®šç†ã€</h3><blockquote><p> äºŒåˆ†å›¾Gä¸­çš„ä¸¤éƒ¨åˆ†é¡¶ç‚¹ç»„æˆçš„é›†åˆåˆ†åˆ«ä¸ºX, Y(å‡è®¾æœ‰|X|â‰¤|Y||X|â‰¤|Y|)ã€‚Gä¸­æœ‰ä¸€ç»„æ— å…¬å…±ç‚¹çš„è¾¹ï¼Œä¸€ç«¯æ°å¥½ä¸ºç»„æˆXçš„ç‚¹(ä¹Ÿå°±æ˜¯å­˜åœ¨å®Œç¾åŒ¹é…)çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ï¼šXä¸­çš„ä»»æ„kä¸ªç‚¹è‡³å°‘ä¸Yä¸­çš„kä¸ªç‚¹ç›¸é‚»ï¼Œå³å¯¹äºXä¸­çš„ä¸€ä¸ªç‚¹é›†W ï¼Œä»¤N(W)ä¸ºWçš„æ‰€æœ‰é‚»å±…ï¼Œ éœå°”å®šç†å³å¯¹äºä»»æ„Wï¼Œ|W|â‰¤|N(W)</p></blockquote><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç”±äºæœ€åæƒ…å†µä»»é€‰ $k$ ä¸ªæ˜¯é€‰ä¸€ç«¯è¿ç»­çš„åŒºé—´ $[l, r]$ï¼Œæ ¹æ®Hallå®šç†çš„ $|W| \le N(W)$ å¯ä»¥å¾—åˆ°<br>$$<br>\begin{aligned}<br>sum[l, r] &amp;\le (r - l + 1 + d) \cdot k \\<br>sum[l, r] - (r - l +1) \cdot k &amp;\le d \cdot k<br>\end{aligned}<br>$$<br>é‚£ä¹ˆå°±å¯ä»¥åœ¨çº¿æ®µæ ‘ä¸­å°†æ¯ä¸ªç‚¹çš„æƒå€¼è®¾ä¸º $value - k$ï¼Œç„¶åç»´æŠ¤æœ€å¤§å­æ®µå’Œ $sumax$</p><p>é‚£ä¹ˆæœ€å $sumax \le d \cdot k  ?  TAK  :  NIE$ å³å¯</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> limit, N, k, d;</span><br><span class="line"></span><br><span class="line">LL subsum[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL lmax[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;, rmax[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumax[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123;</span><br><span class="line">subsum[root] = subsum[lson] + subsum[rson];</span><br><span class="line">lmax[root] = max (lmax[lson], subsum[lson] + lmax[rson]);</span><br><span class="line">rmax[root] = max (rmax[rson], rmax[lson] + subsum[rson]);</span><br><span class="line">sumax[root] = max (sumax[lson], max (sumax[rson], rmax[lson] + lmax[rson]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">subsum[root] = lmax[root] = rmax[root] = sumax[root] = - k;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid), build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">maintain (root);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi, <span class="keyword">int</span> delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">subsum[root] += delta;</span><br><span class="line">lmax[root] += delta, rmax[root] += delta;</span><br><span class="line">sumax[root] += delta;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">posi &lt;= mid ? modify (lson, left, mid, posi, delta) : modify (rson, mid + <span class="number">1</span>, right, posi, delta);</span><br><span class="line">maintain (root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">bool</span> isneg = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>) isneg = <span class="literal">true</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">limit = getnum (), N = getnum (), k = getnum (), d = getnum ();</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, limit);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> posi = getnum (), delta = getnum ();</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, limit, posi, delta);</span><br><span class="line">LL deal = sumax[<span class="number">1</span>];</span><br><span class="line">deal &lt;= <span class="number">1l</span>l * k * d ? <span class="built_in">puts</span> (<span class="string">"TAK"</span>) : <span class="built_in">puts</span> (<span class="string">"NIE"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 4 2 1</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">3 3</span></span><br><span class="line"><span class="comment">2 -1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> äºŒåˆ†å›¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒPOI2006ã€MET-Subway</title>
      <link href="/2020/08/04/%5BPOI2006%5DMET-Subway/"/>
      <url>/2020/08/04/%5BPOI2006%5DMET-Subway/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>åœ¨ä¸€æ£µæ ‘ä¸Šé€‰å‡º $k$ æ¡å¯ç›¸äº¤çš„é“¾ä½¿å¾—è¢«è¦†ç›–çš„ç‚¹æ•°æœ€å¤šï¼Œæ±‚è¯¥æœ€å¤§å€¼</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¯´å®è¯è¿™ä¸ªè§£æ³•æ˜¯çœŸçš„å‰å®³</p><p>æ˜¾ç„¶é¢˜ç›®å¯ä»¥çœ‹ä½œé€‰å‡º $k \times 2$ ä¸ªå¶å­èŠ‚ç‚¹ï¼Œç„¶åå°†å®ƒä»¬äº’ç›¸è¿æ¥æœ€ç»ˆè¦†ç›–çš„ç‚¹çš„æœ€å¤§å€¼</p><p>å†è€ƒè™‘åˆ å»é€‰ä¸­çš„ $k \times 2$ ä¸ªå¶å­èŠ‚ç‚¹åï¼Œå‘å†…ä¸€å±‚çš„ç‚¹æœ€å¤šåªä¼šæœ‰ $k \times 2$ ä¸ªç‚¹æœ‰è´¡çŒ®</p><p>åŒç†ç»§ç»­å†…æ¨</p><p>äºæ˜¯ä¸Šè¿°è¿‡ç¨‹å³ç”±å¶å­èŠ‚ç‚¹å¼€å§‹æ‹“æ‰‘ï¼Œå¯¹äºæ‹“æ‰‘çš„æ¯ä¸€å±‚ï¼Œä»¤ç‚¹ $i$ æ‹“æ‰‘æ·±åº¦ä¸º $depth_i$ï¼Œ$total_i$ è¡¨ç¤ºæ‹“æ‰‘æ·±åº¦ä¸º $i$ çš„ç‚¹çš„ä¸ªæ•°ï¼Œå³ï¼Œå°†æ¯ä¸€ä¸ªæ‹“æ‰‘å±‚é‡æ–°çœ‹ä½œå¶å­èŠ‚ç‚¹ï¼Œå†åœ¨å½“å‰æ‹“æ‰‘å±‚ä¸­é€‰å‡ºè‡³å¤š $k \times 2$ ä¸ªâ€œå¶å­èŠ‚ç‚¹â€ï¼Œæ•…<br>$$<br>\min (k \times 2, total_i)<br>$$<br>å³ä¸ºæ‹“æ‰‘æ·±åº¦ä¸º $i$ çš„å±‚çš„ç­”æ¡ˆè´¡çŒ®</p><p>å°†å®ƒä»¬ç´¯åŠ èµ·æ¥å³å¯</p><p>å¤æ‚åº¦ $O (n)$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e06</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="keyword">int</span> degree[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> total[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">toposort</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (degree[i] == <span class="number">1</span>) &#123;</span><br><span class="line">que.push(i);</span><br><span class="line">total[depth[i] = <span class="number">1</span>] ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> ((-- degree[v]) == <span class="number">1</span>) &#123;</span><br><span class="line">total[depth[v] = depth[u] + <span class="number">1</span>] ++;</span><br><span class="line">que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">Insert (u, v), Insert (v, u);</span><br><span class="line">degree[u] ++, degree[v] ++;</span><br><span class="line">&#125;</span><br><span class="line">toposort ();</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">ans += min (K &lt;&lt; <span class="number">1</span>, total[i]);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">17 3</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">5 2</span></span><br><span class="line"><span class="comment">5 6</span></span><br><span class="line"><span class="comment">5 8</span></span><br><span class="line"><span class="comment">7 8</span></span><br><span class="line"><span class="comment">9 8</span></span><br><span class="line"><span class="comment">5 10</span></span><br><span class="line"><span class="comment">10 13</span></span><br><span class="line"><span class="comment">13 14</span></span><br><span class="line"><span class="comment">10 12</span></span><br><span class="line"><span class="comment">12 11</span></span><br><span class="line"><span class="comment">15 17</span></span><br><span class="line"><span class="comment">15 16</span></span><br><span class="line"><span class="comment">15 10</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒNOI2018ã€ä½ çš„åå­—</title>
      <link href="/2020/08/04/%5BNOI2018%5D%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97/"/>
      <url>/2020/08/04/%5BNOI2018%5D%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="ä¸»è¦é¢˜æ„"><a href="#ä¸»è¦é¢˜æ„" class="headerlink" title="ä¸»è¦é¢˜æ„"></a>ä¸»è¦é¢˜æ„</h3><p>æ±‚å­—ç¬¦ä¸²$S$ä¸$T$ä¸åŒçš„å­ä¸²æ€»æ•°</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å…ˆè€ƒè™‘$l = 1, r = |T|$çš„æƒ…å†µï¼š</p><p>å› ä¸ºä»»æ„å­ä¸²ä¸ºå­—ç¬¦ä¸²å‰ç¼€çš„æŸäº›åç¼€ï¼Œé‚£ä¹ˆä»¤$Lim[i]$è¡¨ç¤º$T[1â€¦i]$åœ¨$S$ä¸Šæ‰€èƒ½åŒ¹é…çš„æœ€å¤§é•¿åº¦ï¼Œ$Posi[i]$è¡¨ç¤º$T$çš„åç¼€è‡ªåŠ¨æœºä¸Šçš„ç‚¹$i$çš„$endpos$é›†åˆä¸­æœ€é å‰çš„ä½ç½®ï¼Œé‚£ä¹ˆç­”æ¡ˆå³ä¸º</p><p>$$Ans = \sum\limits_{i = 1}^{nodes} \max (0, Len[i] - min (Len[Father[i]], Lim[Posi[i]]))$$</p><p>æ¥ä¸‹æ¥è€ƒè™‘$l, r$ä»»æ„çš„æƒ…å†µï¼š</p><p>åŸæ¥èƒ½å¦åœ¨$S$çš„åç¼€è‡ªåŠ¨æœºä¸Šå¾€ä¸‹èµ°çš„åˆ¤æ–­ä¾æ®åªæœ‰å½“å‰èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨$c$è¾¹ï¼Œé‚£ä¹ˆæœ‰äº†$l, r$çš„é™åˆ¶ï¼Œå°±å¤šéœ€è¦åˆ¤æ–­å‘ä¸‹çš„è¿™ä¸ªèŠ‚ç‚¹çš„$endpos$æ˜¯å¦æœ‰å­˜åœ¨äº$[l + len, r]$ï¼ˆ$len$è¡¨ç¤ºå·²åŒ¹é…é•¿åº¦ï¼‰åŒºé—´çš„ä½ç½®ï¼Œ$endpos$é›†åˆç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹å°±å¥½äº†</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e06</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">20</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line"><span class="keyword">char</span> Orig[MAXN], Str[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Root[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Left[MAXN * MAXL]= &#123;<span class="number">0</span>&#125;, Right[MAXN * MAXL]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> tnodes = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Modify</span> <span class="params">(<span class="keyword">int</span>&amp; root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (! root)</span><br><span class="line">        root = ++ tnodes;</span><br><span class="line">    <span class="keyword">if</span> (left == right)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    pos &lt;= mid ? Modify (Left[root], left, mid, pos) : Modify (Right[root], mid + <span class="number">1</span>, right, pos);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Tree_Merge</span> <span class="params">(<span class="keyword">int</span> sl, <span class="keyword">int</span> sr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (! sl || ! sr)</span><br><span class="line">        <span class="keyword">return</span> sl + sr;</span><br><span class="line">    <span class="keyword">int</span> p = ++ tnodes;</span><br><span class="line">    Left[p] = Tree_Merge (Left[sl], Left[sr]);</span><br><span class="line">    Right[p] = Tree_Merge (Right[sl], Right[sr]);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (! root || left &gt; right)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= mid)</span><br><span class="line">        <span class="keyword">if</span> (Query (Left[root], left, mid, L, R))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (R &gt; mid)</span><br><span class="line">        <span class="keyword">if</span> (Query (Right[root], mid + <span class="number">1</span>, right, L, R))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> Tree[MAXN][<span class="number">30</span>];</span><br><span class="line">    <span class="keyword">int</span> Father[MAXN];</span><br><span class="line">    <span class="keyword">int</span> Len[MAXN], Posi[MAXN];</span><br><span class="line">    <span class="keyword">int</span> last, nodes;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++) &#123;</span><br><span class="line">            <span class="built_in">memset</span> (Tree[i], <span class="number">0</span>, <span class="keyword">sizeof</span> (Tree[i]));</span><br><span class="line">            Father[i] = <span class="number">0</span>, Posi[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last = nodes = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Append</span> <span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> pos, <span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> fa = last, p = ++ nodes;</span><br><span class="line">        last = p;</span><br><span class="line">        Len[p] = Len[fa] + <span class="number">1</span>, Posi[p] = pos;</span><br><span class="line">        <span class="keyword">while</span> (fa &amp;&amp; ! Tree[fa][c])</span><br><span class="line">            Tree[fa][c] = p, fa = Father[fa];</span><br><span class="line">        <span class="keyword">if</span> (! fa)</span><br><span class="line">            Father[p] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> x = Tree[fa][c];</span><br><span class="line">            <span class="keyword">if</span> (Len[x] == Len[fa] + <span class="number">1</span>)</span><br><span class="line">                Father[p] = x;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> np = ++ nodes;</span><br><span class="line">                Len[np] = Len[fa] + <span class="number">1</span>, Father[np] = Father[x], Posi[np] = Posi[x];</span><br><span class="line">                Father[p] = Father[x] = np;</span><br><span class="line">                <span class="built_in">memcpy</span> (Tree[np], Tree[x], <span class="keyword">sizeof</span> (Tree[x]));</span><br><span class="line">                <span class="keyword">while</span> (fa &amp;&amp; Tree[fa][c] == x)</span><br><span class="line">                    Tree[fa][c] = np, fa = Father[fa];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>)</span><br><span class="line">            Modify (Root[p], <span class="number">1</span>, N, pos);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> Topo[MAXN];</span><br><span class="line">    <span class="keyword">int</span> Minp[MAXN];</span><br><span class="line">    <span class="keyword">int</span> buck[MAXN];</span><br><span class="line">    <span class="comment">/*void Merge_Minp () &#123;</span></span><br><span class="line"><span class="comment">        for (int i = 1; i &lt;= nodes; i ++)</span></span><br><span class="line"><span class="comment">            buck[i] = 0, Minp[i] = Posi[i];</span></span><br><span class="line"><span class="comment">        for (int i = 1; i &lt;= nodes; i ++)</span></span><br><span class="line"><span class="comment">            buck[Len[i]] ++;</span></span><br><span class="line"><span class="comment">        for (int i = 1; i &lt;= N; i ++)</span></span><br><span class="line"><span class="comment">            buck[i] += buck[i - 1];</span></span><br><span class="line"><span class="comment">        for (int i = nodes; i &gt;= 1; i --)</span></span><br><span class="line"><span class="comment">            Topo[buck[Len[i]] --] = i;</span></span><br><span class="line"><span class="comment">        for (int i = nodes; i &gt;= 1; i --)</span></span><br><span class="line"><span class="comment">            Minp[Father[Topo[i]]] = min (Minp[Father[Topo[i]]], Minp[Topo[i]]);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Merge_Tree</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">            buck[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">            buck[Len[i]] ++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">            buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = nodes; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">            Topo[buck[Len[i]] --] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = nodes; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">            Root[Father[Topo[i]]] = Tree_Merge (Root[Father[Topo[i]]], Root[Topo[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">SAM S, T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Lim[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">/*void Match (int l, int r) &#123;</span></span><br><span class="line"><span class="comment">    int p = 1, len = 0;</span></span><br><span class="line"><span class="comment">    for (int i = 1; i &lt;= M; i ++) &#123;</span></span><br><span class="line"><span class="comment">        int c = Str[i] - 'a';</span></span><br><span class="line"><span class="comment">        while (p &amp;&amp; ! S.Tree[p][c])</span></span><br><span class="line"><span class="comment">            p = S.Father[p], len = S.Len[p];</span></span><br><span class="line"><span class="comment">        while (p &amp;&amp; ! Query (Root[S.Tree[p][c]], 1, N, l + len, r))</span></span><br><span class="line"><span class="comment">            p = S.Father[p], len = S.Len[p];</span></span><br><span class="line"><span class="comment">        S.Tree[p][c] ? (p = S.Tree[p][c], len ++) : (p = 1, len = 0);</span></span><br><span class="line"><span class="comment">        Lim[i] = len;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Work</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">1</span>, len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> c = Str[j] - <span class="string">'a'</span>;</span><br><span class="line">        T.Append (c, j, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (S.Tree[p][c] &amp;&amp; Query (Root[S.Tree[p][c]], <span class="number">1</span>, N, l + len, r)) &#123;</span><br><span class="line">                p = S.Tree[p][c], len ++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (! len)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            len --;</span><br><span class="line">            <span class="keyword">if</span> (len == S.Len[S.Father[p]])</span><br><span class="line">                p = S.Father[p];</span><br><span class="line">        &#125;</span><br><span class="line">        Lim[j] = len;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// T.Merge_Minp ();</span></span><br><span class="line">    <span class="comment">// Match (l, r);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">Solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T.nodes; i ++)</span><br><span class="line">        ans += max (<span class="number">0</span>, T.Len[i] - max (T.Len[T.Father[i]], Lim[T.Posi[i]]));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span> (<span class="string">"%s"</span>, Orig + <span class="number">1</span>);</span><br><span class="line">    N = <span class="built_in">strlen</span> (Orig + <span class="number">1</span>);</span><br><span class="line">    S.init ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        S.Append (Orig[i] - <span class="string">'a'</span>, i, <span class="number">1</span>);</span><br><span class="line">    S.Merge_Tree ();</span><br><span class="line">    <span class="built_in">scanf</span> (<span class="string">"%d"</span>, &amp; Q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span> (<span class="string">"%s"</span>, Str + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> l = getnum (), r = getnum ();</span><br><span class="line">        T.init ();</span><br><span class="line">        M = <span class="built_in">strlen</span> (Str + <span class="number">1</span>);</span><br><span class="line">        Work (l, r);</span><br><span class="line">        LL ans = Solve ();</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">scbamgepe</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">smape 1 9</span></span><br><span class="line"><span class="comment">sbape 1 9</span></span><br><span class="line"><span class="comment">sgepe 1 9</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">scbamgepe</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">smape 2 7</span></span><br><span class="line"><span class="comment">sbape 3 8</span></span><br><span class="line"><span class="comment">sgepe 1 9</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­—ç¬¦ä¸² </category>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> åç¼€è‡ªåŠ¨æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒNOI2016ã€å¾ªç¯ä¹‹ç¾</title>
      <link href="/2020/08/04/%5BNOI2016%5D%E5%BE%AA%E7%8E%AF%E4%B9%8B%E7%BE%8E/"/>
      <url>/2020/08/04/%5BNOI2016%5D%E5%BE%AA%E7%8E%AF%E4%B9%8B%E7%BE%8E/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æ±‚è§£ $1 \le x \le n, ~ 1 \le y \le m$ ä¸­æ»¡è¶³åœ¨ $k$ è¿›åˆ¶ä¸‹ $\frac{x}{y}$ æ˜¯æœ‰é™å¾ªç¯å°æ•°çš„ä¸ªæ•°</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å¾ˆå¥½ç„¶åæˆ‘ä¸€å¼€å§‹åœ¨è®¡ç®—å™¨ä¸Šæ•²äº†åŠä¸ªå°æ—¶ç„¶åç”±äºçœ¼çå¹¶ä¸”å½’çº³èƒ½åŠ›å·®å¹¶æ²¡æœ‰å‘ç°è§„å¾‹</p><p>è®¾ $\frac{x}{y}$ çš„å¾ªç¯èŠ‚é•¿åº¦ä¸º $l$ï¼Œåˆ™æœ‰<br>$$<br>\begin{aligned}<br>\frac{xk^l}{y} - \left\lfloor\frac{xk^l}{y}\right\rfloor &amp;= \frac{x}{y} - \left\lfloor\frac{x}{y}\right\rfloor \\<br>xk^l - \left\lfloor\frac{xk^l}{y}\right\rfloor y &amp;= x - \left\lfloor\frac{x}{y}\right\rfloor y \\<br>xk^l &amp;\equiv x \pmod y \\<br>k &amp;\equiv 1 \pmod y<br>\end{aligned}<br>$$<br>ä¹Ÿå°±æ˜¯è¯´åªè¦æ»¡è¶³ $y \bot k$ å³å¯æ»¡è¶³é¢˜æ„ï¼Œæ•…å¯å°†é—®é¢˜åŒ–ä¸º<br>$$<br>\begin{aligned}<br>Ans &amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^m [(i, j) = 1][(j, k) = 1] \\<br>&amp;= \sum\limits_{j = 1}^m [(j, k) = 1]\sum\limits_{d | j} \mu(d)\left\lfloor\frac{n}{d}\right\rfloor \\<br>&amp;= \sum\limits_{d = 1}^n \mu(d)\left\lfloor\frac{n}{d}\right\rfloor\sum\limits_{d | j}[(j, k) = 1] \\<br>&amp;å°†jé™¤ä»¥d, æ­¤æ—¶è‹¥ååŠéƒ¨åˆ†çš„\sumè¦æœ‰è´¡çŒ®åˆ™éœ€æ»¡è¶³d \bot k \\<br>&amp;= \sum\limits_{d = 1}^n [(d, k) = 1]\mu(d)\left\lfloor\frac{n}{d}\right\rfloor\big(\sum\limits_{j = 1}^{\left\lfloor\frac{m}{d}\right\rfloor}[(j, k) = 1]\big)<br>\end{aligned}<br>$$<br>äºæ˜¯æ¥ä¸‹æ¥å˜ä¸ºå¤„ç†<br>$$<br>f_1(n, k) = \sum\limits_{d = 1}^n [(d, k) = 1]\mu(d) \\<br>f_2(n) = \sum\limits_{d = 1}^n [(d, k) = 1]<br>$$<br>å…ˆè¯´ $f_2(n)$ï¼Œè¾ƒå¥½å¤„ç†ï¼Œå³è€ƒè™‘é•¿åº¦ä¸º $k$ çš„åŒºé—´å°† $n$ åˆ†æ®µï¼Œå…¶ä¸­é™¤äº†æœ€åå¤šå‡ºæ¥çš„é‚£ä¸€æ®µå…¶ä½™çš„æ®µå¾—åˆ°çš„è´¡çŒ®æ˜¯ç›¸åŒçš„ï¼Œå³ $\varphi(k)$ï¼Œæ•…<br>$$<br>f_2(n) = \left\lfloor\frac{n}{k}\right\rfloor\varphi(k) + f_2(n \% k)<br>$$<br>é‚£ä¹ˆå¯¹äº $f_1(n, k)$ï¼Œå®¹æ˜“å˜æ¢å¾—<br>$$<br>f_1(n, k) = \sum\limits_{d | k}^n \mu(d)\sum\limits_{l = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(ld)<br>$$<br>ç„¶åæˆ‘å°±ä¸ä¼šäº†ï¼Œçœ‹äº†ä¸‹é¢˜è§£ï¼Œå¯ä»¥å‘ç°è‹¥ $\mu(ld)$ æœ‰è´¡çŒ®ï¼Œ<strong>åˆ™éœ€æ»¡è¶³ $l \bot d$ï¼Œæ­¤æ—¶æœ‰ $\mu(ld) = \mu(l)\mu(d)$</strong>ï¼Œæ•…<br>$$<br>\begin{aligned}<br>f_1(n, k) &amp;= \sum\limits_{d | k} \mu(d)\sum\limits_{l = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(l)\mu(d)[(d, l) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu^2(d)\sum\limits_{l = 1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(l)[(d, l) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu^2(d)f_1(\left\lfloor\frac{n}{d}\right\rfloor, d)<br>\end{aligned}<br>$$<br>å¾ˆå¥½æˆ‘è¿˜æ˜¯ç¬¬ä¸€æ¬¡å†™åˆ°è«åå¸¦é€’å½’çš„</p><p>æ³¨æ„è¾¹ç•Œæ¡ä»¶ $n = 0$ ä¸ $k = 1$ï¼Œå¯¹äº $n = 0$ è¿”å› $0$ å³å¯ï¼Œå¯¹äº $k = 1$ï¼Œ$f_1(n, 1)$ å³ä¸º $\sum\limits_{d = 1}^n \mu(d)$ï¼Œæœæ•™ç­›ä¸€ä¸‹å³å¯</p><p>æœ€åå†æ•´é™¤åˆ†å—ä¸€æ¬¡æ±‚æ€»ç­”æ¡ˆå°±å¥½äº†</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e06</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1e06</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, K;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXM / <span class="number">10</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mu[MAXM]= &#123;<span class="number">0</span>&#125;, sumu[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linear_sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">sumu[<span class="number">1</span>] = mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (! visit[i]) &#123;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line">mu[i] = - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; i * prime[j] &lt;= MAX; j ++) &#123;</span><br><span class="line">visit[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (! (i % prime[j])) <span class="keyword">break</span>;</span><br><span class="line">mu[i * prime[j]] = - mu[i];</span><br><span class="line">&#125;</span><br><span class="line">sumu[i] = sumu[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tr1::<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mapmu;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mu_sieve</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= MAX) <span class="keyword">return</span> sumu[n];</span><br><span class="line"><span class="keyword">if</span> (mapmu[n]) <span class="keyword">return</span> mapmu[n];</span><br><span class="line"><span class="keyword">int</span> total = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = n / (n / l);</span><br><span class="line">total -= (r - l + <span class="number">1</span>) * mu_sieve (n / l);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> mapmu[n] = total;</span><br><span class="line">&#125;</span><br><span class="line">LL f[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL sumr[MAXM]= &#123;<span class="number">0</span>&#125;; <span class="comment">// sigma ([(j, k) = 1])</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GCD</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> ! b ? a : GCD (b, a % b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">r_sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">f[i] = f[i - <span class="number">1</span>] + (GCD (i, K) == <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rval</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (n / K) * f[K] + f[n % K];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;, <span class="keyword">int</span>&gt; mapl;</span><br><span class="line"><span class="function">LL <span class="title">l_solve</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123; <span class="comment">// S(n, K)</span></span><br><span class="line"><span class="keyword">if</span> (! n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ret = make_pair (n, k);</span><br><span class="line"><span class="keyword">if</span> (mapl[ret]) <span class="keyword">return</span> mapl[ret];</span><br><span class="line"><span class="keyword">if</span> (k == <span class="number">1</span>) <span class="keyword">return</span> mu_sieve (n);</span><br><span class="line">LL total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i * i &lt;= k; i ++)</span><br><span class="line"><span class="keyword">if</span> (! (k % i)) &#123;</span><br><span class="line"><span class="keyword">if</span> (mu[i]) total += l_solve (n / i, i);</span><br><span class="line"><span class="keyword">if</span> (i * i != k &amp;&amp; mu[k / i])</span><br><span class="line">total += l_solve (n / (k / i), k / i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> mapl[ret] = total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">linear_sieve ();</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d%d"</span>, &amp; N, &amp; M, &amp; K);</span><br><span class="line">r_sieve ();</span><br><span class="line">LL ans = <span class="number">0</span>, pre = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r; l &lt;= min (N, M); l = r + <span class="number">1</span>) &#123;</span><br><span class="line">r = min (N / (N / l), M / (M / l));</span><br><span class="line">LL pl = l_solve (r, K);</span><br><span class="line">ans += <span class="number">1l</span>l * (pl - pre) * (N / l) * rval (M / l);</span><br><span class="line">pre = pl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 6 10</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">99 7689 100</span></span><br><span class="line"><span class="comment">ans: 257777</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>æˆ‘æ²¡æœ‰å†™è¿™ç§æ–¹æ³•ï¼Œä½†æ˜¯è¿™ç§çœŸçš„å¾ˆç®€å•çš„è¯´<br>$$<br>\begin{aligned}<br>f(n, m, k) &amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^m [(i, j) = 1][(j, k) = 1] \\<br>&amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^m [(i, j) = 1]\sum\limits_{d | j, d | k} \mu(d) \\<br>&amp;= \sum\limits_{d | k} \mu(d)\sum\limits_{i = 1}^n\sum\limits_{d | j}^m [(i, j) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu(d)\sum\limits_{i = 1}^n\sum\limits_{j = 1}^{\left\lfloor\frac{m}{d}\right\rfloor} [(i, jd) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu(d)\sum\limits_{i = 1}^n\sum\limits_{j = 1}^{\left\lfloor\frac{m}{d}\right\rfloor} [(i, j) = 1][(i, d) = 1] \\<br>&amp;= \sum\limits_{d | k} \mu(d)f(\left\lfloor\frac{m}{d}\right\rfloor, n, d)<br>\end{aligned}<br>$$<br>è¾¹ç•Œ $n = 0$ æˆ–è€… $m = 0$ è¿”å› $0$ï¼Œ$k = 1$ è¿”å› $\sum\limits_{i = 1}^n\sum\limits_{j = 1}^m [(i, j) = 1] = \sum\limits_{i = 1}^{\min (n, m)} \mu(d) \left\lfloor\frac{n}{d}\right\rfloor \left\lfloor\frac{m}{d}\right\rfloor$ å³å¯</p><p>ä¸è¿‡è¯´å®è¯è¿™ä¸ªè™½ç„¶ç®€å•ä½†æ˜¯è‡³å°‘å¯¹äºæˆ‘ä¸å¤§å®¹æ˜“æƒ³åˆ°ï¼Œæ¯•ç«Ÿæˆ‘ä¼šå…ˆæ‹† $[(i, j) = 1]$ éƒ¨åˆ†ï¼Œå› ä¸ºæ€»æ„Ÿè§‰ $[(j, k) = 1]$ ä¼šå¤šå‡ºä¸€ä¸ª $d | k$ çš„é™åˆ¶æ¡ä»¶</p><p>ä½†æ˜¯è¿™ä¸ªè§£æ³•æ˜¯çœŸçš„å‰å®³</p>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è«æ¯”ä¹Œæ–¯åæ¼” </tag>
            
            <tag> æœæ•™ç­› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒNOI2014ã€è´­ç¥¨ ã€Œæ ‘ä¸Šæ–œç‡ä¼˜åŒ–ã€</title>
      <link href="/2020/08/04/%5BNOI2014%5D%E8%B4%AD%E7%A5%A8%20%E3%80%8C%E6%A0%91%E4%B8%8A%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96%E3%80%8D/"/>
      <url>/2020/08/04/%5BNOI2014%5D%E8%B4%AD%E7%A5%A8%20%E3%80%8C%E6%A0%91%E4%B8%8A%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>é¦–å…ˆæ˜“å¾—æ–¹ç¨‹ï¼Œä¸”ç»è¿‡å˜æ¢æœ‰</p><p>$$\begin{aligned} f_i &amp;= \min\limits_{dist_i - lim_i \le dist_j} \{f_j + (dist_i - dist_j)p_i + q_i\} \\ f_j &amp;= p_idist_j + f_i - dist_ip_i - q_i \end{aligned}â€‹$$</p><p>åœ¨ä¸€æ¡ç›´çº¿ä¸Šæ—¶ï¼Œæ–œç‡ä¼˜åŒ–å¯ä»¥ç”¨æ™®é€š$CDQâ€‹$åˆ†æ²»å®ç°ï¼ˆä¼šä¸ä¼šè¿‡äºéº»çƒ¦ï¼Ÿï¼‰ï¼Œé‚£ä¹ˆå¯¹äºåœ¨æ ‘ä¸Šæ–œç‡ä¼˜åŒ–æ—¶ï¼Œè€ƒè™‘ç‚¹åˆ†æ²»</p><p>è¿™æ—¶å°±åœ¨ç‚¹åˆ†æ²»ä¸­è¿ç”¨$CDQ$åˆ†æ²»çš„æ€æƒ³ï¼Œå³ä½¿ç”¨åœ¨å½“å‰é‡å¿ƒç®¡è¾–èŒƒå›´å†…çš„é€šå‘æ ¹èŠ‚ç‚¹çš„é‚£ä¸€æ¡é“¾ä¸Šçš„èŠ‚ç‚¹æ¥æ›´æ–°å…¶å®ƒèŠ‚ç‚¹å°±å¥½äº†</p><p>æ³¨æ„åœ¨åˆ†æ²»ä¸­çš„æ–œç‡ä¼˜åŒ–æ—¶åœ¨å‡¸åŒ…ä¸ŠåŠ ç‚¹å’Œæ›´æ–°å³ä¾§èŠ‚ç‚¹ç­”æ¡ˆè¦åŒæ—¶è¿›è¡Œï¼Œä¸ç„¶å½“å‰æœ€ä¼˜è§£å¯èƒ½ä¼šåœ¨åé¢ç”±äºæ–œç‡è¢«åˆ å»ï¼Œå¯¼è‡´ç­”æ¡ˆé”™è¯¯ï¼Œè¿˜æœ‰ç”±äºä¸‹é¢ä»£ç æ˜¯ç”±æ·±åº¦ç”±å°åˆ°å¤§å¤„ç†çš„ï¼Œæ‰€ä»¥æ˜¯åç€ç»´æŠ¤ä¸‹å‡¸åŒ…ï¼Œå³ä¸Šå‡¸åŒ…</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="keyword">const</span> LL INFLL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-08</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dcmp</span> <span class="params">(<span class="keyword">double</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span> (p) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> p &lt; <span class="number">0</span> ? - <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    Link[++ size].to = v;</span><br><span class="line">    Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">    Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Root = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CitySt</span> &#123;</span></span><br><span class="line">    LL p, q, lim;</span><br><span class="line"></span><br><span class="line">    CitySt () &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">CitySt City[MAXN];</span><br><span class="line"></span><br><span class="line">LL f[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">LL Fdist[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL Dist[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Dist[v] = Dist[root] + Fdist[v];</span><br><span class="line">        DFS (v, root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Vis[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Size[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> grvy, minval = INF;</span><br><span class="line"><span class="keyword">int</span> total;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Grvy_Acqu</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    Size[root] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father || Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Grvy_Acqu (v, root);</span><br><span class="line">        Size[root] += Size[v];</span><br><span class="line">        maxpart = max (maxpart, Size[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    maxpart = max (maxpart, total - Size[root]);</span><br><span class="line">    <span class="keyword">if</span> (maxpart &lt; minval)</span><br><span class="line">        grvy = root, minval = maxpart;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> temp[MAXN];</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> Que[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Dist[a] == Dist[b])</span><br><span class="line">        <span class="keyword">return</span> INFLL * <span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">double</span>) (f[b] - f[a]) * <span class="number">1.0</span> / (<span class="keyword">double</span>) (Dist[b] - Dist[a]) * <span class="number">1.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> listq[MAXN];</span><br><span class="line"><span class="keyword">int</span> lp = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; a, <span class="keyword">const</span> <span class="keyword">int</span>&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Dist[a] - City[a].lim &gt; Dist[b] - City[b].lim;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">listq_Acqu</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (father)</span><br><span class="line">        listq[++ lp] = root;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (v == father || Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        listq_Acqu (v, root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Binary_Search</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left == right)</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    <span class="keyword">int</span> l = left, r = right;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (f[Que[mid + <span class="number">1</span>]] - f[Que[mid]] &lt;= p * (Dist[Que[mid + <span class="number">1</span>]] - Dist[Que[mid]]))</span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> tp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left &gt; right)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> p = Binary_Search (left, right, City[tp].p);</span><br><span class="line">    f[tp] = min (f[tp], f[Que[p]] + (Dist[tp] - Dist[Que[p]]) * City[tp].p + City[tp].q);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Solve</span> <span class="params">(<span class="keyword">int</span> root)</span> </span>&#123;</span><br><span class="line">    minval = INF, total = Size[root], Grvy_Acqu (root, <span class="number">0</span>);</span><br><span class="line">    Vis[grvy] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> fgrvy = grvy;</span><br><span class="line">    <span class="keyword">if</span> (grvy != root) &#123;</span><br><span class="line">        Size[root] -= Size[grvy];</span><br><span class="line">        Solve (root);</span><br><span class="line">    &#125;</span><br><span class="line">    p = <span class="number">0</span>;</span><br><span class="line">    temp[++ p] = fgrvy;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> nd = fgrvy; nd != root; nd = Father[nd]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Dist[fgrvy] - City[fgrvy].lim &lt;= Dist[Father[nd]])</span><br><span class="line">            f[fgrvy] = min (f[fgrvy], f[Father[nd]] + (Dist[fgrvy] - Dist[Father[nd]]) * City[fgrvy].p + City[fgrvy].q);</span><br><span class="line">        temp[++ p] = Father[nd];</span><br><span class="line">    &#125;</span><br><span class="line">    lp = <span class="number">0</span>;</span><br><span class="line">    listq_Acqu (fgrvy, <span class="number">0</span>);</span><br><span class="line">    sort (listq + <span class="number">1</span>, listq + lp + <span class="number">1</span>, comp);</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">1</span>, right = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= p &amp;&amp; j &lt;= lp; i ++) &#123; <span class="comment">// æ–œç‡ä¼˜åŒ–</span></span><br><span class="line">        <span class="keyword">while</span> (j &lt;= lp &amp;&amp; Dist[temp[i]] &lt; Dist[listq[j]] - City[listq[j]].lim)</span><br><span class="line">            Update (left, right, listq[j ++]);</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; Dcmp (slope (Que[right - <span class="number">1</span>], Que[right]) - slope (Que[right], temp[i])) &lt;= <span class="number">0</span>) <span class="comment">// æ³¨æ„æ˜¯ä¸Šå‡¸åŒ…</span></span><br><span class="line">            right --;</span><br><span class="line">        Que[++ right] = temp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j &lt;= lp)</span><br><span class="line">        Update (left, right, listq[j ++]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Head[fgrvy]; i; i = Link[i].next) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">        <span class="keyword">if</span> (Vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        Solve (v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getint</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">getLL</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    LL num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen ("Input.txt", "r", stdin);</span></span><br><span class="line">    <span class="comment">// freopen ("Output.txt", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span> (f, <span class="number">0x3f3f3f3f</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line">    f[Root] = <span class="number">0</span>;</span><br><span class="line">    N = getint (), getint ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> fa = getint ();</span><br><span class="line">        Father[i] = fa;</span><br><span class="line">        Fdist[i] = getLL ();</span><br><span class="line">        City[i].p = getLL (), City[i].q = getLL (), City[i].lim = getLL ();</span><br><span class="line">        Insert (fa, i), Insert (i, fa);</span><br><span class="line">    &#125;</span><br><span class="line">    DFS (Root, <span class="number">0</span>);</span><br><span class="line">    Size[Root] = N;</span><br><span class="line">    Solve (Root);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++)</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, f[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">7 3</span></span><br><span class="line"><span class="comment">1 2 20 0 3</span></span><br><span class="line"><span class="comment">1 5 10 100 5</span></span><br><span class="line"><span class="comment">2 4 10 10 10</span></span><br><span class="line"><span class="comment">2 9 1 100 10</span></span><br><span class="line"><span class="comment">3 5 20 100 10</span></span><br><span class="line"><span class="comment">4 4 20 0 10</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–œç‡ä¼˜åŒ– </tag>
            
            <tag> æ ‘ä¸ŠDP </tag>
            
            <tag> ç‚¹åˆ†æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒNOI2007ã€è´§å¸å…‘æ¢ ã€ŒCDQåˆ†æ²»å®ç°æ–œç‡ä¼˜åŒ–ã€</title>
      <link href="/2020/08/04/%5BNOI2007%5D%E8%B4%A7%E5%B8%81%E5%85%91%E6%8D%A2%20%E3%80%8CCDQ%E5%88%86%E6%B2%BB%E5%AE%9E%E7%8E%B0%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96%E3%80%8D/"/>
      <url>/2020/08/04/%5BNOI2007%5D%E8%B4%A7%E5%B8%81%E5%85%91%E6%8D%A2%20%E3%80%8CCDQ%E5%88%86%E6%B2%BB%E5%AE%9E%E7%8E%B0%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>é¦–å…ˆæ¯æ¬¡ä¹°å–ä¸€å®šæ˜¯åœ¨æŸå¤© $k$ ä»¥å½“æ—¶çš„æœ€å¤§æ”¶å…¥ä¹°å…¥ï¼Œå†åˆ°ç¬¬ $i$ å¤©å–å‡ºï¼Œé‚£ä¹ˆæ˜“å¾—æ–¹ç¨‹ï¼š</p><p>$$f_i = \max \{\frac{A_iRate_kf_k}{A_kRate_k + B_k} + \frac{B_if_k}{A_kRate_k + B_k}\}$$</p><p>å†ä»¤</p><p>$$\left\{\begin{aligned} x_k = \frac{Rate_kf_k}{A_kRate_k + B_k} \\ y_k = \frac{f_k}{A_kRate_k + B_k}\end{aligned}\right.$$</p><p>åˆ™æœ‰</p><p>$$\begin{aligned} f_i &amp;= \max \{A_ix_k + B_iy_k\} \\ y_k &amp;= - \frac{A_i}{B_i}x_k + \frac{f_i}{B_i} \end{aligned}$$</p><p>é‚£ä¹ˆç°åœ¨éœ€è¦æ‰¾åˆ°ä¸€ä¸ªç‚¹ $(x_k, y_k)$ ä½¿å¾—ç›´çº¿çš„æˆªè·æœ€å¤§</p><p>ç”±äºæ–œç‡å’Œæ¨ªåæ ‡çš†ä¸æ»¡è¶³å•è°ƒæ€§ï¼Œå¯ä»¥ç”¨å¹³è¡¡æ ‘ç­‰ç»´æŠ¤ï¼Œè¿™é‡Œä½¿ç”¨CDQåˆ†æ²»å®ç°</p><p>å®ç°è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>â…  å°†æ•°æ®æŒ‰ç…§æ–œç‡$\frac{A_i}{B_i}$é™åºæ’åº</p><p>â…¡ å°†åŒºé—´æŒ‰ç…§æ“ä½œé¡ºåºåˆ†ä¸ºå·¦å³ä¸¤éƒ¨åˆ†å¤„ç†</p><p>â…¢ å…ˆå¤„ç†å·¦åŠéƒ¨åˆ†ï¼Œç»´æŠ¤å·¦åŠè¾¹å‡¸åŒ…ï¼ˆæ³¨æ„ï¼Œæ­¤æ—¶å·¦åŠè¾¹å·²æŒ‰ç…§ $x$ æ’åºï¼‰</p><p>â…£ å¤„ç†å·¦åŠè¾¹å¯¹å³åŠè¾¹çš„å½±å“ï¼Œç”±äºå·²æŒ‰ç…§æ–œç‡é™åºæ’åºï¼Œæ‰€ä»¥æ™®é€šæ–œç‡ä¼˜åŒ–å³å¯</p><p>â…¤ å°†åŒºé—´æŒ‰ç…§ $x$ æ’åº</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> INF = <span class="number">1e60</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-08</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dcmp</span> <span class="params">(<span class="keyword">double</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span> (p) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> p &lt; <span class="number">0</span> ? - <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CashSt</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> a, b, rate;</span><br><span class="line">    <span class="keyword">double</span> k, x, y;</span><br><span class="line">    <span class="keyword">int</span> index;</span><br><span class="line"></span><br><span class="line">    CashSt () &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> CashSt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Dcmp (x - p.x) == <span class="number">0</span> ? Dcmp (y - p.y) &lt; <span class="number">0</span> : Dcmp (x - p.x) &lt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">CashSt Cash[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> CashSt&amp; a, <span class="keyword">const</span> CashSt&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Dcmp (a.k - b.k) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span> <span class="params">(CashSt a, CashSt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Dcmp (b.x - a.x) == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="keyword">return</span> (b.y - a.y) / (b.x - a.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">double</span> f[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">CashSt Que[MAXN];</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">CashSt temp[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">        f[left] = max (f[left], f[left - <span class="number">1</span>]);</span><br><span class="line">        Cash[left].y = f[left] / (Cash[left].a * Cash[left].rate + Cash[left].b);</span><br><span class="line">        Cash[left].x = Cash[left].y * Cash[left].rate;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> p1 = left - <span class="number">1</span>, p2 = mid;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= right; i ++)</span><br><span class="line">        Cash[i].index &lt;= mid ? temp[++ p1] = Cash[i] : temp[++ p2] = Cash[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= right; i ++)</span><br><span class="line">        Cash[i] = temp[i];</span><br><span class="line">    CDQ (left, mid);</span><br><span class="line">    l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= mid; i ++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; Dcmp (slope (Que[r - <span class="number">1</span>], Que[r]) - slope (Que[r], Cash[i])) &lt; <span class="number">0</span>)</span><br><span class="line">            r --;</span><br><span class="line">        Que[++ r] = Cash[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mid + <span class="number">1</span>; i &lt;= right; i ++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; Dcmp (slope (Que[l], Que[l + <span class="number">1</span>]) - Cash[i].k) &gt; <span class="number">0</span>)</span><br><span class="line">            l ++;</span><br><span class="line">        f[Cash[i].index] = max (f[Cash[i].index], Cash[i].a * Que[l].x + Cash[i].b * Que[l].y);</span><br><span class="line">    &#125;</span><br><span class="line">    CDQ (mid + <span class="number">1</span>, right);</span><br><span class="line">    l = left, r = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= mid &amp;&amp; r &lt;= right) &#123;</span><br><span class="line">        <span class="comment">// if (Dcmp (Cash[l].x - Cash[r].x) &lt; 0 || (Dcmp (Cash[l].x - Cash[r].x) == 0 &amp;&amp; Dcmp (Cash[l].y - Cash[r].y) &lt; 0))</span></span><br><span class="line">        <span class="keyword">if</span> (Cash[l] &lt; Cash[r])</span><br><span class="line">            temp[++ p] = Cash[l], l ++;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            temp[++ p] = Cash[r], r ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= mid)</span><br><span class="line">        temp[++ p] = Cash[l], l ++;</span><br><span class="line">    <span class="keyword">while</span> (r &lt;= right)</span><br><span class="line">        temp[++ p] = Cash[r], r ++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= p; i ++)</span><br><span class="line">        Cash[i + left - <span class="number">1</span>] = temp[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> num = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">double</span> T = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = num * <span class="number">10.0</span> + (ch - <span class="string">'0'</span>) * <span class="number">1.0</span>, ch = getchar ();</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">'.'</span>) &#123;</span><br><span class="line">        ch = getchar ();</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">            num = num + (T /= <span class="number">10.0</span>) * (ch - <span class="string">'0'</span>), ch = getchar ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen ("Input.txt", "r", stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span> (<span class="string">"%d%lf"</span>, &amp; N, &amp; f[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">double</span> a = getnum (), b = getnum (), rate = getnum ();</span><br><span class="line">        Cash[i].a = a, Cash[i].b = b, Cash[i].rate = rate;</span><br><span class="line">        Cash[i].index = i;</span><br><span class="line">        Cash[i].k = - a / b;</span><br><span class="line">    &#125;</span><br><span class="line">    sort (Cash + <span class="number">1</span>, Cash + N + <span class="number">1</span>, comp);</span><br><span class="line">    CDQ (<span class="number">1</span>, N);</span><br><span class="line">    <span class="built_in">printf</span> (<span class="string">"%.3f\n"</span>, f[N]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 100</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">2 2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> æ–œç‡ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒNOI2007ã€ç”Ÿæˆæ ‘è®¡æ•°</title>
      <link href="/2020/08/04/%5BNOI2007%5D%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0/"/>
      <url>/2020/08/04/%5BNOI2007%5D%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>åé¢å‘ç°è¿™æ˜¯æŸæ¬¡è€ƒè¯•çš„åŸé¢˜æ¥ç€</p><p>æ€•æ˜¯å¤ªä¹…æ²¡æ‰“è¿‡çŠ¶å‹ç„¶åè¿ $k \le 5$ å¯èƒ½è¦çŠ¶å‹è¿™ä¹ˆæ˜æ˜¾çš„æç¤ºéƒ½ç»™æ— è§†äº†ç„¶åå°±éšä¾¿æ•²äº†ä¸ªçŸ©é˜µæ ‘éª—äº† $50$ã€‚ã€‚ã€‚</p><p>å¥½æ‰€ä»¥è¿™é¢˜æ˜¯ä¸€é“çŠ¶å‹</p><p>ä»¤ $state$ è¡¨ç¤ºå¯¹äº $i$ ç‚¹ï¼ˆåŒ…æ‹¬å®ƒæœ¬èº«ï¼‰çš„å‰ $k$ ä¸ªç‚¹çš„è¿é€šçŠ¶æ€ï¼Œ$e.g.   \{1, 1, 2\}$ è¡¨ç¤º $\{1, 2\}, \{3\}$ ç‚¹åˆ†åˆ«è¿é€š</p><p>æ³¨æ„ä¸ºäº†å»é‡è¦ç”¨æœ€å°è¡¨ç¤ºï¼Œäºæ˜¯å³ä½¿å½“ $k = 5$ æ—¶çŠ¶æ€æ•°ä¹Ÿä¸è¿‡å°± $52$ ä¸ªè€Œå·²äº†</p><p>å†ä»¤ $f_{i, j}$ è¡¨ç¤ºå‰ $i$ ä¸ªç‚¹ä¸” $i$ ç‚¹è¿é€šçŠ¶æ€ä¸º $j$ æ—¶çš„æ–¹æ¡ˆæ•°ï¼Œ$g_{i, j}$ è¡¨ç¤ºçŠ¶æ€ $i$ è½¬ç§»åˆ°çŠ¶æ€ $j$ æ—¶çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰æ–¹ç¨‹<br>$$<br>f_{i, j} = \sum_k f_{i - 1, k} * g_{k, j}<br>$$<br>å¯ä»¥å‘ç°è¿™å°±æ˜¯ä¸€ä¸ªçŸ©é˜µè½¬ç§»å¼ï¼Œæ•…ç›´æ¥çŸ©é˜µä¹˜æ³•å³å¯</p><p>é‚£ä¹ˆè‡³äºè®¡ç®— $g_{i, j}$ åˆ™æšä¸¾ $i$ï¼ŒåŠå½“å‰ç‚¹ä¸å‰é¢ç‚¹çš„è¿é€šçŠ¶æ€ $state$ï¼ˆäºŒè¿›åˆ¶è¡¨ç¤ºï¼‰ï¼Œç„¶åå¹¶æŸ¥é›†ç»´æŠ¤ä¸€ä¸‹ï¼Œåˆ¤æ–­å½“å‰ $state$ æ˜¯å¦ä¼šä¸ä¹‹å‰å†²çªï¼ˆè¿è¾¹åæ— ç¯ä¸”åŸçŠ¶æ€ä¸­çš„æœ€å‰ç‚¹ï¼ˆå³ä¼šè¢«åˆ·æ‰çš„ç‚¹ï¼‰ä¸å½“å‰çš„ $k$ ä¸ªç‚¹ä¸­è‡³å°‘ä¸€ä¸ªç‚¹è¿è¾¹ï¼‰ï¼Œç„¶åè®¡ç®—å‡º $j$ï¼Œæœ€åç´¯åŠ å³å¯</p><p>å½“ç„¶è¦æ³¨æ„è€ƒè™‘ $f$ çŸ©é˜µçš„åˆå§‹çŠ¶æ€ï¼Œå³å¯¹äº $i  \in [1, k]$ï¼Œé‚£ä¹ˆè®¡ç®—å‡ºé‡Œé¢æ¯ä¸ªè¿é€šå—çš„å¤§å° $a_i$ï¼Œç„¶åç”¨ $Calley$ å…¬å¼ $n^{n - 2}$ ç®—ä¸€ä¸‹å°±å¥½äº†</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 65521</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">52</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXT = <span class="number">6e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> K;</span><br><span class="line">LL N;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> allst[MAXM], M = <span class="number">0</span>; <span class="comment">// å‹ä½è¡¨ç¤º</span></span><br><span class="line"><span class="keyword">int</span> mapp[MAXT]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> state, <span class="keyword">int</span> maxi)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == K + <span class="number">1</span>) &#123;</span><br><span class="line">        allst[++ M] = state;</span><br><span class="line">        mapp[state] = M;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= min (maxi + <span class="number">1</span>, K); i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> nst = state * <span class="number">10</span> + i;</span><br><span class="line">        DFS (p + <span class="number">1</span>, nst, max (i, maxi));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">    LL a[MAXM][MAXM];</span><br><span class="line"></span><br><span class="line">    Matrix () &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line">        a[i][j] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix&amp; A, <span class="keyword">const</span> Matrix&amp; B) &#123;</span><br><span class="line">Matrix ret = Matrix ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= M; k ++)</span><br><span class="line">ret.a[i][j] = (ret.a[i][j] + A.a[i][k] * B.a[k][j] % MOD) % MOD;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">Matrix f, g;</span><br><span class="line"><span class="function">LL <span class="title">matpower</span> <span class="params">(LL p)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">f = f * g;</span><br><span class="line">g = g * g;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> f.a[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> father[MAXK];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> father[x] == x ? x : father[x] = find (father[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    LL cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (p) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">            cnt = cnt * x % MOD;</span><br><span class="line">        x = x * x % MOD;</span><br><span class="line">        p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> visit[MAXK]= &#123;<span class="number">0</span>&#125;, bit[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span> <span class="params">(<span class="keyword">int</span> state, <span class="keyword">int</span> con)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K + <span class="number">1</span>; i ++)</span><br><span class="line">        father[i] = i, visit[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> st = state, i = K; i &gt; <span class="number">0</span>; i --, st /= <span class="number">10</span>)</span><br><span class="line">        bit[i] = st % <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= K; j ++) &#123;</span><br><span class="line">            <span class="keyword">int</span> fx = find (i), fy = find (j);</span><br><span class="line">            <span class="keyword">if</span> (bit[i] != bit[j] || fx == fy) <span class="keyword">continue</span>;</span><br><span class="line">            father[fx] = fy;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; j ++)</span><br><span class="line">        <span class="keyword">if</span> (con &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))) &#123;</span><br><span class="line">            <span class="keyword">int</span> fx = find (K + <span class="number">1</span>), fy = find (j);</span><br><span class="line">            <span class="keyword">if</span> (fx == fy) <span class="keyword">return</span> ;</span><br><span class="line">            father[fx] = fy;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">bool</span> fail = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= K + <span class="number">1</span>; i ++)</span><br><span class="line">        <span class="keyword">if</span> (find (<span class="number">1</span>) == find (i)) &#123;</span><br><span class="line">            fail = <span class="literal">false</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (fail) <span class="keyword">return</span> ; <span class="comment">// ä¹‹å‰çš„ç‚¹éƒ½è”é€š</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">        bit[i] = find (i + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">        <span class="keyword">if</span> (! visit[bit[i]])</span><br><span class="line">            visit[bit[i]] = ++ cnt;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">final</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++)</span><br><span class="line">        <span class="keyword">final</span> = <span class="keyword">final</span> * <span class="number">10</span> + visit[bit[i]];</span><br><span class="line">    g.a[mapp[state]][mapp[<span class="keyword">final</span>]] ++, g.a[mapp[state]][mapp[<span class="keyword">final</span>]] %= MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cnt[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prep</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123; <span class="comment">// i in [1, k]</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; j ++) cnt[j] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> st = allst[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; j ++, st /= <span class="number">10</span>)</span><br><span class="line">            cnt[st % <span class="number">10</span>] ++;</span><br><span class="line">    LL ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K &amp;&amp; cnt[j] &gt; <span class="number">0</span>; j ++)</span><br><span class="line">    ret = ret * power (cnt[j], cnt[j] - <span class="number">2</span>) % MOD;</span><br><span class="line">    f.a[<span class="number">1</span>][i] = ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> limit = (<span class="number">1</span> &lt;&lt; K) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) <span class="comment">// æšä¸¾å½“å‰ç‚¹åŠå…¶ä¸ä¹‹å‰çš„è¿é€šçŠ¶æ€</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> state = <span class="number">0</span>; state &lt;= limit; state ++)</span><br><span class="line">            maintain (allst[i], state);</span><br><span class="line">    <span class="comment">/*for (int i = 1; i &lt;= M; i ++) &#123;</span></span><br><span class="line"><span class="comment">        for (int j = 1; j &lt;= M; j ++)</span></span><br><span class="line"><span class="comment">            cout &lt;&lt; g.a[i][j] &lt;&lt; ' ';</span></span><br><span class="line"><span class="comment">        puts ("");</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; K &gt;&gt; N;</span><br><span class="line">    DFS (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>), prep ();</span><br><span class="line">    LL ans = matpower (N - K);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 5</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 23333333333333</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çŠ¶å‹DP </tag>
            
            <tag> çŸ©é˜µä¹˜æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒJSOI2012ã€åˆ†é›¶é£Ÿ</title>
      <link href="/2020/08/04/%5BJSOI2012%5D%E5%88%86%E9%9B%B6%E9%A3%9F/"/>
      <url>/2020/08/04/%5BJSOI2012%5D%E5%88%86%E9%9B%B6%E9%A3%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>é¦–å…ˆæ™®é€š $DP$ å¼å­å¾ˆå¥½åˆ—</p><p>ä»¤ $f[i][j]$ è¡¨ç¤º $i$ ä¸ªå°æœ‹å‹åˆ† $j$ ä¸ªç³–æœä¸”æ¯äººè‡³å°‘ä¸€é¢—çš„ç­”æ¡ˆï¼Œåˆ™æœ‰<br>$$<br>f[i][j] = \sum\limits_{k = 1}^j f[i - 1][j - k](Ok^2 + Sk + U)<br>$$<br>æ¥ä¸‹æ¥ç”¨ç”Ÿæˆå‡½æ•°ä¼˜åŒ–è¯¥å¼</p><p>ä»¤ $g[k] = Ok^2 + Sk + U$ï¼Œåˆ™<br>$$<br>f_i(x) = f_{i - 1}(x)g(x)<br>$$<br>å…¶ä¸­ $f_0(x) = 1$</p><p>æ‰€ä»¥ç­”æ¡ˆå³ä¸º<br>$$<br>[x^M] \sum\limits_{i = 0}^A f_i(x) = [x^M] \sum\limits_{i = 0}^A (g(x))^i = [x^M] \frac{1 - (g(x))^{A + 1}}{1 - g(x)}<br>$$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span> (- <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL MOD;</span><br><span class="line">LL O, S, U;</span><br><span class="line">LL a[MAXN]= &#123;<span class="number">0</span>&#125;, b[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mcomplex</span> &#123;</span></span><br><span class="line"><span class="keyword">double</span> a, b;</span><br><span class="line"></span><br><span class="line">mcomplex (<span class="keyword">double</span> fa = <span class="number">0.0</span>, <span class="keyword">double</span> fb = <span class="number">0.0</span>) :</span><br><span class="line">a (fa), b (fb) &#123;&#125;</span><br><span class="line"></span><br><span class="line">mcomplex <span class="keyword">operator</span> + (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (a + p.a, b + p.b);</span><br><span class="line">&#125;</span><br><span class="line">mcomplex <span class="keyword">operator</span> - (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (a - p.a, b - p.b);</span><br><span class="line">&#125;</span><br><span class="line">mcomplex <span class="keyword">operator</span> * (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (a * p.a - b * p.b, a * p.b + b * p.a);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span> <span class="params">(mcomplex* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">swap (a[i], a[oppo[i]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">mcomplex omega = mcomplex (<span class="built_in">cos</span> (PI / (<span class="keyword">double</span>) mid), inv * <span class="built_in">sin</span> (PI / (<span class="keyword">double</span>) mid));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">mcomplex x = mcomplex (<span class="number">1.0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * omega) &#123;</span><br><span class="line">mcomplex a1 = a[j + k], xa2 = x * a[j + mid + k];;</span><br><span class="line">a[j + k] = a1 + xa2;</span><br><span class="line">a[j + k + mid] = a1 - xa2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">aclimit</span> <span class="params">(<span class="keyword">int</span> maxl)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> n, lim;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>, lim = <span class="number">0</span>; n &lt;= maxl; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line">limit = n;</span><br><span class="line">&#125;</span><br><span class="line">mcomplex a1[MAXN &lt;&lt; <span class="number">2</span>], a2[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multiply</span> <span class="params">(LL* A, LL* B, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">aclimit (n + m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">a1[i] = a2[i] = mcomplex ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">a1[i] = mcomplex ((<span class="keyword">double</span>) A[i], <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i ++)</span><br><span class="line">a2[i] = mcomplex ((<span class="keyword">double</span>) B[i], <span class="number">0</span>);</span><br><span class="line">FFT (a1, <span class="number">1</span>), FFT (a2, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">a1[i] = a1[i] * a2[i];</span><br><span class="line">FFT (a1, - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n + m; i ++)</span><br><span class="line">A[i] = (LL) (a1[i].a / limit + <span class="number">0.5</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL inv[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL temp[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inverse</span> <span class="params">(<span class="keyword">int</span> deg, LL* A, LL* B)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (deg == <span class="number">1</span>) &#123;</span><br><span class="line">B[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">inverse ((deg + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, A, B);</span><br><span class="line">aclimit (deg &lt;&lt; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">temp[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">temp[i] = A[i];</span><br><span class="line">multiply (temp, B, deg, deg);</span><br><span class="line">multiply (temp, B, deg, deg);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; deg; i ++)</span><br><span class="line">B[i] = (<span class="number">2</span> * B[i] % MOD - temp[i] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL ans[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">power</span> <span class="params">(LL* A, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">ans[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">multiply (ans, a, M, M);</span><br><span class="line">multiply (a, a, M, M);</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">int</span> isneg = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>)</span><br><span class="line">isneg = <span class="number">1</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">M = getnum (), MOD = getnum (), N = getnum ();</span><br><span class="line">O = getnum (), S = getnum (), U = getnum ();</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">a[i] = (O * i * i + S * i + U) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++)</span><br><span class="line">b[i] = (- a[i] + MOD) % MOD;</span><br><span class="line">b[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">power (ans, N + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">ans[i] = (- ans[i] + MOD) % MOD;</span><br><span class="line">ans[<span class="number">0</span>] = (ans[<span class="number">0</span>] + <span class="number">1</span>) % MOD;</span><br><span class="line">inverse (M + <span class="number">1</span>, b, inv);</span><br><span class="line">multiply (ans, inv, M, M);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans[M] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 100</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒJLOI2013ã€åœ°å½¢ç”Ÿæˆ</title>
      <link href="/2020/08/04/%5BJLOI2013%5D%E5%9C%B0%E5%BD%A2%E7%94%9F%E6%88%90/"/>
      <url>/2020/08/04/%5BJLOI2013%5D%E5%9C%B0%E5%BD%A2%E7%94%9F%E6%88%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>æŒºæœ‰è¶£çš„ä¸€é“ $dp$ï¼Œä¸¤é—®å®é™…ä¸Šå°±ç›¸å½“äºæ˜¯ç¬¬ä¸€é—®æ˜¯ç¬¬äºŒé—®çš„éƒ¨åˆ†åˆ†</p><h4 id="ç¬¬ä¸€é—®"><a href="#ç¬¬ä¸€é—®" class="headerlink" title="ç¬¬ä¸€é—®"></a>ç¬¬ä¸€é—®</h4><p>ä¸€å¼€å§‹ä»¥ä¸ºè¦ $dp$ï¼Œç„¶è€Œå¹¶ä¸ç”¨</p><p>å¯¹äºè¿™ç§é«˜åº¦ç„¶åæ±‚æ–¹æ¡ˆæ•°çš„é¢˜ï¼Œå¯ä»¥åªè€ƒè™‘å…¶ç›¸å¯¹ä½ç½®ï¼Œå› ä¸ºåªè¦æ‰€æœ‰ç›¸å¯¹ä½ç½®ç¡®å®šäº†ï¼Œé‚£ä¹ˆæ•´ä¸ªåºåˆ—å°±å”¯ä¸€ç¡®å®šäº†</p><p>é¦–å…ˆè‚¯å®šè¦å…ˆå°†å®ƒä»¬ä»¥é«˜åº¦ä¸ºç¬¬ä¸€å…³é”®å­—ï¼ˆç”±å¤§åˆ°å°ï¼‰ï¼Œå…³é”®å€¼ä¸ºç¬¬äºŒå…³é”®å­—ï¼ˆä»å°åˆ°å¤§ï¼‰æ’åº</p><p>é‚£ä¹ˆå¯¹äºç¬¬ $i$ åº§å±±ï¼Œå®ƒå°±ä¼šæœ‰ $\min (i, key_i)$ ä¸ªç›¸å¯¹ä½ç½®å¯ä»¥å ï¼Œå› ä¸ºæœ‰ç›¸åŒé«˜åº¦çš„å±±å³°ï¼Œæ‰€ä»¥è¿˜ä¼šå¤šå‡º $same$ ï¼ˆ$i$ å‰é¢ä¸å…¶é«˜åº¦ç›¸åŒçš„å±±å³°çš„ä¸ªæ•°ï¼‰ä¸ªä½ç½®</p><p>é‚£ä¹ˆ $ans_1 = \prod\limits_{i = 1}^n min (i, key_i + same)$</p><h4 id="ç¬¬äºŒé—®"><a href="#ç¬¬äºŒé—®" class="headerlink" title="ç¬¬äºŒé—®"></a>ç¬¬äºŒé—®</h4><p>ç—‡ç»“è¿˜æ˜¯åœ¨äºç›¸åŒé«˜åº¦çš„å±±å³°ä¼šäº§ç”Ÿé‡å¤</p><p>ä½†æ˜¯æ˜¾ç„¶å¦‚æœä¸€æ¬¡æ€§ç¡®å®šå¥½æ‰€æœ‰ç›¸åŒå±±å³°çš„ä½ç½®æ˜¯ä¸ä¼šäº§ç”Ÿé‡å¤çš„ï¼Œæ•…è€ƒè™‘å°†æ¯ä¸€ç»„ç›¸åŒé«˜åº¦çš„å±±å³°æ”¾åœ¨ä¸€èµ·å¤„ç†</p><p>ä¸ºäº†é¿å…é‡å¤ï¼Œéœ€è¦å¼ºåˆ¶ä»¤è¿™äº›ç›¸åŒé«˜åº¦çš„å±±å³°æ”¾ç½®æœ‰åºï¼Œå³åæ”¾çš„ä¸€å®šåœ¨å…ˆæ”¾çš„åé¢ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä»¤ $f_{i, j}$ è¡¨ç¤ºï¼ˆå½“å‰ç»„ç›¸åŒé«˜åº¦å±±å³°ï¼‰å‰ $i$ ä¸ªæ”¾åœ¨å‰ $j$ ä¸ªä½ç½®ä¸Šï¼Œå¹¶ä¸”ç¬¬ $i$ æ”¾åœ¨ç¬¬ $j$ ä¸ªä½ç½®çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼ˆä¸‹ç¤ºæ–¹ç¨‹è¡¨ç¤ºåŒºé—´ $[l, r]$ çš„ç›¸åŒé«˜åº¦å±±å³°ç»„ï¼‰<br>$$<br>\begin{aligned}<br>f_{i, j} &amp;= \sum\limits_{k = 1}^j f_{i - 1, k}  (j \in [0, \min (l, key_i) - 1]) \\<br>&amp;= f_{i - 1, j} + f_{i, j - 1}<br>\end{aligned}<br>$$<br>ç„¶åå®é™…ä¸Šç¬¬ä¸€ç»´æ˜¯æ²¡ç”¨çš„ï¼Œå†çœæ‰å°±è¡Œäº†</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 2011</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL f[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hillSt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> high;</span><br><span class="line"><span class="keyword">int</span> key;</span><br><span class="line"></span><br><span class="line">hillSt (<span class="keyword">int</span> fhigh = <span class="number">0</span>, <span class="keyword">int</span> fkey = <span class="number">0</span>) :</span><br><span class="line">high (fhigh), key (fkey) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> hillSt&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (high == p.high)</span><br><span class="line"><span class="keyword">return</span> key &lt; p.key;</span><br><span class="line"><span class="keyword">return</span> high &gt; p.high;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">hillSt hill[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">hill[i].high = getnum (), hill[i].key = getnum ();</span><br><span class="line">sort (hill + <span class="number">1</span>, hill + N + <span class="number">1</span>);</span><br><span class="line">LL ans1 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> same = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">hill[i].high == hill[i - <span class="number">1</span>].high ? same ++ : same = <span class="number">0</span>;</span><br><span class="line">ans1 = ans1 * <span class="number">1l</span>l * min (i, hill[i].key + same) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL ans2 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= N; l ++) &#123;</span><br><span class="line"><span class="keyword">int</span> r;</span><br><span class="line"><span class="keyword">for</span> (r = l; r &lt;= N &amp;&amp; hill[r + <span class="number">1</span>].high == hill[r].high; r ++);</span><br><span class="line"><span class="built_in">memset</span> (f, <span class="number">0</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line">f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= min (l, hill[i].key) - <span class="number">1</span>; j ++)</span><br><span class="line">f[j] = (f[j - <span class="number">1</span>] + f[j]) % MOD;</span><br><span class="line">LL total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= min (l, hill[r].key) - <span class="number">1</span>; j ++)</span><br><span class="line">total = (total + f[j]) % MOD;</span><br><span class="line">ans2 = ans2 * total % MOD;</span><br><span class="line">swap (l, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans1 &lt;&lt; <span class="string">' '</span> &lt;&lt; ans2 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒHNOI2007ã€æ¢¦å¹»å²›å®ç  ã€Œå¥—è·¯ï¼šåˆ†å±‚DPã€</title>
      <link href="/2020/08/04/%5BHNOI2007%5D%E6%A2%A6%E5%B9%BB%E5%B2%9B%E5%AE%9D%E7%8F%A0%20%E3%80%8C%E5%A5%97%E8%B7%AF%EF%BC%9A%E5%88%86%E5%B1%82DP%E3%80%8D/"/>
      <url>/2020/08/04/%5BHNOI2007%5D%E6%A2%A6%E5%B9%BB%E5%B2%9B%E5%AE%9D%E7%8F%A0%20%E3%80%8C%E5%A5%97%E8%B7%AF%EF%BC%9A%E5%88%86%E5%B1%82DP%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>æ˜¾ç„¶ç›´æ¥ $01$ èƒŒåŒ…ä¼šè¶…æ—¶å¹¶ä¸”è¶…ç©ºé—´</p><p><strong>å¥—è·¯ï¼šåˆ†å±‚ $DP$</strong></p><p>ã€Œè€ƒè™‘å°†æ¯ä¸ªå­ç»“æ„çœ‹ä½œä¸€å±‚ï¼ˆä¹Ÿå°±æ˜¯åŒ…å«äº†ä¸æ­¢ $1$ ä¸ªç‰©å“çš„ä¿¡æ¯ï¼‰ï¼Œå¹¶ä¸”å¤§å±‚ä¸ä¼šå¯¹å°å±‚é€ æˆå½±å“ï¼Œå¯ä»¥è€ƒè™‘å…ˆè¿›è¡Œæ¯ä¸€å±‚çš„è‡ªæˆ‘æ›´æ–°ï¼ˆå³ç”¨å½“å‰å±‚ç‰©å“æ›´æ–°å½“å‰å±‚ç­”æ¡ˆï¼‰ï¼Œå†è¿›è¡Œå±‚çš„åˆå¹¶ï¼Œæ­¤æ—¶è€ƒè™‘ä½å±‚å¯¹é«˜å±‚çš„å½±å“ã€</p><p><strong>æ­£é¢˜</strong></p><p>é‚£ä¹ˆè¿™é¢˜æœ‰ä¸€ä¸ªç‰¹æ®Šæ€§è´¨ï¼š $V_i = a \times 2^b$</p><blockquote><p>bå€¼å¤§çš„ç‰©å“ä¸ä¼šå½±å“é›¶ç¢å‰©ä½™çš„é‡é‡ä¸Šé™ã€‚</p><p>å°†ç‰©å“æŒ‰bå€¼åˆ†é˜¶æ®µå¤„ç†ã€‚</p></blockquote><p>é‚£ä¹ˆå°±æ˜¯åˆ†å±‚ $DP$</p><p>å…ˆé€šè¿‡æ™®é€šçš„ $01$ èƒŒåŒ…æ›´æ–°å½“å‰å±‚è‡ªèº«æœ€ä¼˜è§£</p><p>å†è¿›è¡Œå±‚åˆå¹¶ï¼š</p><p>ä»¤ $g_{i, j}â€‹$ è¡¨ç¤ºç¬¬ $iâ€‹$ å±‚ï¼Œ$aâ€‹$ ä¸º $jâ€‹$ çš„æœ€ä¼˜è§£ï¼Œ$f_{i, j}â€‹$ è¡¨ç¤ºç¬¬ $iâ€‹$ å±‚ï¼Œ$aâ€‹$ ä¸º $jâ€‹$ï¼Œå¹¶ä¸”å†åŠ ä¸Š $V_{total}â€‹$ çš„ $1â€¦i - 1â€‹$ ä½çš„æœ€ä¼˜è§£</p><p>é‚£ä¹ˆå¯¹äºç¬¬ $i$ å±‚ï¼Œæšä¸¾å½“å‰ $j$</p><p>å¯¹äºè½¬ç§»ï¼Œæšä¸¾åœ¨è‡ªèº«å±‚å†…æ¶ˆè€—çš„ç©ºé—´ $(j - k) \times 2^i$ï¼Œé‚£ä¹ˆè¿˜å‰©ä¸‹ $k \times 2^i + V_{total}\{1â€¦i - 1\}$ çš„ç©ºé—´ï¼Œåˆ†é…ç»™ä¸Šä¸€å±‚ï¼Œé‚£ä¹ˆå¯å¾—è½¬ç§»æ–¹ç¨‹ä¸º</p><p>ï¼ˆæ³¨ï¼š$w_i$ è¡¨ç¤º $V_{total}$ ç¬¬ $i$ ä½ï¼‰<br>$$<br>f_{i, j} = \max \{g_{i, j - k} + f_{i - 1, 2k + w_i}\}<br>$$<br>åŒæ—¶ï¼Œ$g_{i, j}$ å¯ä»¥é€šè¿‡ç”±å¤§åˆ°å°æšä¸¾æ¥æ¶ˆé™¤</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">30</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line">LL f[MAXN][MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">int</span> isneg = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">'-'</span>)</span><br><span class="line">isneg = <span class="number">1</span>;</span><br><span class="line">ch = getchar ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (~ (N = getnum ())) &#123;</span><br><span class="line">M = getnum ();</span><br><span class="line"><span class="built_in">memset</span> (f, <span class="number">0</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> vol = getnum (), value = getnum ();</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (! (vol &amp; <span class="number">1</span>))</span><br><span class="line">vol &gt;&gt;= <span class="number">1</span>, b ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1000</span>; j &gt;= vol; j --)</span><br><span class="line">f[b][j] = max (f[b][j], f[b][j - vol] + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> xm = M, maxb = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (xm)</span><br><span class="line">xm &gt;&gt;= <span class="number">1</span>, maxb ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= maxb; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1000</span>; j ++)</span><br><span class="line">f[i][j] = max (f[i][j], f[i][j - <span class="number">1</span>]);</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxb; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = min (<span class="number">1000</span>, M &gt;&gt; i); j &gt;= <span class="number">0</span>; j --) <span class="comment">// æ³¨æ„æ­¤å¤„ä¸Šé™æ˜¯ min (100, M &gt;&gt; i)ï¼ŒM &gt;&gt; i ä¿è¯ä¸ä¼šå°†é«˜ä½æ‹¿å¤šäº†</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= j; k ++) &#123;</span><br><span class="line">f[i][j] = max (f[i][j], f[i][j - k] + f[i - <span class="number">1</span>][min ((k &lt;&lt; <span class="number">1</span>) + ((M &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>), <span class="number">1000</span>)]);</span><br><span class="line">ans = max (ans, f[i][j]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 10</span></span><br><span class="line"><span class="comment">8 9</span></span><br><span class="line"><span class="comment">5 8</span></span><br><span class="line"><span class="comment">4 6</span></span><br><span class="line"><span class="comment">2 5</span></span><br><span class="line"><span class="comment">-1 -1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 10</span></span><br><span class="line"><span class="comment">8 9</span></span><br><span class="line"><span class="comment">5 8</span></span><br><span class="line"><span class="comment">4 6</span></span><br><span class="line"><span class="comment">2 5</span></span><br><span class="line"><span class="comment">4 13</span></span><br><span class="line"><span class="comment">8 9</span></span><br><span class="line"><span class="comment">5 8</span></span><br><span class="line"><span class="comment">4 6</span></span><br><span class="line"><span class="comment">2 5</span></span><br><span class="line"><span class="comment">16 75594681</span></span><br><span class="line"><span class="comment">393216 5533</span></span><br><span class="line"><span class="comment">2 77</span></span><br><span class="line"><span class="comment">32768 467</span></span><br><span class="line"><span class="comment">29360128 407840</span></span><br><span class="line"><span class="comment">112 68</span></span><br><span class="line"><span class="comment">24576 372</span></span><br><span class="line"><span class="comment">768 60</span></span><br><span class="line"><span class="comment">33554432 466099</span></span><br><span class="line"><span class="comment">16384 318</span></span><br><span class="line"><span class="comment">33554432 466090</span></span><br><span class="line"><span class="comment">2048 111</span></span><br><span class="line"><span class="comment">24576 350</span></span><br><span class="line"><span class="comment">9216 216</span></span><br><span class="line"><span class="comment">12582912 174768</span></span><br><span class="line"><span class="comment">16384 295</span></span><br><span class="line"><span class="comment">1024 76</span></span><br><span class="line"><span class="comment">-1 -1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å±‚DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒFJOI2016ã€å»ºç­‘å¸ˆ</title>
      <link href="/2020/08/04/%5BFJOI2016%5D%E5%BB%BA%E7%AD%91%E5%B8%88/"/>
      <url>/2020/08/04/%5BFJOI2016%5D%E5%BB%BA%E7%AD%91%E5%B8%88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>è¿™é¢˜ä¸€ç›´å¾€ $\text{dp}$ å»æƒ³ï¼Œç„¶åå°±æ²¡äº†</p><p>æ‰€ä»¥å…¶å®å¹¶ä¸ç”¨æ³¨æ„ä¹‹å‰çš„å¯çœ‹è§çš„å»ºç­‘çš„æœ€å¤§å€¼æ˜¯å¤šå°‘ï¼Œè‹¥æŠŠé‚£äº›èƒ½å¤Ÿè¢«çœ‹è§çš„å»ºç­‘ä¹‹é—´æ„æˆçš„åŒºé—´çœ‹ä½œä¸€ä¸ªå°ç»„ï¼Œé‚£ä¹ˆèƒ½å¤Ÿè¢«çœ‹è§çš„å»ºç­‘ä¸è¿‡æ˜¯åœ¨å½“å‰å°ç»„ä¸­é€‰æ‹©ä¸€ä¸ªæœ€å¤§å€¼æœ€ä¸ºä»£è¡¨æ’åœ¨å·¦ï¼ˆå³ï¼‰è¾¹ç½¢äº†</p><p>æ‰€ä»¥ç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºå°† $n - 1$ ä¸ªå»ºç­‘åˆ†åœ¨ $A + B - 2$ ä¸ªç›’å­ï¼Œç„¶åç›’å­å†…å¯ä»¥éšæ„æ’åˆ—çš„ä¸ªæ•°</p><p>ç„¶åä¸Šè¿°é—®é¢˜å®é™…ä¸Šå¯ä»¥å°†æ¯ä¸ªç›’å­çœ‹ä½œä¸€ä¸ªåœ†ï¼Œæ•…é—®é¢˜åˆè½¬åŒ–ä¸º $n - 1$ ä¸ªå»ºç­‘æ„æˆçš„ $A + B - 2$ ä¸ªåœ†æ’åˆ—æ–¹æ¡ˆæ•°ï¼Œå³æ–¯ç‰¹æ—æ•° $S (n - 1, A + B - 2)$</p><p>ç„¶åè¦åœ¨å…¶ä¸­é€‰æ‹©ä¸€äº›æ”¾å·¦ï¼ˆå³ï¼‰è¾¹ï¼Œæ•…ç­”æ¡ˆå³ä¸º<br>$$<br>ans = S (n - 1, A + B - 2) \times \dbinom{A + B - 2}{A - 1}<br>$$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e04</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXAB = <span class="number">200</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> n, A, B;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NMAX = <span class="number">5e04</span>, ABMAX = <span class="number">200</span>;</span><br><span class="line">LL S[MAXN][MAXAB]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL fact[MAXAB]= &#123;<span class="number">0</span>&#125;, invfact[MAXAB]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">S[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= NMAX; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= min (i, ABMAX); j ++)</span><br><span class="line">S[i][j] = (S[i - <span class="number">1</span>][j - <span class="number">1</span>] + S[i - <span class="number">1</span>][j] * (i - <span class="number">1</span>) % MOD) % MOD;</span><br><span class="line">fact[<span class="number">0</span>] = fact[<span class="number">1</span>] = invfact[<span class="number">0</span>] = invfact[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= ABMAX; i ++) &#123;</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[i] = (MOD - MOD / i) * invfact[MOD % i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ABMAX; i ++)</span><br><span class="line">invfact[i] = invfact[i - <span class="number">1</span>] * invfact[i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">init ();</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line">n = getnum (), A = getnum (), B = getnum ();</span><br><span class="line">LL ans = S[n - <span class="number">1</span>][A + B - <span class="number">2</span>] * C (A + B - <span class="number">2</span>, A - <span class="number">1</span>) % MOD;</span><br><span class="line">write (ans), <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3 2 2</span></span><br><span class="line"><span class="comment">3 1 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»„åˆæ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒCTSC2008ã€ç¥­ç¥€ï¼ˆDAGæœ€é•¿åé“¾åŠå…¶æ–¹æ¡ˆæ„é€ ï¼‰</title>
      <link href="/2020/08/04/%5BCTSC2008%5D%E7%A5%AD%E7%A5%80%EF%BC%88DAG%E6%9C%80%E9%95%BF%E5%8F%8D%E9%93%BE%E5%8F%8A%E5%85%B6%E6%96%B9%E6%A1%88%E6%9E%84%E9%80%A0%EF%BC%89/"/>
      <url>/2020/08/04/%5BCTSC2008%5D%E7%A5%AD%E7%A5%80%EF%BC%88DAG%E6%9C%80%E9%95%BF%E5%8F%8D%E9%93%BE%E5%8F%8A%E5%85%B6%E6%96%B9%E6%A1%88%E6%9E%84%E9%80%A0%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æ±‚ä¸€ä¸ª $n$ ç‚¹ $m$ è¾¹çš„ $DAG$ çš„æœ€é•¿åé“¾ï¼Œåœ¨ç¬¬äºŒè¡Œè¾“å‡ºæ„é€ çš„å…¶ä¸­ä¸€ç§æ–¹æ¡ˆï¼Œåœ¨ç¬¬ä¸‰è¡Œè¾“å‡ºåœ¨ä¿è¯æœ€é•¿åé“¾çš„å‰æä¸‹ï¼Œæ¯ä¸ªç‚¹æ˜¯å¦èƒ½å¤Ÿè®¾ç½®ä¸ºåé“¾ä¸­çš„ç‚¹</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>åæ­£è¯æ˜ä¹Ÿä¸ä¼šï¼Œå°±è®°å½•ä¸€ä¸‹å…·ä½“æ–¹æ³•</p><blockquote><p>æœ€é•¿åé“¾ï¼šå¯¹ $DAG$ ç‚¹é›† $V$ï¼Œæœ€é•¿åé“¾ä¸ºä¸€ä¸ªé›†åˆ $S \subseteq V$ï¼Œæ»¡è¶³ $\forall u \in S, v \in S$ï¼Œ$u$ ä¸èƒ½åˆ°è¾¾ $v$ï¼Œ$v$ ä¹Ÿä¸èƒ½åˆ°è¾¾ $u$</p></blockquote><p>æ ¹æ® $\text{Dilworth}$ å®šç†ï¼Œä¸€ä¸ª $DAG$ çš„æœ€é•¿åé“¾å¤§å°ç­‰äºå…¶æœ€å°å¯é‡é“¾è¦†ç›–å¤§å°</p><p>å¯¹ $DAG$ ä¼ é€’é—­åŒ…åï¼Œæœ€å°å¯é‡é“¾è¦†ç›–å¤§å°å¯è½¬åŒ–ä¸ºæœ€å°<strong>ä¸</strong>å¯é‡é“¾è¦†ç›–å¤§å°ï¼Œå³æœ€å°è·¯å¾„ç‚¹è¦†ç›–</p><blockquote><p>æœ€å°è·¯å¾„ç‚¹è¦†ç›–ï¼šå°† $DAG$ ç”¨è‹¥å¹²ä¸ç›¸äº¤çš„é“¾è¦†ç›–ï¼Œå³æ¯ä¸ªç‚¹æœ€å¤šè¢«ç»è¿‡ä¸€æ¬¡ï¼Œæœ€å°ä½¿ç”¨é“¾çš„ä¸ªæ•°</p></blockquote><p>é‚£ä¹ˆæœ€å°å¯é‡é“¾è¦†ç›–åˆ™æ˜¯ç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„ä»…åœ¨äºæ¯ä¸ªç‚¹å¯è¢«ç»è¿‡å¤šæ¬¡</p><blockquote><p>æœ€å°è·¯å¾„ç‚¹è¦†ç›–å¤§å° $=$ $n$ $-$ è¯¥ $DAG$ æ‹†ç‚¹äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…å¤§å°</p></blockquote><p>é‚£ä¹ˆ $\text{Subtask1}$ å°±åšå®Œäº†</p><p>æŠŠ $DAG$ æ‹†ç‚¹åæœ€å°è·¯å¾„ç‚¹è¦†ç›–å°±ç›¸å½“äºæ˜¯æ±‚è¯¥æ‹†ç‚¹äºŒåˆ†å›¾çš„æœ€å¤§ç‹¬ç«‹é›†</p><p>æ¥ä¸‹æ¥å¼€å§‹æ„é€ æ–¹æ¡ˆ</p><ul><li>æ‰¾åˆ°æ‹†ç‚¹äºŒåˆ†å›¾ä¸­å³ä¾§çš„æ‰€æœ‰éåŒ¹é…ç‚¹</li><li>ç”±è¿™äº›éåŒ¹é…ç‚¹å‡ºå‘ï¼Œå³ä¾§ç‚¹åªèµ°éåŒ¹é…è¾¹ï¼Œå·¦ä¾§ç‚¹åªèµ°åŒ¹é…è¾¹</li><li>é‚£ä¹ˆä¸€ç§æœ€å°ç‚¹è¦†ç›–çš„åˆæ³•æ–¹æ¡ˆå°±æ˜¯å–å·¦ä¾§ä¸­è¢« $DFS$ åˆ°çš„ç‚¹ï¼Œå³ä¾§ä¸­æ²¡è¢« $DFS$ åˆ°çš„ç‚¹</li><li>é‚£ä¹ˆè¯¥æ‹†ç‚¹äºŒåˆ†å›¾çš„æœ€å¤§ç‹¬ç«‹é›†çš„ä¸€ç§åˆæ³•æ–¹æ¡ˆæ„é€ å°±æ˜¯ä¸Šè¿°æ„é€ çš„è¡¥é›†</li></ul><p>è¿™æ ·å°±æ±‚å‡ºäº†æœ€å°è·¯å¾„ç‚¹è¦†ç›–çš„ä¸€ç§æ–¹æ¡ˆï¼Œå³æœ€é•¿åé“¾çš„ä¸€ç§æ„é€ </p><p>é‚£ä¹ˆ $\text{Subtask2}$ å°±åšå®Œäº†</p><p>å¯¹ $\text{Subtask3}$ï¼Œæšä¸¾æ¯ä¸ªç‚¹ï¼Œå°†å®ƒä¼šåˆ°è¾¾çš„ç‚¹å’Œä¼šåˆ°è¾¾å®ƒçš„ç‚¹åˆ æ‰ï¼Œå¼ºåˆ¶å‡å¦‚è¯¥ç‚¹ï¼Œå†è·‘ä¸€éæœ€é•¿åé“¾ï¼Œè‹¥å…¶å¾—åˆ°æœ€é•¿åé“¾é•¿åº¦ç­‰äºåŸç­”æ¡ˆå‡ä¸€ï¼Œåˆ™è¯´æ˜è¯¥ç‚¹å¯ä»¥è¢«è®¾ç½®ä¸ºåé“¾ä¸­çš„ç‚¹</p><p>é‚£ä¹ˆ $\text{Subtask3}$ å°±åšå®Œäº†</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">2</span> * MAXN + MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="built_in">bitset</span>&lt;MAXN&gt; g[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, cap, next; &#125; ;</span><br><span class="line">LFS Link[MAXL &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;, size = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].cap = cap;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">Insert (x, y, cap); Insert (y, x, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> S, T, _N;</span><br><span class="line"><span class="keyword">int</span> depth[MAXN &lt;&lt; <span class="number">1</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) que.pop();</span><br><span class="line"><span class="built_in">memset</span> (depth, <span class="number">0</span>, <span class="keyword">sizeof</span> (depth));</span><br><span class="line">depth[S] = <span class="number">1</span>, que.push(S);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] || ! cap) <span class="keyword">continue</span>;</span><br><span class="line">depth[v] = depth[u] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (v == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cur[MAXL]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> flow)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (p == T) <span class="keyword">return</span> flow;</span><br><span class="line"><span class="keyword">int</span> rest = flow;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> &amp;i = cur[p]; i &amp;&amp; rest; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, cap = Link[i].cap;</span><br><span class="line"><span class="keyword">if</span> (depth[v] != depth[p] + <span class="number">1</span> || ! cap) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> k = Dinic (v, min (cap, rest));</span><br><span class="line"><span class="keyword">if</span> (! k) depth[v] = - <span class="number">1</span>;</span><br><span class="line">Link[i].cap -= k, Link[i ^ <span class="number">1</span>].cap += k;</span><br><span class="line">rest -= k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow - rest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">MAXFLOW</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (BFS ()) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= _N; i ++) cur[i] = Head[i];</span><br><span class="line">ret += Dinic (S, INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> match[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Subtask2</span></span><br><span class="line"><span class="keyword">bool</span> tagl[MAXN]= &#123;<span class="literal">false</span>&#125;, tagr[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">tagr[u - N] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][u - N] &amp;&amp; ! tagl[i]) &#123;</span><br><span class="line">tagl[i] = <span class="literal">true</span>;</span><br><span class="line">DFS (match[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Subtask3</span></span><br><span class="line"><span class="keyword">bool</span> del[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">g[u][v] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][k])</span><br><span class="line">g[i] |= g[k];</span><br><span class="line">S = <span class="number">2</span> * N + <span class="number">1</span>, _N = T = <span class="number">2</span> * N + <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">add (S, i, <span class="number">1</span>), add (i + N, T, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][j])</span><br><span class="line">add (i, j + N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> ans = N - MAXFLOW ();</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! Link[<span class="number">4</span> * i - <span class="number">2</span>].cap)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = Head[i]; j; j = Link[j].next)</span><br><span class="line"><span class="keyword">if</span> (! Link[j].cap) &#123;</span><br><span class="line">match[i] = Link[j].to;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (Link[<span class="number">4</span> * i].cap)</span><br><span class="line">DFS (i + N);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) <span class="built_in">printf</span> (<span class="string">"%d"</span>, ! tagl[i] &amp;&amp; tagr[i]);</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">memset</span> (Head, <span class="number">0</span>, <span class="keyword">sizeof</span> (Head)); size = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">memset</span> (del, <span class="literal">false</span>, <span class="keyword">sizeof</span> (del));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (i == j || g[i][j] || g[j][i])</span><br><span class="line">del[j] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! del[i]) &#123;</span><br><span class="line">add (S, i, <span class="number">1</span>), add (i + N, T, <span class="number">1</span>);</span><br><span class="line">m ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! del[i])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line"><span class="keyword">if</span> (g[i][j] &amp;&amp; ! del[j])</span><br><span class="line">add (i, j + N, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> ret = m - MAXFLOW ();</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, ret == ans - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒåˆ†å›¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒCodeforces Round 558 (Div. 2).Fã€Indecisive Taxi Fee</title>
      <link href="/2020/08/04/%5BCodeforces%20Round%20#558%20(Div.%202).F%5DIndecisive%20Taxi%20Fee/"/>
      <url>/2020/08/04/%5BCodeforces%20Round%20#558%20(Div.%202).F%5DIndecisive%20Taxi%20Fee/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>é¢˜æ„å³ä¸ºå¸¦ä¿®ï¼ˆä¸´æ—¶ï¼‰æœ€çŸ­è·¯</p><p>å…ˆéšä¾¿æä¸€æ¡æœ€çŸ­è·¯å‡ºæ¥ï¼Œé‚£ä¹ˆä¿®æ”¹å¯åˆ†ä¸ºå››ç§æƒ…å†µï¼š</p><ul><li>è¯¥è¾¹åœ¨æœ€çŸ­è·¯ä¸Šï¼Œä¸”æ•°å€¼å˜å°</li><li>è¯¥è¾¹åœ¨æœ€çŸ­è·¯ä¸Šï¼Œä¸”æ•°å€¼å˜å¤§</li><li>è¯¥è¾¹åœ¨æœ€çŸ­è·¯å¤–ï¼Œä¸”æ•°å€¼å˜å°</li><li>è¯¥è¾¹åœ¨æœ€çŸ­è·¯å¤–ï¼Œä¸”æ•°å€¼å˜å¤§</li></ul><p>é‚£ä¹ˆå¯¹äºæƒ…å†µ $1, 3, 4$ï¼Œæ˜¾ç„¶æ˜¯ååˆ†å®¹æ˜“å¤„ç†çš„ï¼Œé‚£ä¹ˆé—®é¢˜å°±åœ¨æƒ…å†µ $2$</p><p>è®¾æœ€çŸ­è·¯ç»è¿‡ç‚¹ $e_1, e_2, e_3, â€¦$</p><p>è€ƒè™‘åˆ°æ–°çš„æœ€çŸ­è·¯å¿…å®šä¸åŸæœ€çŸ­è·¯æœ‰ç›¸åŒçš„ä¸€æ®µå‰ç¼€ä¸åç¼€ï¼ˆå¯ä»¥ä¸ºç©ºï¼‰ï¼Œè®¾ $dis2_{i, j} (i &lt; j)$ è¡¨ç¤ºä¸ç»è¿‡è·¯å¾„ $e_ie_j$ çš„æœ€çŸ­è·¯ï¼Œæ‰€ä»¥ç­”æ¡ˆå³ä¸º $\min \{dis2 (e_ie_j) (i &lt; j)\}$</p><p>é‚£ä¹ˆä¾¿ä¸¤é $Dijstra$ åˆ†åˆ«æ±‚å‡º $1, n$ åˆ°æ¯ä¸ªç‚¹ $p$ çš„æœ€çŸ­è·¯ $pre_p, suf_p$ï¼Œå¹¶ä¸”å¯¹äºæœ€çŸ­è·¯ä¸Šçš„ç‚¹ $e_i$ï¼Œæ±‚å‡ºå…¶åœ¨æœ€çŸ­è·¯ä¸Šçš„å‰é©±è¾¹ $from_{e_i}$ ä¸åç»§è¾¹ $nxt_{e_i}$ï¼Œå¯¹äºæ¯ä¸ªä¸åœ¨æœ€çŸ­è·¯ä¸Šçš„ç‚¹ $p$ï¼Œæ±‚å‡ºç‚¹ $1$ è‡³ $p$ ä¸­æœ€åä¸€ä¸ªåœ¨åŸæœ€çŸ­è·¯ä¸Šçš„ç‚¹çš„åç»§è¾¹ $from_p$ åŠç‚¹ $p$ è‡³ $n$ ä¸­ç¬¬ä¸€ä¸ªåœ¨åŸæœ€çŸ­è·¯ä¸Šçš„ç‚¹çš„åç»§è¾¹ $nxt_p$ï¼Œæ•…å¯¹äºæ¯ä¸ªä¸åœ¨æœ€çŸ­è·¯ä¸Šçš„è¾¹ $(u, v)$ï¼Œå®ƒå¯ä»¥å¯¹ $dis2 (from_u, nxt_v - 1), dis2 (from_v, nxt_u - 1)$ åšè´¡çŒ®ï¼Œç„¶åç”¨çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹å°±å¥½äº†</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>è¦æ³¨æ„ä¸‹åˆ—ä»£ç å¯¹äºæœ€çŸ­è·¯ä¸Šçš„ç‚¹ $e_i$ å…¶ $from_{e_i}$ å®é™…ä¸Šæ˜¯åç»§è¾¹ï¼Œè¿™æ ·å­ä¿®æ”¹çš„åŒºé—´æ‰æ˜¯å¯¹çš„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"><span class="keyword">int</span> w, id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].w = w;</span><br><span class="line">Link[size].id = id;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> p;</span><br><span class="line">LL dist;</span><br><span class="line"></span><br><span class="line">node (<span class="keyword">int</span> fp = <span class="number">0</span>, LL fdist = <span class="number">0</span>) :</span><br><span class="line">p (fp), dist (fdist) &#123;&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> dist &gt; p.dist;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">priority_queue&lt;node&gt; heap;</span><br><span class="line">LL dist[<span class="number">3</span>][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> from[MAXN]= &#123;<span class="number">0</span>&#125;, nxt[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> occp[MAXN]= &#123;<span class="literal">false</span>&#125;; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> S)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">dist[p][i] = INF, visit[i] = <span class="literal">false</span>;</span><br><span class="line">dist[p][S] = <span class="number">0</span>, heap.push(node (S, <span class="number">0</span>));</span><br><span class="line"><span class="keyword">while</span> (! heap.empty()) &#123;</span><br><span class="line">node top = heap.top();</span><br><span class="line">heap.pop();</span><br><span class="line"><span class="keyword">int</span> u = top.p;</span><br><span class="line">LL d = top.dist;</span><br><span class="line"><span class="keyword">if</span> (visit[u]) <span class="keyword">continue</span>;</span><br><span class="line">visit[u] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (d + w &lt; dist[p][v]) &#123;</span><br><span class="line">dist[p][v] = d + w;</span><br><span class="line"><span class="keyword">if</span> (p == <span class="number">2</span>) from[v] = i;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (p == <span class="number">0</span> &amp;&amp; ! occp[v]) from[v] = from[u];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (p == <span class="number">1</span> &amp;&amp; ! occp[v]) nxt[v] = nxt[u];</span><br><span class="line">heap.push(node (v, dist[p][v]));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> path[MAXM]= &#123;<span class="number">0</span>&#125;, pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deal</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">1</span>; v != N;) &#123;</span><br><span class="line"><span class="keyword">int</span> ps = Link[from[v]].id;</span><br><span class="line">path[ps] = ++ pcnt, occp[v] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> nxn = Link[from[v] ^ <span class="number">1</span>].to;</span><br><span class="line">from[v] = nxt[v] = pcnt; <span class="comment">// attention</span></span><br><span class="line">v = nxn;</span><br><span class="line">&#125;</span><br><span class="line">occp[N] = <span class="literal">true</span>;</span><br><span class="line">from[N] = nxt[N] = pcnt + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL minv[MAXN &lt;&lt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">minv[root] = INF;</span><br><span class="line"><span class="keyword">if</span> (left == right) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">build (lson, left, mid), build (rson, mid + <span class="number">1</span>, right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R, LL delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> ( L &gt; R) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R) &#123;</span><br><span class="line">minv[root] = min (minv[root], delta);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) modify (lson, left, mid, L, R, delta);</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) modify (rson, mid + <span class="number">1</span>, right, L, R, delta);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right)</span><br><span class="line"><span class="keyword">return</span> minv[root];</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) <span class="keyword">return</span> min (minv[root], query (lson, left, mid, posi));</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> min (minv[root], query(rson, mid + <span class="number">1</span>, right, posi));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum (), Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line"><span class="keyword">int</span> w = getnum ();</span><br><span class="line">Insert (u, v, w, i), Insert (v, u, w, i);</span><br><span class="line">&#125;</span><br><span class="line">Dijkstra (<span class="number">2</span>, N), deal ();</span><br><span class="line">Dijkstra (<span class="number">0</span>, <span class="number">1</span>), Dijkstra (<span class="number">1</span>, N);</span><br><span class="line">build (<span class="number">1</span>, <span class="number">1</span>, pcnt);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= size; i += <span class="number">2</span>) &#123;</span><br><span class="line"><span class="keyword">int</span> u = Link[i].to, v = Link[i ^ <span class="number">1</span>].to;</span><br><span class="line"><span class="keyword">int</span> w = Link[i].w;</span><br><span class="line"><span class="keyword">if</span> (path[Link[i].id]) <span class="keyword">continue</span>;</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, pcnt, from[u], nxt[v] - <span class="number">1</span>, dist[<span class="number">0</span>][u] + dist[<span class="number">1</span>][v] + w);</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, pcnt, from[v], nxt[u] - <span class="number">1</span>, dist[<span class="number">0</span>][v] + dist[<span class="number">1</span>][u] + w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> cur = getnum () &lt;&lt; <span class="number">1</span>, delta = getnum ();</span><br><span class="line"><span class="keyword">int</span> u = Link[cur].to, v = Link[cur ^ <span class="number">1</span>].to;</span><br><span class="line"><span class="keyword">int</span> w = Link[cur].w;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (path[Link[cur].id]) ans = min (dist[<span class="number">0</span>][N] - w + delta, query (<span class="number">1</span>, <span class="number">1</span>, pcnt, path[Link[cur].id]));</span><br><span class="line"><span class="keyword">else</span> ans = min (dist[<span class="number">0</span>][N], min (dist[<span class="number">0</span>][u] + dist[<span class="number">1</span>][v] + delta, dist[<span class="number">0</span>][v] + dist[<span class="number">1</span>][u] + delta));</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%I64d\n"</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5 6</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">2 4 3</span></span><br><span class="line"><span class="comment">1 4 7</span></span><br><span class="line"><span class="comment">1 3 1</span></span><br><span class="line"><span class="comment">3 4 5</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">5 1</span></span><br><span class="line"><span class="comment">3 8</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 4 4</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">1 2 3</span></span><br><span class="line"><span class="comment">1 2 4</span></span><br><span class="line"><span class="comment">1 2 5</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">4 3</span></span><br><span class="line"><span class="comment">1 5</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 1 1</span></span><br><span class="line"><span class="comment">1 2 1</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœ€çŸ­è·¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒCERC2014ã€Outer space invaders</title>
      <link href="/2020/08/04/%5BCERC2014%5DOuter%20space%20invaders/"/>
      <url>/2020/08/04/%5BCERC2014%5DOuter%20space%20invaders/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®š $n$ ä¸ªçº¿æ®µï¼Œæ¯ä¸ªçº¿æ®µæœ‰ä¸€ä¸ªæƒå€¼ $w_i$ï¼Œæ¯æ¬¡å–è½´ä¸Šä¸€ç‚¹ï¼Œè·å¾—çš„æƒå€¼ä¸ºé€‰æ‹©çš„è¦†ç›–åœ¨å½“å‰ç‚¹ä¸Šçš„çº¿æ®µçš„æœ€å¤§æƒå€¼ï¼Œæ±‚æœ€ç»ˆè¦†ç›–æ‰€æœ‰çº¿æ®µåéœ€è¦çš„æœ€å°æƒå€¼</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å¥½å§æ˜¯ä¸€é“éå¸¸æ°´çš„åŒºé—´ $dp$ ç„¶è€Œæˆ‘å¹¶æ²¡æœ‰æƒ³å‡ºæ¥æ‰€ä»¥æˆ‘æ˜¯çœŸçš„ç»æœ›</p><p>å…ˆæŠŠ $l_i, r_i$ ç¦»æ•£åŒ–åä»¤ $f_{l, r}$ è¡¨ç¤º<strong>å®Œå…¨è¦†ç›–</strong>åŒºé—´ $[l, r]$ çš„çº¿æ®µçš„æœ€å°æƒå€¼ï¼Œè®¾å®Œå…¨å¤„äº $[l, r]$ çš„çº¿æ®µä¸­æƒå€¼å–æœ€å¤§å€¼çš„çº¿æ®µ $p$ï¼Œåˆ™æœ‰è½¬ç§»æ–¹ç¨‹<br>$$<br>f_{l, r} = \min \{f_{l, k - 1} + f_{k + 1, r} + w_p\} (l_p \le k \le r_p)<br>$$<br>æ‰€ä»¥æ³¨æ„ä¸€å®šè¦å®Œå…¨è¦†ç›–ï¼Œ$[l, k - 1], [k + 1, r]$ æ‰ä¸ä¼šå¯¹ $[l, r]$ é€ æˆå½±å“ï¼Œäºæ˜¯æˆ‘å°±å¡è¿™å„¿äº†</p><p>è°¨ä»¥æ­¤æ–‡çºªå¿µæˆ‘é€å»çš„æ™ºå•†</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">600</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> l[MAXN], r[MAXN], value[MAXN];</span><br><span class="line"><span class="keyword">int</span> vcol[MAXN &lt;&lt; <span class="number">1</span>], vcnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; Case ++) &#123;</span><br><span class="line">N = getnum ();</span><br><span class="line">vcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">l[i] = getnum (), r[i] = getnum (), value[i] = getnum ();</span><br><span class="line">vcol[++ vcnt] = l[i], vcol[++ vcnt] = r[i];</span><br><span class="line">&#125;</span><br><span class="line">sort (vcol + <span class="number">1</span>, vcol + vcnt + <span class="number">1</span>);</span><br><span class="line">vcnt = unique (vcol + <span class="number">1</span>, vcol + vcnt + <span class="number">1</span>) - vcol - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">l[i] = lower_bound (vcol + <span class="number">1</span>, vcol + vcnt + <span class="number">1</span>, l[i]) - vcol;</span><br><span class="line">r[i] = lower_bound (vcol + <span class="number">1</span>, vcol + vcnt + <span class="number">1</span>, r[i]) - vcol;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">2</span>; len &lt;= vcnt; len ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= vcnt - len + <span class="number">1</span>; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> j = i + len - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> maxv = - <span class="number">1</span>, sl, sr;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k ++)</span><br><span class="line"><span class="keyword">if</span> (i &lt;= l[k] &amp;&amp; r[k] &lt;= j) <span class="comment">// å®Œå…¨è¦†ç›–</span></span><br><span class="line"><span class="keyword">if</span> (value[k] &gt; maxv) &#123;</span><br><span class="line">maxv = value[k];</span><br><span class="line">sl = l[k], sr = r[k];</span><br><span class="line">&#125;</span><br><span class="line">f[i][j] = maxv == - <span class="number">1</span> ? <span class="number">0</span> : INF;</span><br><span class="line"><span class="keyword">if</span> (maxv != - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = sl; k &lt;= sr; k ++)</span><br><span class="line">f[i][j] = min (f[i][j], f[i][k - <span class="number">1</span>] + f[k + <span class="number">1</span>][j] + maxv);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, f[<span class="number">1</span>][vcnt]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 4 4</span></span><br><span class="line"><span class="comment">4 7 5</span></span><br><span class="line"><span class="comment">3 4 7</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒºé—´DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŒAPIO2013ã€æœºå™¨äºº</title>
      <link href="/2020/08/04/%5BAPIO2013%5D%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
      <url>/2020/08/04/%5BAPIO2013%5D%E6%9C%BA%E5%99%A8%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>é¦–å…ˆå› ä¸ºç‚¹æ•°ä¸å¤šï¼Œå¯ä»¥è€ƒè™‘å…ˆåœ¨ $4r \times c$ æ—¶é—´å†…å°†æ¯ä¸ªç‚¹æœæ¯ä¸ªæ–¹å‘å¯ä»¥åˆ°è¾¾çš„ä½ç½®é¢„å¤„ç†å‡ºæ¥ï¼Œå»ºæˆå›¾</p><p>é‚£ä¹ˆç°åœ¨å®¹æ˜“çœ‹å‡ºæ˜¯æ–¯å¦é‚£æ ‘é—®é¢˜ï¼Œæ‰€ä»¥è€ƒè™‘å°†é—®é¢˜ç®€åŒ–ä¸€ä¸‹ï¼š</p><blockquote><p>ç°åœ¨ç»™å®š $n$ ä¸ªä¸åŒçº§åˆ«çš„æœºå™¨äººï¼Œå°†ä¸¤æ®µçº§åˆ«çš„æœºå™¨äººåˆå¹¶éœ€è¦èŠ±è´¹ $c_i$ï¼Œé‚£ä¹ˆå°†æ‰€æœ‰æœºå™¨äººåˆå¹¶çš„æœ€å°èŠ±è´¹æ˜¯å¤šå°‘</p></blockquote><p>è¿™ä¸ªé—®é¢˜æ˜¾ç„¶ä½¿ç”¨åŒºé—´ $DP$ å¯ä»¥è§£å†³ï¼Œé‚£ä¹ˆæ‰©å±•åˆ°æ–¯å¦é‚£æ ‘ä¸Šå³å¯</p><p>ä»¤ $f[l][r][i]$ è¡¨ç¤ºåŒºé—´ $l, r$ çš„æœºå™¨äººåˆå¹¶åä½äºä½ç½® $i$ çš„æœ€å°èŠ±è´¹ï¼Œåˆ™æœ‰<br>$$<br>f[l][r][i] = \min \{f[l][k][i] + f[k + 1][r][i]\}<br>$$<br>ä»¥åŠ<br>$$<br>f[l][r][i] = \min\limits_{p  link  to  i} \{f[l][r][p] + 1\}<br>$$<br>ç¬¬äºŒä¸ªå¼å­ç›´æ¥ $SPFA$ ä¼šè¶…æ—¶</p><p><strong>ä½†æ˜¯è§‚å¯Ÿæ¯æ¡è¾¹çš„è´¡çŒ®éƒ½ä¸º $1$ï¼Œæ‰€ä»¥å¯ä»¥å°† $SPFA$ ä¼˜åŒ–æˆ $BFS$ çš„å¤æ‚åº¦</strong></p><p>ç±»ä¼¼å †ä¼˜åŒ–çš„æ€æƒ³ï¼Œå¼€ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªå­˜åˆå§‹çš„ç»è¿‡ $f$ æ’åºçš„ç‚¹ï¼Œä¸€ä¸ªå­˜è¢«æ¾å¼›çš„ç‚¹ï¼Œç”±äºè¾¹çš„æ€§è´¨åŠ $que1$ ç»è¿‡æ’åºçš„åŸå› ï¼Œæ‰€ä»¥ $que2$ ä¸€å®šä¹Ÿæ˜¯æŒ‰ $f$ é€’å¢çš„ï¼Œä»è€Œä¼˜åŒ–æˆ $BFS$ çš„å¤æ‚åº¦</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">9</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">500</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXI = MAXL * MAXL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">4</span> * MAXI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NextX[<span class="number">4</span>]= &#123;- <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, NextY[<span class="number">4</span>]= &#123;<span class="number">0</span>, - <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM];</span><br><span class="line"><span class="keyword">int</span> Head[MAXI]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, R, C;</span><br><span class="line"><span class="keyword">char</span> Map[MAXL][MAXL];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">encode</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (x - <span class="number">1</span>) * C + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fto[MAXL][MAXL][<span class="number">4</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXL][MAXL][<span class="number">4</span>]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">move</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (vis[x][y][k])</span><br><span class="line"><span class="keyword">return</span> fto[x][y][k] = - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (fto[x][y][k])</span><br><span class="line"><span class="keyword">return</span> fto[x][y][k];</span><br><span class="line"><span class="keyword">int</span> tx = x + NextX[k], ty = y + NextY[k];</span><br><span class="line">vis[x][y][k] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (Map[tx][ty] == <span class="string">'x'</span>)</span><br><span class="line">fto[x][y][k] = encode (x, y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (Map[tx][ty] == <span class="string">'A'</span>)</span><br><span class="line">fto[x][y][k] = move (tx, ty, (k + <span class="number">1</span>) % <span class="number">4</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (Map[tx][ty] == <span class="string">'C'</span>)</span><br><span class="line">fto[x][y][k] = move (tx, ty, (k + <span class="number">3</span>) % <span class="number">4</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">fto[x][y][k] = move (tx, ty, k);</span><br><span class="line">vis[x][y][k] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> fto[x][y][k];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][MAXN][MAXI];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que1, que2;</span><br><span class="line"><span class="keyword">int</span> inque[MAXI]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> buck[MAXI]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> save[MAXI];</span><br><span class="line"><span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fsort</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> limit = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R * C; i ++)</span><br><span class="line"><span class="keyword">if</span> (f[l][r][i] &lt; INF)</span><br><span class="line">limit = max (limit, f[l][r][i]), total ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= limit; i ++)</span><br><span class="line">buck[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R * C; i ++)</span><br><span class="line"><span class="keyword">if</span> (f[l][r][i] &lt; INF)</span><br><span class="line">buck[f[l][r][i]] ++;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= limit; i ++)</span><br><span class="line">buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = R * C; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line"><span class="keyword">if</span> (f[l][r][i] &lt; INF)</span><br><span class="line">save[buck[f[l][r][i]] --] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span> <span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">fsort (l, r);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= total; i ++)</span><br><span class="line">que1.push(save[i]), inque[save[i]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (! que1.empty() || ! que2.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> u;</span><br><span class="line"><span class="keyword">int</span> f1 = ! que1.empty() ? que1.front() : INF;</span><br><span class="line"><span class="keyword">int</span> f2 = ! que2.empty() ? que2.front() : INF;</span><br><span class="line">f1 &lt; f2 ? (u = f1, que1.pop()) : (u = f2, que2.pop());</span><br><span class="line">inque[u] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[u]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line"><span class="keyword">if</span> (f[l][r][u] + <span class="number">1</span> &lt; f[l][r][v]) &#123;</span><br><span class="line">f[l][r][v] = f[l][r][u] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (! inque[v])</span><br><span class="line">que2.push(v), inque[v] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d%d"</span>, &amp; N, &amp; C, &amp; R);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; i ++)</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, Map[i] + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; i ++)</span><br><span class="line">Map[i][<span class="number">0</span>] = Map[i][C + <span class="number">1</span>] = <span class="string">'x'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; j ++)</span><br><span class="line">Map[<span class="number">0</span>][j] = Map[R + <span class="number">1</span>][j] = <span class="string">'x'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (Map[i][j] == <span class="string">'x'</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k ++) &#123;</span><br><span class="line">move (i, j, k);</span><br><span class="line"><span class="keyword">if</span> ((~ fto[i][j][k]) &amp;&amp; fto[i][j][k] != encode (i, j))</span><br><span class="line">Insert (encode (i, j), fto[i][j][k]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span> (f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (f));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; j ++)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">isdigit</span> (Map[i][j]))</span><br><span class="line">f[Map[i][j] - <span class="string">'0'</span>][Map[i][j] - <span class="string">'0'</span>][encode (i, j)] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">1</span>; len &lt;= N; len ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= N - len + <span class="number">1</span>; l ++) &#123;</span><br><span class="line"><span class="keyword">int</span> r = l + len - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R * C; i ++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt; r; k ++)</span><br><span class="line">f[l][r][i] = min (f[l][r][i], f[l][k][i] + f[k + <span class="number">1</span>][r][i]);</span><br><span class="line">&#125;</span><br><span class="line">SPFA (l, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R * C; i ++)</span><br><span class="line">ans = min (ans, f[<span class="number">1</span>][N][i]);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans == INF ? - <span class="number">1</span> : ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 10 5</span></span><br><span class="line"><span class="comment">1.........</span></span><br><span class="line"><span class="comment">AA...x4...</span></span><br><span class="line"><span class="comment">..A..x....</span></span><br><span class="line"><span class="comment">2....x....</span></span><br><span class="line"><span class="comment">..C.3.A...</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–¯å¦çº³æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nç‚¹åŸºç¯æ ‘ä¸ªæ•°é—®é¢˜</title>
      <link href="/2020/08/04/n%E7%82%B9%E5%9F%BA%E7%8E%AF%E6%A0%91%E4%B8%AA%E6%95%B0%E9%97%AE%E9%A2%98/"/>
      <url>/2020/08/04/n%E7%82%B9%E5%9F%BA%E7%8E%AF%E6%A0%91%E4%B8%AA%E6%95%B0%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>å¯¹äº $n$ ä¸ªç‚¹ç»„æˆçš„ç¯å¤§å°ä¸º $m$ çš„åŸºç¯æ ‘ä¸ªæ•°çš„é—®é¢˜ï¼Œç›®å‰å·²çŸ¥ä¸‰ç§è§£æ³•</p><h2 id="è§£æ³•ä¸€ã€ŒåŠ¨æ€è§„åˆ’ã€"><a href="#è§£æ³•ä¸€ã€ŒåŠ¨æ€è§„åˆ’ã€" class="headerlink" title="è§£æ³•ä¸€ã€ŒåŠ¨æ€è§„åˆ’ã€"></a>è§£æ³•ä¸€ã€ŒåŠ¨æ€è§„åˆ’ã€</h2><p>åœ¨ç¯ä¸Šæ¯ä¸ªç‚¹ä¸‹é¢æ­æ ‘çš„æ–¹æ¡ˆæ•°ï¼Œç›¸å½“äºæ˜¯åœ¨å®Œå…¨å›¾ä¸­åˆ¶é€ ç”Ÿæˆæ ‘ï¼Œç„¶åæä¸€ä¸ªç‚¹ï¼ˆå³ç¯ä¸Šé‚£ä¸ªç‚¹ï¼‰ä¸ºæ ¹ï¼Œæ•…å¯ç”¨ $n^{n - 2}$ æ¥è®¡ç®—</p><p>ç„¶åå°±å¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§èƒŒåŒ…è§£æ³•ï¼ŒæŠŠç¯éšä¾¿æ‰¾ä¸ªåœ°æ–¹æ–­ä¸€ä¸‹ï¼ŒæŠŠå®ƒçœ‹æˆåºåˆ—ï¼Œå³å¯ä»¤ $f_{i, j}$ è¡¨ç¤ºç¯åºåˆ—å‰ $i$ ä¸ªç‚¹ï¼Œå·²ç»ä½¿ç”¨äº† $j$ ä¸ªç‚¹åšç¯ä¸‹çš„æ ‘çš„æ–¹æ¡ˆæ•°ï¼Œæ˜¾ç„¶<br>$$<br>f_{i, j} = \sum\limits_{k = 0}^j f_{i - 1, j - k} \times \dbinom{n - m - (j - k)}{k} \cdot (k + 1)^{k - 1}<br>$$<br>ç„¶åç­”æ¡ˆè¦å¯¹ç¯è¿›è¡Œåœ†æ’åˆ—ï¼Œå³ $ans = f_{m, n - m} \times \frac{A_n^m}{2m}$</p><p>å¤æ‚åº¦ $O (n^3)$</p><p>å½“ç„¶è¿™æ ·å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œå¯ä»¥è€ƒè™‘å°†å·²ç»æ‹¼å¥½çš„è¿é€šå—å’Œå·²ç»æ‹¼å¥½çš„ä¸€æ£µæ ‘è¿æ¥èµ·æ¥ï¼Œä»¤ $f_n$ è¡¨ç¤º $n$ ä¸ªç‚¹çš„ç­”æ¡ˆ</p><p>å½“ç„¶ï¼Œä¸ºäº†ä¿è¯ä¸ä¼šç®—é‡ï¼Œéœ€è¦æœ‰ä¸€ä¸ªç‰¹å¾ç‚¹ï¼Œå³ä¿è¯ç‚¹ $1$ ä¸ä¼šåœ¨ç¯ä¸Šï¼Œå³<br>$$<br>f_n = \frac{n}{n - m}\sum\limits_{i = m}^{n - 1} f_i \times i \cdot (n - i)^{n - i - 2} \cdot \dbinom{n - 1}{i}<br>$$<br>æ³¨æ„ï¼Œå‰é¢çš„ $\frac{n}{n - m}$ æ˜¯å› ä¸ºåœ¨ä½ ä»¤æ¯ä¸ªç‚¹ä½œä¸ºé‚£ä¸ªä¸åœ¨ç¯ä¸Šçš„é‚£ä¸ªç‚¹çš„æ—¶å€™ï¼Œå®é™…ä¸Šå¯¹äºæ¯ä¸ªç‚¹å®ƒä¼šè¢«å…¶å®ƒç‚¹ä½œä¸ºä¸åœ¨ç¯ä¸Šçš„ç‚¹æ—¶ç®—é‡ $n - m$ æ¬¡ï¼Œæ•…éœ€è¦é™¤ä»¥ $n - m$</p><p>å¤æ‚åº¦ $O (n^2)$</p><h2 id="è§£æ³•äºŒã€Œpruferåºåˆ—ã€"><a href="#è§£æ³•äºŒã€Œpruferåºåˆ—ã€" class="headerlink" title="è§£æ³•äºŒã€Œpruferåºåˆ—ã€"></a>è§£æ³•äºŒã€Œpruferåºåˆ—ã€</h2><p>è€ƒè™‘åœ¨åšpruferåºåˆ—çš„æ—¶å€™ï¼Œå¯¹äºåºåˆ—é•¿åº¦æ¥è®²ï¼Œå°†å…¶ç¼©æˆä¸€ä¸ªç‚¹ï¼Œå³æœ‰ $n - m + 1$ ä¸ªä½ç½®ï¼Œä½†æ˜¯åœ¨å®é™…æ”¾ç‚¹çš„æ—¶å€™ï¼Œå´åº”å½“æ˜¯æœ‰ $n$ ç§é€‰æ‹©ï¼Œå› ä¸ºç¯ä¸Šä¸åŒç‚¹ä½œä¸ºçˆ¶äº²çš„æƒ…å†µæ˜¯ä¸ä¸€æ ·çš„ï¼Œå³æœ‰ $n^{n - m - 1}$ ä¸ªä½ç½®ï¼Œç„¶åå†åšä¸€æ¬¡åœ†æ’åˆ—ï¼Œå³ä¹˜ä¸Š $\frac{A_n^m}{2m}$ï¼Œä½†æ˜¯å¯ä»¥å‘ç°ç¯æ‰€ç§°çš„ç‚¹ä½œä¸ºéæ ¹èŠ‚ç‚¹ï¼ˆç›¸å¯¹æ„ä¹‰ä¸Šï¼‰çš„æ—¶å€™ï¼Œéœ€è¦é€‰å®šä¸€ä¸ªç¯ä¸Šçš„ç‚¹ä½œä¸ºä¸çˆ¶èŠ‚ç‚¹è¿æ¥çš„ç‚¹ï¼Œå³è¿˜éœ€è¦ä¹˜ä¸Š $m$</p><p>æ•…æœ€åç­”æ¡ˆä¸ºï¼Œ$ans = \frac{A_n^m}{2m} \cdot n^{n - m - 1} \cdot m$</p><p>å¤æ‚åº¦ $O (n)$</p><h2 id="è§£æ³•ä¸‰ã€Œç”Ÿæˆå‡½æ•°ã€"><a href="#è§£æ³•ä¸‰ã€Œç”Ÿæˆå‡½æ•°ã€" class="headerlink" title="è§£æ³•ä¸‰ã€Œç”Ÿæˆå‡½æ•°ã€"></a>è§£æ³•ä¸‰ã€Œç”Ÿæˆå‡½æ•°ã€</h2><p>è€ƒè™‘å°†åŸºç¯æ ‘æ‹†åˆ†ä¸ºè‹¥å¹²æ£µæ ‘çš„æ‹¼å‡‘</p><p>æ³¨æ„æ­¤æ—¶éœ€è€ƒè™‘çš„æ˜¯æœ‰æ ¹æ ‘ï¼Œå³å…ˆå°†èŠ‚ç‚¹çœ‹ä½œç»„åˆå¯¹è±¡ï¼Œæ ¹æ® $Cayley$ å®šç†ï¼Œ$n$ ä¸ªèŠ‚ç‚¹çš„å®Œå…¨å›¾æœ‰ $n^{n - 1}$ æ£µæœ‰æ ¹æ ‘ï¼Œåˆ™æœ‰æ ¹æ ‘çš„ EGF $T(x)$ ä¸º<br>$$<br>T(x) = \sum\limits_{n = 1}^{\infty} n^{n - 1}\frac{x^n}{n!}<br>$$<br>é‚£ä¹ˆæ­¤æ—¶å°†æœ‰æ ¹æ ‘çœ‹ä½œç»„åˆå¯¹è±¡ï¼Œåˆ™å°†å®ƒä»¬ç»„æˆç¯ï¼Œå³åŸºç¯æ ‘çš„ EGF $G(x)$ ä¸º<br>$$<br>\begin{aligned}<br>G(x) &amp;= \frac{1}{2}\sum\limits_{k = 3}^{\infty} \frac{T(x)^k}{k} \\<br>&amp;= - \frac{1}{2}\ln (1 - T(x)) - \sum\limits_{k = 1}^2 \frac{T(x)^k}{k}<br>\end{aligned}<br>$$</p>]]></content>
      
      
      <categories>
          
          <category> å½’çº³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§DP </tag>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
            <tag> pruferåºåˆ— </tag>
            
            <tag> å½’çº³ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NTTï¼ˆå¿«é€Ÿæ•°è®ºå˜æ¢ï¼‰</title>
      <link href="/2020/08/04/NTT%EF%BC%88%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2%EF%BC%89/"/>
      <url>/2020/08/04/NTT%EF%BC%88%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="æ¦‚å¿µå¼•å…¥"><a href="#æ¦‚å¿µå¼•å…¥" class="headerlink" title="æ¦‚å¿µå¼•å…¥"></a>æ¦‚å¿µå¼•å…¥</h2><h3 id="é˜¶"><a href="#é˜¶" class="headerlink" title="é˜¶"></a>é˜¶</h3><p>å¯¹äº$p \in N_+$ä¸”$(a,  p) = 1$ï¼Œæ»¡è¶³$a^r \equiv 1 (mod  p)$çš„æœ€å°çš„éè´Ÿ$r$ä¸º$a$æ¨¡$p$æ„ä¹‰ä¸‹çš„é˜¶ï¼Œè®°ä½œ$\delta_p(a)$</p><h3 id="åŸæ ¹"><a href="#åŸæ ¹" class="headerlink" title="åŸæ ¹"></a>åŸæ ¹</h3><p>å®šä¹‰ï¼šè‹¥$p \in N_+$ä¸”$a \in N$ï¼Œè‹¥$\delta_p(a) = \phi(p)$ï¼Œåˆ™ç§°$a$ä¸ºæ¨¡$p$çš„ä¸€ä¸ªåŸæ ¹<br>ç›¸å…³å®šç†ï¼š</p><ul><li>è‹¥ä¸€ä¸ªæ•°$m$æ‹¥æœ‰åŸæ ¹ï¼Œé‚£ä¹ˆå®ƒå¿…å®šä¸º$2,  4,  p^t,  2p^t  (p$ä¸ºå¥‡è´¨æ•°$)$çš„å…¶ä¸­ä¸€ä¸ª<br>   æ¯ä¸ªæ•°$p$éƒ½æœ‰$\phi(\phi(p))$ä¸ªåŸæ ¹<br>   ã€€ã€€è¯æ˜ï¼šè‹¥$p \in N_+$ä¸”$(a,  p) = 1$ï¼Œæ­£æ•´æ•°$r$æ»¡è¶³$a^r \equiv 1 (mod  p)$ï¼Œé‚£ä¹ˆ$\delta(p) | r$ï¼Œç”±æ­¤æ¨å¹¿ï¼Œå¯çŸ¥$\delta(p) | \phi(p)$ï¼Œæ‰€ä»¥$p$çš„åŸæ ¹ä¸ªæ•°å³ä¸º$p$ä¹‹å‰ä¸$\phi(p)$äº’è´¨çš„æ•°ï¼Œå³$\phi(p)$æ•…å®šç†æˆç«‹<br>   ã€€ã€€ã€€ã€€ã€€ã€€- è‹¥$g$æ˜¯$m$çš„ä¸€ä¸ªåŸæ ¹ï¼Œåˆ™$g,  g^1,  g^2,  â€¦,  g^{\phi(m)} (mod  p)$ä¸¤ä¸¤ä¸åŒ<br>   ã€€ã€€ã€€ã€€åŸæ ¹æ±‚æ³•ï¼š<br>   ã€€ã€€å°†$\phi(m)$è´¨å› æ•°åˆ†è§£ï¼Œå¾—$\phi(m) = p_1^{c_1} * p_2^{c_2} * â€¦ * p_k^{c_k}$<br>   ã€€ã€€é‚£ä¹ˆæ‰€æœ‰$g$æ»¡è¶³$g^{\frac{\phi(m)}{p_i}} \neq 1 (mod  m)$å³ä¸º$m$çš„åŸæ ¹</li></ul><h2 id="NTT"><a href="#NTT" class="headerlink" title="$NTT$"></a>$NTT$</h2><p>ã€€ã€€ç”±äº$FTT$æ¶‰åŠåˆ°å¤æ•°çš„è¿ç®—ï¼Œæ‰€ä»¥å¸¸æ•°å¾ˆå¤§ï¼Œè€Œ$NTT$ä»…éœ€ä½¿ç”¨é•¿æ•´å‹ï¼Œå¯å¤§å¤§ä¼˜åŒ–å¸¸æ•°</p><p>ã€€ã€€èƒ½å¤Ÿå°†åŸæ ¹ä»£æ›¿å•ä½æ ¹è¿›è¡Œè®¡ç®—ï¼Œæ˜¯å› ä¸ºå®ƒä»¬çš„æ€§è´¨ç›¸ä¼¼ï¼Œè‡³å°‘åœ¨å•ä½æ ¹éœ€è¦çš„é‚£å‡ ä¸ªæ€§è´¨åŸæ ¹éƒ½æ»¡è¶³ï¼Œå½“ç„¶ï¼Œè¦èƒ½å¤Ÿè¿›è¡Œ$NTT$ï¼Œéœ€è¦æ»¡è¶³æ¨¡æ•°$p$ä¸ºè´¨æ•°ï¼Œä¸”$p = ax + 1$å…¶ä¸­$x$ä¸º$2$çš„æ¬¡å¹‚ï¼Œé‚£ä¹ˆä¸€èˆ¬èƒ½æ»¡è¶³æ¡ä»¶çš„æ•°ï¼ˆå¸¸ç”¨ï¼‰æœ‰ï¼š<br>ã€€ã€€$|            p             |    g     |$</p><p>ã€€ã€€$|    469762049     |    3     |$</p><p>ã€€ã€€$|    998244353     |    3     |$</p><p>ã€€ã€€$|   1004535809    |    3     |$<br>ã€€ã€€é‚£ä¹ˆï¼Œå°±å¯ä»¥å°†å•ä½æ ¹$\omega_n$æ›¿æ¢ä¸º$g^{\frac{p - 1}{n}}$è¿›è¡Œ$NTT$äº†</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> g 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = (<span class="number">1</span> &lt;&lt; <span class="number">22</span>);</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    LL cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (p) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">            cnt = cnt * x % MOD;</span><br><span class="line"></span><br><span class="line">        x = x * x % MOD;</span><br><span class="line">        p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL invg = power (g, MOD - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN];</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">            swap (a[i], a[oppo[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> ome = power (inv == <span class="number">1</span> ? g : invg, (MOD - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome % MOD) &#123;</span><br><span class="line">                LL a1 = a[j + k], xa2 = x * a[j + k + mid] % MOD;</span><br><span class="line">                a[j + k] = (a1 + xa2) % MOD;</span><br><span class="line">                a[j + k + mid] = (a1 - xa2 + MOD) % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line">        A[i] = (<span class="keyword">int</span>) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">        B[i] = (<span class="keyword">int</span>) getnum ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n, lim = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= N + M; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">        oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line">    limit = n;</span><br><span class="line">    NTT (A, <span class="number">1</span>);</span><br><span class="line">    NTT (B, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">        A[i] = A[i] * B[i] % MOD;</span><br><span class="line">    NTT (A, - <span class="number">1</span>);</span><br><span class="line">    LL invn = power (n, MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i)</span><br><span class="line">            <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d"</span>, (<span class="keyword">int</span>) (A[i] * invn % MOD));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä»»æ„æ¨¡æ•°-NTT-ï¼ˆä¸‰æ¨¡æ•°-NTT-æ³•ï¼‰"><a href="#ä»»æ„æ¨¡æ•°-NTT-ï¼ˆä¸‰æ¨¡æ•°-NTT-æ³•ï¼‰" class="headerlink" title="ä»»æ„æ¨¡æ•°$NTT$ï¼ˆä¸‰æ¨¡æ•°$NTT$æ³•ï¼‰"></a>ä»»æ„æ¨¡æ•°$NTT$ï¼ˆä¸‰æ¨¡æ•°$NTT$æ³•ï¼‰</h3><p>æœ‰å…¬å¼</p><p>$$<br>\left\{\begin{aligned} x \equiv a_1 (mod  m_1) \\ x \equiv a_2 (mod  m_2) \\ x \equiv a_3 (mod  m_3) \end{aligned}\right.<br>$$<br>ç›´æ¥ä¹˜ä¼šçˆ†$long  long$ï¼Œå°±å…ˆå°†ä¸Šé¢çš„ç”¨$CRT$åˆå¹¶ï¼Œå¾—</p><p>$$<br>\left\{\begin{aligned} x \equiv A (mod  M) \\ x \equiv a_3 (mod  m_3) \end{aligned}\right.<br>$$<br>é‚£ä¹ˆè®¾$Ans = kM + A$ï¼Œåˆ™æœ‰<br>$$<br>\begin{aligned}<br>kM + A &amp;\equiv a_3 \pmod{m_3} \\<br>k &amp;\equiv (a_3 - A)M^{- 1} \pmod{m_3}<br>\end{aligned}<br>$$<br>ç›´æ¥å¤„ç†å³å¯</p><h4 id="ä»£ç ï¼ˆä»»æ„æ¨¡æ•°-NTT-ï¼‰"><a href="#ä»£ç ï¼ˆä»»æ„æ¨¡æ•°-NTT-ï¼‰" class="headerlink" title="ä»£ç ï¼ˆä»»æ„æ¨¡æ•°$NTT$ï¼‰"></a>ä»£ç ï¼ˆä»»æ„æ¨¡æ•°$NTT$ï¼‰</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL MOD[<span class="number">3</span>]= &#123;<span class="number">469762049</span>, <span class="number">998244353</span>, <span class="number">1004535809</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> LL g = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> eps = <span class="number">1e-03</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">multi</span> <span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">    a %= p, b %= p;</span><br><span class="line">    <span class="keyword">return</span> ((a * b - (LL) ((LL) ((<span class="keyword">long</span> <span class="keyword">double</span>) a / p * b + eps) * p)) % p + p) % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, LL p, LL mod)</span> </span>&#123;</span><br><span class="line">    LL cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (p) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">            cnt = cnt * x % mod;</span><br><span class="line"></span><br><span class="line">        x = x * x % mod;</span><br><span class="line">        p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL invg[<span class="number">3</span>]= &#123;power (g, MOD[<span class="number">0</span>] - <span class="number">2</span>, MOD[<span class="number">0</span>]), power (g, MOD[<span class="number">1</span>] - <span class="number">2</span>, MOD[<span class="number">1</span>]), power (g, MOD[<span class="number">2</span>] - <span class="number">2</span>, MOD[<span class="number">2</span>])&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL P;</span><br><span class="line"></span><br><span class="line">LL A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="keyword">int</span> oppo[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span> <span class="params">(LL* a, <span class="keyword">int</span> inv, <span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">            swap (a[i], a[oppo[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        LL ome = power (inv == <span class="number">1</span> ? g : invg[type], (MOD[type] - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>), MOD[type]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">            LL x = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome % MOD[type]) &#123;</span><br><span class="line">                LL a1 = a[j + k], xa2 = x * a[j + k + mid] % MOD[type];</span><br><span class="line">                a[j + k] = (a1 + xa2) % MOD[type];</span><br><span class="line">                a[j + k + mid] = (a1 - xa2 + MOD[type]) % MOD[type];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL ntta[<span class="number">3</span>][MAXN], nttb[<span class="number">3</span>][MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT_Main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, lim = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= N + M; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">    limit = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">        oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i ++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            ntta[i][j] = A[j];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            nttb[i][j] = B[j];</span><br><span class="line">        NTT (ntta[i], <span class="number">1</span>, i);</span><br><span class="line">        NTT (nttb[i], <span class="number">1</span>, i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            ntta[i][j] = ntta[i][j] * nttb[i][j] % MOD[i];</span><br><span class="line">        NTT (ntta[i], - <span class="number">1</span>, i);</span><br><span class="line">        LL invn = power (n, MOD[i] - <span class="number">2</span>, MOD[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= N + M; j ++)</span><br><span class="line">            ntta[i][j] = ntta[i][j] * invn % MOD[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL ans[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CRT</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    LL m = MOD[<span class="number">0</span>] * MOD[<span class="number">1</span>];</span><br><span class="line">    LL M1 = MOD[<span class="number">1</span>], M2 = MOD[<span class="number">0</span>];</span><br><span class="line">    LL t1 = power (M1, MOD[<span class="number">0</span>] - <span class="number">2</span>, MOD[<span class="number">0</span>]), t2 = power (M2, MOD[<span class="number">1</span>] - <span class="number">2</span>, MOD[<span class="number">1</span>]), invM = power (m % MOD[<span class="number">2</span>], MOD[<span class="number">2</span>] - <span class="number">2</span>, MOD[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line">        LL a1 = ntta[<span class="number">0</span>][i], a2 = ntta[<span class="number">1</span>][i], a3 = ntta[<span class="number">2</span>][i];</span><br><span class="line">        LL A = (multi (a1 * M1 % m, t1 % m, m) + multi (a2 * M2 % m, t2 % m, m)) % m;</span><br><span class="line">        LL k = ((a3 - A % MOD[<span class="number">2</span>]) % MOD[<span class="number">2</span>] + MOD[<span class="number">2</span>]) % MOD[<span class="number">2</span>] * invM % MOD[<span class="number">2</span>];</span><br><span class="line">        ans[i] = ((k % P * (m % P) % P + A % P) % P + P) % P;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum (), P = (LL) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line">        A[i] = (LL) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">        B[i] = (LL) getnum ();</span><br><span class="line"></span><br><span class="line">    NTT_Main ();</span><br><span class="line">    CRT ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i)</span><br><span class="line">            <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld"</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šé¡¹å¼ </tag>
            
            <tag> FFT/NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LOJ6039 - ã€Œé›…ç¤¼é›†è®­ 2017 Day5ã€ç å® ã€Œé‡é‡è¾ƒå°çš„å¤§æ•°æ®01èƒŒåŒ…ã€</title>
      <link href="/2020/08/04/LOJ%206039%20-%20%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD%202017%20Day5%E3%80%8D%E7%8F%A0%E5%AE%9D%20%E3%80%8C%E9%87%8D%E9%87%8F%E8%BE%83%E5%B0%8F%E7%9A%84%E5%A4%A7%E6%95%B0%E6%8D%AE01%E8%83%8C%E5%8C%85%E3%80%8D/"/>
      <url>/2020/08/04/LOJ%206039%20-%20%E3%80%8C%E9%9B%85%E7%A4%BC%E9%9B%86%E8%AE%AD%202017%20Day5%E3%80%8D%E7%8F%A0%E5%AE%9D%20%E3%80%8C%E9%87%8D%E9%87%8F%E8%BE%83%E5%B0%8F%E7%9A%84%E5%A4%A7%E6%95%B0%E6%8D%AE01%E8%83%8C%E5%8C%85%E3%80%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>$01$ èƒŒåŒ…ï¼Œæ•°æ®èŒƒå›´ $1 \le n \le 1e06, 1 \le weight_i \le 300$</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç¥ä»™ $01$ èƒŒåŒ…</p><p>è€ƒè™‘é‡é‡è¾ƒå°ï¼Œæ•…å¯ä»¥è€ƒè™‘æ ¹æ®é‡é‡åˆ†å±‚å¤„ç†</p><p>ä»¤ $f_{i, j}$ è¡¨ç¤ºä½¿ç”¨å‰ $i$ ä¸ªé‡é‡ï¼Œæ€»å…±èŠ±è´¹ $j$ å®¹é‡çš„æœ€å¤§ä»·å€¼</p><p>å®¹æ˜“æ³¨æ„åˆ°åœ¨åŒä¸€é‡é‡ä¸­æ˜¾ç„¶è¦ä¼˜å…ˆé€‰æ‹©ä»·å€¼å¤§çš„ï¼Œæ•…å°†æ¯ç§é‡é‡æŒ‰ä»·å€¼æ’åºï¼Œä»¤ $sumv_{i, j}$ è¡¨ç¤ºé‡é‡ä¸º $i$ çš„å‰ $j$ å¤§çš„ä»·å€¼å‰ç¼€å’Œï¼Œåˆ™æœ‰<br>$$<br>f_{i, j} = \max\limits_k \{f_{i - 1, j - ki} + sumv_{i, k}\}<br>$$<br>ç„¶åï¼ˆé€šè¿‡çœ‹é¢˜è§£ï¼‰å¯ä»¥å‘ç°ï¼Œå› ä¸ºæ˜¯ $j - ki$ï¼Œæ•…å¯ä»¥è€ƒè™‘æŒ‰ç…§ $j \mod i$ åˆ†ç±»å¤„ç†ï¼Œè¿™æ ·æ˜¯æ»¡è¶³å†³ç­–å•è°ƒæ€§çš„</p><p>è‡³äºè¯æ˜ï¼Œä¸ºäº†æ–¹ä¾¿å¯ä»¥å°†å¼å­ç®€åŒ–æˆ $f_i = \max \{f_j +sumv_{i - j}\}$ çš„å½¢å¼ï¼Œç„¶åç”¨åè¯æ³•æˆ–æ˜¯å››è¾¹å½¢ä¸ç­‰å¼éƒ½å®¹æ˜“è¯æ˜</p><p>é‚£ä¹ˆæœ€åå°±å¯ä»¥ç”¨å†³ç­–å•è°ƒæ€§çš„å¥—è·¯ä»£ç æˆ–è€…æ˜¯ç”¨åˆ†æ²»è§£å†³äº†</p><p>åˆ†æ²»æ¯”è¾ƒç®€å•ï¼Œå¤§æ¦‚å°±æ˜¯çœ‹åœ¨å¤„ç†åŒºé—´ $[u, v]$ï¼Œ $[l, r]$ å†³ç­–åŒºé—´å†…å¯¹äº $mid$ ä½ç½®åœ¨ $[l, r]$ ä¸­æœ€æœ‰å†³ç­–åœ¨å“ªä¸ªä½ç½®ï¼Œç„¶åå·¦å³é€’å½’å³å¯</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">5e04</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXC = <span class="number">300</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K, C = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; value[MAXC];</span><br><span class="line"><span class="built_in">vector</span>&lt;LL&gt; prefix[MAXC];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; a, <span class="keyword">const</span> <span class="keyword">int</span>&amp; b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL f[MAXC][MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL trans[MAXK]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function">LL <span class="title">w</span> <span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = (i - j) / s;</span><br><span class="line"><span class="keyword">if</span> (p &gt;= (<span class="keyword">int</span>) prefix[s].size())</span><br><span class="line"><span class="keyword">return</span> - <span class="number">1l</span>l;</span><br><span class="line"><span class="keyword">return</span> f[s - <span class="number">1</span>][j] + prefix[s][p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; <span class="comment">// å±‚æ•° å¤„ç†åŒºé—´ å†³ç­–åŒºé—´</span></span><br><span class="line"><span class="keyword">int</span> mid = (u + v) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">LL maxi = - <span class="number">1</span>, posi = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= min (mid, r); i ++) &#123;</span><br><span class="line">LL cont = w (trans[mid], trans[i], p);</span><br><span class="line"><span class="keyword">if</span> (cont &gt; maxi)</span><br><span class="line">maxi = cont, posi = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (u == v) &#123;</span><br><span class="line">f[p][trans[u]] = maxi;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">solve (p, u, mid, l, posi);</span><br><span class="line">solve (p, mid + <span class="number">1</span>, v, posi, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>)</span><br><span class="line">write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> c = getnum (), v = getnum ();</span><br><span class="line">C = max (C, c), value[c].push_back(v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= C; i ++) &#123;</span><br><span class="line">sort (value[i].begin(), value[i].end(), comp);</span><br><span class="line">LL sum = <span class="number">0</span>;</span><br><span class="line">prefix[i].push_back(sum);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) value[i].size(); j ++)</span><br><span class="line">sum += value[i][j], prefix[i].push_back(sum);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j ++) &#123;</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line">trans[limit = <span class="number">1</span>] = j;</span><br><span class="line"><span class="keyword">while</span> (trans[limit] + i &lt;= K)</span><br><span class="line">limit ++, trans[limit] = trans[limit - <span class="number">1</span>] + i;</span><br><span class="line">solve (i, <span class="number">1</span>, limit, <span class="number">1</span>, limit);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">write (f[C][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 10</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">1 48</span></span><br><span class="line"><span class="comment">3 25</span></span><br><span class="line"><span class="comment">2 76</span></span><br><span class="line"><span class="comment">4 83</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èƒŒåŒ…DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FFTï¼ˆå¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼‰</title>
      <link href="/2020/08/04/FFT%EF%BC%88%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%EF%BC%89/"/>
      <url>/2020/08/04/FFT%EF%BC%88%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="æ¦‚å¿µå¼•å…¥"><a href="#æ¦‚å¿µå¼•å…¥" class="headerlink" title="æ¦‚å¿µå¼•å…¥"></a>æ¦‚å¿µå¼•å…¥</h2><p>ã€€ã€€<strong>- ç‚¹å€¼è¡¨ç¤º</strong><br>ã€€ã€€ã€€ã€€å¯¹äºä¸€ä¸ª$n - 1$æ¬¡å¤šé¡¹å¼$A(x)$ï¼Œå¯ä»¥é€šè¿‡ç¡®å®š$n$ä¸ªç‚¹ä¸å€¼ï¼ˆå³$x$å’Œ$y$ï¼‰æ¥è¡¨ç¤ºè¿™å”¯ä¸€çš„$A(x)$</p><p>ã€€ã€€<strong>- å¤æ•°</strong><br>ã€€ã€€ã€€ã€€å¯¹äºä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹<br>ã€€ã€€ã€€ã€€$$x^2 + 1 = 0$$<br>ã€€ã€€ã€€ã€€åœ¨å®æ•°èŒƒå›´å†…æ— è§£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å®æ•°èŒƒå›´æ‰©å……ï¼Œå°±å¾—åˆ°äº†å¤æ•°ï¼Œå†ä»¤$i$ä¸ºè¯¥æ–¹ç¨‹çš„è§£ï¼Œå³<br>ã€€ã€€ã€€ã€€$$i^2 = - 1$$<br>ã€€ã€€ã€€ã€€é‚£ä¹ˆå°±å®šä¹‰$z = a + bi$çš„æ•°ä¸ºå¤æ•°ï¼Œåˆ™æœ‰<br>ã€€ã€€ã€€ã€€å½“$b = 0$æ—¶ï¼Œ$z$ä¸ºå®æ•°<br>ã€€ã€€ã€€ã€€å½“$b \neq 0$æ—¶ï¼Œ$z$ä¸ºè™šæ•°<br>ã€€ã€€ã€€ã€€å½“$a = 0  \&amp;\&amp;  b \neq 0$æ—¶ï¼Œ$z$ä¸ºçº¯è™šæ•°<br>ã€€ã€€ã€€ã€€å…¶ä¸­ï¼Œå¤æ•°æ»¡è¶³åŠ æ³•äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€ä¹˜æ³•åˆ†é…ç‡ç­‰</p><p>ã€€ã€€ã€€ã€€å¤æ•°ç›¸ä¹˜ï¼š$z_1 = a_1 + b_1i,  z_2 = a_2 + b_2i$ï¼Œåˆ™$z_1 Ã— z_2 = (a_1 + b_1i)(a_2 + b_2i) = (a_1a_2 - b_1b_2) + (a_1b_2 + b_1a_2)i$ï¼Œå®ƒä»¬ç›¸ä¹˜è¿˜æ˜¯ä¸€ä¸ªå¤æ•°ï¼Œåœ¨å¤å¹³é¢ä¸Šç†è§£ï¼Œå°±æ˜¯æ¨¡é•¿ç›¸ä¹˜ï¼Œå¹…è§’ç›¸åŠ </p><p>ã€€ã€€ã€€ã€€å…±è½­å¤æ•°ï¼šå½“ä¸¤ä¸ªå¤æ•°å®éƒ¨ç›¸åŒï¼Œè™šéƒ¨ä¸ºç›¸åæ•°æ—¶ï¼Œä¸¤ä¸ªå¤æ•°è¢«ç§°ä¸ºå…±è½­å¤æ•°</p><p>ã€€ã€€ã€€ã€€å¯¹äºä¸€ä¸ªå¤æ•°$z = a + bi$ï¼Œè¿˜å¯ä»¥åœ¨å¤æ•°å¹³é¢ä¸Šç”¨å‘é‡è¡¨ç¤ºå‡ºæ¥ï¼Œå³æœ‰$\overrightarrow{OZ}$ä¸€ä¸€å¯¹åº”æ¯ä¸ª$z = a + bi$ï¼Œé‚£ä¹ˆå°±æœ‰å¤æ•°çš„æ¨¡ç­‰äº$\overline{Z}$ï¼Œå³$|z| = \sqrt{a^2 + b^2}$<br>ã€€ã€€ã€€ã€€å¤æ•°ç›´æ¥æ¯”è¾ƒå¤§å°æ²¡æœ‰æ„ä¹‰ï¼Œé™¤éå®ƒæ˜¯ä¸€ä¸ªå®æ•°</p><h3 id="FFT-ä½œç”¨"><a href="#FFT-ä½œç”¨" class="headerlink" title="$FFT$ä½œç”¨"></a>$FFT$ä½œç”¨</h3><p>ã€€ã€€é‚£ä¹ˆï¼Œæœ‰äº†ç‚¹å€¼è¡¨ç¤ºï¼Œå¯¹äºå¤šé¡¹å¼$A(x)$å’Œ$B(x)$ç›¸ä¹˜ï¼Œå°±ä¸éœ€è¦$O(n^2)$ï¼Œè€Œåªéœ€è¦$O(n)$ï¼Œå› ä¸º$C(x_i) = A(x_i) * B(x_i)$ï¼Œç„¶åæšä¸¾$x_i$å³å¯<br>ã€€ã€€äºæ˜¯ç°åœ¨çš„å¤æ‚åº¦ç—‡ç»“å°±åœ¨äºå°†å¤šé¡¹å¼è½¬åŒ–æˆç‚¹å€¼è¡¨ç¤ºçš„$O(n^2)$äº†ï¼Œäºæ˜¯å°±æœ‰$FFT$ï¼Œå¯ä»¥å®ç°åœ¨$O(n  logn)$çš„æ—¶é—´å†…è½¬åŒ–</p><h3 id="ç¦»æ•£å‚…é‡Œå¶å˜æ¢"><a href="#ç¦»æ•£å‚…é‡Œå¶å˜æ¢" class="headerlink" title="ç¦»æ•£å‚…é‡Œå¶å˜æ¢"></a>ç¦»æ•£å‚…é‡Œå¶å˜æ¢</h3><p>ã€€ã€€äºæ˜¯å‚…é‡Œå¶è§„å®šï¼Œç‚¹å€¼ä¸­çš„$x$ä¸ºæ¨¡é•¿ä¸º$1$çš„å¤æ•°<br>ã€€ã€€è‡³äºä¸ºä»€ä¹ˆè¦å–å¤æ•°è€Œä¸æ˜¯å®æ•°ï¼Œå› ä¸ºå®ƒæœ‰å¾ˆç¥å¥‡çš„æ€§è´¨<br>ã€€ã€€é‚£ä¹ˆå¯¹äºè¿™$n$ä¸ªå¤æ•°çš„å–æ³•ï¼Œå–çš„æ˜¯å¤å¹³é¢ä¸ŠåŠå¾„ä¸º$1$çš„ä¸€ä¸ªåœ†ï¼Œå°†å…¶$n$ç­‰åˆ†åå¾—åˆ°çš„ç‚¹ï¼Œä»¤ç¬¬$i$ä¸ªç‚¹è¡¨ç¤ºä¸º$\omega_n^k(0 \le k \le n - 1)$ï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹åœ¨å¤å¹³é¢ä¸­çš„è¡¨ç¤ºå³ä¸º$(cos\frac{k}{n}2\pi,  sin\frac{k}{n}2\pi)$ï¼Œé‚£ä¹ˆæ ¹æ®å¤æ•°ä¹˜æ³•åœ¨å¤å¹³é¢ä¸Šçš„æ„ä¹‰ä¸ºæ¨¡é•¿ç›¸ä¹˜ï¼Œå¹…é•¿ç›¸åŠ ï¼Œå³$\omega_n^k$ç›¸å½“äº$(\omega_n^1)^k$ï¼Œé‚£ä¹ˆç§°$\omega_n^1$ä¸ºå•ä½æ ¹<br>ã€€ã€€æˆ‘ä»¬å°±æŠŠè¿™$\omega_n^0,  \omega_n^1,  â€¦,  \omega_n^{n - 1}$ä½œä¸ºç‚¹å€¼è¡¨ç¤ºçš„$x$ï¼Œç§°ä½œç¦»æ•£å‚…é‡Œå¶å˜æ¢çš„ç»“æœ<br>ã€€ã€€å…ˆç»™å‡ºå…³äºå‚…é‡Œå¶é€†å˜æ¢çš„ç»“è®ºï¼š<br>ã€€ã€€ã€€ã€€- å°†å¤šé¡¹å¼$A(x)$çš„ç¦»æ•£å‚…é‡Œå¶å˜æ¢ç»“æœä½œä¸ºç³»æ•°ä»£å…¥å¤šé¡¹å¼$B(x)$ï¼Œå†å°†æ¯ä¸ªç¦»æ•£å‚…é‡Œå¶å˜æ¢ç»“æœçš„å€’æ•°ï¼Œå³$\omega_n^0,  \omega_n^{- 1},  â€¦,  \omega_n^{- (n - 1)}$ä½œä¸º$x$ä»£å…¥$B(x)$å¾—åˆ°ç‚¹å€¼è¡¨ç¤ºï¼Œé‚£ä¹ˆè¿™äº›è¡¨ç¤ºé™¤ä»¥$n$å°±å¾—åˆ°äº†$A(x)$çš„åŸç³»æ•° [è‡³äºè¯æ˜ï¼šä¸å­˜åœ¨çš„]<br>ã€€ã€€è¿™å°±æ˜¯å‚…é‡Œå¶å˜æ¢ç¥å¥‡çš„æ€§è´¨</p><h2 id="FFT"><a href="#FFT" class="headerlink" title="$FFT$"></a>$FFT$</h2><p>ã€€ã€€æœ‰äº†å‚…é‡Œå¶å˜æ¢ï¼Œè™½ç„¶å¤šé¡¹å¼ä¸ç‚¹å€¼è¡¨ç¤ºç›¸äº’è½¬åŒ–å·²ç»å¾ˆè½»æ¾äº†ï¼Œä½†æ˜¯å¤æ‚åº¦ä»ç„¶ä¸ç†æƒ³ï¼Œå°±æœ‰äº†å¿«é€Ÿå‚…é‡Œå¶å˜æ¢<br>ã€€ã€€ç»“è®ºï¼š</p><ul><li>$\omega_{2n}^{2k} = \omega_n^k$ [è¯æ˜ï¼šä»£è¿›åŸå…¬å¼æ˜¾ç„¶]<ul><li>$\omega_n^{k + \frac{n}{2}} = - \omega_n^k$ [è¯æ˜ï¼šå…³äºå¤å¹³é¢åŸç‚¹ä¸­å¿ƒå¯¹ç§°]<br>  å¯¹äºå¤šé¡¹å¼$A(x) = \sum\limits_{i = 0}^{n - 1} a_ix^i$ï¼Œå°†å®ƒçš„å¥‡å¶é¡¹æ‹†å¼€ï¼Œå¹¶å°†$x$è½¬ä¸º$x^2$å¾—åˆ°ï¼ˆæ­¤å¤„å…ˆå‡å®š$n$ä¸ºå¶æ•°ï¼‰</li></ul></li></ul><p>$$<br>N(x) = a_0 + a_2x + a_4x^2 + â€¦ + a_{n - 2}x^{\frac{n}{2} - 1} \\<br>M(x) = a_1 + a_3x + a_5x^2 + â€¦ + a_{n - 1}x^{\frac{n}{2} - 1}<br>$$</p><p>ã€€ã€€    å½“ç„¶æ­¤æ—¶ä»£å…¥çš„æ˜¯$N(x^2),  M(x^2)$ï¼Œåˆ™æœ‰</p><p>$$<br>A(x) = N(x^2) + xM(x^2)<br>$$<br>â€‹    ã€€ã€€æ­¤æ—¶å°±éœ€è¦æŠŠ$\omega_n^k$ä»£å…¥ï¼Œåˆ†æƒ…å†µè®¨è®ºï¼š<br>ã€€ã€€    è‹¥$k &lt; \frac{n}{2}$ï¼Œåˆ™æœ‰<br>$$<br>\begin{aligned}<br>A(\omega_n^k) &amp;= N(\omega_n^{2k}) + \omega_n^kM(\omega_n^{2k}) \\<br>&amp;= N(\omega_{\frac{n}{2}}^k) + \omega_n^kM(\omega_{\frac{n}{2}}^k)<br>\end{aligned}<br>$$</p><p>â€‹    ã€€ã€€åä¹‹</p><p>$$<br>\begin{aligned}<br>A(\omega_n^k) &amp;= N(\omega_n^{2k + n}) + \omega_n^{k + \frac{n}{2}}M(\omega_n^{2k + n}) \\<br>&amp;= N(\omega_n^{2k} Ã— \omega_n^n) + \omega_n^{k + \frac{n}{2}}M(\omega_n^{2k} Ã— \omega_n^n)ï¼ˆè¿™ä¸€æ­¥æ˜¯é€šè¿‡å¤æ•°ä¹˜æ³•å¤å¹³é¢ä¸Šçš„æ„ä¹‰åŒ–ç®€çš„ï¼‰ \\<br>&amp;= N(\omega_{\frac{n}{2}}^k) - \omega_n^kM(\omega_{\frac{n}{2}}^k)<br>\end{aligned}<br>$$</p><p>ã€€ã€€äºæ˜¯ï¼Œæˆ‘ä»¬åªè¦æ±‚å¾—$\{\omega_{\frac{n}{2}}^0,  \omega_{\frac{n}{2}}^1,  â€¦,  \omega_{\frac{n}{2}}^{\frac{n}{2} - 1}\}$ï¼Œå°±å¯ä»¥å¾—åˆ°$A(x)$çš„æ‰€æœ‰å…³äºæ‰€æœ‰ç¦»æ•£å‚…é‡Œå¶å˜æ¢ç»“æœçš„ç‚¹å€¼è¡¨ç¤ºäº†ï¼Œå¯ç”¨åˆ†æ²»å®ç°ï¼Œå¤æ‚åº¦$O(n  logn)$</p><h3 id="ä»£ç ï¼ˆåˆ†æ²»FFTï¼‰"><a href="#ä»£ç ï¼ˆåˆ†æ²»FFTï¼‰" class="headerlink" title="ä»£ç ï¼ˆåˆ†æ²»FFTï¼‰"></a>ä»£ç ï¼ˆåˆ†æ²»FFTï¼‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e06</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span> (- <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mcomplex</span> &#123;</span></span><br><span class="line"><span class="keyword">double</span> x, y;</span><br><span class="line"></span><br><span class="line">mcomplex () &#123;&#125;</span><br><span class="line">mcomplex (<span class="keyword">double</span> fx, <span class="keyword">double</span> fy) :</span><br><span class="line">x (fx), y (fy) &#123;&#125;</span><br><span class="line"></span><br><span class="line">mcomplex <span class="keyword">operator</span> + (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (x + p.x, y + p.y);</span><br><span class="line">&#125;</span><br><span class="line">mcomplex <span class="keyword">operator</span> - (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (x - p.x, y - p.y);</span><br><span class="line">&#125;</span><br><span class="line">mcomplex <span class="keyword">operator</span> * (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (x * p.x - y * p.y, x * p.y + y * p.x);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function">mcomplex <span class="title">omega</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> mcomplex (<span class="built_in">cos</span> (<span class="number">2.0</span> * PI * (<span class="keyword">double</span>) k / (<span class="keyword">double</span>) n), <span class="number">1.0</span> * inv * <span class="built_in">sin</span> (<span class="number">2.0</span> * PI * (<span class="keyword">double</span>) k / (<span class="keyword">double</span>) n));</span><br><span class="line">&#125;</span><br><span class="line">mcomplex A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span> <span class="params">(mcomplex* a, <span class="keyword">int</span> n, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">mcomplex a1[n &gt;&gt; <span class="number">1</span>], a2[n &gt;&gt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> m = n &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i += <span class="number">2</span>) &#123;</span><br><span class="line">a1[i &gt;&gt; <span class="number">1</span>] = a[i];</span><br><span class="line">a2[i &gt;&gt; <span class="number">1</span>] = a[i + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">FFT (a1, m, inv);</span><br><span class="line">FFT (a2, m, inv);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i ++) &#123;</span><br><span class="line">mcomplex x = omega (n, i, inv);</span><br><span class="line">a[i] = a1[i] + x * a2[i];</span><br><span class="line">a[i + m] = a1[i] - x * a2[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line">A[i].x = (<span class="keyword">double</span>) getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">B[i].x = (<span class="keyword">double</span>) getnum ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= N + M; n &lt;&lt;= <span class="number">1</span>);</span><br><span class="line">FFT (A, n, <span class="number">1</span>);</span><br><span class="line">FFT (B, n, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">A[i] = A[i] * B[i];</span><br><span class="line">FFT (A, n, - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i)</span><br><span class="line"><span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d"</span>, (<span class="keyword">int</span>) (A[i].x / n + <span class="number">0.5</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è´è¶æ“ä½œ"><a href="#è´è¶æ“ä½œ" class="headerlink" title="è´è¶æ“ä½œ"></a>è´è¶æ“ä½œ</h3><p>ã€€ã€€äºæ˜¯è¿™æ ·è¿˜æ˜¯ä¼šè¶…æ—¶ï¼Œé‚£ä¹ˆè¿˜éœ€è¦ä¼˜åŒ–<br>ã€€ã€€æ ¹æ®è¡¨æ ¼ï¼Œæœ‰ä¸€ä¸ªè€ƒçœ¼åŠ›çš„æ€§è´¨<br>ã€€ã€€$|0  1  2  3|$<br>ã€€ã€€$|0  2 | 1  3|$<br>ã€€ã€€$|0 | 2 | 1 | 3|$<br>ã€€ã€€ä¼šå‘ç°æ¯ä¸ªæ•°å­—çš„ç›®æ ‡ä½ç½®çš„äºŒè¿›åˆ¶æ˜¯åŸæ•°çš„äºŒè¿›åˆ¶ç¿»è½¬çš„ç»“æœï¼Œæ¯”å¦‚$1 = (01)_2,  2 = (10)_2$æ°å¥½æ˜¯ç›¸å¯¹åº”çš„ï¼Œäºæ˜¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ€§è´¨å…ˆå°†æ¯ä¸ªæ•°æ’åˆ—åˆ°æœ€ç»ˆä½ç½®ï¼Œå†é€ä¸€åˆå¹¶</p><h4 id="ä»£ç ï¼ˆè¿­ä»£ä¼˜åŒ–-FFT-ï¼‰"><a href="#ä»£ç ï¼ˆè¿­ä»£ä¼˜åŒ–-FFT-ï¼‰" class="headerlink" title="ä»£ç ï¼ˆè¿­ä»£ä¼˜åŒ–$FFT$ï¼‰"></a>ä»£ç ï¼ˆè¿­ä»£ä¼˜åŒ–$FFT$ï¼‰</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = (<span class="number">1</span> &lt;&lt; <span class="number">22</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span> (- <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mcomplex</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line"></span><br><span class="line">    mcomplex () &#123;&#125;</span><br><span class="line">    mcomplex (<span class="keyword">double</span> fx, <span class="keyword">double</span> fy) :</span><br><span class="line">        x (fx), y (fy) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    mcomplex <span class="keyword">operator</span> + (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mcomplex (x + p.x, y + p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    mcomplex <span class="keyword">operator</span> - (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mcomplex (x - p.x, y - p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    mcomplex <span class="keyword">operator</span> * (<span class="keyword">const</span> mcomplex&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mcomplex (x * p.x - y * p.y, x * p.y + y * p.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function">mcomplex <span class="title">omega</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mcomplex (<span class="built_in">cos</span> (<span class="number">2.0</span> * PI * (<span class="keyword">double</span>) k / (<span class="keyword">double</span>) n), <span class="number">1.0</span> * inv * <span class="built_in">sin</span> (<span class="number">2.0</span> * PI * (<span class="keyword">double</span>) k / (<span class="keyword">double</span>) n));</span><br><span class="line">&#125;</span><br><span class="line">mcomplex A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> oppo[MAXN];</span><br><span class="line"><span class="keyword">int</span> limit;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span> <span class="params">(mcomplex* a, <span class="keyword">int</span> inv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i ++)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; oppo[i])</span><br><span class="line">            swap (a[i], a[oppo[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        mcomplex ome = mcomplex (<span class="built_in">cos</span> (PI / (<span class="keyword">double</span>) mid), inv * <span class="built_in">sin</span> (PI / (<span class="keyword">double</span>) mid));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> n = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; limit; j += n) &#123;</span><br><span class="line">            mcomplex x = mcomplex (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k ++, x = x * ome) &#123;</span><br><span class="line">                mcomplex a1 = a[j + k], xa2 = x * a[j + k + mid];</span><br><span class="line">                a[j + k] = a1 + xa2;</span><br><span class="line">                a[j + k + mid] = a1 - xa2;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    N = getnum (), M = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i ++)</span><br><span class="line">        A[i].x = (<span class="keyword">double</span>) getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= M; i ++)</span><br><span class="line">        B[i].x = (<span class="keyword">double</span>) getnum ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n, lim = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= N + M; n &lt;&lt;= <span class="number">1</span>, lim ++);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">        oppo[i] = (oppo[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (lim - <span class="number">1</span>));</span><br><span class="line">    limit = n;</span><br><span class="line">    FFT (A, <span class="number">1</span>);</span><br><span class="line">    FFT (B, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)</span><br><span class="line">        A[i] = A[i] * B[i];</span><br><span class="line">    FFT (A, - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N + M; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i)</span><br><span class="line">            <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d"</span>, (<span class="keyword">int</span>) (A[i].x / n + <span class="number">0.5</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ã€€ã€€è¿™æ ·çš„$FFT$å¯ä»¥åœ¨$O(n  logn)$çš„æ—¶é—´å†…æ±‚å‡ºå¤šé¡¹å¼ä¹˜æ³•çš„å„é¡¹ç³»æ•°ï¼Œä¸»è¦æµç¨‹ï¼šå°†ä¸¤ä¸ªå¤šé¡¹å¼åˆ†åˆ«è½¬åŒ–æˆç‚¹å€¼è¡¨ç¤º $\dashrightarrow$ é€šè¿‡ç‚¹å€¼è¡¨ç¤ºå°†ä¸¤ä¸ªå¤šé¡¹å¼åˆå¹¶ $\dashrightarrow$ é€šè¿‡ç¦»æ•£å‚…é‡Œå¶é€†å˜æ¢å°†ç‚¹å€¼è¡¨ç¤ºè½¬åŒ–æˆç³»æ•°è¡¨ç¤ºï¼Œå³å¾—è§£</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.cnblogs.com/RabbitHu/p/FFT.html" target="_blank" rel="noopener">[å°å­¦ç”Ÿéƒ½èƒ½çœ‹æ‡‚çš„FFTï¼ï¼ï¼]</a></p><p><a href="https://www.cnblogs.com/zwfymqz/p/8244902.html" target="_blank" rel="noopener">[å¿«é€Ÿå‚…é‡Œå¶å˜æ¢(FFT)è¯¦è§£]</a></p><p><a href="https://blog.csdn.net/qq_39670434/article/details/79678103" target="_blank" rel="noopener">[å¤æ•°â€”â€”æ¦‚å¿µå’Œä»£æ•°è¿ç®—]</a></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šé¡¹å¼ </tag>
            
            <tag> FFT/NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF917D Stranger Trees</title>
      <link href="/2020/08/04/CF917D%20Stranger%20Trees/"/>
      <url>/2020/08/04/CF917D%20Stranger%20Trees/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Solution-â… "><a href="#Solution-â… " class="headerlink" title="Solution â… "></a>Solution â… </h2><p>ä¸€é“æœ‰ç‚¹æœ‰è¶£çš„æ ‘å½¢ $dp$ + å®¹æ–¥ï¼Œåæ­£ç»•äº†æˆ‘åŠå¤©ï¼Œè¿™ä¹ˆç¥ä»™æˆ‘ä¹Ÿä¸å¯èƒ½å†™å‡ºæ¥</p><p>é¦–å…ˆè€ƒè™‘åŸºæœ¬æ€è·¯ï¼Œç›´æ¥æ±‚è§£æ°å¥½ $k$ ä¸ªè¾ƒéš¾ï¼Œæ•…è€ƒè™‘å…ˆæ±‚è§£å¤§äºç­‰äº $k$ çš„ç›¸ä¼¼åº¦çš„æ–¹æ¡ˆæ•°ï¼Œç„¶åå†å®¹æ–¥</p><p>è€ƒè™‘é€‰å®šäº†å¿…é€‰çš„è‹¥å¹²æ¡è¾¹åè®¡ç®—æ–¹æ¡ˆæ•°ã€‚æ˜¾ç„¶æ­¤æ—¶æ•´ä¸ªå›¾è¢«åˆ†æˆäº†è‹¥å¹²è¿é€šå—ï¼Œå‡è®¾æœ‰ $k$ ä¸ªè¿é€šå—ï¼Œå°†è¿é€šå—ç¼©ç‚¹ï¼Œè€ƒè™‘å®ƒä»¬å¯ä»¥ç»„æˆçš„æ ‘çš„æ–¹æ¡ˆæ•°ï¼Œæœ¬æ¥åº”è¯¥æ˜¯ $k^{k - 2}$ï¼Œç„¶è€Œå¯¹äºæ¯ä¸ªè¿é€šå—çš„ç¼©ç‚¹ï¼Œå®ƒå¯ä»¥å‘å…¶å®ƒè¿é€šå—ä¸­åŒ…å«çš„ä»»æ„ä¸€ç‚¹è¿æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ purfer åºåˆ—ä¸­ï¼Œåº”å½“è€ƒè™‘è¿é€šå—å†…çš„ç‚¹ç¼–å·åœ¨åºåˆ—ä¸­çš„å‡ºç°æƒ…å†µï¼Œè€Œä¸æ˜¯ä»…ä»…è€ƒè™‘è¿é€šå—ç¼–å·å‡ºç°åœ¨åºåˆ—ä¸­ï¼Œæ•… prufer åºåˆ—ä¸­çš„æ¯ä¸ªä½ç½®å¯ä»¥å¡« $n$ ä¸ªæ•°ï¼Œå³ $n^{k - 2}$ï¼Œç„¶è€Œè€ƒè™‘äº†çˆ¶äº²ï¼Œè¿˜éœ€è¦è€ƒè™‘å„¿å­ï¼Œä½œä¸ºå¶å­èŠ‚ç‚¹çš„ç¼©ç‚¹åçš„è¿é€šå—ï¼ŒåŒæ ·çš„é‡Œé¢ä¹Ÿæ˜¯ä»»æ„ç‚¹å‘å¤–è¿è¾¹ï¼Œæ•…è¿˜éœ€ä¹˜ä¸Š $\prod size_i$ï¼Œå…¶ä¸­ï¼Œ$size_i$ ä¸ºè¿é€šå— $i$ çš„å¤§å°ï¼Œé‚£ä¹ˆç»¼ä¸Šï¼Œå¯¹äºä¸€ä¸ªå­˜åœ¨ $k$ ä¸ªè¿é€šå—çš„å›¾ï¼Œå…¶æ„é€ çš„ç”Ÿæˆæ ‘çš„æ–¹æ¡ˆæ•°ä¸º $n^{k - 2} \times \prod size_i$</p><p>é‚£ä¹ˆç°åœ¨è€ƒè™‘æ±‚è§£ $\prod size_i$ï¼Œä½¿ç”¨æ ‘å½¢ $dp$ æ±‚è§£</p><p>ä»¤ $f_{root, i, j}$ è¡¨ç¤ºä»¥ $root$ ä¸ºæ ¹ï¼Œæ€»è®¡ $j$ ä¸ªè¿é€šå—ï¼Œ$root$ æ‰€åœ¨çš„è¿é€šå—å¤§å°ä¸º $j$ çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå¯¹äº $root$ çš„æ¯ä¸ªå„¿å­æœ‰é€‰æˆ–ä¸é€‰çš„ä¸¤ç§æƒ…å†µï¼Œæšä¸¾å…¶å„¿å­ $son$ çš„è¿é€šå—ä¸ªæ•° $k$ åŠ $son$ æ‰€åœ¨è¿é€šå—å¤§å° $l$ï¼š</p><ul><li>é€‰ï¼š$f_{root, i + k - 1, j + l} += f_{root, i, j} \times f_{son, k, l}$</li><li>ä¸é€‰ï¼š$f_{root, i + k, j} = f_{root, i, j} \times f_{son, k, l} \times l$</li></ul><p>æ³¨æ„æ¯æ¬¡çš„ $\times size_i$ æ˜¯åœ¨æ•´ä¸ªè¿é€šå— $i$ å·²ç»ç¡®å®šä¸‹æ¥çš„æ—¶å€™æ‰èƒ½ä¹˜ï¼Œæ•…åœ¨å…¶çˆ¶äº²æ‰«æåˆ°å½“å‰èŠ‚ç‚¹çš„æ—¶å€™æ‰ä¹˜ä¸Šå…¶æ‰€åœ¨è¿é€šå—å¤§å°</p><p>å†ç»™å‡º $g_i = \sum\limits_{i = 1}^n\sum\limits_{j = 1}^{n - i + 1} n^{i - 2}f_{1, i, j} \times j$</p><p>æ³¨æ„æ­¤æ—¶çš„ $g_k$ å¹¶ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å¤§äºç­‰äº $k$ çš„ç›¸ä¼¼åº¦çš„ç­”æ¡ˆï¼Œè€Œæ˜¯å¯¹äºæ¯ä¸€ç§ä½¿ç”¨å¤§äºç­‰äº $k$ æ¡é‡å¤è¾¹åˆ†å‰²è¿é€šå—çš„æ–¹æ¡ˆæ•°ï¼Œå†æ‰©å±•æˆæ ‘æ—¶ä¼šé‡å¤ï¼Œæ•… $g_i - g_{i + 1}$ å¹¶ä¸æ˜¯ $ans_i$ï¼Œé‚£ä¹ˆæ­¤æ—¶å†è¿›è¡Œå®¹æ–¥ï¼Œå³<br>$$<br>g_i = g_i - \sum\limits_{j = i + 1}^{n - 1} g_j\dbinom{j}{i}<br>$$<br>å³å¯¹äºæ¯ä¸€ç»„æ°å¥½ $j$ æ¡é‡å¤è¾¹çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆåœ¨æ¯ä¸€ç»„æ–¹æ¡ˆä¸­é€‰å‡ºä»»æ„ $i$ æ¡è¾¹å³å¯ç»„æˆ $g_i$ ä¸­çš„ä¸€ç§æ–¹æ¡ˆï¼Œæ•…å…¶æ–¹æ¡ˆæ•°çš„æ€»å’Œå³ä¸º $g_i$ å¤šç®—çš„æ–¹æ¡ˆæ•°</p><p>æ­¤æ—¶ $g_i$ å³ä¸ºè§£</p><p>å¤æ‚åº¦ $O (n^4)$</p><p>å¤æ‚åº¦è¯æ˜</p><p>æ±‚è§£ $S = \sum\limits_{i = 1}^n size_i^2 \big(\sum\limits size_{son}^2\big)$ æœ€å¤§å€¼</p><p>ç°åœ¨è€ƒè™‘å¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ $i$ï¼Œæ±‚è§£ $size_i^2 \big(\sum\limits size_{son}^2\big)$ æœ€å¤§å€¼</p><p>ä»¤ $i$ çš„å„¿å­é›†åˆä¸º $SON$ï¼Œåˆ™æœ‰ $\sum\limits_{j \in SON} size_j = size_i - 1$ï¼Œæ±‚è§£ $\sum\limits_{j \in SON} size_j^2$ æœ€å¤§å€¼</p><p>å› ä¸º $(size_i - 1)^2 = (\sum\limits_{j \in SON} size_j)^2 \ge \sum\limits_{j \in SON} size_j^2$ï¼Œæ•…å½“ $SON$ å¤§å°ä¸º $1$ æ—¶ä¸Šå¼å–æœ€å¤§å€¼</p><p>æ˜¾ç„¶ $S_{max}$ éšç€ $n$ è€Œé€’å¢ï¼Œåˆç”±äºå¯¹äºæ‰€æœ‰ $SON$ å¤§å°ä¸º $1$ æ—¶çš„ç‚¹ $i$ å…¶ $size_i^2 = t_1$ï¼Œå¯¹äºå…¶å®ƒä»»æ„æƒ…å†µç‚¹ $i$ çš„ $size_i^2 = t_2$ï¼Œæ˜¾ç„¶å¯ä»¥å¯¹è¿™äº›æœ‰æ ‡å·ç‚¹æ‰¾åˆ°ä¸€ç§æ’åˆ—ä½¿å¾—å¯¹äº $\forall i$ï¼Œ å­˜åœ¨ $t_1 \ge t_2$ï¼Œæ•…è¿™æ ·åˆ™å¯ä½¿å¾— $S$ å–æœ€å¤§å€¼ï¼Œæ­¤æ—¶è¯¥æ ‘ä¸ºä¸€æ¡é“¾ï¼Œ$S_{max} = \sum\limits_{i = 1}^n i^2 = \frac{(2n +1)n(n + 1)}{6}$ï¼Œæ•…å¤æ‚åº¦ä¸Šé™ä¸º $O (n^4)$</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">p = (p + MOD - <span class="number">1</span>) % (MOD - <span class="number">1</span>);</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL fact[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function">LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> fact[n] * power (fact[m], MOD - <span class="number">2</span>) % MOD * power (fact[n - m], MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL f[MAXN][MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL temp[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">subsize[root] = f[root][<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> p = Head[root]; p; p = Link[p].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[p].to;</span><br><span class="line"><span class="keyword">if</span> (v == father) <span class="keyword">continue</span>;</span><br><span class="line">DFS (v, root);</span><br><span class="line"><span class="built_in">memset</span> (temp, <span class="number">0</span>, <span class="keyword">sizeof</span> (temp));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= subsize[root]; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= subsize[root] - i + <span class="number">1</span>; j ++)</span><br><span class="line"><span class="keyword">if</span> (f[root][i][j])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= subsize[v]; k ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= subsize[v] - k + <span class="number">1</span>; l ++) &#123;</span><br><span class="line">temp[i + k - <span class="number">1</span>][j + l] = (temp[i + k - <span class="number">1</span>][j + l] + f[root][i][j] * f[v][k][l] % MOD) % MOD; <span class="comment">// select</span></span><br><span class="line">temp[i + k][j] = (temp[i + k][j] + f[root][i][j] * f[v][k][l] % MOD * l % MOD) % MOD; <span class="comment">// do not select</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memcpy</span> (f[root], temp, <span class="keyword">sizeof</span> (f[root]));</span><br><span class="line">subsize[root] += subsize[v];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL g[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) output (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">Insert (u, v), Insert (v, u);</span><br><span class="line">&#125;</span><br><span class="line">DFS (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ç›¸ä¼¼åº¦ n - k</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">LL base = power (<span class="number">1l</span>l * N, i - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N - i + <span class="number">1</span>; j ++) &#123;</span><br><span class="line">g[N - i] = (g[N - i] + base * f[<span class="number">1</span>][i][j] % MOD * j % MOD) % MOD;</span><br><span class="line"><span class="keyword">if</span> (N - i == <span class="number">1</span>)</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Test: "</span> &lt;&lt; f[<span class="number">1</span>][i][j] % MOD % MOD &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j ++)</span><br><span class="line">g[i] = (g[i] - g[j] * C (j, i) % MOD + MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">output (g[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="Solution-â…¡"><a href="#Solution-â…¡" class="headerlink" title="Solution â…¡"></a>Solution â…¡</h2><p>è¿™æ˜¯ä¸€ä¸ªçŸ©é˜µæ ‘å®šç†çš„è§£æ³•</p><p>è¿™ä¸ã€Œ<a href="https://www.luogu.org/problem/P5296" target="_blank" rel="noopener">[åŒ—äº¬çœé€‰é›†è®­2019]ç”Ÿæˆæ ‘è®¡æ•°</a>ã€æä¸ºç›¸ä¼¼ï¼Œéƒ½æ˜¯å¤šé¡¹å¼çŸ©é˜µæ ‘å®šç†</p><p>å¯¹äºä¸åœ¨ç»™å®šæ ‘ä¸Šçš„è¾¹å°†å…¶æƒå€¼èµ‹ä¸º $1$ï¼Œå¯¹äºåœ¨ç»™å®šæ ‘ä¸Šçš„è¾¹å°†å…¶æƒå€¼èµ‹ä¸º $x$ï¼ˆå³å¤šé¡¹å¼ $x$ï¼‰ï¼Œç„¶åçŸ©é˜µæ ‘å®šç†å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€è§„åˆ’ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘å½¢DP </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1187F Expected Square Beauty</title>
      <link href="/2020/08/04/CF1187F%20Expected%20Square%20Beauty/"/>
      <url>/2020/08/04/CF1187F%20Expected%20Square%20Beauty/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>ç¬¬ä¸€æ¬¡åšåˆ°è¿™ç§ç±»ä¼¼ä»£æ•°æ–¹æ³•è¿ç”¨æœŸæœ›æ€§è´¨çš„é¢˜çš„è¯´</p><p>æœŸæœ›æ€§è´¨ï¼š</p><ul><li>å¯¹äºä¸¤ä¸ªç‹¬ç«‹çš„å¯¹è±¡ $A, B$ï¼Œåˆ™æœ‰ $E (AB) = E(A)E(B)â€‹$</li><li>çº¿æ€§æ€§ï¼šå¯¹äºå¯¹è±¡ $X, Yâ€‹$ï¼Œå­˜åœ¨ $E(aX + bY) = aE(x) + bE(Y)â€‹$</li></ul><p>é¦–å…ˆè®¾è®¡å‡½æ•° $I_i(x) = \begin{cases} 1     x_i \neq x_{i - 1} \ 0     x_i = x_{i - 1} \end{cases} (i &gt; 1), ~ I_1(x) = 1â€‹$ï¼Œåˆ™æœ‰ $B(x) = \sum\limits_{i = 1}^n I_i(x)â€‹$ï¼Œæ•…<br>$$<br>\begin{aligned}<br>E (B^2(x)) &amp;= E (\sum\limits_{i = 1}^n I_i(x)\sum\limits_{j = 1}^n I_j(x)) \\<br>&amp;= E (\sum\limits_{i = 1}^n\sum\limits_{j = 1}^n I_i(x)I_j(x)) \\<br>&amp;= \sum\limits_{i = 1}^n\sum\limits_{j = 1}^n E(I_i(x)I_j(x))<br>\end{aligned}<br>$$<br>æ˜“çŸ¥ï¼Œè‹¥ $x_i = x_{i - 1}â€‹$ çš„æ¦‚ç‡ $p_i = \frac{\min(r_{i - 1}, r_i) - \max (l_{i - 1}, l_i) + 1}{(r_{i - 1} - l_{i - 1} + 1)(r_i - l_i + 1)}â€‹$ï¼Œé‚£ä¹ˆ $x_i \neq x_{i - 1}â€‹$ çš„æ¦‚ç‡ï¼Œå³ $E(I_i(x)) = 1 - p_iâ€‹$ï¼Œç‰¹åˆ«åœ°ï¼Œ$p_1 = 0, E(I_1(x)) = 1â€‹$</p><p>é‚£ä¹ˆæ­¤æ—¶å¯¹ $E (I_i(x)I_j(x))â€‹$ è¿›è¡Œè®¨è®ºï¼š</p><p>è‹¥ $i = j$ï¼Œåˆ™ $E(I_i(x)I_j(x)) = E(I_i(x))$</p><p>è‹¥ $|i - j| &gt; 1â€‹$ï¼Œé‚£ä¹ˆ $I_i(x)â€‹$ ä¸ $I_j(x)â€‹$ åˆ†åˆ«ç‹¬ç«‹ï¼Œæ•… $E(I_i(x)I_j(x)) = E(I_i(x))E(I_j(x))â€‹$</p><p>è‹¥ $|i - j| = 1â€‹$ï¼Œä»¤ $i + 1 = jâ€‹$ï¼Œé‚£ä¹ˆè¿›è¡Œå®¹æ–¥ï¼Œå³ $E(I_i(x)I_{i- 1}(x)) = 1 - p_{i - 1} - p_i + P ((x_{i - 2} == x_{i - 1}) \bigcup (x_{i - 1} == x_i))â€‹$ï¼Œæ ¹æ® $E(I_i(x))â€‹$ çš„è®¡ç®—æ–¹æ³•ï¼Œæ˜“çŸ¥ï¼Œ$P ((x_{i - 2} = x_{i - 1}) \bigcup (x_{i - 1} = x_i)) =  \frac{\min(r_{i - 2}, r_{i - 1}, r_i) - \max (l_{i - 2}, l_{i - 1}, l_i) + 1}{(r_{i - 2} - l_{i - 2} + 1)(r_{i - 1} - l_{i - 1} + 1)(r_i - l_i + 1)}â€‹$ï¼Œç‰¹åˆ«åœ°ï¼Œ$E(I_1(x)I_2(x)) = E(I_2(x))â€‹$</p><p>ç»¼ä¸Šï¼Œæœ€åç­”æ¡ˆä¸º</p><p>$E(B^2(x)) = \sum\limits_{i = 1}^n(p_i + \sum\limits_{|i - j| &gt; 1} p_j) + 2\sum\limits_{i = 2}^n E(I_i(x)I_{i - 1}(x))$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> l[MAXN], r[MAXN];</span><br><span class="line"><span class="keyword">int</span> size[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">LL p[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL psum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) l[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) r[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) size[i] = r[i] - l[i] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">LL nume = max (<span class="number">0</span>, min (r[i - <span class="number">1</span>], r[i]) - max (l[i - <span class="number">1</span>], l[i]) + <span class="number">1</span>);</span><br><span class="line">LL base = <span class="number">1l</span>l * size[i - <span class="number">1</span>] * size[i] % MOD;</span><br><span class="line">p[i] = nume * power (base, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">psum[i] = (psum[i - <span class="number">1</span>] + (<span class="number">1l</span>l - p[i] + MOD) % MOD) % MOD;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) ans = (ans + (<span class="number">1l</span>l - p[i] + MOD) % MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i - <span class="number">2</span> &gt;= <span class="number">1</span>) ans = (ans + (<span class="number">1l</span>l - p[i] + MOD) % MOD * psum[i - <span class="number">2</span>] % MOD) % MOD;</span><br><span class="line"><span class="keyword">if</span> (i + <span class="number">2</span> &lt;= N)</span><br><span class="line">ans = (ans + (<span class="number">1l</span>l - p[i] + MOD) % MOD * ((psum[N] - psum[i + <span class="number">1</span>] + MOD) % MOD) % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">LL part3 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (N &gt; <span class="number">1</span>) part3 = (<span class="number">1l</span>l - p[<span class="number">2</span>] + MOD) % MOD;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">LL nume = max (<span class="number">0</span>, min (r[i - <span class="number">2</span>], min (r[i - <span class="number">1</span>], r[i])) - max (l[i - <span class="number">2</span>], max (l[i - <span class="number">1</span>], l[i])) + <span class="number">1</span>);</span><br><span class="line">LL base = <span class="number">1l</span>l * size[i - <span class="number">2</span>] * size[i - <span class="number">1</span>] % MOD * size[i] % MOD;</span><br><span class="line">LL per = ((<span class="number">1l</span>l - p[i - <span class="number">1</span>] - p[i] + nume * power (base, MOD - <span class="number">2</span>) % MOD) % MOD + MOD) % MOD;</span><br><span class="line">part3 = (part3 + per) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">part3 = part3 * <span class="number">2l</span>l % MOD;</span><br><span class="line">ans = (ans + part3) % MOD;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">1 2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">3 4 5</span></span><br><span class="line"><span class="comment">4 5 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°è®º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BZOJ3277 - ä¸²</title>
      <link href="/2020/08/04/BZOJ3277%20-%20%E4%B8%B2/"/>
      <url>/2020/08/04/BZOJ3277%20-%20%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç°åœ¨ç»™å®šä½ nä¸ªå­—ç¬¦ä¸²ï¼Œè¯¢é—®æ¯ä¸ªå­—ç¬¦ä¸²æœ‰å¤šå°‘å­ä¸²ï¼ˆä¸åŒ…æ‹¬ç©ºä¸²ï¼‰æ˜¯æ‰€æœ‰nä¸ªå­—ç¬¦ä¸²ä¸­è‡³å°‘kä¸ªå­—ç¬¦ä¸²çš„å­ä¸²ï¼ˆæ³¨æ„åŒ…æ‹¬æœ¬èº«ï¼‰ã€‚</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>é¦–å…ˆæ˜¯å¹¿ä¹‰åç¼€è‡ªåŠ¨æœºï¼Œå°±æ˜¯æ¯æ¬¡å°†$last$å½’ä¸º$Root$ï¼Œä»è€Œå°†å‡ ä¸ªåç¼€è‡ªåŠ¨æœºæ‹¼åœ¨ä¸€èµ·å¤„ç†</p><p>é‚£ä¹ˆç°åœ¨éœ€è¦çŸ¥é“æ¯ä¸ªå­—ä¸²åœ¨$n$ä¸ªæ¯ä¸²ä¸­çš„å‡ºç°æ¬¡æ•°ï¼Œæ‰€è°“å­—ä¸²ï¼Œå°±æ˜¯æ‰€æœ‰å‰ç¼€çš„æ‰€æœ‰åç¼€ï¼Œæ‰€ä»¥å¯ä»¥é¡ºç€å‰ç¼€èµ°ï¼Œé‚£ä¹ˆé€šè¿‡$Parent$æ ‘æ‰¾åç¼€ï¼Œä¸€ç›´å¾€ä¸Šè·³ï¼Œé‚£ä¹ˆéœ€è¦åŠ ä¸€çš„æ‰€æœ‰åç¼€å°±æ˜¯æ‰€å±æ¯ä¸²å¹¶éå½“å‰æ¯ä¸²çš„é‚£å‡ ä¸ª</p><p>æ­¤æ—¶å†æ•´ç†å‡ºæ¯ä¸ªæ‰€å±æ¯ä¸²ä¸ªæ•°$Size &gt;= K$çš„åˆå§‹è´¡çŒ®ï¼Œå³$Len[i] - Len[Father[i]]$ï¼Œåä¹‹èµ‹$0$</p><p>åˆå­ä¸²ä¸ºå‰ç¼€çš„åç¼€ï¼Œé‚£ä¹ˆä¸€ä¸ªèŠ‚ç‚¹çš„è´¡çŒ®å³ä¸ºå®ƒç¥–å…ˆè‡³å®ƒæœ¬èº«çš„è´¡çŒ®å‰ç¼€å’Œï¼Œå³å®ƒæ‰€æœ‰åç¼€èƒ½å¤Ÿæ„æˆçš„å­ä¸²æ•°</p><p>æœ€åå†éå†ä¸€éå‰ç¼€ç»Ÿè®¡ç­”æ¡ˆå³å¯</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">6e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="built_in">string</span> Str[MAXN &gt;&gt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Root = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> Tree[MAXN][<span class="number">30</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Len[MAXN]= &#123;<span class="number">0</span>&#125;, Size[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> Belong[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> last = Root, nodes = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Append</span> <span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> bel)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fa = last, p = ++ nodes;</span><br><span class="line">    last = p;</span><br><span class="line">    Len[p] = Len[fa] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (fa &amp;&amp; ! Tree[fa][c])</span><br><span class="line">        Tree[fa][c] = p, fa = Father[fa];</span><br><span class="line">    <span class="keyword">if</span> (! fa)</span><br><span class="line">        Father[p] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> x = Tree[fa][c];</span><br><span class="line">        <span class="keyword">if</span> (Len[x] == Len[fa] + <span class="number">1</span>)</span><br><span class="line">            Father[p] = x;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> np = ++ nodes;</span><br><span class="line">            Len[np] = Len[fa] + <span class="number">1</span>, Father[np] = Father[x];</span><br><span class="line">            Father[p] = Father[x] = np;</span><br><span class="line">            <span class="built_in">memcpy</span> (Tree[np], Tree[x], <span class="keyword">sizeof</span> (Tree[x]));</span><br><span class="line">            <span class="keyword">while</span> (fa &amp;&amp; Tree[fa][c] == x)</span><br><span class="line">                Tree[fa][c] = np, fa = Father[fa];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> Topo[MAXN];</span><br><span class="line"><span class="keyword">int</span> W[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> buck[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Merge</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = Str[i].size();</span><br><span class="line">        <span class="keyword">int</span> p = Root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++) &#123;</span><br><span class="line">            p = Tree[p][Str[i][j] - <span class="string">'a'</span>];</span><br><span class="line">            <span class="keyword">int</span> fa = p;</span><br><span class="line">            <span class="keyword">while</span> (fa &amp;&amp; Belong[fa] != i) &#123;</span><br><span class="line">                Size[fa] ++;</span><br><span class="line">                Belong[fa] = i;</span><br><span class="line">                fa = Father[fa];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">        buck[Len[i]] ++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">        buck[i] += buck[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = nodes; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">        Topo[buck[Len[i]] --] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">        <span class="keyword">if</span> (Size[i] &gt;= K)</span><br><span class="line">            W[i] = Len[i] - Len[Father[i]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nodes; i ++)</span><br><span class="line">        W[Topo[i]] += W[Father[Topo[i]]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL Answer[MAXN &gt;&gt; <span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span> (<span class="string">"%d%d"</span>, &amp; N, &amp; K);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; Str[i];</span><br><span class="line">        <span class="keyword">int</span> n = Str[i].size();</span><br><span class="line">        last = Root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            Append (Str[i][j] - <span class="string">'a'</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    Merge ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = Str[i].size();</span><br><span class="line">        <span class="keyword">int</span> p = Root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)</span><br><span class="line">            p = Tree[p][Str[i][j] - <span class="string">'a'</span>], Answer[i] += W[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">putchar</span> (<span class="string">' '</span>);</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%lld"</span>, Answer[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">abc</span></span><br><span class="line"><span class="comment">a</span></span><br><span class="line"><span class="comment">ab</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">aa</span></span><br><span class="line"><span class="comment">aaa</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­—ç¬¦ä¸² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åç¼€è‡ªåŠ¨æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BZOJ2959 - é•¿è·‘</title>
      <link href="/2020/08/04/BZOJ%202959%20-%20%E9%95%BF%E8%B7%91/"/>
      <url>/2020/08/04/BZOJ%202959%20-%20%E9%95%BF%E8%B7%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æ¯ä¸ªç‚¹æœ‰å„è‡ªçš„æƒå€¼ï¼Œè¦æ±‚ç»´æŠ¤æ“ä½œï¼šåŠ¨æ€åŠ è¾¹ã€åŠ¨æ€ä¿®æ”¹æƒå€¼ã€è¯¢é—®åœ¨æ¯ä¸ªç‚¹åªèƒ½ç»è¿‡ä¸€æ¬¡çš„æƒ…å†µä¸‹ä¸¤ç‚¹é—´è·¯ç¨‹ä¸­çš„æœ€å¤§æƒå€¼å’Œ</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é¦–å…ˆå¯¹äºä¸€ä¸ªé™æ€çš„å›¾ï¼Œå°†å…¶ç¼©ç‚¹ï¼Œå¯ä»¥å¾—åˆ°ä¸€æ£µæ ‘ï¼Œé‚£ä¹ˆä¸¤ç‚¹é—´è¯¢é—®çš„ç­”æ¡ˆå³ä¸ºå®ƒä»¬ä¹‹é—´ç»è¿‡çš„ $BCC$ çš„æƒå€¼å’Œ</p><p>æ”¯æŒåŠ¨æ€åŠ è¾¹ï¼Œå°±éœ€è¦ç”¨åˆ° $LCT$ å»ç»´æŠ¤ $BCC$</p><p>å¦‚æœä¸¤ä¸ªç‚¹æ‰€åœ¨ $BCC$ åœ¨ä¸åŒæ ‘ä¸Šï¼Œé‚£ä¹ˆç›´æ¥è¿è¾¹å³å¯ï¼›åä¹‹ï¼Œåˆ™è¯´æ˜å½¢æˆäº†ç¯ï¼Œå°±æš´åŠ›å°†è¿™æ¡é“¾æ‹–å‡ºæ¥ï¼Œç”¨é€‰å®šä¸€ä¸ªæ ‡å‡†èŠ‚ç‚¹ï¼Œç”¨å¹¶æŸ¥é›†å°†é“¾ä¸Šå…¶å®ƒèŠ‚ç‚¹è¿åˆ°æ ‡å‡†èŠ‚ç‚¹ä¸Šï¼Œå®¹æ˜“è¯æ˜ï¼Œè¿™æ ·çš„å¤æ‚åº¦æ˜¯å‡æ‘Š $O (\log n)$ çš„</p><p>æŸ¥è¯¢å³ä¿®æ”¹å®¹æ˜“å®ç°ï¼Œä¸åŠ èµ˜è¿°</p><p>æ³¨æ„ï¼Œæ­¤é¢˜æ²¡æœ‰åˆ è¾¹ï¼Œæ‰€ä»¥ $findroot$ å¯ç”¨å¦ä¸€ä¸ªå¹¶æŸ¥é›†ä»£æ›¿ï¼Œä¸ç„¶ä¼š $T$</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">15e04</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ances[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p == ances[p] ? p : ances[p] = find (ances[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lctanc[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lctfind</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p == lctanc[p] ? p : lctanc[p] = lctfind (lctanc[p]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL realval[MAXN];</span><br><span class="line"><span class="keyword">int</span> father[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> son[MAXN][<span class="number">2</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL Sum[MAXN]= &#123;<span class="number">0</span>&#125;, value[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> revtag[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> son[father[p]][<span class="number">0</span>] != p &amp;&amp; son[father[p]][<span class="number">1</span>] != p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sonbel</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> son[father[p]][<span class="number">1</span>] == p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (! p)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    swap (son[p][<span class="number">0</span>], son[p][<span class="number">1</span>]);</span><br><span class="line">    revtag[p] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    Sum[p] = Sum[son[p][<span class="number">0</span>]] + Sum[son[p][<span class="number">1</span>]] + value[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (revtag[p]) &#123;</span><br><span class="line">        reverse (son[p][<span class="number">0</span>]), reverse (son[p][<span class="number">1</span>]);</span><br><span class="line">        revtag[p] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fa = father[p], anc = father[fa];</span><br><span class="line">    <span class="keyword">int</span> s = sonbel (p);</span><br><span class="line">    son[fa][s] = son[p][s ^ <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (son[fa][s])</span><br><span class="line">        father[son[fa][s]] = fa;</span><br><span class="line">    <span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">        son[anc][sonbel (fa)] = p;</span><br><span class="line">    father[p] = anc;</span><br><span class="line">    son[p][s ^ <span class="number">1</span>] = fa, father[fa] = p;</span><br><span class="line">    pushup (fa), pushup (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> Stack[MAXN];</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    top = <span class="number">0</span>, Stack[++ top] = p;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> nd = p; ! isroot (nd); nd = father[nd])</span><br><span class="line">        Stack[++ top] = father[nd];</span><br><span class="line">    <span class="keyword">while</span> (top &gt; <span class="number">0</span>)</span><br><span class="line">        pushdown (Stack[top]), top --;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> fa = father[p]; ! isroot (p); rotate (p), fa = father[p])</span><br><span class="line">        <span class="keyword">if</span> (! isroot (fa))</span><br><span class="line">            sonbel (p) == sonbel (fa) ? rotate (fa) : rotate (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Access</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> tp = <span class="number">0</span>; p; tp = p, p = father[tp] = find (father[p])) <span class="comment">// æ³¨æ„å› ä¸ºæœ‰å¹¶æŸ¥é›†ï¼Œæ‰€ä»¥ä¹Ÿè¦åŒæ—¶æ›´æ–°father[tp]</span></span><br><span class="line">        splay (p), son[p][<span class="number">1</span>] = tp, pushup (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Makeroot</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    Access (p), splay (p), reverse (p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Split</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    Makeroot (x);</span><br><span class="line">    Access (y), splay (y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    Makeroot (x);</span><br><span class="line">    father[x] = y;</span><br><span class="line">    <span class="keyword">int</span> fx = lctfind (x), fy = lctfind (y);</span><br><span class="line">    lctanc[fx] = fy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> root)</span> </span>&#123; <span class="comment">// æš´åŠ›åˆå¹¶</span></span><br><span class="line">    <span class="keyword">if</span> (! p)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (p != root)</span><br><span class="line">        ances[p] = root, value[root] += value[p];</span><br><span class="line">    merge (son[p][<span class="number">0</span>], root), merge (son[p][<span class="number">1</span>], root);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line">    <span class="keyword">if</span> (fx == fy)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (lctfind (fx) != lctfind (fy)) &#123;</span><br><span class="line">        link (fx, fy);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    Split (fx, fy);</span><br><span class="line">    merge (fy, fy);</span><br><span class="line">    son[fy][<span class="number">0</span>] = son[fy][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    pushup (fy);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Modify</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fx = find (x);</span><br><span class="line">    splay (fx);</span><br><span class="line">    value[fx] -= realval[x] - val, realval[x] = val;</span><br><span class="line">    pushup (fx);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Query</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line">    <span class="keyword">if</span> (lctfind (fx) != lctfind (fy))</span><br><span class="line">        <span class="keyword">return</span> - <span class="number">1</span>;</span><br><span class="line">    Split (fx, fy);</span><br><span class="line">    <span class="keyword">return</span> Sum[fy];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">    <span class="keyword">int</span> isneg = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>)</span><br><span class="line">            isneg = <span class="number">1</span>;</span><br><span class="line">        ch = getchar ();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">        num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isneg ? - num : num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> answer[MAXN];</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N = getnum (), M = getnum ();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">        Sum[i] = value[i] = realval[i] = getnum (), lctanc[i] = ances[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">        <span class="keyword">int</span> type = getnum ();</span><br><span class="line">        <span class="keyword">int</span> x = getnum (), y = getnum ();</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>)</span><br><span class="line">            Add (x, y);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">2</span>)</span><br><span class="line">            Modify (x, y);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">3</span>)</span><br><span class="line">            <span class="built_in">printf</span> (<span class="string">"%lld\n"</span>, Query (x, y));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">9 31</span></span><br><span class="line"><span class="comment">10 20 30 40 50 60 70 80 90</span></span><br><span class="line"><span class="comment">3 1 2</span></span><br><span class="line"><span class="comment">1 1 3</span></span><br><span class="line"><span class="comment">1 1 2</span></span><br><span class="line"><span class="comment">1 8 9</span></span><br><span class="line"><span class="comment">1 2 4</span></span><br><span class="line"><span class="comment">1 2 5</span></span><br><span class="line"><span class="comment">1 4 6</span></span><br><span class="line"><span class="comment">1 4 7</span></span><br><span class="line"><span class="comment">3 1 8</span></span><br><span class="line"><span class="comment">3 8 8</span></span><br><span class="line"><span class="comment">1 8 9</span></span><br><span class="line"><span class="comment">3 8 8</span></span><br><span class="line"><span class="comment">3 7 5</span></span><br><span class="line"><span class="comment">3 7 3</span></span><br><span class="line"><span class="comment">1 4 1</span></span><br><span class="line"><span class="comment">3 7 5</span></span><br><span class="line"><span class="comment">3 7 3</span></span><br><span class="line"><span class="comment">1 5 7</span></span><br><span class="line"><span class="comment">3 6 5</span></span><br><span class="line"><span class="comment">3 3 6</span></span><br><span class="line"><span class="comment">1 2 4</span></span><br><span class="line"><span class="comment">1 5 5</span></span><br><span class="line"><span class="comment">3 3 6</span></span><br><span class="line"><span class="comment">2 8 180</span></span><br><span class="line"><span class="comment">3 8 8</span></span><br><span class="line"><span class="comment">2 9 190</span></span><br><span class="line"><span class="comment">3 9 9</span></span><br><span class="line"><span class="comment">2 5 150</span></span><br><span class="line"><span class="comment">3 3 6</span></span><br><span class="line"><span class="comment">2 1 210</span></span><br><span class="line"><span class="comment">3 3 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å›¾è®º,æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LCT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC003è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2020/08/04/AGC003%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
      <url>/2020/08/04/AGC003%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="D-Anticube"><a href="#D-Anticube" class="headerlink" title="D - Anticube"></a>D - Anticube</h2><p>è¯´å®è¯è´¨å› æ•°åˆ†è§£çš„é¢˜éƒ½æŒºæœ‰æ„æ€çš„</p><p>é¦–å…ˆå¯¹äºæ¯ä¸ªæ•°ï¼Œæ˜¾ç„¶é‡Œé¢å­˜åœ¨çš„è´¨æ•°ä¸‰æ¬¡æ–¹çš„å› å­éƒ½æ˜¯æ— è´¡çŒ®çš„ï¼Œé‚£ä¹ˆå°†å…¶çš„æ¯ä¸ªè´¨å› æ•°åŒ–ç®€ï¼Œå³å¯¹äºè´¨å› å­ $p^k$ï¼Œå°†å…¶å˜ä¸º $p^{k ~ mod ~  3}$</p><p>é‚£ä¹ˆä¸¤ä¸ªæ•°è‹¥ä¹˜ç§¯ä¸ºå®Œå…¨ç«‹æ–¹æ•°ï¼Œåˆ™å¿…é¡»æ»¡è¶³å®ƒä»¬çš„æ¯ä¸€ä¸ªç›¸åŒè´¨å› å­éƒ½æ˜¯â€œäº’è¡¥çš„â€ï¼ˆå³æ¬¡æ•°ç›¸åŠ ä¸º $0$ æˆ– $3$ï¼‰ï¼ŒåŒæ—¶æ˜¾ç„¶ä¸€å®šä¸å­˜åœ¨å¤§äºä¸€ä¸ª $&gt; \sqrt[3]n$ çš„è´¨å› æ•° $p$ï¼Œé‚£ä¹ˆè§£æ³•å°±å¾ˆæ˜¾ç„¶äº†</p><p>å°±æ˜¯ç­›å‡º $[2, \sqrt[3]n]$ çš„è´¨æ•°ï¼Œç„¶åå¯¹æ¯ä¸€ä¸ªæ•°è¿›è¡ŒåŒ–ç®€ï¼Œç„¶åå°†åŒ–ç®€åçš„æ•°çš„è®¡æ•°å™¨åŠ ä¸€ï¼Œæœ€ååœ¨æ‰€æœ‰ä¸¤ä¸¤â€œäº’è¡¥â€çš„æ•°ä¸­å– $max$ æ±‚å’Œå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2200</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">LL a[MAXN], newa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXM]= &#123;<span class="number">0</span>&#125;, pcnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXM]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">2200</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAX; i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (visit[i]) <span class="keyword">continue</span>;</span><br><span class="line">prime[++ pcnt] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i &lt;&lt; <span class="number">1</span>; j &lt;= MAX; j += i)</span><br><span class="line">visit[j] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tr1::<span class="built_in">unordered_map</span>&lt;LL, <span class="keyword">int</span>&gt; mapp, ccnt;</span><br><span class="line"><span class="keyword">int</span> ind = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= p; j ++)</span><br><span class="line">cnt *= x;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;LL, LL&gt; save[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">save[++ ind] = make_pair (<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">mapp[<span class="number">0</span>] = mapp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">LL p = a[i];</span><br><span class="line">LL cnt = <span class="number">1</span>, ano = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pcnt; j ++)</span><br><span class="line"><span class="keyword">if</span> (! (p % prime[j])) &#123;</span><br><span class="line"><span class="keyword">int</span> times = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (! (p % prime[j]))</span><br><span class="line">p /= prime[j], times ++;</span><br><span class="line">times %= <span class="number">3</span>;</span><br><span class="line"><span class="keyword">if</span> (times &gt; <span class="number">0</span>)</span><br><span class="line">ano *= power (prime[j], <span class="number">3</span> - times);</span><br><span class="line">cnt *= power (prime[j], times);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (a[i] != <span class="number">1</span> &amp;&amp; cnt == <span class="number">1</span> &amp;&amp; p == <span class="number">1</span>) &#123;</span><br><span class="line">ccnt[<span class="number">0</span>] ++;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">ccnt[cnt * p] ++, newa[i] = cnt * p;</span><br><span class="line"><span class="keyword">if</span> (mapp[cnt * p]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (p &gt; <span class="number">1</span>) &#123;</span><br><span class="line">LL sqr = <span class="built_in">sqrt</span> (p);</span><br><span class="line"><span class="keyword">if</span> (sqr * sqr == p) &#123;</span><br><span class="line">save[++ ind] = make_pair (cnt * p, ano * sqr);</span><br><span class="line">mapp[cnt * p] = mapp[ano * sqr] = ind;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">save[++ ind] = make_pair (cnt, ano);</span><br><span class="line">mapp[cnt] = mapp[ano] = ind;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ccnt[<span class="number">0</span>] = min (ccnt[<span class="number">0</span>], <span class="number">1</span>), ccnt[<span class="number">1</span>] = min (ccnt[<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ind; i ++)</span><br><span class="line">ans += max (ccnt[save[i].first], ccnt[save[i].second]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! mapp[newa[i]])</span><br><span class="line">ans ++;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T num = T ();</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum&lt;<span class="keyword">int</span>&gt; ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum&lt;LL&gt; ();</span><br><span class="line">sieve ();</span><br><span class="line"><span class="keyword">int</span> ans = solve ();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">32</span></span><br><span class="line"><span class="comment">64</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">100</span></span><br><span class="line"><span class="comment">1000000007</span></span><br><span class="line"><span class="comment">10000000000</span></span><br><span class="line"><span class="comment">1000000009</span></span><br><span class="line"><span class="comment">999999999</span></span><br><span class="line"><span class="comment">999</span></span><br><span class="line"><span class="comment">999</span></span><br><span class="line"><span class="comment">999</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">100</span></span><br><span class="line"><span class="comment">2368593037</span></span><br><span class="line"><span class="comment">38192375</span></span><br><span class="line"><span class="comment">218391929</span></span><br><span class="line"><span class="comment">572421321</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">32</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="E-Sequential-operations-on-Sequence"><a href="#E-Sequential-operations-on-Sequence" class="headerlink" title="E - Sequential operations on Sequence"></a>E - Sequential operations on Sequence</h2><p>å…ˆè€ƒè™‘æ‰€æœ‰åªå­˜åœ¨å¢åŠ é•¿åº¦çš„æ“ä½œ</p><p>é‚£ä¹ˆå¯ä»¥ä»åå¾€å‰æšä¸¾ï¼Œè€ƒè™‘åé¢çš„æ“ä½œå¯¹å‰é¢çš„è´¡çŒ®</p><p>é‚£ä¹ˆå¯¹äºæ¯ä¸€ä¸ªä½ç½® $p$ï¼Œå®ƒç›¸å½“äºæ˜¯ç¬¬ä¸€ä¸ªå°äºå®ƒçš„ä½ç½® $q$ ç®— $p / q$ æ¬¡ï¼Œç„¶åå†ç®—ä¸€æ¬¡ $p ~ mod ~ q$ï¼Œæ•…é€’å½’å³å¯</p><p>ç„¶åå¯¹äºå‡å°‘é•¿åº¦çš„æ“ä½œï¼Œæ˜¾ç„¶è¯¥æ“ä½œä¹‹å‰æ‰€æœ‰é•¿åº¦å¤§äºç­‰äºå½“å‰é•¿åº¦çš„æ“ä½œéƒ½æ˜¯æ— ç”¨çš„ï¼Œæ•…åªéœ€åˆå§‹åŒ–æ—¶å–é€’å¢çš„æ“ä½œå³å¯è½¬åŒ–ä¸ºåªå­˜åœ¨å¢åŠ é•¿åº¦çš„æ“ä½œçš„é›†åˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL que[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> tail = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">LL suffix[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> value[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findpos</span> <span class="params">(<span class="keyword">int</span> limit, LL delta)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (delta &lt; que[<span class="number">1</span>]) <span class="keyword">return</span> delta;</span><br><span class="line"><span class="keyword">int</span> posi = upper_bound (que + <span class="number">1</span>, que + limit, delta) - que - <span class="number">1</span>;</span><br><span class="line">LL add = delta / que[posi], rest = delta % que[posi];</span><br><span class="line">suffix[posi] += suffix[limit] * add;</span><br><span class="line"><span class="keyword">return</span> findpos (limit, rest);</span><br><span class="line">&#125;</span><br><span class="line">LL subsum[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">value[<span class="number">1</span>] = que[<span class="number">1</span>], suffix[tail] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = tail; i &gt;= <span class="number">2</span>; i --) &#123;</span><br><span class="line"><span class="keyword">int</span> val = findpos (i, que[i]);</span><br><span class="line">value[i] = val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = tail; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">subsum[value[i]] += suffix[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --)</span><br><span class="line">subsum[i] += subsum[i + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">T num = T ();</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= <span class="number">10</span>) write (x / <span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span> (x % <span class="number">10</span> + <span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">println</span> <span class="params">(LL x)</span> </span>&#123;</span><br><span class="line">write (x), <span class="built_in">puts</span> (<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum&lt;<span class="keyword">int</span>&gt; (), M = getnum&lt;<span class="keyword">int</span>&gt; ();</span><br><span class="line">que[++ tail] = N;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">LL posi = getnum&lt;LL&gt; ();</span><br><span class="line"><span class="keyword">while</span> (tail &gt;= <span class="number">1</span> &amp;&amp; que[tail] &gt;= posi) tail --;</span><br><span class="line">que[++ tail] = posi;</span><br><span class="line">&#125;</span><br><span class="line">solve ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">println (subsum[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 3</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">11</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 10</span></span><br><span class="line"><span class="comment">9</span></span><br><span class="line"><span class="comment">13</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">9</span></span><br><span class="line"><span class="comment">19</span></span><br><span class="line"><span class="comment">22</span></span><br><span class="line"><span class="comment">27</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 10</span></span><br><span class="line"><span class="comment">15</span></span><br><span class="line"><span class="comment">22</span></span><br><span class="line"><span class="comment">12</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 10</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">26</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">12</span></span><br><span class="line"><span class="comment">12</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">20</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 10</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">24</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">16</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="F-Fraction-of-Fractal"><a href="#F-Fraction-of-Fractal" class="headerlink" title="F - Fraction of Fractal"></a><strong>F - Fraction of Fractal</strong></h2><p>äºæ˜¯æˆ‘åˆçœ‹é”™äº†ä¸€æ¬¡é¢˜ç›®ã€‚ã€‚</p><p>å¯¹äºå·¦å³ã€ä¸Šä¸‹å¤åˆ¶åéƒ½è¿é€šçš„æƒ…å†µï¼Œæ˜¾ç„¶ç­”æ¡ˆä¸º $1$</p><p>å¯¹äºå·¦å³ã€ä¸Šä¸‹å¤åˆ¶åéƒ½ä¸è¿é€šçš„æƒ…å†µï¼Œè®¾å…¶é»‘ç‚¹ä¸ªæ•°ä¸º $p$ï¼Œåˆ™ç­”æ¡ˆæ˜¾ç„¶ä¸º $p^{k - 1}$</p><p>é‚£ä¹ˆç°åœ¨å‡è®¾å·¦å³å¤åˆ¶åè¿é€šï¼Œä¸Šä¸‹å¤åˆ¶åä¸è¿é€šï¼Œä»¤å…¶æœ€ç»ˆçŠ¶æ€é»‘ç‚¹ä¸ªæ•° $x_n$ï¼Œå·¦å³è¿é€šçš„ç‚¹ç»„ï¼ˆå³ $##$ï¼‰ä¸ªæ•°ä¸º $y_n$ï¼Œé‚£ä¹ˆæ€è€ƒä¸€ä¸‹ï¼Œç­”æ¡ˆå³ä¸º $x_n - y_n$ï¼Œè€ƒè™‘è½¬ç§»ï¼Œé‚£ä¹ˆ $y_i$ ä¼šåªä¼šåœ¨æœ€å·¦ç«¯å’Œæœ€å³ç«¯è¿é€šæ—¶å¢åŠ ï¼Œæ•…ä»¤ $z_i$ è¡¨ç¤º $i$ çŠ¶æ€æ—¶æœ€å·¦å’Œæœ€å³è¿é€šçš„ä¸ªæ•°ï¼Œåˆ™è½¬ç§»å³ä¸º<br>$$<br>\begin{aligned}<br>x_i &amp;= x_{i - 1}^2 \\<br>y_i &amp;= x_{i - 1} \times y_{i - 1} + z_{i - 1} \times y_{i - 1} \\<br>z_i &amp;= z_{i - 1}^2<br>\end{aligned}<br>$$<br>ç„¶åå‘ç°è¿™æ ·å­æ»¡è¶³çŸ©é˜µä¹˜æ³•ï¼Œå³å¯æ„é€ çŸ©é˜µ<br>$$<br>\begin{bmatrix}<br>x_1 &amp; y_1 \\<br>0 &amp; z_1<br>\end{bmatrix}<br>$$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">LL cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p &amp; <span class="number">1</span>)</span><br><span class="line">cnt = cnt * x % MOD;</span><br><span class="line">x = x * x % MOD;</span><br><span class="line">p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">LL a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">Matrix () &#123;</span><br><span class="line"><span class="built_in">memset</span> (a, <span class="number">0</span>, <span class="keyword">sizeof</span> (a));</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix&amp; A, <span class="keyword">const</span> Matrix&amp; B) &#123;</span><br><span class="line">Matrix ret = Matrix ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span>; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">2</span>; j ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= <span class="number">2</span>; k ++)</span><br><span class="line">ret.a[i][j] = (ret.a[i][j] + A.a[i][k] * B.a[k][j] % MOD) % MOD;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">matpower</span> <span class="params">(Matrix x, LL k)</span> </span>&#123;</span><br><span class="line">Matrix ret = Matrix ();</span><br><span class="line">ret.a[<span class="number">1</span>][<span class="number">1</span>] = ret.a[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (k) &#123;</span><br><span class="line"><span class="keyword">if</span> (k &amp; <span class="number">1</span>)</span><br><span class="line">ret = ret * x;</span><br><span class="line">x = x * x;</span><br><span class="line">k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> (ret.a[<span class="number">1</span>][<span class="number">1</span>] - ret.a[<span class="number">1</span>][<span class="number">2</span>] + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL k;</span><br><span class="line"><span class="keyword">char</span> <span class="built_in">map</span>[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d%lld"</span>, &amp; N, &amp; M, &amp; k);</span><br><span class="line"><span class="keyword">int</span> tol = <span class="number">0</span>, toup = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> lr = <span class="number">0</span>, ud = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%s"</span>, <span class="built_in">map</span>[i] + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">map</span>[i][j] == <span class="string">'#'</span>) &#123;</span><br><span class="line">cnt ++;</span><br><span class="line">tol += <span class="built_in">map</span>[i][j - <span class="number">1</span>] == <span class="string">'#'</span>;</span><br><span class="line">toup += <span class="built_in">map</span>[i - <span class="number">1</span>][j] == <span class="string">'#'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">map</span>[i][<span class="number">1</span>] == <span class="string">'#'</span> &amp;&amp; <span class="built_in">map</span>[i][M] == <span class="string">'#'</span>) lr ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">map</span>[<span class="number">1</span>][j] == <span class="string">'#'</span> &amp;&amp; <span class="built_in">map</span>[N][j] == <span class="string">'#'</span>) ud ++;</span><br><span class="line"><span class="keyword">if</span> (! lr &amp;&amp; ! ud) &#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; power (<span class="number">1l</span>l * cnt, k - <span class="number">1</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (lr &amp;&amp; ud) &#123;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">"1"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (! lr) swap (lr, ud), swap (tol, toup);</span><br><span class="line">Matrix x = Matrix ();</span><br><span class="line">x.a[<span class="number">1</span>][<span class="number">1</span>] = cnt, x.a[<span class="number">1</span>][<span class="number">2</span>] = tol, x.a[<span class="number">2</span>][<span class="number">2</span>] = lr;</span><br><span class="line">LL ans = matpower (x, k - <span class="number">1</span>);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3 3</span></span><br><span class="line"><span class="comment">.#.</span></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="comment">#.#</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">11 15 1000000000000000000</span></span><br><span class="line"><span class="comment">.....#.........</span></span><br><span class="line"><span class="comment">....###........</span></span><br><span class="line"><span class="comment">....####.......</span></span><br><span class="line"><span class="comment">...######......</span></span><br><span class="line"><span class="comment">...#######.....</span></span><br><span class="line"><span class="comment">..##.###.##....</span></span><br><span class="line"><span class="comment">..##########...</span></span><br><span class="line"><span class="comment">.###.....####..</span></span><br><span class="line"><span class="comment">.####...######.</span></span><br><span class="line"><span class="comment">###############</span></span><br><span class="line"><span class="comment">#.##..##..##..#</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AtCoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC002è§£é¢˜æŠ¥å‘Š</title>
      <link href="/2020/08/04/AGC002%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
      <url>/2020/08/04/AGC002%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="D-Stamp-Rally"><a href="#D-Stamp-Rally" class="headerlink" title="D - Stamp Rally"></a>D - Stamp Rally</h2><p>æ•´ä½“äºŒåˆ† + å¹¶æŸ¥é›†å¸¸è§„æ“ä½œ</p><p>ä¸è¿‡è®°å¾—æ¯æ¬¡ä»…å°†å½“å‰é€’å½’æ—¶ä½¿ç”¨çš„å¹¶æŸ¥é›†åˆ å»å³å¯ï¼Œä¹‹å‰çš„ä¿ç•™ï¼Œæ‰€ä»¥å¯¹äºé‚£äº›è¢«å¿½ç•¥çš„ç­”æ¡ˆçš„ä½ç½®ï¼Œä¹Ÿéœ€è¦é€’å½’åˆ°ç„¶ååŠ å…¥å¹¶æŸ¥é›†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXQ = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; edge[MAXM];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> answer[MAXQ]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">querySt</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> index;</span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"><span class="keyword">int</span> lim;</span><br><span class="line"></span><br><span class="line">querySt (<span class="keyword">int</span> find = <span class="number">0</span>, <span class="keyword">int</span> fx = <span class="number">0</span>, <span class="keyword">int</span> fy = <span class="number">0</span>, <span class="keyword">int</span> flim = <span class="number">0</span>) :</span><br><span class="line">index (find), x (fx), y (fy), lim (flim) &#123;&#125;</span><br><span class="line">&#125; ;</span><br><span class="line">querySt query[MAXQ];</span><br><span class="line"></span><br><span class="line">querySt q1[MAXQ], q2[MAXQ];</span><br><span class="line"><span class="keyword">int</span> father[MAXN], subsize[MAXN];</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; <span class="built_in">stack</span>[MAXM];</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> father[x] == x ? x : find (father[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line"><span class="keyword">if</span> (fx == fy) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">if</span> (subsize[fx] &gt; subsize[fy]) swap (fx, fy);</span><br><span class="line">father[fx] = fy, subsize[fy] += subsize[fx];</span><br><span class="line"><span class="built_in">stack</span>[++ top] = make_pair (fx, fy);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line"><span class="comment">// if (left &gt; right || l &gt; r) return ; æ³¨æ„è‹¥ l &gt; r å°±é€€å‡ºé‚£ä¹ˆæœ‰ä¸€äº›ç‚¹æ— æ³•åŠ å…¥å¹¶æŸ¥é›†</span></span><br><span class="line">top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line"><span class="comment">// cout &lt;&lt; "Test: " &lt;&lt; left &lt;&lt; ' ' &lt;&lt; l &lt;&lt; ' ' &lt;&lt; r &lt;&lt; endl;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++)</span><br><span class="line">answer[query[i].index] = left;</span><br><span class="line">merge (edge[left].first, edge[left].second);</span><br><span class="line">top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= mid; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = edge[i].first, v = edge[i].second;</span><br><span class="line">merge (u, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> t1 = <span class="number">0</span>, t2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = query[i].x, y = query[i].y;</span><br><span class="line"><span class="keyword">int</span> lim = query[i].lim;</span><br><span class="line"><span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line"><span class="keyword">if</span> (fx == fy) &#123;</span><br><span class="line"><span class="keyword">if</span> (subsize[fx] &gt;= lim) q1[++ t1] = query[i];</span><br><span class="line"><span class="keyword">else</span> q2[++ t2] = query[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (subsize[fx] + subsize[fy] &gt;= lim) q1[++ t1] = query[i];</span><br><span class="line"><span class="keyword">else</span> q2[++ t2] = query[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t1; i ++)</span><br><span class="line">query[l + i - <span class="number">1</span>] = q1[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t2; i ++)</span><br><span class="line">query[l + t1 + i - <span class="number">1</span>] = q2[i];</span><br><span class="line"><span class="keyword">while</span> (top &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">int</span> x = <span class="built_in">stack</span>[top].first, y = <span class="built_in">stack</span>[top].second;</span><br><span class="line">top --;</span><br><span class="line">father[x] = x, subsize[y] -= subsize[x];</span><br><span class="line">&#125;</span><br><span class="line">solve (left, mid, l, l + t1 - <span class="number">1</span>), solve (mid + <span class="number">1</span>, right, l + t1, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// freopen ("stamp.in", "r", stdin);</span></span><br><span class="line"><span class="comment">// freopen ("stamp.out", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">N = getnum (), M = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> u = getnum (), v = getnum ();</span><br><span class="line">edge[i] = make_pair (u, v);</span><br><span class="line">&#125;</span><br><span class="line">Q = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++) &#123;</span><br><span class="line"><span class="keyword">int</span> x = getnum (), y = getnum (), z = getnum ();</span><br><span class="line">query[i] = querySt (i, x, y, z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">father[i] = i, subsize[i] = <span class="number">1</span>;</span><br><span class="line">solve (<span class="number">1</span>, M, <span class="number">1</span>, Q);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Q; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, answer[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 6</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">1 5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">2 4 3</span></span><br><span class="line"><span class="comment">2 4 4</span></span><br><span class="line"><span class="comment">2 4 5</span></span><br><span class="line"><span class="comment">1 3 3</span></span><br><span class="line"><span class="comment">1 3 4</span></span><br><span class="line"><span class="comment">1 3 5</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 13</span></span><br><span class="line"><span class="comment">8 5</span></span><br><span class="line"><span class="comment">5 7</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">7 8</span></span><br><span class="line"><span class="comment">5 6</span></span><br><span class="line"><span class="comment">10 9</span></span><br><span class="line"><span class="comment">4 8</span></span><br><span class="line"><span class="comment">7 10</span></span><br><span class="line"><span class="comment">7 1</span></span><br><span class="line"><span class="comment">2 7</span></span><br><span class="line"><span class="comment">4 2</span></span><br><span class="line"><span class="comment">8 10</span></span><br><span class="line"><span class="comment">6 9</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">4 9 11</span></span><br><span class="line"><span class="comment">6 2 2</span></span><br><span class="line"><span class="comment">5 4 5</span></span><br><span class="line"><span class="comment">10 8 4</span></span><br><span class="line"><span class="comment">2 4 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="E-Candy-Piles"><a href="#E-Candy-Piles" class="headerlink" title="E - Candy Piles"></a>E - Candy Piles</h2><p>ç¥ä»™åšå¼ˆè®º + æ¨¡å‹è½¬åŒ–</p><p>ç®—æ˜¯ç›®å‰åšè¿‡çš„ä¸ºæ•°æå°‘çš„åšå¼ˆè®ºé¢˜ä¹‹ä¸€ï¼Œç„¶è€Œå¹¶ä¸ç”¨ $SG$ å‡½æ•°ä»€ä¹ˆçš„</p><p>æ³¨æ„ $2$ æ“ä½œæ˜¯å¯¹äºæ¯ä¸€å †éƒ½åƒä¸€ä¸ªè€Œä¸æ˜¯ä»»é€‰ä¸€å †åƒï¼Œç„¶è€Œæˆ‘çœ‹å®Œé¢˜è§£æ‰å‘ç°æˆ‘é¢˜ç›®çœ‹é”™äº†ã€‚ã€‚ã€‚</p><p>å°†ç³–æœå †æŒ‰ç…§ä¸ªæ•°æ’åºåï¼Œå¾—åˆ°å¦‚ä¸‹å›¾</p><blockquote><p>000</p><p>000</p><p>0000</p><p>00000</p></blockquote><p>å°†å…¶çœ‹åšä»¥å·¦ä¸‹è§’ä¸ºç‚¹ $(1, 1)$ çš„åæ ‡ç³»ï¼Œé‚£ä¹ˆï¼Œå¯¹äºåƒæœ€å¤§çš„ä¸€å †ç³–æœï¼Œå°±ç›¸å½“äºå‘ä¸Šç§»ä¸€æ ¼ï¼Œå¯¹äºæ¯å †åƒä¸€ä¸ªç³–æœï¼Œå°±ç›¸å½“äºå‘å³ç§»ä¸€æ ¼ï¼Œç„¶ååƒåˆ°ä¸èƒ½åƒä¸ºæ­¢ï¼Œå³åˆ°è¾¾ç‚¹ $(3, 4), ~ (4, 2), ~ (1, 5)$ çš„å…¶ä¸­ä¸€ä¸ª</p><p>æ˜¾ç„¶ï¼Œä¸Šè¿°æ— æ³•ç»§ç»­èµ°åŠ¨çš„ä¸‰ç‚¹æ˜¯å¿…è¾“ç‚¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ä¸Šè¿°ç‚¹æ‰©å¼ å°†æ•´å¹…å›¾çš„å¿…èµ¢å¿…è¾“çŠ¶æ€è¡¨ç¤ºå‡ºæ¥</p><p>æ ¹æ®å®šç†</p><blockquote><p>è‹¥ä¸€ä¸ªç‚¹æ˜¯å¿…èµ¢ç‚¹å½“ä¸”ä»…å½“å…¶å¯è½¬ç§»çš„çŠ¶æ€ä¸­å­˜åœ¨å¿…è¾“ç‚¹ï¼›è‹¥ä¸€ä¸ªç‚¹æ˜¯å¿…è¾“ç‚¹å½“ä¸”ä»…å½“å…¶å¯è½¬ç§»çš„çŠ¶æ€ä¸­çš†æ˜¯å¿…èµ¢ç‚¹</p></blockquote><p>å°±å¯ä»¥å®ç°</p><p>å½“ç„¶ï¼Œè¿™æ ·è¿˜æ˜¯ $T$ çš„ï¼Œæ‰€ä»¥ç»è¿‡è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°</p><ul><li>ä¸€ä¸ªç‚¹çš„å¿…èµ¢å¿…è¾“çŠ¶æ€ä¸å…¶å·¦ä¸Šè§’çš„çŠ¶æ€ç›¸åŒ</li></ul><p>è¯æ˜çš„è¯æšä¸¾ç„¶åç®€å•åè¯ä¸€ä¸‹å°±å¥½äº†</p><p>æ•…ç°åœ¨å¯ä»¥å°†ç‚¹ $(1, 1)$ ä¸€ç›´å‘å³ä¸Šè§’ç§»åŠ¨åˆ°ç›´åˆ°æ— æ³•ç§»åŠ¨ä¸ºæ­¢çš„ç‚¹ $(k, k)$ï¼Œé‚£ä¹ˆå®ƒç°åœ¨å¿…å¤„äºå›¾å½¢çš„â€œè¾¹ç¼˜â€ä¸Šï¼Œæ˜¾ç„¶ï¼Œå¯¹äºè¾¹ç¼˜çš„æƒ…å†µï¼Œä¸€ä¸ªç‚¹çš„çŠ¶æ€å¿…ä¸å…¶å³ï¼ˆä¸Šï¼‰çš„ç‚¹ç›¸åï¼Œé‚£ä¹ˆåªè¦åˆ¤æ–­ä¸€ä¸‹ $(k, k)$ å¯ä»¥å‘ä¸Šæˆ–å‘å³æ‰©å¼ ç›´åˆ°æ— æ³•ç§»åŠ¨çš„æ­¥æ•°çš„å¥‡å¶æ€§ï¼Œè‹¥å­˜åœ¨å¥‡æ•°ï¼Œåˆ™ä¸ºå…ˆæ‰‹å¿…èµ¢ï¼›åä¹‹ï¼Œåˆ™åæ‰‹å¿…èµ¢</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; a, <span class="keyword">const</span> <span class="keyword">int</span>&amp; b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum ();</span><br><span class="line">sort (a + <span class="number">1</span>, a + N + <span class="number">1</span>, comp);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (a[i + <span class="number">1</span>] &lt;= i) &#123;</span><br><span class="line"><span class="keyword">bool</span> win = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> ((a[i] - i) &amp; <span class="number">1</span>)</span><br><span class="line">win = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (! win &amp;&amp; a[i + <span class="number">1</span>] == i) &#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= N; j ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (a[j] &lt; i) <span class="keyword">break</span>;</span><br><span class="line">cnt ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (! (cnt &amp; <span class="number">1</span>))</span><br><span class="line">win = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">win ? <span class="built_in">puts</span> (<span class="string">"First"</span>) : <span class="built_in">puts</span> (<span class="string">"Second"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="F-Leftmost-Ball"><a href="#F-Leftmost-Ball" class="headerlink" title="F - Leftmost Ball"></a>F - Leftmost Ball</h2><p>åŠ¨æ€è§„åˆ’</p><p>ä¸€å¼€å§‹æˆ‘æ˜¯æŒ‰ç…§å¸¸è§„æ€è·¯æƒ³ï¼Œå¹¶ä¸”å°†ä¸€ä¸ªç™½çƒä¸ä¸€ç±»é¢œè‰²çƒå½“åšä¸€ä¸ªæ•´ä½“æ¥å¤„ç†çš„ï¼Œå³è®¾ $f_{i, j}$ è¡¨ç¤ºå‰ $i$ ä¸ªä½ç½®æ”¾ç½® $j$ ä¸ªç™½çƒçš„æ–¹æ¡ˆæ•°ï¼Œç„¶è€Œé¦–å…ˆè¿™æ ·ä¼š $T$ï¼Œå¹¶ä¸”å®¹æ˜“ç®—é‡ï¼Œäºæ˜¯æˆ‘å»åº·äº†çœ¼é¢˜è§£</p><p>ç„¶åå‘ç°å®é™…ä¸Šç™½çƒä¸èƒ½ä¸ç±»é¢œè‰²çƒæ•´ä½“è€ƒè™‘ï¼Œä¸ç„¶ä¼šç®—é‡ï¼Œä½†æ˜¯æ˜¾ç„¶ä¸€ç±»é¢œè‰²çƒæ˜¯å¯ä»¥æ•´ä½“è€ƒè™‘çš„ï¼Œæ•…è®¾çŠ¶æ€ $f_{i, j}$ è¡¨ç¤ºæ”¾äº† $i$ ä¸ªç™½çƒå’Œ $j$ ä¸ªç±»é¢œè‰²çƒçš„æ–¹æ¡ˆæ•° $(j \le i)$</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¦å¦‚ä½•çŸ¥é“æ¯ä¸ªçƒåœ¨å½“å‰çŠ¶æ€ä¸‹çš„ä½ç½®å…³ç³»å‘¢ï¼Ÿå› ä¸ºæ„Ÿè§‰ä¸çŸ¥é“æ²¡æ³•ç¡®å®šçƒçš„å¯æ”¾ç½®æ–¹æ¡ˆæ•°</p><p>å½“ç„¶å‡å¦‚çœŸçš„è¦çŸ¥é“ä½ç½®å…³ç³»æ˜¯ä¸å¯èƒ½çš„ï¼Œæ‰€ä»¥ä»”ç»†æ€è€ƒä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°ï¼Œè‹¥å½“å‰ä½ è¦æ”¾ä¸€ä¸ªç™½çƒï¼Œé‚£ä¹ˆåœ¨ä½ æ”¾å½“å‰ç™½çƒçš„ä½ç½®ä¹‹å‰çš„ä½ç½®å¿…é¡»å·²ç»è¢«å®Œå…¨å¡«æ»¡ï¼Œä¸ç„¶å¿…ä¼šå­˜åœ¨è¯¥ç™½çƒä¹‹åçš„ç±»é¢œè‰²çƒæ”¾ç½®åœ¨å½“å‰ç™½çƒå‰ï¼Œä½¿å¾—æ–¹æ¡ˆä¸åˆæ³•ï¼Œæ•…å½“å‰ç™½çƒæ”¾ç½®çš„ç›¸å¯¹ä½ç½®ä¸€å®šåªæœ‰ä¸€ä¸ªï¼Œå³ $f_{i, j} += f_{i - 1,j }$</p><p>å¯¹äºæ”¾ç½®ç±»é¢œè‰²çƒï¼Œç”±äºå½“å‰ç±»é¢œè‰²çƒçš„ç™½çƒå·²ç»æ”¾ç½®å®Œæ¯•ï¼Œæ•…å®ƒè¿˜å‰©ä¸‹ $n \times k - i - (k - 1) \times(j - 1)$ ä¸ªä½ç½®æ”¾å…¶ $k - 1$ ä¸ªçƒï¼Œä¸”å½“å‰è¿˜å‰©ä¸‹ $n - (j - 1)$ ä¸ªé¢œè‰²å¯ä¾›é€‰æ‹©ï¼Œæ•…å¾— $f_{i, j} += f_{i, j - 1} \times (n - j + 1) \times \dbinom{n \times k - i - (k - 1) \times (j - 1)}{k - 1}$</p><p>ç„¶è€Œä½ ä¼šå‘ç°è¿™æ ·è¿æ ·ä¾‹éƒ½è¿‡ä¸äº†ï¼Œå› ä¸ºä½ åˆç®—é‡äº†</p><p>æ¯”å¦‚å¯¹äº</p><blockquote><p>{0, 0, 1, 2}</p></blockquote><p>å°±ä¼šå­˜åœ¨å…ˆæ”¾ $\{0, 1\}$ è¿˜æ˜¯ $\{0, 2\}$ çš„é—®é¢˜ï¼Œç„¶åä¼šæ”¾ä¸¤éï¼Œæ‰€ä»¥ç†è®ºä¸Šåªè¦æ˜¯å­˜åœ¨è¿ç»­çš„ $0$ çš„éƒ½ä¼šç®—é‡</p><p>äºæ˜¯ä¸€æ—¶è„‘æŠ½ï¼Œåˆåªèƒ½ç„é¢˜è§£äº†</p><p>å…¶å®è§£å†³æ–¹æ¡ˆæå…¶ç®€å•ï¼Œåªè¦æ»¡è¶³å½“å‰æ”¾çš„ç±»é¢œè‰²çƒçš„ç¬¬ä¸€ä¸ªä¸€å®šæ˜¯æœ€æ¥è¿‘ $0$ çš„å°±è¡Œäº†ï¼Œä¹Ÿå°±æ˜¯è§„å®šå…¶æ”¾ç½®é¡ºåº</p><p>æ•…ç»¼ä¸Šæ‰€è¿°ï¼Œè½¬ç§»æ–¹ç¨‹ä¸º<br>$$<br>f_{i, j} = f_{i - 1, j} + f_{i, j - 1} \times (n - j + 1) \times \dbinom{n \times k - i - (k - 1) \times (j - 1) - 1}{k - 2}<br>$$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = MAXN * MAXN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"></span><br><span class="line">LL fact[MAXM]= &#123;<span class="number">0</span>&#125;, invfact[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">fact[<span class="number">0</span>] = fact[<span class="number">1</span>] = invfact[<span class="number">0</span>] = invfact[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N * K; i ++) &#123;</span><br><span class="line">fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">invfact[i] = (MOD - MOD / i) * invfact[MOD % i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N * K; i ++)</span><br><span class="line">invfact[i] = invfact[i - <span class="number">1</span>] * invfact[i] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL f[MAXN][MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">scanf</span> (<span class="string">"%d%d"</span>, &amp; N, &amp; K);</span><br><span class="line"><span class="keyword">if</span> (K == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="built_in">puts</span> (<span class="string">"1"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">init ();</span><br><span class="line">f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j ++) &#123;</span><br><span class="line">LL delta = f[i][j - <span class="number">1</span>] * (N - j + <span class="number">1</span>) % MOD * C (N * K - i - (K - <span class="number">1</span>) * (j - <span class="number">1</span>) - <span class="number">1</span>, K - <span class="number">2</span>) % MOD;</span><br><span class="line"><span class="keyword">if</span> (j == <span class="number">0</span>) delta = <span class="number">0</span>;</span><br><span class="line">f[i][j] = (f[i][j] + f[i - <span class="number">1</span>][j] + delta) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; f[N][N] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 2</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2000 2000</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AtCoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC001 E - Wide Swap</title>
      <link href="/2020/08/04/AGC001%20E%20-%20Wide%20Swap/"/>
      <url>/2020/08/04/AGC001%20E%20-%20Wide%20Swap/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>é¦–å…ˆæ˜¾ç„¶è¦å…ˆæŠŠåŸæ•°ç»„é‡æ–°æ˜ å°„ä¸€ä¸‹ï¼Œä»¤æ˜ å°„è¿‡åçš„æ•°ç»„ä¸º $a_i$</p><p>å› ä¸ºé¢˜ç›®è¦æ±‚ $|a_j - a_i| &gt;= K$ çš„å¯ä»¥ç½®æ¢ï¼Œé‚£ä¹ˆåä¹‹ï¼Œåˆ™æœ‰ $|a_j - a_i| &lt; K$ çš„ $i, j$ ç›¸å¯¹ä½ç½®ä¸å˜</p><p>æ•…æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å¯¹äºæ¯ä¸ª $i$ï¼Œå°†å…¶ä¸æ‰€æœ‰æ»¡è¶³ $|a_j - a_i| &lt; K$ çš„ $j$ è¿è¾¹ï¼Œç„¶åè·‘ä¸€è¾¹æ‹“æ‰‘ï¼Œå¤æ‚åº¦ $O (n^2)$</p><p>ç„¶åè€ƒè™‘åœ¨ $a_i$ è¿çš„è¿™ä¹ˆå¤šè¾¹ä¸­ï¼Œè‹¥æ˜¯å­˜åœ¨è¾¹ $(i, j), (j, k), (i, k)$ï¼Œå…¶ä¸­ $i &lt; j &lt; k$ï¼Œé‚£ä¹ˆæ˜¾ç„¶ $(i, k)$ çš„å­˜åœ¨æ€§æ˜¯æ— å…³ç´§è¦çš„</p><p>åˆ $a_i$ å¯è¿è¾¹çš„æƒå€¼èŒƒå›´æ˜¯ $(a_i - K, a_i) \cup (a_i, a_i + K)$ï¼Œé‚£ä¹ˆåªéœ€è¦åˆ†åˆ«å‘ä¸¤ä¸ªåŒºé—´ä¸­æ ‡å·æœ€å°çš„é‚£ä¸ªç‚¹è¿è¾¹å°±å¥½äº†ï¼ˆå•å‘è¾¹ï¼Œå¹¶ä¸”ä¸€å®šå‘æ ‡å·æ¯”è‡ªå·±å¤§çš„ç‚¹è¿ï¼‰ï¼Œè¿™æ ·å°±ç›¸å½“äºæ˜¯å°†åŸæ¥çš„ä¹±ä¸ƒå…«ç³Ÿè¿æ¥çš„å›¾å˜æˆäº†ä¸€æ¡æ¡å•å‘çš„é“¾ï¼Œå¹¶ä¸”è¿™äº›é“¾å¯ä»¥è¦†ç›–åŸæ¥çš„æ‰€æœ‰æƒ…å†µ</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson root &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson root &lt;&lt; 1 | 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">5e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkedForwardStar</span> &#123;</span></span><br><span class="line"><span class="keyword">int</span> to;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> next;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line">LinkedForwardStar Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">Link[++ size].to = v;</span><br><span class="line">Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K;</span><br><span class="line"><span class="keyword">int</span> a[MAXN]= &#123;<span class="number">0</span>&#125;, b[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> minv[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> posi, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">minv[root] = value;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (posi &lt;= mid) modify (lson, left, mid, posi, value);</span><br><span class="line"><span class="keyword">else</span> modify (rson, mid + <span class="number">1</span>, right, posi, value);</span><br><span class="line">minv[root] = min (minv[lson], minv[rson]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &gt; R) <span class="keyword">return</span> INF;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= left &amp;&amp; right &lt;= R)</span><br><span class="line"><span class="keyword">return</span> minv[root];</span><br><span class="line"><span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> mv = INF;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) mv = min (mv, query (lson, left, mid, L, R));</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) mv = min (mv, query (rson, mid + <span class="number">1</span>, right, L, R));</span><br><span class="line"><span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> indeg[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt; &gt; que;</span><br><span class="line"><span class="keyword">int</span> ret[MAXN]= &#123;<span class="number">0</span>&#125;, rcnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">topo</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="keyword">if</span> (! indeg[i])</span><br><span class="line">que.push(i);</span><br><span class="line"><span class="keyword">while</span> (! que.empty()) &#123;</span><br><span class="line"><span class="keyword">int</span> p = que.top();</span><br><span class="line">que.pop();</span><br><span class="line">ret[p] = ++ rcnt;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Head[p]; i; i = Link[i].next) &#123;</span><br><span class="line"><span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">indeg[v] --;</span><br><span class="line"><span class="keyword">if</span> (! indeg[v]) que.push(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch))</span><br><span class="line">ch = getchar ();</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch))</span><br><span class="line">num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">N = getnum (), K = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">a[i] = getnum ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">b[a[i]] = i;</span><br><span class="line"><span class="built_in">memset</span> (minv, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> (minv));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt;= <span class="number">1</span>; i --) &#123;</span><br><span class="line"><span class="keyword">int</span> p1 = query (<span class="number">1</span>, <span class="number">1</span>, N, max (<span class="number">1</span>, b[i] - K + <span class="number">1</span>), b[i] - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> p2 = query (<span class="number">1</span>, <span class="number">1</span>, N, b[i] + <span class="number">1</span>, min (N, b[i] + K - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">if</span> (p1 &gt;= <span class="number">1</span> &amp;&amp; p1 &lt;= N) Insert (b[i], b[p1]), indeg[b[p1]] ++;</span><br><span class="line"><span class="keyword">if</span> (p2 &gt;= <span class="number">1</span> &amp;&amp; p2 &lt;= N) Insert (b[i], b[p2]), indeg[b[p2]] ++;</span><br><span class="line">modify (<span class="number">1</span>, <span class="number">1</span>, N, b[i], i);</span><br><span class="line">&#125;</span><br><span class="line">topo ();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ret[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 2</span></span><br><span class="line"><span class="comment">4 2 3 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 1</span></span><br><span class="line"><span class="comment">5 4 3 2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8 3</span></span><br><span class="line"><span class="comment">4 5 7 8 3 1 2 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ€ç»´ </category>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
