<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>长乐集训 - NOI模拟赛（二十六） | Colythme</title><meta name="description" content="今天是几场下来第一次完整搞出一道题 虽然跑的贼慢，方法不够优，比 $\text{std}$ 慢 $200ms$。。 $\text{score：0 + 100 + 0 &#x3D; 100   rk：16&#x2F;32}$ Problem A：Geometric Progressions题目描述首项为 $a$ 且公比为 $b$ 的等比数列是一个形如 $a, ab, ab^2, ab^3, …$ 的数字序列 你被给定了"><meta name="keywords" content="点分治,集训,ExGCD,最小生成树"><meta name="author" content="Colythme"><meta name="copyright" content="Colythme"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://i.loli.net/2020/07/01/HAkVZw1jYbBezxS.jpg"><link rel="canonical" href="http://colythme.github.io/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="长乐集训 - NOI模拟赛（二十六）"><meta property="og:url" content="http://colythme.github.io/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/"><meta property="og:site_name" content="Colythme"><meta property="og:description" content="今天是几场下来第一次完整搞出一道题 虽然跑的贼慢，方法不够优，比 $\text{std}$ 慢 $200ms$。。 $\text{score：0 + 100 + 0 &#x3D; 100   rk：16&#x2F;32}$ Problem A：Geometric Progressions题目描述首项为 $a$ 且公比为 $b$ 的等比数列是一个形如 $a, ab, ab^2, ab^3, …$ 的数字序列 你被给定了"><meta property="og:image" content="https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg"><meta property="article:published_time" content="2020-08-04T09:14:21.370Z"><meta property="article:modified_time" content="2020-07-19T10:14:06.000Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="prev" title="长乐集训 - NOI模拟赛（二十四）「订正未完成」" href="http://colythme.github.io/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"><link rel="next" title="长乐集训 - NOI模拟赛（二十八）「订正未完成」" href="http://colythme.github.io/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AB%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"Press","message_next":"to bookmark this page"},"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://i.loli.net/2020/07/01/VbugJ9i4FUkIsoE.jpg" onerror="onerror=null;src='https://i.loli.net/2020/07/19/CD63xSYyqw5QmdH.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">71</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">58</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">18</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem-A：Geometric-Progressions"><span class="toc-number">1.</span> <span class="toc-text">Problem A：Geometric Progressions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目描述"><span class="toc-number">1.1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据范围"><span class="toc-number">1.2.</span> <span class="toc-text">数据范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#题解"><span class="toc-number">1.3.</span> <span class="toc-text">题解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem-B：Bichrome-Spanning-Tree"><span class="toc-number">2.</span> <span class="toc-text">Problem B：Bichrome Spanning Tree</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目描述-1"><span class="toc-number">2.1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据范围-1"><span class="toc-number">2.2.</span> <span class="toc-text">数据范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#题解-1"><span class="toc-number">2.3.</span> <span class="toc-text">题解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#方法一"><span class="toc-number">2.3.1.</span> <span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码（方法一）"><span class="toc-number">2.3.2.</span> <span class="toc-text">代码（方法一）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#方法二"><span class="toc-number">2.3.3.</span> <span class="toc-text">方法二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem-C：Network"><span class="toc-number">3.</span> <span class="toc-text">Problem C：Network</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题面"><span class="toc-number">3.1.</span> <span class="toc-text">题面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#题解-2"><span class="toc-number">3.2.</span> <span class="toc-text">题解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码"><span class="toc-number">3.3.</span> <span class="toc-text">代码</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Colythme</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">长乐集训 - NOI模拟赛（二十六）</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2020-08-04 17:14:21"><i class="far fa-calendar-alt fa-fw"></i> Created 2020-08-04</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2020-07-19 18:14:06"><i class="fas fa-history fa-fw"></i> Updated 2020-07-19</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>今天是几场下来第一次完整搞出一道题</p>
<p>虽然跑的贼慢，方法不够优，比 $\text{std}$ 慢 $200ms$。。</p>
<p>$\text{score：0 + 100 + 0 = 100   rk：16/32}$</p>
<h2 id="Problem-A：Geometric-Progressions"><a href="#Problem-A：Geometric-Progressions" class="headerlink" title="Problem A：Geometric Progressions"></a>Problem A：Geometric Progressions</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>首项为 $a$ 且公比为 $b$ 的等比数列是一个形如 $a, ab, ab^2, ab^3, …$ 的数字序列</p>
<p>你被给定了 $n$ 个整数等比数列。你的任务是找出最小的整数 $x$，使得它是所有给定的序列的元素，或者声明这样的整数不存在</p>
<h3 id="数据范围"><a href="#数据范围" class="headerlink" title="数据范围"></a>数据范围</h3><p>对 $100\%$ 的数据，$1 \le n \le 100, ~ 1 \le a, b \le 10^9$</p>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>原题 <a href="https://codeforces.com/problemset/problem/571/E" target="_blank" rel="noopener">CF571E</a></p>
<p>首先将所有 $a, b$ 分解质因数，得到大小为 $m$ 质因数集 $\{p_1, p_2, …, p_m\}$</p>
<p>设 $c_{i, j}$ 表示 $a_i$ 分解质因数后 $p_j$ 的幂次，$d_{i, j}$ 表示 $b_i$ 分解质因数后 $p_j$ 的幂次，那么答案即可被表示为 $\prod\limits_{i = 1}^m p_i^{c_{1, i} + k \times d_{1, i}}$，其中 $k \in N$</p>
<p>考虑每次将两对 $a, b$ 合并，设之前合并得到的 $a, b$ 分解质因数后的质因数幂次数组 $A, B$，其中 $A_i$ 表示第 $i$ 个质因数的幂次，再设准备与之合并的 $a, b$ 的质因数幂次数组 $C, D$</p>
<p>那么现在分为仅有一解、有无数解、无解三种情况</p>
<p>对 $A, B$ 单独考虑，设答案 $p_i$ 幂次 $t_i$，则有<br>$$<br>\left\{<br>    \begin{aligned}<br>        t_i &amp;= A_i + k \times B_i \\<br>        t_j &amp;= A_j + k \times B_j<br>    \end{aligned}<br>\right. \\<br>\Rightarrow<br>t_i = A_i + \frac{B_i}{B_j}(t_j - A_j)<br>$$<br>也就是说 $t_j$ 和 $t_i$ 的关系是一条斜率为 $\frac{B_i}{B_j}$ 的直线</p>
<p>同理对 $C, D$，有 $t_i = C_i + \frac{D_i}{D_j}(t_j - C_j)$</p>
<p>那么仅有一解的条件即为它们之间有交点，即 $\frac{B_i}{B_j} = \frac{D_i}{D_j}$，这种情况直接解出来就好了</p>
<p>那么考虑剩下的情况，$t_i = A_i + k_1 \times B_i = C_i + k_2 \times D_i$ 可以转化成 $k_2 \times D_i - k_1 \times B_i = A_i - C_i$，然后用 $ExGCD$ 求解，注意由于它们 $k_1, k_2$ 都相同，所以要满足每组方程是否满足比例关系，不满足则无解，其实我觉得上面那个 $\frac{B_i}{B_j} \ne \frac{D_i}{D_j}$ 则只有一解也应该可以用这个来理解，然后就相当于解一个二元一次方程</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">900</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, LL p)</span> </span>&#123;</span><br><span class="line">	LL cnt = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (p) &#123;</span><br><span class="line">		<span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">		x = x * x % MOD;</span><br><span class="line">		p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e04</span>;</span><br><span class="line"><span class="keyword">int</span> oa[MAXN], ob[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">GCD</span> <span class="params">(LL a, LL b)</span> </span>&#123; <span class="keyword">return</span> ! b ? a : GCD (b, a % b); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exGCD</span> <span class="params">(LL a, LL b, LL&amp; x, LL&amp; y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (! b) &#123; x = <span class="number">1</span>, y = <span class="number">0</span>; <span class="keyword">return</span> ; &#125;</span><br><span class="line">	exGCD (b, a % b, y, x);</span><br><span class="line">	y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXM]= &#123;<span class="number">0</span>&#125;, pn = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">separ</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i ++)</span><br><span class="line">		<span class="keyword">if</span> (! (x % i)) &#123;</span><br><span class="line">			prime[++ pn] = i;</span><br><span class="line">			<span class="keyword">while</span> (! (x % i)) x /= i;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">if</span> (x &gt; <span class="number">1</span>) prime[++ pn] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> pcnt[<span class="number">2</span>][MAXN][MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cencus</span> <span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> id, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">		<span class="keyword">if</span> (! (x % prime[i])) &#123;</span><br><span class="line">			<span class="keyword">while</span> (! (x % prime[i])) &#123;</span><br><span class="line">				x /= prime[i];</span><br><span class="line">				pcnt[p][id][i] ++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL a[MAXM], b[MAXM], c[MAXM], d[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">merge</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	LL sb = <span class="number">0</span>, sd = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) &#123; sb += b[i]; sd += d[i]; &#125;</span><br><span class="line">	<span class="keyword">if</span> (! sb &amp;&amp; ! sd) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">			<span class="keyword">if</span> (a[i] != c[i])</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (! sb || ! sd) &#123;</span><br><span class="line">		<span class="keyword">if</span> (! sd) &#123; swap (sb, sd); swap (a, c); swap (b, d); &#125;</span><br><span class="line">		LL k = - <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">			<span class="keyword">if</span> (d[i]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (c[i] &gt; a[i] || (a[i] - c[i]) % d[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				LL pk = (a[i] - c[i]) / d[i];</span><br><span class="line">				<span class="keyword">if</span> (k != - <span class="number">1</span> &amp;&amp; pk != k) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				k = pk;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> i, j;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">			<span class="keyword">if</span> (sb * d[i] != sd * b[i])</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span> (i &lt;= pn) &#123;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= pn; j ++)</span><br><span class="line">				<span class="keyword">if</span> (b[i] * d[j] != d[i] * b[j]) <span class="comment">// 只有一个解</span></span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">			LL ka = d[j] * (c[i] - a[i]) - d[i] * (c[j] - a[j]);</span><br><span class="line">			LL kb = b[j] * (c[i] - a[i]) - b[i] * (c[j] - a[j]);</span><br><span class="line">			LL down = d[j] * b[i] - d[i] * b[j];</span><br><span class="line">			<span class="keyword">if</span> (down &lt; <span class="number">0</span>) ka = - ka, kb = - kb, down = - down;</span><br><span class="line">			<span class="keyword">if</span> (ka &lt; <span class="number">0</span> || kb &lt; <span class="number">0</span> || ka % down || kb % down) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			ka /= down, kb /= down;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= pn; k ++) &#123;</span><br><span class="line">				<span class="keyword">if</span> (a[k] + ka * b[k] != c[k] + kb * d[k]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				a[k] = a[k] + ka * b[k], b[k] = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ExGCD合并</span></span><br><span class="line">	LL rb = <span class="number">0</span>, rd = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">		<span class="keyword">if</span> (b[i]) &#123;</span><br><span class="line">			LL g = GCD (b[i], d[i]);</span><br><span class="line">			rb = b[i] / g, rd = d[i] / g;</span><br><span class="line">			<span class="keyword">if</span> ((a[i] - c[i]) % g) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			r = (a[i] - c[i]) / g;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">		<span class="keyword">if</span> (r * (b[i] / rb) != a[i] - c[i]) <span class="comment">// 判断是否成比例</span></span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (r &lt; <span class="number">0</span>) swap (a, c), swap (b, d), swap (rb, rd), r = - r;</span><br><span class="line">	LL ka, kb;</span><br><span class="line">	exGCD (rb, rd, ka, kb);</span><br><span class="line">	ka = (ka * (- r) % rd + rd) % rd;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++)</span><br><span class="line">		a[i] += ka * b[i], b[i] *= rd;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">	<span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line">	<span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	N = getnum ();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) oa[i] = getnum (), ob[i] = getnum ();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) separ (oa[i]), separ (ob[i]);</span><br><span class="line">	sort (prime + <span class="number">1</span>, prime + pn + <span class="number">1</span>);</span><br><span class="line">	pn = unique (prime + <span class="number">1</span>, prime + pn + <span class="number">1</span>) - prime - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) cencus (<span class="number">0</span>, i, oa[i]), cencus (<span class="number">1</span>, i, ob[i]);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) a[i] = pcnt[<span class="number">0</span>][<span class="number">1</span>][i], b[i] = pcnt[<span class="number">1</span>][<span class="number">1</span>][i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pn; j ++) c[j] = pcnt[<span class="number">0</span>][i][j], d[j] = pcnt[<span class="number">1</span>][i][j];</span><br><span class="line">		<span class="keyword">if</span> (! merge ()) &#123; <span class="built_in">puts</span> (<span class="string">"-1"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	LL ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pn; i ++) ans = ans * power (prime[i], a[i]) % MOD;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Problem-B：Bichrome-Spanning-Tree"><a href="#Problem-B：Bichrome-Spanning-Tree" class="headerlink" title="Problem B：Bichrome Spanning Tree"></a>Problem B：Bichrome Spanning Tree</h2><h3 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h3><p>我们有一个 $n$ 个点 $m$ 条边的带权无向图。图中的第 $i$ 条边连接了节点 $u_i, v_i,$，权重为 $w_i$。另外，你还被给定了一个整数 $X$。</p>
<p>请求出将每条边染成黑色或白色，且满足下面的条件的方案数模 $10^9 + 7$ 的值</p>
<ul>
<li>图中存在一棵同时包含染成白色的边和染成黑色的边的生成树。另外，在所有这种生成树中，权重最小的一棵的权重恰为 $X$</li>
</ul>
<p>这里，一棵生成树的权重定义为生成树中边的权重的和</p>
<h3 id="数据范围-1"><a href="#数据范围-1" class="headerlink" title="数据范围"></a>数据范围</h3><p>对 $100\%$ 的数据，$1 \le n \le 1000, ~ 1 \le m \le 2000, ~ 1 \le w_i \le 10^9, ~ 1 \le X \le 10^{12}$</p>
<p>给出的数据保证图联通，不存在重边，不存在自环</p>
<h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>原题 <a href="https://atcoder.jp/contests/arc093/tasks/arc093_c" target="_blank" rel="noopener">ARC093C</a></p>
<h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><p>先讲讲我的方法吧</p>
<p>显然对一棵权重 $&lt; X$ 的树，它所有的边的颜色都应该相同，那么我们考虑对每条边判断它会不会有这种限制</p>
<p>此时直接用 $Kruskal$ 求出包含该边的最小生成树，若其权重 $&lt; X$，则该边的染色就会被限制，称一类边；若其权重 $&gt; X$，则它属于染色情况不论如何都不会对答案造成贡献的边，称二类边；若其权重 $= X$，则需要着重考虑，称三类边</p>
<p>这里考虑两棵在相同的图上但边集完全无交集的最小生成树，它们一定可以构成一个新的最小生成树，该最小生成树的边集与原两棵树的边集分别有交，这个也很好证明，因为最小生成树一定是最小瓶颈生成树，即最大边最小，那么它们之间一定可以互相替换，从而构成一棵新的 $MST$，至于对那些权重 $&lt; X$ 的树，也拥有类似该定理，证明类比一下就好了</p>
<p>自此我们就可以认为所有二类边的颜色一定是相同的</p>
<p>设某条三类边 $E$，三类边的总数为 $m$</p>
<p>现在只需枚举 $E$ 来进行组合计数，强制令 $E$ 染色与一类边不同，则剩余 $m - 1$ 条边则可随意染色，为避免算重，枚举 $m - 1$ 条边中与 $E$ 染色相同的个数 $j$，则 $E$ 在枚举到 $j$ 加上的贡献即为 $\frac{C (m - 1, j)}{j + 1}$，记得最后乘二，但对不存在一类边的情况要特判一下</p>
<p>那么最后再设三类边个数 $ext$，将之前统计得到的答案乘上 $2^{ext}$ 即可</p>
<p>时间复杂度 $O \big(nm \times \alpha(n)\big)$</p>
<h4 id="代码（方法一）"><a href="#代码（方法一）" class="headerlink" title="代码（方法一）"></a>代码（方法一）</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">2000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">power</span> <span class="params">(LL x, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">	LL cnt = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (p) &#123;</span><br><span class="line">		<span class="keyword">if</span> (p &amp; <span class="number">1</span>) cnt = cnt * x % MOD;</span><br><span class="line">		x = x * x % MOD;</span><br><span class="line">		p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line">LL pow2[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125;;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, sze = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">	Link[++ sze].to = v;</span><br><span class="line">	Link[sze].w = w;</span><br><span class="line">	Link[sze].next = Head[u];</span><br><span class="line"></span><br><span class="line">	Head[u] = sze;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL fact[MAXM]= &#123;<span class="number">0</span>&#125;, invfact[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">LL inv[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">C</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="keyword">return</span> fact[n] * invfact[m] % MOD * invfact[n - m] % MOD; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">LL X;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> u, v, w;</span><br><span class="line">	Edge (<span class="keyword">int</span> u = <span class="number">0</span>, <span class="keyword">int</span> v = <span class="number">0</span>, <span class="keyword">int</span> w = <span class="number">0</span>) : u (u), v (v), w (w) &#123;&#125;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Edge&amp; p) <span class="keyword">const</span> &#123; <span class="keyword">return</span> w &lt; p.w; &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">Edge edge[MAXM];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> fa[x] == x ? x : fa[x] = find (fa[x]); &#125;</span><br><span class="line"><span class="function">LL <span class="title">Kruskal</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	LL ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> x = edge[i].u, y = edge[i].v, w = edge[i].w;</span><br><span class="line">		<span class="keyword">int</span> fx = find (x), fy = find (y);</span><br><span class="line">		<span class="keyword">if</span> (fx == fy) <span class="keyword">continue</span>;</span><br><span class="line">		fa[fx] = fy; ret += w;</span><br><span class="line">		Insert (x, y, w), Insert (y, x, w);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> white[MAXM]= &#123;<span class="number">0</span>&#125;, black[MAXM]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> wn = <span class="number">0</span>, bn = <span class="number">0</span>;</span><br><span class="line"><span class="function">LL <span class="title">cencus</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	LL ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= bn; q ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> i = black[q];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123; fa[j] = j; Head[j] = <span class="number">0</span>; &#125;</span><br><span class="line">		sze = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> u = edge[i].u, v = edge[i].v, w = edge[i].w;</span><br><span class="line">		fa[u] = v;</span><br><span class="line">		Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">		Kruskal ();</span><br><span class="line">		LL add = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= bn - <span class="number">1</span> - (! wn); j ++)</span><br><span class="line">			add = (add + C (bn - <span class="number">1</span>, j) * inv[j + <span class="number">1</span>] % MOD) % MOD;</span><br><span class="line">		ret = (ret + add) % MOD;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (wn) ret = <span class="number">2l</span>l * ret % MOD;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	LL ans = <span class="number">0</span>; <span class="keyword">int</span> ext = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">1l</span>l * edge[i].w &gt; X) &#123; ext ++; <span class="keyword">continue</span>; &#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j ++) &#123; fa[j] = j; Head[j] = <span class="number">0</span>; &#125;</span><br><span class="line">		sze = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> u = edge[i].u, v = edge[i].v, w = edge[i].w;</span><br><span class="line">		fa[u] = v;</span><br><span class="line">		LL x = w + Kruskal ();</span><br><span class="line">		<span class="keyword">if</span> (x &lt; X) white[++ wn] = i;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == X) black[++ bn] = i;</span><br><span class="line">		<span class="keyword">else</span> ext ++;</span><br><span class="line">	&#125;</span><br><span class="line">	ans = cencus ();</span><br><span class="line">	ans = ans * pow2[ext] % MOD;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">	<span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line">	<span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	N = getnum (), M = getnum (); <span class="built_in">cin</span> &gt;&gt; X;</span><br><span class="line">	<span class="keyword">if</span> (N == <span class="number">1</span>) &#123; <span class="built_in">puts</span> (<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">	pow2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= max (N, M); i ++) pow2[i] = pow2[i - <span class="number">1</span>] * <span class="number">2l</span>l % MOD;</span><br><span class="line">	fact[<span class="number">0</span>] = invfact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	inv[<span class="number">1</span>] = fact[<span class="number">1</span>] = invfact[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">		inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">		fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">		invfact[i] = invfact[i - <span class="number">1</span>] * inv[i] % MOD;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">		edge[i] = Edge (u, v, w);</span><br><span class="line">	&#125;</span><br><span class="line">	sort (edge + <span class="number">1</span>, edge + M + <span class="number">1</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; solve () &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><p>题解的方法，我觉着挺妙</p>
<p>先随便取一个 $MST$ 设为 $T$，设其权重和 $w(T)$，显然只需考虑 $w(T) \le X$</p>
<p>对 $w(T) = X$，可以先加上让其内部不全部染相同色，剩余边随意染色，即贡献 $(2^{n - 1} - 2) \cdot 2^{m - n + 1}$</p>
<p>接下来考虑 $T$ 染色全部相同的情况，不妨设 $T$ 中边均为黑边</p>
<blockquote>
<p>每次替换一个不在 $T$ 中的白边到 $T$，则最多替换一次</p>
</blockquote>
<p>证明反向思考一下就行了，每次替换权重一定不会减少，那么假定现在替换了两个白边，但全图的黑白边 $MST$ 仍不包括你第二次替换的边，因为第二次替换出来的黑边此时就满足条件了</p>
<p>对每次替换，若替换第 $i$ 条边，则会增大 $cost(i) = w_i - \max\{w_j | (u_j, v_j) 在T中(u_i, v_i)两点间路径上\}$（题解表述）的贡献，因此一定选最小边替换</p>
<p>求 $cost(i)$ 跳个倍增就好了</p>
<p>那么最后将所有 $i$ 的 $cost(i)$ 排个序，设排序后某条边排在位置 $p$，则其对答案贡献 $2^{n + m - 1 - p}$（只有后面的边才能任意染色）</p>
<p>时间复杂度 $O (m \log n)$</p>
<h2 id="Problem-C：Network"><a href="#Problem-C：Network" class="headerlink" title="Problem C：Network"></a>Problem C：Network</h2><h3 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h3><p><img src= "/img/loading.gif" data-src="https://i.loli.net/2020/07/19/ZTh8wvO5FAqHKG4.png" alt=""></p>
<p><img src= "/img/loading.gif" data-src="https://i.loli.net/2020/07/19/DAaFX5Gpq2vzY8g.png" alt=""></p>
<h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>先计算在不反转用户的情况下，所有用户的 $MS(u)$</p>
<p>考虑点分治，现在递归到分治中心 $p$，设 $p$ 子树点 $x$ 到 $p$ 的边的最小值和最大值 $(mi_x, ma_x)$，假设现在有服务器 $i$，用户 $j$，都是 $p$ 的子树结点，计算 $MS(j)$，考虑有哪几种情况会贡献到 $MS(j)$，即是 $ma_i - mi_x$、$ma_i - mi_j$、$ma_j - mi_i$，同时 $(mi_i, ma_i), (mi_j, ma_j)$ 之间不存在任何关系，那么也就是说只需求得 $p$ 子树中满足 $ma_i - mi_i$ 最大，或 $ma_i$ 最大、或 $mi_i$ 最大，即可更新其它所有的用户（当然要与 $i$ 不同子树），又考虑到同子树不能互相更新，所以还得记录上面三者的次大值，这样就可以求出所有 $MS(u)$</p>
<p>接下来计算反转用户的情况，最小值最大，考虑二分答案</p>
<p>设此时二分答案 $mid$，继续考虑点分治（实际上只需要看点分树就好了），设分治中心 $p$，设在两个子树的用户 $i, j$，若使 $check$ 失败则需要找到一对 $i, j$，反转 $i$，使得 $Waste (j, i) &lt; mid$</p>
<p>将 $p$ 所有储存下来的 $(mi_x, ma_x)$ 按 $mi_x$ 排序，则对 $mi_j \le mi_x$，欲使其失败则需满足 $ma_i - mi_j &lt; mid$，即 $ma_x &lt; mi_j + mid$，对 $mi_j &gt; mi_x$，欲使其失败则需满足 $mi_i &gt; \max(ma_i, ma_j) - mid$，当然已经排除了所有满足 $ma_x - mi_x \ge mid$（对第一种情况）或 $MS(x) \ge mid$（对两种情况）的点，然后和前面相同可以线性处理</p>
<p>时间复杂度 $O (n \log n \log V)$</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1e05</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LFS</span> &#123;</span> <span class="keyword">int</span> to, w, next; &#125; ;</span><br><span class="line">LFS Link[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> Head[MAXN]= &#123;<span class="number">0</span>&#125;, size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">	Link[++ size].to = v;</span><br><span class="line">	Link[size].w = w;</span><br><span class="line">	Link[size].next = Head[u];</span><br><span class="line"></span><br><span class="line">	Head[u] = size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> type[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> subsize[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> visit[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> rt, minval = INF, fa;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">grvy</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> root, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">	subsize[root] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> maxpart = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">		<span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">		<span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">		grvy (n, v, root);</span><br><span class="line">		subsize[root] += subsize[v];</span><br><span class="line">		maxpart = max (maxpart, subsize[v]);</span><br><span class="line">	&#125;</span><br><span class="line">	maxpart = max (maxpart, n - subsize[root]);</span><br><span class="line">	<span class="keyword">if</span> (maxpart &lt; minval) &#123; rt = root; fa = father; minval = maxpart; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> l, r, id, bel;</span><br><span class="line">	<span class="comment">// min value, max value, original index, 子树从属</span></span><br><span class="line">	node (<span class="keyword">int</span> l = <span class="number">0</span>, <span class="keyword">int</span> r = <span class="number">0</span>, <span class="keyword">int</span> id = <span class="number">0</span>, <span class="keyword">int</span> bel = <span class="number">0</span>) : l (l), r (r), id (id), bel (bel) &#123;&#125;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node&amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (l == p.l) <span class="keyword">return</span> r &lt; p.r;</span><br><span class="line">		<span class="keyword">return</span> l &lt; p.l;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="built_in">vector</span>&lt;node&gt; a[MAXN];</span><br><span class="line"><span class="keyword">int</span> minv[MAXN], maxv[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span> <span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> father, <span class="keyword">int</span> bel)</span> </span>&#123;</span><br><span class="line">	a[rt].push_back(node (minv[root], maxv[root], root, bel));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = Head[root]; i; i = Link[i].next) &#123;</span><br><span class="line">		<span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line">		<span class="keyword">if</span> (v == father || visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">		minv[v] = min (minv[root], w);</span><br><span class="line">		maxv[v] = max (maxv[root], w);</span><br><span class="line">		DFS (v, root, bel);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> MS[MAXN]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	minv[rt] = INF, maxv[rt] = <span class="number">0</span>;</span><br><span class="line">	a[rt].push_back(node (minv[rt], maxv[rt], rt, rt));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = Head[rt]; i; i = Link[i].next) &#123;</span><br><span class="line">		<span class="keyword">int</span> v = Link[i].to, w = Link[i].w;</span><br><span class="line">		<span class="keyword">if</span> (visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">		minv[v] = min (minv[rt], w);</span><br><span class="line">		maxv[v] = max (maxv[rt], w);</span><br><span class="line">		DFS (v, rt, v);</span><br><span class="line">	&#125;</span><br><span class="line">	sort (a[rt].begin(), a[rt].end());</span><br><span class="line">	pair&lt;int, int&gt;  fir (- INF, 0), sec (- INF, 0);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">		node x = a[rt][i];</span><br><span class="line">		<span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line">			<span class="keyword">int</span> ms = x.r - x.l;</span><br><span class="line">			<span class="keyword">if</span> (ms &gt;= fir.first) &#123;</span><br><span class="line">				<span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">				fir = make_pair (ms, x.bel);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (ms &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (ms, x.bel);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">		node x = a[rt][i];</span><br><span class="line">		<span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">			pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line">			<span class="keyword">if</span> (now.second) &#123;</span><br><span class="line">				MS[x.id] = max (MS[x.id], x.r - x.l);</span><br><span class="line">				MS[x.id] = max (MS[x.id], now.first);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fir = make_pair (- INF, <span class="number">0</span>), sec = make_pair (- INF, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">		node x = a[rt][i];</span><br><span class="line">		<span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line">			<span class="keyword">if</span> (x.r &gt;= fir.first) &#123;</span><br><span class="line">				<span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">				fir = make_pair (x.r, x.bel);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (x.r &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.r, x.bel);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">		node x = a[rt][i];</span><br><span class="line">		<span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">			pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second? sec : fir;</span><br><span class="line">			<span class="keyword">int</span> r = max (x.r, now.first);</span><br><span class="line">			<span class="keyword">if</span> (now.second) MS[x.id] = max (MS[x.id], r - x.l);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fir = make_pair (INF, <span class="number">0</span>), sec = make_pair (INF, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">		node x = a[rt][i];</span><br><span class="line">		<span class="keyword">if</span> (type[x.id]) &#123;</span><br><span class="line">			<span class="keyword">if</span> (x.l &lt;= fir.first) &#123;</span><br><span class="line">				<span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">				fir = make_pair (x.l, x.bel);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (x.l &lt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.l, x.bel);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[rt].size(); i ++) &#123;</span><br><span class="line">		node x = a[rt][i];</span><br><span class="line">		<span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">			pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second? sec : fir;</span><br><span class="line">			<span class="keyword">int</span> l = min (x.l, now.first);</span><br><span class="line">			<span class="keyword">if</span> (now.second) MS[x.id] = max (MS[x.id], x.r - l);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	minval = INF; grvy (n, x, <span class="number">0</span>);</span><br><span class="line">	visit[rt] = <span class="literal">true</span>;</span><br><span class="line">	work ();</span><br><span class="line">	grvy (n, rt, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = Head[rt]; i; i = Link[i].next) &#123;</span><br><span class="line">		<span class="keyword">int</span> v = Link[i].to;</span><br><span class="line">		<span class="keyword">if</span> (visit[v]) <span class="keyword">continue</span>;</span><br><span class="line">		divide (subsize[v], v);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> fail[MAXN]= &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doit</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line">	pair&lt;int, int&gt; fir (- INF, 0), sec (- INF, 0);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) a[u].size(); i ++) &#123;</span><br><span class="line">		node x = a[u][i];</span><br><span class="line">		<span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">			pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line">			<span class="keyword">if</span> (now.second &amp;&amp; x.r &lt; now.first) fail[x.id] = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span> (MS[x.id] &gt;= mid || x.r - x.l &gt;= mid) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (x.l + mid &gt;= fir.first) &#123;</span><br><span class="line">				<span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">				fir = make_pair (x.l + mid, x.bel);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (x.l + mid &gt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.l + mid, x.bel);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fir = make_pair (INF, <span class="number">0</span>), sec = make_pair (INF, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = a[u].size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">		node x = a[u][i];</span><br><span class="line">		<span class="keyword">if</span> (! type[x.id]) &#123;</span><br><span class="line">			pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = x.bel == fir.second ? sec : fir;</span><br><span class="line">			<span class="keyword">if</span> (now.second &amp;&amp; x.l &gt; max (x.r, now.first) - mid) fail[x.id] = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span> (MS[x.id] &gt;= mid) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (x.r &lt;= fir.first) &#123;</span><br><span class="line">				<span class="keyword">if</span> (x.bel != fir.second) sec = fir;</span><br><span class="line">				fir = make_pair (x.r, x.bel);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(x.r &lt; sec.first &amp;&amp; x.bel != fir.second) sec = make_pair (x.r, x.bel);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span> <span class="params">(<span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) fail[i] = type[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) doit (i, mid);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">		<span class="keyword">if</span> (! fail[i])</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getnum</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar ();</span><br><span class="line">	<span class="keyword">while</span> (! <span class="built_in">isdigit</span> (ch)) ch = getchar ();</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">isdigit</span> (ch)) num = (num &lt;&lt; <span class="number">3</span>) + (num &lt;&lt; <span class="number">1</span>) + ch - <span class="string">'0'</span>, ch = getchar ();</span><br><span class="line">	<span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	N = getnum ();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) type[i] = getnum ();</span><br><span class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) sum += type[i];</span><br><span class="line">	<span class="keyword">if</span> (sum &gt;= N - <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (sum == N) &#123; <span class="built_in">puts</span> (<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">			<span class="keyword">if</span> (! type[i]) &#123;</span><br><span class="line">				<span class="built_in">printf</span> (<span class="string">"%d 0\n"</span>, i);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> maxi = <span class="number">0</span>, mini = INF;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u = getnum (), v = getnum (), w = getnum ();</span><br><span class="line">		Insert (u, v, w), Insert (v, u, w);</span><br><span class="line">		maxi = max (maxi, w); mini = min (mini, w);</span><br><span class="line">	&#125;</span><br><span class="line">	divide (N, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">int</span> left = <span class="number">0</span>, right = maxi - mini, ans;</span><br><span class="line">	<span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">		<span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (check (mid)) &#123; ans = mid; left = mid + <span class="number">1</span>; &#125;</span><br><span class="line">		<span class="keyword">else</span> right = mid - <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	check (ans);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i ++)</span><br><span class="line">		<span class="keyword">if</span> (! fail[i]) &#123;</span><br><span class="line">			<span class="built_in">printf</span> (<span class="string">"%d %d\n"</span>, i, ans);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Colythme</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://colythme.github.io/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/">http://colythme.github.io/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%82%B9%E5%88%86%E6%B2%BB/">点分治</a><a class="post-meta__tags" href="/tags/%E9%9B%86%E8%AE%AD/">集训</a><a class="post-meta__tags" href="/tags/ExGCD/">ExGCD</a><a class="post-meta__tags" href="/tags/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/">最小生成树</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"><img class="prev-cover" data-src="https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg" onerror="onerror=null;src='https://i.loli.net/2020/07/19/CD63xSYyqw5QmdH.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">长乐集训 - NOI模拟赛（二十四）「订正未完成」</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/04/%E9%95%BF%E4%B9%90%E9%9B%86%E8%AE%AD%20-%20NOI%E6%A8%A1%E6%8B%9F%E8%B5%9B%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AB%EF%BC%89%E3%80%8C%E8%AE%A2%E6%AD%A3%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%8D/"><img class="next-cover" data-src="https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg" onerror="onerror=null;src='https://i.loli.net/2020/07/19/CD63xSYyqw5QmdH.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">长乐集训 - NOI模拟赛（二十八）「订正未完成」</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/07/01/[NOI2014]购票 「树上斜率优化」/" title="「NOI2014」购票 「树上斜率优化」"><img class="relatedPosts_cover" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-01</div><div class="relatedPosts_title">「NOI2014」购票 「树上斜率优化」</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/04/长乐集训 - NOI模拟赛（二十）「订正未完成」/" title="长乐集训 - NOI模拟赛（二十）「订正未完成」"><img class="relatedPosts_cover" data-src="https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-04</div><div class="relatedPosts_title">长乐集训 - NOI模拟赛（二十）「订正未完成」</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/04/长乐集训 - NOI模拟赛（二十四）「订正未完成」/" title="长乐集训 - NOI模拟赛（二十四）「订正未完成」"><img class="relatedPosts_cover" data-src="https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-04</div><div class="relatedPosts_title">长乐集训 - NOI模拟赛（二十四）「订正未完成」</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/04/长乐集训 - NOI模拟赛（二十八）「订正未完成」/" title="长乐集训 - NOI模拟赛（二十八）「订正未完成」"><img class="relatedPosts_cover" data-src="https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-04</div><div class="relatedPosts_title">长乐集训 - NOI模拟赛（二十八）「订正未完成」</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/04/长乐集训 - NOI模拟赛（二十五）/" title="长乐集训 - NOI模拟赛（二十五）"><img class="relatedPosts_cover" data-src="https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-04</div><div class="relatedPosts_title">长乐集训 - NOI模拟赛（二十五）</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/04/长乐集训 - NOI模拟赛（二十二）「订正未完成」/" title="长乐集训 - NOI模拟赛（二十二）「订正未完成」"><img class="relatedPosts_cover" data-src="https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-04</div><div class="relatedPosts_title">长乐集训 - NOI模拟赛（二十二）「订正未完成」</div></div></a></div></div></div></article></main><footer id="footer" style="background-image: url(https://i.loli.net/2020/07/13/KhC7N5EDpbt6OM2.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By Colythme</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font_plus" title="Increase Font Size"><i class="fas fa-plus"></i></button><button id="font_minus" title="Decrease Font Size"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script></body></html>